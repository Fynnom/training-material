{"layout":"tutorial_hands_on","title":"Protein target prediction of a bioactive ligand with Align-it and ePharmaLib","level":"Intermediate","zenodo_link":"https://zenodo.org/record/6055897","questions":["What is a pharmacophore model?","How can I perform protein target prediction with a multi-step workflow or the one-step Zauberkugel workflow?"],"objectives":["Create an SMILES file of a bioactive ligand.","Screen the query ligand against a pharmacophore library.","Analyze the results of the protein target prediction."],"time_estimation":"2H","key_points":["A pharmacophore is an abstract description of the molecular features of a bioactive ligand.","Pharmacophore-based target prediction is an efficient and cost-effective method."],"contributors":[{"name":"Aurélien F. A. Moumbock","email":"amaf.aurelien@yahoo.com","orcid":"0000-0002-6034-2016","twitter":"FMoumbock","joined":"2022-02","id":"aurelienmoumbock","url":"https://training.galaxyproject.org/training-material/api/contributors/aurelienmoumbock.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/aurelienmoumbock/"},{"name":"Simon Bray","joined":"2019-05","elixir_node":"de","former_affiliations":["uni-freiburg","elixir-europe"],"id":"simonbray","url":"https://training.galaxyproject.org/training-material/api/contributors/simonbray.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/simonbray/"}],"js_requirements":{"mathjax":6049,"mermaid":false},"short_id":"T00054","url":"/topics/computational-chemistry/tutorials/zauberkugel/tutorial.html","topic_name":"computational-chemistry","tutorial_name":"zauberkugel","dir":"topics/computational-chemistry/tutorials/zauberkugel","symlink":null,"id":"computational-chemistry/zauberkugel","ref_tutorials":["<p>Historically, the pharmacophore concept was formulated in 1909 by the German physician and Nobel prize laureate Paul Ehrlich (<span class=\"citation\"><a href=\"#Ehrlich1909\">Ehrlich 1909</a></span>). According to the <a href=\"https://iupac.org/\">International Union of Pure and Applied Chemistry (IUPAC)</a>, a pharmacophore is defined as “an ensemble of steric and electronic features that is necessary to ensure the optimal supramolecular interactions with a specific biological target and to trigger (or block) its biological response” (<span class=\"citation\"><a href=\"#Wermuth1998\">Wermuth <i>et al.</i> 1998</a></span>). Starting from the cocrystal structure of a non-covalent protein–ligand complex (e.g. Figure 1), pharmacophore perception involves the extraction of the key molecular features of the bioactive ligand at the protein–ligand contact interface into a single model (<span class=\"citation\"><a href=\"#Moumbock2019\">Moumbock <i>et al.</i> 2019</a></span>). These pharmacophoric features mainly include: H-bond acceptor (HACC or A), H-bond donor (HDON or D), lipophilic group (LIPO or H), negative center (NEGC or N), positive center (POSC or P), and aromatic ring (AROM or R) moieties. Moreover, receptor-based excluded spheres (EXCL) can be added in order to mimic spatial constraints of the binding pocket (Figure 2). Once a pharmacophore model has been generated, a query can be performed either in a forward manner, using several ligands to search for novel putative hits of a given target, or in a reverse manner, by screening a single ligand against multiple pharmacophore models in search of putative protein targets (<span class=\"citation\"><a href=\"#Steindl2006\">Steindl <i>et al.</i> 2006</a></span>).</p>\n\n<figure id=\"figure-1\" style=\"max-width: 90%;\"><img src=\"/training-material/topics/computational-chemistry/images/4MVF-STU.png\" alt=\"PDB ID: 4MVF. \" width=\"683\" height=\"638\" loading=\"lazy\" /><a target=\"_blank\" href=\"/training-material/topics/computational-chemistry/images/4MVF-STU.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 1</strong>:</span> Crystal Structure of *Plasmodium falciparum* calcium-dependent protein kinase 2 (CDPK2) complexed with staurosporine (STU) with PDB ID: [4MVF](https://www.rcsb.org/structure/4mvf). Image generated using Maestro (Schrödinger LLC, NY).</figcaption></figure>\n\n<p>Bioactive compounds often bind to several target proteins, thereby exhibiting polypharmacology. However, experimentally determining these interactions is laborious, and structure-based virtual screening of bioactive compounds could expedite drug discovery by prioritizing hits for experimental validation. The recently reported ePharmaLib (<span class=\"citation\"><a href=\"#Moumbock2021\">Moumbock <i>et al.</i> 2021</a></span>) dataset is a library of 15,148 e-pharmacophores modeled from solved structures of pharmaceutically relevant protein–ligand complexes of the screening Protein Data Bank (sc-PDB, <span class=\"citation\"><a href=\"#Desaphy2014\">Desaphy <i>et al.</i> 2014</a></span>). ePharmaLib can be used for target fishing of phenotypic hits, side effect predictions, drug repurposing, and scaffold hopping.</p>\n\n<figure id=\"figure-2\" style=\"max-width: 90%;\"><img src=\"/training-material/topics/computational-chemistry/images/STU.png\" alt=\"STU. \" width=\"1201\" height=\"751\" loading=\"lazy\" /><a target=\"_blank\" href=\"/training-material/topics/computational-chemistry/images/STU.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 2</strong>:</span> Depiction of the 2D structure of staurosporine (left) and 3D structure (right) with key pharmacophoric features extracted from the STU–CDPK2 complex (PDB ID: [4MVF](https://www.rcsb.org/structure/4mvf)). Image generated using Maestro (Schrödinger LLC, NY).</figcaption></figure>\n\n<p>In this tutorial, you will perform pharmacophore-based target prediction of a bioactive ligand known as staurosporine (Figure 2) with the ePharmaLib subset representing <em>Plasmodium falciparum</em> protein targets (138 pharmacophore models) and the open-source pharmacophore alignment program <a href=\"https://anaconda.org/bioconda/align_it\">Align-it</a>, formerly known as PHARAO (<span class=\"citation\"><a href=\"#Taminau2008\">Taminau <i>et al.</i> 2008</a></span>).</p>\n\n<blockquote class=\"details\">\n  <details-title>Pharmacology of staurosporine</details-title>\n\n  <p>Staurosporine (PDB hetID: <a href=\"https://www.rcsb.org/ligand/STU\">STU</a>) is an indolocarbazole secondary metabolite isolated from several bacteria of the genus Streptomyces. It displays diverse biological activities such as anticancer and antiparasitic activities (<span class=\"citation\"><a href=\"#Nakano2009\">Nakano and Ōmura 2009</a></span>).</p>\n</blockquote>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n  <p>In this tutorial, we will cover:</p>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#create-a-history\" id=\"markdown-toc-create-a-history\">Create a history</a></li>\n  <li><a href=\"#get-data\" id=\"markdown-toc-get-data\">Get data</a>    <ol>\n      <li><a href=\"#fetching-the-epharmalib-dataset\" id=\"markdown-toc-fetching-the-epharmalib-dataset\">Fetching the ePharmaLib dataset</a></li>\n      <li><a href=\"#creating-a-query-ligand-structure-file\" id=\"markdown-toc-creating-a-query-ligand-structure-file\">Creating a query ligand structure file</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#pre-processing\" id=\"markdown-toc-pre-processing\">Pre-processing</a>    <ol>\n      <li><a href=\"#ligand-hydration\" id=\"markdown-toc-ligand-hydration\">Ligand hydration</a></li>\n      <li><a href=\"#splitting-epharmalib-into-individual-pharmacophores\" id=\"markdown-toc-splitting-epharmalib-into-individual-pharmacophores\">Splitting ePharmaLib into individual pharmacophores</a></li>\n      <li><a href=\"#ligand-conformational-flexibility\" id=\"markdown-toc-ligand-conformational-flexibility\">Ligand conformational flexibility</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#pharmacophore-alignment\" id=\"markdown-toc-pharmacophore-alignment\">Pharmacophore alignment</a></li>\n  <li><a href=\"#post-processing\" id=\"markdown-toc-post-processing\">Post-processing</a>    <ol>\n      <li><a href=\"#concatenating-the-pharmacophore-alignment-scores\" id=\"markdown-toc-concatenating-the-pharmacophore-alignment-scores\">Concatenating the pharmacophore alignment scores</a></li>\n      <li><a href=\"#ranking-the-predicted-protein-targets\" id=\"markdown-toc-ranking-the-predicted-protein-targets\">Ranking the predicted protein targets</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#one-step-zauberkugel-workflow-vs-multi-step-workflow\" id=\"markdown-toc-one-step-zauberkugel-workflow-vs-multi-step-workflow\">One-step Zauberkugel workflow vs. multi-step workflow</a></li>\n  <li><a href=\"#further-analysis\" id=\"markdown-toc-further-analysis\">Further analysis</a></li>\n  <li><a href=\"#conclusion\" id=\"markdown-toc-conclusion\">Conclusion</a></li>\n</ol>\n\n</blockquote>\n\n<h1 id=\"create-a-history\">Create a history</h1>\n\n<p>As a first step, we create a new history for the analysis.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Hands-on 1: Create history</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Create a new history.</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-new-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-new-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a new history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>Click the <i class=\"fas fa-plus\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">new-history</span> icon at the top of the history panel:</p>   <p><img src=\"/training-material/shared/images/history_create_new.svg\" alt=\"UI for creating new history\" /></p>   <!-- the original drawing can be found here https://docs.google.com/drawings/d/1cCBrLAo4kDGic5QyB70rRiWJAKTenTU8STsKDaLcVU8/edit?usp=sharing --> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Rename it to <code class=\"language-plaintext highlighter-rouge\">Staurosporine target prediction</code>.</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-renaming-a-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-renaming-a-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Renaming a history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ol>   <li>Click on <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> (<strong>Edit</strong>) next to the history name (which by default is “Unnamed history”)</li>   <li>Type the new name: <code class=\"language-plaintext highlighter-rouge\">Staurosporine target prediction</code></li>   <li>Click on <strong>Save</strong></li> </ol>   <p>If you do not have the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> (<strong>Edit</strong>) next to the history name:</p>   <ol>   <li>Click on <strong>Unnamed history</strong> (or the current name of the history) (<strong>Click to rename history</strong>) at the top of your history panel</li>   <li>Type the new name: <code class=\"language-plaintext highlighter-rouge\">Staurosporine target prediction</code></li>   <li>Press <kbd>Enter</kbd></li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h1 id=\"get-data\">Get data</h1>\n\n<p>For this exercise, we need two datasets: the ePharmaLib pharmacophore library (PHAR format) and a query ligand structure file (SMI format).</p>\n\n<h2 id=\"fetching-the-epharmalib-dataset\">Fetching the ePharmaLib dataset</h2>\n\n<p>Firstly, we will retrieve the concatenated ePharmaLib subset representing <em>P. falciparum</em> protein targets.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Hands-on 2: Upload ePharmaLib</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Upload the dataset from the <a href=\"https://zenodo.org\">Zenodo</a> link provided to your Galaxy history.</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-via-links\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-via-links\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing via links</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>     <p><code class=\"language-plaintext highlighter-rouge\">https://zenodo.org/record/6055897/files/ePharmaLib_PHARAO_plasmodium.phar</code></p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <blockquote class=\"comment\">\n        <comment-title>ePharmaLib versions</comment-title>\n\n        <p>Two versions of the ePharmaLib (PHAR &amp; PHYPO formats) have been created for use with the pharmacophore alignment programs <a href=\"https://anaconda.org/bioconda/align_it\">Align-it</a> and <a href=\"https://www.schrodinger.com/products/phase\">Phase</a>, respectively. Both versions can be broken down into small datasets. e.g. for human targets. They are freely available at <a href=\"https://zenodo.org\">Zenodo</a> under the link:\n\t<code class=\"language-plaintext highlighter-rouge\">\n\thttps://zenodo.org/record/6055897\n</code></p>\n      </blockquote>\n    </li>\n    <li>\n      <p>Change the datatype from <code class=\"language-plaintext highlighter-rouge\">tabular</code>to <code class=\"language-plaintext highlighter-rouge\">phar</code>. This step is essential, as Galaxy does not automatically detect the datatype for PHAR files.</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-changing-the-datatype\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-changing-the-datatype\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Changing the datatype</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, click <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Datatypes</strong> tab on the top</li>   <li>In the <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Assign Datatype</strong>, select <code class=\"language-plaintext highlighter-rouge\">phar</code> from “<em>New type</em>” dropdown     <ul>       <li>Tip: you can start typing the datatype into the field to filter the dropdown menu</li>     </ul>   </li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>You can view the contents of the downloaded PHAR file by pressing the <strong>eye icon</strong> (View data) for this dataset.</p>\n\n      <blockquote class=\"details\">\n        <details-title>What is a PHAR file?</details-title>\n\n        <p>A PHAR file is essentially a series of lines containing the three-dimensional coordinates of pharmacophoric features and excluded spheres. The first column specifies a feature type (e.g. HACC is a hydrogen bond acceptor). Subsequent columns specify the position of the feature center in a three-dimensional space. Individual pharmacophores are separated by lines containing four dollar signs (<code class=\"language-plaintext highlighter-rouge\">$$$$</code>). The pharmacophores of the ePharmaLib dataset were labeled according to the following three-component code <em>PDBID-hetID-UniprotEntryName</em>.</p>\n      </blockquote>\n    </li>\n  </ol>\n</blockquote>\n\n<h2 id=\"creating-a-query-ligand-structure-file\">Creating a query ligand structure file</h2>\n\n<p>In this step, we will manually create an SMI file containing the SMILES of staurosporine.</p>\n\n<blockquote class=\"details\">\n  <details-title>What are SMILES and the SMI file format?</details-title>\n\n  <p>The simplified molecular-input line-entry system (SMILES) is a string notation for describing the 2D chemical structure of a compound. It only states the atoms present in a compound and the connectivity between them. As an example, the SMILES string of acetone is <code class=\"language-plaintext highlighter-rouge\">CC(=O)C</code>. SMILES strings can be imported by most molecule editors and converted into either two-dimensional structural drawings or three-dimensional models of the compounds, and vice versa. For more information on how the notation works, please consult the <a href=\"http://opensmiles.org/opensmiles.html\">OpenSMILES specification</a> or the description provided by <a href=\"https://en.wikipedia.org/wiki/Simplified_molecular-input_line-entry_system\">Wikipedia</a>.</p>\n\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Hands-on 3: Create an SMI file</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Create a new file using the Galaxy upload manager, with the following contents. Make sure to select the datatype (with <strong>Type</strong>) as <code class=\"language-plaintext highlighter-rouge\">smi</code>. This step is essential, as Galaxy does not automatically detect the datatype for SMI files.</p>\n\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>C[C@@]12[C@@H]([C@@H](C[C@@H](O1)N3C4=CC=CC=C4C5=C6C(=C7C8=CC=CC=C8N2C7=C53)CNC6=O)NC)OC\tstaurosporine\n</code></pre></div>      </div>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-new-file\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-new-file\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a new file</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong> at the bottom</li>   <li>Paste the file contents into the text field</li>   <li>Change <strong>Type</strong> from “Auto-detect” to <code class=\"language-plaintext highlighter-rouge\">smi</code>* Press <strong>Start</strong> and <strong>Close</strong> the window</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n  <blockquote class=\"tip\">\n    <tip-title>SMILES generation</tip-title>\n\n    <p>A SMILES string can automatically be generated from a ligand name or 2D structure with a desktop molecule editor such <a href=\"https://perkinelmerinformatics.com/products/research/chemdraw/\">ChemDraw®</a> and <a href=\"https://chemaxon.com/products/marvin\">Marvin®</a>, or with web-based molecule editors such as <a href=\"https://pubchem.ncbi.nlm.nih.gov//edit3/index.html\">PubChem Sketcher</a> and <a href=\"https://chemdrawdirect.perkinelmer.cloud/js/sample/index.html\">ChemDraw® JS</a>. Moreover, the pre-computed SMILES strings of a large number of bioactive compounds can be retrieved from chemical databases such as <a href=\"https://pubchem.ncbi.nlm.nih.gov/\">PubChem</a>. e.g.</p>\n\n    <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://pubchem.ncbi.nlm.nih.gov/compound/44259#section=Isomeric-SMILES&amp;fullscreen=true\n</code></pre></div>    </div>\n\n  </blockquote>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>Why do we specifically use a so-called isomeric SMILES string?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <p>Staurosporine is a chiral molecule possessing four chiral centers. The SMILES notation allows the specification of configuration at tetrahedral centers and double bond geometry, by marking atoms with <code class=\"language-plaintext highlighter-rouge\">@</code> or <code class=\"language-plaintext highlighter-rouge\">@@</code>. These are structural features that cannot be specified by connectivity alone, and therefore SMILES which encode this information are termed isomeric SMILES. A notable feature of these rules is that they allow rigorous partial specification of chirality.</p>\n\n  </blockquote>\n\n</blockquote>\n\n<h1 id=\"pre-processing\">Pre-processing</h1>\n\n<p>Prior to pharmacophore alignment, the predominant ionization state(s) of the query ligand as well as its 3D conformers should be generated. Also, the pharmacophore dataset will be split into a collection of individual pharmacophore files.</p>\n\n<h2 id=\"ligand-hydration\">Ligand hydration</h2>\n\n<p>More often than not, the bioactive form of a compound is its predominant form at physiological pH (7.4). In this step, we predict the most probable ionization state(s) of the query ligand at pH 7.4 with the cheminformatics toolkit OpenBabel (<span class=\"citation\"><a href=\"#OBoyle2011\">O’Boyle <i>et al.</i> 2011</a></span>).</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Hands-on 4: Add hydrogen atoms</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/openbabel_addh/openbabel_addh/3.1.1+galaxy1\" title=\"Add hydrogen atoms tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Add hydrogen atoms</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 3.1.1+galaxy1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Molecular input file”</em>: <code class=\"language-plaintext highlighter-rouge\">staurosporine.smi</code> (from Hands-on 3)</li>\n        <li><em>“Add hydrogens to polar atoms only (i.e. not to carbon atoms)”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n      </ul>\n    </li>\n    <li>\n      <p>Rename the output to <code class=\"language-plaintext highlighter-rouge\">staurosporine_hydrated</code>.</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-renaming-a-dataset\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-renaming-a-dataset\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Renaming a dataset</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, change the <strong>Name</strong> field  to <code class=\"language-plaintext highlighter-rouge\">staurosporine_hydrated</code></li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>Nitrogen-containing functional groups are known to be basic. Which of them present in staurosporine (Figure 2) do you expect to be protonated at pH 7.4, and which not? And why?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <p>Only the secondary N-methylamino group will be protonated because indoles, much like aromatic amides, are typically not basic.</p>\n\n  </blockquote>\n\n</blockquote>\n\n<h2 id=\"splitting-epharmalib-into-individual-pharmacophores\">Splitting ePharmaLib into individual pharmacophores</h2>\n\n<p>The ePharmaLib subset representing <em>P. falciparum</em> protein targets (<em>ePharmaLib_PHARAO_plasmodium.phar</em>) is a concatenated file containing 148 individual pharmacophore files. To speed up our analysis, it is preferable to split the dataset into individual files in order to perform several pharmacophore alignments in parallel, using Galaxy’s collection functionality.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Hands-on 5: Splitting ePharmaLib</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/split_file_to_collection/split_file_to_collection/0.5.0\" title=\"Split file tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Split file</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.5.0)</span> with the following parameters:\n      <ul>\n        <li><em>“Select the file type to split”</em>: <code class=\"language-plaintext highlighter-rouge\">Generic</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“File to split”</em>: <code class=\"language-plaintext highlighter-rouge\">ePharmaLib_PHARAO_plasmodium.phar</code> (from Hands-on 2)</li>\n            <li><em>“Method to split files”</em>: <code class=\"language-plaintext highlighter-rouge\">Specify record separator as regular expression</code>\n              <ul>\n                <li><em>“Regex to match record separator”</em>: <code class=\"language-plaintext highlighter-rouge\">\\$\\$\\$\\$</code></li>\n                <li><em>“Split records before or after the separator?”</em>: <code class=\"language-plaintext highlighter-rouge\">After</code></li>\n              </ul>\n            </li>\n            <li><em>“Specify number of output files or number of records per file?”</em>: <code class=\"language-plaintext highlighter-rouge\">Number of records per file ('chunk mode')</code></li>\n            <li><em>“Base name for new files in collection”</em>: <code class=\"language-plaintext highlighter-rouge\">epharmalib</code></li>\n            <li><em>“Method to allocate records to new files”</em>: <code class=\"language-plaintext highlighter-rouge\">Maintain record order</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>\n      <p>Rename the output to <code class=\"language-plaintext highlighter-rouge\">ePharmaLib_PLAF_split</code>.</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-renaming-a-dataset-1\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-renaming-a-dataset-1\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Renaming a dataset</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, change the <strong>Name</strong> field  to <code class=\"language-plaintext highlighter-rouge\">ePharmaLib_PLAF_split</code></li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h2 id=\"ligand-conformational-flexibility\">Ligand conformational flexibility</h2>\n\n<p>To reduce the calculation time, the Align-it (<span class=\"citation\"><a href=\"#Taminau2008\">Taminau <i>et al.</i> 2008</a></span>) tool performs rigid alignment rather than flexible alignment. Conformational flexibility of the ligand is accounted for by introducing a preliminary step, in which a set of energy-minimized conformers for the query ligand are generated with the RDConf (<span class=\"citation\"><a href=\"#rdconf\">Koes</a></span>) tool (using the RDKit (<span class=\"citation\"><a href=\"#landrum2013rdkit\">Landrum and others 2013</a></span>) toolkit).</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Hands-on 6: Low-energy ligand conformer search</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/rdconf/rdconf/2020.03.4+galaxy0\" title=\"RDConf: Low-energy ligand conformer search tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>RDConf: Low-energy ligand conformer search</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2020.03.4+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input file”</em>: <code class=\"language-plaintext highlighter-rouge\">staurosporine_hydrated</code> (from Hands-on 4)</li>\n        <li><em>“Maximum number of conformers to generate per molecule”</em>: <code class=\"language-plaintext highlighter-rouge\">100</code></li>\n      </ul>\n    </li>\n    <li>\n      <p>Rename the output to <code class=\"language-plaintext highlighter-rouge\">staurosporine_3D_conformers</code>.</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-renaming-a-dataset-2\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-renaming-a-dataset-2\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Renaming a dataset</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, change the <strong>Name</strong> field  to <code class=\"language-plaintext highlighter-rouge\">staurosporine_3D_conformers</code></li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <blockquote class=\"comment\">\n        <comment-title>RDConf</comment-title>\n\n        <p>It is recommended to use the default settings, except for the number of conformers which should be changed to 100. As a rule of thumb, a threshold of 100 conformers appropriately represents the conformational flexibility of a compound with less than 10 rotatable bonds. The output SDF (structure data file) format encodes three-dimensional atomic coordinates of each conformer, separated by lines containing four dollar signs (<code class=\"language-plaintext highlighter-rouge\">$$$$</code>).</p>\n      </blockquote>\n    </li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>Have a look at the contents of the created collection <code class=\"language-plaintext highlighter-rouge\">staurosporine_3D_conformers</code>. Why were less than 100 conformers were generated for staurosporine?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <p>Staurosporine is a fused 8-ring system with only two rotatable bonds, due to its planar aromatic 5-ring indolocarbozole scaffold which confers a high structural rigidity upon the compound, i.e. it exists in relatively few energetically distinct 3D conformations.</p>\n\n  </blockquote>\n\n</blockquote>\n\n<h1 id=\"pharmacophore-alignment\">Pharmacophore alignment</h1>\n\n<p>In this step, the ligand conformer dataset (SDF format) is converted on-the-fly to a pharmacophore dataset (PHAR format) and simultaneously aligned to the individual pharmacophores of the ePharmaLib dataset in a batch mode with Align-it (<span class=\"citation\"><a href=\"#Taminau2008\">Taminau <i>et al.</i> 2008</a></span>). The pharmacophoric alignments and thus the predicted targets are ranked in terms of a scoring metric: <code class=\"language-plaintext highlighter-rouge\">Tversky index</code> = [0,1]. The higher the Tversky index, the higher the likelihood of the predicted protein–ligand interaction.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Hands-on 7: Pharmacophore alignment</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/align_it/ctb_alignit/1.0.4+galaxy0\" title=\"Pharmacophore alignment tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Pharmacophore alignment</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.0.4+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Defines the database of molecules that will be used to screen”</em>: <code class=\"language-plaintext highlighter-rouge\">staurosporine_3D_conformers</code> (from Hands-on 7)</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Reference molecule”</em>: <code class=\"language-plaintext highlighter-rouge\">ePharmaLib_PLAF_split</code> (from Hands-on 5)</li>\n        <li><em>“No normal information is included during the alignment”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        <li><em>“Disable the use of hybrid pharmacophore points”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        <li><em>“Only structures with a score larger than this cutoff will be written to the files”</em>: <code class=\"language-plaintext highlighter-rouge\">0.0</code></li>\n        <li><em>“Maximum number of best scoring structures to write to the files”</em>: <code class=\"language-plaintext highlighter-rouge\">1</code></li>\n        <li><em>“This option defines the used scoring scheme”</em>: <code class=\"language-plaintext highlighter-rouge\">TVERSKY_REF</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h1 id=\"post-processing\">Post-processing</h1>\n\n<p>The above pharmacophore alignment produces three types of outputs: the aligned pharmacophores (PHAR format), aligned structures (SMI format), and alignment scores (tabular format). Of these results, only the alignment scores are of interest and will be post-processed prior to analysis.</p>\n\n<h2 id=\"concatenating-the-pharmacophore-alignment-scores\">Concatenating the pharmacophore alignment scores</h2>\n\n<p>The alignment score of the best ranked ligand conformer aligned against each ePharmaLib pharmacophore is stored in an individual file. In total, this job generates a collection of 138 output files which should be concatenated in a single file, for a better overview of the predictions.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Hands-on 8: Concatenating the scores</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_cat/0.1.1\" title=\"Concatenate datasets tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Concatenate datasets</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.1.1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Datasets to concatenate”</em>: <code class=\"language-plaintext highlighter-rouge\">scores</code> (from Hands-on 7)</li>\n      </ul>\n    </li>\n    <li>\n      <p>Rename the output to <code class=\"language-plaintext highlighter-rouge\">concatenated_scores</code>.</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-renaming-a-dataset-3\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-renaming-a-dataset-3\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Renaming a dataset</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, change the <strong>Name</strong> field  to <code class=\"language-plaintext highlighter-rouge\">concatenated_scores</code></li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h2 id=\"ranking-the-predicted-protein-targets\">Ranking the predicted protein targets</h2>\n\n<p>The resulting <code class=\"language-plaintext highlighter-rouge\">concatenated_scores</code> needs to be re-sorted according to the alignment metric, the Tversky index, i.e. the 10th column. The pharmacophores of the ePharmaLib dataset were labeled according to the following three-component code <em>PDBID-hetID-UniprotEntryName</em>. The contents of the <code class=\"language-plaintext highlighter-rouge\">concatenated_scores</code> are as follows:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>------    ---------------------------------------------------------------------\ncolumn    Content\n------    ---------------------------------------------------------------------\n     1    Id of the reference structure\n     2    Maximum volume of the reference structure\n     3    Id of the database structure\n     4    Maximum volume of the database structure\n     5    Maximum volume overlap of the two structures\n     6    Overlap between pharmacophore and exclusion spheres in the reference\n     7    Corrected volume overlap between database pharmacophore and reference\n     8    Number of pharmacophore points in the processed pharmacophore\n     9    TANIMOTO score\n    10    TVERSKY_REF score\n    11    TVERSKY_DB score\n------    --------------------------------------------------------------------- \n</code></pre></div></div>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Hands-on 9: Sort Dataset</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"sort1\" title=\"Sort tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Sort</strong></span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Sort Dataset”</em>: <code class=\"language-plaintext highlighter-rouge\">concatenated_scores</code> (from Hands-on 8)</li>\n        <li><em>“on column”</em>: <code class=\"language-plaintext highlighter-rouge\">c10</code></li>\n      </ul>\n    </li>\n    <li>\n      <p>Rename the output to <code class=\"language-plaintext highlighter-rouge\">final_target_prediction_scores</code>.</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-renaming-a-dataset-4\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-renaming-a-dataset-4\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Renaming a dataset</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, change the <strong>Name</strong> field  to <code class=\"language-plaintext highlighter-rouge\">final_target_prediction_scores</code></li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>You can view the contents of the collection <code class=\"language-plaintext highlighter-rouge\">final_target_prediction_scores</code> by pressing the <strong>eye icon</strong> (View data).</li>\n  </ol>\n\n  <p>The top-ranked protein of our target prediction experiment is <em>4mvf-STU-CDPK2_PLAFK</em> (Figures 1 &amp; 2) with a Tversky index = 0.73. The general observation that can be made from this ranking of protein hits is the high self-retrieval rate of known targets, which demonstrates the high prediction accuracy of the method. The higher the Tversky index, the higher the likelihood of the predicted protein–ligand interaction; with a value of 0.5 corresponding to a 50% likelihood.</p>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>Why was a perfect pharmacophore alignment (Tversky index =  1) not achieved for the top-ranked protein target for which the cocrystallized ligand is staurosporine (<em>STU</em>)?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <p>A perfect pharmacophore alignment because a computational conformer generator (here RDConf in Hands-on 6) is unlikely to be able to reproduce a crystallographic (native) ligand pose with 100% accuracy.</p>\n\n  </blockquote>\n\n</blockquote>\n\n<h1 id=\"one-step-zauberkugel-workflow-vs-multi-step-workflow\">One-step Zauberkugel workflow vs. multi-step workflow</h1>\n\n<p>For pharmacophore-based protein target prediction, you can choose to use Galaxy tools separately and in succession as described above, or alternatively use the one-step Zauberkugel workflow as described below (Figure 3).</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Upload the Zauberkugel workflow</hands-on-title>\n\n  <p>Upload the Zauberkugel workflow from the following URL:</p>\n\n  <!--SNIPPET-->\n  <blockquote class=\"hands_on\">   <div class=\"box-title hands_on-title\" id=\"hands-on-importing-and-launching-a-gtn-workflow\"><i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i> Hands-on: Importing and launching a GTN workflow</div>   <div class=\"show-when-galaxy-proxy-active\"> <span class=\"workflow\" data-workflow=\"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/computational-chemistry-zauberkugel/versions/main_workflow\">Launch <strong>Zauberkugel Workflow</strong> <i class=\"fas fa-share-alt\" aria-hidden=\"true\"></i></span> (<a href=\"https://github.com/galaxyproject/training-material/blob/main/topics/computational-chemistry/tutorials/zauberkugel/workflows/main_workflow.ga\">View on GitHub</a>, <a href=\"https://training.galaxyproject.org/training-material/topics/computational-chemistry/tutorials/zauberkugel/workflows/main_workflow.ga\">Download workflow</a>) workflow. </div>   <div class=\"hide-when-galaxy-proxy-active\"> Click to  <a href=\"https://my.galaxy.training/?path=/workflows/trs_import%3Frun_form=true%26trs_url=https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/computational-chemistry-zauberkugel/versions/main_workflow\">     Launch <strong>Zauberkugel Workflow</strong> <i class=\"fas fa-share-alt\" aria-hidden=\"true\"></i> </a> (<a href=\"https://github.com/galaxyproject/training-material/blob/main/topics/computational-chemistry/tutorials/zauberkugel/workflows/main_workflow.ga\">View on GitHub</a>, <a href=\"https://training.galaxyproject.org/training-material/topics/computational-chemistry/tutorials/zauberkugel/workflows/main_workflow.ga\">Download workflow</a>) </div>   <!--SNIPPET-->   <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-if-this-does-not-work\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-if-this-does-not-work\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: If this does not work</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on <em>Workflow</em> on the top menu bar of Galaxy. You will see a list of all your workflows.</li>   <li>Click on <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Import</strong> at the top-right of the screen</li>   <li>Paste the following URL into the box labelled <em>“Archived Workflow URL”</em>: <code class=\"language-plaintext highlighter-rouge\">https://training.galaxyproject.org/training-material/topics/computational-chemistry/tutorials/zauberkugel/workflows/main_workflow.ga</code></li>   <li>Click the <strong>Import workflow</strong> button</li> </ul>   <p>Below is a short video demonstrating how to import a workflow from GitHub using this procedure:</p>   <figure> <iframe credentialless=\"\" allowfullscreen=\"\" referrerpolicy=\"no-referrer\" sandbox=\"allow-scripts allow-same-origin\" allow=\"accelerometer 'none'; ambient-light-sensor 'none'; autoplay 'none'; battery 'none'; bluetooth 'none'; browsing-topics 'none'; camera 'none'; ch-ua 'none'; display-capture 'none'; domain-agent 'none'; document-domain 'none'; encrypted-media 'none'; execution-while-not-rendered 'none'; execution-while-out-of-viewport 'none'; gamepad 'none'; geolocation 'none'; gyroscope 'none'; hid 'none'; identity-credentials-get 'none'; idle-detection 'none'; keyboard-map 'none'; local-fonts 'none'; magnetometer 'none'; microphone 'none'; midi 'none'; navigation-override 'none'; otp-credentials 'none'; payment 'none'; picture-in-picture 'none'; publickey-credentials-create 'none'; publickey-credentials-get 'none'; screen-wake-lock 'none'; serial 'none'; speaker-selection 'none'; sync-xhr 'none'; usb 'none'; web-share 'none'; window-management 'none'; xr-spatial-tracking 'none'\" csp=\"sandbox allow-scripts allow-same-origin;\" width=\"560\" height=\"315\" src=\"https://www.youtube-nocookie.com/embed/hoP36Te5wko\" title=\"Importing a workflow from URL\" frameborder=\"0\" loading=\"lazy\"></iframe> <figcaption>   <span class=\"figcaption-prefix\"><strong>Video</strong>:</span> Importing a workflow from URL</figcaption> </figure> </blockquote>   <p><!--END_SNIPPET--></p> </blockquote>\n  <p><!--END_SNIPPET--></p>\n\n  <p>The Zauberkugel workflow requires only two inputs; the ligand structure file (SMI format) and the ePharmaLib dataset (PHAR format). The output of the prediction of human targets of staurosporine performed with the ePharmaLib human target subset (<a href=\"https://zenodo.org/record/6055897\">https://zenodo.org/record/6055897</a>) and this workflow is available as a <a href=\"https://usegalaxy.eu/u/aurelien_moumbock/h/zauberkugel\">Galaxy history</a>.</p>\n</blockquote>\n\n<figure id=\"figure-3\" style=\"max-width: 90%;\"><img src=\"/training-material/topics/computational-chemistry/images/zauberkugel.png\" alt=\"Snapshot of Zauberkugel workflow. \" width=\"1117\" height=\"346\" loading=\"lazy\" /><a target=\"_blank\" href=\"/training-material/topics/computational-chemistry/images/zauberkugel.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 3</strong>:</span> Zauberkugel — protein target prediction of a bioactive ligand with Align-it and ePharmaLib</figcaption></figure>\n\n<h1 id=\"further-analysis\">Further analysis</h1>\n\n<p>To obtain a docking pose of a protein–ligand interaction predicted from pharmacophore-based protein target prediction, follow the <a href=\"/training-material/topics/computational-chemistry/tutorials/cheminformatics/tutorial.html\">Protein–ligand docking</a> Galaxy training.</p>\n\n<h1 id=\"conclusion\">Conclusion</h1>\n"],"ref_slides":[],"hands_on":true,"slides":false,"mod_date":"2024-06-11 12:02:02 +0000","pub_date":"2022-02-15 13:56:40 +0000","version":23,"workflows":[{"workflow":"main_workflow.ga","tests":false,"url":"https://training.galaxyproject.org/training-material/topics/computational-chemistry/tutorials/zauberkugel/workflows/main_workflow.ga","path":"topics/computational-chemistry/tutorials/zauberkugel/workflows/main_workflow.ga","wfid":"computational-chemistry-zauberkugel","wfname":"main_workflow","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/computational-chemistry-zauberkugel/versions/main_workflow","license":"MIT","creators":[{"class":"Person","email":"mailto:amaf.aurelien@yahoo.com","identifier":"https://orcid.org/0000-0002-6034-2016","name":"Aurélien F. A. Moumbock"},{"class":"Organization","name":"Albert-Ludwigs-Universität Freiburg"}],"name":"Zauberkugel","title":"Zauberkugel","test_results":null,"modified":"2024-06-17 13:05:32 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\nQuery ligand\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"ℹ️ Input Dataset\\nPharmacophore library\"];\n  style 1 stroke:#2c3143,stroke-width:4px;\n  2[\"Ligand ionization state generation\"];\n  0 -->|output| 2;\n  3[\"Splitting ePharmaLib into individual pharmacophores\"];\n  1 -->|output| 3;\n  4[\" Low-energy ligand conformer search\"];\n  2 -->|outfile| 4;\n  5[\"Pharmacophore alignment\"];\n  4 -->|outfile| 5;\n  3 -->|list_output_generic| 5;\n  6[\"Concatenating the pharmacophore alignment scores\"];\n  5 -->|score_result_file| 6;\n  7[\"Ranking the predicted protein targets according to the Tversky index 10th column\"];\n  6 -->|out_file1| 7;"}],"api":"https://training.galaxyproject.org/training-material/api/topics/computational-chemistry/tutorials/zauberkugel/tutorial.json","tools":["sort1","toolshed.g2.bx.psu.edu/repos/bgruening/align_it/ctb_alignit/1.0.4+galaxy0","toolshed.g2.bx.psu.edu/repos/bgruening/openbabel_addh/openbabel_addh/3.1.1+galaxy1","toolshed.g2.bx.psu.edu/repos/bgruening/rdconf/rdconf/2020.03.4+galaxy0","toolshed.g2.bx.psu.edu/repos/bgruening/split_file_to_collection/split_file_to_collection/0.5.0","toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_cat/0.1.1"],"supported_servers":{"exact":[{"url":"https://usegalaxy.cz/","name":"UseGalaxy.cz","usegalaxy":false},{"url":"https://usegalaxy.eu","name":"UseGalaxy.eu","usegalaxy":true}],"inexact":[]},"topic_name_human":"Computational chemistry","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"align_it","owner":"bgruening","revisions":"06d9381593a4","tool_panel_section_label":"ChemicalToolBox","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"openbabel_addh","owner":"bgruening","revisions":"6e4b7e0c61a6","tool_panel_section_label":"ChemicalToolBox","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"rdconf","owner":"bgruening","revisions":"5c501eb8d56c","tool_panel_section_label":"ChemicalToolBox","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"split_file_to_collection","owner":"bgruening","revisions":"6cbe2f30c2d7","tool_panel_section_label":"Collection Operations","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"text_processing","owner":"bgruening","revisions":"d698c222f354","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: align_it\n  owner: bgruening\n  revisions: 06d9381593a4\n  tool_panel_section_label: ChemicalToolBox\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: openbabel_addh\n  owner: bgruening\n  revisions: 6e4b7e0c61a6\n  tool_panel_section_label: ChemicalToolBox\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: rdconf\n  owner: bgruening\n  revisions: 5c501eb8d56c\n  tool_panel_section_label: ChemicalToolBox\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: split_file_to_collection\n  owner: bgruening\n  revisions: 6cbe2f30c2d7\n  tool_panel_section_label: Collection Operations\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: text_processing\n  owner: bgruening\n  revisions: d698c222f354\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":false,"slides_recordings":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial"}