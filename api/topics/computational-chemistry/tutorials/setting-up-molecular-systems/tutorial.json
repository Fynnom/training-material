{"layout":"tutorial_hands_on","title":"Setting up molecular systems","zenodo_link":"https://zenodo.org/record/2600690","level":"Intermediate","questions":["How to get started modelling a protein and a ligand?"],"objectives":["learn about the Protein Data Bank","learn how to set up up a model protein and ligand system (with CHARMM-GUI)","learn how to upload the system to Galaxy"],"requirements":[{"type":"internal","topic_name":"computational-chemistry","tutorials":["setting-up-molecular-systems"]}],"time_estimation":"2H","key_points":["The PDB is a key resource for finding protein structures.","Using CHARMM-GUI is one way to prepare a protein and ligand system.","To get data into Galaxy you can upload a file from your computer or paste in a web address."],"follow_up_training":[{"type":"internal","topic_name":"computational-chemistry","tutorials":["md-simulation-namd"]}],"contributors":[{"name":"Christopher Barnett","joined":"2019-05","id":"chrisbarnettster","url":"https://training.galaxyproject.org/training-material/api/contributors/chrisbarnettster.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/chrisbarnettster/"},{"name":"Simon Bray","joined":"2019-05","elixir_node":"de","former_affiliations":["uni-freiburg","elixir-europe"],"id":"simonbray","url":"https://training.galaxyproject.org/training-material/api/contributors/simonbray.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/simonbray/"},{"name":"Nadia Goué","email":"nadia.goue@uca.fr","orcid":"0000-0003-2750-1473","joined":"2019-07","id":"nagoue","url":"https://training.galaxyproject.org/training-material/api/contributors/nagoue.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/nagoue/"}],"js_requirements":{"mathjax":null,"mermaid":false},"short_id":"T00053","url":"/topics/computational-chemistry/tutorials/setting-up-molecular-systems/tutorial.html","topic_name":"computational-chemistry","tutorial_name":"setting-up-molecular-systems","dir":"topics/computational-chemistry/tutorials/setting-up-molecular-systems","symlink":null,"id":"computational-chemistry/setting-up-molecular-systems","ref_tutorials":["<p>In this tutorial, we’ll cover the basics of molecular modelling by setting up a protein in complex with a ligand and uploading the structure to Galaxy. This tutorial will make use of CHARMM-GUI. Please note that the follow-up to this tutorial (located in <a href=\"/training-material/topics/computational-chemistry/tutorials/md-simulation-namd/tutorial.html\">Running molecular dynamics simulations using NAMD</a>) requires access to NAMD Galaxy tools, which can be accessed using the <a href=\"https://github.com/scientificomputing/BRIDGE\">Docker container</a> but are currently not available on any public Galaxy server.</p>\n\n<blockquote class=\"comment\">\n  <comment-title>Audience</comment-title>\n  <p>This tutorial is intended for those who are new to the computational chemistry tools in Galaxy.</p>\n</blockquote>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n  <p>In this tutorial, we will cover:</p>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#cellulase-and-cellulose\" id=\"markdown-toc-cellulase-and-cellulose\">Cellulase and cellulose</a>    <ol>\n      <li><a href=\"#get-data\" id=\"markdown-toc-get-data\">Get data</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#modelling-with-charmm-gui\" id=\"markdown-toc-modelling-with-charmm-gui\">Modelling with CHARMM-GUI</a>    <ol>\n      <li><a href=\"#charmm\" id=\"markdown-toc-charmm\">CHARMM</a></li>\n      <li><a href=\"#namd\" id=\"markdown-toc-namd\">NAMD</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#conclusion\" id=\"markdown-toc-conclusion\">Conclusion</a></li>\n</ol>\n\n</blockquote>\n\n<h1 id=\"cellulase-and-cellulose\">Cellulase and cellulose</h1>\n\n<p>To start we’ll look at the PDB and find the entry for a fungal enzyme that cleaves cellulose. The enzyme is 7CEL, a hydrolase as seen in <a href=\"#figure-1\">the figure.</a></p>\n\n<figure id=\"figure-1\" style=\"max-width: 90%;\"><img src=\"/training-material/topics/computational-chemistry/images/enzyme.jpg\" alt=\"Snapshot of 7CEL pdb with octaose ligand. \" width=\"1200\" height=\"1200\" loading=\"lazy\" /><a target=\"_blank\" href=\"/training-material/topics/computational-chemistry/images/enzyme.jpg\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 1</strong>:</span> 7CEL Cellulase with a short chain cellulose (octaose) ligand</figcaption></figure>\n\n<p>In this section we’ll access the PDB, download the correct structure, import it and view in Galaxy.</p>\n\n<blockquote class=\"details\">\n  <details-title>Background: What is the PDB (Protein Data Bank) and format?</details-title>\n\n  <p>The Protein Data Bank (PDB) format contains atomic coordinates of biomolecules and provides a standard representation for macromolecular structure data derived from X-ray diffraction and NMR studies. Each structure is stored under a four-letter accession code. For example, the PDB file we will use is assigned the code <a href=\"https://www.rcsb.org/pdb/explore/explore.do?structureId=7CEL\">7CEL</a>).</p>\n\n  <p>More resources:</p>\n\n  <ul>\n    <li>Multiple structures are stored and can be queried at <a href=\"https://www.rcsb.org/\">https://www.rcsb.org/</a></li>\n    <li>Documentation describing the PDB file format is available from the wwPDB at <a href=\"http://www.wwpdb.org/documentation/file-format.php\">http://www.wwpdb.org/documentation/file-format.php</a>.</li>\n  </ul>\n</blockquote>\n\n<blockquote class=\"details\">\n  <details-title>Background: Why choose a cellulase?</details-title>\n\n  <p>Using enzymes to break down abundant cellulose into disaccharide units (cellobiose) is a method to optimise the\nbiofuel process. <span class=\"citation\"><a href=\"#barnett11\">Barnett <i>et al.</i> 2011</a></span></p>\n\n  <p>More resources:</p>\n\n  <ul>\n    <li><a href=\"https://en.wikipedia.org/wiki/Cellulase\">https://en.wikipedia.org/wiki/Cellulase</a></li>\n    <li><a href=\"https://en.wikipedia.org/wiki/Biofuel\">https://en.wikipedia.org/wiki/Biofuel</a></li>\n    <li><span class=\"citation\"><a href=\"#Payne_2015\">Payne <i>et al.</i> 2015</a></span></li>\n    <li><span class=\"citation\"><a href=\"#Barnett_2010\">Barnett <i>et al.</i> 2010</a></span></li>\n  </ul>\n</blockquote>\n\n<h2 id=\"get-data\">Get data</h2>\n\n<p>The 7CEL <a href=\"https://files.rcsb.org/download/7CEL.pdb\">PDB</a> does not include a complete 8 unit substrate and some modelling is required. The correctly modelled substrate is provided for this tutorial.</p>\n<blockquote class=\"details\">\n  <details-title>More details about the modelling done</details-title>\n  <ul>\n    <li>VMD (visualisation software) was used for atomic placement and CHARMM was used for energy minimisation.</li>\n    <li>The PDB structure contains a mutation at position 217 (glumatate to glutamine). Our structure reverses this.</li>\n    <li>The ligand was modelled separately and inserted into the binding site.</li>\n  </ul>\n\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Data upload</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Create a new history for this tutorial.</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-new-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-new-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a new history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>Click the <i class=\"fas fa-plus\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">new-history</span> icon at the top of the history panel:</p>   <p><img src=\"/training-material/shared/images/history_create_new.svg\" alt=\"UI for creating new history\" /></p>   <!-- the original drawing can be found here https://docs.google.com/drawings/d/1cCBrLAo4kDGic5QyB70rRiWJAKTenTU8STsKDaLcVU8/edit?usp=sharing --> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Import the files from the Zenodo link provided.</p>\n\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/2600690/files/7cel_modeled.pdb?download=1\n</code></pre></div>      </div>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-via-links\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-via-links\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing via links</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-data-from-a-data-library\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-data-from-a-data-library\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing data from a data library</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>As an alternative to uploading the data from a URL or your computer, the files may also have been made available from a <em>shared data library</em>:</p>   <ol>   <li>Go into <strong>Shared data</strong> (top panel) then <strong>Data libraries</strong></li>   <li>Navigate to  the correct folder as indicated by your instructor.     <ul>       <li>On most Galaxies tutorial data will be provided in a folder named <strong>GTN - Material –&gt; Topic Name -&gt; Tutorial Name</strong>.</li>     </ul>   </li>   <li>Select the desired files</li>   <li>Click on <strong>Add to History</strong> <i class=\"fas fa-caret-down\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-dropdown</span> near the top and select <strong>as Datasets</strong> from the dropdown menu</li>   <li>     <p>In the pop-up window, choose</p>     <ul>       <li><em>“Select history”</em>: the history you want to import the data to (or create a new one)</li>     </ul>   </li>   <li>Click on <strong>Import</strong></li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>Rename the datasets.</li>\n    <li>\n      <p>Check that the datatype is correct. The file should have the PDB datatype.</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-changing-the-datatype\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-changing-the-datatype\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Changing the datatype</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, click <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Datatypes</strong> tab on the top</li>   <li>In the <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Assign Datatype</strong>, select <code class=\"language-plaintext highlighter-rouge\">pdb</code> from “<em>New type</em>” dropdown     <ul>       <li>Tip: you can start typing the datatype into the field to filter the dropdown menu</li>     </ul>   </li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h1 id=\"modelling-with-charmm-gui\">Modelling with CHARMM-GUI</h1>\n<p>It is convenient to set up the molecular system outside Galaxy using a tool such as CHARMM-GUI. Alternative methods are possible - see the <a href=\"/training-material/topics/computational-chemistry/tutorials/md-simulation-gromacs/tutorial.html\">GROMACS tutorial</a> for an example. <span class=\"citation\"><a href=\"#jo17\">Jo <i>et al.</i> 2016</a></span></p>\n\n<blockquote class=\"tip\">\n  <tip-title>Viewing figures</tip-title>\n  <ul>\n    <li>Some of the figures are screenshots and it may be difficult to make out details</li>\n    <li>Right-click on the image and choose ‘Open image in new tab’ to view</li>\n    <li>Zoom in and out as needed to see the content</li>\n  </ul>\n</blockquote>\n\n<figure id=\"figure-2\" style=\"max-width: 90%;\"><img src=\"/training-material/topics/computational-chemistry/images/charmmgui.png\" alt=\"CHARMM-GUI interface. \" width=\"2551\" height=\"1435\" loading=\"lazy\" /><a target=\"_blank\" href=\"/training-material/topics/computational-chemistry/images/charmmgui.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 2</strong>:</span> The CHARMM-GUI interface</figcaption></figure>\n\n<p>Go to the correct section depending on which MD engine you will be using.</p>\n\n<h2 id=\"charmm\">CHARMM</h2>\n\n<h3 id=\"upload-the-pdb-to-charmm-gui\">Upload the PDB to CHARMM-GUI</h3>\n<p><a href=\"http://www.charmm-gui.org/?doc=input/pdbreader\">Navigate to CHARMM-GUI</a> and use the Input Generator, specifically the PDB Reader tool and upload the Cellulase PDB file. Press ‘Next Step: Select Model/Chain’ in the bottom right corner.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Upload the PDB to CHARMM-GUI</hands-on-title>\n\n  <ol>\n    <li>Retrieve the modelled PDB structure from <a href=\"https://doi.org/10.5281/zenodo.2600690\">Zenodo</a>.</li>\n    <li>Upload the PDB and choose CHARMM format.</li>\n  </ol>\n  <figure id=\"figure-3\" style=\"max-width: 90%;\"><img src=\"/training-material/topics/computational-chemistry/images/charmmgui-reader.png\" alt=\"Snapshot of CHARMM-GUI PDB reader section. \" width=\"2546\" height=\"979\" loading=\"lazy\" /><a target=\"_blank\" href=\"/training-material/topics/computational-chemistry/images/charmmgui-reader.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 3</strong>:</span> The CHARMM-GUI PDB Reader tool</figcaption></figure>\n</blockquote>\n\n<h3 id=\"select-both-protein-and-ligand-models\">Select both protein and ligand models</h3>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Generate PDB file</hands-on-title>\n  <p>Two model chains are presented for selection: the protein (PROA) and the hetero residue, which is the ligand or glycan in this case (HETA). Select both, and press ‘Next Step: Generate PDB’ in the bottom right corner.</p>\n  <figure id=\"figure-4\" style=\"max-width: 90%;\"><img src=\"/training-material/topics/computational-chemistry/images/charmmgui-modelchain.png\" alt=\"Snapshot of CHARMM-GUI model section. \" width=\"2555\" height=\"864\" loading=\"lazy\" /><a target=\"_blank\" href=\"/training-material/topics/computational-chemistry/images/charmmgui-modelchain.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 4</strong>:</span> Select both ligand and protein models in CHARMM-GUI</figcaption></figure>\n</blockquote>\n\n<h3 id=\"manipulate-the-system\">Manipulate the system</h3>\n<blockquote class=\"hands_on\">\n  <hands-on-title>Make necessary modifications</hands-on-title>\n  <p>Rename the hetero chain to BGLC and add ten disulfide bonds to the protein, as shown in the figure. Then press ‘Next Step: Generate PDB’ in the bottom right corner.</p>\n  <figure id=\"figure-5\" style=\"max-width: 90%;\"><img src=\"/training-material/topics/computational-chemistry/images/charmmgui-manipulate.png\" alt=\"Snapshot of CHARMM-GUI renaming section. \" width=\"2143\" height=\"1373\" loading=\"lazy\" /><a target=\"_blank\" href=\"/training-material/topics/computational-chemistry/images/charmmgui-manipulate.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 5</strong>:</span> Rename the chains in CHARMM-GUI</figcaption></figure>\n</blockquote>\n\n<h3 id=\"download-the-output\">Download the output</h3>\n<blockquote class=\"hands_on\">\n  <hands-on-title>Download CHARMM output</hands-on-title>\n  <p>The output is a .tgz file (a tarball or zipped tarball). Inside the archive you will see all inputs and outputs from CHARMM-GUI.</p>\n  <figure id=\"figure-6\" style=\"max-width: 90%;\"><img src=\"/training-material/topics/computational-chemistry/images/charmmgui-charmmoutput.png\" alt=\"Snapshot of CHARMM-GUI CHARMM output section. \" width=\"2560\" height=\"1215\" loading=\"lazy\" /><a target=\"_blank\" href=\"/training-material/topics/computational-chemistry/images/charmmgui-charmmoutput.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 6</strong>:</span> CHARMM output from CHARMM-GUI</figcaption></figure>\n</blockquote>\n\n<blockquote class=\"tip\">\n  <tip-title>What is a .tgz file?</tip-title>\n\n  <p>This is a compressed file which contains all the output files created by the CHARMM-GUI. To access them, the .tgz file needs to be decompressed. There should be a tool available on your operating system for this. If you prefer to use the command line, tar will work fine on Linux or Mac <code class=\"language-plaintext highlighter-rouge\">tar -zxvf example.tgz</code>. On Windows use <a href=\"https://www.7-zip.org/download.html\">7zip</a>, or download Git for windows and use Git Bash.</p>\n</blockquote>\n\n<h3 id=\"upload-to-galaxy\">Upload to Galaxy</h3>\n<blockquote class=\"hands_on\">\n  <hands-on-title>Upload files to Galaxy</hands-on-title>\n  <p>Upload the step1_pdbreader.psf and step1_pdbreader.crd files to your Galaxy instance and run the system setup tool.</p>\n</blockquote>\n\n<h2 id=\"namd\">NAMD</h2>\n\n<h3 id=\"upload-the-pdb-to-charmm-gui-1\">Upload the PDB to CHARMM-GUI</h3>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Upload the PDB to CHARMM-GUI</hands-on-title>\n  <p>Retrieve the modelled PDB structure from <a href=\"https://doi.org/10.5281/zenodo.2600690\">Zenodo</a>.\n<a href=\"http://www.charmm-gui.org/?doc=input/mdsetup\">Navigate to CHARMM-GUI</a> and use the Input Generator, specifically the Solution Builder tool. Upload the PDB file, selecting ‘CHARMM’ as the file format. Press ‘Next Step: Select Model/Chain’ in the bottom right corner.</p>\n  <figure id=\"figure-7\" style=\"max-width: 90%;\"><img src=\"/training-material/topics/computational-chemistry/images/charmmgui-mdsimulator-solution-builder.png\" alt=\"Snapshot of CHARMM-GUI Solution Builder tool . \" width=\"1901\" height=\"962\" loading=\"lazy\" /><a target=\"_blank\" href=\"/training-material/topics/computational-chemistry/images/charmmgui-mdsimulator-solution-builder.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 7</strong>:</span> The CHARMM-GUI Solution Builder tool</figcaption></figure>\n</blockquote>\n\n<h3 id=\"select-both-protein-and-ligand-models-1\">Select both protein and ligand models</h3>\n<blockquote class=\"hands_on\">\n  <hands-on-title>Generate PDB file</hands-on-title>\n  <p>Two model chains are presented for selection: the protein (PROA) and the hetero residue, which is the ligand or glycan in this case (HETA). Select both, and press ‘Next Step: Generate PDB’ in the bottom right corner.</p>\n  <figure id=\"figure-8\" style=\"max-width: 90%;\"><img src=\"/training-material/topics/computational-chemistry/images/charmmgui-modelchain.png\" alt=\"Snapshot of CHARMM-GUI model section. \" width=\"2555\" height=\"864\" loading=\"lazy\" /><a target=\"_blank\" href=\"/training-material/topics/computational-chemistry/images/charmmgui-modelchain.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 8</strong>:</span> Select both ligand and protein models in CHARMM-GUI</figcaption></figure>\n</blockquote>\n\n<h3 id=\"manipulate-the-system-1\">Manipulate the system</h3>\n<blockquote class=\"hands_on\">\n  <hands-on-title>Make necessary modifications</hands-on-title>\n  <p>Rename the hetero chain to BGLC and add disulfide bonds.Press ‘Next Step: Generate PDB’ in the bottom right corner.</p>\n  <figure id=\"figure-9\" style=\"max-width: 90%;\"><img src=\"/training-material/topics/computational-chemistry/images/charmmgui-manipulate.png\" alt=\"Snapshot of CHARMM-GUI renaming section. \" width=\"2143\" height=\"1373\" loading=\"lazy\" /><a target=\"_blank\" href=\"/training-material/topics/computational-chemistry/images/charmmgui-manipulate.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 9</strong>:</span> Rename the chains in CHARMM-GUI</figcaption></figure>\n</blockquote>\n\n<h3 id=\"set-up-the-waterbox-and-add-ions\">Set up the waterbox and add ions</h3>\n<blockquote class=\"hands_on\">\n  <hands-on-title>Solvate the protein</hands-on-title>\n  <p>Set up a waterbox. Use a size of 10 angstroms and choose a cubic box (‘rectangular’ option).</p>\n  <figure id=\"figure-10\" style=\"max-width: 90%;\"><img src=\"/training-material/topics/computational-chemistry/images/charmm-gui-waterbox-from-solution-builder.png\" alt=\"Snapshot of CHARMM-GUI waterbox section. \" width=\"1905\" height=\"864\" loading=\"lazy\" /><a target=\"_blank\" href=\"/training-material/topics/computational-chemistry/images/charmm-gui-waterbox-from-solution-builder.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 10</strong>:</span> Setting up a waterbox in CHARMM-GUI</figcaption></figure>\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>Why is 10 angstrom a fair choice for the buffer?  Why choose 0.15M NaCl?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n    <p>Under periodic boundary conditions, we need to ensure the protein can never interact with its periodic image, otherwise artefacts are introduced. Allowing 10 angstroms between the protein and the box edge ensures the two images will always be at minimum 20 angstroms apart, which is sufficient.</p>\n\n    <p>Some of the residues on the protein surface are charged and counter-ions need to be present nearby to neutralise them. Failure to explicitly model salt ions may destabilise the protein.</p>\n  </blockquote>\n</blockquote>\n\n<h3 id=\"generate-the-fft-automatically\">Generate the FFT automatically</h3>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Generate the FFT</hands-on-title>\n  <p>Particle Mesh Ewald (PME) summation is the method being used to calculate long-range interactions in this system. To improve the computational time a Fast Fourier Transform (FFT) is used. A detailed discussion of FFT will not be presented here; there are many articles on the subject. Try <a href=\"https://en.wikipedia.org/wiki/Ewald_summation\">Wikipedia</a> and <span class=\"citation\"><a href=\"#Toukmaji_1996\">Toukmaji and Board 1996</a></span>.</p>\n  <figure id=\"figure-11\" style=\"max-width: 90%;\"><img src=\"/training-material/topics/computational-chemistry/images/charmmgui-fft.png\" alt=\"Snapshot of CHARMM-GUI FFT section. \" width=\"2555\" height=\"1189\" loading=\"lazy\" /><a target=\"_blank\" href=\"/training-material/topics/computational-chemistry/images/charmmgui-fft.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 11</strong>:</span> Setting up a FFT in CHARMM-GUI</figcaption></figure>\n</blockquote>\n\n<h3 id=\"download-the-output-1\">Download the output</h3>\n<blockquote class=\"hands_on\">\n  <hands-on-title>Solvate the protein</hands-on-title>\n  <p>The output is a .tgz file (a tarball or zipped tarball). Inside the archive you will see all inputs and outputs from CHARMM-GUI.</p>\n  <figure id=\"figure-12\" style=\"max-width: 90%;\"><img src=\"/training-material/topics/computational-chemistry/images/charmmgui-namdoutput.png\" alt=\"Snapshot of CHARMM-GUI NAMD output section. \" width=\"2560\" height=\"1161\" loading=\"lazy\" /><a target=\"_blank\" href=\"/training-material/topics/computational-chemistry/images/charmmgui-namdoutput.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 12</strong>:</span> NAMD output from CHARMM-GUI</figcaption></figure>\n</blockquote>\n\n<blockquote class=\"tip\">\n  <tip-title>What is a .tgz file?</tip-title>\n\n  <p>This is a compressed file and needs to be uncompressed using the correct tool.\nOn Linux or Mac: tar will work fine <code class=\"language-plaintext highlighter-rouge\">tar -zxvf example.tgz</code>.\nOn Windows use <a href=\"https://www.7-zip.org/download.html\">7zip</a> or download Git for windows and use Git Bash.</p>\n</blockquote>\n\n<h3 id=\"upload-to-galaxy-1\">Upload to Galaxy</h3>\n<blockquote class=\"hands_on\">\n  <hands-on-title>Upload files to Galaxy</hands-on-title>\n  <p>Upload the following files to your Galaxy instance and ensure the correct datatype is selected:</p>\n  <ul>\n    <li>step3_pbcsetup.psf -&gt; xplor psf input (psf format)</li>\n    <li>step3_pbcsetup.pdb -&gt; pdb input (pdb format)</li>\n    <li>Checkfft.str -&gt; PME grid specs (txt format)</li>\n    <li>step2.1_waterbox.prm -&gt; waterbox prm input (txt format)</li>\n  </ul>\n</blockquote>\n\n<p>You are now ready to run the NAMD workflow, which is discussed in another <a href=\"/training-material/topics/computational-chemistry/tutorials/md-simulation-namd/tutorial.html\">tutorial</a>.</p>\n\n<h1 id=\"conclusion\">Conclusion</h1>\n\n<p><i class=\"fas fa-trophy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">trophy</span> Well done! You have started modelling a cellulase protein and uploaded it into Galaxy. The next step is running molecular dynamics simulations (<a href=\"/training-material/topics/computational-chemistry/tutorials/md-simulation-namd/tutorial.html\">tutorial</a>)</p>\n"],"ref_slides":[],"hands_on":true,"slides":false,"mod_date":"2023-11-03 14:30:27 +0000","pub_date":"2019-06-03 07:41:49 +0000","version":30,"api":"https://training.galaxyproject.org/training-material/api/topics/computational-chemistry/tutorials/setting-up-molecular-systems/tutorial.json","tools":[],"supported_servers":{"exact":[],"inexact":[{"name":"UseGalaxy.eu","url":"https://usegalaxy.eu","id":"eu","human":"Galaxy Europe","usegalaxy":true},{"name":"UseGalaxy.org","url":"https://usegalaxy.org","id":"us","human":"Galaxy Main","usegalaxy":true},{"name":"UseGalaxy.org.au","url":"https://usegalaxy.org.au","id":"au","human":"Galaxy Australia","usegalaxy":true},{"name":"UseGalaxy.fr","url":"https://usegalaxy.fr","id":"fr","human":"Galaxy France","usegalaxy":true}]},"topic_name_human":"Computational chemistry","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools: []\n","tours":false,"video":false,"slides_recordings":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial"}