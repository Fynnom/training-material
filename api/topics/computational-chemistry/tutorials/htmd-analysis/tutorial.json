{"layout":"tutorial_hands_on","title":"High Throughput Molecular Dynamics and Analysis","level":"Advanced","zenodo_link":"https://zenodo.org/records/3813283","questions":["How are protein-ligand systems parameterized for molecular dynamics simulation?","What kind of analysis can be carried out on molecular trajectories?","How can high-throughput MD be used to study multiple ligands?"],"objectives":["Learn about force-fields and MD parameterization","Learn how to conduct MD simulation and analysis for a protein-ligand system","Understand how different molecular interactions contribute to the binding affinity of various ligands for the Hsp90 protein."],"time_estimation":"3H","key_points":["Simulating protein-ligand systems is more complex than simply simulating protein-only systems.","There are a range of Galaxy tools for MD simulation (using GROMACS) and analysis.","Galaxy makes assembling and scaling up workflows for high-throughput MD straightforward for users."],"contributors":[{"name":"Simon Bray","joined":"2019-05","elixir_node":"de","former_affiliations":["uni-freiburg","elixir-europe"],"id":"simonbray","url":"https://training.galaxyproject.org/training-material/api/contributors/simonbray.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/simonbray/"},{"name":"Tharindu Senapathi","joined":"2019-05","id":"tsenapathi","url":"https://training.galaxyproject.org/training-material/api/contributors/tsenapathi.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/tsenapathi/"},{"name":"Christopher Barnett","joined":"2019-05","id":"chrisbarnettster","url":"https://training.galaxyproject.org/training-material/api/contributors/chrisbarnettster.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/chrisbarnettster/"},{"name":"Björn Grüning","email":"bjoern.gruening@gmail.com","twitter":"bjoerngruening","fediverse":"https://fosstodon.org/@bgruening","fediverse_flavor":"mastodon","matrix":"bgruening:matrix.org","orcid":"0000-0002-3079-6586","elixir_node":"de","linkedin":"bgruening","contact_for_training":true,"joined":"2017-09","location":{"country":"DE","lat":47.997791,"lon":7.842609},"affiliations":["eurosciencegateway","eosc-life","by-covid","deNBI","sfb992","elixir-converge","uni-freiburg","elixir-europe"],"id":"bgruening","url":"https://training.galaxyproject.org/training-material/api/contributors/bgruening.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/bgruening/"}],"recordings":[{"captioners":["simonbray"],"date":"2021-02-15","galaxy_version":"21.01","length":"1H40M","youtube_id":"LjW3nES04bI","speakers":["simonbray","chrisbarnettster"]}],"js_requirements":{"mathjax":null,"mermaid":false},"short_id":"T00050","url":"/topics/computational-chemistry/tutorials/htmd-analysis/tutorial.html","topic_name":"computational-chemistry","tutorial_name":"htmd-analysis","dir":"topics/computational-chemistry/tutorials/htmd-analysis","symlink":null,"id":"computational-chemistry/htmd-analysis","ref_tutorials":["<p>This tutorial provides an introduction to using high-throughput molecular dynamics to study protein-ligand interaction, as applied to the N-terminal domain of Hsp90 (heat shock protein 90).</p>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n  <p>In this tutorial, we will cover:</p>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#background\" id=\"markdown-toc-background\">Background</a>    <ol>\n      <li><a href=\"#what-is-high-throughput-molecular-dynamics\" id=\"markdown-toc-what-is-high-throughput-molecular-dynamics\">What is high-throughput molecular dynamics?</a></li>\n      <li><a href=\"#why-is-hsp90-interesting-to-study\" id=\"markdown-toc-why-is-hsp90-interesting-to-study\">Why is Hsp90 interesting to study?</a></li>\n      <li><a href=\"#get-data\" id=\"markdown-toc-get-data\">Get data</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#simulation\" id=\"markdown-toc-simulation\">Simulation</a>    <ol>\n      <li><a href=\"#topology-generation\" id=\"markdown-toc-topology-generation\">Topology generation</a></li>\n      <li><a href=\"#combine-topology-and-gro-files\" id=\"markdown-toc-combine-topology-and-gro-files\">Combine topology and GRO files</a></li>\n      <li><a href=\"#create-the-simulation-box\" id=\"markdown-toc-create-the-simulation-box\">Create the simulation box</a></li>\n      <li><a href=\"#solvation\" id=\"markdown-toc-solvation\">Solvation</a></li>\n      <li><a href=\"#energy-minimization\" id=\"markdown-toc-energy-minimization\">Energy minimization</a></li>\n      <li><a href=\"#equilibration\" id=\"markdown-toc-equilibration\">Equilibration</a></li>\n      <li><a href=\"#production-simulation\" id=\"markdown-toc-production-simulation\">Production simulation</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#analysis\" id=\"markdown-toc-analysis\">Analysis</a>    <ol>\n      <li><a href=\"#create-pdb-file-needed-by-most-analysis-tools\" id=\"markdown-toc-create-pdb-file-needed-by-most-analysis-tools\">Create PDB file needed by most analysis tools</a></li>\n      <li><a href=\"#convert-trajectory-to-dcd-format\" id=\"markdown-toc-convert-trajectory-to-dcd-format\">Convert trajectory to DCD format</a></li>\n      <li><a href=\"#rmsd-analysis---protein\" id=\"markdown-toc-rmsd-analysis---protein\">RMSD analysis - protein</a></li>\n      <li><a href=\"#rmsf-analysis\" id=\"markdown-toc-rmsf-analysis\">RMSF analysis</a></li>\n      <li><a href=\"#pca-analysis\" id=\"markdown-toc-pca-analysis\">PCA analysis</a></li>\n      <li><a href=\"#hydrogen-bond-analysis\" id=\"markdown-toc-hydrogen-bond-analysis\">Hydrogen bond analysis</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#optional-automating-high-throughput-calculations\" id=\"markdown-toc-optional-automating-high-throughput-calculations\">Optional: Automating high throughput calculations</a></li>\n  <li><a href=\"#conclusion\" id=\"markdown-toc-conclusion\">Conclusion</a></li>\n  <li><a href=\"#glossary-and-abbreviations\" id=\"markdown-toc-glossary-and-abbreviations\">Glossary and abbreviations</a></li>\n</ol>\n\n</blockquote>\n\n<h1 id=\"background\">Background</h1>\n\n<h2 id=\"what-is-high-throughput-molecular-dynamics\">What is high-throughput molecular dynamics?</h2>\n<p>Molecular dynamics (MD) is a method to simulate molecular motion by iterative application of Newton’s laws of motion. It is often applied to large biomolecules such as proteins or nucleic acids. A common application is to assess the interaction between these macromolecules and a number of small molecules (e.g. potential drug candidates). This tutorial provides a guide to setting up and running a high-throughput workflow for screening multiple small molecules, using the open-source GROMACS tools provided through the Galaxy platform. Following simulation, the trajectory data is analyzed using a range of tools to investigate structural properties and correlations over time.</p>\n\n<h2 id=\"why-is-hsp90-interesting-to-study\">Why is Hsp90 interesting to study?</h2>\n<p>The 90 kDa heat shock protein (Hsp90) is a chaperone protein responsible for catalyzing the conversion of a wide variety of proteins to a functional form; examples of the Hsp90 clientele, which totals several hundred proteins, include nuclear steroid hormone receptors and protein kinases (<span class=\"citation\"><a href=\"#Pearl2006\">Pearl and Prodromou 2006</a></span>). The mechanism by which Hsp90 acts varies between clients, as does the client binding site; the process is dependent on post-translational modifications of Hsp90 and the identity of co-chaperones which bind and regulate the conformational cycle (<span class=\"citation\"><a href=\"#Schopf2017\">Schopf <i>et al.</i> 2017</a></span>).</p>\n\n<p>Due to its vital biochemical role as a chaperone protein involved in facilitating the folding of many client proteins, Hsp90 is an attractive pharmaceutical target. In particular, as protein folding is a potential bottleneck to cellular reproduction and growth, blocking Hsp90 function using inhibitors which bind tightly to the ATP binding site of the NTD could assist in treating cancer; for example, the antibiotic geldanamycin and its analogs are under investigation as possible anti-tumor agents (<span class=\"citation\"><a href=\"#Stebbins1997\">Stebbins <i>et al.</i> 1997</a></span>, <span class=\"citation\"><a href=\"#Hermane2019\">Hermane <i>et al.</i> 2019</a></span>).</p>\n\n<p>In the structure which will be examined during this tutorial, the ligand of concern is a resorcinol, a common class of compounds with affinity for the Hsp90 N-terminal domain. It is registered in the PubChem database under the compound ID 135508238 (<span class=\"citation\"><a href=\"#ligand_resorcinol\">PubChem</a></span>). As can be seen by viewing the PDB structure, the resorcinol part of the structure is embedded in the binding site, bound by a hydrogen bond to residue aspartate-93. The ligand structure also contains a triazole and a fluorophenyl ring, which lie nearer to the surface of the protein.</p>\n\n<figure id=\"figure-1\" style=\"max-width: 90%;\"><img src=\"/training-material/topics/computational-chemistry/images/hsp90lig.png\" alt=\"Image showing Hsp90 structure, with a ligand bound. \" width=\"677\" height=\"562\" loading=\"lazy\" /><a target=\"_blank\" href=\"/training-material/topics/computational-chemistry/images/hsp90lig.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 1</strong>:</span> Structure of Hsp90, with a ligand bound. <a href=\"https://usegalaxy.eu/u/sbray/v/hsp90-lig\">Click to view</a> in NGL. (<span class=\"citation\"><a href=\"#ngl\">Rose <i>et al.</i> 2018</a></span>)</figcaption></figure>\n\n<h2 id=\"get-data\">Get data</h2>\n\n<p>As a first step, we create a new Galaxy history and then we download a crystal structure for the Hsp90 protein from the Protein Data Bank (PDB). The structure is provided under accession code <code class=\"language-plaintext highlighter-rouge\">6HHR</code> (<span class=\"citation\"><a href=\"#Schuetz2018\">Schuetz <i>et al.</i> 2018</a></span>) and shows Hsp90 in complex with a ligand belonging to the resorcinol class.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Data upload</hands-on-title>\n\n  <ol>\n    <li>Create a new history for this tutorial</li>\n    <li>Search Galaxy for the <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/get_pdb/get_pdb/0.1.0\" title=\"Get PDB tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Get PDB</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.1.0)</span> tool. Request the accession code <code class=\"language-plaintext highlighter-rouge\">6hhr</code>.</li>\n    <li>Rename the dataset to ‘Hsp90 structure’</li>\n    <li>\n      <p>Check that the datatype is correct (PDB file).</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-changing-the-datatype\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-changing-the-datatype\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Changing the datatype</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, click <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Datatypes</strong> tab on the top</li>   <li>In the <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Assign Datatype</strong>, select <code class=\"language-plaintext highlighter-rouge\">datatypes</code> from “<em>New type</em>” dropdown     <ul>       <li>Tip: you can start typing the datatype into the field to filter the dropdown menu</li>     </ul>   </li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h1 id=\"simulation\">Simulation</h1>\n\n<h2 id=\"topology-generation\">Topology generation</h2>\n\n<p>Now we have downloaded a PDB structure of the protein we wish to study, we will start preparing it for MD simulation; this process may also be referred to as parameterization or topology generation.</p>\n\n<p>GROMACS distinguishes between constant and dynamic attributes of the atoms in the system. The constant attributes (e.g. atom charges, bonds connecting atoms) are listed in the topology (TOP file), while dynamic attributes (attributes that can change during a simulation, e.g. atom position, velocities and forces) are stored in structure (PDB or GRO) and trajectory (XTC and TRR) files.</p>\n\n<p>The PDB file we start from only explicitly states atom element (i.e.carbon, oxygen, and so on) and 3D Cartesian coordinates of each atom; additionally, it will usually not include hydrogen atoms. Therefore, before beginning simulation, we need to calculate the rest of the information contained within the topology file. Parameterization needs to be done separately for the ligand and protein. Therefore, the first step is to separate the PDB file into two sets of coordinates - one for the ligand and one for the protein.</p>\n\n<h3 id=\"extract-protein-and-ligand-coordinates\">Extract protein and ligand coordinates</h3>\n\n<p>Parameterization needs to be done separately for the ligand and protein. Therefore, the first step is to separate the PDB file into two sets of coordinates - one for the ligand and one for the protein. Here, we can make use of the simple text manipulation tools integrated into Galaxy.</p>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>Why do protein and ligand need to be parameterized separately?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>Protein and small molecules are constructed differently. A protein is made up of 20 different building blocks (amino acids) - therefore, to construct a protein topology, amino acid topologies simply need to be combined appropriately. By contrast, the structure of small molecules is far more flexible and needs to be calculated for each different structure.</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Separate protein and ligand coordinates</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_grep_tool/1.1.1\" title=\"Search in textfiles (grep) tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Search in textfiles (grep)</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.1.1)</span> with the following parameters:\n      <ul>\n        <li><em>“Select lines from”</em>: ‘Hsp90 structure’</li>\n        <li><em>“that”</em>: <code class=\"language-plaintext highlighter-rouge\">Don't Match</code></li>\n        <li><em>“Regular Expression”</em>: <code class=\"language-plaintext highlighter-rouge\">HETATM</code></li>\n      </ul>\n    </li>\n    <li>Rename output to ‘Protein (PDB)’</li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_grep_tool/1.1.1\" title=\"Search in textfiles (grep) tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Search in textfiles (grep)</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.1.1)</span> with the following parameters:\n      <ul>\n        <li><em>“Select lines from”</em>: ‘Hsp90 structure’</li>\n        <li><em>“that”</em>: <code class=\"language-plaintext highlighter-rouge\">Match</code></li>\n        <li><em>“Regular Expression”</em>: <code class=\"language-plaintext highlighter-rouge\">AG5E</code></li>\n      </ul>\n    </li>\n    <li>Rename output to ‘Ligand (PDB)’</li>\n  </ol>\n\n</blockquote>\n\n<p>Here, we simply filter the original PDB twice: once for lines which do not match <code class=\"language-plaintext highlighter-rouge\">HETATM</code>, which returns a PDB file containing only protein, not ligand and solvent; and once for lines which match the ligand’s identity code <code class=\"language-plaintext highlighter-rouge\">AG5E</code>, which returns a PDB file containing only the ligand.</p>\n\n<p>If you inspect the PDB file, you will see that two different ligands are listed: <code class=\"language-plaintext highlighter-rouge\">AG5E</code> and <code class=\"language-plaintext highlighter-rouge\">BG5E</code>. These are the same compound (<code class=\"language-plaintext highlighter-rouge\">G5E</code>); they refer to two possible conformations it could adopt, both of which would be compatible with the crystallographic data. We choose to take the coordinates from <code class=\"language-plaintext highlighter-rouge\">AG5E</code> for our simulations, though you could just as well enter <code class=\"language-plaintext highlighter-rouge\">BG5E</code> instead. For the purpose of this tutorial, you should consider this as a minor technical detail arising from the nature of protein crystallography.</p>\n\n<h3 id=\"set-up-protein-topology\">Set up protein topology</h3>\n\n<p>Firstly, we need to calculate the topology for the protein file. We will use the <strong>GROMACS initial setup</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> tool.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Generate protein topology</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/chemteam/gmx_setup/gmx_setup/2020.4+galaxy0\" title=\"GROMACS initial setup tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>GROMACS initial setup</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2020.4+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><em>“PDB input file”</em>: ‘Protein (PDB)’ file</li>\n        <li><em>“Force field”</em>: <code class=\"language-plaintext highlighter-rouge\">AMBER99SB</code></li>\n        <li><em>“Water model”</em>: <code class=\"language-plaintext highlighter-rouge\">TIP3P</code></li>\n        <li><em>“Generate detailed log”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n      </ul>\n\n      <blockquote class=\"comment\">\n        <comment-title></comment-title>\n        <p>A force field is essentially a function to calculate the potential energy of a system, based on various empirical parameters (for the atoms, bonds, charges, dihedral angles and so on). There are a number of families of forcefields; some of the most commonly used include CHARMM, AMBER, GROMOS and OpenFF (for a recent, accessible overview see (<span class=\"citation\"><a href=\"#Lemkul2020\">Lemkul 2020</a></span>).</p>\n\n        <p>A wide range of models exist for modeling water. Here we are using the common TIP3P model, which is an example of a ‘three-site model’ - so-called because the molecule is modeled using three points, corresponding to the three atoms of water. (Four- and five-site models include additional ‘dummy atoms’ representing the negative charges of the lone pairs of the oxygen atom).</p>\n      </blockquote>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>The tool produces four outputs: a GRO file (containing the coordinates of the protein), a TOP file (containing other information, including on charges, masses, bonds and angles), an ITP file (which will be used to restrain the protein position in the equilibration step later on), and a log for the tool.</p>\n\n<p>Please note all GROMACS tools output a log. Generally, you only need to look at this when a job fails. These provide useful information for debugging if we encounter any problems.</p>\n\n<h3 id=\"generate-a-topology-for-the-ligand\">Generate a topology for the ligand</h3>\n\n<p>To generate a topology for the ligand, we will use the <strong>acpype</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> tool (<span class=\"citation\"><a href=\"#SousadaSilva2012\">da Silva and Vranken 2012</a></span>). This provides a convenient interface to the AmberTools suite and allows us to easily create the ligand topology in the format required by GROMACS.</p>\n\n<p>Inspecting the contents of the <code class=\"language-plaintext highlighter-rouge\">Ligand (PDB)</code> file shows that it contains no hydrogen atoms. These need to be added before the topology can be calculated. The <strong>Compound conversion</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> (which is based on OpenBabel) can be used to achieve this.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Generate ligand topology</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/openbabel_compound_convert/openbabel_compound_convert/3.1.1+galaxy0\" title=\"Compound conversion tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Compound conversion</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 3.1.1+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><em>“Molecular input file”</em>: ‘Ligand (PDB)’</li>\n        <li><em>“Output format”</em>: <code class=\"language-plaintext highlighter-rouge\">Protein Data Bank format (pdb)</code></li>\n        <li><em>“Add hydrogens appropriate for pH”</em>: <code class=\"language-plaintext highlighter-rouge\">7.0</code></li>\n      </ul>\n    </li>\n    <li>Rename the output file to <code class=\"language-plaintext highlighter-rouge\">Hydrated ligand (PDB)</code>.</li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/chemteam/ambertools_acpype/ambertools_acpype/21.3+galaxy0\" title=\"Generate MD topologies for small molecules tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Generate MD topologies for small molecules</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 21.3+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><em>“Input file”</em>: ‘Hydrated ligand (PDB)’</li>\n        <li><em>“Charge of the molecule”</em>: <code class=\"language-plaintext highlighter-rouge\">0</code></li>\n        <li><em>“Multiplicity”</em>: <code class=\"language-plaintext highlighter-rouge\">1</code></li>\n        <li><em>“Force field to use for parameterization”</em>: <code class=\"language-plaintext highlighter-rouge\">gaff</code></li>\n        <li><em>“Charge method”</em>: <code class=\"language-plaintext highlighter-rouge\">bcc (default)</code></li>\n        <li><em>“Save GRO file?”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>Here, we use GAFF (general AMBER force field), which is a generalized AMBER force field which can be applied to almost any small organic molecule.</p>\n\n<p>We select charge and multiplicity as appropriate. The ligand studied here is neutral, so the charge is 0. The multiplicity is 1, which will be the case for every simple organic molecule we encounter; only if we deal with more exotic species such as metal complexes or carbenes will we need to consider higher values.</p>\n\n<p>Having generated topologies, we now need to combine them, define the box\nwhich contains the system, add solvent and ions, and perform an energy\nminimization step.</p>\n\n<!-- ## Solvation and energy minimization -->\n\n<h2 id=\"combine-topology-and-gro-files\">Combine topology and GRO files</h2>\n\n<p>While we have separate topology and structure files for both protein and ligand, we need to combine them into a single set of files to continue with the simulation setup. A dedicated Galaxy tool is provided for this, using the Python library ParmEd (<span class=\"citation\"><a href=\"#Swails2016\">Swails <i>et al.</i> 2016</a></span>).</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Combine GRO and topology files</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/chemteam/gmx_merge_topology_files/gmx_merge_topology_files/3.2.0+galaxy0\" title=\"Merge GROMACS topologies tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Merge GROMACS topologies</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 3.2.0+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Protein topology (TOP) file”</em>: <code class=\"language-plaintext highlighter-rouge\">TOP</code> file created by the <strong>GROMACS initial setup</strong> tool</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Ligand topology (TOP or ITP file)”</em>: <code class=\"language-plaintext highlighter-rouge\">Topology</code> created by the <strong>acpype</strong> tool</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Protein structure (GRO) file”</em>: <code class=\"language-plaintext highlighter-rouge\">GRO</code> file created by the <strong>GROMACS initial setup</strong> tool</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Ligand structure (GRO) file”</em>: <code class=\"language-plaintext highlighter-rouge\">Structure file (GRO format)</code> created by the <strong>acpype</strong> tool</li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h2 id=\"create-the-simulation-box\">Create the simulation box</h2>\n\n<p>The next step, once combined coordinate (GRO) and topology (TOP) files have been created, is to create a simulation box in which the system is situated.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Create simulation box</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/chemteam/gmx_editconf/gmx_editconf/2020.4+galaxy0\" title=\"GROMACS structure configuration tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>GROMACS structure configuration</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2020.4+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input structure”</em>: <code class=\"language-plaintext highlighter-rouge\">System GRO file</code> (Input dataset)</li>\n        <li><em>“Configure box?”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code>\n          <ul>\n            <li><em>“Box dimensions in nanometers”</em>: <code class=\"language-plaintext highlighter-rouge\">1.0</code></li>\n            <li><em>“Box type”</em>: <code class=\"language-plaintext highlighter-rouge\">Triclinic</code></li>\n          </ul>\n        </li>\n        <li><em>“Generate detailed log”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n      </ul>\n\n      <blockquote class=\"comment\">\n        <comment-title></comment-title>\n\n        <p>This tool returns a new GRO structure file, containing the same coordinates as before, but defining a simulation box such that every atom is a minimum of 1 nm from the box boundary. A distance of at least 1 nm is recommended to avoid interactions between the protein and its mirror image. On the other hand, increasing the box size too far will increase the simulation time, due to the greater number of solvent molecules which need to be treated. A variety of box shapes are available to choose: we select triclinic, as it provides the most efficient packing in space and thus fewer computational resources need to be devoted to simulation of solvent.</p>\n      </blockquote>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h2 id=\"solvation\">Solvation</h2>\n\n<p>The next step is solvation of the newly created simulation box - as we are simulating under biological conditions, we use water as the solvent. Note that the system is charged (depending on the pH) - the solvation tool also adds sodium or chloride ions (replacing existing water molecules) as required to neutralize this.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Solvation</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/chemteam/gmx_solvate/gmx_solvate/2020.4+galaxy1\" title=\"GROMACS solvation and adding ions tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>GROMACS solvation and adding ions</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2020.4+galaxy1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“GRO structure file”</em>: output of <strong>GROMACS structure configuration</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Topology (TOP) file”</em>: <code class=\"language-plaintext highlighter-rouge\">TOP</code> output of <strong>Merge GROMACS topologies</strong></li>\n        <li><em>“Water model for solvation”</em>: <code class=\"language-plaintext highlighter-rouge\">SPC (generic three-point model)</code></li>\n        <li><em>“Add ions to neutralize system”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes, add ions</code></li>\n        <li><em>“Specify salt concentration (sodium chloride) to add, in mol/liter”</em>: <code class=\"language-plaintext highlighter-rouge\">0</code></li>\n        <li><em>“Generate detailed log”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n      </ul>\n    </li>\n    <li>Rename the outputs to <code class=\"language-plaintext highlighter-rouge\">Solvated GRO</code> and <code class=\"language-plaintext highlighter-rouge\">Solvated TOP</code>.</li>\n  </ol>\n\n</blockquote>\n\n<h2 id=\"energy-minimization\">Energy minimization</h2>\n\n<p>After the solvation step, parameterization of the system is complete and preparatory simulations can be performed. The first of theses is energy minimization, which can be carried out using the <strong>GROMACS energy minimization</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> tool.</p>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>What is the purpose of energy minimization?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>Running an energy minimization (EM) algorithm relaxes the structure by removing any steric clashes or unusual geometry which would artificially raise the energy of the system.</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Energy minimization</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/chemteam/gmx_em/gmx_em/2020.4+galaxy0\" title=\"GROMACS energy minimization tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>GROMACS energy minimization</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2020.4+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“GRO structure file.”</em>: GRO output of <strong>GROMACS solvation and adding ions</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Topology (TOP) file.”</em>: TOP output of <strong>GROMACS solvation and adding ions</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n        <li><em>“Parameter input”</em>: <code class=\"language-plaintext highlighter-rouge\">Use default (partially customisable) setting</code>\n          <ul>\n            <li><em>“Number of steps for the MD simulation”</em>: <code class=\"language-plaintext highlighter-rouge\">50000</code></li>\n            <li><em>“EM tolerance”</em>: <code class=\"language-plaintext highlighter-rouge\">1000.0</code></li>\n          </ul>\n        </li>\n        <li><em>“Generate detailed log”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        <li>Rename output to <code class=\"language-plaintext highlighter-rouge\">Minimized GRO file</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>The EM tolerance here refers to the maximum force which will be allowed in a minimized system. The simulation will be terminated when the maximum force is less than this value, or when 50000 steps have elapsed.</p>\n\n<p>As an aside, we can use the <code class=\"language-plaintext highlighter-rouge\">Extract energy components</code> tool to plot the convergence of the potential energy during the minimization.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Checking EM convergence</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/chemteam/gmx_energy/gmx_energy/2020.4+galaxy0\" title=\"Extract energy components with GROMACS tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Extract energy components with GROMACS</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2020.4+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“EDR file.”</em>: EDR output of <strong>GROMACS energy minimization</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n        <li><em>“Terms to calculate”</em>: <code class=\"language-plaintext highlighter-rouge\">Potential</code></li>\n        <li><em>“Output format”</em>: <code class=\"language-plaintext highlighter-rouge\">Galaxy tabular</code></li>\n      </ul>\n    </li>\n    <li>On the output tabular file, click on the ‘Visualize this data’ icon. This provides a range of visualization options. Select ‘Line chart (jqPlot)’.</li>\n    <li>In the visualization window which appears, click on <code class=\"language-plaintext highlighter-rouge\">Select data.</code> Enter the following parameters:\n      <ul>\n        <li><em>“Provide a label”</em>: <code class=\"language-plaintext highlighter-rouge\">Energy potential</code></li>\n        <li><em>“Values for x-axis”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 1</code></li>\n        <li><em>“Values for y-axis”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 2</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>The resulting plot should resemble the figure below. The system first drops rapidly in energy, before slowly converging on the minimized state.</p>\n\n<figure id=\"figure-2\" style=\"max-width: 90%;\"><img src=\"/training-material/topics/computational-chemistry/images/empot.png\" alt=\"Snapshot of Energy potential during the EM simulation. \" width=\"640\" height=\"525\" loading=\"lazy\" /><a target=\"_blank\" href=\"/training-material/topics/computational-chemistry/images/empot.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 2</strong>:</span> Energy potential during the EM simulation. <a href=\"https://usegalaxy.eu/u/sbray/v/em-pot\">Click to view</a> as a Galaxy visualization</figcaption></figure>\n\n<h2 id=\"equilibration\">Equilibration</h2>\n\n<p>We now carry out equilibration in two stages: NVT and NPT. This is discussed at greater length in the basic GROMACS tutorial. Equilibration requires restraining the protein structure - we use the ITP file produced by the initial setup tool for this.</p>\n\n<p>Simulation under the NVT ensemble allows the solvent to be brought to the desired temperature, while simulation under the NPT ensemble bring the solvent to the correct pressure.</p>\n\n<blockquote class=\"comment\">\n  <comment-title>More detail about equilibration</comment-title>\n\n  <p>At this point equilibration of the solvent around the solute (i.e. the protein) is necessary. This is performed in two stages: equilibration under an NVT (or isothermal-isochoric) ensemble, followed by an NPT (or isothermal-isobaric) ensemble. Use of the NVT ensemble entails maintaining constant number of particles, volume and temperature, while the NPT ensemble maintains constant number of particles, pressure and temperature.</p>\n\n  <p>For equilibration, the protein must be held in place while the solvent is allowed to move freely around it. This is achieved using the position restraint file (ITP) we created in system setup. When we specify this restraint, protein movement is not forbidden, but is energetically penalized.</p>\n\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>NVT equilibration</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/chemteam/gmx_sim/gmx_sim/2020.4+galaxy1\" title=\"GROMACS simulation tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>GROMACS simulation</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2020.4+galaxy1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“GRO structure file”</em>: <code class=\"language-plaintext highlighter-rouge\">Minimized GRO file</code> (from energy minimization step)</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Topology (TOP) file”</em>: <code class=\"language-plaintext highlighter-rouge\">Solvated TOP</code></li>\n        <li>In <em>“Inputs”</em>:\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Position restraint (ITP) file”</em>: ITP file produced by initial setup step.</li>\n          </ul>\n        </li>\n        <li>In <em>“Outputs”</em>:\n          <ul>\n            <li><em>“Trajectory output”</em>: <code class=\"language-plaintext highlighter-rouge\">Return .xtc file (reduced precision)</code></li>\n            <li><em>“Structure output”</em>: <code class=\"language-plaintext highlighter-rouge\">Return .gro file</code></li>\n            <li><em>“Produce a checkpoint (CPT) file”</em>: <code class=\"language-plaintext highlighter-rouge\">Produce CPT output</code></li>\n            <li><em>“Produce an energy (EDR) file”</em>: <code class=\"language-plaintext highlighter-rouge\">Produce EDR output</code></li>\n          </ul>\n        </li>\n        <li>In <em>“Settings”</em>:\n          <ul>\n            <li><em>“Parameter input”</em>: <code class=\"language-plaintext highlighter-rouge\">Use default (partially customisable) setting</code>\n              <ul>\n                <li><em>“Bond constraints (constraints)”</em>: <code class=\"language-plaintext highlighter-rouge\">All bonds (all-bonds).</code></li>\n                <li><em>“Temperature /K”</em>: <code class=\"language-plaintext highlighter-rouge\">300</code></li>\n                <li><em>“Step length in ps”</em>: <code class=\"language-plaintext highlighter-rouge\">0.001</code></li>\n                <li><em>“Number of steps that elapse between saving data points (velocities, forces, energies)”</em>: <code class=\"language-plaintext highlighter-rouge\">1000</code></li>\n                <li><em>“Number of steps for the simulation”</em>: <code class=\"language-plaintext highlighter-rouge\">50000</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n        <li><em>“Generate detailed log”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>Once the NVT equilibration is complete, it is worth using the <code class=\"language-plaintext highlighter-rouge\">Extract energy components</code> tool again to check whether the system temperature has converged on 300 K. This can be done as described for energy minimization, this time specifying <code class=\"language-plaintext highlighter-rouge\">Temperature</code> under <code class=\"language-plaintext highlighter-rouge\">Terms to calculate</code> rather than <code class=\"language-plaintext highlighter-rouge\">Potential</code>. The plot should show the temperature reaching 300 K and remaining there, albeit with some fluctuation.</p>\n\n<p>Having stabilized the temperature of the system with NVT equilibration,\nwe also need to stabilize the pressure of the system. We therefore\nequilibrate again using the NPT (constant number of particles, pressure,\ntemperature) ensemble.</p>\n\n<p>Note that we can continue where the last simulation left off (with new\nparameters) by using the checkpoint (CPT) file saved at the end of the\nNVT simulation.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>NPT equilibration</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/chemteam/gmx_sim/gmx_sim/2020.4+galaxy1\" title=\"GROMACS simulation tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>GROMACS simulation</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2020.4+galaxy1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“GRO structure file”</em>: GRO output of <strong>GROMACS simulation</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> (NVT equilibration)</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Topology (TOP) file”</em>: <code class=\"language-plaintext highlighter-rouge\">Solvated TOP</code></li>\n        <li>In <em>“Inputs”</em>:\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Checkpoint (CPT) file”</em>: Output of <strong>GROMACS simulation</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> (NVT equilibration))</li>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Position restraint (ITP) file”</em>: ITP file produced by initial setup step.</li>\n          </ul>\n        </li>\n        <li>In <em>“Outputs”</em>:\n          <ul>\n            <li><em>“Trajectory output”</em>: <code class=\"language-plaintext highlighter-rouge\">Return .xtc file (reduced precision)</code></li>\n            <li><em>“Structure output”</em>: <code class=\"language-plaintext highlighter-rouge\">Return .gro file</code></li>\n            <li><em>“Produce a checkpoint (CPT) file”</em>: <code class=\"language-plaintext highlighter-rouge\">Produce CPT output</code></li>\n            <li><em>“Produce an energy (EDR) file”</em>: <code class=\"language-plaintext highlighter-rouge\">Produce EDR output</code></li>\n          </ul>\n        </li>\n        <li>In <em>“Settings”</em>:\n          <ul>\n            <li><em>“Ensemble”</em>: <code class=\"language-plaintext highlighter-rouge\">Isothermal-isobaric ensemble (NPT)</code></li>\n            <li><em>“Parameter input”</em>: <code class=\"language-plaintext highlighter-rouge\">Use default (partially customisable) setting</code>\n              <ul>\n                <li><em>“Bond constraints (constraints)”</em>: <code class=\"language-plaintext highlighter-rouge\">All bonds (all-bonds).</code></li>\n                <li><em>“Temperature /K”</em>: <code class=\"language-plaintext highlighter-rouge\">300</code></li>\n                <li><em>“Step length in ps”</em>: <code class=\"language-plaintext highlighter-rouge\">0.001</code></li>\n                <li><em>“Number of steps that elapse between saving data points (velocities, forces, energies)”</em>: <code class=\"language-plaintext highlighter-rouge\">1000</code></li>\n                <li><em>“Number of steps for the simulation”</em>: <code class=\"language-plaintext highlighter-rouge\">50000</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n        <li><em>“Generate detailed log”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>After the NPT equilibration is complete, <strong>Extract energy components</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> can be used again to view the pressure of the system. This is done as described for energy minimization, specifying <code class=\"language-plaintext highlighter-rouge\">Pressure</code> under <code class=\"language-plaintext highlighter-rouge\">Terms to calculate</code>. The plot should show convergence on 1 bar and remain there, although some fluctuation is expected.</p>\n\n<h2 id=\"production-simulation\">Production simulation</h2>\n\n<p>We can now remove the restraints and continue with the production simulation. The simulation will run for 1 million steps, with a step size of 1 fs, so will have a total length of 1 ns. This is rather short compared to the state-of-the-art, but sufficient for the purposes of a tutorial. For longer-scale simulations, the tool can be used multiple times (with the checkpoint file) to continue the existing simulation.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title></hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/chemteam/gmx_sim/gmx_sim/2020.4+galaxy1\" title=\"GROMACS simulation tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>GROMACS simulation</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2020.4+galaxy1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“GRO structure file”</em>: Output of <strong>GROMACS simulation</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> (NPT equilibration)</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Topology (TOP) file”</em>: <code class=\"language-plaintext highlighter-rouge\">Solvated TOP</code></li>\n        <li>In <em>“Inputs”</em>:\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Checkpoint (CPT) file”</em>: Output of <strong>GROMACS simulation</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> (NPT simulation))</li>\n          </ul>\n        </li>\n        <li>In <em>“Outputs”</em>:\n          <ul>\n            <li><em>“Trajectory output”</em>: <code class=\"language-plaintext highlighter-rouge\">Return .xtc file (reduced precision)</code></li>\n            <li><em>“Structure output”</em>: <code class=\"language-plaintext highlighter-rouge\">Return .gro file</code></li>\n            <li><em>“Produce a checkpoint (CPT) file”</em>: <code class=\"language-plaintext highlighter-rouge\">Produce CPT output</code></li>\n          </ul>\n        </li>\n        <li>In <em>“Settings”</em>:\n          <ul>\n            <li><em>“Ensemble”</em>: <code class=\"language-plaintext highlighter-rouge\">Isothermal-isobaric ensemble (NPT)</code></li>\n            <li><em>“Parameter input”</em>: <code class=\"language-plaintext highlighter-rouge\">Use default (partially customisable) setting</code>\n              <ul>\n                <li><em>“Temperature /K”</em>: <code class=\"language-plaintext highlighter-rouge\">300</code></li>\n                <li><em>“Step length in ps”</em>: <code class=\"language-plaintext highlighter-rouge\">0.001</code></li>\n                <li><em>“Number of steps that elapse between saving data points (velocities, forces, energies)”</em>: <code class=\"language-plaintext highlighter-rouge\">1000</code></li>\n                <li><em>“Number of steps for the simulation”</em>: <code class=\"language-plaintext highlighter-rouge\">1000000</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n        <li><em>“Generate detailed log”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h1 id=\"analysis\">Analysis</h1>\n\n<p>After the completion of the simulation, the following questions arise: 1) is the simulation converged enough, and 2) what interesting molecular properties are observed. To answer these questions, an analysis of the GROMACS simulation outputs (structure and trajectory file) will be carried out using Galaxy tools developed for computational chemistry (<span class=\"citation\"><a href=\"#senapathi_biomolecular_2019\">Senapathi <i>et al.</i> 2019</a></span>) based on popular analysis software, such as MDAnalysis (<span class=\"citation\"><a href=\"#michaudagrawal_mdanalysis_2011\">Michaud‐Agrawal <i>et al.</i> 2011</a></span>), MDTraj (<span class=\"citation\"><a href=\"#mcgibbon_mdtraj_2015\">McGibbon <i>et al.</i> 2015</a></span>), and  Bio3D (<span class=\"citation\"><a href=\"#skjaerven_integrating_2014\">Skjærven <i>et al.</i> 2014</a></span>). These tools output both tabular files as well as a variety of attractive plots.</p>\n\n<h2 id=\"create-pdb-file-needed-by-most-analysis-tools\">Create PDB file needed by most analysis tools</h2>\n\n<p>Before beginning a detailed analysis, the structure and trajectory files generated previously need to be converted into different formats. First, convert the structural coordinates of the system in GRO format into PDB format. This PDB file will be used by most analysis tools as a starting structure.  Next, convert the trajectory from XTC to DCD format, as a number of tools (particularly those based on Bio3D) only accept trajectories in DCD format.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Convert coordinate format</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/chemteam/gmx_editconf/gmx_editconf/2020.4+galaxy0\" title=\"GROMACS structure configuration tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>GROMACS structure configuration</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2020.4+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><em>“Output format”</em>: <code class=\"language-plaintext highlighter-rouge\">PDB file</code></li>\n        <li><em>“Configure box?”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n      </ul>\n\n      <blockquote class=\"comment\">\n        <comment-title></comment-title>\n\n        <p>This tool can also be used to carry out initial setup (as discussed in the simulation methods section) for GROMACS simulations and convert from PDB to GRO format.</p>\n      </blockquote>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h2 id=\"convert-trajectory-to-dcd-format\">Convert trajectory to DCD format</h2>\n\n<p>Convert from XTC to DCD format. A number of the analysis tools being used have been built to analyse trajectories in CHARMM’s DCD format.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Convert trajectory format</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/chemteam/md_converter/md_converter/1.9.6+galaxy0\" title=\"MDTraj file converter tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>MDTraj file converter</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.9.6+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><em>“Output format”</em>: <code class=\"language-plaintext highlighter-rouge\">DCD file</code></li>\n      </ul>\n\n      <blockquote class=\"comment\">\n        <comment-title></comment-title>\n\n        <p>This tool can also be used to interconvert between several trajectory formats.</p>\n      </blockquote>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h2 id=\"rmsd-analysis---protein\">RMSD analysis - protein</h2>\n\n<p>The Root Mean Square Deviation (RMSD) and Root Mean Square Fluctuation (RMSF) are calculated to check the stability and conformation of the protein and ligand through the course of the simulation.\nRMSD is a standard measure of structural distance between coordinate\nsets that measures the average distance between a group of atoms. The\nRMSD of the Cα atoms of the protein backbone is calculated here and\nis a measure of how much the protein conformation has changed between different time points in the trajectory.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>RMSD Analysis</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/chemteam/bio3d_rmsd/bio3d_rmsd/2.3.4\" title=\"RMSD Analysis tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>RMSD Analysis</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.3.4)</span> <em>“DCD trajectory input”</em>: <code class=\"language-plaintext highlighter-rouge\">output</code> (output of <strong>MDTraj file converter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“PDB input”</em>: <code class=\"language-plaintext highlighter-rouge\">output</code> (output of <strong>GROMACS structure configuration</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Select domains”</em>: <code class=\"language-plaintext highlighter-rouge\">Residue ID</code>\n          <ul>\n            <li><em>“Residue ID”</em>: <code class=\"language-plaintext highlighter-rouge\">G5E</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>In our case the ligand is stable with a single binding mode. The RMSD fluctuates around 0.3Å, with a slight fluctuation near the end of the simulation. This is more clearly seen in the histogram. The conformation seen during simulation is very similar to that in the crystal structure and the ligand is stable in the active site.</p>\n\n<figure id=\"figure-5\" style=\"max-width: 90%;\"><img src=\"../../images/htmd_analysis_rmsd2_series.png\" alt=\"RMSD timeseries Hsp90 ligand. \" width=\"480\" height=\"480\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/htmd_analysis_rmsd2_series.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 5</strong>:</span> RMSD timeseries for the Hsp90 Residue ID G5E (ligand)</figcaption></figure>\n\n<figure id=\"figure-6\" style=\"max-width: 90%;\"><img src=\"../../images/htmd_analysis_rmsd2_histo.png\" alt=\"RMSD histogram Hsp90 ligand. \" width=\"480\" height=\"480\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/htmd_analysis_rmsd2_histo.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 6</strong>:</span> RMSD histogram for the Hsp90 Residue ID G5E (ligand)</figcaption></figure>\n\n<h2 id=\"rmsf-analysis\">RMSF analysis</h2>\n\n<p>The Root Mean Square Fluctuation (RMSF) is valuable to consider, as it represents the deviation at a reference position over time. The fluctuation in space of particular amino acids in the protein are considered. The Cα of the protein, designated by <code class=\"language-plaintext highlighter-rouge\">C-alpha</code>, is a good selection to understand the change in protein structure. Depending on the system these fluctuations can be correlated to experimental techniques including Nuclear Magnetic Resonance (NMR) and M\"{o}ssbauer spectroscopy (<span class=\"citation\"><a href=\"#berjanskii_nmr_2006\">Berjanskii and Wishart 2006</a></span>, <span class=\"citation\"><a href=\"#kuzmanic_determination_2010\">Kuzmanic and Zagrovic 2010</a></span>). The output from the tools is the requested RMSF data and the RMSF plotted as a time series.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>RMSF analysis</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/chemteam/bio3d_rmsf/bio3d_rmsf/2.3.4\" title=\"RMSF Analysis tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>RMSF Analysis</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.3.4)</span> <em>“DCD trajectory input”</em>: <code class=\"language-plaintext highlighter-rouge\">output</code> (output of <strong>MDTraj file converter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“PDB input”</em>: <code class=\"language-plaintext highlighter-rouge\">output</code> (output of <strong>GROMACS structure configuration</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Select domains”</em>: <code class=\"language-plaintext highlighter-rouge\">C-alpha</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<figure id=\"figure-7\" style=\"max-width: 90%;\"><img src=\"../../images/htmd_analysis_rmsf.png\" alt=\"RMSF Hsp90. \" width=\"480\" height=\"480\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/htmd_analysis_rmsf.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 7</strong>:</span> RMSF(Å) vs the residue position. Large fluctuations occur at various positions, which correspond to flexible loop regions on the surface of the protein.</figcaption></figure>\n\n<p>When considering the RMSF, fluctuations greater than 1.0Å are of interest; for example see the fluctuations near residue positions 50, 110 and 160.  Inspecting the structure with molecular visualization software such as VMD, these can be seen to correspond to flexible loop regions on the protein surface. In addition, very large fluctuations are seen for the C-terminus; this is common and no investigation is needed.</p>\n\n<p>Note that the first few residues of this protein are missing in the PDB, and therefore residue position 0 in the RMSF corresponds to position 17 in the Hsp90 FASTA primary sequence. This is a fairly common problem that can occur with molecular modeling of proteins, where there may be missing residues at the beginning or within the sequence.</p>\n\n<h2 id=\"pca-analysis\">PCA analysis</h2>\n\n<p>Principal component analysis (PCA) converts a set of correlated\nobservations (movement of selected atoms in protein) to a set of principal\ncomponents (PCs) which are linearly independent (or uncorrelated). Here several related tools are used.\nThe PCA tool calculates the PCA in order to determine the relationship between statistically meaningful conformations (major global motions) sampled during the trajectory. The Cα carbons of the protein backbone are again a good selection for this purpose.  Outputs include the PCA raw data and figures of the relevant principal components (PCs) as well as an eigenvalue rank plot which is used to visualize the proportion of variance due to each principal component (remembering that the PCs are ranked eigenvectors based on the variance).\nHaving discovered the principal components usually these are visualized. The PCA visualization tool will create trajectories of specific principal components which can be viewed in a molecular viewer such as VMD (<span class=\"citation\"><a href=\"#hump_vmd_1996\">Humphrey <i>et al.</i> 1996</a></span>) or NGL viewer (<span class=\"citation\"><a href=\"#Rose2018ngl\">Rose <i>et al.</i> 2018</a></span>). We also consider the PCA cosine content which when close to 1 indicates that the simulation is not converged and a longer simulation is needed. For values below 0.7, no statement can be made about convergence or lack thereof.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>PCA</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/chemteam/bio3d_pca/bio3d_pca/2.3.4\" title=\"PCA tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>PCA</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.3.4)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“DCD trajectory input”</em>: <code class=\"language-plaintext highlighter-rouge\">output</code> (output of <strong>MDTraj file converter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“PDB input”</em>: <code class=\"language-plaintext highlighter-rouge\">output</code> (output of <strong>GROMACS structure configuration</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Select domains”</em>: <code class=\"language-plaintext highlighter-rouge\">C-alpha</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<figure id=\"figure-8\" style=\"max-width: 90%;\"><img src=\"../../images/htmd_analysis_pca.png\" alt=\"PCA Hsp90. \" width=\"480\" height=\"480\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/htmd_analysis_pca.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 8</strong>:</span> PCA results which include graphs of PC2 vs PC1, PC2 vs PC3, PC3 vs PC1  colored from blue to red in order of time, and an eigenvalue rank plot. In the eigenvalue plot the cumulative variance is labeled for each data point.</figcaption></figure>\n\n<p>The first three principal components are responsible for 32.8% of the total variance, as seen in the eigenvalue rank plot. The first principal component (PC1) accounts for 15.4% of the variance (see PC1 vs PC2 and eigenvalue rank plots). Visualization of PC1 using VMD shows a rocking motion and wagging of the C-terminus.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>PCA cosine content calculation</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/chemteam/mdanalysis_cosine_analysis/mdanalysis_cosine_analysis/1.0.0+galaxy0\" title=\"Cosine Content tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Cosine Content</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.0.0+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“DCD/XTC trajectory input”</em>: <code class=\"language-plaintext highlighter-rouge\">output</code> (output of <strong>MDTraj file converter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“PDB/GRO input”</em>: <code class=\"language-plaintext highlighter-rouge\">output</code> (output of <strong>GROMACS structure configuration</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>The PCA cosine content of the dominant motion related to PC1 is 0.93, indicating that the simulation is not fully converged. This is expected due to the short simulation length. For production level simulations, it is the norm to extend simulations to hundreds of nanoseconds in length, if not microseconds. As this tutorial is designed to be carried out on public webservers, we limit simulations to 1 ns, as we cannot provide a large amount of computational resources for training purposes.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>PCA visualisation</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/chemteam/bio3d_pca/bio3d_pca/2.3.4\" title=\"PCA visualization tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>PCA visualization</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.3.4)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“DCD trajectory input”</em>: <code class=\"language-plaintext highlighter-rouge\">output</code> (output of <strong>MDTraj file converter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“PDB input”</em>: <code class=\"language-plaintext highlighter-rouge\">output</code> (output of <strong>GROMACS structure configuration</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Select domains”</em>: <code class=\"language-plaintext highlighter-rouge\">C-alpha</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<figure id=\"figure-9\" style=\"max-width: 90%;\"><img src=\"../../images/htmd_analysis_pc1_hsp90.gif\" alt=\"PC1 Hsp90 gif. \" width=\"365\" height=\"450\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/htmd_analysis_pc1_hsp90.gif\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 9</strong>:</span> PC1 motion for Hsp90</figcaption></figure>\n\n<h2 id=\"hydrogen-bond-analysis\">Hydrogen bond analysis</h2>\n\n<p>Hydrogen bonding interactions contribute to binding and are worth investigating, in particular persistent hydrogen bonds. All possible hydrogen bonding interactions between the two selected regions, here the protein and the ligand, are investigated over time using the VMD hydrogen bond analysis tool included in Galaxy. Hydrogen bonds are identified and in the output the total number of hydrogen bonds and  occupancy over time is returned.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Hydrogen bond analysis</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/chemteam/vmd_hbonds/vmd_hbonds/1.9.3\" title=\"Hydrogen Bond Analysis using VMD tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Hydrogen Bond Analysis using VMD</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.9.3)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“DCD/XTC trajectory input”</em>: <code class=\"language-plaintext highlighter-rouge\">output</code> (output of <strong>MDTraj file converter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“PDB/GRO input”</em>: <code class=\"language-plaintext highlighter-rouge\">output</code> (output of <strong>GROMACS structure configuration</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Selection 1”</em>: <code class=\"language-plaintext highlighter-rouge\">protein</code></li>\n        <li><em>“Selection 2”</em>: <code class=\"language-plaintext highlighter-rouge\">resname G5E</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>The active site of this protein is quite hydrophobic, yet multiple hydrogen bonds were identified. The hydrogen bond between aspartate-93 and the ligand (as identified in the crystal structure) was found to be persistent, meeting the hydrogen bond criteria for 89.22% of the simulation. A hydrogen bond between the ligand and the carbonyl group of glycine-97 was found to have a 15.27% occupancy. Hydrogen bonding interactions with threonine-184, asparagine-51 and lysine-58 were also observed but these are not persistent and only present for a minority of the simulation. These values can be accessed from the ‘Percentage occupancy of the H-bond’ output of the hydrogen bond analysis tool.</p>\n\n<h1 id=\"optional-automating-high-throughput-calculations\">Optional: Automating high throughput calculations</h1>\n<p>Up until this step, Galaxy tools have been applied sequentially to datasets. This is useful to gain an understanding of the steps involved, but becomes tedious if the workflow needs to be run on multiple protein-ligand systems. Fortunately, Galaxy allows entire workflows to be executed with a single mouse-click, enabling straightforward high-throughput analyses.</p>\n\n<p>We will demonstrate the high-throughput capabilities of Galaxy by running the workflow detailed so far on a further three ligands.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>High-throughput MD</hands-on-title>\n\n  <ol>\n    <li>Create a new history for running the high-throughput workflow and name it <code class=\"language-plaintext highlighter-rouge\">Hsp90 HTMD simulation</code></li>\n    <li>Upload the SD-file containing the new ligand structures from Zenodo  and rename it <code class=\"language-plaintext highlighter-rouge\">Ligands (SDF)</code></li>\n    <li>Import the simulation workflow from the European (<span class=\"citation\"><a href=\"#eu_htmd_simulation_workflow\">“<b>Galaxy | Europe | Accessible History | Protein-ligand HTMD simulation</b>”</a></span>) or the South African Galaxy server (<span class=\"citation\"><a href=\"#za_htmd_simulation_workflow\">“<b>Galaxy | South Africa | Accessible History | Protein-ligand HTMD analysis</b>”</a></span>).</li>\n    <li>Run the imported workflow with the following parameters:\n      <ul>\n        <li><em>“Send results to a new history”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        <li><em>“History name results to a new history”</em>: <code class=\"language-plaintext highlighter-rouge\">Hsp90 HTMD analysis</code></li>\n        <li><em>“GRO input”</em>: ‘Collection of GRO files produced by simulation workflow’</li>\n        <li><em>“XTC input”</em>: ‘Collection of XTC files produced by simulation workflow’</li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>This process runs the entire simulation and analysis procedure described so far on the new set of ligands. It uses Galaxy’s <a href=\"/training-material/topics/galaxy-interface/tutorials/collections/tutorial.html\">collection feature</a> to organize the data; each item in the history is a collection (essentially a directory containing multiple individual datasets) containing one file corresponding to each of the input ligands.</p>\n\n<p>Note that the SD-file needs to contain ligands with the correct 3D coordinates for MD simulation. The easiest way to obtain these is using a molecular docking tool such as Autodock Vina (<span class=\"citation\"><a href=\"#Trott2009\">Trott and Olson 2009</a></span>) or rDock (<span class=\"citation\"><a href=\"#Ruiz2014\">Ruiz-Carmona <i>et al.</i> 2014</a></span>); tutorials and workflows are available for both of these from the Galaxy Training Network. As an example, the history in which the SD-file used in the HTMD workflow is generated (using AutoDock Vina) is provided (<span class=\"citation\"><a href=\"#eu_6hhr\">“<b>Galaxy | Europe | Accessible History | Protein-ligand docking (6hhr)</b>”</a></span>).</p>\n\n<p>Apart from manual setups or collections, there are several other alternatives which are helpful in scaling up workflows. Galaxy supports and provides training material for converting <a href=\"/training-material/topics/galaxy-interface/tutorials/history-to-workflow/tutorial.html\">histories to workflows</a>, using <a href=\"/training-material/topics/galaxy-interface/tutorials/history/tutorial.html\">multiple histories</a>, and the <a href=\"/training-material/topics/dev/tutorials/bioblend-api/slides.html\">Galaxy Application Programming Interface (API)</a>. For beginners and users who prefer a visual interface, automation can be done using multiple histories and collections with the standard Galaxy user interface.</p>\n\n<p>If you are able to write small scripts, you can automate everything you have learned here with the Galaxy API. This allows you to interact with the server to automate repetitive tasks and create more complex workflows (which may have repetition or branching). The simplest way to access the API is through the Python library BioBlend (<span class=\"citation\"><a href=\"#sloggett_bioblend\">Sloggett <i>et al.</i> 2013</a></span>). An example Python script, which uses BioBlend to run the GROMACS simulation workflow for each of a list of ligands, is given in the hands-on box below.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Bioblend script</hands-on-title>\n\n  <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>from bioblend import galaxy\n\n# Server and account details\nAPI_KEY = 'YOUR USEGALAXY.EU API KEY'\ngi = galaxy.GalaxyInstance(key=API_KEY,\n   url='https://usegalaxy.eu/')\n\n# ID for GROMACS workflow\nworkflow_id = 'adc6d049e9283789'\n\n# Dataset IDs for ligands to dock\nligands = {\n# ligand_name: dataset ID,\n'lig1': '11ac94870d0bb33a79c5fa18b0fd3b4c',\n# ...\n}\n\n# Loop over ligands, invoking workflow\nfor name, _id in ligands.items():\n   inv = gi.workflows.invoke_workflow(\n       workflow_id,\n       inputs={\n           '1': {'src': 'hda', 'id': _id}\n       },\n       history_name=f'HTMD run on {name}'\n   )\n</code></pre></div>  </div>\n\n</blockquote>\n\n<p>Another option is to use the Planemo command-line tool. Planemo has a very wide range of functions, including the ability to run Galaxy workflows from the command line. For a full overview, see the <a href=\"https://planemo.readthedocs.io/en/latest/running.html\">tutorial</a>.</p>\n\n<p>Assuming you have Planemo installed, you can create a file with the name <code class=\"language-plaintext highlighter-rouge\">htmd-job.yml</code> with the following contents:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>SDF file with (docked) ligands:\n  class: File\n  galaxy_id: '11ac94870d0bb33a79c5fa18b0fd3b4c'\n  # path: ligands.sdf\n\n</code></pre></div></div>\n\n<p>You can specify the dataset either using its Galaxy ID, or with the path of a local file. The Galaxy ID is associated with the specific server you are using - in\nthis case <code class=\"language-plaintext highlighter-rouge\">usegalaxy.eu</code>. You can get this ID by clicking on the <code class=\"language-plaintext highlighter-rouge\">View details</code> icon of a dataset in your Galaxy history - it is provided in the <code class=\"language-plaintext highlighter-rouge\">Dataset Information</code>\ntable as <code class=\"language-plaintext highlighter-rouge\">History Content API ID</code>. Then run:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>planemo run adc6d049e9283789 htmd-job.yml --galaxy_url https://usegalaxy.eu --galaxy_user_key YOUR_USEGALAXY_EU_API_KEY --history_name \"HTMD with planemo\"\n</code></pre></div></div>\n\n<p>Here <code class=\"language-plaintext highlighter-rouge\">adc6d049e9283789</code> is the Galaxy ID associated with the workflow on <code class=\"language-plaintext highlighter-rouge\">usegalaxy.eu</code>, but the <code class=\"language-plaintext highlighter-rouge\">planemo run</code> command can also use a local workflow file.</p>\n\n<p>If you now return to the web-browser, you should see a new history should have been created named <code class=\"language-plaintext highlighter-rouge\">HTMD with planemo</code> and it should begin to fill with datasets.</p>\n\n<h1 id=\"conclusion\">Conclusion</h1>\n\n<p>This tutorial provides a guide on how to study protein-ligand interaction using molecular dynamics in Galaxy. Performing such analyses in Galaxy makes it straightforward to set up, schedule and run workflows, removing much of the difficulty from MD simulation. Thus, the technical barrier to performing high-throughput studies is greatly reduced. Results are structured in the form of Galaxy histories or collections, and include ready-plotted diagrams, which ensure data can be easily understood and reproduced if necessary. Apart from streamlining the process for existing MD users, this tutorial should also prove useful as a pedagogical guide for educating students or newcomers to the field.</p>\n\n<p>After completing the tutorial, the user will be familiar at a basic level with a range of MD analysis techniques, and understand the steps required for a typical MD simulation. Thus, they will be equipped to apply these tools to their own problems.</p>\n\n<h1 id=\"glossary-and-abbreviations\">Glossary and abbreviations</h1>\n\n<ul>\n  <li>Concepts:\n    <ul>\n      <li><strong>MD</strong> - molecular dynamics simulation.</li>\n      <li><strong>NVT</strong> - isothermal-isochoric ensemble, in which number of atoms (N), volume (V) and temperature (T) are kept constant.</li>\n      <li><strong>NPT</strong> - isothermal-isobaric ensemble, in which number of atoms (N), pressure (P) and temperature (T) are kept constant.</li>\n      <li><strong>RMSD</strong> - Root Mean Square Deviation</li>\n      <li><strong>RMSF</strong> - Root Mean Square Fluctuation</li>\n      <li><strong>PCA</strong> - Principal Component Analysis</li>\n    </ul>\n  </li>\n  <li>Software:\n    <ul>\n      <li><strong>GROMACS</strong> (Groningen Machine for Chemical Simulation) - a molecular dynamics package mainly designed for simulations of proteins, lipids and nucleic acids.</li>\n      <li><strong>NAMD</strong> (Nanoscale Molecular Dynamics) - a molecular dynamics software designed for high-performance simulation of large biomolecular systems.</li>\n      <li><strong>CHARMM</strong> (Chemistry at Harvard Macromolecular Mechanics) - a molecular modeling and simulation program for many-particle systems. It includes a comprehensive set of force fields to simulate biomolecules.</li>\n      <li><strong>VMD</strong> (Visual Molecular Dynamics) - a molecular visualisation program.</li>\n      <li><strong>ACPYPE</strong> (AnteChamber Python Parser interface) - a tool that simplifies the generation of small molecule topologies and parameters for a variety of molecular dynamics programs, like GROMACS and CHARMM. It is based on the Antechamber software provided by AmberTools.</li>\n    </ul>\n  </li>\n  <li>Filetypes:\n    <ul>\n      <li><strong>PDB</strong> - a commonly used filetype for storing 3-dimensional structural data of large biomolecules such as proteins and nucleic acids. Also stands for the Protein Data Bank, an online repository for such data.</li>\n      <li><strong>GRO</strong> - a filetype similar to PDB, which contains a molecular structure in a format supported by GROMACS.</li>\n      <li><strong>DCD</strong> - a trajectory file format supported by CHARMM and NAMD.</li>\n      <li><strong>TOP</strong> - a GROMACS filetype for representing molecular topologies.</li>\n      <li><strong>ITP</strong> - another GROMACS filetype for representing molecular topologies.</li>\n      <li><strong>TRR</strong> - a lossless GROMACS trajectory file, storing coordinates, forces and velocity.</li>\n      <li><strong>XTC</strong> - a compressed GROMACS trajectory file, storing coordinates.</li>\n    </ul>\n  </li>\n  <li>Force fields and water molecules:\n    <ul>\n      <li><strong>GROMOS</strong> (GROningen Molecular Simulation) - the name of a force field for molecular dynamics simulation.</li>\n      <li><strong>AMBER</strong> (Assisted Model building with Energy Refinement) - a set of molecular mechanical force fields for the simulation of biomolecules.</li>\n      <li><strong>OpenFF</strong> (Open Force Field) - a Python toolkit used for the development and application of modern molecular mechanics force fields.</li>\n      <li><strong>GAFF</strong> (General AMBER Force Field) - a force field developed to augment the other AMBER force fields, allowing augmentation of most pharmaceutical molecules.</li>\n      <li><strong>TIP3P</strong> - a water model that specifies rigid water molecules with charges and Lennard-Jones parameters assigned to each of the 3 atoms.</li>\n    </ul>\n  </li>\n  <li>Biological concepts:\n    <ul>\n      <li><strong>Hsp90</strong> - Heat shock protein 90, a chaperone protein.</li>\n      <li><strong>ATP</strong> - Adenosine triphosphate, the primary carrier of energy in cells.</li>\n      <li><strong>NTD</strong> - N-Terminal Domain, the start of a protein or polypeptide chain where the free amine group is located.</li>\n      <li><strong>NMR</strong> (Nuclear Magnetic Resonance) - an experimental technique for determining 3D molecular structure.</li>\n    </ul>\n  </li>\n</ul>\n"],"ref_slides":[],"hands_on":true,"slides":false,"mod_date":"2024-05-29 14:28:52 +0000","pub_date":"2020-05-20 17:27:02 +0000","version":20,"workflows":[{"workflow":"analysis_workflow.ga","tests":false,"url":"https://training.galaxyproject.org/training-material/topics/computational-chemistry/tutorials/htmd-analysis/workflows/analysis_workflow.ga","path":"topics/computational-chemistry/tutorials/htmd-analysis/workflows/analysis_workflow.ga","wfid":"computational-chemistry-htmd-analysis","wfname":"analysis_workflow","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/computational-chemistry-htmd-analysis/versions/analysis_workflow","license":null,"creators":[],"name":"Workflow constructed from history 'Hsp90-MDAnalysis'","title":"Workflow constructed from history 'Hsp90-MDAnalysis'","test_results":null,"modified":"2024-06-24 07:14:26 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\nInput dataset\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"ℹ️ Input Dataset\\nInput dataset\"];\n  style 1 stroke:#2c3143,stroke-width:4px;\n  2[\"GROMACS structure configuration\"];\n  0 -->|output| 2;\n  3[\"MDTraj file converter\"];\n  1 -->|output| 3;\n  4[\"RMSD Analysis\"];\n  2 -->|output| 4;\n  3 -->|output| 4;\n  5[\"RMSF Analysis\"];\n  2 -->|output| 5;\n  3 -->|output| 5;\n  6[\"PCA\"];\n  2 -->|output| 6;\n  3 -->|output| 6;\n  7[\"Cosine Content\"];\n  3 -->|output| 7;\n  2 -->|output| 7;\n  8[\"PCA visualization\"];\n  2 -->|output| 8;\n  3 -->|output| 8;\n  9[\"Hydrogen Bond Analysis using VMD\"];\n  3 -->|output| 9;\n  2 -->|output| 9;\n  10[\"RMSD Analysis\"];\n  2 -->|output| 10;\n  3 -->|output| 10;"},{"workflow":"main_workflow.ga","tests":false,"url":"https://training.galaxyproject.org/training-material/topics/computational-chemistry/tutorials/htmd-analysis/workflows/main_workflow.ga","path":"topics/computational-chemistry/tutorials/htmd-analysis/workflows/main_workflow.ga","wfid":"computational-chemistry-htmd-analysis","wfname":"main_workflow","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/computational-chemistry-htmd-analysis/versions/main_workflow","license":null,"creators":[],"name":"MD protein-ligand workflow (from PDB structure)","title":"MD protein-ligand workflow (from PDB structure)","test_results":null,"modified":"2024-06-24 07:14:26 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Parameter\\nPDB code e.g. 6hhr\"];\n  style 0 fill:#ded,stroke:#393,stroke-width:4px;\n  1[\"ℹ️ Input Parameter\\nLigand name e.g. AG5E\"];\n  style 1 fill:#ded,stroke:#393,stroke-width:4px;\n  2[\"Get PDB file\"];\n  0 -->|output| 2;\n  3[\"Search in textfiles\"];\n  2 -->|output| 3;\n  4[\"Search in textfiles\"];\n  2 -->|output| 4;\n  1 -->|output| 4;\n  5[\"GROMACS initial setup\"];\n  3 -->|output| 5;\n  6[\"Compound conversion\"];\n  4 -->|output| 6;\n  7[\"Generate MD topologies for small molecules\"];\n  6 -->|outfile| 7;\n  8[\"Merge GROMACS topologies\"];\n  7 -->|gro_output| 8;\n  5 -->|output1| 8;\n  5 -->|output2| 8;\n  7 -->|output| 8;\n  9[\"GROMACS structure configuration\"];\n  8 -->|complex_gro| 9;\n  10[\"GROMACS solvation and adding ions\"];\n  8 -->|complex_top| 10;\n  9 -->|output| 10;\n  11[\"GROMACS energy minimization\"];\n  10 -->|output2| 11;\n  10 -->|output1| 11;\n  12[\"GROMACS simulation\"];\n  5 -->|output3| 12;\n  10 -->|output2| 12;\n  11 -->|output1| 12;\n  13[\"GROMACS simulation\"];\n  5 -->|output3| 13;\n  10 -->|output2| 13;\n  12 -->|output1| 13;\n  12 -->|output5| 13;\n  14[\"GROMACS simulation\"];\n  10 -->|output2| 14;\n  13 -->|output1| 14;\n  13 -->|output5| 14;"}],"api":"https://training.galaxyproject.org/training-material/api/topics/computational-chemistry/tutorials/htmd-analysis/tutorial.json","tools":["toolshed.g2.bx.psu.edu/repos/bgruening/get_pdb/get_pdb/0.1.0","toolshed.g2.bx.psu.edu/repos/bgruening/openbabel_compound_convert/openbabel_compound_convert/2.4.2.2.0","toolshed.g2.bx.psu.edu/repos/bgruening/openbabel_compound_convert/openbabel_compound_convert/3.1.1+galaxy0","toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_grep_tool/1.1.1","toolshed.g2.bx.psu.edu/repos/chemteam/ambertools_acpype/ambertools_acpype/19.11","toolshed.g2.bx.psu.edu/repos/chemteam/ambertools_acpype/ambertools_acpype/21.3+galaxy0","toolshed.g2.bx.psu.edu/repos/chemteam/bio3d_pca/bio3d_pca/2.3.4","toolshed.g2.bx.psu.edu/repos/chemteam/bio3d_pca_visualize/bio3d_pca_visualize/2.3.4","toolshed.g2.bx.psu.edu/repos/chemteam/bio3d_rmsd/bio3d_rmsd/2.3.4","toolshed.g2.bx.psu.edu/repos/chemteam/bio3d_rmsf/bio3d_rmsf/2.3.4","toolshed.g2.bx.psu.edu/repos/chemteam/gmx_editconf/gmx_editconf/2019.1.4","toolshed.g2.bx.psu.edu/repos/chemteam/gmx_editconf/gmx_editconf/2020.4+galaxy0","toolshed.g2.bx.psu.edu/repos/chemteam/gmx_em/gmx_em/2019.1.4","toolshed.g2.bx.psu.edu/repos/chemteam/gmx_em/gmx_em/2020.4+galaxy0","toolshed.g2.bx.psu.edu/repos/chemteam/gmx_energy/gmx_energy/2020.4+galaxy0","toolshed.g2.bx.psu.edu/repos/chemteam/gmx_merge_topology_files/gmx_merge_topology_files/3.2.0","toolshed.g2.bx.psu.edu/repos/chemteam/gmx_merge_topology_files/gmx_merge_topology_files/3.2.0+galaxy0","toolshed.g2.bx.psu.edu/repos/chemteam/gmx_setup/gmx_setup/2019.1.4","toolshed.g2.bx.psu.edu/repos/chemteam/gmx_setup/gmx_setup/2020.4+galaxy0","toolshed.g2.bx.psu.edu/repos/chemteam/gmx_sim/gmx_sim/2019.1.4.1","toolshed.g2.bx.psu.edu/repos/chemteam/gmx_sim/gmx_sim/2020.4+galaxy1","toolshed.g2.bx.psu.edu/repos/chemteam/gmx_solvate/gmx_solvate/2019.1.4","toolshed.g2.bx.psu.edu/repos/chemteam/gmx_solvate/gmx_solvate/2020.4+galaxy1","toolshed.g2.bx.psu.edu/repos/chemteam/md_converter/md_converter/1.9.3.2","toolshed.g2.bx.psu.edu/repos/chemteam/md_converter/md_converter/1.9.6+galaxy0","toolshed.g2.bx.psu.edu/repos/chemteam/mdanalysis_cosine_analysis/mdanalysis_cosine_analysis/0.20","toolshed.g2.bx.psu.edu/repos/chemteam/mdanalysis_cosine_analysis/mdanalysis_cosine_analysis/1.0.0+galaxy0","toolshed.g2.bx.psu.edu/repos/chemteam/vmd_hbonds/vmd_hbonds/1.9.3"],"supported_servers":{"exact":[{"url":"https://usegalaxy.org","name":"UseGalaxy.org (Main)","usegalaxy":true},{"url":"https://usegalaxy.org.au","name":"UseGalaxy.org.au","usegalaxy":true}],"inexact":[{"url":"https://usegalaxy.cz/","name":"UseGalaxy.cz","usegalaxy":false},{"url":"https://usegalaxy.eu","name":"UseGalaxy.eu","usegalaxy":true},{"url":"https://usegalaxy.no/","name":"UseGalaxy.no","usegalaxy":false}]},"topic_name_human":"Computational chemistry","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"get_pdb","owner":"bgruening","revisions":"538790c6c21b","tool_panel_section_label":"ChemicalToolBox","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"openbabel_compound_convert","owner":"bgruening","revisions":"b59c91adeac1","tool_panel_section_label":"ChemicalToolBox","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"openbabel_compound_convert","owner":"bgruening","revisions":"e2c36f62e22f","tool_panel_section_label":"ChemicalToolBox","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"text_processing","owner":"bgruening","revisions":"d698c222f354","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"ambertools_acpype","owner":"chemteam","revisions":"f4230f116196","tool_panel_section_label":"ChemicalToolBox","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"ambertools_acpype","owner":"chemteam","revisions":"6ca543ec1bf8","tool_panel_section_label":"ChemicalToolBox","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"bio3d_pca","owner":"chemteam","revisions":"24867ab16f36","tool_panel_section_label":"ChemicalToolBox","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"bio3d_pca_visualize","owner":"chemteam","revisions":"f61a718993fd","tool_panel_section_label":"ChemicalToolBox","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"bio3d_rmsd","owner":"chemteam","revisions":"77e28e1da9f4","tool_panel_section_label":"ChemicalToolBox","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"bio3d_rmsf","owner":"chemteam","revisions":"6bcb804a54c3","tool_panel_section_label":"ChemicalToolBox","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"gmx_editconf","owner":"chemteam","revisions":"3b8a9d5ced85","tool_panel_section_label":"ChemicalToolBox","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"gmx_editconf","owner":"chemteam","revisions":"0fac8e2afc13","tool_panel_section_label":"ChemicalToolBox","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"gmx_em","owner":"chemteam","revisions":"eb6564a60136","tool_panel_section_label":"ChemicalToolBox","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"gmx_em","owner":"chemteam","revisions":"f5d979cb4b54","tool_panel_section_label":"ChemicalToolBox","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"gmx_energy","owner":"chemteam","revisions":"d2f955aea23a","tool_panel_section_label":"ChemicalToolBox","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"gmx_merge_topology_files","owner":"chemteam","revisions":"d1d0efda35c0","tool_panel_section_label":"ChemicalToolBox","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"gmx_merge_topology_files","owner":"chemteam","revisions":"319a28774da9","tool_panel_section_label":"ChemicalToolBox","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"gmx_setup","owner":"chemteam","revisions":"cac1886249a2","tool_panel_section_label":"ChemicalToolBox","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"gmx_setup","owner":"chemteam","revisions":"2c349b027a01","tool_panel_section_label":"ChemicalToolBox","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"gmx_sim","owner":"chemteam","revisions":"2e219a2d9327","tool_panel_section_label":"ChemicalToolBox","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"gmx_sim","owner":"chemteam","revisions":"73008ef1f487","tool_panel_section_label":"ChemicalToolBox","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"gmx_solvate","owner":"chemteam","revisions":"1809414a9454","tool_panel_section_label":"ChemicalToolBox","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"gmx_solvate","owner":"chemteam","revisions":"2c8ed1b52bf7","tool_panel_section_label":"ChemicalToolBox","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"md_converter","owner":"chemteam","revisions":"79e8ab8f1e81","tool_panel_section_label":"ChemicalToolBox","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"md_converter","owner":"chemteam","revisions":"ba83f0923369","tool_panel_section_label":"ChemicalToolBox","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"mdanalysis_cosine_analysis","owner":"chemteam","revisions":"9a3a1f698fc6","tool_panel_section_label":"ChemicalToolBox","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"mdanalysis_cosine_analysis","owner":"chemteam","revisions":"48d6a6eb438b","tool_panel_section_label":"ChemicalToolBox","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"vmd_hbonds","owner":"chemteam","revisions":"8aa5e465b043","tool_panel_section_label":"ChemicalToolBox","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: get_pdb\n  owner: bgruening\n  revisions: 538790c6c21b\n  tool_panel_section_label: ChemicalToolBox\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: openbabel_compound_convert\n  owner: bgruening\n  revisions: b59c91adeac1\n  tool_panel_section_label: ChemicalToolBox\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: openbabel_compound_convert\n  owner: bgruening\n  revisions: e2c36f62e22f\n  tool_panel_section_label: ChemicalToolBox\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: text_processing\n  owner: bgruening\n  revisions: d698c222f354\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: ambertools_acpype\n  owner: chemteam\n  revisions: f4230f116196\n  tool_panel_section_label: ChemicalToolBox\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: ambertools_acpype\n  owner: chemteam\n  revisions: 6ca543ec1bf8\n  tool_panel_section_label: ChemicalToolBox\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bio3d_pca\n  owner: chemteam\n  revisions: 24867ab16f36\n  tool_panel_section_label: ChemicalToolBox\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bio3d_pca_visualize\n  owner: chemteam\n  revisions: f61a718993fd\n  tool_panel_section_label: ChemicalToolBox\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bio3d_rmsd\n  owner: chemteam\n  revisions: 77e28e1da9f4\n  tool_panel_section_label: ChemicalToolBox\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bio3d_rmsf\n  owner: chemteam\n  revisions: 6bcb804a54c3\n  tool_panel_section_label: ChemicalToolBox\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: gmx_editconf\n  owner: chemteam\n  revisions: 3b8a9d5ced85\n  tool_panel_section_label: ChemicalToolBox\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: gmx_editconf\n  owner: chemteam\n  revisions: 0fac8e2afc13\n  tool_panel_section_label: ChemicalToolBox\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: gmx_em\n  owner: chemteam\n  revisions: eb6564a60136\n  tool_panel_section_label: ChemicalToolBox\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: gmx_em\n  owner: chemteam\n  revisions: f5d979cb4b54\n  tool_panel_section_label: ChemicalToolBox\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: gmx_energy\n  owner: chemteam\n  revisions: d2f955aea23a\n  tool_panel_section_label: ChemicalToolBox\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: gmx_merge_topology_files\n  owner: chemteam\n  revisions: d1d0efda35c0\n  tool_panel_section_label: ChemicalToolBox\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: gmx_merge_topology_files\n  owner: chemteam\n  revisions: 319a28774da9\n  tool_panel_section_label: ChemicalToolBox\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: gmx_setup\n  owner: chemteam\n  revisions: cac1886249a2\n  tool_panel_section_label: ChemicalToolBox\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: gmx_setup\n  owner: chemteam\n  revisions: 2c349b027a01\n  tool_panel_section_label: ChemicalToolBox\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: gmx_sim\n  owner: chemteam\n  revisions: 2e219a2d9327\n  tool_panel_section_label: ChemicalToolBox\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: gmx_sim\n  owner: chemteam\n  revisions: 73008ef1f487\n  tool_panel_section_label: ChemicalToolBox\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: gmx_solvate\n  owner: chemteam\n  revisions: 1809414a9454\n  tool_panel_section_label: ChemicalToolBox\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: gmx_solvate\n  owner: chemteam\n  revisions: 2c8ed1b52bf7\n  tool_panel_section_label: ChemicalToolBox\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: md_converter\n  owner: chemteam\n  revisions: 79e8ab8f1e81\n  tool_panel_section_label: ChemicalToolBox\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: md_converter\n  owner: chemteam\n  revisions: ba83f0923369\n  tool_panel_section_label: ChemicalToolBox\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: mdanalysis_cosine_analysis\n  owner: chemteam\n  revisions: 9a3a1f698fc6\n  tool_panel_section_label: ChemicalToolBox\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: mdanalysis_cosine_analysis\n  owner: chemteam\n  revisions: 48d6a6eb438b\n  tool_panel_section_label: ChemicalToolBox\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: vmd_hbonds\n  owner: chemteam\n  revisions: 8aa5e465b043\n  tool_panel_section_label: ChemicalToolBox\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":false,"slides_recordings":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial"}