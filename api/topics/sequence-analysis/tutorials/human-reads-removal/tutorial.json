{"layout":"tutorial_hands_on","title":"Removal of human reads from SARS-CoV-2 sequencing data","questions":["How can you remove traces of human sequence data from a sequenced viral sample?"],"objectives":["Obtain viral (SARS-CoV-2) sequencing data with contaminating human reads from public sources","Organize the data into a collection","Preprocess and map the data against the human reference genome","Eliminate reads/read pairs that map to the human genome from the original data"],"time_estimation":"1h","level":"Intermediate","key_points":["Before submitting raw viral sequencing data to public databases you will want to remove human sequence traces","Human reads can be identified by mapping the data to the human reference genome","After mapping, you can extract the read identifiers of the non-human reads and use these to extract just the desired original sequenced reads from the input data"],"requirements":[{"type":"internal","topic_name":"sequence-analysis","tutorials":["quality-control","mapping"]},{"type":"internal","topic_name":"galaxy-interface","tutorials":["collections"]}],"tags":["covid19"],"contributors":[{"name":"Wolfgang Maier","orcid":"0000-0002-9464-6640","matrix":"wm75:matrix.org","joined":"2017-09","elixir_node":"de","fediverse":"https://scholar.social/@zerodivision","fediverse_flavor":"mastodon","affiliations":["by-covid","uni-freiburg","elixir-europe"],"id":"wm75","url":"https://training.galaxyproject.org/training-material/api/contributors/wm75.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/wm75/"}],"js_requirements":{"mathjax":null,"mermaid":false},"short_id":"T00236","url":"/topics/sequence-analysis/tutorials/human-reads-removal/tutorial.html","topic_name":"sequence-analysis","tutorial_name":"human-reads-removal","dir":"topics/sequence-analysis/tutorials/human-reads-removal","symlink":null,"id":"sequence-analysis/human-reads-removal","ref_tutorials":["<p>Patient samples for pathogen detection are usually “contaminated” with human host DNA.\nSuch contamination, if not removed from sequencing data, may pose an issue with certain types of\ndata analyses.\nAnother issue is that submitting the raw sequenced reads with the human sequence “contamination” included to a public database may simply violate national or institutional regulations for handling patient data.\nFor this second reason in particular, researchers will regularly have to remove traces of human sequencing data even from samples that, by their nature, should be highly enriched for just pathogen reads, as is the case, for example, for ampliconic viral samples, in which viral sequences have been PCR-amplified with virus-specific primers before sequencing.</p>\n\n<p>This tutorial will guide you through a typical workflow for clearing human sequences from any kind (ampliconic or not) of viral sequenced sample, which retains non-human reads in a format ready to be submitted to public databases.</p>\n\n<blockquote class=\"comment\">\n  <comment-title>Nature of the input data</comment-title>\n  <p>We will use sequencing data of bronchoalveolar lavage fluid (BALF) samples obtained from early COVID-19 patients in China as our input data.\nSince such samples are expected to be contaminated signficantly with human sequenced reads, the effect of the cleaning steps will be much more apparent than for ampliconic sequencing data from diagnostic patient swabs.\nNevertheless the cleaning processs does not rely on any particular sample isolation or preprcocessing method and could be used unaltered on, for example, ARTIC amplified SARS-CoV-2 samples.</p>\n\n</blockquote>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n  <p>In this tutorial, we will deal with:</p>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#get-data\" id=\"markdown-toc-get-data\">Get data</a>    <ol>\n      <li><a href=\"#getting-the-sequencing-data\" id=\"markdown-toc-getting-the-sequencing-data\">Getting the sequencing data</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#read-trimming-and-mapping\" id=\"markdown-toc-read-trimming-and-mapping\">Read trimming and mapping</a></li>\n  <li><a href=\"#obtaining-the-identifiers-of-non-human-read-pairs\" id=\"markdown-toc-obtaining-the-identifiers-of-non-human-read-pairs\">Obtaining the identifiers of non-human read pairs</a></li>\n  <li><a href=\"#use-the-non-human-read-identifiers-to-extract-the-reads-of-interest-from-the-original-inputs\" id=\"markdown-toc-use-the-non-human-read-identifiers-to-extract-the-reads-of-interest-from-the-original-inputs\">Use the non-human read identifiers to extract the reads of interest from the original inputs</a></li>\n  <li><a href=\"#conclusion\" id=\"markdown-toc-conclusion\">Conclusion</a></li>\n</ol>\n\n</blockquote>\n\n<h1 id=\"get-data\">Get data</h1>\n\n<p>As always, it is best to give each analysis you are performing with Galaxy its own history, so let’s start with preparing this:</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Prepare new history</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Create a new history for this tutorial and give it a proper name</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-new-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-new-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a new history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>Click the <i class=\"fas fa-plus\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">new-history</span> icon at the top of the history panel:</p>   <p><img src=\"/training-material/shared/images/history_create_new.svg\" alt=\"UI for creating new history\" /></p>   <!-- the original drawing can be found here https://docs.google.com/drawings/d/1cCBrLAo4kDGic5QyB70rRiWJAKTenTU8STsKDaLcVU8/edit?usp=sharing --> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-renaming-a-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-renaming-a-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Renaming a history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ol>   <li>Click on <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> (<strong>Edit</strong>) next to the history name (which by default is “Unnamed history”)</li>   <li>Type the new name</li>   <li>Click on <strong>Save</strong></li> </ol>   <p>If you do not have the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> (<strong>Edit</strong>) next to the history name:</p>   <ol>   <li>Click on <strong>Unnamed history</strong> (or the current name of the history) (<strong>Click to rename history</strong>) at the top of your history panel</li>   <li>Type the new name</li>   <li>Press <kbd>Enter</kbd></li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h2 id=\"getting-the-sequencing-data\">Getting the sequencing data</h2>\n\n<p>The sequenced reads datasets used in this tutorial (4 files representing 2 Illumina paired-end sequenced samples) have been deposited on <a href=\"https://zenodo.org/record/3732359/\">Zenodo</a> and can be uploaded to Galaxy via their URLs.\nAfter that, we will arrange the uploaded data into a collection in our Galaxy history to facilitate its handling in the analysis.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Data upload and rearrangement</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Upload the data from Zenodo via URLs</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-via-links\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-via-links\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing via links</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <p>The URLs for our example data are these:</p>\n\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/3732359/files/SRR10903401_r1.fq.gz\nhttps://zenodo.org/record/3732359/files/SRR10903401_r2.fq.gz\nhttps://zenodo.org/record/3732359/files/SRR10903402_r1.fq.gz\nhttps://zenodo.org/record/3732359/files/SRR10903402_r2.fq.gz\n</code></pre></div>      </div>\n    </li>\n    <li>\n      <p>Arrange the data into a paired dataset collection</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-paired-collection\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-paired-collection\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a paired collection</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on <i class=\"far fa-check-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-selector</span> <strong>Select Items</strong> at the top of the history panel <img src=\"/training-material/topics/galaxy-interface/images/historyItemControls.png\" alt=\"Select Items button\" /></li>   <li>Check all the datasets in your history you would like to include</li>   <li>     <p>Click <strong>n of N selected</strong> and choose <strong>Build List of Dataset Pairs</strong></p>   </li>   <li>Change the text of <em>unpaired forward</em> to a common selector for the forward reads</li>   <li>Change the text of <em>unpaired reverse</em> to a common selector for the reverse reads</li>   <li>Click <strong>Pair these datasets</strong> for each valid <em>forward</em> and <em>reverse</em> pair.</li>   <li>Enter a name for your collection</li>   <li>Click <strong>Create List</strong> to build your collection</li>   <li>Click on the checkmark icon at the top of your history again</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <p>For the example datasets this means:</p>\n      <ul>\n        <li>You need to tell Galaxy about the suffix for your forward and reverse reads, respectively:\n          <ul>\n            <li>set the text of <em>unpaired forward</em> to: <code class=\"language-plaintext highlighter-rouge\">_r1.fq.gz</code></li>\n            <li>set the text of <em>unpaired reverse</em> to: <code class=\"language-plaintext highlighter-rouge\">_r2.fq.gz</code></li>\n            <li>click: <code class=\"language-plaintext highlighter-rouge\">Auto-pair</code></li>\n          </ul>\n\n          <p>All datasets should now be moved to the <em>paired section</em> of the dialog, and the middle column there should show that only the sample accession numbers, <em>i.e.</em> <code class=\"language-plaintext highlighter-rouge\">SRR10903401</code> and <code class=\"language-plaintext highlighter-rouge\">SRR10903402</code>, will be used as the pair names.</p>\n        </li>\n        <li>Make sure <em>Hide original elements</em> is checked to obtain a cleaned-up history after building the collection.</li>\n        <li>Click <em>Create Collection</em></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h1 id=\"read-trimming-and-mapping\">Read trimming and mapping</h1>\n\n<p>In order to learn which of the reads of each of the input samples are of likely human origin, we need to map the reads to the human reference genome. To improve the quality of this step we will also trim low-quality bases from the ends of all reads before passing them to the read mapping software.</p>\n\n<blockquote class=\"comment\">\n  <comment-title></comment-title>\n\n  <p>Do you want to learn more about the principles behind quality control (including trimming) and mapping? Follow our dedicated tutorials:</p>\n  <ul>\n    <li><a href=\"/training-material/topics/sequence-analysis/tutorials/quality-control/tutorial.html\">Quality Control</a>.</li>\n    <li><a href=\"/training-material/topics/sequence-analysis/tutorials/mapping/tutorial.html\">Mapping</a>.</li>\n  </ul>\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Trim reads and map them to the human reference genome</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/pjbriggs/trimmomatic/trimmomatic/0.38.0\" title=\"Trimmomatic tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Trimmomatic</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.38.0)</span> with default settings and:\n      <ul>\n        <li><em>“Single-end or paired-end reads?”</em>: <code class=\"language-plaintext highlighter-rouge\">Paired-end (as collection)</code>\n          <ul>\n            <li><em>“Select FASTQ dataset collection with R1/R2 pair”</em>: the collection of sequenced reads input datasets</li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/devteam/bwa/bwa_mem/0.7.17.2\" title=\"Map with BWA-MEM tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Map with BWA-MEM</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.7.17.2)</span> with the following parameters:\n      <ul>\n        <li><em>“Will you select a reference genome from your history or use a built-in index?”</em>: <code class=\"language-plaintext highlighter-rouge\">Use a built-in genome index</code>\n          <ul>\n            <li>\n              <p><em>“Using reference genome”</em>: <code class=\"language-plaintext highlighter-rouge\">Human Dec. 2013 (GRCh38/hg38)(hg38)</code></p>\n\n              <p>The exact name of this version of the human reference genome may vary between Galaxy servers. Start typing <code class=\"language-plaintext highlighter-rouge\">hg38</code> in the select box to reveal available choices on your server.</p>\n            </li>\n          </ul>\n        </li>\n        <li><em>“Single or Paired-end reads”</em>: <code class=\"language-plaintext highlighter-rouge\">Paired Collection</code>\n          <ul>\n            <li><em>“Select a paired collection”</em>: the <code class=\"language-plaintext highlighter-rouge\">paired</code> output of <strong>Trimmomatic</strong></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h1 id=\"obtaining-the-identifiers-of-non-human-read-pairs\">Obtaining the identifiers of non-human read pairs</h1>\n\n<p>The mapping step above has produced a collection of BAM datasets that store, for each sample, which of its reads map to the human genome (and if so to which position on the genome though we are not interested in this information), and which ones could not be mapped to it. It is these <em>unmapped</em> reads that we are interested in, but how do we get at them?</p>\n\n<p>The logic of the following steps is:</p>\n\n<ol>\n  <li>\n    <p>Filter the BAM dataset for each sample for only those reads that could not be mapped to the human reference genome, and for which also the read mate in the pair could not be mapped to this genome.</p>\n\n    <p>In other words, if only one read of a read pair can be mapped to the human genome we play it safe and discard the pair.</p>\n  </li>\n  <li>\n    <p>Emit the remaining reads in a format (we choose FASTA here) from which it is easy to extract the read identifiers</p>\n  </li>\n  <li>\n    <p>Extract the read identifiers</p>\n  </li>\n</ol>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Filter for read pairs not mapping to the human genome and extract their identifiers</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/samtools_fastx/samtools_fastx/1.9+galaxy1\" title=\"Samtools fastx tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Samtools fastx</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.9+galaxy1)</span> with the following parameter settings:\n      <ul>\n        <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“BAM or SAM file to convert”</em>: the output of <strong>Map with BWA-MEM</strong></li>\n        <li><em>“Output format”</em>: <code class=\"language-plaintext highlighter-rouge\">FASTA</code></li>\n        <li>\n          <p><em>“outputs”</em>: select <code class=\"language-plaintext highlighter-rouge\">READ1</code></p>\n\n          <p>With this setting we are choosing to retrieve only the forward reads of each pair as a single result dataset.\nSince the forward and reverse reads of a pair share their read identifier, we do not need the reverse reads.</p>\n        </li>\n        <li>\n          <p><em>“Omit or append read numbers”</em>: <code class=\"language-plaintext highlighter-rouge\">Do not append /1 and /2 to read names</code></p>\n\n          <p>Adding this first or second read of the pair indicator to the read name would make the result dependent on which half of the reads we retrieve. We do not want this.</p>\n        </li>\n        <li><em>“Require that these flags are set”</em>:\n          <ul>\n            <li><code class=\"language-plaintext highlighter-rouge\">read is unmapped</code></li>\n            <li><code class=\"language-plaintext highlighter-rouge\">mate is unmapped</code></li>\n          </ul>\n\n          <p>This setting makes sure we retain only read pairs for which none of the two reads could be mapped to the human genome.</p>\n        </li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"Grep1\" title=\"Select lines that match an expression tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Select lines that match an expression</strong></span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“Select lines from”</em>: the output of <strong>Samtools fastx</strong></li>\n        <li><em>“that”</em>: <code class=\"language-plaintext highlighter-rouge\">Matching</code></li>\n        <li><em>“the pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">^&gt;.+</code></li>\n      </ul>\n\n      <p>This will select only those lines from the FASTA inputs that start with a <code class=\"language-plaintext highlighter-rouge\">&gt;</code> character, <em>i.e.</em> will retain the identifier lines, but not the sequence lines.</p>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_replace_in_line/1.1.2\" title=\"Replace Text in entire line tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Replace Text in entire line</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.1.2)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“File to process”</em>: the output of <strong>Select</strong></li>\n        <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Replacement”</em>:\n          <ul>\n            <li><em>“Find Pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">^&gt;(.+)</code></li>\n            <li><em>“Replace with”</em>: <code class=\"language-plaintext highlighter-rouge\">\\1</code></li>\n          </ul>\n\n          <p>This find and replacement pattern will work on lines starting with a <code class=\"language-plaintext highlighter-rouge\">&gt;</code> character and replace each such line with the content following the <code class=\"language-plaintext highlighter-rouge\">&gt;</code> character (the <code class=\"language-plaintext highlighter-rouge\">(.+)</code> part that gets referenced as <code class=\"language-plaintext highlighter-rouge\">\\1</code> in the replacement pattern).</p>\n        </li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h1 id=\"use-the-non-human-read-identifiers-to-extract-the-reads-of-interest-from-the-original-inputs\">Use the non-human read identifiers to extract the reads of interest from the original inputs</h1>\n\n<p>We are almost there! We already know the identifiers of all reads we would like to retain, we only need a way to filter the original input datasets for these identifiers.</p>\n\n<blockquote class=\"comment\">\n  <comment-title>Why not use the unmapped reads directly?</comment-title>\n\n  <p>When you followed the previous steps you may have noticed that <strong>Samtools fastx</strong> offers <em>fastq</em> as an output format.\nSince we used this tool to report the unmapped reads, you may be wondering why we did not simply ask the tool to write the reads in the format we want and be done with it.</p>\n\n  <p>The answer is: we could have done that (and some people follow this approach), but remember that we trimmed the reads before mapping them, which means the extracted unmapped reads would not be identical to the input reads.</p>\n\n  <p>It is good practice to submit sequencing data to public databases in as raw a state as possible to leave it up to the people downloading that data to apply processing steps as they see fit.</p>\n\n</blockquote>\n\n<p>The <strong>seqtk_subseq</strong> tool offfers the identifier-based filtering functionality we are looking for.\nAs a slight complication, however, the tool is not prepared to handle paired read collections like the one we organized our input data into.\nFor this reason, we need to first unzip our collection into two simple list collections - one with the forward reads, the other one with the reverse reads of all samples.\nThen, after processing both with <strong>seqtk_subseq</strong>, we zip the filtered collections back into one.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Identifier-based extraction of non-human reads from the input data</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"__UNZIP_COLLECTION__\" title=\"Unzip Collection tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Unzip Collection</strong></span> with the following setting:\n      <ul>\n        <li><em>“Input Paired Dataset”</em>: the collection of original sequenced reads input datasets</li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/seqtk/seqtk_subseq/1.3.1\" title=\"seqtk_subseq tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>seqtk_subseq</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.3.1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“Input FASTA/Q file”</em>: the first (forward reads) output of <strong>Unzip Collection</strong></li>\n        <li><em>“Select source of sequence choices”</em>: <code class=\"language-plaintext highlighter-rouge\">FASTA/Q ID list</code>\n          <ul>\n            <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> the collection of read identifiers; output of <strong>Replace Text</strong></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/seqtk/seqtk_subseq/1.3.1\" title=\"seqtk_subseq tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>seqtk_subseq</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.3.1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“Input FASTA/Q file”</em>: the second (reverse reads) output of <strong>Unzip Collection</strong></li>\n        <li><em>“Select source of sequence choices”</em>: <code class=\"language-plaintext highlighter-rouge\">FASTA/Q ID list</code>\n          <ul>\n            <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> the collection of read identifiers; output of <strong>Replace Text</strong></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"__ZIP_COLLECTION__\" title=\"Zip Collection tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Zip Collection</strong></span> with the following settings:\n      <ul>\n        <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“Input Dataset (Forward)”</em>: the collection of cleaned forward reads; output of the first run of <strong>seqtk_subseq</strong></li>\n        <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“Input Dataset (Reverse)”</em>: the collection of cleaned reverse reads; output of the second run of <strong>seqtk_subseq</strong></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h1 id=\"conclusion\">Conclusion</h1>\n\n<p>Data cleaning is a standard procedure for clinical sequencing datasets and is a rather straightforward process in Galaxy.\nYou just learnt how to remove human reads from any number of paired-end sequenced samples in parallel using collections and just a handful of tools.\nCleaning of single-end data would use the same tools (with adjusted settings), but would work on data arranged in a simple list collection instead of in a paired collection.</p>\n"],"ref_slides":[],"hands_on":true,"slides":false,"mod_date":"2023-11-03 14:30:27 +0000","pub_date":"2021-08-04 12:11:40 +0000","version":14,"workflows":[{"workflow":"human-reads-removal.ga","tests":false,"url":"https://training.galaxyproject.org/training-material/topics/sequence-analysis/tutorials/human-reads-removal/workflows/human-reads-removal.ga","path":"topics/sequence-analysis/tutorials/human-reads-removal/workflows/human-reads-removal.ga","wfid":"sequence-analysis-human-reads-removal","wfname":"human-reads-removal","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/sequence-analysis-human-reads-removal/versions/human-reads-removal","license":null,"creators":[],"name":"GTN - Sequence Analyses - Removal of human reads from SARS-CoV-2 sequencing data","title":"GTN - Sequence Analyses - Removal of human reads from SARS-CoV-2 sequencing data","test_results":null,"modified":"2024-06-18 00:05:43 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Collection\\nInput Dataset Collection\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"Trimmomatic\"];\n  0 -->|output| 1;\n  2[\"Unzip Collection\"];\n  0 -->|output| 2;\n  3[\"Map with BWA-MEM\"];\n  1 -->|fastq_out_paired| 3;\n  4[\"Samtools fastx\"];\n  3 -->|bam_output| 4;\n  5[\"Select\"];\n  4 -->|forward| 5;\n  6[\"Replace Text\"];\n  5 -->|out_file1| 6;\n  7[\"seqtk_subseq\"];\n  2 -->|forward| 7;\n  6 -->|outfile| 7;\n  8[\"seqtk_subseq\"];\n  2 -->|reverse| 8;\n  6 -->|outfile| 8;\n  9[\"Paired-end collection of cleaned reads\"];\n  7 -->|default| 9;\n  8 -->|default| 9;\n  f24bbf28-dc51-440f-a758-ac05033f0645[\"Output\\nCleaned Data\"];\n  9 --> f24bbf28-dc51-440f-a758-ac05033f0645;\n  style f24bbf28-dc51-440f-a758-ac05033f0645 stroke:#2c3143,stroke-width:4px;"}],"api":"https://training.galaxyproject.org/training-material/api/topics/sequence-analysis/tutorials/human-reads-removal/tutorial.json","tools":["Grep1","__UNZIP_COLLECTION__","__ZIP_COLLECTION__","toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_replace_in_line/1.1.2","toolshed.g2.bx.psu.edu/repos/devteam/bwa/bwa_mem/0.7.17.2","toolshed.g2.bx.psu.edu/repos/iuc/samtools_fastx/samtools_fastx/1.9+galaxy1","toolshed.g2.bx.psu.edu/repos/iuc/seqtk/seqtk_subseq/1.3.1","toolshed.g2.bx.psu.edu/repos/pjbriggs/trimmomatic/trimmomatic/0.38.0","toolshed.g2.bx.psu.edu/repos/pjbriggs/trimmomatic/trimmomatic/0.38.1"],"supported_servers":{"exact":[{"url":"https://usegalaxy.fr/","name":"UseGalaxy.fr","usegalaxy":false},{"url":"https://usegalaxy.org","name":"UseGalaxy.org (Main)","usegalaxy":true}],"inexact":[{"url":"https://galaxy.mesocentre.uca.fr","name":"Galaxy@AuBi","usegalaxy":false},{"url":"https://galaxytrakr.org/","name":"GalaxyTrakr","usegalaxy":false},{"url":"https://mississippi.sorbonne-universite.fr","name":"MISSISSIPPI","usegalaxy":false},{"url":"https://usegalaxy.be/","name":"UseGalaxy.be","usegalaxy":false},{"url":"https://usegalaxy.cz/","name":"UseGalaxy.cz","usegalaxy":false},{"url":"https://usegalaxy.eu","name":"UseGalaxy.eu","usegalaxy":true},{"url":"https://usegalaxy.no/","name":"UseGalaxy.no","usegalaxy":false},{"url":"https://usegalaxy.org.au","name":"UseGalaxy.org.au","usegalaxy":true}]},"topic_name_human":"Sequence analysis","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"text_processing","owner":"bgruening","revisions":"d698c222f354","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"bwa","owner":"devteam","revisions":"e188dc7a68e6","tool_panel_section_label":"Mapping","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"samtools_fastx","owner":"iuc","revisions":"a8d69aee190e","tool_panel_section_label":"SAM/BAM","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"seqtk","owner":"iuc","revisions":"3da72230c066","tool_panel_section_label":"FASTA/FASTQ","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"trimmomatic","owner":"pjbriggs","revisions":"898b67846b47","tool_panel_section_label":"FASTA/FASTQ","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"trimmomatic","owner":"pjbriggs","revisions":"d94aff5ee623","tool_panel_section_label":"FASTA/FASTQ","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: text_processing\n  owner: bgruening\n  revisions: d698c222f354\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bwa\n  owner: devteam\n  revisions: e188dc7a68e6\n  tool_panel_section_label: Mapping\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: samtools_fastx\n  owner: iuc\n  revisions: a8d69aee190e\n  tool_panel_section_label: SAM/BAM\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: seqtk\n  owner: iuc\n  revisions: 3da72230c066\n  tool_panel_section_label: FASTA/FASTQ\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: trimmomatic\n  owner: pjbriggs\n  revisions: 898b67846b47\n  tool_panel_section_label: FASTA/FASTQ\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: trimmomatic\n  owner: pjbriggs\n  revisions: d94aff5ee623\n  tool_panel_section_label: FASTA/FASTQ\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":false,"slides_recordings":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial"}