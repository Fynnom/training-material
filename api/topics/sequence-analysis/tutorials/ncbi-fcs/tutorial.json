{"layout":"tutorial_hands_on","title":"Screening assembled genomes for contamination using NCBI FCS","zenodo_link":"https://zenodo.org/records/10932013","questions":["Are the sequences in a genome assembly contaminant-free?"],"objectives":["Learn how to screen a genome assembly for adaptor and vector contamination.","Learn how to screen a genome assembly for non-host organism contamination."],"time_estimation":"90M","key_points":["Contamination can arise from multiple sources and occur at multiple stages of a genome assembly project.","Contamination cleanup is essential for reliable comparative genomics analyses."],"contributions":{"authorship":["tvedtees"],"editing":["hexylena"],"funding":["NIH"]},"js_requirements":{"mathjax":null,"mermaid":false},"short_id":"T00439","url":"/topics/sequence-analysis/tutorials/ncbi-fcs/tutorial.html","topic_name":"sequence-analysis","tutorial_name":"ncbi-fcs","dir":"topics/sequence-analysis/tutorials/ncbi-fcs","symlink":null,"id":"sequence-analysis/ncbi-fcs","ref_tutorials":["<p>The National Center for Biotechnology Information (NCBI) performs contamination screening of genome assemblies submitted to the archival GenBank. Advances in genome sequencing have accelerated the production of genome assemblies and their submission to public databases, necessitating high-performance screening tools. Since contaminants can lead to misleading conclusions about the biology of the organism in question (e.g. gene content, gene evolution, etc.), ideally contamination screening should be performed after the initial contig assembly and prior to downstream genome analyses.</p>\n\n<p>NCBI has released a publicly-available Foreign Contamination Screen (FCS) tool suite to detect contaminants from various sources and produce a cleaned sequence set. This tutorial provides a quick example of two current FCS tools: FCS-adaptor identifies synthetic sequences used in library preparation, and FCS-GX (<span class=\"citation\"><a href=\"#Astashyn2024\">Astashyn <i>et al.</i> 2024</a></span>) identifies sequences from foreign organisms assigned to discordant taxonomies compared to the user-declared source organism.</p>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n  <p>In this tutorial, we will cover:</p>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#retrieving-the-data\" id=\"markdown-toc-retrieving-the-data\">Retrieving the data</a>    <ol>\n      <li><a href=\"#upload-the-genome-fasta-from-zenodo\" id=\"markdown-toc-upload-the-genome-fasta-from-zenodo\">Upload the genome FASTA from Zenodo</a></li>\n      <li><a href=\"#confirm-dataset-upload\" id=\"markdown-toc-confirm-dataset-upload\">Confirm dataset upload</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#importing-workflows\" id=\"markdown-toc-importing-workflows\">Importing Workflows</a></li>\n  <li><a href=\"#contamination-screening\" id=\"markdown-toc-contamination-screening\">Contamination screening</a>    <ol>\n      <li><a href=\"#running-the-ncbi-fcs-workflow\" id=\"markdown-toc-running-the-ncbi-fcs-workflow\">Running the NCBI FCS Workflow</a></li>\n      <li><a href=\"#interpreting-fcs-output\" id=\"markdown-toc-interpreting-fcs-output\">Interpreting FCS Output</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#conclusion\" id=\"markdown-toc-conclusion\">Conclusion</a></li>\n</ol>\n\n</blockquote>\n\n<h1 id=\"retrieving-the-data\">Retrieving the data</h1>\n\n<p>FCS operates on assembled genome sequences and is not intended for use on raw reads. The following tutorial uses an assembled genome from yeast (<em>Saccharomyces cerevisiae</em>) with contaminants artificially inserted into the genome. The first step is to retrieve the genome FASTA.</p>\n\n<h2 id=\"upload-the-genome-fasta-from-zenodo\">Upload the genome FASTA from Zenodo</h2>\n\n<p>The following steps provide instructions to upload the test dataset into your Galaxy instance.</p>\n<blockquote class=\"hands_on\">\n  <hands-on-title> Data Upload </hands-on-title>\n\n  <ol>\n    <li>\n      <p>Create a new history for this tutorial</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-new-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-new-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a new history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>Click the <i class=\"fas fa-plus\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">new-history</span> icon at the top of the history panel:</p>   <p><img src=\"/training-material/shared/images/history_create_new.svg\" alt=\"UI for creating new history\" /></p>   <!-- the original drawing can be found here https://docs.google.com/drawings/d/1cCBrLAo4kDGic5QyB70rRiWJAKTenTU8STsKDaLcVU8/edit?usp=sharing --> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>Copy the datasets URLs into clipboard.\nClick on the copy button in the right upper corner of the box below.\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/records/10932013/files/FCS_combo_test.fa\n</code></pre></div>      </div>\n    </li>\n    <li>\n      <p>Upload <code class=\"language-plaintext highlighter-rouge\">fasta.gz</code> dataset into Galaxy</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-via-links\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-via-links\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing via links</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-data-from-a-data-library\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-data-from-a-data-library\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing data from a data library</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>As an alternative to uploading the data from a URL or your computer, the files may also have been made available from a <em>shared data library</em>:</p>   <ol>   <li>Go into <strong>Shared data</strong> (top panel) then <strong>Data libraries</strong></li>   <li>Navigate to  the correct folder as indicated by your instructor.     <ul>       <li>On most Galaxies tutorial data will be provided in a folder named <strong>GTN - Material –&gt; Topic Name -&gt; Tutorial Name</strong>.</li>     </ul>   </li>   <li>Select the desired files</li>   <li>Click on <strong>Add to History</strong> <i class=\"fas fa-caret-down\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-dropdown</span> near the top and select <strong>as Datasets</strong> from the dropdown menu</li>   <li>     <p>In the pop-up window, choose</p>     <ul>       <li><em>“Select history”</em>: the history you want to import the data to (or create a new one)</li>     </ul>   </li>   <li>Click on <strong>Import</strong></li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h2 id=\"confirm-dataset-upload\">Confirm dataset upload</h2>\n\n<p>Your data should look like this:</p>\n\n<figure id=\"figure-1\" style=\"max-width: 90%;\"><img src=\"../../images/ncbi-fcs/fcs-galaxy-1.jpg\" alt=\"Galaxy History with FCS.combo.test.fa showing in green, successfully uploaded.\" width=\"500\" height=\"220\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/ncbi-fcs/fcs-galaxy-1.jpg\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 1</strong>:</span> Galaxy History with Uploaded Data.</figcaption></figure>\n\n<h1 id=\"importing-workflows\">Importing Workflows</h1>\n\n<p>Next we will import a Galaxy workflow - a chain of tools to perform a set of operations on a user-supplied input. Specificially in this workflow, we will:</p>\n\n<ol>\n  <li>Screen the genome for foreign organism sequences using <strong>FCS-GX</strong> <code class=\"language-plaintext highlighter-rouge\">screen</code> mode.</li>\n  <li>Produce a cleaned set of contigs using <strong>FCS-GX</strong> <code class=\"language-plaintext highlighter-rouge\">clean</code> mode.</li>\n  <li>Screen the genome for synthetic sequences using <strong>FCS-adaptor</strong> and remove identified contaminants.</li>\n  <li>Produce a final set of cleaned contigs using a second iteration of <strong>FCS-GX</strong> <code class=\"language-plaintext highlighter-rouge\">clean</code> mode.</li>\n</ol>\n\n<figure id=\"figure-2\" style=\"max-width: 90%;\"><img src=\"../../images/ncbi-fcs/fcs-galaxy-2.jpg\" alt=\"The workflow pictured has five steps, input data is provided to FCS-GX screen, and both of these are inputs to FCS-GX clean. This output is fed to FCS-adapter screen, and both of these outputs are fed to FCS-adapter clean. \" width=\"2325\" height=\"1208\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/ncbi-fcs/fcs-galaxy-2.jpg\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 2</strong>:</span> NCBI Foreign Contamination Screen Galaxy Workflow.</figcaption></figure>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title> Importing Galaxy Workflows </hands-on-title>\n\n  <ol>\n    <li>\n      <p>Ensure you are logged in to Galaxy</p>\n    </li>\n    <li>\n      <p>Import the workflow into Galaxy</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"hands_on\">   <div class=\"box-title hands_on-title\" id=\"hands-on-importing-and-launching-a-gtn-workflow\"><i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i> Hands-on: Importing and launching a GTN workflow</div>   <div class=\"show-when-galaxy-proxy-active\"> <span class=\"workflow\" data-workflow=\"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/sequence-analysis-ncbi-fcs/versions/ncbi-foreign-contamination-screen\">Launch <strong>NCBI Foreign Contamination Screen Workflow</strong> <i class=\"fas fa-share-alt\" aria-hidden=\"true\"></i></span> (<a href=\"https://github.com/galaxyproject/training-material/blob/main/topics/sequence-analysis/tutorials/ncbi-fcs/workflows/NCBI-Foreign-Contamination-Screen.ga\">View on GitHub</a>, <a href=\"https://training.galaxyproject.org/training-material/topics/sequence-analysis/tutorials/ncbi-fcs/workflows/NCBI-Foreign-Contamination-Screen.ga\">Download workflow</a>) workflow. </div>   <div class=\"hide-when-galaxy-proxy-active\"> Click to  <a href=\"https://my.galaxy.training/?path=/workflows/trs_import%3Frun_form=true%26trs_url=https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/sequence-analysis-ncbi-fcs/versions/ncbi-foreign-contamination-screen\">     Launch <strong>NCBI Foreign Contamination Screen Workflow</strong> <i class=\"fas fa-share-alt\" aria-hidden=\"true\"></i> </a> (<a href=\"https://github.com/galaxyproject/training-material/blob/main/topics/sequence-analysis/tutorials/ncbi-fcs/workflows/NCBI-Foreign-Contamination-Screen.ga\">View on GitHub</a>, <a href=\"https://training.galaxyproject.org/training-material/topics/sequence-analysis/tutorials/ncbi-fcs/workflows/NCBI-Foreign-Contamination-Screen.ga\">Download workflow</a>) </div>   <!--SNIPPET-->   <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-if-this-does-not-work\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-if-this-does-not-work\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: If this does not work</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on <em>Workflow</em> on the top menu bar of Galaxy. You will see a list of all your workflows.</li>   <li>Click on <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Import</strong> at the top-right of the screen</li>   <li>Paste the following URL into the box labelled <em>“Archived Workflow URL”</em>: <code class=\"language-plaintext highlighter-rouge\">https://training.galaxyproject.org/training-material/topics/sequence-analysis/tutorials/ncbi-fcs/workflows/NCBI-Foreign-Contamination-Screen.ga</code></li>   <li>Click the <strong>Import workflow</strong> button</li> </ul>   <p>Below is a short video demonstrating how to import a workflow from GitHub using this procedure:</p>   <figure> <iframe credentialless=\"\" allowfullscreen=\"\" referrerpolicy=\"no-referrer\" sandbox=\"allow-scripts allow-same-origin\" allow=\"accelerometer 'none'; ambient-light-sensor 'none'; autoplay 'none'; battery 'none'; bluetooth 'none'; browsing-topics 'none'; camera 'none'; ch-ua 'none'; display-capture 'none'; domain-agent 'none'; document-domain 'none'; encrypted-media 'none'; execution-while-not-rendered 'none'; execution-while-out-of-viewport 'none'; gamepad 'none'; geolocation 'none'; gyroscope 'none'; hid 'none'; identity-credentials-get 'none'; idle-detection 'none'; keyboard-map 'none'; local-fonts 'none'; magnetometer 'none'; microphone 'none'; midi 'none'; navigation-override 'none'; otp-credentials 'none'; payment 'none'; picture-in-picture 'none'; publickey-credentials-create 'none'; publickey-credentials-get 'none'; screen-wake-lock 'none'; serial 'none'; speaker-selection 'none'; sync-xhr 'none'; usb 'none'; web-share 'none'; window-management 'none'; xr-spatial-tracking 'none'\" csp=\"sandbox allow-scripts allow-same-origin;\" width=\"560\" height=\"315\" src=\"https://www.youtube-nocookie.com/embed/hoP36Te5wko\" title=\"Importing a workflow from URL\" frameborder=\"0\" loading=\"lazy\"></iframe> <figcaption>   <span class=\"figcaption-prefix\"><strong>Video</strong>:</span> Importing a workflow from URL</figcaption> </figure> </blockquote>   <p><!--END_SNIPPET--></p> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <blockquote class=\"warning\">\n        <warning-title>Log in to Galaxy</warning-title>\n        <p>If the workflow failed to import, it is usually because you are not logged in.</p>\n      </blockquote>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>Once the workflow is loaded, your workflow page should look like this:</p>\n\n<figure id=\"figure-3\" style=\"max-width: 90%;\"><img src=\"../../images/ncbi-fcs/fcs-galaxy-3.jpg\" alt=\"Galaxy Workflows page with NCBI Foreign Contamination Screen workflow loaded and ready to run.\" width=\"2421\" height=\"917\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/ncbi-fcs/fcs-galaxy-3.jpg\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 3</strong>:</span> Galaxy Workflows page with NCBI Foreign Contamination Screen.</figcaption></figure>\n\n<h1 id=\"contamination-screening\">Contamination screening</h1>\n\n<h2 id=\"running-the-ncbi-fcs-workflow\">Running the NCBI FCS Workflow</h2>\n\n<p>Next you will run the Galaxy workflow. Here you will configure the parameters for the FCS run according to the target organism.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title> Running the NBCI FCS Workflow </hands-on-title>\n  <ol>\n    <li>Collect inputs\n      <ol>\n        <li>Assembled genome in <code class=\"language-plaintext highlighter-rouge\">fasta/fasta.gz</code> format</li>\n        <li>Taxonomic information for source organism</li>\n      </ol>\n    </li>\n    <li>Launch the Workflow\n      <ol>\n        <li>Click the Workflow menu located in the top menu bar</li>\n        <li>Click the <i class=\"fas fa-play\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">workflow-run</span> button located in the NCBI Foreign Contamination Screen Workflow box</li>\n        <li>Click “Expand to full workflow form.”</li>\n        <li>In the <i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> 1: Input genome menu:\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input file (Fasta file)”</em>: <code class=\"language-plaintext highlighter-rouge\">1:FCS.combo.test.fa</code></li>\n          </ul>\n        </li>\n        <li>In the <strong>2: FCS-GX screen</strong> menu:\n          <ul>\n            <li>Select the appropriate taxonomic division for <strong>Taxonomy entry</strong>: <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>div</strong> (<code class=\"language-plaintext highlighter-rouge\">fung:budding yeasts</code> in this example).</li>\n            <li>Set the <strong>Advanced Options</strong>: <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Database location</strong> to <code class=\"language-plaintext highlighter-rouge\">/cvmfs/data.galaxyproject.org/byhand/ncbi_fcs_gx/all</code></li>\n          </ul>\n        </li>\n        <li>In the <strong>4: FCS-adaptor screen</strong> menu:\n          <ul>\n            <li>Select the appropriate taxonomy for <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Choose the taxonomy</strong> (<code class=\"language-plaintext highlighter-rouge\">Eukaryotes</code> in this example).</li>\n          </ul>\n        </li>\n        <li>Run the workflow</li>\n        <li>Take a coffee break!</li>\n      </ol>\n    </li>\n  </ol>\n</blockquote>\n\n<h2 id=\"interpreting-fcs-output\">Interpreting FCS Output</h2>\n\n<p>Running NCBI FCS on Galaxy is dependent on loading a large reference database on an adequate host. Currently the database is not persistent, meaning run times may vary. Most runs <em>should</em> complete in around one hour.</p>\n\n<p>After the workflow is completed, you will be able to visualize tables of identified contaminants and can access FASTA files of clean sequences separated from contaminants.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title> Reviewing FCS Contamination Reports </hands-on-title>\n  <ol>\n    <li>\n      <p>Look at the FCS-GX contamination report</p>\n\n      <ol>\n        <li>In your Galaxy history, click the <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> icon for 3: <strong>NCBI FCS GX on data 1: Action report</strong></li>\n        <li>\n          <p>Confirm that the taxonomic division you specified for the workflow run appears in the metadata in the first row of the file. It should appear as the “asserted-div” and in the list of “inferred-primary-divs”.</p>\n\n          <blockquote class=\"warning\">\n            <warning-title> My organism's division is not in inferred-primary-divs </warning-title>\n            <p>If your target organism division is not in the set of inferred-primary-divs, it means that the assembly is likely heavily contaminated. FCS-GX will still call contaminants with respect to the taxonomy you define as the target organism (i.e. the primary division), but you should review the sequencing and assembly data for errors.</p>\n          </blockquote>\n        </li>\n        <li>Review the contaminated sequence list, the suggested contamination cleanup actions, and the taxonomic divisions assigned to contaminants</li>\n      </ol>\n\n      <blockquote class=\"question\">\n        <question-title></question-title>\n\n        <ol>\n          <li>What are the major contaminants in this genome assembly?</li>\n          <li>When was this contamination likely introduced in the genome assembly process?</li>\n        </ol>\n\n        <blockquote class=\"solution\">\n          <solution-title></solution-title>\n\n          <ol>\n            <li><em>Homo sapiens</em> (human) and <em>Pseudomonas aeruginosa</em>. Note that for various reasons the actual contaminating genus/species isn’t reported as the top_tax_name.</li>\n            <li>Contamination was likely introduced at the sample/library preparation stage. <em>Pseudomonas aeruginosa</em> can be found in multiple human tissues, including skin flora.</li>\n          </ol>\n        </blockquote>\n      </blockquote>\n    </li>\n    <li>\n      <p>Look at the FCS-GX cleaned sequences</p>\n\n      <ol>\n        <li>Click the box in your workflow history - 1: <strong>FCS.combo.test.fa</strong>. Note the total number of sequences.</li>\n        <li>Click the box in your workflow history - 4: <strong>NCBI FCS GX on data 3 and data 1: Fasta for EXCLUDE entries</strong>. Note the total number of sequences.</li>\n        <li>Click the box in your workflow history - 5: <strong>NCBI FCS GX on data 3 and data 1: Cleaned Fasta</strong>. Note the total number of sequences as well as Applied actions.</li>\n        <li>Confirm that Cleaned Fasta sequences (Step 5) = Total sequences (Step 1) - Contaminant sequences (Step 4)</li>\n      </ol>\n    </li>\n    <li>\n      <p>Look at the FCS-adaptor contamination report</p>\n\n      <ol>\n        <li>In your Galaxy history, click the <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> icon for 6: <strong>NCBI FCS Adaptor on data 5: Adaptor report</strong></li>\n        <li>Review the contaminated sequence list, the suggested contamination cleanup actions, and the identity of adaptor/vector contaminants. Adaptor/vector sequences can be found on the <a href=\"https://ftp.ncbi.nlm.nih.gov/pub/UniVec/UniVec\">NCBI UniVec FTP</a> page.</li>\n      </ol>\n\n      <blockquote class=\"question\">\n        <question-title></question-title>\n\n        <ol>\n          <li>What are the adaptor/vector contaminants in this genome assembly?</li>\n          <li>When was this contamination likely introduced in the genome assembly process?</li>\n        </ol>\n\n        <blockquote class=\"solution\">\n          <solution-title></solution-title>\n\n          <ol>\n            <li>Illumina PCR Primer sequence.</li>\n            <li>Contamination was likely introduced during contig assembly or polishing. Often the initial contig assembly is generated using long reads alone, so the introduction of contamination via polishing with untrimmed reads is the more likely explanation.</li>\n          </ol>\n        </blockquote>\n      </blockquote>\n    </li>\n    <li>\n      <p>Look at the FCS-adaptor cleaned sequences</p>\n\n      <ol>\n        <li>Click the box in your workflow history - 5: <strong>NCBI FCS GX on data 3 and data 1: Cleaned Fasta</strong>. Note the total number of sequences.</li>\n        <li>Click the box in your workflow history - 8: <strong>NCBI FCS GX on data 6 and data 5: Fasta for EXCLUDE entries</strong>. Note the total number of sequences as well as Applied actions.</li>\n        <li>Click the box in your workflow history - 9: <strong>NCBI FCS GX on data 6 and data 5: Cleaned Fasta</strong>. Note the total number of sequences.</li>\n      </ol>\n    </li>\n  </ol>\n\n  <blockquote class=\"warning\">\n    <warning-title> Two different cleaned FASTA files from FCS-adaptor step </warning-title>\n    <p>FCS-adaptor only removes sequences that are completely/mostly adaptor (assigned <code class=\"language-plaintext highlighter-rouge\">ACTION_EXCLUDE</code>) and adaptors near contig ends (assigned <code class=\"language-plaintext highlighter-rouge\">ACTION_TRIM</code>). FCS-adaptor <strong>does not remove</strong> small internal trims in large sequences. In this example, the FASTA file in workflow history - 7: <strong>NCBI FCS Adaptor on data 5: Cleaned Fasta</strong> is the same as the uncleaned input FASTA. FCS-GX <code class=\"language-plaintext highlighter-rouge\">clean</code> is required to handle these internal spans. The FASTA file in workflow history - 9: <strong>NCBI FCS GX on data 6 and data 5: Cleaned Fasta</strong> has the contigs seq_1 through seq_16 split into two separate contigs at the <code class=\"language-plaintext highlighter-rouge\">ACTION_TRIM</code> sites. If you want to hardmask these regions instead, you must download the tabular adaptor report, convert <code class=\"language-plaintext highlighter-rouge\">ACTION_TRIM</code> values to <code class=\"language-plaintext highlighter-rouge\">FIX</code>, and run the FCS-GX <code class=\"language-plaintext highlighter-rouge\">clean</code> tool separately.</p>\n  </blockquote>\n</blockquote>\n\n<h1 id=\"conclusion\">Conclusion</h1>\n\n<p>In this example, we removed 200 contaminant sequences from non-target organisms using FCS-GX and removed 16 internal adaptor sequences using FCS-adaptor, producing a cleaned yeast genome. Following contamination detection, we can perform separate validation checks to support the removal of these sequences from our assembly. One example is to perform BLAST searches or NUCmer alignments against reference genomes of the same or closely related species.</p>\n"],"ref_slides":[],"hands_on":true,"slides":false,"mod_date":"2024-04-16 12:17:01 +0000","pub_date":"2024-04-16 09:25:46 +0000","version":13,"workflows":[{"workflow":"NCBI-Foreign-Contamination-Screen.ga","tests":true,"url":"https://training.galaxyproject.org/training-material/topics/sequence-analysis/tutorials/ncbi-fcs/workflows/NCBI-Foreign-Contamination-Screen.ga","path":"topics/sequence-analysis/tutorials/ncbi-fcs/workflows/NCBI-Foreign-Contamination-Screen.ga","wfid":"sequence-analysis-ncbi-fcs","wfname":"ncbi-foreign-contamination-screen","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/sequence-analysis-ncbi-fcs/versions/ncbi-foreign-contamination-screen","license":"http://www.usa.gov/publicdomain/label/1.0/","creators":[{"class":"Organization","name":"National Center for Biotechnology Information","url":"https://github.com/ncbi/fcs"}],"name":"NCBI Foreign Contamination Screen","title":"NCBI Foreign Contamination Screen","test_results":null,"modified":"2024-06-21 00:05:31 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\nInput genome\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"FCS-GX screen\"];\n  0 -->|output| 1;\n  9741edf2-4be6-45a3-980d-99b1aea18380[\"Output\\nfcs_gx_action_report\"];\n  1 --> 9741edf2-4be6-45a3-980d-99b1aea18380;\n  style 9741edf2-4be6-45a3-980d-99b1aea18380 stroke:#2c3143,stroke-width:4px;\n  ddedd49f-8c57-4e3e-a158-3d66ce12f05c[\"Output\\nfcs_gx_taxonomy_report\"];\n  1 --> ddedd49f-8c57-4e3e-a158-3d66ce12f05c;\n  style ddedd49f-8c57-4e3e-a158-3d66ce12f05c stroke:#2c3143,stroke-width:4px;\n  2[\"FCS-GX clean\"];\n  1 -->|action_report| 2;\n  0 -->|output| 2;\n  f3a37b43-d304-4ec0-a023-197c9e0ce2e1[\"Output\\ngx_contam_fasta\"];\n  2 --> f3a37b43-d304-4ec0-a023-197c9e0ce2e1;\n  style f3a37b43-d304-4ec0-a023-197c9e0ce2e1 stroke:#2c3143,stroke-width:4px;\n  56716c7c-ac7f-42f7-bbef-62a36b4d3810[\"Output\\ngx_clean_fasta\"];\n  2 --> 56716c7c-ac7f-42f7-bbef-62a36b4d3810;\n  style 56716c7c-ac7f-42f7-bbef-62a36b4d3810 stroke:#2c3143,stroke-width:4px;\n  3[\"FCS-adaptor screen\"];\n  2 -->|clean_fasta| 3;\n  6a4baf46-80b0-4a96-b864-9201fc80cdb7[\"Output\\nfcs_adaptor_report\"];\n  3 --> 6a4baf46-80b0-4a96-b864-9201fc80cdb7;\n  style 6a4baf46-80b0-4a96-b864-9201fc80cdb7 stroke:#2c3143,stroke-width:4px;\n  1cad7ab4-a817-436c-9a63-fd4e3c6b4bbb[\"Output\\nadaptor_clean_fasta\"];\n  3 --> 1cad7ab4-a817-436c-9a63-fd4e3c6b4bbb;\n  style 1cad7ab4-a817-436c-9a63-fd4e3c6b4bbb stroke:#2c3143,stroke-width:4px;\n  4[\"FCS-adaptor clean\"];\n  3 -->|adaptor_report| 4;\n  2 -->|clean_fasta| 4;\n  0da68570-7490-4087-86c8-739522e1a776[\"Output\\nadaptor_contam_fasta\"];\n  4 --> 0da68570-7490-4087-86c8-739522e1a776;\n  style 0da68570-7490-4087-86c8-739522e1a776 stroke:#2c3143,stroke-width:4px;\n  4985eb07-30b0-4872-ab83-52ffeb619900[\"Output\\nfinal_clean_fasta\"];\n  4 --> 4985eb07-30b0-4872-ab83-52ffeb619900;\n  style 4985eb07-30b0-4872-ab83-52ffeb619900 stroke:#2c3143,stroke-width:4px;"}],"api":"https://training.galaxyproject.org/training-material/api/topics/sequence-analysis/tutorials/ncbi-fcs/tutorial.json","tools":["toolshed.g2.bx.psu.edu/repos/iuc/ncbi_fcs_gx/ncbi_fcs_gx/0.5.0+galaxy0","toolshed.g2.bx.psu.edu/repos/richard-burhans/ncbi_fcs_adaptor/ncbi_fcs_adaptor/0.5.0+galaxy0"],"supported_servers":{"exact":[{"url":"https://usegalaxy.org","name":"UseGalaxy.org (Main)","usegalaxy":true}],"inexact":[]},"topic_name_human":"Sequence analysis","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"ncbi_fcs_gx","owner":"iuc","revisions":"49f8eae39606","tool_panel_section_label":"FASTA/FASTQ","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"ncbi_fcs_adaptor","owner":"richard-burhans","revisions":"d55ad8533d58","tool_panel_section_label":"Sequence Contamination Filtering","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: ncbi_fcs_gx\n  owner: iuc\n  revisions: 49f8eae39606\n  tool_panel_section_label: FASTA/FASTQ\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: ncbi_fcs_adaptor\n  owner: richard-burhans\n  revisions: d55ad8533d58\n  tool_panel_section_label: Sequence Contamination Filtering\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":false,"slides_recordings":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial","contributors":[{"name":"Eric Tvedte","joined":"2024-03","id":"tvedtees","url":"https://training.galaxyproject.org/training-material/api/contributors/tvedtees.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/tvedtees/"},{"name":"Helena Rasche","orcid":"0000-0001-9760-8992","maintainer_contact":"gitter","matrix":"hexylena:matrix.org","joined":"2017-09","elixir_node":"nl","affiliations":["gallantries","by-covid","erasmusmc","elixir-europe","elixir-converge"],"former_affiliations":["deNBI","avans-atgm","uni-freiburg"],"contact_for_training":false,"location":{"country":"NL","lat":51.91,"lon":4.46},"id":"hexylena","url":"https://training.galaxyproject.org/training-material/api/contributors/hexylena.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/hexylena/"},{"name":"National Institutes of Health","short_name":"NIH","avatar":"/training-material/shared/images/nih.png","url":"https://training.galaxyproject.org/training-material/api/funders/NIH.json","funder":true,"github":false,"id":"NIH","page":"https://training.galaxyproject.org/training-material/hall-of-fame/NIH/"}]}