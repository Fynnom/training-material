{"layout":"tutorial_slides","title":"Circos","zenodo_link":"https://zenodo.org/record/4494146","questions":["What is Circos?","How can I use Circos within Galaxy?","What are some of the different track types I can plot?"],"objectives":null,"time_estimation":"2h","key_points":["Circos is very powerful, but also very complex","Creating plots is an iterative process","The full configuration directory can be downloaded from Galaxy to be further tweaked locally"],"contributors":["hexylena","shiltemann","gallantries"],"recordings":[{"captioners":["assuntad23","shiltemann"],"date":"2021-02-15","galaxy_version":"21.01","length":"6M","youtube_id":"KCtI5KLp05k","speakers":["hexylena"]}],"js_requirements":{"mathjax":null,"mermaid":false},"short_id":"S00100","url":"/topics/visualisation/tutorials/circos/slides.html","topic_name":"visualisation","tutorial_name":"circos","dir":"topics/visualisation/tutorials/circos","symlink":null,"id":"visualisation/circos","ref_tutorials":["<p>Circos (<span class=\"citation\"><a href=\"#krzywinski2009circos\">Krzywinski <i>et al.</i> 2009</a></span>) is a software package for visualizing data in a circular layout. This makes Circos ideal for exploring relationships between objects or positions. Circos plots have appeared in thousands of scientific publications. Although originally designed for visualizing genomic data, it can create figures from data in any field. In this tutorial we discuss the Galactic Circos (<span class=\"citation\"><a href=\"#Rasche_2020\">Rasche and Hiltemann 2020</a></span>) tool which enables you to access Circos via the convenient Galaxy interface, and even produce plots as part of your workflows!</p>\n\n<p><a href=\"../../images/circos-sample-panel.png\" rel=\"noopener noreferrer\"><img src=\"../../images/circos-sample-panel.png\" alt=\"Panel of example Circos images. \" width=\"950\" height=\"234\" loading=\"lazy\" /></a></p>\n\n<p>In this tutorial you will learn how to create such publication-ready Circos plots within Galaxy, and hopefully you can draw inspiration from these for developing your own plots.</p>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n  <p>In this tutorial, we will deal with:</p>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#background\" id=\"markdown-toc-background\">Background</a>    <ol>\n      <li><a href=\"#circos-is-an-iterative-process\" id=\"markdown-toc-circos-is-an-iterative-process\">Circos is an Iterative Process</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#circos-basics\" id=\"markdown-toc-circos-basics\">Circos Basics</a>    <ol>\n      <li><a href=\"#ideogram\" id=\"markdown-toc-ideogram\">Ideogram</a></li>\n      <li><a href=\"#data-tracks\" id=\"markdown-toc-data-tracks\">Data Tracks</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#tutorial-overview\" id=\"markdown-toc-tutorial-overview\">Tutorial Overview</a></li>\n  <li><a href=\"#example-cancer-genomics\" id=\"markdown-toc-example-cancer-genomics\">Example: Cancer Genomics</a>    <ol>\n      <li><a href=\"#data-upload\" id=\"markdown-toc-data-upload\">Data upload</a></li>\n      <li><a href=\"#ideogram-1\" id=\"markdown-toc-ideogram-1\">Ideogram</a></li>\n      <li><a href=\"#structural-variations\" id=\"markdown-toc-structural-variations\">Structural Variations</a></li>\n      <li><a href=\"#copy-number-variation\" id=\"markdown-toc-copy-number-variation\">Copy Number Variation</a></li>\n      <li><a href=\"#b-allele-frequency\" id=\"markdown-toc-b-allele-frequency\">B-allele Frequency</a></li>\n      <li><a href=\"#optional-final-tweaking-of-circos-plot\" id=\"markdown-toc-optional-final-tweaking-of-circos-plot\">Optional: Final Tweaking of Circos plot</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#example-presidential-debate\" id=\"markdown-toc-example-presidential-debate\">Example: Presidential Debate</a>    <ol>\n      <li><a href=\"#get-data\" id=\"markdown-toc-get-data\">Get Data</a></li>\n      <li><a href=\"#ideogram-2\" id=\"markdown-toc-ideogram-2\">Ideogram</a></li>\n      <li><a href=\"#highlights-track\" id=\"markdown-toc-highlights-track\">Highlights track</a></li>\n      <li><a href=\"#link-track\" id=\"markdown-toc-link-track\">Link Track</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#example-nature-cover-encode\" id=\"markdown-toc-example-nature-cover-encode\">Example: Nature Cover ENCODE</a>    <ol>\n      <li><a href=\"#data-formats\" id=\"markdown-toc-data-formats\">Data Formats</a></li>\n      <li><a href=\"#get-data-1\" id=\"markdown-toc-get-data-1\">Get data</a></li>\n      <li><a href=\"#create-plot\" id=\"markdown-toc-create-plot\">Create Plot</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#further-editing\" id=\"markdown-toc-further-editing\">Further Editing</a></li>\n  <li><a href=\"#conclusion\" id=\"markdown-toc-conclusion\">Conclusion</a></li>\n</ol>\n\n</blockquote>\n\n<h1 id=\"background\">Background</h1>\n\n<p>Circos supports various different plot types, such as histograms, scatter plots and heat maps. Each Circos plot may contain multiple tracks containing different sub-plots, making it ideal for visualisation of high-dimensional data.</p>\n\n<h2 id=\"circos-is-an-iterative-process\">Circos is an Iterative Process</h2>\n\n<p>Publication quality circos plots are <em>rarely</em> produced on the first try. Developing a quality Circos plot involves a lot of trial and error to find the best way to convey specific pieces of your data to your audience. Usually you will build up the circos plot one track at a time, and play around with different parameter settings until the plot looks exactly like you want it to:</p>\n\n<figure id=\"figure-1\" style=\"max-width: 90%;\"><img src=\"../../images/circos2.gif\" alt=\"Gif of a circos plots through the development process. \" width=\"400\" height=\"400\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/circos2.gif\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 1</strong>:</span> Circos plots are an iterative process, requiring many iterative steps, each improving your plot and getting you closer to a final image.</figcaption></figure>\n\n<p>Circos is an extremely flexible but also very complex tool. The Galaxy Circos tool covers the most commonly used Circos features, but in order to avoid becoming too complex, it does not expose every single configuration option available in Circos. However, the Galaxy Circos tool allows you to download the full set of configuration files it uses, allowing you to manually tweak the plot further.</p>\n\n<blockquote class=\"comment\">\n  <comment-title>Circos tutorials</comment-title>\n\n  <p>To learn more about using Circos outside of Galaxy (e.g. for tweaking the\nCircos configuration output by the Galaxy tool), there are a wide range\nof tutorials available from the <a href=\"http://circos.ca\">Circos website</a></p>\n</blockquote>\n\n<h1 id=\"circos-basics\">Circos Basics</h1>\n\n<h2 id=\"ideogram\">Ideogram</h2>\n\n<p>The ideogram depicts your major data classes. For genomics data this is usually chromosomes, but could also be species, or genes, or another resolution level depending on what relationships you want to show. For non-genomic data this could be individuals in a population, countries, or any other major facet of your data that you want to use for grouping.</p>\n\n<figure id=\"figure-2\" style=\"max-width: 90%;\"><img src=\"../../images/circos/ideograms_examples.png\" alt=\"Examples of ideograms in Circos. \" width=\"800\" height=\"800\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/circos/ideograms_examples.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 2</strong>:</span> The ideogram shows the objects for which you will plot data. Cytogenic bands can be shown as needed and when available.</figcaption></figure>\n\n<h2 id=\"data-tracks\">Data Tracks</h2>\n\n<p>Within this ideogram, we can plot <em>data tracks</em>. There are different plot types available, such as scatterplots, histograms, heatmaps, and link tracks. Below is a list of the main track types with example images:</p>\n\n<table style=\"table-layout: fixed\">\n\t<thead>\n\t\t<tr>\n\t\t\t<th width=\"300\">Example</th>\n\t\t\t<th>Description</th>\n\t\t</tr>\n\t</thead>\n\t<tbody>\n\t\t<tr>\n\t\t\t<td><img src=\"../../images/circos/data_tracks_scatter.png\" alt=\"Example of a Circos scatter track\" /></td>\n\t\t\t<td>\n\t\t\t\t<b>Scatter plot</b> track type. All data points are indicated by a glyph (shape).\n\t\t\t\t<br /><br />\n\n\t\t\t\t<u>Data format</u>: four or five columns, tab separated. While Circos accepts space or tab separated, to use Galaxy's data manipulation tools you will need tab separated data. The attributes colum is completely optional but can be used to override colours, or provide extra context like \"strand\" or something else on which it might be diserable to filter. The format is <code>key=value,key2=value2,...</code>\n\t\t\t\t<table>\n\t\t\t\t\t<thead><tr><th>Chromosome</th><th>Start</th><th>End</th><th>Value</th><th>Attributes (optional)</th></tr></thead>\n\t\t\t\t\t\t<tbody>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>chrX</td><td>0</td><td>7499999</td><td>50</td><td></td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>chrX</td><td>7500000</td><td>14999999</td><td>100</td><td>fill_color=red</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>chrX</td><td>15000000</td><td>22499999</td><td>-25</td><td>fill_color=(140,104,137)</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</tbody>\n\t\t\t\t</table>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td><img src=\"../../images/circos/data_tracks_line.png\" alt=\"Example of a Circos line track\" /></td>\n\t\t\t<td><strong>Line plot</strong> track type. Data points are connected by a line. <br /><br /><u>Data format</u>: identical to scatter plot.</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td><img src=\"../../images/circos/data_tracks_histogram.png\" alt=\"Example of a Circos Histogram track\" /></td>\n\t\t\t<td><strong>Histogram</strong> track type. Data points are connected to form a step-like trace. <br /><br /><u>Data format</u>: identical to scatter plot.</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td><img src=\"../../images/circos/data_tracks_heatmap.png\" alt=\"Example of a Circos Heatmap track\" /></td>\n\t\t\t<td><strong>Heatmap</strong> track type. <br /><br /><u>Data format</u>: identical to scatter plot.</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td><img src=\"../../images/circos/data_tracks_tiles.png\" alt=\"Example of a Circos tile track\" /></td>\n\t\t\t<td>\n\t\t\t\t<strong>Tile</strong> track type. This is useful to indicate a range of the chromosome, for example to show genes, <span class=\"notranslate\">reads</span>, repeat regions, etc.\n\t\t\t\t<br /><br />\n\n\t\t\t\t<u>Data format</u>: four or five columns, similar to scatter plot but instead of a value or a score, we have a text label that can be displayed.\n\t\t\t\t<table>\n\t\t\t\t\t<thead><tr><th>Chromosome</th><th>Start</th><th>End</th><th>Label</th><th>Attributes (optional)</th></tr></thead>\n\t\t\t\t\t\t<tbody>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>chr1</td><td>10119128</td><td>10345073</td><td>C_994</td><td>id=Conrad_994</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>chr1</td><td>10171406</td><td>10415218</td><td>M_1535</td><td>id=McCarroll_1535</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>chr1</td><td>103351772</td><td>103448763</td><td>M_5507</td><td>id=Mills_5507</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</tbody>\n\t\t\t\t</table>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td><img src=\"../../images/circos/data_tracks_text.png\" alt=\"Example of a Circos text track\" /></td>\n\t\t\t<td><strong>Text</strong> track type. Text may also be added to a plot, for instance to indicate names of impacted genes. <br /><br /><u>Data format</u>: identical to tiles plot.</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td><img src=\"../../images/circos/data_tracks_links.png\" alt=\"Example of a Circos link track\" /></td>\n\t\t\t<td>\n\t\t\t\t<strong>Link</strong> track type. Relationship between objects can be indicated by a line between them.\n\t\t\t\t<br /><br />\n\n\t\t\t\t<u>Data format 1</u>: six or seven columns, including the optional attribute column.\n\t\t\t\t<table>\n\t\t\t\t\t<thead>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<th>Chromosome 1</th><th>Start 1</th><th>End 1</th>\n\t\t\t\t\t\t\t<th>Chromosome 2</th><th>Start 2</th><th>End 2</th>\n\t\t\t\t\t\t\t<th>Attributes (optional)</th>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</thead>\n\t\t\t\t\t<tbody>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>chrX</td><td>87655109</td><td>107655109</td><td>chr12</td><td>109275831</td><td>129275831</td><td>color=blue,value=0</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>chrX</td><td>73701156</td><td>93701156</td><td>chr22</td><td>26513447</td><td>46513447</td><td>color=green,value=1</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>chr12</td><td>121879007</td><td>132349534</td><td>chr7</td><td>43840633</td><td>63840633</td><td>color=red,value=2</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</tbody>\n\t\t\t\t</table>\n\n\t\t\t\t<u>Data format 2</u>: four or five columns, including the optional attribute column.\n\t\t\t\t<table>\n\t\t\t\t\t<thead>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<th>Link ID</th><th>Chromosome</th><th>Start</th><th>End</th><th>Attributes (optional)</th>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</thead>\n\t\t\t\t\t<tbody>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>link_0</td><td>chrX</td><td>87655109</td><td>107655109</td><td>color=red</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>link_0</td><td>chr12</td><td>109275831</td><td>129275831</td><td>color=blue</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>link_1</td><td>chrX</td><td>73701156</td><td>93701156</td><td>color=green</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>link_1</td><td>chr22</td><td>26513447</td><td>46513447</td><td>color=black</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</tbody>\n\t\t\t\t</table>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td><img src=\"../../images/circos/data_tracks_ribbons.png\" alt=\"Example of a Circos link track with ribbons\" /></td>\n\t\t\t<td><strong>Ribbons</strong> are a type of link track. These can be coloured and twisted as desired. <br /><br /><u>Data format</u>: identical to links.</td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<p>Tracks can be customized a lot, some relevant concepts are:</p>\n<ul>\n  <li><strong>Radius</strong> of the track determines its location between the center (0) and the ideogram (1).</li>\n  <li><strong>Rules</strong> can be defined to change for example the color of data points depending on the value of the data points.</li>\n  <li><strong>Axes and backgrounds</strong> can be drawn on a data track</li>\n</ul>\n\n<p>There are a <em>lot</em> of further customizations available within Circos, but in this tutorial, we will start with the basics.</p>\n\n<h1 id=\"tutorial-overview\">Tutorial Overview</h1>\n\n<p>We will now illustrate Circos further with a number of example plots. Each of these can be run independently of each other, so feel free to pick an example that suits your interest. If this is your first time using Circos, we suggest doing the examples in order.</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>Link to Section</th>\n      <th style=\"text-align: center\">Preview</th>\n      <th style=\"text-align: left\">Note</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><a href=\"#example-cancer-genomics\">Cancer Genomics</a></td>\n      <td style=\"text-align: center\"><a href=\"../../images/circos/vcap.png\" rel=\"noopener noreferrer\"><img src=\"../../images/circos/vcap.png\" alt=\"VCaP cancer Circos plot. \" width=\"3000\" height=\"3000\" loading=\"lazy\" /></a></td>\n      <td style=\"text-align: left\">Create a plot using data from a cancer cell line. This tutorial will guide you through the iterative process of building your first Circos image, and covers some cancer background as well.</td>\n    </tr>\n    <tr>\n      <td><a href=\"#example-presidential-debate\">Presidential Debate</a></td>\n      <td style=\"text-align: center\"><a href=\"../../images/circos/candidatenetworkdiagram.png\" rel=\"noopener noreferrer\"><img src=\"../../images/circos/candidatenetworkdiagram.png\" alt=\"Presidential Debate NYT Circos plot. \" width=\"557\" height=\"531\" loading=\"lazy\" /></a></td>\n      <td style=\"text-align: left\">To show that Circos can be used for non-genomics data as well, this example recreates a plot that appeared in the New York times, visualizing data of the presidential debates.</td>\n    </tr>\n    <tr>\n      <td><a href=\"#example-nature-cover-encode\">ENCODE cover</a></td>\n      <td style=\"text-align: center\"><a href=\"../../images/nature_cover_encode.png\" rel=\"noopener noreferrer\"><img src=\"../../images/nature_cover_encode.png\" alt=\"Nature Cover ENCODE. \" width=\"500\" height=\"657\" loading=\"lazy\" /></a></td>\n      <td style=\"text-align: left\">Recreate a Nature Cover!</td>\n    </tr>\n  </tbody>\n</table>\n\n<h1 id=\"example-cancer-genomics\">Example: Cancer Genomics</h1>\n\n<p>In this section, we will recreate a Circos plot of the VCaP cancer cell line presented in <span class=\"citation\"><a href=\"#alves2013gene\">Alves <i>et al.</i> 2013</a></span>. In this study, data from various sources were combined into a single integrative Circos plot.</p>\n\n<figure id=\"figure-3\" style=\"max-width: 90%;\"><img src=\"../../images/circos/vcap.png\" alt=\"VCaP cancer Circos plot. \" width=\"3000\" height=\"3000\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/circos/vcap.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 3</strong>:</span> Circos plot of the VCaP cancer cell line displaying from the outside in: copy number variation, B-allele frequency, structural variants</figcaption></figure>\n\n<p>This plot has 4 tracks:</p>\n<ul>\n  <li>Structural variants (2 tracks, data obtained from whole-genome NGS sequencing data)</li>\n  <li>B-allele Frequency (obtained from SNP array data)</li>\n  <li>Copy Number (obtained from SNP array data)</li>\n</ul>\n\n<p>In this section we will reproduce this Circos plot step by step.</p>\n\n<h2 id=\"data-upload\">Data upload</h2>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Obtaining our data</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Make sure you have an empty analysis history. Give it a name.</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-new-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-new-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a new history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>Click the <i class=\"fas fa-plus\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">new-history</span> icon at the top of the history panel:</p>   <p><img src=\"/training-material/shared/images/history_create_new.svg\" alt=\"UI for creating new history\" /></p>   <!-- the original drawing can be found here https://docs.google.com/drawings/d/1cCBrLAo4kDGic5QyB70rRiWJAKTenTU8STsKDaLcVU8/edit?usp=sharing --> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p><span class=\"tool\" data-tool=\"upload1\" title=\"Import Data tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Import Data</strong></span></p>\n      <ul>\n        <li>Import the sample data files to your history, either from a shared data library (if available), or from Zenodo using the following URLs:</li>\n      </ul>\n\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/4494146/files/VCaP_Copy-Number.tsv\nhttps://zenodo.org/record/4494146/files/VCaP_B-allele-Frequency.tsv\nhttps://zenodo.org/record/4494146/files/VCaP-highConfidenceJunctions.tsv\nhttps://zenodo.org/record/4494146/files/hg18_karyotype_withbands.txt\n</code></pre></div>      </div>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-via-links\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-via-links\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing via links</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-data-from-a-data-library\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-data-from-a-data-library\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing data from a data library</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>As an alternative to uploading the data from a URL or your computer, the files may also have been made available from a <em>shared data library</em>:</p>   <ol>   <li>Go into <strong>Shared data</strong> (top panel) then <strong>Data libraries</strong></li>   <li>Navigate to  the correct folder as indicated by your instructor.     <ul>       <li>On most Galaxies tutorial data will be provided in a folder named <strong>GTN - Material –&gt; Topic Name -&gt; Tutorial Name</strong>.</li>     </ul>   </li>   <li>Select the desired files</li>   <li>Click on <strong>Add to History</strong> <i class=\"fas fa-caret-down\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-dropdown</span> near the top and select <strong>as Datasets</strong> from the dropdown menu</li>   <li>     <p>In the pop-up window, choose</p>     <ul>       <li><em>“Select history”</em>: the history you want to import the data to (or create a new one)</li>     </ul>   </li>   <li>Click on <strong>Import</strong></li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h2 id=\"ideogram-1\">Ideogram</h2>\n\n<p>As the first step to this Circos plot, let’s configure the ideogram (set of chromosomes to draw). You can use one of the built-in genomes, or you can supply your own karyotype file.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Set ideogram configuration</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/circos/circos/0.69.8+galaxy12\" title=\"Circos tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Circos</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.69.8+galaxy12)</span> visualizes data in a circular layout with the following parameters:\n      <ul>\n        <li>In <em>“Karyotype”</em>:\n          <ul>\n            <li><em>“Reference Genome Source”</em>: <code class=\"language-plaintext highlighter-rouge\">Custom Karyotype</code>\n              <ul>\n                <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Karyotype Configuration”</em>: <code class=\"language-plaintext highlighter-rouge\">hg18_karyotype_withbands.txt</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n        <li>In <em>“Ideogram”</em>:\n          <ul>\n            <li><em>“Spacing Spacing Between Ideograms (in chromosome units)”</em>: <code class=\"language-plaintext highlighter-rouge\">50</code></li>\n            <li><em>“Radius”</em>: <code class=\"language-plaintext highlighter-rouge\">0.85</code></li>\n            <li><em>“Thickness”</em>: <code class=\"language-plaintext highlighter-rouge\">45</code></li>\n            <li>In <em>“Labels”</em>:\n              <ul>\n                <li><em>“Label Font Size”</em>: <code class=\"language-plaintext highlighter-rouge\">64</code></li>\n              </ul>\n            </li>\n            <li>In <em>“Cytogenic Bands”</em>:\n              <ul>\n                <li><em>“Bands transparency”</em>: <code class=\"language-plaintext highlighter-rouge\">2</code></li>\n                <li><em>“Band Stroke Thickness”</em>: <code class=\"language-plaintext highlighter-rouge\">1</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>\n      <p><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the output <code class=\"language-plaintext highlighter-rouge\">Circos Plot ideogram</code></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-renaming-a-dataset\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-renaming-a-dataset\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Renaming a dataset</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, change the <strong>Name</strong> field  to <code class=\"language-plaintext highlighter-rouge\">Circos Plot ideogram</code></li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>You should now have a plot that looks like this:</p>\n\n<p><a href=\"../../images/circos/cancer_ideogram.png\" rel=\"noopener noreferrer\"><img src=\"../../images/circos/cancer_ideogram.png\" alt=\"Circos output with only the ideogram. \" width=\"3000\" height=\"3000\" loading=\"lazy\" /></a></p>\n\n<p>We will use this as the basis for our plot, and add data tracks one at a time.</p>\n\n<blockquote class=\"comment\">\n  <comment-title>Advanced info: defining your karyotype file</comment-title>\n\n  <p>Since our data uses <code class=\"language-plaintext highlighter-rouge\">hg18</code> reference genome, we supply a corresponding karyotype file:</p>\n\n  <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>chr - chr1 1 0 247249719 chr1\nchr - chr2 2 0 242951149 chr2\nchr - chr3 3 0 199501827 chr3\nchr - chr4 4 0 191273063 chr4\nchr - chr5 5 0 180857866 chr5\nchr - chr6 6 0 170899992 chr6\nchr - chr7 7 0 158821424 chr7\nchr - chr8 8 0 146274826 chr8\nchr - chr9 9 0 140273252 chr9\nchr - chr10 10 0 135374737 chr10\nchr - chr11 11 0 134452384 chr11\nchr - chr12 12 0 132349534 chr12\nchr - chr13 13 0 114142980 chr13\nchr - chr14 14 0 106368585 chr14\nchr - chr15 15 0 100338915 chr15\nchr - chr16 16 0 88827254 chr16\nchr - chr17 17 0 78774742 chr17\nchr - chr18 18 0 76117153 chr18\nchr - chr19 19 0 63811651 chr19\nchr - chr20 20 0 62435964 chr20\nchr - chr21 21 0 46944323 chr21\nchr - chr22 22 0 49691432 chr22\nchr - chrX x 0 154913754 chrx\nchr - chrY y 0 57772954 chry\n</code></pre></div>  </div>\n\n  <p>Chromosome definitions are formatted as follows: <code class=\"language-plaintext highlighter-rouge\">chr - ID LABEL START END COLOR</code></p>\n\n  <ul>\n    <li>The first two fields are always <code class=\"language-plaintext highlighter-rouge\">chr</code>, indicating that the line defines a chromosome, and <code class=\"language-plaintext highlighter-rouge\">-</code>. The second field defines the parent structure and is used only for band definitions.</li>\n    <li>The <code class=\"language-plaintext highlighter-rouge\">ID</code> is the identifier used in data files whereas the <code class=\"language-plaintext highlighter-rouge\">LABEL</code> is the text that will appear next to the ideogram on the image.</li>\n    <li>The <code class=\"language-plaintext highlighter-rouge\">start</code> and <code class=\"language-plaintext highlighter-rouge\">end</code> values define the size of the chromosome. The karyotype file should store the entire chromsome size, not just the region you wish to draw.\nThere are other parameters we can use to draw only a subset of the data (e.g. just one chromosome).</li>\n    <li>The <code class=\"language-plaintext highlighter-rouge\">color</code> parameter is optional, to use built-in color scheme, use <code class=\"language-plaintext highlighter-rouge\">chr1, chr2. etc</code> again in this column</li>\n  </ul>\n\n  <p>More information about this format (including karyotype definitions for several species) can be found on the <a href=\"http://circos.ca/documentation/tutorials/ideograms/karyotypes/\">Circos website</a></p>\n\n  <blockquote class=\"question\">\n    <question-title></question-title>\n\n    <ol>\n      <li>Why didn’t we use the <code class=\"language-plaintext highlighter-rouge\">hg18</code> built-in genome (using the <code class=\"language-plaintext highlighter-rouge\">Locally Cached</code> option)?</li>\n    </ol>\n\n    <blockquote class=\"solution\">\n      <solution-title></solution-title>\n\n      <ol>\n        <li>\n          <p>These built-in definitions often include more than the canonical chromosomes (chr1-chr22, chrX, chrY), which we might not want to plot. For example, using\nThe full definition of <code class=\"language-plaintext highlighter-rouge\">hg18</code> built-in to Galaxy, we get the following ideogram:</p>\n\n          <p><a href=\"../../images/circos/cancer_ideogram_cached.png\" rel=\"noopener noreferrer\"><img src=\"../../images/circos/cancer_ideogram_cached.png\" alt=\"Example of ideogram generated using built-in genome definition. \" width=\"3000\" height=\"3000\" loading=\"lazy\" /></a></p>\n\n          <p>We could still use this karyotype, but we would have to limit the chromosomes to be drawn in the Circos settings (we will cover this later). In this example however, we supply our own karyotype file defining only the canonical chromosomes.</p>\n        </li>\n      </ol>\n    </blockquote>\n  </blockquote>\n\n</blockquote>\n\n<h2 id=\"structural-variations\">Structural Variations</h2>\n\n<p>The first data track we will configure, will be the structural variants (SVs) using the <em>link</em> track type in Circos. We will colour the links differently depending on whether the SVs are intrachromosomal (within a single chromosome) or interchromosomal (between different chromosomes).</p>\n\n<blockquote class=\"comment\">\n  <comment-title>Background: Structural Variants</comment-title>\n\n  <p>Structural variants (SVs) are large-scale genomic rearrangements. SVs involve large segments of DNA (&gt;50 bp) that are deleted, duplicated, translocated or inverted.</p>\n\n  <figure id=\"figure-4\" style=\"max-width: 90%;\"><img src=\"../../images/circos/sv-types.jpg\" alt=\"Overview of types of SVs. \" width=\"600\" height=\"401\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/circos/sv-types.jpg\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 4</strong>:</span> Different types of SVs</figcaption></figure>\n\n  <p>Image Credit: <span class=\"citation\"><a href=\"#alkan2011genome\">Alkan <i>et al.</i> 2011</a></span></p>\n\n  <p>One of the first observations of SVs in the human genome is known as the <a href=\"https://en.wikipedia.org/wiki/Philadelphia_chromosome\">Philadelphia Chromosome</a>, a SV observed in leukemia. In this mutation, a translocation of genetic material  occurs between chromosomes 9 and 22, resulting in a fusion between genes <em>BCR</em> and <em>ABL1</em>, causing the production of a hybrid protein, impairing various signalling pathways and causing the cell to divide uncontrollably.</p>\n\n  <figure id=\"figure-5\" style=\"max-width: 90%;\"><img src=\"../../images/circos/sv.jpg\" alt=\"the Philedelphia chromosome. \" width=\"800\" height=\"551\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/circos/sv.jpg\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 5</strong>:</span> The Philadelphia chromosome</figcaption></figure>\n\n  <p>In cancer analyses it is therefore often useful to examine SVs and look for potential fusion genes that may affect cell function.</p>\n\n</blockquote>\n\n<p>SVs are usually described in terms of the SV <strong>breakpoints</strong> (or <strong>junctions</strong>); sets of genomic locations which are separated by a large distance on the reference genome, but have become adjacent in the sample through the occurrence of structural variants. Unfortunately, there is no standard file format for SV data, with different SV callers outputting different formats. Therefore, our first step will be to transform our input dataset to the Circos format for link tracks.</p>\n\n<h3 id=\"sv-file-format\">SV File Format</h3>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>#ASSEMBLY_ID\tGS000008107-ASM\n#SOFTWARE_VERSION\t2.0.2.22\n#GENERATED_BY cgatools\n#GENERATED_AT\t2012-Mar-07 19:33:32.930656\n#FORMAT_VERSION\t2.0\n#GENOME_REFERENCE\tNCBI build 36\n#SAMPLE\tGS00669-DNA_D02\n#TYPE\tJUNCTIONS\n#DBSNP_BUILD\tdbSNP build 130\n#GENE_ANNOTATIONS\tNCBI build 36.3\n&gt;Id\tLeftChr\tLeftPosition\tLeftStrand\tLeftLength\tRightChr\tRightPosition\tRightStrand\tRightLength\tStrandConsistent\tInterchromosomal\tDistance\tDiscordantMatePairAlignments\tJunctionSequenceResolved\tTransitionSequence\tTransitionLength\tLeftRepeatClassification\tRightRepeatClassification\tLeftGenes\tRightGenes\tXRef\tDeletedTransposableElement\tKnownUnderrepresentedRepeat\tFrequencyInBaselineGenomeSet\tAssembledSequence\tEventId\tType\tRelatedJunctions\n3872\tchr1\t815629\t-\t155\tchr1\t5649523\t-\t822\tY\tN\t4833894\t13\tY\t\t0\tAluS:SINE:Alu;SegDup;Self chain\tAluSx:SINE:Alu;Self chain\t\t\t\t\t\t0.92\tgcaaccaaaatgactattctttctaccctcCTAGTTCAGACATAGCCTGAGACTTTTTTTTTTTTGAGATGAAGTCTCACTCTGTCACTCAGGCTGGAGTGCAGTGGCATGGTCTCGGCTCATTGCAATCTCTACCTCCCGGGTTCAAGTGATTCTCCTGCCTCAGCCTCCCAAGTAGCTGGGGCTACAGGCGTGCACCACCACACCTGGCTAATTTTCATATTATTAGTAGAGATGGGGTTTCACCATGTTGGTCAGACTGGTCTTGAACTCCTGACCTCAGGTGATCTGCCCGCCTCTGCCTCCCAAAATGCTGAGATTACAGATGTGAGCCACTGtgcccggccgcctgagacattttggacgac\t490\tcomplex\t6269;6270;8575;8577;8578\n8577\tchr1\t816163\t+\t449\tchr1\t5650075\t+\t435\tY\tN\t4833912\t21\tY\t\t0\tSegDup;Self chain\tSelf chain\t\t\t\t\t\t1.00\tgactgcagggggcaggagctctctggctggGCCTTGATCGTGTTCAAGCCACAACCACAGACCTAGGCGTGGTCCCTCAGCCACCTTGTAGCCTTGGCTTGCAACATCTCGACATGGAAACCAAAATGCAGCAGGGCCAATGTGATCTGAAGTTTCCTGAAAAGTTTCTCAGACCCcctcttttaccccttgtgcaacctgcacac\t490\tcomplex\t3872;6269;6270;8575;8578\n8578\tchr1\t816176\t+\t363\tchr1\t5650768\t+\t228\tY\tN\t4834592\t12\tY\tCTTTTGTAACCTGCACACAGTGACCTGTATTCTAGAGGGTCCACACAGAGCTGCCATTCCTTCTGCCAGACCCTGCGGGACTCAGGCATTCTGGAGGCTTCCTGCCCTACAAAGGCAGCCAGACTCCCGCCATGCATCCCTGCACCAGCGGCTCACGGCCAGCTCCCTCACCTGCACCAGCGGCTCACGGCTAGCTCCCTCATCTGCATTCCAGTGGCTCATGGCCAGCTCCCTCACCTGCACCAGCGGCTCTCGGCCGGCTCCCTCCCCTGCACTCCAGCGGC\t284\tSelf chain\tSelf chain;Tandem period 100;Tandem period 34;Tandem period 66\t\t\t\t\t\t1.00\taaaccaaaacgcagcagagcccatgtgatcTGAAAGTTCCTGAAAAGTTGCCCAGACCCCCTCTTGTACCCCTTTTGTAACCTGCACACAGTGACCTGTATTCTAGAGGGTCCACACAGAGCTGCCATTCCTTCTGCCAGACCCTGCGGGACTCAGGCATTCTGGAGGCTTCCTGCCCTACAAAGGCAGCCAGACTCCCGCCATGCATCCCTGCACCAGCGGCTCACGGCCAGCTCCCTCACCTGCACCAGCGGCTCACGGCTAGCTCCCTCATCTGCATTCCAGTGGCTCATGGCCAGCTCCCTCACCTGCACCAGCGGCTCTCGGCCGGCTCCCTCCCCTGCACTCCAGCGGCtcaccgccggctccctcacctgcactccag\t490\tcomplex\t3872;6269;6270;8575;8577\n</code></pre></div></div>\n\n<h3 id=\"circos-input-format\">Circos Input Format</h3>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>chromosome - start - end - chromosome - start - end\n</code></pre></div></div>\n\n<p>So in order to convert this to Circos format, we need to</p>\n<ul>\n  <li>Remove header lines (lines starting with <code class=\"language-plaintext highlighter-rouge\">#</code>)</li>\n  <li>Select the columns containing the chromosomes and positions of the breaks (junctions)</li>\n</ul>\n\n<!--SNIPPET-->\n<blockquote class=\"warning\">   <div class=\"box-title warning-title\" id=\"warning-beware-of-cuts\"><i class=\"fas fa-exclamation-triangle\" aria-hidden=\"true\"></i> Warning: Beware of Cuts</div>   <p>The section below uses <strong>Cut</strong> tool. There are two <strong>cut</strong> tools in Galaxy due to historical reasons. This example uses tool with the full name <strong>Cut columns from a table (cut)</strong>. However, the same logic applies to the other tool. It simply has a slightly different interface.</p> </blockquote>\n<p><!--END_SNIPPET--></p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Prepare input data</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"Grep1\" title=\"Select tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Select</strong></span> lines that match an expression with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Select lines from”</em>: <code class=\"language-plaintext highlighter-rouge\">VCaP highConfidenceJunctions.tsv</code></li>\n        <li><em>“that”</em>: <code class=\"language-plaintext highlighter-rouge\">NOT Matching</code></li>\n        <li><em>“the pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">^[#&gt;&lt;]</code></li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"Cut1\" title=\"Cut tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Cut</strong></span> columns from a table with the following parameters:\n      <ul>\n        <li><em>“Cut columns”</em>: <code class=\"language-plaintext highlighter-rouge\">c2,c3,c3,c6,c7,c7</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“From”</em>: output of <strong>Select</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n      </ul>\n    </li>\n    <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> this output to <code class=\"language-plaintext highlighter-rouge\">SVs Circos.tsv</code></li>\n  </ol>\n\n</blockquote>\n\n<p>Now that we have the correct format, we can plot our data in Circos. We will plot the SVs as links; showing which parts of genome have been fused together in our sample.</p>\n\n<p>Given that Circos is a very complex with dozens of parameters to set, we re-run previous circos runs to build on the existing configuration we have done, without losing the progress and having to re-specify parameters every time.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Add Circos link track for SVs</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Click <strong>Re-run</strong> <i class=\"fas fa-redo\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-refresh</span> on the previous Circos <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> run (<code class=\"language-plaintext highlighter-rouge\">Circos Plot ideogram</code>)</p>\n    </li>\n    <li>Add a new Link Track for the SV data, colouring by SV type:\n      <ul>\n        <li>In <em>“Link Tracks”</em>:\n          <ul>\n            <li>In <em>“Link Data”</em>:\n              <ul>\n                <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Link Data”</em>\n                  <ul>\n                    <li><em>“Inside Radius”</em>: <code class=\"language-plaintext highlighter-rouge\">0.95</code></li>\n                    <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Link Data Source”</em>: <code class=\"language-plaintext highlighter-rouge\">SVs Circos.tsv</code></li>\n                    <li><em>“Link Type”</em>: <code class=\"language-plaintext highlighter-rouge\">basic</code></li>\n                    <li><em>“Thickness”</em>: <code class=\"language-plaintext highlighter-rouge\">3.0</code></li>\n                    <li><em>“Bezier Radius”</em>: <code class=\"language-plaintext highlighter-rouge\">0.5</code></li>\n                    <li>In <em>“Rules”</em>:\n                      <ul>\n                        <li>In <em>“Rule”</em>:\n                          <ul>\n                            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Rule”</em>\n                              <ul>\n                                <li>In <em>“Conditions to Apply”</em>:\n                                  <ul>\n                                    <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Conditions to Apply”</em>\n                                      <ul>\n                                        <li><em>“Condition”</em>: <code class=\"language-plaintext highlighter-rouge\">Interchromosomal</code></li>\n                                      </ul>\n                                    </li>\n                                  </ul>\n                                </li>\n                                <li>In <em>“Actions to Apply”</em>:\n                                  <ul>\n                                    <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Actions to Apply”</em>\n                                      <ul>\n                                        <li><em>“Action”</em>: <code class=\"language-plaintext highlighter-rouge\">Change Fill Colour</code></li>\n                                        <li><em>“Change fill Color”</em>: <span style=\"background-color:#ff0000;border-radius:3px;border:1px solid #000;width:12px;height:12px;margin-right:5px;\">     </span> (red)</li>\n                                      </ul>\n                                    </li>\n                                  </ul>\n                                </li>\n                              </ul>\n                            </li>\n                          </ul>\n                        </li>\n                      </ul>\n                    </li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the output <code class=\"language-plaintext highlighter-rouge\">Circos Plot SVs</code></li>\n  </ol>\n\n</blockquote>\n\n<p>Your output should look something like this:</p>\n\n<figure id=\"figure-6\" style=\"max-width: 90%;\"><img src=\"../../images/circos/cancer_svs1.png\" alt=\"The plot with an SV track. \" width=\"3000\" height=\"3000\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/circos/cancer_svs1.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 6</strong>:</span> SVs on the VCaP cell line. Red lines indicate <i>interchromosomal</i> SVs, where pieces originating from different chromosomes have fused together. Black lines show breaks withing in single chromosome.</figcaption></figure>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>Are there more interchromosomal or intrachromosomal SVs?</li>\n    <li>Which chromosome appears to have the most SVs?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>Interchromosomal SVs (between different chromosomes) are coloured red in this\nplot, while SVs within a single chromosome are coloured black. By plotting the data with Circos, you can now easily see\nat a glance that there are more intrachromosomal SVs (black) than interchromosomal SVs (red).</li>\n      <li>Chromosome 5 appears to have a lot more SVs than the other chromosomes (it looks almost completely black!)</li>\n    </ol>\n\n  </blockquote>\n</blockquote>\n\n<p>We see from this image that chromosome 5 has an unusually large number of SVs, let’s look at that chromosome more closely, by limiting the chromosomes Circos should draw:</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Plot only Chromosome 5</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Hit <strong>Rerun</strong> <i class=\"fas fa-redo\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-refresh</span> on the previous Circos <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> run</p>\n    </li>\n    <li>\n      <p><strong>Change</strong> the following tool parameters:</p>\n      <ul>\n        <li>In <em>“Ideogram”</em>:\n          <ul>\n            <li><em>“Limit/Filter Chromosomes”</em>: <code class=\"language-plaintext highlighter-rouge\">chr5</code></li>\n            <li><em>“Spacing Between Ideograms (in chromosome units)”</em>: <code class=\"language-plaintext highlighter-rouge\">0.5</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>You should see a plot like:</p>\n\n<figure id=\"figure-7\" style=\"max-width: 90%;\"><img src=\"../../images/circos/cancer_svs_chr5.png\" alt=\"Circos plot of chromosome 5 SVs. \" width=\"3000\" height=\"3000\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/circos/cancer_svs_chr5.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 7</strong>:</span> Chromosome 5 of the VCaP cancer cell line. The <a href=\"https://en.wikipedia.org/wiki/Locus_(genetics)\">q arm</a> of this chromosome appears to be affected by an unusually large number of SVs</figcaption></figure>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>Are there indeed significantly more SVs on chromosome 5 than on the other chromosomes? (hint: plot some of the other chromosomes as well)</li>\n    <li>Are the SVs equally distributed over chromosome 5? Can you think of an explanation for this?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>\n        <p>Yes, plotting for example only chromosome 1 (left) and comparing this with the chromosome 5 plot (right), reveals that chr5 has abnormally high number of SVs compared to the other chromosomes</p>\n\n        <p><a href=\"../../images/circos/cancer_svs_chr1.png\" rel=\"noopener noreferrer\"><img src=\"../../images/circos/cancer_svs_chr1.png\" alt=\"Circos plot of chromosome 5 SVs. \" width=\"3000\" height=\"3000\" loading=\"lazy\" /></a>\n<a href=\"../../images/circos/cancer_svs_chr5.png\" rel=\"noopener noreferrer\"><img src=\"../../images/circos/cancer_svs_chr5.png\" alt=\"Circos plot of chromosome 1 SVs. \" width=\"3000\" height=\"3000\" loading=\"lazy\" /></a></p>\n      </li>\n      <li>\n        <p>No, only part of chromosome 5 appears to be affected. It turns out that this region is exactly one arm of the chromosome.\nThis could be caused by a phenomenon known as <em>chromothripsis</em> (see next box).</p>\n\n        <figure id=\"figure-8\" style=\"max-width: 90%;\"><img src=\"../../images/circos/chromosome-arms.jpg\" alt=\"Chromosome arms. \" width=\"960\" height=\"720\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/circos/chromosome-arms.jpg\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 8</strong>:</span> The different arms of a chromosome. The short arm is termed p, the long arm is q. In our sample, the 5q arm appears to be affected by chromothripsis</figcaption></figure>\n      </li>\n    </ol>\n\n  </blockquote>\n</blockquote>\n\n<blockquote class=\"comment\">\n  <comment-title>Background: Chromothripsis</comment-title>\n\n  <p><strong>Chromothripsis</strong> is a phenomenon whereby (part of) a chromosome is shattered in a single catastrophic event, and subsequently imprecisely stitched\ntogether by the cell’s repair mechanisms. This leads to a huge number of SV junctions.</p>\n\n  <figure id=\"figure-9\" style=\"max-width: 90%;\"><img src=\"../../images/circos/chromothripsis.png\" alt=\"Chromothripsis. \" width=\"500\" height=\"621\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/circos/chromothripsis.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 9</strong>:</span> Chromothripsis is a scattering of the DNA, followed by an imprecise repair process, leading to many structural rearrangements.</figcaption></figure>\n\n  <blockquote class=\"quote\" cite=\"https://en.wikipedia.org/wiki/Chromothripsis\">\n    <p><strong>Characteristics of chromothripsis:</strong></p>\n\n    <ol>\n      <li><strong>Large numbers of complex rearrangements</strong> in localised regions of single chromosomes or chromosome arms (showed by high density and clustered breakpoints) which suggests that chromosomes need to be condensed e.g. in mitosis for chromothripsis to occur.</li>\n      <li>Low <strong>copy number states- alternation between 2 states</strong> (sometimes 3) suggesting that rearrangements occurred in a short period of time.</li>\n      <li>In chromothriptic areas you get <strong>alternation of regions which retain heterozygosity-two copy (no loss or gain), with regions that have loss of heterozygosity- one copy</strong> (heterozygous deletion). This suggest that the rearrangements took place at a time that both parental copies of the chromosome were present and hence early on the development of the cancer cell.</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<p>By visualizing the SVs, we have observed characteristic 1 of the list above; large number of complex rearrangements in a localised regon of a single chromosome arm, one of the main features of chromothripsis. In order to confirm we are indeed dealing with chromothripsis, we will next look plot copy number data and B-allele frequency data (both obtained from microarrays) to ascertain whether we observe the expected patterns in copy number states and heterozygosity.</p>\n\n<h2 id=\"copy-number-variation\">Copy Number Variation</h2>\n\n<p>Next, we will create a track displaying copy number. This data comes from Affymetrix SNP arrays.</p>\n\n<blockquote class=\"comment\">\n  <comment-title>Background: Copy Number Variation (CNV)</comment-title>\n\n  <p>The human genome is a <em>diploid</em> genome, meaning there are 2 copies of each chromosome, one paternal, and one maternal. This means that for any given gene, humans have two different copies of it in our genome.</p>\n\n  <p><br /></p>\n\n  <p>Some structural variants will lead to a change in this copy number, for example duplications and deletions. Other SVs (such as inversions and translocations) do not result in a change in copy number, since the piece of DNA is just moved, but the number of copies of it remains the same.</p>\n\n  <figure id=\"figure-10\" style=\"max-width: 90%;\"><img src=\"../../images/circos/cancer-cnv-intro.png\" alt=\"SVs lead to CNVs. \" width=\"373\" height=\"438\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/circos/cancer-cnv-intro.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 10</strong>:</span> Duplications and deletions lead to a change in copy number, measurable by a change in read depth. Other SVs such as inversions are copy-number neutral.</figcaption></figure>\n\n  <p>In a healthy diploid genome, we expect the copy number to be around 2 in most places, with occasional duplications and deletions which are part of\nthe normal variation within the human population. In highly rearranged genomes such as cancer we expect to see a lot more copynumber variation.</p>\n\n</blockquote>\n\n<blockquote class=\"comment\">\n  <comment-title>Background: DNA Microarrays</comment-title>\n\n  <p><strong>Microarrays</strong> are used to measure the expression levels of large number of genes simultaneously, or to genotype multiple regions of a genome. In this example in our tutorial, we have data from a <strong>SNP array</strong>. This type of microarray detects the presence and proportion (homozyogous/heterozygous) of a\nwide range of SNPs (Single Nucleotide Polymorphisms) known to exist within the population. A set of <strong>probes</strong> targeting positions of a large number of known SNPs\nare used to detect the presence or absence of the SNPs in the sample.</p>\n\n  <p><br />\nEach SNP location is covered by 2 probes (one for the reference allele, and one for the variant allele). By comparing their combined intensity to the expected intensity (e.g. the sample average), a measure known as the <strong>Log R ratio</strong>, we can learn something about copy number. The resulting plots often look something like this:</p>\n\n  <p><a href=\"../../images/circos/cnv-plot.png\" rel=\"noopener noreferrer\"><img src=\"../../images/circos/cnv-plot.png\" alt=\"Example of a Log R ration plot. \" width=\"548\" height=\"245\" loading=\"lazy\" /></a></p>\n\n  <p>With a value of 0 indicating the normalized copy number (2 in the case of a diploid genome), and significant diversions from this expected value\npoint to copy number gains or losses (the figure above shows 1 region with a copy number loss).</p>\n\n</blockquote>\n\n<p>Let’s look at our file format (VCaP-copynumber.txt`):</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>Chromosome\tStart\tEnd\tValue\tArray\nchr1\t10004\t10004\t0.07110633\t0\nchr1\t28663\t28663\t0.2057637\t0\nchr1\t46844\t46844\t0.2016204\t0\nchr1\t59415\t59415\t0.1775235\t0\nchr1\t72017\t72017\t-0.1353417\t0\n</code></pre></div></div>\n\n<p>The <code class=\"language-plaintext highlighter-rouge\">Value</code> column indicates the copy number state, and is always between -1 and 1. the position has expected copy-number (<code class=\"language-plaintext highlighter-rouge\">0</code>), indicating 2 copies in the case of diploid genomes, or whether it has a copy number loss (negative values) or a gain in copy number (positive values).</p>\n\n<p>This is pretty close to the format expected by Circos for 2D data tracks (<code class=\"language-plaintext highlighter-rouge\">chr - start - end - value</code>), all we need to do to prepare this file is remove the first header line, and remove column 5. Furthermore, because this file is quite large, we do a subsampling down to 25000 lines; this is enough to get a genome-level overview of the data, but small enough that Circos will complete plotting quickly.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Prepare CNV input file</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"Remove beginning1\" title=\"Remove beginning tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Remove beginning</strong></span> of a file with the following parameters:\n      <ul>\n        <li><em>“Remove first”</em>: <code class=\"language-plaintext highlighter-rouge\">1</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“from”</em>: <code class=\"language-plaintext highlighter-rouge\">VCaP copy number.tsv</code></li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"Cut1\" title=\"Cut tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Cut</strong></span> columns from a table  with the following parameters:\n      <ul>\n        <li><em>“Cut columns”</em>: <code class=\"language-plaintext highlighter-rouge\">c1,c2,c3,c4</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“From”</em>: output of <strong>Remove beginning</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"random_lines1\" title=\"Select random lines tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Select random lines</strong></span> with the following parameters:\n      <ul>\n        <li><em>“Randomly select”</em>: <code class=\"language-plaintext highlighter-rouge\">25000</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“from”</em>: output of <strong>Cut</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n      </ul>\n    </li>\n    <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the output file <code class=\"language-plaintext highlighter-rouge\">cnv-circos.txt</code></li>\n  </ol>\n\n</blockquote>\n\n<p>Now that our file is prepared, we can add a track to our Circos image. We will create a scatterplot, and colour each data point depending on copy number state (green=gain, red=loss)</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Add Copy Number track to Circos</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Hit <strong>Rerun</strong> <i class=\"fas fa-redo\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-refresh</span> on the Circos plot containing the SV track <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> run (<code class=\"language-plaintext highlighter-rouge\">Circos Plot SVs</code>)</p>\n    </li>\n    <li>Add a new scatterplot track to the image\n      <ul>\n        <li>In <em>“2D Data Tracks”</em>:\n          <ul>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert 2D Data Plot”</em>\n              <ul>\n                <li><em>“Outside Radius”</em>: <code class=\"language-plaintext highlighter-rouge\">0.95</code></li>\n                <li><em>“Inside Radius”</em>: <code class=\"language-plaintext highlighter-rouge\">0.8</code></li>\n                <li><em>“Plot Type”</em>: <code class=\"language-plaintext highlighter-rouge\">Scatter</code>\n                  <ul>\n                    <li><em>“Scatter Plot Data Source”</em>: <code class=\"language-plaintext highlighter-rouge\">cnv-circos.txt</code></li>\n                    <li>In <em>“Plot Format Specific Options”</em>:\n                      <ul>\n                        <li><em>“Glyph Size”</em>: <code class=\"language-plaintext highlighter-rouge\">4</code></li>\n                        <li><em>“Fill Color”</em>: <span style=\"background-color:#7f7f7f;border-radius:3px;border:1px solid #000;width:12px;height:12px;margin-right:5px;\">     </span> (gray)</li>\n                        <li><em>“Stroke Thickness”</em>: <code class=\"language-plaintext highlighter-rouge\">0</code></li>\n                      </ul>\n                    </li>\n                  </ul>\n                </li>\n                <li><em>“Minimum / maximum options”</em>: <code class=\"language-plaintext highlighter-rouge\">Supply min/max values</code>\n                  <ul>\n                    <li><em>“Minimum value”</em>: <code class=\"language-plaintext highlighter-rouge\">-1.0</code></li>\n                    <li><em>“Maximum value”</em>: <code class=\"language-plaintext highlighter-rouge\">1.0</code></li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>\n      <p><strong>Examine</strong> <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> the resulting plot</p>\n\n      <blockquote class=\"question\">\n        <question-title></question-title>\n\n        <ol>\n          <li>Examine the resulting plot, what do you see?</li>\n          <li>How could we solve this?</li>\n        </ol>\n\n        <blockquote class=\"solution\">\n          <solution-title></solution-title>\n\n          <ol>\n            <li>\n              <p>We see the new track, but it overlaps with the SV track. This is because we used the same <code class=\"language-plaintext highlighter-rouge\">radius</code> parameter.\nThis parameter determines the position of the track within the plot.</p>\n\n              <p><a href=\"../../images/circos/cancer-overlap.png\" rel=\"noopener noreferrer\"><img src=\"../../images/circos/cancer-overlap.png\" alt=\"Circos plot of chromosome 5 SVs. \" width=\"3000\" height=\"3000\" loading=\"lazy\" /></a></p>\n            </li>\n            <li>\n              <p>To fix this, we can rerun the Circos tool, and change the radius of the link track (SVs) to be inside the new copynumber track (&lt;<code class=\"language-plaintext highlighter-rouge\">0.8</code>).\nWe will do this in the next step. This is what we mean by Circos being an iterative process; the tool is too complex to define a multitrack plot\nall at once, rather, you build it up step by step and frequently check the output.</p>\n            </li>\n          </ol>\n\n        </blockquote>\n      </blockquote>\n    </li>\n    <li><strong>Rerun</strong> <i class=\"fas fa-redo\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-refresh</span> the tool, changing the following parameters.\n      <ul>\n        <li>In <em>“Link Tracks”</em>:\n          <ul>\n            <li>In <em>“1: Link Data”</em>:\n              <ul>\n                <li><em>“Inside Radius”</em>: <code class=\"language-plaintext highlighter-rouge\">0.75</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>You should see a plot that looks like:</p>\n\n<p><a href=\"../../images/circos/cancer-cnv.png\" rel=\"noopener noreferrer\"><img src=\"../../images/circos/cancer-cnv.png\" alt=\"Circos plot with CNV track. \" width=\"3000\" height=\"3000\" loading=\"lazy\" /></a></p>\n\n<p>Now that we are happy with the placement of our track, let’s tweak it a bit more. Let’s colour positions showing a significant copy number loss (&lt; <code class=\"language-plaintext highlighter-rouge\">-0.15</code>) red, and positions with a copy number gain (&gt; <code class=\"language-plaintext highlighter-rouge\">0.15</code>) green, leaving everything inbetween gray (expected copy number):</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Colour data points by copy number state</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Hit <strong>Rerun</strong> <i class=\"fas fa-redo\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-refresh</span> on the previous Circos <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> run</p>\n    </li>\n    <li>\n      <p>In the <strong>2D data track</strong> of the CNV track we just created, add the following rules:</p>\n      <ul>\n        <li>In <em>“Rules”</em>:\n          <ul>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Rule”</em>\n              <ul>\n                <li>In <em>“Conditions to Apply”</em>:\n                  <ul>\n                    <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Conditions to Apply”</em>\n                      <ul>\n                        <li><em>“Condition”</em>: <code class=\"language-plaintext highlighter-rouge\">Based on value (ONLY for scatter/histogram/heatmap/line)</code>\n                          <ul>\n                            <li><em>“Points above this value”</em>: <code class=\"language-plaintext highlighter-rouge\">0.15</code></li>\n                          </ul>\n                        </li>\n                      </ul>\n                    </li>\n                  </ul>\n                </li>\n                <li>In <em>“Actions to Apply”</em>:\n                  <ul>\n                    <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Actions to Apply”</em>\n                      <ul>\n                        <li><em>“Action”</em>: <code class=\"language-plaintext highlighter-rouge\">Change Fill Color for all points</code>\n                          <ul>\n                            <li><em>“Fill Color”</em>: <span style=\"background-color:#00b050;border-radius:3px;border:1px solid #000;width:12px;height:12px;margin-right:5px;\">     </span> (green)</li>\n                          </ul>\n                        </li>\n                      </ul>\n                    </li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Rule”</em>\n              <ul>\n                <li>In <em>“Conditions to Apply”</em>:\n                  <ul>\n                    <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Conditions to Apply”</em>\n                      <ul>\n                        <li><em>“Condition”</em>: <code class=\"language-plaintext highlighter-rouge\">Based on value (ONLY for scatter/histogram/heatmap/line)</code>\n                          <ul>\n                            <li><em>“Points below this value”</em>: <code class=\"language-plaintext highlighter-rouge\">-0.15</code></li>\n                          </ul>\n                        </li>\n                      </ul>\n                    </li>\n                  </ul>\n                </li>\n                <li>In <em>“Actions to Apply”</em>:\n                  <ul>\n                    <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Actions to Apply”</em>\n                      <ul>\n                        <li><em>“Action”</em>: <code class=\"language-plaintext highlighter-rouge\">Change Fill Color for all points</code>\n                          <ul>\n                            <li><em>“Fill Color”</em>: <span style=\"background-color:#ff0000;border-radius:3px;border:1px solid #000;width:12px;height:12px;margin-right:5px;\">     </span> (red)</li>\n                          </ul>\n                        </li>\n                      </ul>\n                    </li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>You should now see a plot like this:</p>\n\n<p><a href=\"../../images/circos/cancer-cnv-full.png\" rel=\"noopener noreferrer\"><img src=\"../../images/circos/cancer-cnv-full.png\" alt=\"Circos plot with SNV track with rules defined. \" width=\"3000\" height=\"3000\" loading=\"lazy\" /></a></p>\n\n<p>Sometimes it can also be nice to see the axes of the plot, to more accurately judge the values of the different data points.\nWe can do this as follows:</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Add plot axes</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Hit <strong>Rerun</strong> <i class=\"fas fa-redo\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-refresh</span> on the previous Circos <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> run</p>\n    </li>\n    <li>In the <strong>2D data track</strong> of the CNV track we just created, add plot axes as follows:\n      <ul>\n        <li>In <em>“Axes”</em>:\n          <ul>\n            <li>In <em>“Axis”</em>:\n              <ul>\n                <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Axis”</em>\n                  <ul>\n                    <li><em>“Spacing”</em>: <code class=\"language-plaintext highlighter-rouge\">0.25</code></li>\n                    <li><em>“Color”</em>: <span style=\"background-color:#7f7f7f;border-radius:3px;border:1px solid #000;width:12px;height:12px;margin-right:5px;\">     </span> (gray)</li>\n                    <li><em>“y0”</em>: -1</li>\n                    <li><em>“y1”</em>: 1</li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the output <code class=\"language-plaintext highlighter-rouge\">Circos Plot CopyNumber</code></li>\n  </ol>\n\n</blockquote>\n\n<p>You should now see a plot with axes:</p>\n\n<p><a href=\"../../images/circos/cancer-cnv-full-axes.png\" rel=\"noopener noreferrer\"><img src=\"../../images/circos/cancer-cnv-full-axes.png\" alt=\"Circos plot with SNV track with rules and axes defined. \" width=\"3000\" height=\"3000\" loading=\"lazy\" /></a></p>\n\n<!-- TODO: update image when axes are fixed (should be able to go to -1) -->\n\n<h2 id=\"b-allele-frequency\">B-allele Frequency</h2>\n\n<p>Next, we will visualize the B-allele frequency (also known as minor allele frequency)</p>\n\n<blockquote class=\"comment\">\n  <comment-title>Background: B-allele Frequency (BAF)</comment-title>\n\n  <p>The B-allele frequency is closely related to copy number. There are many nuances to the measurement of B-allele frequency,\nbut roughly speaking it indicates the frequency (ratio) of the non-reference allele of the SNP within the sample</p>\n\n  <p>This can be used to estimate copy number changes; in a diploid genome we expect to observe 3 states:</p>\n  <ol>\n    <li>SNP is present in 100% of the probes (<strong>homozygous variant</strong>)</li>\n    <li>SNP is present in 0% of the probes (<strong>homozygous reference</strong>)</li>\n    <li>SNP is present in 50% of the probes (<strong>heterozygous</strong>)</li>\n  </ol>\n\n  <p><br /></p>\n\n  <p>By plotting this percentage, we get our B-allele frequency plot:</p>\n\n  <figure id=\"figure-11\" style=\"max-width: 90%;\"><img src=\"../../images/circos/cnv-baf-intro.png\" alt=\"Example CNV and BAF plots for different copy number states. \" width=\"260\" height=\"341\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/circos/cnv-baf-intro.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 11</strong>:</span> expected B-allele frequency plot (top) and Log R ratio plot (bottom) for different copy number states</figcaption></figure>\n\n  <p>When these SNPs are detected at different ratios, it may indicate copy number variation. For example, a region displaying SNP ratios of 33% and 66% may indicate a copy number of 3 for that region (see image above).</p>\n\n</blockquote>\n\n<p>Now we will add such a B-allele frequency plot as track in our Circos visualization.\nThe data we will use for this is also obtained from SNP array data, and looks like this:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>Chromosome\tStart\tEnd\tValue\nchr1\t10004\t10004\t0.9956236\nchr1\t28663\t28663\t0.005509489\nchr1\t46844\t46844\t0.488594\nchr1\t59415\t59415\t0.570193\nchr1\t72017\t72017\t0.006410222\nchr1\t97215\t97215\t0.0\nchr1\t110905\t110905\t0.9918569\n[..]\n</code></pre></div></div>\n\n<p>Note that the B-allele frequency value is always between 0 and 1.</p>\n\n<p>We will make another scatterplot, so our data should be in the same format as the copynumber track: <code class=\"language-plaintext highlighter-rouge\">chr - start - end - value</code>. Luckily, this data is already in the correct format, all we have to do is remove the header line! We will also subset the data again by selecting lines randomly from the file.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Prepare the B-allele frequency table</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"Remove beginning1\" title=\"Remove beginning tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Remove beginning</strong></span> with the following parameters:\n      <ul>\n        <li><em>“Remove first”</em>: <code class=\"language-plaintext highlighter-rouge\">1</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“from”</em>: <code class=\"language-plaintext highlighter-rouge\">VCaP_B-allele frequence.tsv</code></li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"random_lines1\" title=\"Select random lines tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Select random lines</strong></span> with the following parameters:\n      <ul>\n        <li><em>“Randomly select”</em>: <code class=\"language-plaintext highlighter-rouge\">25000</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“from”</em>: output of <strong>Remove</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n        <li><em>“Set a random seed”</em>: <code class=\"language-plaintext highlighter-rouge\">Don't set seed</code></li>\n      </ul>\n    </li>\n    <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> this file to <code class=\"language-plaintext highlighter-rouge\">baf-circos.tsv</code></li>\n  </ol>\n\n</blockquote>\n\n<p>Now are data is ready to be plotted in Circos. We will plot this track directly inside the CNV track, which means we will have to change the radius of the SV link track again as well.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Add B-allele Frequency track to Circos</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Hit <strong>Rerun</strong> <i class=\"fas fa-redo\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-refresh</span> on the previous Circos <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> run (<code class=\"language-plaintext highlighter-rouge\">Circos Plot CopyNumber</code>)</p>\n    </li>\n    <li>Add a new scatterplot track to the image\n      <ul>\n        <li>In <em>“2D Data Tracks”</em>:\n          <ul>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert 2D Data Plot”</em>\n              <ul>\n                <li><em>“Outside Radius”</em>: <code class=\"language-plaintext highlighter-rouge\">0.75</code></li>\n                <li><em>“Inside Radius”</em>: <code class=\"language-plaintext highlighter-rouge\">0.6</code></li>\n                <li><em>“Plot Format”</em>: <code class=\"language-plaintext highlighter-rouge\">Scatter</code>\n                  <ul>\n                    <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Scatter Plot Data Source”</em>: <code class=\"language-plaintext highlighter-rouge\">baf-circos.tsv</code> (output of <strong>Select random lines</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n                    <li>In <em>“Plot Format Specific Options”</em>:\n                      <ul>\n                        <li><em>“Glyph Size”</em>: <code class=\"language-plaintext highlighter-rouge\">4</code></li>\n                        <li><em>“Fill Color”</em>: <span style=\"background-color:#7f7f7f;border-radius:3px;border:1px solid #000;width:12px;height:12px;margin-right:5px;\">     </span> (gray)</li>\n                        <li><em>“Stroke Thickness”</em>: <code class=\"language-plaintext highlighter-rouge\">0</code></li>\n                      </ul>\n                    </li>\n                  </ul>\n                </li>\n                <li><em>“Minimum / maximum options”</em>: <code class=\"language-plaintext highlighter-rouge\">Supply min/max values</code>\n                  <ul>\n                    <li><em>“Minimum value”</em>: <code class=\"language-plaintext highlighter-rouge\">0.0</code></li>\n                    <li><em>“Maximum value”</em>: <code class=\"language-plaintext highlighter-rouge\">1.0</code></li>\n                  </ul>\n                </li>\n                <li>In <em>“Axes”</em>:\n                  <ul>\n                    <li>In <em>“Axis”</em>:\n                      <ul>\n                        <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Axis”</em>\n                          <ul>\n                            <li><em>“Spacing”</em>: <code class=\"language-plaintext highlighter-rouge\">0.25</code></li>\n                          </ul>\n                        </li>\n                      </ul>\n                    </li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n        <li>In <em>“Link Tracks”</em>:\n          <ul>\n            <li>In <em>“1: Link Data”</em>:\n              <ul>\n                <li><em>“Inside Radius”</em>: <code class=\"language-plaintext highlighter-rouge\">0.55</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> this plot to <code class=\"language-plaintext highlighter-rouge\">Circos Plot BAF</code></li>\n  </ol>\n\n</blockquote>\n\n<p>You should see a plot that looks like this:</p>\n\n<p><a href=\"../../images/circos/cancer-baf.png\" rel=\"noopener noreferrer\"><img src=\"../../images/circos/cancer-baf.png\" alt=\"Circos output with BAF track. \" width=\"3000\" height=\"3000\" loading=\"lazy\" /></a></p>\n\n<p>Great! we can see our B-allele frequency plot track added.</p>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>Look at the B-allele frequency track, try to identify chromosome(s) having a copy number of:\n      <ol>\n        <li><code class=\"language-plaintext highlighter-rouge\">CN=2</code> (diploid)</li>\n        <li><code class=\"language-plaintext highlighter-rouge\">CN=1</code> (haploid)</li>\n        <li><code class=\"language-plaintext highlighter-rouge\">CN=3</code> (triploid)</li>\n      </ol>\n\n      <p>Hint: <a href=\"../../images/circos/cnv-baf-intro.png\" rel=\"noopener noreferrer\"><img src=\"../../images/circos/cnv-baf-intro.png\" alt=\"Example CNV and BAF plots for different copy number states. \" width=\"260\" height=\"341\" loading=\"lazy\" /></a></p>\n    </li>\n    <li>Do you see anything other than these states?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>Compare the B-allele frequency plot to the expected plot shown above for the different copynumber states.\n        <ol>\n          <li>Chromosome 12 appears completely diploid</li>\n          <li>Chromosomes 16 and X appear to have only 1 copy (no heterozygosity and a loss in copynumber as shown by the CNV track)</li>\n          <li>Chromosomes 1,2, and 3 show a pattern consistent with <code class=\"language-plaintext highlighter-rouge\">CN=3</code></li>\n        </ol>\n      </li>\n      <li>Chromosome 5 shows a lot of changes in B-allele frequency. Chromosome 19 displays a pattern that could potentially indicate 4 copies (B-allele frequencies of 0, 0.25, 0.5, 0.75 and 1)</li>\n    </ol>\n  </blockquote>\n</blockquote>\n\n<h2 id=\"optional-final-tweaking-of-circos-plot\">Optional: Final Tweaking of Circos plot</h2>\n\n<p>You may have noticed, that by moving the link track closer to the center repeatedly, the track of intrachromosomal links has become rather narrow.\nThere is a parameter of the link track type called <em>Bezier</em>, which controls how tightly the links arc (i.e. how close to the center they reach. By playing around with this parameter, we can fine a more pleasing</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Change Bezier radius</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Hit <strong>Rerun</strong> <i class=\"fas fa-redo\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-refresh</span> on the previous Circos <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> run (<code class=\"language-plaintext highlighter-rouge\">Circos Plot BAF</code>)</p>\n    </li>\n    <li>\n      <p>Change the Bezier parameter of the SV track:</p>\n      <ul>\n        <li>In <em>“Link Tracks”</em>:\n          <ul>\n            <li>In <em>“1: Link Data”</em>:\n              <ul>\n                <li><em>“Bezier Radius”</em>: <code class=\"language-plaintext highlighter-rouge\">0.25</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p><a href=\"../../images/circos/cancer-all.png\" rel=\"noopener noreferrer\"><img src=\"../../images/circos/cancer-all.png\" alt=\"Final Circos image. \" width=\"3000\" height=\"3000\" loading=\"lazy\" /></a></p>\n\n<p>Another thing you may have noticed, is that in the original image we showed at the start of this section, the red links (interchromosomal SVs) were displayed as a completely different track. To do this, instead of creating a single track with a rule to change the colour of a subset of the data, we can make 2 separate tracks, with rules to only plot a subset of the data.</p>\n\n<blockquote class=\"question\">\n  <question-title>Exercise: Split SV track into two</question-title>\n\n  <ol>\n    <li>Try to split the link track in two so that it matches the original image. This may take some trial and error. The full configuration is shown in the answer box below, but we provede some hints if you want to try it yourself first:\n      <ol>\n        <li><strong>Change the existing link track:</strong>\n          <ol>\n            <li>instead of a rule to change the colour of <em>interchromosomal</em> SVs, change their visibility (hide them)</li>\n          </ol>\n        </li>\n        <li><strong>Add a new link track</strong>\n          <ol>\n            <li>Choose an appropriate radius</li>\n            <li>Set the link colour to red</li>\n            <li>Add a rule to hide the <em>intrachromosomal</em> SVs</li>\n          </ol>\n        </li>\n      </ol>\n    </li>\n  </ol>\n\n  <figure id=\"figure-12\" style=\"max-width: 90%;\"><img src=\"../../images/circos/vcap.png\" alt=\"VCaP cancer Circos plot. \" width=\"3000\" height=\"3000\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/circos/vcap.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 12</strong>:</span> The original image from the paper. Try to make the two link tracks look like this</figcaption></figure>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <p>The full configuration  of the two link tracks is:</p>\n\n    <blockquote class=\"hands_on\">\n      <hands-on-title>Hands on: Two link tracks</hands-on-title>\n\n      <ol>\n        <li>\n          <p>Hit <strong>Rerun</strong> <i class=\"fas fa-redo\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-refresh</span> on the previous Circos <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> run</p>\n        </li>\n        <li>\n          <p>Configure two separate link tracks:</p>\n          <ul>\n            <li>In <em>“Link Tracks”</em>:\n              <ul>\n                <li>In <em>“Link Data”</em>:\n                  <ul>\n                    <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Link Data”</em>\n                      <ul>\n                        <li><em>“Inside Radius”</em>: <code class=\"language-plaintext highlighter-rouge\">0.55</code></li>\n                        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Link Data Source”</em>: <code class=\"language-plaintext highlighter-rouge\">SVs Circos.tsv</code></li>\n                        <li><em>“Link Type”</em>: <code class=\"language-plaintext highlighter-rouge\">basic</code></li>\n                        <li><em>“Thickness”</em>: <code class=\"language-plaintext highlighter-rouge\">1.0</code></li>\n                        <li><em>“Bezier Radius”</em>: <code class=\"language-plaintext highlighter-rouge\">0.25</code></li>\n                        <li>In <em>“Advanced Settings”</em>:\n                          <ul>\n                            <li><em>“Bezier Radius Purity”</em>: <code class=\"language-plaintext highlighter-rouge\">1.0</code></li>\n                            <li><em>“Perturb links?”</em>: <code class=\"language-plaintext highlighter-rouge\">no</code></li>\n                          </ul>\n                        </li>\n                        <li>In <em>“Rules”</em>:\n                          <ul>\n                            <li>In <em>“Rule”</em>:\n                              <ul>\n                                <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Rule”</em>\n                                  <ul>\n                                    <li>In <em>“Conditions to Apply”</em>:\n                                      <ul>\n                                        <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Conditions to Apply”</em>\n                                          <ul>\n                                            <li><em>“Condition”</em>: <code class=\"language-plaintext highlighter-rouge\">Interchromosomal</code></li>\n                                          </ul>\n                                        </li>\n                                      </ul>\n                                    </li>\n                                    <li>In <em>“Actions to Apply”</em>:\n                                      <ul>\n                                        <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Actions to Apply”</em>\n                                          <ul>\n                                            <li><em>“Action”</em>: <code class=\"language-plaintext highlighter-rouge\">Change Visibility</code></li>\n                                            <li><em>“Show”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n                                          </ul>\n                                        </li>\n                                      </ul>\n                                    </li>\n                                  </ul>\n                                </li>\n                              </ul>\n                            </li>\n                          </ul>\n                        </li>\n                      </ul>\n                    </li>\n                    <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Link Data”</em>\n                      <ul>\n                        <li><em>“Inside Radius”</em>: <code class=\"language-plaintext highlighter-rouge\">0.3</code></li>\n                        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Link Data Source”</em>: <code class=\"language-plaintext highlighter-rouge\">SVs Circos.tsv</code></li>\n                        <li><em>“Link Type”</em>: <code class=\"language-plaintext highlighter-rouge\">basic</code></li>\n                        <li><em>“Link Color”</em>: <span style=\"background-color:#ff0000;border-radius:3px;border:1px solid #000;width:12px;height:12px;margin-right:5px;\">     </span> (red)</li>\n                        <li><em>“Thickness”</em>: <code class=\"language-plaintext highlighter-rouge\">2.0</code></li>\n                        <li><em>“Bezier Radius”</em>: <code class=\"language-plaintext highlighter-rouge\">0.0</code></li>\n                        <li>In <em>“Rules”</em>:\n                          <ul>\n                            <li>In <em>“Rule”</em>:\n                              <ul>\n                                <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Rule”</em>\n                                  <ul>\n                                    <li>In <em>“Conditions to Apply”</em>:\n                                      <ul>\n                                        <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Conditions to Apply”</em>\n                                          <ul>\n                                            <li><em>“Condition”</em>: <code class=\"language-plaintext highlighter-rouge\">Intrachromosomal</code></li>\n                                          </ul>\n                                        </li>\n                                      </ul>\n                                    </li>\n                                    <li>In <em>“Actions to Apply”</em>:\n                                      <ul>\n                                        <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Actions to Apply”</em>\n                                          <ul>\n                                            <li><em>“Action”</em>: <code class=\"language-plaintext highlighter-rouge\">Change Visibility</code></li>\n                                            <li><em>“Show”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n                                          </ul>\n                                        </li>\n                                      </ul>\n                                    </li>\n                                  </ul>\n                                </li>\n                              </ul>\n                            </li>\n                          </ul>\n                        </li>\n                      </ul>\n                    </li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ol>\n\n    </blockquote>\n\n  </blockquote>\n</blockquote>\n\n<p>Awesome! You have now created a publication-quality Circos plot within Galaxy! There are more example plots in the sections below if you would like to get some more practice with the tool.</p>\n\n<h1 id=\"example-presidential-debate\">Example: Presidential Debate</h1>\n\n<p>Circos was originally developed for genomics data, and a lot of the terminology in the tool is reminiscent of genomics (karyotype, ideogram, chromosome), but Circos can be used to plot any type of data. To illustrate this, the next example involves recreating a plot that appeared in <a href=\"http://www.nytimes.com/interactive/2007/12/15/us/politics/DEBATE.html\">an article in the New York Times</a>, visualizing the 2008 presidential debates.</p>\n\n<figure id=\"figure-13\" style=\"max-width: 90%;\"><img src=\"../../images/circos/presidential_debate_nyt.png\" alt=\"Original plot from the NYT article. \" width=\"900\" height=\"660\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/circos/presidential_debate_nyt.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 13</strong>:</span> Plot showing how many times each presidential candidate mentioned each other candidate in the debates leading up to the 2008 US presidential election.</figcaption></figure>\n\n<blockquote class=\"comment\">\n  <comment-title>Note</comment-title>\n\n  <p>This tutorial is based on one of the <a href=\"http://circos.ca/documentation/tutorials/recipes/naming_names/\">tutorials on the Circos website</a>.</p>\n\n</blockquote>\n\n<p>Since we could not obtain the original datasets used to generate this image, we will re-create a similar plot using an artificial dataset:</p>\n\n<p><a href=\"../../images/circos/presidential_debate_plot.png\" rel=\"noopener noreferrer\"><img src=\"../../images/circos/presidential_debate_plot.png\" alt=\"Presidential plot we will create this tutorial. \" width=\"3000\" height=\"3000\" loading=\"lazy\" /></a></p>\n\n<h2 id=\"get-data\">Get Data</h2>\n\n<p>First, let’s get the data we need for this plot:</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Obtaining our data</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Make sure you have an empty analysis history. Give it a name.</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-new-history-1\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-new-history-1\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a new history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>Click the <i class=\"fas fa-plus\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">new-history</span> icon at the top of the history panel:</p>   <p><img src=\"/training-material/shared/images/history_create_new.svg\" alt=\"UI for creating new history\" /></p>   <!-- the original drawing can be found here https://docs.google.com/drawings/d/1cCBrLAo4kDGic5QyB70rRiWJAKTenTU8STsKDaLcVU8/edit?usp=sharing --> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p><strong>Import Data.</strong></p>\n      <ul>\n        <li>Import the sample data files to your history, either from a shared data library (if available), or from Zenodo using the following URLs:</li>\n      </ul>\n\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/4494146/files/debate_karyotype.txt\nhttps://zenodo.org/record/4494146/files/debate_links.tab\nhttps://zenodo.org/record/4494146/files/debate_slices.tab\n</code></pre></div>      </div>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-via-links-1\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-via-links-1\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing via links</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-data-from-a-data-library-1\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-data-from-a-data-library-1\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing data from a data library</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>As an alternative to uploading the data from a URL or your computer, the files may also have been made available from a <em>shared data library</em>:</p>   <ol>   <li>Go into <strong>Shared data</strong> (top panel) then <strong>Data libraries</strong></li>   <li>Navigate to  the correct folder as indicated by your instructor.     <ul>       <li>On most Galaxies tutorial data will be provided in a folder named <strong>GTN - Material –&gt; Topic Name -&gt; Tutorial Name</strong>.</li>     </ul>   </li>   <li>Select the desired files</li>   <li>Click on <strong>Add to History</strong> <i class=\"fas fa-caret-down\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-dropdown</span> near the top and select <strong>as Datasets</strong> from the dropdown menu</li>   <li>     <p>In the pop-up window, choose</p>     <ul>       <li><em>“Select history”</em>: the history you want to import the data to (or create a new one)</li>     </ul>   </li>   <li>Click on <strong>Import</strong></li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h2 id=\"ideogram-2\">Ideogram</h2>\n\n<p>Ideograms can be used to depict any axes, not just a stretch of genomics sequence like a chromosome. In this example, each segment corresponds to a candidate’s total word count during all the debates.</p>\n\n<p>The karyotype file (<code class=\"language-plaintext highlighter-rouge\">debate_karyotype.tab</code>) defines these segments:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>chr - obama OBAMA 0 2000 dem\nchr - richardson RICHARDSON 0 1000 dem\nchr - clinton CLINTON 0 1500 dem\nchr - mccain MCCAIN 0 1000 rep\nchr - romney ROMNEY 0 1750 rep\nchr - huckabee HUCKABEE 0 1250 rep\n</code></pre></div></div>\n\n<p>In this example, Obama spoke 2000 words, Richardson spoke a total of 1000 words, etc. These are not the real values, but we are using them as an example.\nThe last column indicates the party of each candidate (democratic or republican), and will be used for the color of the segments.</p>\n\n<p>Let’s start by creating the ideogram for our plot:</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Set ideogram configuration</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/circos/circos/0.69.8+galaxy12\" title=\"Circos tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Circos</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.69.8+galaxy12)</span> with the following parameters:\n      <ul>\n        <li>In <em>“Karyotype”</em>:\n          <ul>\n            <li><em>“Reference Genome Source”</em>: <code class=\"language-plaintext highlighter-rouge\">Custom Karyotype</code>\n              <ul>\n                <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Karyotype Configuration”</em>: <code class=\"language-plaintext highlighter-rouge\">debate_karyotype.tab</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n        <li>In <em>“Ideogram”</em>:\n          <ul>\n            <li><em>“Chromosome units”</em>: <code class=\"language-plaintext highlighter-rouge\">bases</code></li>\n            <li><em>“Spacing Between Ideograms (in chromosome units)”</em>: <code class=\"language-plaintext highlighter-rouge\">20</code></li>\n            <li>In <em>“Labels”</em>:\n              <ul>\n                <li><em>“Label Font Size”</em>: <code class=\"language-plaintext highlighter-rouge\">40</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>\n      <p><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the output <code class=\"language-plaintext highlighter-rouge\">Circos Plot karyotype</code></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-renaming-a-dataset-1\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-renaming-a-dataset-1\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Renaming a dataset</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, change the <strong>Name</strong> field</li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>The resulting file should look something like this:</p>\n\n<p><a href=\"../../images/circos/debate_karyotype.png\" rel=\"noopener noreferrer\"><img src=\"../../images/circos/debate_karyotype.png\" alt=\"first step of the debate circos plot. \" width=\"3000\" height=\"3000\" loading=\"lazy\" /></a></p>\n\n<p>That looks right, but we want to colour each candidate’s segment according to their party. We will do this using a <em>highlights</em> track.</p>\n\n<h2 id=\"highlights-track\">Highlights track</h2>\n\n<p>This highlights track shows a highlight for each debate, in the color of their party (blue for democrat, red for republican). The size of each highlight indicates the number of words spoken by the candidate in each debate. The file <code class=\"language-plaintext highlighter-rouge\">debate_slices.tab</code> contains this information and looks like this:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>obama       0    300    stroke_thickness=5,stroke_color=white\nobama       301  750    stroke_thickness=5,stroke_color=white\nobama       751  950    stroke_thickness=5,stroke_color=white\nobama       951  1250   stroke_thickness=5,stroke_color=white\nobama       1251 1500   stroke_thickness=5,stroke_color=white\nobama       1501 2000   stroke_thickness=5,stroke_color=white\nrichardson  0    250    stroke_thickness=5,stroke_color=white\nrichardson  251  750    stroke_thickness=5,stroke_color=white\n[..]\n</code></pre></div></div>\n\n<p>It is of format <code class=\"language-plaintext highlighter-rouge\">segment - start - end</code>, with an optional 4th column, which can contain some additional Circos parameter settings.</p>\n\n<p>Now, let’s use this file to create our highlights track</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Add Highlights track to Circos Plot</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Hit <strong>Rerun</strong> <i class=\"fas fa-redo\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-refresh</span> on the previous Circos <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> run (<code class=\"language-plaintext highlighter-rouge\">Circos Plot karyotype</code>)</p>\n    </li>\n    <li>Add highlights to the ideogram:\n      <ul>\n        <li>In “2D Data Tracks”:\n          <ul>\n            <li>In “2D Data Plots”:\n              <ul>\n                <li><em>“Outside Radius”</em>: <code class=\"language-plaintext highlighter-rouge\">1</code></li>\n                <li><em>“Inside Radius”</em>: <code class=\"language-plaintext highlighter-rouge\">0.9</code></li>\n                <li><em>“Plot Type”</em>: <code class=\"language-plaintext highlighter-rouge\">Highlight</code></li>\n                <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Highlight Data Source”</em>: <code class=\"language-plaintext highlighter-rouge\">debate_slices.tab</code></li>\n                <li>In “Plot Format Specific Options”:\n                  <ul>\n                    <li><em>“Fill Color”</em>: <span style=\"background-color:#d99696;border-radius:3px;border:1px solid #000;width:12px;height:12px;margin-right:5px;\">     </span> (light red)</li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n            <li>In “Rules”:\n              <ul>\n                <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> Insert Rule\n                  <ul>\n                    <li>In <em>“Conditions to Apply”</em>:\n                      <ul>\n                        <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Conditions to Apply”</em>\n                          <ul>\n                            <li><em>“Condition”</em>: <code class=\"language-plaintext highlighter-rouge\">Check for presence/absence per chromosome</code></li>\n                            <li><em>“Contig IDs”</em>: <code class=\"language-plaintext highlighter-rouge\">obama|richardson|clinton</code></li>\n                          </ul>\n                        </li>\n                      </ul>\n                    </li>\n                    <li>In <em>“Actions to Apply”</em>:\n                      <ul>\n                        <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Actions to Apply”</em>\n                          <ul>\n                            <li><em>“Action”</em>: <code class=\"language-plaintext highlighter-rouge\">Change Fill Color for all points</code></li>\n                            <li><em>“Fill Color”</em>: <span style=\"background-color:#548dd4;border-radius:3px;border:1px solid #000;width:12px;height:12px;margin-right:5px;\">     </span> (light blue)</li>\n                          </ul>\n                        </li>\n                      </ul>\n                    </li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the output <code class=\"language-plaintext highlighter-rouge\">Circos Plot highlights</code></li>\n  </ol>\n\n</blockquote>\n\n<p><a href=\"../../images/circos/debate_highlights.png\" rel=\"noopener noreferrer\"><img src=\"../../images/circos/debate_highlights.png\" alt=\"The debate plot with highlights track. \" width=\"3000\" height=\"3000\" loading=\"lazy\" /></a></p>\n\n<p>Great! All that is left to do now is add a link track. One line will be drawn for each time a candidate mentioned another candidate’s name.</p>\n\n<h2 id=\"link-track\">Link Track</h2>\n\n<p>The data is stored in the file named <code class=\"language-plaintext highlighter-rouge\">debate_links.tab</code>:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>obama\t150\t150\tclinton\t750\t750\nmccain\t875\t875\tclinton\t750\t750\nhuckabee\t525\t525\tclinton\t750\t750\n</code></pre></div></div>\n\n<p>The format is <code class=\"language-plaintext highlighter-rouge\">segment start end segment start end</code>. The first line indicates that Obama mentioned Clinton in a debate.</p>\n\n<p>Let’s add it to our plot:</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Add Highlights track to Circos Plot</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Hit <strong>Rerun</strong> <i class=\"fas fa-redo\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-refresh</span> on the previous Circos <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> run (<code class=\"language-plaintext highlighter-rouge\">Circos Plot highlights</code>)</p>\n    </li>\n    <li>\n      <p>Add a link track:</p>\n      <ul>\n        <li>In <em>“Link Tracks”</em>:\n          <ul>\n            <li>In <em>“Link Data”</em>:\n              <ul>\n                <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Link Data”</em>\n                  <ul>\n                    <li><em>“Inside Radius”</em>: <code class=\"language-plaintext highlighter-rouge\">0.89</code></li>\n                    <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Link Data Source”</em>: <code class=\"language-plaintext highlighter-rouge\">debate_links.tab</code></li>\n                    <li><em>“Link Type”</em>: <code class=\"language-plaintext highlighter-rouge\">basic</code></li>\n                    <li><em>“Thickness”</em>: <code class=\"language-plaintext highlighter-rouge\">5.0</code></li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p><a href=\"../../images/circos/debate_links.png\" rel=\"noopener noreferrer\"><img src=\"../../images/circos/debate_links.png\" alt=\"Debate plot with link track. \" width=\"3000\" height=\"3000\" loading=\"lazy\" /></a></p>\n\n<blockquote class=\"question\">\n  <question-title>Exercise: Focus on a single</question-title>\n\n  <ol>\n    <li>As an exercise, try to add rules to the link track to colour the links red or blue depending on party of the person who spoke (<code class=\"language-plaintext highlighter-rouge\">from_chromosom</code>)\n      <ul>\n        <li>The link should be blue for Obama, and red for McCain and Huckabee</li>\n        <li>Hint 1: since two of the links should be red, and one blue, it is easiest to make red the default colour, and use a rule to change the colour for Obama</li>\n        <li>Hint 2: use <code class=\"language-plaintext highlighter-rouge\">Chromosome</code> as the condition for the rule</li>\n      </ul>\n    </li>\n  </ol>\n\n  <figure id=\"figure-14\" style=\"max-width: 90%;\"><img src=\"../../images/circos/presidential_debate_plot.png\" alt=\"Debate plot with coloured links. \" width=\"3000\" height=\"3000\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/circos/presidential_debate_plot.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 14</strong>:</span> Try to make the link track look like this</figcaption></figure>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <p>The full configuration  of the rules for the link tracks is:</p>\n\n    <blockquote class=\"hands_on\">\n      <hands-on-title>Hands on: Two link tracks</hands-on-title>\n\n      <ol>\n        <li>\n          <p>Hit <strong>Rerun</strong> <i class=\"fas fa-redo\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-refresh</span> on the previous Circos <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> run</p>\n        </li>\n        <li>\n          <p>Add rules to the link track:</p>\n          <ul>\n            <li>In <em>“Link Tracks”</em>:\n              <ul>\n                <li><em>“Link Color”</em>: <span style=\"background-color:#d99696;border-radius:3px;border:1px solid #000;width:12px;height:12px;margin-right:5px;\">     </span> (light red)</li>\n                <li>In <em>“Rules”</em>:\n                  <ul>\n                    <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Rule”</em>\n                      <ul>\n                        <li>In <em>“Conditions to Apply”</em>:\n                          <ul>\n                            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Conditions to Apply”</em>\n                              <ul>\n                                <li><em>“Condition”</em>: <code class=\"language-plaintext highlighter-rouge\">Chromosome</code>\n                                  <ul>\n                                    <li><em>“Comparison”</em>: <code class=\"language-plaintext highlighter-rouge\">from chromosome</code></li>\n                                    <li><em>“Chromosome”</em>: <code class=\"language-plaintext highlighter-rouge\">obama</code></li>\n                                  </ul>\n                                </li>\n                              </ul>\n                            </li>\n                            <li>In <em>“Actions to Apply”</em>:\n                              <ul>\n                                <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Actions to Apply”</em>\n                                  <ul>\n                                    <li><em>“Action”</em>: <code class=\"language-plaintext highlighter-rouge\">Change Link Color</code></li>\n                                    <li><em>“Link Color”</em>: <span style=\"background-color:#548dd4;border-radius:3px;border:1px solid #000;width:12px;height:12px;margin-right:5px;\">     </span> (light blue)</li>\n                                  </ul>\n                                </li>\n                              </ul>\n                            </li>\n                          </ul>\n                        </li>\n                      </ul>\n                    </li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ol>\n    </blockquote>\n\n  </blockquote>\n</blockquote>\n\n<p>Great work! You have now created a Circos plot with non-genomics data!</p>\n\n<p>The next example will show you how to recreate a Nature cover, if you would like to keep going.</p>\n\n<h1 id=\"example-nature-cover-encode\">Example: Nature Cover ENCODE</h1>\n\n<p>Here we will reproduce the output of the <a href=\"http://circos.ca/documentation/tutorials/recipes/nature_cover_encode/lesson\">Circos tutorial</a> for producing an image like that which was used on Nature’s Cover:</p>\n\n<figure id=\"figure-15\" style=\"max-width: 90%;\"><img src=\"../../images/nature_cover_encode.png\" alt=\"Nature Cover ENCODE. \" width=\"500\" height=\"657\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/nature_cover_encode.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 15</strong>:</span> Nature Cover</figcaption></figure>\n\n<h2 id=\"data-formats\">Data Formats</h2>\n\n<!-- TODO(hxr): document it all -->\n\n<p>The Circos Galaxy tool mostly accepts <code class=\"language-plaintext highlighter-rouge\">tabular</code> files. These always have at least three columns <code class=\"language-plaintext highlighter-rouge\">chromosome start end</code>.</p>\n\n<h2 id=\"get-data-1\">Get data</h2>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Data upload</hands-on-title>\n\n  <ol>\n    <li>Create a new history for this tutorial</li>\n    <li>\n      <p>Import the files from Zenodo or from the shared data library</p>\n\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/4494146/files/chrom.tab\nhttps://zenodo.org/record/4494146/files/highlights.tab\n</code></pre></div>      </div>\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-via-links-2\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-via-links-2\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing via links</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>Rename the datasets</li>\n    <li>\n      <p>Check that the datatype is <code class=\"language-plaintext highlighter-rouge\">tabular</code> for both files</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-changing-the-datatype\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-changing-the-datatype\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Changing the datatype</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, click <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Datatypes</strong> tab on the top</li>   <li>In the <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Assign Datatype</strong>, select <code class=\"language-plaintext highlighter-rouge\">tabular</code> from “<em>New type</em>” dropdown     <ul>       <li>Tip: you can start typing the datatype into the field to filter the dropdown menu</li>     </ul>   </li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h2 id=\"create-plot\">Create Plot</h2>\n\n<p>We will now create the plot all at once. Normally, this would be a more iterative step-by-step process. The previous examples show how this stepwise approach is normally used, here we just give you all the configuration to create this plot all at once.</p>\n\n<blockquote class=\"tip\">\n  <tip-title>Interface Complexity</tip-title>\n  <p>The interface looks deceptively simple when all of the sections are collapsed, but as you start adding tracks it can be easy to get lost and become overwhelmed, so just go slowly. Do not worry if your plot does not look exactly like the expected output.</p>\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Circos</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/circos/circos/0.69.8+galaxy12\" title=\"Circos tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Circos</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.69.8+galaxy12)</span> with the following parameters:\n      <ul>\n        <li>In <em>“Karyotype”</em>:\n          <ul>\n            <li><em>“Reference Genome Source”</em>: <code class=\"language-plaintext highlighter-rouge\">Custom Karyotype</code>\n              <ul>\n                <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Karyotype Configuration”</em>: <code class=\"language-plaintext highlighter-rouge\">chrom.tab</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n        <li>In <em>“Ideogram”</em>:\n          <ul>\n            <li><em>“Thickness”</em>: <code class=\"language-plaintext highlighter-rouge\">0.0</code></li>\n            <li>In <em>“Labels”</em>:\n              <ul>\n                <li><em>“Show Label”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n        <li>In <em>“General”</em>:\n          <ul>\n            <li><em>“Plot Background”</em>: <code class=\"language-plaintext highlighter-rouge\">Solid Color</code>\n              <ul>\n                <li><em>“Background Color”</em>: <span style=\"background-color:#000000;border-radius:3px;border:1px solid #000;width:12px;height:12px;margin-right:5px;\">     </span></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n        <li>In <em>“2D Tracks”</em>:\n          <ul>\n            <li>In <em>“2D Data Plot”</em>:\n              <ul>\n                <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert 2D Data Plot”</em></li>\n                <li>In *“1: 2D Data Plot\n                  <ul>\n                    <li><em>“Outside Radius”</em>: <code class=\"language-plaintext highlighter-rouge\">0.99</code></li>\n                    <li><em>“Inside Radius”</em>: <code class=\"language-plaintext highlighter-rouge\">0.9</code></li>\n                    <li><em>“Plot Type”</em>: <code class=\"language-plaintext highlighter-rouge\">Highlight</code></li>\n                    <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Highlight Data Source”</em>: <code class=\"language-plaintext highlighter-rouge\">highlights.tab</code></li>\n                  </ul>\n                </li>\n                <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert 2D Data Plot”</em></li>\n                <li>In *“2: 2D Data Plot\n                  <ul>\n                    <li><em>“Outside Radius”</em>: <code class=\"language-plaintext highlighter-rouge\">0.89</code></li>\n                    <li><em>“Inside Radius”</em>: <code class=\"language-plaintext highlighter-rouge\">0.8</code></li>\n                    <li><em>“Plot Type”</em>: <code class=\"language-plaintext highlighter-rouge\">Highlight</code></li>\n                    <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Highlight Data Source”</em>: <code class=\"language-plaintext highlighter-rouge\">highlights.tab</code></li>\n                    <li>In <em>“Rules”</em>:\n                      <ul>\n                        <li>In <em>“Rule”</em>:\n                          <ul>\n                            <li>Click on <em>“Insert Rule”</em>:</li>\n                            <li>In <em>“1: Rule”</em>:\n                              <ul>\n                                <li>In <em>“Conditions to Apply”</em>:\n                                  <ul>\n                                    <li>Click on <em>“Insert Conditions to Apply”</em>:</li>\n                                    <li>In <em>“1: Conditions to Apply”</em>:\n                                      <ul>\n                                        <li><em>“Condition”</em>: <code class=\"language-plaintext highlighter-rouge\">Randomly</code>\n                                          <ul>\n                                            <li><em>“Percentage of bins”</em>: <code class=\"language-plaintext highlighter-rouge\">0.1</code></li>\n                                          </ul>\n                                        </li>\n                                      </ul>\n                                    </li>\n                                  </ul>\n                                </li>\n                                <li>In <em>“Actions to Apply”</em>:\n                                  <ul>\n                                    <li>Click on <em>“Insert Actions to Apply”</em>:</li>\n                                    <li>In <em>“1: Actions to Apply”</em>:\n                                      <ul>\n                                        <li><em>“Action”</em>: <code class=\"language-plaintext highlighter-rouge\">Change Fill Color for all points</code>\n                                          <ul>\n                                            <li><em>“Fill Color”</em>: <span style=\"background-color:#8064a2;border-radius:3px;border:1px solid #000;width:12px;height:12px;margin-right:5px;\">     </span> (light purple)</li>\n                                          </ul>\n                                        </li>\n                                      </ul>\n                                    </li>\n                                  </ul>\n                                </li>\n                                <li><em>“Continue flow”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n                              </ul>\n                            </li>\n                            <li>Click on <em>“Insert Rule”</em>:</li>\n                            <li>In <em>“2: Rule”</em>:\n                              <ul>\n                                <li>In <em>“Conditions to Apply”</em>:\n                                  <ul>\n                                    <li>Click on <em>“Insert Conditions to Apply”</em>:</li>\n                                    <li>In <em>“1: Conditions to Apply”</em>:\n                                      <ul>\n                                        <li><em>“Condition”</em>: <code class=\"language-plaintext highlighter-rouge\">Randomly</code>\n                                          <ul>\n                                            <li><em>“Percentage of bins”</em>: <code class=\"language-plaintext highlighter-rouge\">0.1</code></li>\n                                          </ul>\n                                        </li>\n                                      </ul>\n                                    </li>\n                                  </ul>\n                                </li>\n                                <li>In <em>“Actions to Apply”</em>:\n                                  <ul>\n                                    <li>Click on <em>“Insert Actions to Apply”</em>:</li>\n                                    <li>In <em>“1: Actions to Apply”</em>:\n                                      <ul>\n                                        <li><em>“Action”</em>: <code class=\"language-plaintext highlighter-rouge\">Change Fill Color for all points</code>\n                                          <ul>\n                                            <li><em>“Fill Color”</em>: <span style=\"background-color:#ffff00;border-radius:3px;border:1px solid #000;width:12px;height:12px;margin-right:5px;\">     </span> (yellow)</li>\n                                          </ul>\n                                        </li>\n                                      </ul>\n                                    </li>\n                                  </ul>\n                                </li>\n                                <li><em>“Continue flow”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n                              </ul>\n                            </li>\n                          </ul>\n                        </li>\n                      </ul>\n                    </li>\n                  </ul>\n                </li>\n                <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert 2D Data Plot”</em></li>\n                <li>In *“3: 2D Data Plot\n                  <ul>\n                    <li><em>“Outside Radius”</em>: <code class=\"language-plaintext highlighter-rouge\">0.79</code></li>\n                    <li><em>“Inside Radius”</em>: <code class=\"language-plaintext highlighter-rouge\">0.7</code></li>\n                    <li><em>“Plot Type”</em>: <code class=\"language-plaintext highlighter-rouge\">Highlight</code></li>\n                    <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Highlight Data Source”</em>: <code class=\"language-plaintext highlighter-rouge\">highlights.tab</code></li>\n                    <li>In <em>“Rules”</em>:\n                      <ul>\n                        <li>In <em>“Rule”</em>:\n                          <ul>\n                            <li>Click on <em>“Insert Rule”</em>:</li>\n                            <li>In <em>“1: Rule”</em>:\n                              <ul>\n                                <li>In <em>“Conditions to Apply”</em>:\n                                  <ul>\n                                    <li>Click on <em>“Insert Conditions to Apply”</em>:</li>\n                                    <li>In <em>“1: Conditions to Apply”</em>:\n                                      <ul>\n                                        <li><em>“Condition”</em>: <code class=\"language-plaintext highlighter-rouge\">Randomly</code>\n                                          <ul>\n                                            <li><em>“Percentage of bins”</em>: <code class=\"language-plaintext highlighter-rouge\">0.2</code></li>\n                                          </ul>\n                                        </li>\n                                      </ul>\n                                    </li>\n                                  </ul>\n                                </li>\n                                <li>In <em>“Actions to Apply”</em>:\n                                  <ul>\n                                    <li>Click on <em>“Insert Actions to Apply”</em>:</li>\n                                    <li>In <em>“1: Actions to Apply”</em>:\n                                      <ul>\n                                        <li><em>“Action”</em>: <code class=\"language-plaintext highlighter-rouge\">Change Fill Color for all points</code>\n                                          <ul>\n                                            <li><em>“Fill Color”</em>: <span style=\"background-color:#8064a2;border-radius:3px;border:1px solid #000;width:12px;height:12px;margin-right:5px;\">     </span> (light purple)</li>\n                                          </ul>\n                                        </li>\n                                      </ul>\n                                    </li>\n                                  </ul>\n                                </li>\n                                <li><em>“Continue flow”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n                              </ul>\n                            </li>\n                            <li>Click on <em>“Insert Rule”</em>:</li>\n                            <li>In <em>“2: Rule”</em>:\n                              <ul>\n                                <li>In <em>“Conditions to Apply”</em>:\n                                  <ul>\n                                    <li>Click on <em>“Insert Conditions to Apply”</em>:</li>\n                                    <li>In <em>“1: Conditions to Apply”</em>:\n                                      <ul>\n                                        <li><em>“Condition”</em>: <code class=\"language-plaintext highlighter-rouge\">Randomly</code>\n                                          <ul>\n                                            <li><em>“Percentage of bins”</em>: <code class=\"language-plaintext highlighter-rouge\">0.2</code></li>\n                                          </ul>\n                                        </li>\n                                      </ul>\n                                    </li>\n                                  </ul>\n                                </li>\n                                <li>In <em>“Actions to Apply”</em>:\n                                  <ul>\n                                    <li>Click on <em>“Insert Actions to Apply”</em>:</li>\n                                    <li>In <em>“1: Actions to Apply”</em>:\n                                      <ul>\n                                        <li><em>“Action”</em>: <code class=\"language-plaintext highlighter-rouge\">Change Fill Color for all points</code>\n                                          <ul>\n                                            <li><em>“Fill Color”</em>: <span style=\"background-color:#ffff00;border-radius:3px;border:1px solid #000;width:12px;height:12px;margin-right:5px;\">     </span> (yellow)</li>\n                                          </ul>\n                                        </li>\n                                      </ul>\n                                    </li>\n                                  </ul>\n                                </li>\n                              </ul>\n                            </li>\n                          </ul>\n                        </li>\n                      </ul>\n                    </li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>View <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> the output PNG file</li>\n  </ol>\n\n</blockquote>\n\n<p>When this has complete, your output should look similar to the following;</p>\n\n<figure id=\"figure-16\" style=\"max-width: 90%;\"><img src=\"../../images/circos-encode.png\" alt=\"Circos simplified Nature ENCODE Cover. \" width=\"1200\" height=\"1200\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/circos-encode.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 16</strong>:</span> Simplified Nature Cover</figcaption></figure>\n\n<h1 id=\"further-editing\">Further Editing</h1>\n\n<p>Sometimes the plots you create will be very close to what you want for a final image, but might be missing something, or the slightly wrong colour, or something else you want to tweak. We will look at an example of taking the final microbe graphic from above and making some additional changes. This is <em>not</em> a hands-on as installing Circos on your local system is outside of the scope of this tutorial, but if you have Circos <a href=\"http://circos.ca/software/download/circos/\">installed locally</a>, you’re welcome to follow along.</p>\n\n<p>Re-running the final step of the cancer genomics example:</p>\n\n<ol>\n  <li>In outputs, enable the <strong>Configuration Archive</strong></li>\n  <li>You can download this <code class=\"language-plaintext highlighter-rouge\">.tar.gz</code> archive, and unpack it.</li>\n  <li>\n    <p>You should see files like:</p>\n\n    <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>.\n└── circos\n    ├── conf\n    │   ├── circos.conf\n    │   ├── data.conf\n    │   ├── galaxy_test_case.json\n    │   ├── highlight.conf\n    │   ├── ideogram.conf\n    │   ├── karyotype-colors.conf\n    │   ├── karyotype.txt\n    │   ├── links.conf\n    │   └── ticks.conf\n    └── data\n        ├── data-0.txt\n        ├── data-1.txt\n        └── links-0.txt\n</code></pre></div>    </div>\n  </li>\n  <li>\n    <p>In this directory, you can run the <code class=\"language-plaintext highlighter-rouge\">circos</code> command to rebuild the image locally.</p>\n\n    <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code> $ circos -conf circos/conf/circos.conf\n debuggroup summary 0.16s welcome to circos v0.69-6 31 July 2017 on Perl 5.026001\n debuggroup summary 0.17s current working directory /tmp/tmp.LqWqFc7RNW\n debuggroup summary 0.17s command /home/hxr/arbeit/circos/circos-0.69-6/bin/circos -conf circos/conf/circos.conf\n debuggroup summary 0.17s loading configuration from file circos/conf/circos.conf\n debuggroup summary 0.17s found conf file circos/conf/circos.conf\n debuggroup summary 0.30s debug will appear for these features: output,summary\n debuggroup summary 0.30s bitmap output image ./circos.png\n debuggroup summary 0.30s parsing karyotype and organizing ideograms\n debuggroup summary 0.39s karyotype has 24 chromosomes of total size 3,080,419,504\n debuggroup summary 0.40s applying global and local scaling\n debuggroup summary 0.41s allocating image, colors and brushes\n debuggroup summary 7.03s drawing 24 ideograms of total size 3,080,419,504\n debuggroup summary 7.03s drawing highlights and ideograms\n debuggroup summary 7.33s found conf file /home/hxr/arbeit/circos/circos-0.69-6/bin/../etc/tracks/link.conf\n debuggroup summary 7.33s process track_0 link circos/conf/../data/links-0.txt\n debuggroup summary 7.85s drawing link track_0 z 0\n debuggroup summary 9.42s found conf file /home/hxr/arbeit/circos/circos-0.69-6/bin/../etc/tracks/scatter.conf\n debuggroup summary 9.42s found conf file /home/hxr/arbeit/circos/circos-0.69-6/bin/../etc/tracks/scatter.conf\n debuggroup summary 9.42s processing track_0 scatter circos/conf/../data/data-0.txt\n debuggroup summary 23.98s processing track_1 scatter circos/conf/../data/data-1.txt\n debuggroup summary 31.57s drawing track_0 scatter z 0 data-0.txt orient out\n debuggroup summary 32.48s found conf file /home/hxr/arbeit/circos/circos-0.69-6/bin/../etc/tracks/axis.conf\n debuggroup summary 38.92s drawing track_1 scatter z 0 data-1.txt orient out\n debuggroup summary 39.84s found conf file /home/hxr/arbeit/circos/circos-0.69-6/bin/../etc/tracks/axis.conf\n debuggroup output 46.53s generating output\n debuggroup output 47.02s created PNG image ./circos.png (1004 kb)\n debuggroup summary,timer 47.02s image took more than 30 s to generate. Component timings are shown above. To always show them, use -debug_group timer. To adjust the time cutoff, change debug_auto_timer_report in etc/housekeeping.conf.\n</code></pre></div>    </div>\n  </li>\n</ol>\n\n<p>Looking at the extracted files, where possible the configuration files within the archive are annotated with their specific inputs, e.g.:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>&lt;plot&gt;\n    file        = data/data-1.txt # baf-circos.tsv\n    r1          = 0.75r\n    r0          = 0.6r\n    orientation = out\n    min         = 0.0\n    max         = 1.0\n</code></pre></div></div>\n\n<p>Hopefully this helps you take your Circos plots from 90% to 100% publication ready! If there are any changes you find yourself making manually very often, please <a href=\"https://github.com/galaxyproject/tools-iuc/issues/new\">let the tool authors know</a> and maybe they can add that configuration to the Galaxy tool.</p>\n\n<h1 id=\"conclusion\">Conclusion</h1>\n\n<p>Congratulations on finishing this tutorial! You have now seen how you can create Circos plots within Galaxy. Circos is a very flexible tool, but this flexibility also comes with a certain degree of complexity and a steep learning curve. When you are making your own plots, remember that Circos is an iterative process, don’t try to do too much at once, but build your plot up step by step, and check the output often.</p>\n"],"ref_slides":["# Circos for Genomics Visualisation\n\n---\n\n### What is Circos?\n\n- Circular Graphics\n- Highly flexible, but also very complex configuration\n- ... but beautiful visualisations\n- Can visualise a huge range of data types\n\n![Panel of example Circos images](../../images/circos-sample-panel.png)\n\n???\nMany researchers find Circos overwhelming and complex. This tool can save them time and we will hopefully show them how to reproduce several plots from published papers.\n\n---\n\n### Circos in Galaxy\n\n- Tool that produces a Circos Plot (PNG / SVG)\n- Circos is too complex to put all configuration options in Galaxy\n    - Option to **download full configuration** directory\n        - allows for further manual tweaking locally\n        - 90% done inside Galaxy, last 10% finished locally\n\n.image-50[![Screenshot of the Circos Galaxy tool](../../images/circos/circos_tool.png)]\n\n???\nEmphasize that producing production quality plots is still a lot of work. Not all configuration options available in Circos can be set in the Galaxy tool. But all the config files can be downloaded so that you can tweak the plot manually if you have circos installed on your computer\n\nWe cannot support them uploading these edited config files into Galaxy because of potential security issues (circos can shell out.)\n\n---\n\n### Supported Features\n\n- Covers *most* of the possibilities of Circos\n- Can **auto convert** GFF3/BED/(big)Wig datasets into appropriate formats\n- Supports common Circos features like:\n\t- histograms\n\t- heatmaps\n\t- \"tile\" (from gff3/bed)\n\t- line\n\t- scatter\n\t- ribbons\n- Complex Circos visualisations made easy (Thanks Galaxy!)\n\n---\n\n### Tracks: Histograms\n\n- For data which associate a position with a value\n- Can be good for\n  - Gene density on large genomes\n  - Variation density?\n  - GC Skew\n\n![Histogram Plot](../../images/circos-histogram.png)\n\n???\n\n---\n\n### Tracks: Heatmaps\n\n- Similar use case to histograms\n- Histograms may provide easier quantification for viewers\n\n![Heatmap Plot](../../images/circos-heatmap.png)\n\n???\n\nIt can be easier to quantify differences between two values next to each other with the histogram than relying on the viewer's ability to distinguish + quantify how far apart two colours lie on a colour scale. These can be pretty but are harder to extract data from\n\n---\n\n### Tracks: Tiles\n\n- Show genomic regions\n- Great for genes on small genomes\n\n\n\n![Tile Plot](../../images/circos-tiles.png)\n\n???\n\"Tile tracks are used to show spans such as genomic regions (genes, exons, duplications) or coverage elements (clones, sequence reads). Tiles will stack within their track to avoid overlap.\" (circos documentation)\n\n\n---\n\n### Tracks: Scatter\n\n- Can be used similarly to heatmaps and histograms\n\n![Scatter Plot](../../images/circos-scatter.png \"The data are SNP density for windows of 100kb (number of SNPs from dbSNP per base).\")\n\n???\n\nImage is based off of the Circos Scatter plot lesson. All images in this tutorial should be reproducible with the Galaxy Circos tool\n\nhttp://circos.ca/documentation/tutorials/2d_tracks/scatter_plots/lesson\n\n---\n\n### Tracks: Lines\n\n![Line Plot](../../images/circos-line.png)\n\n???\n\nImage is based off of the Circos Line lesson.\n\nhttp://circos.ca/documentation/tutorials/2d_tracks/line_plots/images\n\n---\n\n### Tracks: Ribbons\n\n- Shows a relationship between two regions\n- On the same chromosome or on different ones\n- Great for synteny mapping or other regional interactions\n\n![Ribbon Plot](../../images/circos-ribbons.png)\n\n???\n\nThis plot highlights all interactions coming from, or going to chr1.\n\nThis plot was generated from a set of random links. The circos-tools package includes a `randomlinks` tool that will generate these files. There is no galaxy wrapper for this tool.\n\n---\n\n### Circos: An iterative process!\n\n- Because of its complexity, creating a Circos plot is often an *iterative* process\n- Build your plot one step at a time, check the output regularly!\n\n.image-40[![Gif of a circos plots through the development process](../../images/circos2.gif)]\n"],"hands_on":true,"slides":true,"mod_date":"2024-05-29 14:28:52 +0000","pub_date":"2020-01-10 12:21:13 +0000","version":65,"workflows":[{"workflow":"main_workflow.ga","tests":false,"url":"https://training.galaxyproject.org/training-material/topics/visualisation/tutorials/circos/workflows/main_workflow.ga","path":"topics/visualisation/tutorials/circos/workflows/main_workflow.ga","wfid":"visualisation-circos","wfname":"main_workflow","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/visualisation-circos/versions/main_workflow","license":"AGPL-3.0-or-later","creators":[{"class":"Person","identifier":"0000-0001-9760-8992","name":"Helena Rasche"},{"class":"Person","identifier":"0000-0003-3803-468X","name":"Saskia Hiltemann"}],"name":"Circos tutorial","title":"Circos tutorial","test_results":null,"modified":"2024-06-24 07:44:32 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\nInput dataset\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"Remove beginning\"];\n  2[\"Remove beginning\"];\n  3[\"Select\"];\n  4[\"Circos\"];\n  5[\"Cut\"];\n  1 -->|out_file1| 5;\n  6[\"Select random lines\"];\n  2 -->|out_file1| 6;\n  7[\"Cut\"];\n  3 -->|out_file1| 7;\n  8[\"Select random lines\"];\n  5 -->|out_file1| 8;\n  9[\"Circos\"];\n  0 -->|output| 9;\n  7 -->|out_file1| 9;\n  10[\"Circos\"];\n  0 -->|output| 10;\n  7 -->|out_file1| 10;\n  11[\"Circos\"];\n  0 -->|output| 11;\n  7 -->|out_file1| 11;\n  8 -->|out_file1| 11;\n  12[\"Circos\"];\n  0 -->|output| 12;\n  7 -->|out_file1| 12;\n  8 -->|out_file1| 12;\n  13[\"Circos\"];\n  0 -->|output| 13;\n  7 -->|out_file1| 13;\n  8 -->|out_file1| 13;\n  14[\"Circos\"];\n  0 -->|output| 14;\n  7 -->|out_file1| 14;\n  8 -->|out_file1| 14;\n  15[\"Circos\"];\n  0 -->|output| 15;\n  7 -->|out_file1| 15;\n  8 -->|out_file1| 15;\n  6 -->|out_file1| 15;\n  16[\"Circos\"];\n  0 -->|output| 16;\n  7 -->|out_file1| 16;\n  8 -->|out_file1| 16;\n  6 -->|out_file1| 16;"},{"workflow":"nature_workflow.ga","tests":false,"url":"https://training.galaxyproject.org/training-material/topics/visualisation/tutorials/circos/workflows/nature_workflow.ga","path":"topics/visualisation/tutorials/circos/workflows/nature_workflow.ga","wfid":"visualisation-circos","wfname":"nature_workflow","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/visualisation-circos/versions/nature_workflow","license":"AGPL-3.0-or-later","creators":[{"class":"Person","identifier":"0000-0001-9760-8992","name":"Helena Rasche"},{"class":"Person","identifier":"0000-0003-3803-468X","name":"Saskia Hiltemann"}],"name":"Circos: Nature workflow","title":"Circos: Nature workflow","test_results":null,"modified":"2024-06-24 07:44:32 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\nInput dataset\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"ℹ️ Input Dataset\\nInput dataset\"];\n  style 1 stroke:#2c3143,stroke-width:4px;\n  2[\"Circos\"];\n  0 -->|output| 2;\n  1 -->|output| 2;\n  1 -->|output| 2;\n  1 -->|output| 2;\n  3[\"Circos\"];\n  0 -->|output| 3;\n  1 -->|output| 3;\n  1 -->|output| 3;\n  1 -->|output| 3;"}],"api":"https://training.galaxyproject.org/training-material/api/topics/visualisation/tutorials/circos/tutorial.json","tools":["Cut1","Grep1","Remove beginning1","random_lines1","toolshed.g2.bx.psu.edu/repos/iuc/circos/circos/0.69.8+galaxy12","upload1"],"supported_servers":{"exact":[{"url":"https://mississippi.sorbonne-universite.fr","name":"MISSISSIPPI","usegalaxy":false},{"url":"https://usegalaxy.eu","name":"UseGalaxy.eu","usegalaxy":true},{"url":"https://usegalaxy.fr/","name":"UseGalaxy.fr","usegalaxy":false},{"url":"https://usegalaxy.org","name":"UseGalaxy.org (Main)","usegalaxy":true}],"inexact":[{"url":"https://usegalaxy.cz/","name":"UseGalaxy.cz","usegalaxy":false},{"url":"https://usegalaxy.no/","name":"UseGalaxy.no","usegalaxy":false}]},"topic_name_human":"Visualisation","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"circos","owner":"iuc","revisions":"c4bde687c846","tool_panel_section_label":"Graph/Display Data","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: circos\n  owner: iuc\n  revisions: c4bde687c846\n  tool_panel_section_label: Graph/Display Data\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":false,"slides_recordings":[{"captioners":["assuntad23","shiltemann"],"date":"2021-02-15","galaxy_version":"21.01","length":"6M","youtube_id":"KCtI5KLp05k","speakers":["hexylena"]}],"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial","logo":"GTN","redirect_from":["/short/visualisation/circos/slides","/short/S00100"]}