{"layout":"tutorial_hands_on","title":"Mass spectrometry: LC-MS data processing","zenodo_link":"https://zenodo.org/record/5179809","level":"Introductory","questions":["Why should one consider performing data processing steps when dealing with Metabolomics data?","How to conduct LCMS-based untargeted metabolomic data processing using Galaxy?"],"objectives":["To comprehend the key role of data processing.","To comprehend the diversity of steps necessary to perform untargeted LC-MS metabolomic data processing.","To be familiar with the \"identify then perform\" approach necessary to deploy relevant data processing strategies."],"time_estimation":"2H","key_points":["Data processing is a key step in untargeted Metabolomics analyses. The question of data filtering and correction must be addressed in all projects, even thought in some cases it may lead to the decision of no action on data. In particular, blank filtering, pool variation study and signal drift correction are common aspects to consider when dealing with LC-MS.","Although some main steps are standard, various ways to combine tools exist. Remember that depending on your context (type of samples, protocol specificities...) specific filters/normalisations may be needed, independently of standards ones.","A variety of tools is available in Galaxy, but do not forget that you need appropriate knowledge to decide what to use depending on your data."],"contributors":[{"name":"Mélanie Petera","joined":"2019-06","id":"melpetera","url":"https://training.galaxyproject.org/training-material/api/contributors/melpetera.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/melpetera/"},{"name":"Workflow4Metabolomics core team","joined":"2019-06","id":"workflow4metabolomics","url":"https://training.galaxyproject.org/training-material/api/contributors/workflow4metabolomics.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/workflow4metabolomics/"}],"js_requirements":{"mathjax":null,"mermaid":false},"short_id":"T00196","url":"/topics/metabolomics/tutorials/lcms-dataprocessing/tutorial.html","topic_name":"metabolomics","tutorial_name":"lcms-dataprocessing","dir":"topics/metabolomics/tutorials/lcms-dataprocessing","symlink":null,"id":"metabolomics/lcms-dataprocessing","ref_tutorials":["<p>Metabolomics is a <em>-omic</em> science known for being one of the most closely related to phenotypes.\nIt involves the study of different types of matrices, such as blood, urine, tissues, in various organisms including plants.\nIt focuses on studying the very small molecules which are called <em>metabolites</em>, to better understand matters linked to the metabolism.</p>\n\n<p>Metabolomics analyses can be quite complex to conduct, especially when dealing with untargeted approaches. \n<strong>Liquid-Chromatography Mass Spectrometry</strong> (LC-MS) is one of the three main technologies used to perform this kind of approach. \nData analysis for this technology requires a large variety of steps, ranging from extracting information from the raw data to statistical analysis and annotation. \nOne of these steps is called “data processing”. It takes place after the pre-processing step (extraction of the peak list from raw data) and before any statistical analysis.\nYou can get an overview of a complete LC-MS untargeted metabolomic workflow by following <a href=\"/training-material/topics/metabolomics/tutorials/lcms/tutorial.html\">the dedicated training material</a>.</p>\n\n<p>After the pre-processing step, what you have at your disposal is a list of ions (hereafter in the form of a “variableMetadata” file) and the corresponding intensities (“dataMatrix” file).\nWhat you may want now is to get some relevant information from your tables. However, your data may not be suitable yet for statistical analysis.\nWhat should you do to ensure the quality of your tables? This tutorial will show you what the usual quality steps are.</p>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n  <p>In this tutorial, we will cover:</p>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#overview-and-data-upload\" id=\"markdown-toc-overview-and-data-upload\">Overview and data upload</a>    <ol>\n      <li><a href=\"#galaxy-tools-workflow\" id=\"markdown-toc-galaxy-tools-workflow\">Galaxy tools’ workflow</a></li>\n      <li><a href=\"#dataset-description\" id=\"markdown-toc-dataset-description\">Dataset description</a></li>\n      <li><a href=\"#data-upload\" id=\"markdown-toc-data-upload\">Data upload</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#removing-trash-signals\" id=\"markdown-toc-removing-trash-signals\">Removing “trash” signals</a>    <ol>\n      <li><a href=\"#filtering-signals-at-given-retention-times\" id=\"markdown-toc-filtering-signals-at-given-retention-times\">Filtering signals at given retention times</a></li>\n      <li><a href=\"#using-blanks-to-filter-noise-signals\" id=\"markdown-toc-using-blanks-to-filter-noise-signals\">Using blanks to filter noise signals</a></li>\n      <li><a href=\"#filtered-dataset-overview\" id=\"markdown-toc-filtered-dataset-overview\">Filtered dataset overview</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#signal-drift-and-batch-effect-correction\" id=\"markdown-toc-signal-drift-and-batch-effect-correction\">Signal drift and batch effect correction</a>    <ol>\n      <li><a href=\"#optional-step-checking-batch-effect-on-data\" id=\"markdown-toc-optional-step-checking-batch-effect-on-data\">[Optional step] Checking batch effect on data</a></li>\n      <li><a href=\"#performing-the-correction-process\" id=\"markdown-toc-performing-the-correction-process\">Performing the correction process</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#filtering-signals-of-insufficient-quality\" id=\"markdown-toc-filtering-signals-of-insufficient-quality\">Filtering signals of insufficient quality</a></li>\n  <li><a href=\"#study-specific-data-processing-example-normalising-data-according-to-a-non-analytical-effect\" id=\"markdown-toc-study-specific-data-processing-example-normalising-data-according-to-a-non-analytical-effect\">Study-specific data processing: example normalising data according to a non-analytical effect</a>    <ol>\n      <li><a href=\"#identifying-unwanted-variability\" id=\"markdown-toc-identifying-unwanted-variability\">Identifying unwanted variability</a></li>\n      <li><a href=\"#formalising-the-information\" id=\"markdown-toc-formalising-the-information\">Formalising the information</a></li>\n      <li><a href=\"#getting-rid-of-the-variability\" id=\"markdown-toc-getting-rid-of-the-variability\">Getting rid of the variability</a></li>\n      <li><a href=\"#checking-the-resulting-data\" id=\"markdown-toc-checking-the-resulting-data\">Checking the resulting data</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#conclusion\" id=\"markdown-toc-conclusion\">Conclusion</a></li>\n</ol>\n\n</blockquote>\n\n<h1 id=\"overview-and-data-upload\">Overview and data upload</h1>\n\n<p>Data processing covers a large range of actions. They can generally be described as transformation (<em>e.g.</em> normalisation) or filter (<em>e.g.</em> removal of unwanted ions). \nIn this tutorial we will focus on three main types of processing:</p>\n<ul>\n  <li>Removing “trash” signals</li>\n  <li>Correcting intensities</li>\n  <li>Removing signals of insufficient quality</li>\n</ul>\n\n<h2 id=\"galaxy-tools-workflow\">Galaxy tools’ workflow</h2>\n\n<p>The different Galaxy tools that will be used in this tutorial are given in the following workflow picture.</p>\n\n<figure id=\"figure-1\" style=\"max-width: 90%;\"><img src=\"../../images/tutorial-lcms-proc-wf.png\" alt=\"The picture is composed of 3 main boxes linked by arrows from left to right. In each of the first and last boxes, labelled '3 tabulars', are found 3 files named sampleMetadata, variableMetadata and dataMatrix. In the middle box labelled 'Quality Control' is found the workflow used in this tutorial, represented as tiny boxes with tool names, linked with arrows following the tutorial order.\" width=\"2000\" height=\"1096\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/tutorial-lcms-proc-wf.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 1</strong>:</span> The full tutorial workflow</figcaption></figure>\n\n<p>All these modules are part of the <a href=\"http://workflow4metabolomics.org/\">Wokflow4Metabolomics</a> tool suit (<span class=\"citation\"><a href=\"#Giacomoni2014\">Giacomoni <i>et al.</i> 2014</a></span>, <span class=\"citation\"><a href=\"#Guitton2017\">Guitton <i>et al.</i> 2017</a></span>).\nThey are compatible with the whole data analysis solution maintained by the W4M team.</p>\n\n<blockquote class=\"comment\">\n  <comment-title>Workflow4Metabolomics public history</comment-title>\n\n  <p>This training material can be followed running it on any Galaxy instance holding the Galaxy modules needed.\nNonetheless, if you happen to be a W4M user and do not want to run the hands-on yourself, please note that\nyou can find the entire history in the ‘published histories’ section of usegalaxy.fr:\n<a href=\"https://workflow4metabolomics.usegalaxy.fr/u/peteram/h/gtnlcmsdataprocessing\">GTN_LCMSprocessing</a></p>\n\n</blockquote>\n\n<h2 id=\"dataset-description\">Dataset description</h2>\n\n<p>To illustrate the steps in this tutorial, a dataset has been built purposely.\nIt is composed of 3 files. They are text files of tables with tabulation as separator.</p>\n\n<p>The <em>dataMatrix</em> file is a table containing the intensities of measured variables (ions, in lines) for every samples (in column).\nThe first column is for ions’ identifiers while the first line is for samples’ identifiers.</p>\n\n<p>The <em>variableMetadata</em> file is a table containing information about the ions. \nThe first column is for ions’ identifiers while the other columns gather information about m/z and retention time (rt).</p>\n\n<p>The <em>sampleMetadata</em> file is a table containing information about the samples. \nThe first column is for samples’ identifiers while the other columns gather analytical and biological information\nsuch as the order of injection in the analytical sequence and the biological groups of interest for the supposed study.</p>\n\n<p>The simulated design is composed of 30 biological samples (tagged “sample” in the <em>sampleType</em> column),\ncompleted with 8 quality-control pooled samples (tagged “pool” in the <em>sampleType</em> column)\nand 6 extraction solvent samples (tagged “blank” in the <em>sampleType</em> column). \nThe samples have been supposedly injected in two distinct sequences (tagged “B1” and “B2” in the <em>batch</em> column),\nthe injection order being given in the <em>injectionOrder</em> column. \nTwo sample characteristics are given:</p>\n<ul>\n  <li>The <em>Group</em> column represents two groups “A” and “B”, supposedly two biological groups (<em>e.g.</em> phenotypes, treatment groups…).</li>\n  <li>The <em>Osmo</em> column represents a measurement of supposed osmolarity, imagining that the samples may be urine samples.</li>\n</ul>\n\n<h2 id=\"data-upload\">Data upload</h2>\n\n<p>To perform the different exercices of this tutorial, you need to create a new history and upload the dedicated dataset.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Data upload</hands-on-title>\n\n  <ol>\n    <li>Create a new history for this tutorial</li>\n    <li>Import the 3 starting files in your history. Two possibilities:\n      <ul>\n        <li>Option 1: from a shared data library (ask your instructor)</li>\n        <li>Option 2: from <a href=\"https://zenodo.org/record/5179809\">Zenodo</a> using the URLs given below:</li>\n      </ul>\n\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/5179809/files/Dataprocessing_dataMatrix.txt\nhttps://zenodo.org/record/5179809/files/Dataprocessing_sampleMetadata.txt\nhttps://zenodo.org/record/5179809/files/Dataprocessing_variableMetadata.txt \n</code></pre></div>      </div>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-via-links\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-via-links\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing via links</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Rename the datasets for their names to be shorter: “dataMatrix”, “sampleMetadata”, “variableMetadata”.</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-renaming-a-dataset\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-renaming-a-dataset\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Renaming a dataset</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, change the <strong>Name</strong> field</li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Check that the datatype is “tabular”. If not, you may change it.</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-changing-the-datatype\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-changing-the-datatype\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Changing the datatype</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, click <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Datatypes</strong> tab on the top</li>   <li>In the <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Assign Datatype</strong>, select <code class=\"language-plaintext highlighter-rouge\">datatypes</code> from “<em>New type</em>” dropdown     <ul>       <li>Tip: you can start typing the datatype into the field to filter the dropdown menu</li>     </ul>   </li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n  <blockquote class=\"tip\">\n    <tip-title>Comment to W4M users</tip-title>\n\n    <p>In the <a href=\"https://workflow4metabolomics.usegalaxy.fr/u/peteram/h/gtnlcmsdataprocessing\">GTN_LCMSprocessing</a> history,\nthis step corresponds to the datasets number 1 to 3.</p>\n  </blockquote>\n\n</blockquote>\n\n<h1 id=\"removing-trash-signals\">Removing “trash” signals</h1>\n\n<p>Data are often affected by various sources of unwanted variability. This can be found in your tables in different ways, \ntwo common ones being the presence of unwanted ions, and the effect of biological or analytical variables on intensity measures. \nThis unwanted information can limit the effectiveness of statistical methods, leading sometimes to difficulties in revealing investigated effects. \nThus, identifying such variability can help analysing your data at its full potential. \nYet, getting rid of such information may not be a trivial problem. It requires different elements to be completed successfully.</p>\n\n<p>In this section we will adress the question of “trash” signal filtering. \nBy this we mean ions that are present in the extracted peak list we have, but that do not correspond to relevant compounds to analyse.\nThis can be for example noise, or ions from compounds that are not present in the original biological samples.</p>\n\n<p>To make it clearer, we will illustrate this with two examples: a “simple” one first and a more advanced one in a second time.</p>\n\n<h2 id=\"filtering-signals-at-given-retention-times\">Filtering signals at given retention times</h2>\n\n<p>When using a chromatography column for MS analysis, you may want to exclude some time ranges where you know the information found there is not of interest.\nFor example, you may want to exclude the dead volume, a calibration zone at the begining or the end, or to exclude a column flush.</p>\n\n<p>In this tutorial, let’s suppose the data are from some LC-QTOF analysis with a dead volume between 0 and 0.4 minutes and a column flush from 16 minutes.\nThen we may want to exclude ions that may be found at theses specific retention time (rt) ranges. \nA quick check at the variableMetadata file reveals that a retention time column is available (“rt”) with values in minutes.\nWe can then use this column to filter the dataset.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Using <b>Generic_filter</b> to filter ions found at specific retention times</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/melpetera/generic_filter/generic_filter/2020.01\" title=\"Generic_Filter tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Generic_Filter</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2020.01)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Data Matrix file”</em>: the <code class=\"language-plaintext highlighter-rouge\">dataMatrix</code> file</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Sample metadata file”</em>: the <code class=\"language-plaintext highlighter-rouge\">sampleMetadata</code> file</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Variable metadata file”</em>: the <code class=\"language-plaintext highlighter-rouge\">variableMetadata</code> file</li>\n        <li><em>“Deleting samples and/or variables according to Numerical values”</em>: <code class=\"language-plaintext highlighter-rouge\">yes</code>\n          <ul>\n            <li>In <em>“Identify the parameter to filter “</em>:\n              <ul>\n                <li><em>“1: Identify the parameter to filter “</em>\n                  <ul>\n                    <li><em>“On file”</em>: <code class=\"language-plaintext highlighter-rouge\">Variable metadata</code></li>\n                    <li><em>“Name of the column to filter”</em>: <code class=\"language-plaintext highlighter-rouge\">rt</code></li>\n                    <li><em>“Interval of values to remove”</em>: <code class=\"language-plaintext highlighter-rouge\">extremity</code>\n                      <ul>\n                        <li><em>“Remove all values lower than”</em>: <code class=\"language-plaintext highlighter-rouge\">0.4</code></li>\n                        <li><em>“And upper than”</em>: <code class=\"language-plaintext highlighter-rouge\">16.0</code></li>\n                      </ul>\n                    </li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n        <li><em>“Deleting samples and/or variables according to Qualitative values”</em>: <code class=\"language-plaintext highlighter-rouge\">no</code></li>\n      </ul>\n\n      <blockquote class=\"tip\">\n        <tip-title>Comment to W4M users</tip-title>\n\n        <p>In the <a href=\"https://workflow4metabolomics.usegalaxy.fr/u/peteram/h/gtnlcmsdataprocessing\">GTN_LCMSprocessing</a> history,\nthis step corresponds to the datasets number 4 to 6.</p>\n      </blockquote>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>The <strong>Generic Filter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> tool generates 3 tables. They correspond to the 3 original tables, \nexcept the content has been filtered according to the specified parameters. \nBy “filtering”, it means removing from the dataset some variables (ions) and/or samples according to the defined filters.</p>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>What have changed between the 3 input tables and the 3 output ones?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <p>The sampleMetadata output is identical to the input one since no filter on samples has been applied.\n The variableMetadata output contains less lines than the input one: some ions has been removed from the table.\nThe same happened with the dataMatrix table, corresponding ions being removed from the file.\nThus, these two files went from 201 lines (header included) to 172 lines, meaning only 171 ions remained in the dataset.</p>\n\n  </blockquote>\n\n</blockquote>\n\n<p>This was a relatively easy task to do. The key point to perform the filter was to know the ranges of rt that needed to be filter,\nsince the information about rt values was already explicitly found in the dataset. \nHowever, sometimes filtering requires more steps to be able to perform the wanted processing.\nThis will be illustrated with the next example.</p>\n\n<h2 id=\"using-blanks-to-filter-noise-signals\">Using blanks to filter noise signals</h2>\n\n<p>As mentioned before, measured signals using mass spectrometry may not always be all of interest.\nSome can be noise, or compounds not characteristic of the analysed biological samples.\nThere are several ways to reduce there impact on gathered data.\nBut one key point is always, as a starting point, to identify the issue.</p>\n\n<p>In the previous example we knew there were retention time ranges of values where signals were not relevant.\nBut they may also be some signals that represent noise, found at no specific retention times. \nSo a question can be “how do we identify these signals?”.</p>\n\n<p>One possible procedure is the use of blanks to estimate the noise, as a reference. \nThe idea is to compare blanks’ intensities with other samples’ intensities.\nIf there is no subtantial difference, we can assume that the concerned signal is noise.</p>\n\n<p>Of course, to be able to do so, you need to inject reference blanks along with your biological samples to get these intensities in your dataMatrix.\nThus, you need to anticipate it when you define your injection sequence. \nIdeally, the blanks to use are extraction blanks, but you can also use injection solvent depending on your protocols.</p>\n\n<p>When blanks are available in your dataset, another thing to consider is “how do I formalise the information needed to be able to filter?”.\nOne common way to compare may be to set a minimum difference between means or medians, or to test for significant difference with a statistical test.\nIn this tutorial, we will choose to calculate a mean fold change between blanks and non-blank samples, and to set a threshold value for filtering.</p>\n\n<p>The mean fold change (“fold”) for each ion can be calculated using the <strong>Intensity Check</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> tool.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Using <b>Intensity Check</b> to generate the information needed to filter</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/melpetera/intensity_checks/intens_check/1.2.8\" title=\"Intensity Check tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Intensity Check</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.2.8)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Data Matrix file”</em>: <code class=\"language-plaintext highlighter-rouge\">GF_dataMatrix</code> (output of the previous <strong>Generic Filter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> job)</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Sample metadata file”</em>: <code class=\"language-plaintext highlighter-rouge\">GF_sampleMetadata</code> (output of the previous <strong>Generic Filter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> job)</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Variable metadata file”</em>: <code class=\"language-plaintext highlighter-rouge\">GF_variableMetadata</code> (output of the previous <strong>Generic Filter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> job)</li>\n        <li><em>“Computation method”</em>: <code class=\"language-plaintext highlighter-rouge\">Between one class and all the remaining samples</code>\n          <ul>\n            <li><em>“Class column”</em>: <code class=\"language-plaintext highlighter-rouge\">c5: sampleType</code></li>\n            <li><em>“Selected class”</em>: <code class=\"language-plaintext highlighter-rouge\">blank</code></li>\n            <li><em>“Calculate the mean fold change”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code>\n              <ul>\n                <li><em>“Where should the class be placed for the mean fold change calculation?”</em>: <code class=\"language-plaintext highlighter-rouge\">Denominator (Bottom)</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n\n      <blockquote class=\"tip\">\n        <tip-title>Comment to W4M users</tip-title>\n\n        <p>In the <a href=\"https://workflow4metabolomics.usegalaxy.fr/u/peteram/h/gtnlcmsdataprocessing\">GTN_LCMSprocessing</a> history,\nthis step corresponds to the datasets number 7 and 8.</p>\n      </blockquote>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>This module generates two outputs: a pdf file for plots (that is not of interest in our example)\nand a table corresponding to the variableMetadata file used as input, completed with new columns depending on the selected parameters. \nIn our case, it generated a column named <em>fold_Other_VS_blank</em> that we will use for filtering.</p>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>What does a value of “4” mean in the <em>fold_Other_VS_blank</em> column?\nRemember that we used as parameter <em>“Selected class”</em>=<code class=\"language-plaintext highlighter-rouge\">blank</code> and\n<em>“Where should the class be placed for the mean fold change calculation?”</em>=<code class=\"language-plaintext highlighter-rouge\">Denominator (Bottom)</code>.</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <p>Since <em>“Selected class”</em>=<code class=\"language-plaintext highlighter-rouge\">blank</code>, the samples are devided in two groups: the blank samples on one hand\nand all the other samples on the other hand. \nTo calculate a mean fold change (<em>i.e.</em> a ratio of means) between the two classes, we need to define which mean will be used as numerator \nand which one will be used as denominator. Since we defined that the selected class should be the denominator, the values we will get are \n(mean of non-blank samples)/(mean of blank samples). \nThus, a value of “4” for a given ion means that the ion has a mean 4-times higher in non-blank samples compared to blank samples.</p>\n\n  </blockquote>\n\n</blockquote>\n\n<p>The <strong>Intensity Check</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> tool generates additional information about your dataset, but do not perform any filter.\nWe can now define a threshold for filtering, and use the <strong>Generic Filter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> tool again to remove noise signal. \nHere we will use a threshold value of “4”. What we want is to remove ions having a fold value lower than 4,\nmeaning that the mean values of biological samples’ intensities for theses ions are not sufficiently high compared to blanks to be considered\nto be resulting from relevant compounds.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Using <b>Generic_filter</b> to filter ions with insuffisant mean contrast with blank samples</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/melpetera/generic_filter/generic_filter/2020.01\" title=\"Generic_Filter tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Generic_Filter</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2020.01)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Data Matrix file”</em>: <code class=\"language-plaintext highlighter-rouge\">GF_dataMatrix</code> (output of the previous <strong>Generic Filter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> job)</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Sample metadata file”</em>: <code class=\"language-plaintext highlighter-rouge\">GF_sampleMetadata</code> (output of the previous <strong>Generic Filter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> job)</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Variable metadata file”</em>: <code class=\"language-plaintext highlighter-rouge\">IC_GF_variableMetadata</code> (output of the previous <strong>Intensity Check</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> job)</li>\n        <li><em>“Deleting samples and/or variables according to Numerical values”</em>: <code class=\"language-plaintext highlighter-rouge\">yes</code>\n          <ul>\n            <li>In <em>“Identify the parameter to filter “</em>:\n              <ul>\n                <li><em>“1: Insert Identify the parameter to filter “</em>\n                  <ul>\n                    <li><em>“On file”</em>: <code class=\"language-plaintext highlighter-rouge\">Variable metadata</code></li>\n                    <li><em>“Name of the column to filter”</em>: <code class=\"language-plaintext highlighter-rouge\">fold_Other_VS_blank</code></li>\n                    <li><em>“Interval of values to remove”</em>: <code class=\"language-plaintext highlighter-rouge\">lower</code>\n                      <ul>\n                        <li><em>“Remove all values lower than”</em>: <code class=\"language-plaintext highlighter-rouge\">4.0</code></li>\n                      </ul>\n                    </li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n        <li><em>“Deleting samples and/or variables according to Qualitative values”</em>: <code class=\"language-plaintext highlighter-rouge\">no</code></li>\n      </ul>\n\n      <blockquote class=\"tip\">\n        <tip-title>Comment to W4M users</tip-title>\n\n        <p>In the <a href=\"https://workflow4metabolomics.usegalaxy.fr/u/peteram/h/gtnlcmsdataprocessing\">GTN_LCMSprocessing</a> history, this step corresponds to the datasets number 9 to 11.</p>\n      </blockquote>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>As for the previous use of <strong>Generic Filter</strong>, we now have a dataset filtered from noise signals.</p>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>What is the current stage of our training dataset?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <p>From a dataset containing originally 200 ions, the two successive filters lead to a dataset containing only 131 ions.\nThe number of samples did not change, so we still have 30 biological samples, 8 QC pools and 6 blanks.</p>\n\n  </blockquote>\n\n</blockquote>\n\n<p>At that point we will not use the blank samples anymore. However, before removing them from the dataset, it is always interesting to \nget an overview of the dataset including blanks.</p>\n\n<h2 id=\"filtered-dataset-overview\">Filtered dataset overview</h2>\n\n<p>The idea here is to have a glance at what the dataset looks like at a macro scale.\nFor this tutorial, we consider that at this step what we have in our dataset are ions only resulting from compounds originally present in the biological samples.\nThus, there are some assumptions we can begin to make, that we can try to check using graphical tools.</p>\n\n<p>Here, we will use a tool that is called <strong>Quality Metrics</strong> to have an overview of our dataset through the generation of a pdf file containing some plots.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Using <b>Quality Metrics</b> to get an overview of the dataset</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ethevenot/qualitymetrics/quality_metrics/2.2.8\" title=\"Quality Metrics tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Quality Metrics</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.2.8)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Data matrix file”</em>: <code class=\"language-plaintext highlighter-rouge\">GF_GF_dataMatrix</code> (output of the last <strong>Generic Filter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> job)</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Sample metadata file”</em>: <code class=\"language-plaintext highlighter-rouge\">GF_GF_sampleMetadata</code> (output of the last <strong>Generic Filter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> job)</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Variable metadata file”</em>: <code class=\"language-plaintext highlighter-rouge\">GF_IC_GF_variableMetadata</code> (output of the last <strong>Generic Filter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> job)</li>\n        <li><em>“Coefficient of Variation”</em>: <code class=\"language-plaintext highlighter-rouge\">no</code></li>\n        <li><em>“Advanced parameters”</em>: <code class=\"language-plaintext highlighter-rouge\">Use default</code></li>\n      </ul>\n\n      <blockquote class=\"tip\">\n        <tip-title>Comment to W4M users</tip-title>\n\n        <p>In the <a href=\"https://workflow4metabolomics.usegalaxy.fr/u/peteram/h/gtnlcmsdataprocessing\">GTN_LCMSprocessing</a> history, this step corresponds to the datasets number 12 to 15.</p>\n      </blockquote>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>This tool generates several outputs (some of them are going to be used in a later use of this module), however for now only the pdf output is of interest.</p>\n\n<figure id=\"figure-2\" style=\"max-width: 90%;\"><img src=\"../../images/lcmsproc_QM.png\" alt=\"Screenshot of the PDF output from Quality Metrics. It is a composition of several distinct plots. In particular there are a PCA plot and a total intensity per sample plot.\" width=\"1302\" height=\"827\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/lcmsproc_QM.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 2</strong>:</span> PDF output from Quality Metrics</figcaption></figure>\n\n<p>On the top left of the picture, we can see the two first components of a Principal Component Analysis (PCA) with the projection of samples on it, colored by sample type.\nWe can see that the main variability in the dataset distinguishes the blank samples (on the left in black) from the other ones (red for pools and green for samples).\nThis is awaited since blanks are supposed to have very low intensities compared to biological samples. \nThis observation is consistant with the top middle plot which represents the sum of intensities for each sample (plotting according to the injection order),\nwhere blank samples have very low values.</p>\n\n<p>This kind of plots is a good way to detect samples that may have abnormally low profiles: \nif a sample is positioned at the same area as the blanks, it is suspicious and a special attention should be given to the concerned sample.</p>\n\n<p>In this tutorial dataset, no atypical sample is observed, so no special attention needs to be paid on specific samples.</p>\n\n<p>Since the blank samples are of no use anymore, we can remove them from the dataset. \nAgain, this can be done running the <strong>Generic Filter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> tool, using the <em>sampleType</em> column of the sampleMetadata table.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Using <b>Generic_filter</b> to remove blank samples from the dataset</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/melpetera/generic_filter/generic_filter/2020.01\" title=\"Generic_Filter tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Generic_Filter</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2020.01)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Data Matrix file”</em>: <code class=\"language-plaintext highlighter-rouge\">GF_GF_dataMatrix</code> (output of the last <strong>Generic Filter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> job)</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Sample metadata file”</em>: <code class=\"language-plaintext highlighter-rouge\">GF_GF_sampleMetadata</code> (output of the last <strong>Generic Filter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> job)</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Variable metadata file”</em>: <code class=\"language-plaintext highlighter-rouge\">GF_IC_GF_variableMetadata</code> (output of the last <strong>Generic Filter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> job)</li>\n        <li><em>“Deleting samples and/or variables according to Numerical values”</em>: <code class=\"language-plaintext highlighter-rouge\">no</code></li>\n        <li><em>“Deleting samples and/or variables according to Qualitative values”</em>: <code class=\"language-plaintext highlighter-rouge\">yes</code>\n          <ul>\n            <li>In <em>“Removing a level in factor”</em>:\n              <ul>\n                <li><em>“1: Insert Removing a level in factor”</em>\n                  <ul>\n                    <li><em>“Name of the column to filter”</em>: <code class=\"language-plaintext highlighter-rouge\">sampleType</code></li>\n                    <li><em>“Remove factor when”</em>: <code class=\"language-plaintext highlighter-rouge\">blank</code></li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n\n      <blockquote class=\"comment\">\n        <comment-title></comment-title>\n\n        <p>The tabular outputs of the previous <strong>Quality Metrics</strong> job are not needed here.\nThis is why what we use as input here are the outputs from the last <strong>Generic Filter</strong> job.</p>\n      </blockquote>\n\n      <blockquote class=\"tip\">\n        <tip-title>Comment to W4M users</tip-title>\n\n        <p>In the <a href=\"https://workflow4metabolomics.usegalaxy.fr/u/peteram/h/gtnlcmsdataprocessing\">GTN_LCMSprocessing</a> history, this step corresponds to the datasets number 16 to 18.</p>\n      </blockquote>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>This step leads to a dataset containing 131 ions and 38 samples (from which 8 pools).</p>\n\n<p>You may have noticed that from module to module, output names tend to become longer and longer.\nTo prevent very long and not-so-informative names due to successive use of modules, we highly recommand to regularly rename the outputs.\nHere, we completed a first row of data processing with the filter of trash signals. Now is a good time for a little renaming.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Rename the last 3 tables</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Rename the tables for their names to be shorter: “RT_blank_Filter_dataMatrix”, “RT_blank_Filter_sampleMetadata”, “RT_blank_Filter_variableMetadata”.</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-renaming-a-dataset-1\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-renaming-a-dataset-1\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Renaming a dataset</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, change the <strong>Name</strong> field</li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>Now we are ready to investigate another type of data processing: correcting intensities.</p>\n\n<h1 id=\"signal-drift-and-batch-effect-correction\">Signal drift and batch effect correction</h1>\n\n<p>Here we will illustrate an example of data processing that is not about filtering, but about correcting. \nIndeed, when it comes to performing statistics comparing biological samples, it is crucial for the intensity values used to be reflecting\nrelevant variability between samples.</p>\n\n<p>In untargeted Metabolomics studies, we manipulate measures that are relative abundancies.\nAlthough we have no unit attached to the intensities, we at least assume that, for a given ion, an intensity value for one sample being higher\nthan the one from another sample means that the compound from which the ion is generated is originally found in higher abundance in the biological sample from\nthe first sample compared to the other. \nThis assumption may seem trivial, but truth is it is not when dealing with LC-MS data.</p>\n\n<p>It is known that when injecting successively a large number of samples, the LC-MS system tends to get dirty. This may cause a measure drift. \nTo prevent inability to catch signal anymore, in case of large injection series, the sequence is generally divided into several batches and the source is cleaned between batches.\nUnfortunately, these signal drift and batch design can add significant variability in the data. \nIt makes sample comparison complicated, since the assumption stated previously about abundance in biological samples may not be true anymore. \nIn case data is impacted by these effects, we need a way to normalise the data to obtain something reliable for statistical analysis.</p>\n\n<h2 id=\"optional-step-checking-batch-effect-on-data\">[Optional step] Checking batch effect on data</h2>\n\n<p>You may have noticed in the <strong>Quality Metrics</strong> output PDF that appart from blanks, samples seemed to be seperated in two groups. \nTruth is it is indeed. However, the best would be to confirm it, in particular by finding out what these groups are linked to.\nHere dices are already rolled, and given the fact that in this section we are adressing signal drift and batch effects, \none could suppose that the groups may have something to do with it.</p>\n\n<p>Let’s confirm it by performing a PCA, with the specificity to colour the sample projections according to the supposed effect: the batch information. \nThis can be done using the <strong>Multivariate</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> tool.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Using <b>Multivariate</b> to get a coloured score plot from a PCA</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ethevenot/multivariate/Multivariate/2.3.10\" title=\"Multivariate tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Multivariate</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.3.10)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Data matrix file”</em>: <code class=\"language-plaintext highlighter-rouge\">RT_blank_Filter_dataMatrix</code> (output of the last <strong>Generic Filter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> job)</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Sample metadata file”</em>: <code class=\"language-plaintext highlighter-rouge\">RT_blank_Filter_sampleMetadata</code> (output of the last <strong>Generic Filter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> job)</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Variable metadata file”</em>: <code class=\"language-plaintext highlighter-rouge\">RT_blank_Filter_variableMetadata</code> (output of the last <strong>Generic Filter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> job)</li>\n        <li><em>“Number of predictive components”</em>: <code class=\"language-plaintext highlighter-rouge\">2</code></li>\n        <li><em>“Advanced graphical parameters”</em>: <code class=\"language-plaintext highlighter-rouge\">Full parameter list</code>\n          <ul>\n            <li><em>“Sample colors”</em>: <code class=\"language-plaintext highlighter-rouge\">batch</code></li>\n            <li><em>“Amount by which plotting text should be magnified relative to the default”</em>: <code class=\"language-plaintext highlighter-rouge\">0.4</code></li>\n          </ul>\n        </li>\n        <li><em>“Advanced computational parameters”</em>: <code class=\"language-plaintext highlighter-rouge\">Use default</code></li>\n      </ul>\n\n      <blockquote class=\"comment\">\n        <comment-title></comment-title>\n\n        <p>Changing the <code class=\"language-plaintext highlighter-rouge\">0.8</code> value to <code class=\"language-plaintext highlighter-rouge\">0.4</code> makes the text size of labels on the score plot smaller. Since the plot box size by default is tiny, this enhances the readability of the plot.</p>\n      </blockquote>\n\n      <blockquote class=\"tip\">\n        <tip-title>Comment to W4M users</tip-title>\n\n        <p>In the <a href=\"https://workflow4metabolomics.usegalaxy.fr/u/peteram/h/gtnlcmsdataprocessing\">GTN_LCMSprocessing</a> history, this step corresponds to the datasets number 19 to 22.</p>\n      </blockquote>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>The output of <strong>Multivariate</strong> we will be interested in here is only the PDF file (Multivariate_figure.pdf). \nAmong the four plots displayed in the file, we can see at the bottom left corner that the first component clearly reveals two distinct groups.\nThese groups perfectly match the batch information we coloured the sample projections with.</p>\n\n<p>This confirms that we indeed have at least a batch effect in the data. \nTo note, this comment is relevant thanks to the fact that supposedly we randomised the injection sequence. \nThis is essential to be able to efficiently separate any analytical effect from known biological variables when searching for effects. \nIf you look at the sampleMetadata file we originally imported, you can notice that the biological group (<em>A</em> and <em>B</em>) are equally found in the two batches,\nwith alternation all through the injection order.</p>\n\n<h2 id=\"performing-the-correction-process\">Performing the correction process</h2>\n\n<p>We previously saw that in data processing issues, it is sometimes crucial to anticipate what needs to be done before defining the injection sequence.\nThis is even more the case when dealing with batch effects and signal drifts.</p>\n\n<p>There is a strategy, described initially by Van Der Kloet in 2009 (<span class=\"citation\"><a href=\"#VdK2009\">van der Kloet FM <i>et al.</i> 2009</a></span>), that has made its way to nowadays procedures (<span class=\"citation\"><a href=\"#Dunn2011\">Dunn <i>et al.</i> 2011</a></span>).\nThe idea is to model the signal drift and the batch effect level by using a reference that can be representative for every ions in the dataset.\nIndeed, signal drift and batch effects can have very different impacts accross ions in a same dataset, so it is crucial to have a reference that is reliable\nfor each ion independantly.</p>\n\n<p>Here the “universal” reference is obtained by using samples that are made by pooling together an extract of every samples in study. \nThus, these Quality-control pooled samples (‘pools’) contain all the compounds that are originally found in the samples, being a reference for a very wide range of ions.\nBy injecting these pools all through the injection sequence of the study samples, we obtain a reference for which the main variability observed is composed of\nthe analytical effects we want to correct, since biologically they are supposed to be identical.</p>\n\n<blockquote class=\"details\">\n  <details-title>More details about the theory</details-title>\n\n  <p>The procedure that is used to correct data in this tutorial is the following.</p>\n\n  <p>For each ion independently, the normalisation process works as described in the following picture:</p>\n\n  <figure id=\"figure-3\" style=\"max-width: 90%;\"><img src=\"../../images/lcms_BC_theo.png\" alt=\"An example plot with the normalisation formula. \" width=\"1144\" height=\"353\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/lcms_BC_theo.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 3</strong>:</span> How this works</figcaption></figure>\n\n  <p>You can see a plot representing 6 sample measures (blue points) in a batch for a given extracted ion. \nThe yellow line represents a model for the signal drift that can be used to normalise the data.\nThis line is determined using the pools only (red squares). \nWith the given formula, we can correct the signal drift.</p>\n\n  <p>This work has to be done for each batch. \nThus, if your sequence is divided into several batches, the idea is to obtain something similar to the following picture:</p>\n\n  <figure id=\"figure-4\" style=\"max-width: 90%;\"><img src=\"../../images/lcms_BC_theo2.png\" alt=\"A before/after plot showing an example of intensities before correction, with clear signal drift and batch effects, and after correction, where the effects have been erased thanks to the correction process. \" width=\"1193\" height=\"694\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/lcms_BC_theo2.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 4</strong>:</span> Before/after picture</figcaption></figure>\n\n</blockquote>\n\n<p>In this tutorial, we have all the information we need to perform the correction:</p>\n<ul>\n  <li>Pools representing the molecule diversity have been injected regularly all through the sequences.</li>\n  <li>They are numerous enough in each batch for the regression to be reliable (well, at least we have enough of them to perform a linear modeling).</li>\n  <li>The dataset contains the mandatory information needed in the sampleMetadata file: the injection order, the batches of analysis and the sample type (pool or sample).</li>\n</ul>\n\n<p>We can then use the <strong>Batch correction</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> tool to perform the correction.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Using <b>Batch correction</b> to correct the data from signal drift and batch effet</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/melpetera/batchcorrection/Batch_correction/3.0.0\" title=\"Batch_correction tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Batch_correction</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 3.0.0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Data Matrix file”</em>: <code class=\"language-plaintext highlighter-rouge\">RT_blank_Filter_dataMatrix</code> (output of the last <strong>Generic Filter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> job)</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Sample metadata file”</em>: <code class=\"language-plaintext highlighter-rouge\">RT_blank_Filter_sampleMetadata</code> (output of the last <strong>Generic Filter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> job)</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Variable metadata file”</em>: <code class=\"language-plaintext highlighter-rouge\">RT_blank_Filter_variableMetadata</code> (output of the last <strong>Generic Filter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> job)</li>\n        <li><em>“Type of regression model “</em>: <code class=\"language-plaintext highlighter-rouge\">linear</code>\n          <ul>\n            <li><em>“Factor of interest “</em>: <code class=\"language-plaintext highlighter-rouge\">Group</code></li>\n            <li><em>“Level of details for plots “</em>: <code class=\"language-plaintext highlighter-rouge\">complete</code></li>\n          </ul>\n        </li>\n      </ul>\n\n      <blockquote class=\"comment\">\n        <comment-title></comment-title>\n\n        <p>The tabular outputs of the previous <strong>Multivariate</strong> job are not needed here.\nThis is why what we use as input here are the outputs from the last <strong>Generic Filter</strong> job.</p>\n      </blockquote>\n\n      <blockquote class=\"tip\">\n        <tip-title>Comment to W4M users</tip-title>\n\n        <p>In the <a href=\"https://workflow4metabolomics.usegalaxy.fr/u/peteram/h/gtnlcmsdataprocessing\">GTN_LCMSprocessing</a> history, this step corresponds to the datasets number 23 to 25.</p>\n      </blockquote>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>The tool generates 3 outputs:</p>\n<ul>\n  <li>a dataMatrix file containing the corrected intensities</li>\n  <li>a variableMetadata file corresponding to the input one completed with additional columns</li>\n  <li>a pdf file with graphics to visualise the impact of the correction process</li>\n</ul>\n\n<p>Depending on the regression model option chosen (linear/lowess/loess/all_loess_pool/all_loess_sample), the output details differ slightly.\nIndeed, the previously described algorithm has been adapted following two strategies: one for the linear/lowess/loess (3L) options,\nanother for the all_loess_pool/all_loess_sample (all_loess) ones.</p>\n\n<p>The main differences between the two strategies are the following:</p>\n<ul>\n  <li>one part allows regression type choice and applies the normalisation depending on internal quality metrics</li>\n  <li>the other part offers the possibility to apply the correction without pool samples. \nFor more information, do not hesitate to read the help section provided with the Galaxy tool.</li>\n</ul>\n\n<p>In this tutorial example, we used the <em>linear</em> option which is part of the 3L strategy.\nWe could not use any of the other options because the other ones would need more pools per batch than what we have here.\nWhen using the 3L strategy, in the PDF file you can have various graphics depending on the <em>Level of details for plots</em> option you choose.\nHere we generated all the plots that are available. This means that the PDF file contains first one page per ion with before/after plots,\nplus 3 additional pages at the end that display overall before/after indicators (sum of intensities, PCA plots, pools’ coefficients of variation).</p>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>Look at the penultimate page of the PDF output (page n°133).\nThis page represents before/after PCA plots with various colouring.\nWe will only focus on the two first lines, in particular looking at the first column.\nThe two corresponding plots represent PCA score plots before (first line) and after (second line) the correction process.\nThe two plots are coloured according to the batch information (B1 and B2).\nWhat can you say about the batch effect after the correction process compared to before?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <p>Compared to the batch effect that was highlighted as the main effect in the data before the correction process,\nwe can see that after correction, the batch effect is no longer explaining the first PCA component.\nThis result is awaited since the reduction of the batch effect is one of the aim of the Batch correction step.</p>\n\n  </blockquote>\n\n</blockquote>\n\n<p>Now that we corrected the data from the signal drift and batch effect, we consider that differences in intensity between samples\ncan be attributed mostly to differences in concentration of original compounds.\nHowever, we know that what we converted to intensity values in our table is initially signal measurements, thus we suspect that\nintensities may be noisy at some point.</p>\n\n<h1 id=\"filtering-signals-of-insufficient-quality\">Filtering signals of insufficient quality</h1>\n\n<p>Similarly to many measuring devices, values that are generated by LC-MS devices are subject to noise.\nIn the specific case of untargeted Metabolomics, the values are relative and can have, in a single dataset, a very large range of scales.\nIt is difficult to quantify the noise, even so it is crucial to have a minimum confidence when searching for subtile differences between groups of individuals.\nThus, having a way to put appart variables (ions) that may be of insufficient quality is key to limit the risk of wrong conclusion while analysing the data.</p>\n\n<p>Beyond the issue of noise, the quality of the variables in one’s dataset is a key question. In particular, in untargeted Metabolomics the data has particularities that\nmake the endpoint analyses complicated, such as the disproportion between sample size and variable number, the complex redundancy and the noise issue already mentioned.\nWhen quality indicators can be computed before any statistical analysis, it is a real advantage: it can improve the efficiency of later statistical analysis and\nalso help to select good candidates in biomarker approaches.</p>\n\n<p>One common and powerful way to assess measurements quality is the use of pools. \nIndeed, now that the data is corrected for signal drift, we expect to have stable intensities within pools since there is no biological variability among them.\nWe can evaluate the remaining variability in pools for each ion, and consider it to be noise and/or analytical effects that we may not have managed to remove for specific ions. \nThis enables the use of quality thresholds to get rid of ions we consider not to be sufficiently reliable regarding intensity values.</p>\n\n<p>In this tutorial, we will illustrate the use of pools by computing coefficients of variation (CV). \nThis metric allows to evaluate the variability accross samples independantly of the unit scale.\nThis advantage enables the definition of a unique threshold value that can be applied to every ions whatever the scales. \nCV are computed for each ion in your dataset, so you can filter ions using the chosen threshold.\nNote: the greater the CV value, the greater the variability.</p>\n\n<p>The first use of CV we will illustrate here is the computation of CVs for the pools only. The idea here is to grasp the pool variability. \nIt is expected that pools do not vary much since they correspond to the same biological content. \nThus, if your pools vary too much, you can suspect that the corresponding ion is not reliable enough.</p>\n\n<p>The second use of CV we will use here is a comparison between pool CVs and sample CVs.\nIndeed, we expect sample CVs to be higher than pool CVs since they share the same noise and analytical variability but also carry biological variability.</p>\n\n<p>The <strong>Quality Metrics</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> tool provides different CV indicators depending on what is in your sample list. \nIn particular, in the present case-study, it computes pool CVs along with a ratio between pool CVs and sample CVs. \nThese two indicators are automatically calculated as long as the input datasets provide the needed information \n(a <em>sampleType</em> column in the sampleMetadata file with the information of <em>pool</em> and <em>sample</em>).\nThus, for these two indicators the tool can be run without specific parameters to set.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Using <b>Quality Metrics</b> to compute the CV indicators</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ethevenot/qualitymetrics/quality_metrics/2.2.8\" title=\"Quality Metrics tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Quality Metrics</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.2.8)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Data matrix file”</em>: <code class=\"language-plaintext highlighter-rouge\">BC_linear_RT_blank_Filter_dataMatrix</code> (output of the <strong>Batch_correction</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> job)</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Sample metadata file”</em>: <code class=\"language-plaintext highlighter-rouge\">RT_blank_Filter_sampleMetadata</code> (output of the last <strong>Generic Filter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> job)</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Variable metadata file”</em>: <code class=\"language-plaintext highlighter-rouge\">BC_linear_RT_blank_Filter_variableMetadata</code> (output of the <strong>Batch_correction</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> job)</li>\n        <li><em>“Coefficient of Variation”</em>: <code class=\"language-plaintext highlighter-rouge\">no</code></li>\n        <li><em>“Advanced parameters”</em>: <code class=\"language-plaintext highlighter-rouge\">Use default</code></li>\n      </ul>\n\n      <blockquote class=\"comment\">\n        <comment-title></comment-title>\n\n        <p>You may have noticed that we already used this tool previously in the tutorial.\nAlthough CV columns were already available at that time, here you need to use this tool again since this time indicators will be computed on intensities\ncorrected from the signal drifts and batch effects. \nNote that what we are going to use this time is the tabular output, but while you are at it you can always check the pdf file if you want.</p>\n      </blockquote>\n\n      <blockquote class=\"tip\">\n        <tip-title>Comment to W4M users</tip-title>\n\n        <p>In the <a href=\"https://workflow4metabolomics.usegalaxy.fr/u/peteram/h/gtnlcmsdataprocessing\">GTN_LCMSprocessing</a> history, this step corresponds to the datasets number 26 to 29.</p>\n      </blockquote>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>The tool provides a variableMetadata tabular output, containing all the computed CV values.\nFor now no filter has been applied on the dataset. To remove the ions of insufficient quality, you will need the <strong>Generic Filter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> tool again.</p>\n\n<p>But first, you need to determine the thresholds you want to use.\nHere we have two indicators we want to use. One is the pool CVs, the other is the ratio between pool CVs and sample CVs.\nThis means that we will need to set two distinct thresholds, and to add two numerical filters in <strong>Generic Filter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Using <b>Generic Filter</b> to filter the dataset</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/melpetera/generic_filter/generic_filter/2020.01\" title=\"Generic_Filter tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Generic_Filter</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2020.01)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Data Matrix file”</em>: <code class=\"language-plaintext highlighter-rouge\">BC_linear_RT_blank_Filter_dataMatrix</code> (output of the <strong>Batch_correction</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> job)</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Sample metadata file”</em>: <code class=\"language-plaintext highlighter-rouge\">QM_RT_blank_Filter_sampleMetadata</code> (output of the last <strong>Quality Metrics</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> job)</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Variable metadata file”</em>: <code class=\"language-plaintext highlighter-rouge\">QM_BC_linear_RT_blank_Filter_variableMetadata</code> (output of the last <strong>Quality Metrics</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> job)</li>\n        <li><em>“Deleting samples and/or variables according to Numerical values”</em>: <code class=\"language-plaintext highlighter-rouge\">yes</code>\n          <ul>\n            <li>In <em>“Identify the parameter to filter “</em>:\n              <ul>\n                <li><em>“1: Insert Identify the parameter to filter “</em>\n                  <ul>\n                    <li><em>“On file”</em>: <code class=\"language-plaintext highlighter-rouge\">Variable metadata</code></li>\n                    <li><em>“Name of the column to filter”</em>: <code class=\"language-plaintext highlighter-rouge\">poolCV_over_sampleCV</code></li>\n                    <li><em>“Interval of values to remove”</em>: <code class=\"language-plaintext highlighter-rouge\">upper</code>\n                      <ul>\n                        <li><em>“Remove all values upper than”</em>: <code class=\"language-plaintext highlighter-rouge\">1.0</code></li>\n                      </ul>\n                    </li>\n                  </ul>\n                </li>\n                <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“2: Insert Identify the parameter to filter “</em>\n                  <ul>\n                    <li><em>“On file”</em>: <code class=\"language-plaintext highlighter-rouge\">Variable metadata</code></li>\n                    <li><em>“Name of the column to filter”</em>: <code class=\"language-plaintext highlighter-rouge\">pool_CV</code></li>\n                    <li><em>“Interval of values to remove”</em>: <code class=\"language-plaintext highlighter-rouge\">upper</code>\n                      <ul>\n                        <li><em>“Remove all values upper than”</em>: <code class=\"language-plaintext highlighter-rouge\">0.3</code></li>\n                      </ul>\n                    </li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n        <li><em>“Deleting samples and/or variables according to Qualitative values”</em>: <code class=\"language-plaintext highlighter-rouge\">yes</code>\n          <ul>\n            <li>In <em>“Removing a level in factor”</em>:\n              <ul>\n                <li><em>“1: Insert Removing a level in factor”</em>\n                  <ul>\n                    <li><em>“Name of the column to filter”</em>: <code class=\"language-plaintext highlighter-rouge\">sampleType</code></li>\n                    <li><em>“Remove factor when”</em>: <code class=\"language-plaintext highlighter-rouge\">pool</code></li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n\n      <blockquote class=\"comment\">\n        <comment-title></comment-title>\n\n        <p>Here, we took the opportunity of this filter to remove the pools from the dataset. \nIndeed, pools will be no longer used in this tutorial’s steps, so we can remove them from the dataset.</p>\n      </blockquote>\n    </li>\n    <li>\n      <p>Rename the output tables for their names to be shorter: “Filtered_dataMatrix”, “Filtered_sampleMetadata”, “Filtered_variableMetadata”.</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-renaming-a-dataset-2\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-renaming-a-dataset-2\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Renaming a dataset</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, change the <strong>Name</strong> field</li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <blockquote class=\"tip\">\n        <tip-title>Comment to W4M users</tip-title>\n\n        <p>In the <a href=\"https://workflow4metabolomics.usegalaxy.fr/u/peteram/h/gtnlcmsdataprocessing\">GTN_LCMSprocessing</a> history, this step corresponds to the datasets number 30 to 32.</p>\n      </blockquote>\n    </li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>What does the <em>0.3</em> threshold mean in the hands-on exercise you just executed?</li>\n    <li>What does the <em>1.0</em> threshold mean in the hands-on exercise you just executed?</li>\n    <li>How many variables are left in your dataset? How many samples?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>The <em>0.3</em> value corresponds to the maximum value kept in the dataset (‘Interval of values to remove: <em>upper</em>’) regarding the\n<em>pool_CV</em> column in your <em>Variable metadata</em> file. \nThus, ions with pool CV values superior to 0.3 are excluded from the dataset.\nTo note, pool CV values are commonly considered as reflecting unstable ions when superior to 0.3.</li>\n      <li>The <em>1.0</em> value corresponds to the maximum value kept in the dataset (‘Interval of values to remove: <em>upper</em>’) regarding the\n<em>poolCV_over_sampleCV</em> column in your <em>Variable metadata</em> file. This means that any ion with a pool CV / sample CV ratio above 1\n(<em>i.e.</em> a pool CV greater than the sample CV) is discarded from the dataset.</li>\n      <li>Filtering led to 102 ions and 30 samples.</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<p>Presented threshold values here are common thresholds in Metabolomics studies. \nPlease note that thresholds should be chosen consistently regarding the LC-MS device caracteristics and the study objectives.\nThus you may need to be more strict in some cases and less strict in others. \nHowever, being less strict than usual should always be appropriately justified.</p>\n\n<h1 id=\"study-specific-data-processing-example-normalising-data-according-to-a-non-analytical-effect\">Study-specific data processing: example normalising data according to a non-analytical effect</h1>\n\n<p>The previous steps presented in this tutorial illustrated categories of data processing that need to be consider whatever the study in \nuntargeted LC-MS Metabolomics projects. In some cases the decision may be not to take actions, but in all cases the issue has to be considered\nto apprehend the reliability of the data for further analyses.</p>\n\n<p>Nonetheless, each study is unique and specific issues can arise that would need some additional data processing steps that are very specific to the study.\nThus, sticking to a standard data processing workflow may not be sufficient in some cases.\nFor example, one commonly considered data processing step in biomarker discovery studies is the reduction of redundancy, \nwhich is a complex question that can be addressed using various strategies depending on the study objectives.</p>\n\n<p>In this section, we will illustrate an example of study-specific data processing that involves a normalisation of the dataset.\nThis will follow the standard <em>Identify-&gt;Formalise-&gt;Handle</em> design that is common to any data processing approach.</p>\n\n<h2 id=\"identifying-unwanted-variability\">Identifying unwanted variability</h2>\n\n<p>First thing is of course to identify an issue in the data that needs to be handled. \nIn the previous steps, this was the “easy” part since we already had knowledge about what needed to be handled.\nWe adressed well-known problems, for which solutions may not always be easy, but at least we know there is something.</p>\n\n<p>In study-specific data processing, it may not be that simple. \nUsually, to see something you need to search for it. This means you have hypotheses prior to the data analysis.\nHowever, sometimes unwanted variability is unexpected, making the search process difficult.</p>\n\n<p>Fortunately, whether you have hypotheses or not, there is a common starting point in Metabolomics that can help you see whether an issue seems to need special attention. \nThis is the use of PCA, that we already saw in previous steps to highlight awaited effects.</p>\n\n<p>In this tutorial, we constructed the dataset so we already know what is the variability to identify.\nIn a real project it can also be the case, or at least we can have hypotheses about effects we would not be supprised to observe.\nIn this tutorial example, we considered samples as being urine samples. \nIt is known that urine samples can vary a lot in total solute concentration, potentially limiting the possibility to detect specific biological effects.\nThus, even if it may not be the case, we can wonder whether the variability of concentration may have a huge effect on the metabolomic dataset we have. \nThis is why, while making a PCA, we may want to plot the first components and see whether the variability displayed seems to match the concentration.</p>\n\n<p>In the sampleMetadata file provided in this tutorial, you can find a column named <em>Osmo</em> that is meant to correspond to measures of osmolality, \none way to represent the overall concentration of urine samples. \nLet’s try to colour the PCA score plots according to that variable. For this, we will use the <strong>Multivariate</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> Galaxy module.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Using <b>Multivariate</b> to visualise the two first components of a PCA</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ethevenot/multivariate/Multivariate/2.3.10\" title=\"Multivariate tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Multivariate</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.3.10)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Data matrix file”</em>: <code class=\"language-plaintext highlighter-rouge\">Filtered_dataMatrix</code> (output of the last <strong>Generic_Filter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> job)</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Sample metadata file”</em>: <code class=\"language-plaintext highlighter-rouge\">Filtered_sampleMetadata</code> (output of the last <strong>Generic_Filter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> job)</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Variable metadata file”</em>: <code class=\"language-plaintext highlighter-rouge\">Filtered_variableMetadata</code> (output of the last <strong>Generic_Filter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> job)</li>\n        <li><em>“Number of predictive components”</em>: <code class=\"language-plaintext highlighter-rouge\">2</code></li>\n        <li><em>“Advanced graphical parameters”</em>: <code class=\"language-plaintext highlighter-rouge\">Full parameter list</code>\n          <ul>\n            <li><em>“Sample colors”</em>: <code class=\"language-plaintext highlighter-rouge\">Osmo</code></li>\n            <li><em>“Amount by which plotting text should be magnified relative to the default”</em>: <code class=\"language-plaintext highlighter-rouge\">0.4</code></li>\n          </ul>\n        </li>\n        <li><em>“Advanced computational parameters”</em>: <code class=\"language-plaintext highlighter-rouge\">Use default</code></li>\n      </ul>\n\n      <blockquote class=\"tip\">\n        <tip-title>Comment to W4M users</tip-title>\n\n        <p>In the <a href=\"https://workflow4metabolomics.usegalaxy.fr/u/peteram/h/gtnlcmsdataprocessing\">GTN_LCMSprocessing</a> history, this step corresponds to the datasets number 33 to 36.</p>\n      </blockquote>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>Among the four output files generated by the tool, the one we are interested in is the <em>Multivariate_figure.pdf</em> file.\nThe PCA scores plot representing the projection of samples on the two first components is located at the bottom left corner:</p>\n\n<figure id=\"figure-5\" style=\"max-width: 90%;\"><img src=\"../../images/lcmsproc_osmo.png\" alt=\"The picture represents the PCA scores plot of components t1 (32% of total variability) and t2 (9% of total variability) with sample labels coloured according to the values from the Osmo column of the sampleMetadata file. We observe a gradation in the colours of samples following the first bisector of the graphic.\" width=\"757\" height=\"727\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/lcmsproc_osmo.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 5</strong>:</span> PCA scores plot</figcaption></figure>\n\n<p>Taking into account that the PCA was computed on Unit-Variance-scaled data (see the <strong>Multivariate</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> tool’s help section for more details),\nthis result confirms the impact of total concentration on our dataset.\nSince this effect in data is independant of the question of interest that we suppose we investigate in the study (in the case of this tutorial), \nwe may want to get rid of this effect to prevent a power reduction in further statistical analysis.</p>\n\n<h2 id=\"formalising-the-information\">Formalising the information</h2>\n\n<p>This step is essential to be able to perform any data processing action. \nAt this step we have already identified some unwanted variability, however to get rid of it we need to formalise the information in a way or another.</p>\n\n<p>As an example, in the <em>Removing “trash” signals</em> section, we acknowledged the fact that the LC-MS device could detect signals even in samples that are not supposed to contain\nrelevant biological compounds. This being identified, this knowledge alone is not sufficient to be able to handle the issue in the dataset.\nThe solution we chose then was to use blank samples to represent the uninformative signals.\nThus, the blank samples’ intensities are the formalisation of the unwanted variability identified.</p>\n\n<p>In this section’s example, the formalisation is already done: we have the <em>Osmo</em> column in our data, that furthermore enabled to identify the unwanted variability.\nThus, we can move to the next step already. However please remember that this part is still mandatory in the process, even if sometimes it is straightforward.</p>\n\n<h2 id=\"getting-rid-of-the-variability\">Getting rid of the variability</h2>\n\n<p>Now that the unwanted variability is identified and formalised, the next step is to apply an adequate procedure to handle it.</p>\n\n<p>Here we have a quantitative effect linked to the <em>Osmo</em> variable.\nThere are plenty of ways to handle this kind of effect, and a proper approach would be first to study the impact of this effect on data in details,\nand then only to choose which data processing approach to use to efficiently correct this effect.</p>\n\n<p>In this tutorial, we assume the <em>Osmo</em> effect is a multiplicative one. \nThis appears to be true in the dataset: the data was built especially for this tutorial so there is no surprise here. \nThen we can use a normalisation approach to handle the question.\nPlease remember that this is a fake dataset used to illustrate the importance and philosophy of data processing for LC-MS untargeted Metabolomics analyses.\nFor proper handling of urine concentration in one’s study, it may require more in-depth procedures depending on the protocole.</p>\n\n<p>The <strong>Normalization</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> Galaxy module enables to perform an adequate correction of this effect.\nThe approach of this module is to apply the normalisation operation to each sample to make the data from all samples directly comparable with each other\n(to take into account variations of the overall concentrations of samples due to biological and technical reasons).\nIt provides different normalisation strategies, some of them particularly of interest for NMR-based metabolomic datasets. \nIn our example, what we are interested in is a normalisation based on the <em>Osmo</em> variable, which is one of the possibilities provided by the module.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Using <b>Normalization</b> to handle the total concentration effect</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/marie-tremblay-metatoul/normalization/normalization/1.0.7\" title=\"Normalization tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Normalization</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.0.7)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Data matrix of preprocessed data”</em>: <code class=\"language-plaintext highlighter-rouge\">Filtered_dataMatrix</code> (output of the last <strong>Generic_Filter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> job)</li>\n        <li><em>“Normalization method”</em>: <code class=\"language-plaintext highlighter-rouge\">Quantitative variable</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Sample metadata matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Filtered_sampleMetadata</code> (output of the last <strong>Generic_Filter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> job)</li>\n            <li><em>“Name of the column of the numerical variable for normalization (weight, osmolality, …)”</em>: <code class=\"language-plaintext highlighter-rouge\">Osmo</code></li>\n          </ul>\n        </li>\n      </ul>\n\n      <blockquote class=\"tip\">\n        <tip-title>Comment to W4M users</tip-title>\n\n        <p>In the <a href=\"https://workflow4metabolomics.usegalaxy.fr/u/peteram/h/gtnlcmsdataprocessing\">GTN_LCMSprocessing</a> history, this step corresponds to the datasets number 37 and 38.</p>\n      </blockquote>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>With the parameter choices made here, the module generates two outputs: a log file and a dataMatrix file.\nThe dataMatrix corresponds to the normalised intensities. This is what will be used in further analyses.</p>\n\n<h2 id=\"checking-the-resulting-data\">Checking the resulting data</h2>\n\n<p>Now that the normalisation process has been applied, one may want to check the effect on data. \nHas the effect been entirely removed from the data? Can we see a significant reduction of it in the data?</p>\n\n<p>Similarly to the checks we could make in the context of signal drift and batch effect correction with before/after plots,\nit is wise to check the impact of any normalisation process on the dataset. \nThis check can be conducted trying to highlight the unwanted effect the same way it was highlighted in the initial step. \nIn our tutorial example we observed the <em>Osmo</em> effect on the two first components of a PCA.\nThus, we can compute a similar PCA using the normalised intensities and see whether the two first components still cary the unwanted variability.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Using <b>Multivariate</b> to visualise the two first components of a PCA</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ethevenot/multivariate/Multivariate/2.3.10\" title=\"Multivariate tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Multivariate</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.3.10)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Data matrix file”</em>: <code class=\"language-plaintext highlighter-rouge\">Normalization_dataMatrix</code> (output of the <strong>Normalization</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> job)</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Sample metadata file”</em>: <code class=\"language-plaintext highlighter-rouge\">Filtered_sampleMetadata</code> (output of the last <strong>Generic_Filter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> job)</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Variable metadata file”</em>: <code class=\"language-plaintext highlighter-rouge\">Filtered_variableMetadata</code> (output of the last <strong>Generic_Filter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> job)</li>\n        <li><em>“Number of predictive components”</em>: <code class=\"language-plaintext highlighter-rouge\">2</code></li>\n        <li><em>“Advanced graphical parameters”</em>: <code class=\"language-plaintext highlighter-rouge\">Full parameter list</code>\n          <ul>\n            <li><em>“Sample colors”</em>: <code class=\"language-plaintext highlighter-rouge\">Osmo</code></li>\n            <li><em>“Amount by which plotting text should be magnified relative to the default”</em>: <code class=\"language-plaintext highlighter-rouge\">0.4</code></li>\n          </ul>\n        </li>\n        <li><em>“Advanced computational parameters”</em>: <code class=\"language-plaintext highlighter-rouge\">Use default</code></li>\n      </ul>\n\n      <blockquote class=\"tip\">\n        <tip-title>Comment to W4M users</tip-title>\n\n        <p>In the <a href=\"https://workflow4metabolomics.usegalaxy.fr/u/peteram/h/gtnlcmsdataprocessing\">GTN_LCMSprocessing</a> history, this step corresponds to the datasets number 39 to 42.</p>\n      </blockquote>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>When looking at the Scores plot available in the PDF output, we can see that the previously observed link between the colouring scale\nand the components’ coordinates is no longer obvious. \nWe can then conclude that the <em>Osmo</em> effect has been notably reduced inside the dataset.</p>\n\n<p>It is even possible to see, on the first component, what seems to be a clear seperation of two groups of samples.\nTheses groups do not correspond to an <em>Osmo</em> effect: we can see that high and low values of <em>Osmo</em> are found in each group with balance.</p>\n\n<p>We could be curious and wonder whether these groups would reflect a biological state.\nIn the sampleMetadata we have, there is a <em>Group</em> column, supposedly representing two biological groups A and B. \nLet’s see how theses groups are projected on the final PCA we have.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Using <b>Multivariate</b> to visualise the two first components of a PCA</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ethevenot/multivariate/Multivariate/2.3.10\" title=\"Multivariate tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Multivariate</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.3.10)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Data matrix file”</em>: <code class=\"language-plaintext highlighter-rouge\">Normalization_dataMatrix</code> (output of the <strong>Normalization</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> job)</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Sample metadata file”</em>: <code class=\"language-plaintext highlighter-rouge\">Filtered_sampleMetadata</code> (output of the last <strong>Generic_Filter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> job)</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Variable metadata file”</em>: <code class=\"language-plaintext highlighter-rouge\">Filtered_variableMetadata</code> (output of the last <strong>Generic_Filter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> job)</li>\n        <li><em>“Number of predictive components”</em>: <code class=\"language-plaintext highlighter-rouge\">2</code></li>\n        <li><em>“Advanced graphical parameters”</em>: <code class=\"language-plaintext highlighter-rouge\">Full parameter list</code>\n          <ul>\n            <li><em>“Sample colors”</em>: <code class=\"language-plaintext highlighter-rouge\">Group</code></li>\n            <li><em>“Amount by which plotting text should be magnified relative to the default”</em>: <code class=\"language-plaintext highlighter-rouge\">0.4</code></li>\n          </ul>\n        </li>\n        <li><em>“Advanced computational parameters”</em>: <code class=\"language-plaintext highlighter-rouge\">Use default</code></li>\n      </ul>\n\n      <blockquote class=\"comment\">\n        <comment-title></comment-title>\n\n        <p>To run this exercice, you can choose to re-run the previous one and simply change the <em>“Sample colors”</em> parameter from <code class=\"language-plaintext highlighter-rouge\">Osmo</code> to<code class=\"language-plaintext highlighter-rouge\">Group</code>.</p>\n      </blockquote>\n\n      <blockquote class=\"tip\">\n        <tip-title>Comment to W4M users</tip-title>\n\n        <p>In the <a href=\"https://workflow4metabolomics.usegalaxy.fr/u/peteram/h/gtnlcmsdataprocessing\">GTN_LCMSprocessing</a> history, this step corresponds to the datasets number 43 to 46.</p>\n      </blockquote>\n    </li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>What major comment can you do when looking at the PCA scores plot obtain from the last hands-on exercise?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <p>We can see that the groups that seemed to be shown on the first PCA component match perfectly the biological categories available in the <em>Group</em>\ncolumn of the sampleMetadata file. \nWe could say that the normalisation process enabled to highlight a distinct effect of the biological groups. \nNote that it is possible that this effect would be already noticeable without the normalisation process,\nhowever the perfect separation on the first component after normalisation is promising to be able to extract \nclear information about the source of this separation.</p>\n\n  </blockquote>\n\n</blockquote>\n\n<p>Now that the dataset seems to be processed adequately, with no identified remaining unwanted main effect \n(the principal effect being the groups of interest for the study), we can consider the data processing of this dataset completed.\nThis does not mean that further data processing steps could not be considered depending on the study objectives,\nbut we reached the end of the example used to illustrate the meaning and importance of untargeted LC-MS metabolomic data processing\nthrough this tutorial.</p>\n\n<h1 id=\"conclusion\">Conclusion</h1>\n\n<p>The question of data filtering and correction must be addressed in all projects, even thought in some cases it may lead to the decision of no action on data. \nIn particular, the removing of “trash” signals, the signal drift and batch effect correction and the filtering of signals of insufficient quality \nare common aspects to consider when dealing with LC-MS data. \nRemember that depending on your context (type of samples, protocol specificities…) specific filters/normalisations may be needed, independently of standards ones. \nOnce you complete your customed processing procedure, your tables are ready for biologically-oriented exploration!</p>\n"],"ref_slides":[],"hands_on":true,"slides":false,"mod_date":"2023-11-03 14:30:27 +0000","pub_date":"2021-12-14 20:39:51 +0000","version":16,"api":"https://training.galaxyproject.org/training-material/api/topics/metabolomics/tutorials/lcms-dataprocessing/tutorial.json","tools":["toolshed.g2.bx.psu.edu/repos/ethevenot/multivariate/Multivariate/2.3.10","toolshed.g2.bx.psu.edu/repos/ethevenot/qualitymetrics/quality_metrics/2.2.8","toolshed.g2.bx.psu.edu/repos/marie-tremblay-metatoul/normalization/normalization/1.0.7","toolshed.g2.bx.psu.edu/repos/melpetera/batchcorrection/Batch_correction/3.0.0","toolshed.g2.bx.psu.edu/repos/melpetera/generic_filter/generic_filter/2020.01","toolshed.g2.bx.psu.edu/repos/melpetera/intensity_checks/intens_check/1.2.8"],"supported_servers":{"exact":[{"url":"https://usegalaxy.fr/","name":"UseGalaxy.fr","usegalaxy":false}],"inexact":[{"url":"https://usegalaxy.cz/","name":"UseGalaxy.cz","usegalaxy":false},{"url":"https://usegalaxy.eu","name":"UseGalaxy.eu","usegalaxy":true},{"url":"https://usegalaxy.no/","name":"UseGalaxy.no","usegalaxy":false}]},"topic_name_human":"Metabolomics","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"multivariate","owner":"ethevenot","revisions":"5526f8258e8a","tool_panel_section_label":"Metabolomics","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"qualitymetrics","owner":"ethevenot","revisions":"acdf51018708","tool_panel_section_label":"Metabolomics","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"normalization","owner":"marie-tremblay-metatoul","revisions":"221cbd549c40","tool_panel_section_label":"Metabolomics","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"batchcorrection","owner":"melpetera","revisions":"23314e1192d4","tool_panel_section_label":"Metabolomics","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"generic_filter","owner":"melpetera","revisions":"cfd7c4aa5c26","tool_panel_section_label":"Metabolomics","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"intensity_checks","owner":"melpetera","revisions":"a31f3f802b2b","tool_panel_section_label":"Metabolomics","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: multivariate\n  owner: ethevenot\n  revisions: 5526f8258e8a\n  tool_panel_section_label: Metabolomics\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: qualitymetrics\n  owner: ethevenot\n  revisions: acdf51018708\n  tool_panel_section_label: Metabolomics\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: normalization\n  owner: marie-tremblay-metatoul\n  revisions: 221cbd549c40\n  tool_panel_section_label: Metabolomics\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: batchcorrection\n  owner: melpetera\n  revisions: 23314e1192d4\n  tool_panel_section_label: Metabolomics\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: generic_filter\n  owner: melpetera\n  revisions: cfd7c4aa5c26\n  tool_panel_section_label: Metabolomics\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: intensity_checks\n  owner: melpetera\n  revisions: a31f3f802b2b\n  tool_panel_section_label: Metabolomics\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":false,"slides_recordings":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial"}