{"layout":"tutorial_hands_on","title":"Mass spectrometry imaging: Finding differential analytes","zenodo_link":"https://zenodo.org/record/2628280","level":"Intermediate","questions":["Can N-linked glycans from FFPE tissues be detected by MALDI imaging?","Can potential N-linked glycans be identified by an additional LC-MS/MS experiment?","Do specific kidney compartments have different N-linked glycan compositions?"],"objectives":["Combining MSI datasets while using the information about each subfile in further steps.","Preprocessing raw MSI data.","Performing supervised and unsupervised statistical analysis."],"time_estimation":"2H","key_points":["Several files can be combined and the spectra used to obtain the annotation of their original file.","Preprocessing reduces the file size and can improve further analysis steps.","Unsupervised and supervised statistical analysis can reveal analytes with different abundances.","The spatial distribution of N-glycans in a tissue section can be measured by MALDI imaging.","Additional LC-MS/MS experiments enable the identification of N-glycans measured by MSI.","Some N-glycans are located to specific kidney compartments."],"requirements":[{"type":"internal","topic_name":"proteomics","tutorials":["mass-spectrometry-imaging-loading-exploring-data"]}],"contributors":[{"name":"Melanie Föll","email":"melanie.foell@mol-med.uni-freiburg.de","twitter":"MCFoell","matrix":"foellmelanie:matrix.org","orcid":"0000-0002-1887-7543","joined":"2018-10","affiliations":["uni-freiburg"],"id":"foellmelanie","url":"https://training.galaxyproject.org/training-material/api/contributors/foellmelanie.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/foellmelanie/"}],"js_requirements":{"mathjax":null,"mermaid":false},"short_id":"T00199","url":"/topics/metabolomics/tutorials/msi-finding-nglycans/tutorial.html","topic_name":"metabolomics","tutorial_name":"msi-finding-nglycans","dir":"topics/metabolomics/tutorials/msi-finding-nglycans","symlink":null,"id":"metabolomics/msi-finding-nglycans","ref_tutorials":["<p>Mass spectrometry imaging (MSI) is applied to measure the spatial distribution of hundreds of biomolecules in a sample. A mass spectrometer scans over the entire sample and collects a mass spectrum every 5-200 µm. This results in thousands of spots (or pixels) for each of which a mass spectrum is acquired. Each mass spectrum consists of hundreds of analytes that are measured by their mass-to-charge (m/z) ratio. For each analyte the peak intensity in the mass spectra of every pixel is known and can be set together to map the spatial distribution of the analyte in the sample.</p>\n\n<p>The technique has a broad range of applications as it is able to measure many different kinds of analytes such as peptides, proteins, metabolites or chemical compounds in a large variety of samples such as cells, tissues and liquid biopsies. Application areas include pharmacokinetic studies, biomarker discovery, molecular pathology, forensic studies, plant research and material sciences. The strength of MSI is the simultaneous analysis of hundreds of analytes in an unbiased, untargeted, label-free, fast and affordable measurement while maintaining morphological information.</p>\n\n<p>Depending on the analyte of interest and the application, different mass spectrometers are used. A mass spectrometer measures the analytes by ionizing, evaporating and sorting them by their mass-to-charge (m/z) ratio. Put simply, a mass spectrometer consists basically of three parts: an ionization source, a mass analyzer and a detector. The most common ionization sources for MSI are MALDI (Matrix Assisted Laser Desorption/Ionization), DESI (Desorption Electrospray Ionization) and SIMS (Secondary Ion Mass Spectrometry).</p>\n\n<figure id=\"figure-1\" style=\"max-width: 90%;\"><img src=\"../../images/msi_distribution_maldi_tof_imaging.png\" alt=\"MSI measurement. \" width=\"1131\" height=\"354\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/msi_distribution_maldi_tof_imaging.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 1</strong>:</span> MALDI TOF imaging of a mouse kidney</figcaption></figure>\n\n<p>One common type of mass spectrometer for MSI is a MALDI Time-Of-Flight (MALDI-TOF) device. During MALDI ionization, a laser is fired onto the sample, which has been covered with a special matrix that absorbs the laser energy and transfers it to the analytes. This process vaporizes and ionizes the analytes. As they are now charged, they can be accelerated in an electric field towards the TOF tube. The time of flight through the tube to the detector is measured, which allows calculation of the mass over charge (m/z) of the analyte, as both mass and charge are correlated with time of flight. During measurement, complete mass spectra with hundreds of m/z - intensity pairs are acquired in thousands of sample plots, leading to large and complex datasets. Each mass spectrum is annotated with coordinates (x,y) that define its location in the sample. This allows visualization of the intensity distribution of each m/z feature in the sample as a heatmap.</p>\n\n<p>Depending on the analyte of interest, the sample type and the mass spectrometer, the sample preparation steps as well as the properties of the acquired data vary. Human tissues are often stained with hematoxylin and hemalaun (H&amp;E) after mass spectrometry imaging. This allows better visualization of tissue histology and can be used to compare the MSI heatmaps with the real morphology. The stained image of the tissue can also be used to define regions of interest that can be extracted from the MSI data and can be subjected to supervised statistical analysis.</p>\n\n<p>As MSI measures only unfractionated molecules (MS1), identification of the resulting m/z features requires matching them to a list of known m/z features. The easiest approach is to match the MSI m/z features to existing databases such as UniProt for proteins or lipidmaps for lipids. More accurate identification is obtained by performing additional mass spectrometry experiments (either on the same or on a similar sample, e.g. adjacent slice from a tissue) that also measure the fragmented molecules (MS2) and thereby also allow accurate identification of isobaric molecules. This tandem mass spectrometry approach can either be done in situ directly on the sample or by transferring the sample to a tube and bringing it into solution for liquid-chromatography tandem mass spectrometry (LC-MS/MS).</p>\n\n<p>In this tutorial we will determine and identify N-linked glycans by differential analysis of a control (untreated) murine kidney section and a section treated with PNGase F. The data analysis steps can be transferred to any other application that requires finding differential analytes, such as for biomarker discovery.</p>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n  <p>In this tutorial, we will cover:</p>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#n-linked-glycans-in-murine-kidney-dataset\" id=\"markdown-toc-n-linked-glycans-in-murine-kidney-dataset\">N-linked glycans in murine kidney dataset</a>    <ol>\n      <li><a href=\"#get-data\" id=\"markdown-toc-get-data\">Get data</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#preparing-the-files-for-statistical-analysis\" id=\"markdown-toc-preparing-the-files-for-statistical-analysis\">Preparing the files for statistical analysis</a>    <ol>\n      <li><a href=\"#combining-control-and-treated1-files\" id=\"markdown-toc-combining-control-and-treated1-files\">Combining control and treated1 files</a></li>\n      <li><a href=\"#exploring-the-combined-file\" id=\"markdown-toc-exploring-the-combined-file\">Exploring the combined file</a></li>\n      <li><a href=\"#preprocessing-of-the-combined-file\" id=\"markdown-toc-preprocessing-of-the-combined-file\">Preprocessing of the combined file</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#statistical-analysis-and-identification-of-n-glycans\" id=\"markdown-toc-statistical-analysis-and-identification-of-n-glycans\">Statistical analysis and identification of N-glycans</a>    <ol>\n      <li><a href=\"#unsupervised-statistical-analysis\" id=\"markdown-toc-unsupervised-statistical-analysis\">Unsupervised statistical analysis</a></li>\n      <li><a href=\"#supervised-statistical-analysis\" id=\"markdown-toc-supervised-statistical-analysis\">Supervised statistical analysis</a></li>\n      <li><a href=\"#identification-of-n-glycans\" id=\"markdown-toc-identification-of-n-glycans\">Identification of N-glycans</a></li>\n      <li><a href=\"#n-linked-glycan-distribution-in-the-complete-dataset\" id=\"markdown-toc-n-linked-glycan-distribution-in-the-complete-dataset\">N-linked glycan distribution in the complete dataset</a></li>\n      <li><a href=\"#n-linked-glycans-with-a-distinct-localization-to-kidney-compartments\" id=\"markdown-toc-n-linked-glycans-with-a-distinct-localization-to-kidney-compartments\">N-linked glycans with a distinct localization to kidney compartments</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#conclusion\" id=\"markdown-toc-conclusion\">Conclusion</a></li>\n</ol>\n\n</blockquote>\n\n<h1 id=\"n-linked-glycans-in-murine-kidney-dataset\">N-linked glycans in murine kidney dataset</h1>\n\n<p>In this tutorial we will use the <a href=\"https://doi.org/10.1016/j.dib.2018.08.186\">murine kidney N-glycan dataset</a> generated in the lab of Peter Hoffmann (Adelaide, Australia). N-linked glycans are carbohydrates (consisting of several sugar molecules) that are attached as a post-translational modification to the carboxamide side chain of an asparagine residue of a protein. Changes in N-linked glycans have been observed in several diseases. The Hoffmann lab acquired the presented dataset to show that their automated sample preparation method for N-glycan MALDI imaging successfully analyses N-glycans from formalin-fixed paraffin-embedded murine kidney tissue (<a href=\"https://doi.org/10.1007/s00216-014-8293-7\">Gustafsson et al.</a>). The datasets generated in this study were made publicly available via the <a href=\"https://www.ebi.ac.uk/pride/archive/projects/PXD009808\">PRIDE Archive</a>.</p>\n\n<p>Three 6 µm sections of formalin-fixed paraffin-embedded murine kidney tissue were prepared for MALDI imaging. To release N-linked glycans from the proteins, PNGase F was printed onto two kidney sections. In the third kidney section, one area was printed with buffer to serve as a control, and another was covered with N-glycan calibrants <a href=\"https://media.springernature.com/original/springer-static/image/art%3A10.1007%2Fs00216-014-8293-7/MediaObjects/216_2014_8293_Fig4_HTML.gif\">Figure 4a-c</a>. 2,5-DHB matrix was sprayed onto the tissue sections and MALDI imaging was performed with 100 µm intervals using a MALDI-TOF/TOF instrument.</p>\n\n<p>To make computation times feasible for this training, we reduced all datasets to a m/z range of 1250 – 2310 and resampled the m/z values with a step size of 0.1. The main part of the training will be performed with the control and one PNGase F treated kidney file, which were both restricted to representative pixels (Figure 2). To test the results on the complete dataset we also provide a file in which all four (m/z reduced and resampled) files (control, calibrants, treated kidney 1 and treated kidney 2) are combined and TIC-normalized. All size-reduced training datasets are available via <a href=\"https://zenodo.org/record/2628280\">Zenodo</a>. We will combine the cropped control and the cropped treated1 file and perform similar steps to those described by <a href=\"https://doi.org/10.1007/s00216-014-8293-7\">Gustafsson et al.</a>. These steps include combining files, preprocessing, unsupervised and supervised analysis, identification of N-glycans and generation of analyte distribution heatmaps.</p>\n\n<figure id=\"figure-2\" style=\"max-width: 90%;\"><img src=\"../../images/msi-diff-abundance-file-dimensions.png\" alt=\"file_dimensions. \" width=\"626\" height=\"752\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/msi-diff-abundance-file-dimensions.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 2</strong>:</span> Top image: All four files after combining them. Black rectangles show the orientation of the cropped control and cropped treated1 files that are used in the major part of the training. Bottom: Cropped training files after combining them.</figcaption></figure>\n\n<h2 id=\"get-data\">Get data</h2>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Data upload</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Create a new history and give it a name.</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-new-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-new-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a new history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>Click the <i class=\"fas fa-plus\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">new-history</span> icon at the top of the history panel:</p>   <p><img src=\"/training-material/shared/images/history_create_new.svg\" alt=\"UI for creating new history\" /></p>   <!-- the original drawing can be found here https://docs.google.com/drawings/d/1cCBrLAo4kDGic5QyB70rRiWJAKTenTU8STsKDaLcVU8/edit?usp=sharing --> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>Import the files from <a href=\"https://zenodo.org/record/2628280\">Zenodo</a>. Upload all three datasets (one by one) to Galaxy via the <strong>composite</strong> option and rename them to ‘control’, ‘treated1’ and ‘all_files’.\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/2628280/files/conrol.imzml\nhttps://zenodo.org/record/2628280/files/control.ibd\nhttps://zenodo.org/record/2628280/files/treated1.imzml\nhttps://zenodo.org/record/2628280/files/treated1.ibd\nhttps://zenodo.org/record/2628280/files/all_files.imzml\nhttps://zenodo.org/record/2628280/files/all_files.ibd\n</code></pre></div>      </div>\n    </li>\n    <li>Paste the link of the tabular file with the N-glycan identities into the regular upload and rename it to ‘Glycan IDs’:\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/2628280/files/Glycan_IDs.tabular\n</code></pre></div>      </div>\n    </li>\n    <li>Create a tabular file with the three glycan calibrants that were used in the study and rename it to ‘calibrants’:\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>M+Na+    composition\n1257.4225    Man5GlcNAc2\n1542.5551    Man3GlcNAc5\n2393.8457    Man3Gal4GlcNAc6\n</code></pre></div>      </div>\n    </li>\n    <li>\n      <p>Add a tag to each imzML file (‘control’, ‘treated1’ and ‘all_files’) and to the tabular file (‘Glycans’):</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-adding-a-tag\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-adding-a-tag\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Adding a tag</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ol>   <li>Click on the dataset to expand it</li>   <li>Click on <strong>Add Tags</strong> <i class=\"fas fa-tags\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-tags</span></li>   <li>Add a tag  starting with <code class=\"language-plaintext highlighter-rouge\">#</code>     <ul>       <li>Tags starting with <code class=\"language-plaintext highlighter-rouge\">#</code> will be automatically propagated to the outputs of tools using this dataset.</li>     </ul>   </li>   <li>Press <kbd>Enter</kbd></li>   <li>Check that the tag appears below the dataset name</li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h1 id=\"preparing-the-files-for-statistical-analysis\">Preparing the files for statistical analysis</h1>\n\n<h2 id=\"combining-control-and-treated1-files\">Combining control and treated1 files</h2>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Combining files</hands-on-title>\n\n  <ol>\n    <li><strong>MSI combine</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“MSI data”</em>: <code class=\"language-plaintext highlighter-rouge\">control</code> (uploaded dataset) and <code class=\"language-plaintext highlighter-rouge\">treated1</code> (uploaded dataset)</li>\n        <li><em>“Output format”</em>: <code class=\"language-plaintext highlighter-rouge\">imzML</code></li>\n      </ul>\n\n      <blockquote class=\"comment\">\n        <comment-title>on the combine tool</comment-title>\n\n        <p>Two combining options are available: ‘Automatic combination’ combines the selected files into a grid with 5 pixel space between them. The order of the files in the history determines their orientation in the combined file and the file name is used to annotate the corresponding pixels. For custom orientation of the files the option ‘shift xy coordinates with a tabular file’ can be applied. For now, the <strong>MSI combine</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> only allows combining files with the same m/z axis. Different m/z axes can be adjusted by filtering for the common m/z range and then binning with the same bin size (<strong>MSI filtering</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> and <strong>MSI preprocessing</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>.</p>\n      </blockquote>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h2 id=\"exploring-the-combined-file\">Exploring the combined file</h2>\n\n<p>To get an overview of the combined dataset we will use the <strong>MSI Qualitycontrol</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>. We will use the annotation file that was generated by the <strong>MSI combine</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> to inform the <strong>MSI Qualitycontrol</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> which spectra belong to which subfile - this will lead to several extra figures where the data properties for both subfiles are plotted separately.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Quality control with spectrum annotations</hands-on-title>\n\n  <ol>\n    <li><strong>MSI Qualitycontrol</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“MSI data”</em>: <code class=\"language-plaintext highlighter-rouge\">combined imzML</code> (output of <strong>MSI combine</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Use pixel annotation from tabular file for QC plots”</em>: <code class=\"language-plaintext highlighter-rouge\">use pixel annotation from a tabular file</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Tabular file with pixel coordinates and annotation”</em>: <code class=\"language-plaintext highlighter-rouge\">combined annotations</code> (output of <strong>MSI combine</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n            <li><em>“Column with x values”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 1</code></li>\n            <li><em>“Column with y values”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 2</code></li>\n            <li><em>“Column with pixel annotations”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 3</code></li>\n            <li><em>“Tabular file contains a header line”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n          </ul>\n        </li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“m/z of interest (e.g. internal Calibrants)”</em>: <code class=\"language-plaintext highlighter-rouge\">calibrants</code> (uploaded dataset)</li>\n        <li><em>“Column with m/z values”</em>: <code class=\"language-plaintext highlighter-rouge\">column:1</code></li>\n        <li><em>“Column with name of m/z values”</em>: <code class=\"language-plaintext highlighter-rouge\">column:2</code></li>\n        <li><em>“Tabular file contains a header line”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        <li><em>“PCA with 2 components”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>How many m/z values does the combined dataset contain?</li>\n    <li>How many spectra does the combined dataset contain?</li>\n    <li>How many input calibrants were valid?</li>\n    <li>Which of the two subfiles shows higher overall intensities?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>10581</li>\n      <li>1935</li>\n      <li>Two calibrants are valid, which means that they lie in the (cropped) m/z range of our files.</li>\n      <li>Several plots show that the treated subfile has higher intensities than the control subfile.</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<p>The quality report gives a broad overview of the properties of both files. The pixel order seems to be random and does not correspond to the measurement in the MALDI. This means that the plots where the ‘spectra index’ is plotted on the x-axis do not represent the acquisition process. While the PNGase F treated kidney file shows higher intensities in several plots (e.g. median intensity per spectrum and intensity boxplots), the number of peaks is similar in both subfiles. The most abundant m/z feature plot of the treated kidney roughly corresponds to the morphology of the kidney while in the control file there are no visible kidney structures. The first principal componant in the PCA analysis roughly differentiates the spectra of the two subfiles which is a good sign for finding differences in the treated vs. control kidney files. For the following preprocessing steps, it is important to know the rough number of data points that one peak consists of. From page 27 on, the average mass spectra of the two glycan calibrants are shown. Due to our harsh resampling to 0.1 m/z, the calibrant 1257.4225 (Man5GlcNAc2) shows quite an angular peak shape. The complete peak consists of about 6 data points, which corresponds to a width of 0.5 m/z. On page 28 the average spectrum for each subfile is plotted, showing a nice peak in the treated subfile and only basal intensity in the control subfile. Page 29 and 30 show the average mass spectra for the 1542.5551 (Man3GlcNAc5) calibrant. The intensities of this calibrant are relatively low and only slightly higher in the treated than in the control subfile. Furthermore, the split up peak shape is not useful for defining the peak width properly.</p>\n\n<h2 id=\"preprocessing-of-the-combined-file\">Preprocessing of the combined file</h2>\n\n<p>Preprocessing of the MSI raw spectra is crucial to reduce experimental (electrical, chemical and mechanical) noise and variance within and between the datasets before statistical analysis. Depending on the ionization technique, the mass analyzer, the sample and the statistical analysis, different preprocessing steps have to be applied. Here, we will perform similar preprocessing steps to those described by <a href=\"https://doi.org/10.1007/s00216-014-8293-7\">Gustafsson et al.</a>.</p>\n\n<ol>\n  <li>\n    <p><strong>Intensity normalization</strong>:\nSignal intensities in MALDI datasets are affected by heterogeneous matrix spray or crystallization, salt and pH gradients and contamination of the ion source over time. Therefore intensity normalization is important to ensure spectra that were acquired at different positions of the sample are comparable. The most common method is the normalization to the total ion current (TIC). This means that each intensity value of a spectrum is divided by the sum of all intensities of the spectrum (equal to the total ion current, TIC). More information on normalization can be found in the publications by <a href=\"https://arxiv.org/pdf/1607.03180.pdf\">Gibb and Strimmer</a> and <a href=\"https://link.springer.com/article/10.1007%2Fs00216-011-4929-z\">Deininger et al.</a>.</p>\n  </li>\n  <li>\n    <p><strong>Spectra smoothing</strong>:\nSmoothing reduces noise in the spectra and thereby improves peak picking. Smoothing is an optional preprocessing step, especially for high resolution data. The critical parameter for smoothing is the window size. Larger window sizes lead to stronger smoothing, which not only reduces noise but also the intensities of real peaks. Therefore it is important to set the window size large enough to remove noise but small enough to preserve the peaks. We will use the ‘gaussian’ smoothing method that applies a weighted moving average filter and set the window size to 4 (resampling was done with 0.1, multiplied by 4 this gives a 0.4 m/z window which is slightly smaller than the complete peak width that we found to be roughly 0.5 m/z). The standard deviation is set to the default setting: window/4 = 1. As the smoothing changes the peak width, we will quickly examine the 1257.42 calibrant peak width afterwards and use the information to define the correct window sizes in further preprocessing steps.</p>\n  </li>\n  <li>\n    <p><strong>Baseline removal</strong>:\nEspecially for MALDI datasets it is common to perform a baseline subtraction to remove the background intensity that is generated by chemical noise. Baseline removal could also be performed before smoothing but as smoothing might slightly increase the baseline we perform the baseline removal afterwards. Similar to the smoothing step, the window size in which the noise is estimated is crucial. The window should be large enough to obtain a representative number of data points but small enough to avoid removing parts of the peaks as well. Here, the window is obtained by dividing the m/z range by the number of blocks. Recommended window sizes range from 1 - 5 m/z. We will divide the m/z axis into 500 blocks, giving a window size of about 2 m/z.</p>\n  </li>\n</ol>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Preprocessing part I</hands-on-title>\n\n  <ol>\n    <li><strong>MSI preprocessing</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“MSI data”</em>: <code class=\"language-plaintext highlighter-rouge\">combined imzML</code> (output of <strong>MSI combine</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li>In <em>“Preprocessing”</em>:\n          <ul>\n            <li>Click on <em>“Insert Preprocessing”</em>:</li>\n            <li>In <em>“1: Preprocessing”</em>:\n              <ul>\n                <li><em>“Preprocessing methods”</em>: <code class=\"language-plaintext highlighter-rouge\">Intensity Normalization (TIC)</code></li>\n              </ul>\n            </li>\n            <li>Click on <em>“Insert Preprocessing”</em>:</li>\n            <li>In <em>“2: Preprocessing”</em>:\n              <ul>\n                <li><em>“Preprocessing methods”</em>: <code class=\"language-plaintext highlighter-rouge\">Peak smoothing</code>\n                  <ul>\n                    <li><em>“Smoothing method”</em>: <code class=\"language-plaintext highlighter-rouge\">gaussian</code>\n                      <ul>\n                        <li><em>“The standard deviation for the Gaussian kernel (window/sd)”</em>: <code class=\"language-plaintext highlighter-rouge\">1</code></li>\n                      </ul>\n                    </li>\n                    <li><em>“Window size”</em>: <code class=\"language-plaintext highlighter-rouge\">4.0</code></li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n            <li>In <em>“3: Preprocessing”</em>:\n              <ul>\n                <li><em>“Preprocessing methods”</em>: <code class=\"language-plaintext highlighter-rouge\">Baseline Reduction</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n        <li><em>“Output format”</em>: <code class=\"language-plaintext highlighter-rouge\">imzML</code></li>\n      </ul>\n    </li>\n    <li><strong>MSI plot spectra</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“MSI data”</em>: <code class=\"language-plaintext highlighter-rouge\">processed imzML</code> (output of <strong>MSI preprocessing</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Select if you want to plot the mass spectrum of a single pixel or the average spectrum of all pixels of a sample”</em>: <code class=\"language-plaintext highlighter-rouge\">Average spectrum for each sample</code>\n          <ul>\n            <li><em>“Use pixel annotation from tabular file for spectra plots”</em>: <code class=\"language-plaintext highlighter-rouge\">group pixels according to annotations</code></li>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Tabular file with pixel coordinates and annotation”</em>: <code class=\"language-plaintext highlighter-rouge\">combined annotations</code> (output of <strong>MSI combine</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n            <li><em>“Column with x values”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 1</code></li>\n            <li><em>“Column with y values”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 2</code></li>\n            <li><em>“Column with pixel annotations”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 3</code></li>\n            <li><em>“Tabular file contains a header line”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n            <li>In <em>“Zoomed in plots with m/z min and m/z max to define the plot window”</em>:\n              <ul>\n                <li>Click on <em>“Insert Zoomed in plots with m/z min and m/z max to define the plot window”</em>:</li>\n                <li>In <em>“1: Zoomed in plots with m/z min and m/z max to define the plot window”</em>:\n                  <ul>\n                    <li><em>“lower m/z boundary for plotting window”</em>: <code class=\"language-plaintext highlighter-rouge\">1257</code></li>\n                    <li><em>“upper m/z boundary for plotting window”</em>: <code class=\"language-plaintext highlighter-rouge\">1259</code></li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>The QC report of the <strong>MSI preprocessing</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> shows the changes during preprocessing for four random spectra. TIC normalization only changes the dimension of the y-axis. Smoothing decreases the peak height and thus the intensity values on the y-axis shrink as well. Baseline removal shifts the complete spectrum towards the bottom.</p>\n\n<p>The <strong>MSI plot spectra</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> is a quick way to control peak shape after smoothing. The zoomed in spectrum of the 1257.42 calibrant peaks shows that the peaks become broader than before. Most of the underlying data points can be seen as angles of the peak. The peak width ranges from 1257.1 to 1257.9 m/z = 0.8 m/z width. We will set the following window sizes to 9 data points (half the window size of 4).</p>\n\n<p>We can then continue with the second part of the preprocessing:</p>\n\n<ol>\n  <li>\n    <p><strong>m/z alignment</strong>:\nDespite regular m/z calibration of the mass spectrometer, m/z values vary slightly during data acquisition. To make m/z features comparable between different spectra or samples, they need to have the same m/z value. Furthermore, if identification is desired the m/z values should also be as accurate as possible. For high resolution data, binning of the m/z axis is often sufficient to group similar m/z values to a common m/z bin. For TOF instruments, re-calibration of the m/z values is commonly applied with the help of known, ubiquitous analytes such as internal calibrants or matrix peaks. Unfortunately, no internal calibrants were applied and the DHB matrix peaks occur more frequently below 1000 m/z. Therefore, the m/z values are not re-calibrated with known analytes but instead aligned to the average picked mass spectrum to ensure that similar m/z features obtain the same m/z value. This common m/z value can still be slightly shifted from its correct position - this should be kept in mind for the identification step that we will perform later. m/z alignment or binning could also be done after peak picking, but as we will perform peak picking on the average spectrum it is important that the m/z shifts are already minimized. We will remove spectra in which less than 2 reference m/z were found by setting them to zero and then removing all empty spectra. To account for the m/z shifts we will export the processed imzML file, which means that each spectrum has its own m/z axis.</p>\n  </li>\n  <li>\n    <p><strong>Peak picking and binning</strong>:\nThe key step during preprocessing is peak detection as it reduces the dimensionality of the data and bases the following statistical analysis on potentially relevant peaks rather than on noise. A peak is a local maximum above a user-defined noise threshold. The higher the signal-to-noise ratio is set, the more true positive peaks are picked, but at the cost of lowered sensitivity. Therefore, we will set the signal-to-noise ratio to 5, which should remove most of the noise while keeping enough sensitivity. The window should ideally have about the size of the peak width (recalling we set half window size to 4). We will perform peak picking and monoisotopic picking on the average mass spectra of each subfile, which are again defined with the annotation tabular file. The removal of isotopic peaks reduces the number of m/z features of the dataset, which is not only beneficial for computation time but also for many statistical approaches that are hindered by highly correlating variables. To ensure comparability of the picked m/z features, binning of the m/z axis is performed.</p>\n  </li>\n  <li>\n    <p><strong>Extracting peaks</strong>:\nThe average peak picking has removed all spatial information and kept only mean intensity values for the two subfiles. Therefore, the ‘peaks’ function is used to retrieve the picked peaks from all pixels of the normalized, smoothed and baseline reduced dataset.</p>\n  </li>\n</ol>\n\n<p>For further reading on preprocessing we recommend <a href=\"https://arxiv.org/pdf/1607.03180.pdf\">Gibb and Strimmer</a> and <a href=\"https://doi.org/10.1016/j.ijms.2006.10.005\">Norris et al.</a>.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Preprocessing part II</hands-on-title>\n\n  <ol>\n    <li><strong>MALDIquant preprocessing</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“MSI data”</em>: <code class=\"language-plaintext highlighter-rouge\">preprocessed imzML</code> (output of <strong>MSI preprocessing</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li>In <em>“Method”</em>:\n          <ul>\n            <li>In <em>“1: Method”</em>:\n              <ul>\n                <li><em>“Select a method”</em>: <code class=\"language-plaintext highlighter-rouge\">Align spectra</code>\n                  <ul>\n                    <li><em>“Tolerance”</em>: <code class=\"language-plaintext highlighter-rouge\">0.0002</code></li>\n                    <li><em>“Half window size”</em>: <code class=\"language-plaintext highlighter-rouge\">4</code></li>\n                    <li><em>“Signal-to-noise-ratio”</em>: <code class=\"language-plaintext highlighter-rouge\">3</code></li>\n                    <li><em>“Allow no matches”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n                    <li><em>“Empty no matches”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n                    <li><em>“Remove empty spectra”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n                    <li><em>“minFrequency”</em>: <code class=\"language-plaintext highlighter-rouge\">0.8</code></li>\n                    <li><em>“Export processed imzML”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li><strong>MALDIquant peak detection</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“MSI data”</em>: <code class=\"language-plaintext highlighter-rouge\">MALDIquant preprocessing imzML</code> (output of <strong>MALDIquant preprocessing</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Spectra annotations”</em>: <code class=\"language-plaintext highlighter-rouge\">yes</code>\n          <ul>\n            <li><em>“Use annotations from tabular file”</em>: <code class=\"language-plaintext highlighter-rouge\">combined annotations</code> (output of <strong>MSI combine</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n            <li><em>“Column with x values”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 1</code></li>\n            <li><em>“Column with y values”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 2</code></li>\n            <li><em>“Column with pixel annotations”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 3</code></li>\n            <li><em>“File contains a header line”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n          </ul>\n        </li>\n        <li>In <em>“Method”</em>:\n          <ul>\n            <li>In <em>“1: Method”</em>:\n              <ul>\n                <li><em>“Select a method”</em>: <code class=\"language-plaintext highlighter-rouge\">Peak detection</code>\n                  <ul>\n                    <li><em>“Half window size”</em>: <code class=\"language-plaintext highlighter-rouge\">4</code></li>\n                    <li><em>“Signal to noise”</em>: <code class=\"language-plaintext highlighter-rouge\">5</code></li>\n                    <li><em>“Detect peaks on average mass spectra”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n            <li>Click on <em>“Insert Method”</em>:</li>\n            <li>In <em>“2: Method”</em>:\n              <ul>\n                <li><em>“Select a method”</em>: <code class=\"language-plaintext highlighter-rouge\">Monoisotopic peaks</code>\n                  <ul>\n                    <li><em>“Minimal correlation”</em>: <code class=\"language-plaintext highlighter-rouge\">0.4</code></li>\n                    <li><em>“Tolerance”</em>: <code class=\"language-plaintext highlighter-rouge\">0.0002</code></li>\n                    <li><em>“Size”</em>: <code class=\"language-plaintext highlighter-rouge\">2:5</code></li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n            <li>Click on <em>“Insert Method”</em>:</li>\n            <li>In <em>“3: Method”</em>:\n              <ul>\n                <li><em>“Select a method”</em>: <code class=\"language-plaintext highlighter-rouge\">Binning</code>\n                  <ul>\n                    <li><em>“Tolerance”</em>: <code class=\"language-plaintext highlighter-rouge\">0.0002</code></li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li><strong>MSI preprocessing</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“MSI data”</em>: <code class=\"language-plaintext highlighter-rouge\">preprocessed imzML from first step</code> (output of <strong>MSI preprocessing</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li>In <em>“Preprocessing”</em>:\n          <ul>\n            <li>Click on <em>“Insert Preprocessing”</em>:</li>\n            <li>In <em>“1: Preprocessing”</em>:\n              <ul>\n                <li><em>“Preprocessing methods”</em>: <code class=\"language-plaintext highlighter-rouge\">Data reduction</code>\n                  <ul>\n                    <li><em>“Reduction method”</em>: <code class=\"language-plaintext highlighter-rouge\">peaks</code></li>\n                    <li><em>“Tabular file with m/z features to extract from input file”</em>: <code class=\"language-plaintext highlighter-rouge\">MALDIquant peak detection intensity matrix</code> (output of <strong>MALDIquant peak detection</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n                    <li><em>“Tabular file contains a header line”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n        <li><em>“Output format”</em>: <code class=\"language-plaintext highlighter-rouge\">imzML</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>How many m/z values are left after preprocessing?</li>\n    <li>What is the lowest m/z feature that is left after preprocessing?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>125 m/z features are left</li>\n      <li>1257.47 (min m/z)</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<blockquote class=\"details\">\n  <details-title>How to find good preprocessing parameters</details-title>\n  <p>Before starting with preprocessing it is important to know the properties of the data. Internal calibrants can help to estimate the quality of the data and to control the preprocessing steps. The <strong>MSI Qualitycontrol</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> shows the extent of a noise baseline, the level of noise in the mass spectra, intensity distributions and m/z accuracy as described in the (<a href=\"/training-material/topics/proteomics/tutorials/mass-spectrometry-imaging-loading-exploring-data/tutorial.html\">Mass spectrometry imaging: Loading and exploring MSI data</a>) tutorial. Most preprocessing steps are applied to single spectra and therefore allow optimization of the preprocessing steps on a small subset of the original dataset that can be obtained with the <strong>MSI filtering</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>. To make sure that the preprocessing steps and parameters are chosen properly it is recommended to perform them step by step and check the outcome after every step. The <strong>MSI Qualitycontrol</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>, the <strong>MSI spectra plot</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>, and the <strong>MSI mz images</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> are helpful to track the changes during preprocessing. The first two tools are able to overlay MSI data with different annotations, making it possible to combine files before and after the preprocessing step, as done in step 1 and 2 of this tutorial, and compare the introduced changes directly. The usage of annotations in the <strong>MSI spectra plot</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> is explained in the tutorial <a href=\"/training-material/topics/metabolomics/tutorials/msi-analyte-distribution/tutorial.html\">Mass spectrometry imaging: Examining the spatial distribution of analytes</a>.</p>\n</blockquote>\n\n<p>The QC table of the <strong>MALDIquant preprocessing</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> reveals that 19 spectra (pixel) were removed during the alignment. The empty spectra are visible in the QC file of <strong>MALDIquant peak detection</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>. This QC furthermore shows the baseline in blue and the picked (monoisotopic) peaks in green. After peak extraction the mass spectra are not in profile mode anymore (one peak consists of many datapoints) but centroided (one peak is represented by one datapoint). Therefore, in further steps ‘centroided input’ must be set to ‘Yes’.</p>\n\n<h1 id=\"statistical-analysis-and-identification-of-n-glycans\">Statistical analysis and identification of N-glycans</h1>\n\n<h2 id=\"unsupervised-statistical-analysis\">Unsupervised statistical analysis</h2>\n\n<p>Unsupervised analysis can be applied at any time to any dataset because no prior knowledge of the data is required. The clustering or segmentation algorithms (that perform unsupervised analysis) separate regions of the data that have the most distinct differences in their mass spectra. We will perform principal component analysis (PCA) with 4 clusters to visualize the largest differences in the dataset.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Segmentation with PCA</hands-on-title>\n\n  <ol>\n    <li><strong>MSI segmentation</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“MSI data”</em>: <code class=\"language-plaintext highlighter-rouge\">preprocessed imzML (peaks)</code> (output of <strong>MSI preprocessing</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Centroided input”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        <li><em>“Select the tool for spatial clustering”</em>: <code class=\"language-plaintext highlighter-rouge\">pca</code>\n          <ul>\n            <li><em>“The number of principal components to calculate”</em>: <code class=\"language-plaintext highlighter-rouge\">4</code></li>\n          </ul>\n        </li>\n        <li>In <em>“Colours for the plots”</em>:\n          <ul>\n            <li>Click on <em>“Insert Colours for the plots”</em>:</li>\n            <li>In <em>“1: Colours for the plots”</em>:\n              <ul>\n                <li><em>“Colours”</em>: <code class=\"language-plaintext highlighter-rouge\">dark_blue</code></li>\n              </ul>\n            </li>\n            <li>Click on <em>“Insert Colours for the plots”</em>:</li>\n            <li>In <em>“2: Colours for the plots”</em>:\n              <ul>\n                <li><em>“Colours”</em>: <code class=\"language-plaintext highlighter-rouge\">orange</code></li>\n              </ul>\n            </li>\n            <li>Click on <em>“Insert Colours for the plots”</em>:</li>\n            <li>In <em>“3: Colours for the plots”</em>:\n              <ul>\n                <li><em>“Colours”</em>: <code class=\"language-plaintext highlighter-rouge\">green</code></li>\n              </ul>\n            </li>\n            <li>Click on <em>“Insert Colours for the plots”</em>:</li>\n            <li>In <em>“4: Colours for the plots”</em>:\n              <ul>\n                <li><em>“Colours”</em>: <code class=\"language-plaintext highlighter-rouge\">red</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>Which principal components correlate with the morphology of the kidney?</li>\n    <li>What are the approximate m/z values with the highest loadings for each of those principal components?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>PC1, PC3 and PC4</li>\n      <li>PC1: 1900; PC3: 1900; PC4: 2300 (from PCA plot)</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<figure id=\"figure-3\" style=\"max-width: 90%;\"><img src=\"../../images/msi-diff-abundance-pca.png\" alt=\"PCA. \" width=\"858\" height=\"808\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/msi-diff-abundance-pca.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 3</strong>:</span> Distribution of the principal components</figcaption></figure>\n\n<p>The PCA clustering reveals that the N-glycan profile is different in different kidney compartments. To find the m/z features that correspond to these compartments, the feature tabular file can further be analyzed by sorting the file for the principal components of interest. This reveals the discrete m/z values for the features with the highest loadings: PC1 and PC3: 1905.72, PC4: 2304.91. Later, we will visualize the morphological distribution of those features on the complete dataset.</p>\n\n<h2 id=\"supervised-statistical-analysis\">Supervised statistical analysis</h2>\n\n<p>Supervised analysis can only be performed if the regions of interest that should be compared are known. For this dataset we know which spectra were treated or not treated with PNGase F. With this information we can use the spatial shrunken centroids algorithm, which in addition to classification is able to find the m/z features that best distinguish each class (<a href=\"https://doi.org/10.1074/mcp.O115.053918\">Bemis et al.</a>). We expect those discriminating m/z features to be the N-linked glycans that were only released in the treated kidney section but not in the control section.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Spatial shrunken centroids classification</hands-on-title>\n\n  <ol>\n    <li><strong>MSI classification</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“MSI data”</em>: <code class=\"language-plaintext highlighter-rouge\">preprocessed imzML (peaks)</code> (output of <strong>MSI preprocessing</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Centroided input”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        <li><em>“Analysis step to perform”</em>: <code class=\"language-plaintext highlighter-rouge\">training</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Load tabular file with pixel coordinates and their classes”</em>: <code class=\"language-plaintext highlighter-rouge\">combined annotations</code> (output of <strong>MSI combine</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n            <li><em>“Column with x values”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 1</code></li>\n            <li><em>“Column with y values”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 2</code></li>\n            <li><em>“Column with response (condition) values”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 3</code></li>\n            <li><em>“Tabular files contain a header line”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n            <li><em>“Select the method for classification”</em>: <code class=\"language-plaintext highlighter-rouge\">spatial shrunken centroids</code>\n              <ul>\n                <li><em>“Analysis step to perform”</em>: <code class=\"language-plaintext highlighter-rouge\">spatial shrunken centroids analysis</code></li>\n                <li><em>“The sparsity thresholding parameter by which to shrink the t-statistics (s)”</em>: <code class=\"language-plaintext highlighter-rouge\">0</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<figure id=\"figure-4\" style=\"max-width: 90%;\"><img src=\"../../images/msi-diff-abundance-classification.png\" alt=\"SSC. \" width=\"1186\" height=\"1020\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/msi-diff-abundance-classification.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 4</strong>:</span> T-statistics plot for the classification and distribution of the most discriminating m/z feature and class prediction for all spectra.</figcaption></figure>\n\n<p>High accuracy, sensitivity and specificity indicate that the control and PNGase F treated kidney sections can be discriminated quite well. The prediction shows the location of the few misclassified spectra towards the border of the tissue. As our aim is not to build and test a classifier for accurate prediction, we move on to investigate the m/z features that were most discriminative for the two groups more deeply. Looking at the feature tabular file, we spot the 2 m/z features that had the highest loadings in the PCA, amongst the top features with the highest t-statistics. Furthermore, this list can be compared to the m/z features that were determined as potential N-linked glycans in <a href=\"https://static-content.springer.com/esm/art%3A10.1007%2Fs00216-014-8293-7/MediaObjects/216_2014_8293_MOESM1_ESM.pdf\">Gustafsson et al. Figure S6</a>. We found nine out of twelve m/z features. Two m/z features were outside our cropped m/z range and could therefore not be found. The 1079.408 m/z feature is missing in our feature list.</p>\n\n<h2 id=\"identification-of-n-glycans\">Identification of N-glycans</h2>\n\n<p>We filter the m/z feature output from the <strong>MSI classification</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> for an adjusted p-value below 0.05 and a positive t-statistic in the ‘treated1’ spectra to consider only the most discriminative features that are more abundant in the treated than in the control spectra. Those m/z features are potentially N-glycans that were released by PNGase F treatment from the kidney section but not from the control section. To verify that the m/z features are N-linked glycans and to elucidate their identity and structure <a href=\"https://doi.org/10.1007/s00216-014-8293-7\">Gustafsson et al.</a> performed an additional LC-MS/MS experiment on N-linked glycans released from another mouse kidney section. They identified <a href=\"https://media.springernature.com/original/springer-static/image/art%3A10.1007%2Fs00216-014-8293-7/MediaObjects/216_2014_8293_Fig3_HTML.gif\">31 N-linked glycans</a> and calculated the m/z for the sodium N-glycan ions which can be matched to the imaging m/z features. Protonated glycans do not ionize well, but sodium adducts are the best detected glycan form in positive mode mass spectrometry. We match the differential m/z features from the imaging experiment to the m/z features from the LC-MS/MS results with a tolerance of 300 ppm and keep all matches that occur within this distance. We then calculate the average ppm error for the matches.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Identification of N-glycans</hands-on-title>\n\n  <ol>\n    <li><strong>Filter data on any column using simple expressions</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Filter”</em>: <code class=\"language-plaintext highlighter-rouge\">classification features</code> (output of <strong>MSI classification</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“With following condition”</em>: <code class=\"language-plaintext highlighter-rouge\">c5==\"treated1\" and c7&gt;0 and c9&lt;0.05</code></li>\n        <li><em>“Number of header lines to skip”</em>: <code class=\"language-plaintext highlighter-rouge\">1</code></li>\n      </ul>\n    </li>\n    <li><strong>Join two files on column allowing a small difference</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“1st file”</em>: <code class=\"language-plaintext highlighter-rouge\">Filter data</code> (output of <strong>Filter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Column to use from 1st file”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 1</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“2nd file”</em>: <code class=\"language-plaintext highlighter-rouge\">Glycan IDs</code> (uploaded dataset)</li>\n        <li><em>“Column to use from 2nd file”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 1</code></li>\n        <li><em>“Does the input files contain a header line”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        <li><em>“Add an addional column with the calculated distance.”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        <li><em>“Choose the mode of merging.”</em>: <code class=\"language-plaintext highlighter-rouge\">All matches within the defined distance</code></li>\n        <li><em>“Choose the metrics of your distance”</em>: <code class=\"language-plaintext highlighter-rouge\">Distance in ppm</code></li>\n        <li><em>“Allowed distance between the two values that will trigger a merge”</em>: <code class=\"language-plaintext highlighter-rouge\">300.0</code></li>\n      </ul>\n    </li>\n    <li><strong>Summary Statistics for any numerical column</strong>  <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Summary statistics on”</em>: <code class=\"language-plaintext highlighter-rouge\">Join two files</code> (output of <strong>Join two files</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Column or expression”</em>: <code class=\"language-plaintext highlighter-rouge\">c12</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>How many m/z features are filtered by our criteria?</li>\n    <li>How many m/z features could be identified?</li>\n    <li>How many duplicated matches occured?</li>\n    <li>What was the average m/z error for the matching?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>The filtered file has 32 lines minus one header line, i.e. 31 m/z features.</li>\n      <li>19 m/z features were identified.</li>\n      <li>0</li>\n      <li>28.98 ppm</li>\n    </ol>\n  </blockquote>\n\n</blockquote>\n\n<p>31 m/z features of the imaging dataset have a p-value below 0.05 and are potentially N-linked glycans. To ensure the identity of those features, they were matched to the results of an additional LC-MS/MS experiment. This step allows us to identify 19 m/z features as N-linked glycans. 15 of those m/z features were also found and identified in the <a href=\"https://doi.org/10.1007/s00216-014-8293-7\">original publication</a>, which means that we found 4 additional N-glycans: 1704.7, 1542.6, 2101.8 and 1955.7. Those are the 4 m/z features with the lowest t-statistic. One hint to their validity is their m/z error. The m/z errors of 5, 24, 32 and 64 ppm seem reasonable. The average m/z error was 28.98 ppm compared to 38.7 ppm in the original publication. Without resampling of the m/z axis (which was mainly done to speed up computation time) or with additional internal calibrants for m/z re-calibration this error would probably further decrease.\nNext, we visually explore the abundance distribution for all identified N-glycans in the complete, TIC-normalized dataset (consisting of the subfiles: control, calibrant, treated1 and treated2).</p>\n\n<h2 id=\"n-linked-glycan-distribution-in-the-complete-dataset\">N-linked glycan distribution in the complete dataset</h2>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Distribution images for the identified N-glycans</hands-on-title>\n\n  <ol>\n    <li><strong>MSI mz images</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“MSI data”</em>: <code class=\"language-plaintext highlighter-rouge\">all_files</code> (uploaded dataset)</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“m/z of interest”</em>: <code class=\"language-plaintext highlighter-rouge\">Join two files</code> (output of <strong>Join two files</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Column with m/z values”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 1</code></li>\n        <li><em>“Column with name of m/z values”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 11</code></li>\n        <li><em>“Tabular file contains a header line”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        <li><em>“Contrast enhancement”</em>: <code class=\"language-plaintext highlighter-rouge\">suppression</code></li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>Which N-linked glycans were used as calibrants?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>(Hex)2+(Man)3(GlcNAc)2 (1257.5) and (HexNAc)3+(Man)3(GlcNAc)2 (1542.6) (higher intensity in the calibrant file)</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<p>Despite the classification being done on a small part of the complete dataset, the discovered N-glycans are more abundant in both treated kidney sections than in the control and calibrant regions. The four additional N-glycans that we could identify are more abundant in the treated kidney than in the control files, but compared to the other N-glycans their intensities are lower.</p>\n\n<h2 id=\"n-linked-glycans-with-a-distinct-localization-to-kidney-compartments\">N-linked glycans with a distinct localization to kidney compartments</h2>\n\n<p>During PCA analysis we found N-glycans that are localized in specific kidney compartments. We will filter the identified N-glycan file for the specific m/z features to plot their distribution to different compartments as overlay image.</p>\n\n<blockquote class=\"comment\">\n  <comment-title>Regular expressions to filter text</comment-title>\n\n  <p>Regular expressions are syntax that can be used to describe a certain ‘text’. They are extremely helpful to filter any kind of text and are therefore utilized by several Galaxy tools. The tools help section provides more details about how to use regular expressions. Here, we want to filter for three m/z features, but we are unsure where the exact decimal places are. Therefore we filter only for the m/z feature without decimal places but include the point ‘.’ to make sure that we do not get matches to any other numbers in the tabular file. As the point ‘.’ has a special meaning in regular expressions, it is necessary to ‘escape’ it by using the backslash ‘' - this allows searching for the point as well. For example ‘1663\\.’ will filter for ‘1663.’ in the text. The pipe ‘|’ separates alternate possibilities and allows the user to run the tool only once while filtering for three different m/z features.</p>\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Overlayed distribution image for 3 N-glycans</hands-on-title>\n\n  <ol>\n    <li><strong>Select lines that match an expression</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Select lines from”</em>: <code class=\"language-plaintext highlighter-rouge\">Join two files</code> (output of <strong>Join two files</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“the pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">(1663\\.)|(1905\\.)|(2304\\.)</code></li>\n      </ul>\n    </li>\n    <li><strong>MSI mz images</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“MSI data”</em>: <code class=\"language-plaintext highlighter-rouge\">all_files</code> (uploaded dataset)</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“m/z of interest”</em>: <code class=\"language-plaintext highlighter-rouge\">Select on data</code> (output of <strong>Select</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Column with m/z values”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 1</code></li>\n        <li><em>“Column with name of m/z values”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 11</code></li>\n        <li><em>“Contrast enhancement”</em>: <code class=\"language-plaintext highlighter-rouge\">suppression</code></li>\n        <li><em>“Overlay image”</em>: <code class=\"language-plaintext highlighter-rouge\">yes</code>\n          <ul>\n            <li>In <em>“Colours for the plots”</em>:\n              <ul>\n                <li>Click on <em>“Insert Colours for the plots”</em>:</li>\n                <li>In <em>“1: Colours for the plots”</em>:\n                  <ul>\n                    <li><em>“Colours”</em>: <code class=\"language-plaintext highlighter-rouge\">dark_blue</code></li>\n                  </ul>\n                </li>\n                <li>Click on <em>“Insert Colours for the plots”</em>:</li>\n                <li>In <em>“2: Colours for the plots”</em>:\n                  <ul>\n                    <li><em>“Colours”</em>: <code class=\"language-plaintext highlighter-rouge\">green</code></li>\n                  </ul>\n                </li>\n                <li>Click on <em>“Insert Colours for the plots”</em>:</li>\n                <li>In <em>“3: Colours for the plots”</em>:\n                  <ul>\n                    <li><em>“Colours”</em>: <code class=\"language-plaintext highlighter-rouge\">red</code></li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<figure id=\"figure-5\" style=\"max-width: 90%;\"><img src=\"../../images/msi-diff-abundance-mz-images.png\" alt=\"overlay_images. \" width=\"1162\" height=\"1110\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/msi-diff-abundance-mz-images.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 5</strong>:</span> Distribution for three analytes that are localized in different kidney compartments and their overlay.</figcaption></figure>\n\n<h1 id=\"conclusion\">Conclusion</h1>\n\n<p>This tutorial covered combining datasets, data preprocessing and supervised as well as unsupervised statistical analysis.</p>\n\n<figure id=\"figure-6\" style=\"max-width: 90%;\"><img src=\"../../images/msi-diff-abundance-workflow.png\" alt=\"workflow. \" width=\"1508\" height=\"886\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/msi-diff-abundance-workflow.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 6</strong>:</span> Workflow that was used during this tutorial.</figcaption></figure>\n\n"],"ref_slides":[],"hands_on":true,"slides":false,"mod_date":"2023-11-03 14:30:27 +0000","pub_date":"2019-04-13 15:52:01 +0000","version":13,"workflows":[{"workflow":"msi-finding-diff-analytes.ga","tests":false,"url":"https://training.galaxyproject.org/training-material/topics/metabolomics/tutorials/msi-finding-nglycans/workflows/msi-finding-diff-analytes.ga","path":"topics/metabolomics/tutorials/msi-finding-nglycans/workflows/msi-finding-diff-analytes.ga","wfid":"metabolomics-msi-finding-nglycans","wfname":"msi-finding-diff-analytes","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/metabolomics-msi-finding-nglycans/versions/msi-finding-diff-analytes","license":null,"creators":[],"name":"MSI Finding Diff Analytes","title":"MSI Finding Diff Analytes","test_results":null,"modified":"2024-06-21 00:05:30 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\ntreated\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"ℹ️ Input Dataset\\ncontrol\"];\n  style 1 stroke:#2c3143,stroke-width:4px;\n  10[\"MSI classification\"];\n  9 -->|outfile_imzml| 10;\n  4 -->|pixel_annotations| 10;\n  11[\"MSI segmentation\"];\n  9 -->|outfile_imzml| 11;\n  12[\"Filter\"];\n  10 -->|mzfeatures| 12;\n  13[\"Join two files\"];\n  12 -->|out_file1| 13;\n  2 -->|output| 13;\n  14[\"Summary Statistics\"];\n  13 -->|merged_file| 14;\n  15[\"MSI mz images\"];\n  13 -->|merged_file| 15;\n  3 -->|output| 15;\n  16[\"Select\"];\n  13 -->|merged_file| 16;\n  17[\"MSI mz images\"];\n  16 -->|out_file1| 17;\n  3 -->|output| 17;\n  2[\"ℹ️ Input Dataset\\nGlycan_IDs\"];\n  style 2 stroke:#2c3143,stroke-width:4px;\n  3[\"ℹ️ Input Dataset\\nall_files\"];\n  style 3 stroke:#2c3143,stroke-width:4px;\n  4[\"MSI combine\"];\n  1 -->|output| 4;\n  0 -->|output| 4;\n  5[\"MSI preprocessing\"];\n  4 -->|outfile_imzml| 5;\n  6[\"MSI Qualitycontrol\"];\n  4 -->|outfile_imzml| 6;\n  4 -->|pixel_annotations| 6;\n  7[\"MALDIquant preprocessing\"];\n  5 -->|outfile_imzml| 7;\n  8[\"MALDIquant peak detection\"];\n  7 -->|outfile_imzml| 8;\n  4 -->|pixel_annotations| 8;\n  9[\"MSI preprocessing\"];\n  5 -->|outfile_imzml| 9;\n  8 -->|intensity_matrix| 9;"}],"api":"https://training.galaxyproject.org/training-material/api/topics/metabolomics/tutorials/msi-finding-nglycans/tutorial.json","tools":["Filter1","Grep1","Summary_Statistics1","toolshed.g2.bx.psu.edu/repos/bgruening/join_files_on_column_fuzzy/join_files_on_column_fuzzy/1.0.1","toolshed.g2.bx.psu.edu/repos/galaxyp/cardinal_classification/cardinal_classification/1.12.1.3","toolshed.g2.bx.psu.edu/repos/galaxyp/cardinal_combine/cardinal_combine/1.12.1.3","toolshed.g2.bx.psu.edu/repos/galaxyp/cardinal_mz_images/cardinal_mz_images/1.12.1.2","toolshed.g2.bx.psu.edu/repos/galaxyp/cardinal_preprocessing/cardinal_preprocessing/1.12.1.3","toolshed.g2.bx.psu.edu/repos/galaxyp/cardinal_quality_report/cardinal_quality_report/1.12.1.3","toolshed.g2.bx.psu.edu/repos/galaxyp/cardinal_segmentations/cardinal_segmentations/1.12.1.3","toolshed.g2.bx.psu.edu/repos/galaxyp/maldi_quant_peak_detection/maldi_quant_peak_detection/1.18.0.4","toolshed.g2.bx.psu.edu/repos/galaxyp/maldi_quant_preprocessing/maldi_quant_preprocessing/1.18.0.3"],"supported_servers":{"exact":[{"url":"https://usegalaxy.eu","name":"UseGalaxy.eu","usegalaxy":true}],"inexact":[{"url":"https://usegalaxy.cz/","name":"UseGalaxy.cz","usegalaxy":false},{"url":"https://usegalaxy.fr/","name":"UseGalaxy.fr","usegalaxy":false},{"url":"https://usegalaxy.no/","name":"UseGalaxy.no","usegalaxy":false},{"url":"https://usegalaxy.org.au","name":"UseGalaxy.org.au","usegalaxy":true}]},"topic_name_human":"Metabolomics","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"join_files_on_column_fuzzy","owner":"bgruening","revisions":"22ec3c1a20cd","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"cardinal_classification","owner":"galaxyp","revisions":"b574b84afc4d","tool_panel_section_label":"Proteomics","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"cardinal_combine","owner":"galaxyp","revisions":"48c07268f341","tool_panel_section_label":"Proteomics","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"cardinal_mz_images","owner":"galaxyp","revisions":"25b83cbd596a","tool_panel_section_label":"Proteomics","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"cardinal_preprocessing","owner":"galaxyp","revisions":"ed9ed1e6cca2","tool_panel_section_label":"Proteomics","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"cardinal_quality_report","owner":"galaxyp","revisions":"3b7a35d50ebf","tool_panel_section_label":"Proteomics","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"cardinal_segmentations","owner":"galaxyp","revisions":"82f6c2f4332d","tool_panel_section_label":"Proteomics","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"maldi_quant_peak_detection","owner":"galaxyp","revisions":"e9300ef37403","tool_panel_section_label":"Proteomics","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"maldi_quant_preprocessing","owner":"galaxyp","revisions":"71411ac28268","tool_panel_section_label":"Proteomics","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: join_files_on_column_fuzzy\n  owner: bgruening\n  revisions: 22ec3c1a20cd\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: cardinal_classification\n  owner: galaxyp\n  revisions: b574b84afc4d\n  tool_panel_section_label: Proteomics\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: cardinal_combine\n  owner: galaxyp\n  revisions: 48c07268f341\n  tool_panel_section_label: Proteomics\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: cardinal_mz_images\n  owner: galaxyp\n  revisions: 25b83cbd596a\n  tool_panel_section_label: Proteomics\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: cardinal_preprocessing\n  owner: galaxyp\n  revisions: ed9ed1e6cca2\n  tool_panel_section_label: Proteomics\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: cardinal_quality_report\n  owner: galaxyp\n  revisions: 3b7a35d50ebf\n  tool_panel_section_label: Proteomics\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: cardinal_segmentations\n  owner: galaxyp\n  revisions: 82f6c2f4332d\n  tool_panel_section_label: Proteomics\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: maldi_quant_peak_detection\n  owner: galaxyp\n  revisions: e9300ef37403\n  tool_panel_section_label: Proteomics\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: maldi_quant_preprocessing\n  owner: galaxyp\n  revisions: 71411ac28268\n  tool_panel_section_label: Proteomics\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":false,"slides_recordings":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial"}