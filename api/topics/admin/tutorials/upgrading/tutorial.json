{"layout":"tutorial_hands_on","redirect_from":["/topics/admin/tutorials/upgrading/slides","/short/admin/upgrading","/short/T00025"],"title":"Upgrading Galaxy","zenodo_link":"","questions":["How can I find which version of Galaxy I'm running?","How do I upgrade the Galaxy server to the latest version?"],"objectives":["Understand how to find the current Galaxy server version you are using","How to find the latest release version","How to backup the Galaxy server database and why it's a good idea","How to upgrade the Galaxy server to a new version"],"time_estimation":"1h","key_points":["Using Ansible to keep your server up to date is the best practice method","Always backup the database before you do an upgrade in case anything goes wrong","Re-run the playbook from time to time to keep your Galaxy server up to date with any minor changes and patches"],"contributors":[{"name":"Simon Gladman","email":"simon.gladman@unimelb.edu.au","joined":"2017-09","elixir_node":"au","orcid":"0000-0002-6100-4385","in_memoriam":"<a href=\"https://www.biocommons.org.au/news/simon-gladman\">Simon Gladman, system administrator of UseGalaxy.org.au, passed away on November 26, 2022</a>\n\n<a href=\"https://galaxyproject.org/news/2022-11-28-simon-gladman/\">He was a fantastic teacher, tutorial author, system administrator, and warm and welcoming friend.</a> He contributed heavily to the Galaxy Training Network and especially the Galaxy Administration community over the years, we will miss him dearly. The GTN and GAT would not be what they are today, without him.\n\n“Have I told you about my watch?”","id":"slugger70","url":"https://training.galaxyproject.org/training-material/api/contributors/slugger70.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/slugger70/"}],"subtopic":"maintenance","tags":["ansible"],"requirements":[{"type":"internal","topic_name":"admin","tutorials":["ansible","ansible-galaxy"]}],"js_requirements":{"mathjax":null,"mermaid":false},"short_id":"T00025","url":"/topics/admin/tutorials/upgrading/tutorial.html","topic_name":"admin","tutorial_name":"upgrading","dir":"topics/admin/tutorials/upgrading","symlink":null,"id":"admin/upgrading","ref_tutorials":["<h1 id=\"overview\">Overview</h1>\n\n<p>One of the most important and recurring tasks for a Galaxy server admin is to keep the server up to date with security patches, minor fixes and major version upgrades.</p>\n\n<p>Luckily for us, by using the best practice Ansible installation method that we have used throughout these tutorials, keeping our Galaxy server up to date is extremely easy.</p>\n\n<p>We can get all the latest patches and fixes for our currently installed version of Galaxy by just re-running the Ansible playbook on a regular basis.</p>\n\n<p>We can upgrade our Galaxy version by modifying the Ansible var files and re-running the playbook. It’s that simple.</p>\n\n<p>This tutorial will show you how and discuss some of the things you need to keep in mind whenever you are updating or upgrading your Galaxy server.</p>\n\n<h2 id=\"some-notes-on-galaxy-versioning-and-releases\">Some notes on Galaxy versioning and releases.</h2>\n\n<ul>\n  <li>As at June 2021, Galaxy has three new version releases per year - in each of January, May and September. The versions are denominated by the year and month - <code class=\"language-plaintext highlighter-rouge\">YY.MM</code>. i.e. January 2021’s Galaxy release is version <em>21.01</em>.</li>\n  <li>Official Galaxy versions are tagged on the <a href=\"https://github.com/galaxyproject/galaxy/releases\">Galaxy Project’s GitHub releases page</a> as <code class=\"language-plaintext highlighter-rouge\">vYY.MM</code>. e.g. <em>v21.01</em></li>\n  <li>Each version also has an official branch in the GitHub repo named <code class=\"language-plaintext highlighter-rouge\">release_YY.MM</code>. e.g. <em>release_21.01</em></li>\n  <li>Galaxy versions will be supported with security fixes, bug patches and other improvements for <a href=\"https://github.com/galaxyproject/galaxy/blob/dev/SECURITY_POLICY.md#supported-versions\">one year</a> from the time of release at which time they will become “End of Life” and will no longer be supported.</li>\n</ul>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#overview\" id=\"markdown-toc-overview\">Overview</a>    <ol>\n      <li><a href=\"#some-notes-on-galaxy-versioning-and-releases\" id=\"markdown-toc-some-notes-on-galaxy-versioning-and-releases\">Some notes on Galaxy versioning and releases.</a></li>\n      <li><a href=\"#this-tutorial-assumes-that\" id=\"markdown-toc-this-tutorial-assumes-that\">This tutorial assumes that:</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#find-your-current-galaxy-server-version\" id=\"markdown-toc-find-your-current-galaxy-server-version\">Find your current Galaxy server version</a></li>\n  <li><a href=\"#finding-the-latest-release-version\" id=\"markdown-toc-finding-the-latest-release-version\">Finding the latest release version</a>    <ol>\n      <li><a href=\"#the-importance-of-the-release-notes\" id=\"markdown-toc-the-importance-of-the-release-notes\">The importance of the release notes</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#back-up-the-galaxy-database\" id=\"markdown-toc-back-up-the-galaxy-database\">Back up the Galaxy database</a></li>\n  <li><a href=\"#upgrading-galaxy-to-a-new-version\" id=\"markdown-toc-upgrading-galaxy-to-a-new-version\">Upgrading Galaxy to a new version</a></li>\n  <li><a href=\"#ongoing-maintenance\" id=\"markdown-toc-ongoing-maintenance\">Ongoing maintenance</a></li>\n  <li><a href=\"#conclusion\" id=\"markdown-toc-conclusion\">Conclusion</a></li>\n</ol>\n\n</blockquote>\n\n<h2 id=\"this-tutorial-assumes-that\">This tutorial assumes that:</h2>\n\n<ul>\n  <li>You have a VM or machine where you you have Galaxy installed.</li>\n  <li>You have completed at least the “Galaxy Installation with Ansible” tutorial.</li>\n  <li>You have command line and sudo access to the VM/computer where it is installed.</li>\n</ul>\n\n<blockquote class=\"tip\">\n  <tip-title>Galaxy server version installed by the tutorials</tip-title>\n  <p>At the time of writing, the version of Galaxy that was installed with the “Galaxy Installation with Ansible” tutorial is <em>20.09</em>. This tutorial is designed to upgrade the server to <em>21.01</em>. If you already have a version equal to or higher than <em>21.01</em> running on your server, never fear! The process outlined below can still be used to upgrade to the latest version of Galaxy - just swap out <em>21.01</em> used below for the current latest version.</p>\n</blockquote>\n\n<h1 id=\"find-your-current-galaxy-server-version\">Find your current Galaxy server version</h1>\n\n<p>The first thing we will do in this tutorial is find the current installed version of the Galaxy. There are a few methods for determining this - You can find it in the GUI if you are an admin user or you can get it via the server API.</p>\n\n<p>Once we know what our current version is, we can compare it with the latest available version</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Get the current server version</hands-on-title>\n\n  <p><strong>Method 1: Via the Admin UI page</strong>\nThe currently installed version of Galaxy is shown on the Galaxy server’s Admin UI page.</p>\n  <ol>\n    <li>\n      <p>Click on the <strong>Admin</strong> menu item to bring up the Admin UI.</p>\n    </li>\n    <li>\n      <p>The version of Galaxy currently running is displayed in the top left corner of the screen.</p>\n    </li>\n  </ol>\n\n  <figure id=\"figure-1\" style=\"max-width: 90%;\"><img src=\"../../images/admin_page_version.png\" alt=\"Screenshot of the Admin UI page showing the Galaxy server version. \" width=\"453\" height=\"186\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/admin_page_version.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 1</strong>:</span> Screenshot of the Admin UI page showing the Galaxy server version.</figcaption></figure>\n\n  <p><strong>Method 2: Via the API</strong></p>\n\n  <ol>\n    <li>\n      <p>In your browser - go to the following URL: <a href=\"https://my.gat.galaxy.training/?path=/api/version\"><code class=\"language-plaintext highlighter-rouge\">https://galaxy.example.org/api/version</code></a> (replacing <code class=\"language-plaintext highlighter-rouge\">galaxy.example.org</code> with the hostname of your Galaxy server). The version will be displayed as follows:</p>\n\n      <blockquote class=\"code-in\">\n        <code-in-title>Bash</code-in-title>\n        <div data-cmd=\"true\" class=\"language-shell highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>curl https://galaxy.example.org/api/version\n</code></pre></div>        </div>\n      </blockquote>\n\n      <blockquote class=\"code-out\">\n        <code-out-title>Browser window</code-out-title>\n        <pre><code class=\"language-JSON\">{\n  \"version_major\": \"20.09\",\n  \"extra\": {}\n}\n</code></pre>\n      </blockquote>\n    </li>\n  </ol>\n\n  <p>Both methods above show the version of Galaxy that has been installed. At the time of writing, on this server it’s <em>20.09</em>. Your version may differ depending on which version you installed initially.</p>\n</blockquote>\n\n<h1 id=\"finding-the-latest-release-version\">Finding the latest release version</h1>\n\n<p>So, we have found out which version we are running on our server. But what is the current latest version of Galaxy that is available? There are quite a few ways of finding out.</p>\n\n<ul>\n  <li>Galaxy is released 3 times per year. If the time of year is around January/February, April/May or September/October there may be a new release about to be announced.</li>\n  <li>You can check the Galaxy Project Newsletter and home page <a href=\"https://galaxyproject.org\">https://galaxyproject.org</a></li>\n</ul>\n\n<p>Probably the easiest way of finding the version number of the latest release is via the extensive Galaxy Documentation Website located at: <a href=\"https://docs.galaxyproject.org\">https://docs.galaxyproject.org</a>.</p>\n\n<p>This site shows all of the release notes of all the available Galaxy versions and always has the latest release at the top of the list.</p>\n\n<figure id=\"figure-2\" style=\"max-width: 90%;\"><img src=\"../../images/galaxy_doc_releases.png\" alt=\"Screenshot of the Galaxy documentation webpage showing the release versions. \" width=\"1104\" height=\"713\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/galaxy_doc_releases.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 2</strong>:</span> Screenshot of the Galaxy documentation webpage (<a href=\"https://docs.galaxyproject.org\">https://docs.galaxyproject.org</a>) showing the release versions. The latest version is at the top of the 'Releases' list.</figcaption></figure>\n\n<p>We can see from this page that the latest release version of Galaxy is <em>21.01</em> (at the time of writing.)</p>\n\n<blockquote class=\"question\">\n  <question-title>What is the current latest version?</question-title>\n  <p>As previously mentioned, the current latest release of Galaxy may not be <em>21.01</em>. What version is the latest that you can see?</p>\n</blockquote>\n\n<h2 id=\"the-importance-of-the-release-notes\">The importance of the release notes</h2>\n\n<p>Each release of Galaxy is accompanied by extensive release notes in two different “flavours.”</p>\n\n<ul>\n  <li>“Full release notes” which have extensive detail about all changes made since the last release. This version of the release notes is targetted to Administrators who may need to know about minor fixes, configuration details, security issues, new features and other things found in the latest version.</li>\n  <li>“User facing” release notes which provide an visual and interactive summary of the release highlights, additions and new features targetted towards end users, trainers and funders etc.</li>\n</ul>\n\n<p>Before upgrading your Galaxy server to the latest version (or even a new version for that matter) - It is <strong>HIGHLY recommended</strong> that you read the release notes for that version. The notes are <em>very extensive</em> and may contain important information on any new features, links  and how to configure them for your server.</p>\n\n<figure id=\"figure-3\" style=\"max-width: 90%;\"><img src=\"../../images/release_notes_2101.png\" alt=\"Example section of release notes for release 21.01. \" width=\"1104\" height=\"954\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/release_notes_2101.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 3</strong>:</span> An example selection from the release notes for Galaxy version 21.01 showing details on enhancements made with their associated Pull Requests in the GitHub repository.</figcaption></figure>\n\n<h1 id=\"back-up-the-galaxy-database\">Back up the Galaxy database</h1>\n\n<p>At the heart of every Galaxy server beats its database. The database is the most important part of the Galaxy server as it contains all of the metadata required for the server to operate and records details of all users, jobs, datasets etc since the server was started.</p>\n\n<p>Sometimes new versions of Galaxy make changes to the database schema that require a database upgrade.</p>\n\n<p>It is highly important that we back it up before making any substantial changes to the Galaxy server as things sometimes go wrong (inopportune power failures, disk crashes etc) and losing or corrupting the database is possible during an upgrade operation.</p>\n\n<p>In a production environment it is really important to make regular backups of the database in any case. The <strong>usegalaxy.*</strong> servers all perform at least daily backups of their respective databases and even have replicate database servers <em>just in case.</em></p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Back up the Galaxy database</hands-on-title>\n\n  <p>We will be using the PostgreSQL <code class=\"language-plaintext highlighter-rouge\">pg_dump</code> command to dump the complete contents of the Galaxy database to a file. From the usage text of the command:</p>\n\n  <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>  pg_dump --help\n  pg_dump dumps a database as a text file or to other formats.\n\n  Usage:\n    pg_dump [OPTION]... [DBNAME]\n</code></pre></div>  </div>\n\n  <p>We will use <code class=\"language-plaintext highlighter-rouge\">pg_dump</code> and pipe its output through <code class=\"language-plaintext highlighter-rouge\">gzip</code> to an output file to create a compressed text (SQL) representation of the database. We will need to do this as the <code class=\"language-plaintext highlighter-rouge\">galaxy</code> user. It’s a good idea to create the backup file name with a sensible name and then copy it somewhere else like a cloud service.</p>\n\n  <p>From your terminal -</p>\n\n  <blockquote class=\"code-in\">\n    <code-in-title>Bash</code-in-title>\n    <div data-cmd=\"true\" class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nb\">sudo </span>su <span class=\"nt\">-l</span> galaxy\npg_dump galaxy | <span class=\"nb\">gzip</span> <span class=\"o\">&gt;</span> galaxy_database-2009-1.sql.gz\n<span class=\"nb\">ls</span> <span class=\"nt\">-lah</span> galaxy_database<span class=\"k\">*</span>\n</code></pre></div>    </div>\n  </blockquote>\n\n  <blockquote class=\"code-out\">\n    <code-out-title>Bash</code-out-title>\n    <div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nt\">-rw-rw-r--</span> 1 galaxy galaxy 94K Jun  8 04:12 galaxy_database_2009-1.sql.gz\n</code></pre></div>    </div>\n  </blockquote>\n\n  <p>As you can see, the database on our server isn’t currently huge though this will changes as your server gets more users, runs more jobs and stores more data. The current size for Galaxy Australia’s compressed database backup is ~11GB and growing.</p>\n</blockquote>\n\n<p>Now that we have backed up our database we can move on to upgrading our Galaxy server to the latest version. For the sake of this tutorial, we will assume that the installed version is different to the latest version (at the time of writing - <em>20.09</em> vs <em>21.01</em>). If that is not the case for you, then you can instead use this tutorial as a reference in the future.</p>\n\n<h1 id=\"upgrading-galaxy-to-a-new-version\">Upgrading Galaxy to a new version</h1>\n\n<p>If you’ve been following best practices and using Ansible to install and configure your Galaxy server then you’re in luck - this step is going to be very easy! We just need to adjust the Galaxy version number in our <code class=\"language-plaintext highlighter-rouge\">group_vars/galaxyservers.yml</code> file and re-run the playbook. If you haven’t been using Ansible then there are some notes on performing an upgrade located at: <a href=\"https://galaxyproject.org/admin/maintenance/\">https://galaxyproject.org/admin/maintenance/</a>. The Ansible method is much preferred and simple!</p>\n\n<p>There are however a few things to consider before doing the actual upgrade, especially in a production environment.</p>\n\n<ul>\n  <li>Galaxy will be restarted.\n    <ul>\n      <li>Is this an appropriate time for that to happen?</li>\n      <li>Does it need to be scheduled with your users?</li>\n    </ul>\n  </li>\n  <li>The database schema may change\n    <ul>\n      <li>Have you backed up the database?</li>\n    </ul>\n  </li>\n</ul>\n\n<p>Once you’ve made sure of these things, it’s time to do it!</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Back up the Galaxy database</hands-on-title>\n\n  <p>In this tutorial we will upgrade the server to version <em>21.01</em>. This may be different for you. Please use the latest version instead.</p>\n\n  <ol>\n    <li>\n      <p>Edit the <code class=\"language-plaintext highlighter-rouge\">group_vars/galaxyservers.yml</code> file and change the <code class=\"language-plaintext highlighter-rouge\">galaxy_commit_id</code> to the latest version. Use the form <code class=\"language-plaintext highlighter-rouge\">release_YY.MM</code> or in this case <code class=\"language-plaintext highlighter-rouge\">release_21.01</code>.</p>\n\n      <div class=\"language-diff highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"gd\">--- a/group_vars/galaxyservers.yml\n</span><span class=\"gi\">+++ b/group_vars/galaxyservers.yml\n</span><span class=\"p\">@@ -21,7 +21,7 @@</span> galaxy_manage_paths: true\n galaxy_layout: root-dir\n galaxy_root: /srv/galaxy\n galaxy_user: {name: galaxy, shell: /bin/bash}\n<span class=\"gd\">-galaxy_commit_id: release_20.09\n</span><span class=\"gi\">+galaxy_commit_id: release_21.01\n</span> galaxy_force_checkout: true\n miniconda_prefix: \"{{ galaxy_tool_dependency_dir }}/_conda\"\n miniconda_version: 4.7.12\n</code></pre></div>      </div>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-how-to-read-a-diff\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-how-to-read-a-diff\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: How to read a Diff</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>If you haven’t worked with diffs before, this can be something quite new or different.</p>   <p>If we have two files, let’s say a grocery list, in two files. We’ll call them ‘a’ and ‘b’.</p>   <blockquote class=\"code-2col\">   <blockquote class=\"code-in\">     <code-in-title>Old</code-in-title>     <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>$ cat old<br />🍎<br />🍐<br />🍊<br />🍋<br />🍒<br />🥑<br /></code></pre></div>    </div>   </blockquote>   <blockquote class=\"code-out\">     <code-out-title>New</code-out-title>     <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>$ cat new<br />🍎<br />🍐<br />🍊<br />🍋<br />🍍<br />🥑<br /></code></pre></div>    </div>   </blockquote> </blockquote>   <p>We can see that they have some different entries. We’ve removed 🍒 because they’re awful, and replaced them with an 🍍</p>   <p>Diff lets us compare these files</p>   <div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nv\">$ </span>diff old new<br />5c5<br />&lt; 🍒<br /><span class=\"nt\">---</span><br /><span class=\"o\">&gt;</span> 🍍<br /></code></pre></div></div>   <p>Here we see that 🍒 is only in a, and 🍍 is only in b. But otherwise the files are identical.</p>   <p>There are a couple different formats to diffs, one is the ‘unified diff’</p>   <div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nv\">$ </span>diff <span class=\"nt\">-U2</span> old new<br /><span class=\"nt\">---</span> old\t2022-02-16 14:06:19.697132568 +0100<br />+++ new\t2022-02-16 14:06:36.340962616 +0100<br />@@ <span class=\"nt\">-3</span>,4 +3,4 @@<br /> 🍊<br /> 🍋<br />-🍒<br />+🍍<br /> 🥑<br /></code></pre></div></div>   <p>This is basically what you see in the training materials which gives you a lot of context about the changes:</p>   <ul>   <li><code class=\"language-plaintext highlighter-rouge\">--- old</code> is the ‘old’ file in our view</li>   <li><code class=\"language-plaintext highlighter-rouge\">+++ new</code> is the ‘new’ file</li>   <li>@@ these lines tell us where the change occurs and how many lines are added or removed.</li>   <li>Lines starting with a - are removed from our ‘new’ file</li>   <li>Lines with a + have been added.</li> </ul>   <p>So when you go to apply these diffs to your files in the training:</p>   <ol>   <li>Ignore the header</li>   <li>Remove lines starting with - from your file</li>   <li>Add lines starting with + to your file</li> </ol>   <p>The other lines (🍊/🍋 and 🥑) above just provide “context”, they help you know where a change belongs in a file, but <strong>should not be edited</strong> when you’re making the above change. Given the above diff, you would find a line with a 🍒, and replace it with a 🍍</p>   <h4 id=\"added--removed-lines\">Added &amp; Removed Lines</h4>   <p>Removals are very easy to spot, we just have removed lines</p>   <div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nt\">---</span> old\t2022-02-16 14:06:19.697132568 +0100<br />+++ new\t2022-02-16 14:10:14.370722802 +0100<br />@@ <span class=\"nt\">-4</span>,3 +4,2 @@<br /> 🍋<br /> 🍒<br />-🥑<br /></code></pre></div></div>   <p>And additions likewise are very easy, just add a new line, between the other lines in your file.</p>   <div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nt\">---</span> old\t2022-02-16 14:06:19.697132568 +0100<br />+++ new\t2022-02-16 14:11:11.422135393 +0100<br />@@ <span class=\"nt\">-1</span>,3 +1,4 @@<br /> 🍎<br />+🍍<br /> 🍐<br /> 🍊<br /></code></pre></div></div>   <h4 id=\"completely-new-files\">Completely new files</h4>   <p>Completely new files look a bit different, there the “old” file is <code class=\"language-plaintext highlighter-rouge\">/dev/null</code>, the empty file in a Linux machine.</p>   <div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nv\">$ </span>diff <span class=\"nt\">-U2</span> /dev/null old<br /><span class=\"nt\">---</span> /dev/null\t2022-02-15 11:47:16.100000270 +0100<br />+++ old\t2022-02-16 14:06:19.697132568 +0100<br />@@ <span class=\"nt\">-0</span>,0 +1,6 @@<br />+🍎<br />+🍐<br />+🍊<br />+🍋<br />+🍒<br />+🥑<br /></code></pre></div></div>   <p>And removed files are similar, except with the new file being /dev/null</p>   <div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nt\">---</span> old\t2022-02-16 14:06:19.697132568 +0100<br />+++ /dev/null\t2022-02-15 11:47:16.100000270 +0100<br />@@ <span class=\"nt\">-1</span>,6 +0,0 @@<br />-🍎<br />-🍐<br />-🍊<br />-🍋<br />-🍒<br />-🥑<br /></code></pre></div></div> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Now run the playbook!</p>\n\n      <blockquote class=\"code-in\">\n        <code-in-title>Bash</code-in-title>\n        <div data-cmd=\"true\" class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>ansible-playbook galaxy.yml\n</code></pre></div>        </div>\n      </blockquote>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>You should see in the Ansible output that Galaxy had to rebuild the client, update the database, rebuild its virtual environment and restart. If you weren’t using Ansible, these steps would all be manual and important not to get wrong. Ansible makes the entire process super simple for us.</p>\n\n<p>Congratulations, you’re Galaxy server should now be updated to the latest version. You can check this by going to the Admin UI page or by using the API as described above.</p>\n\n<h1 id=\"ongoing-maintenance\">Ongoing maintenance</h1>\n\n<p>The Galaxy development community continually support release versions of Galaxy <a href=\"https://github.com/galaxyproject/galaxy/blob/dev/SECURITY_POLICY.md#supported-versions\">for 1 year.</a> They regularly update releases with bug fixes, patches and security enhancements. Therefore it is important that we as administrators keep our Galaxy servers up to date regardless of which release we are running.</p>\n\n<p>The easiest way to do this is to regularly re-run the Ansible playbook. It will check with GitHub and grab any new changes to Galaxy since the last time you ran it and automatically keep everything up to date. The large <strong>usegalaxy.*</strong> servers all re-run the playbook on a regular schedule for this purpose.</p>\n\n<p>Regular running of the playbook also encourages you and your team members to make changes to the Ansible scripts not the live system (as live changes will be overwritten). This leads to a much more robust and consistent production Galaxy server for your users.</p>\n\n<h1 id=\"conclusion\">Conclusion</h1>\n\n<p>This tutorial has shown you how to keep your Galaxy server up to date with the latest version painlessly and simply following current best practice. We hope you enjoyed this tutorial and got something out of it.</p>\n"],"ref_slides":[],"video_library":{"tutorial":{"description":null,"materials":[{"link":"topics/admin/tutorials/upgrading/tutorial.html","type":"tutorial"}],"tags":["admin"],"type":"Tutorial","versions":[{"captions":["slugger70","hexylena"],"date":"2021-02-15","galaxy_version":"21.01","length":"36M","link":"OnL47MvXjoo","speakers":["slugger70"]}],"gtn_id":"admin/upgrading","title":"Upgrading Galaxy","captioned":true},"slides":null,"demo":null,"both":null,"session":null},"hands_on":true,"slides":false,"mod_date":"2024-03-18 11:27:39 +0000","pub_date":"2021-06-08 09:15:42 +0000","version":13,"api":"https://training.galaxyproject.org/training-material/api/topics/admin/tutorials/upgrading/tutorial.json","tools":[],"supported_servers":[],"topic_name_human":"Galaxy Server administration","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools: []\n","tours":false,"video":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial"}