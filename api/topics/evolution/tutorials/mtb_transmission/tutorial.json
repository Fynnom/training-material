{
  "layout": "tutorial_hands_on",
  "title": "Identifying tuberculosis transmission links: from SNPs to transmission clusters",
  "zenodo_link": "https://zenodo.org/record/6010176",
  "objectives": [
    "Create a SNP alignment",
    "Calculate pairwise SNP distances between MTB samples",
    "Identify transmission clusters based on SNP distances",
    "Study the emergence and spread of drug resistance based on transmission analysis."
  ],
  "time_estimation": "2H",
  "level": "Intermediate",
  "key_points": [
    "Clustering is a useful tool to detect transmission links between patients and oubreak investigation.",
    "Clustering can be used to investigate the transmission of certain traits, like drug resistance.",
    "Clustering does not provide information about particular transmission events nor their directionality (who infected whom).",
    "Clustering is very much influenced by sampling. Lower sampling proportions and shorter sampling timeframes lead to lower clustering rates that shoud not be confounded with lack of transmission."
  ],
  "requirements": [
    {
      "type": "internal",
      "topic_name": "galaxy-interface",
      "tutorials": [
        "collections"
      ]
    },
    {
      "type": "internal",
      "topic_name": "variant-analysis",
      "tutorials": [
        "tb-variant-analysis"
      ]
    }
  ],
  "contributions": {
    "authorship": [
      "GaloGS",
      "dbrites",
      "cstritt"
    ],
    "editing": [
      "wm75"
    ]
  },
  "tags": [
    "prokaryote",
    "one-health",
    "microgalaxy"
  ],
  "edam_ontology": [
    "topic_0622",
    "topic_3301",
    "topic_3324",
    "topic_2885"
  ],
  "js_requirements": {
    "mathjax": null,
    "mermaid": false
  },
  "short_id": "T00145",
  "url": "/topics/evolution/tutorials/mtb_transmission/tutorial.html",
  "topic_name": "evolution",
  "tutorial_name": "mtb_transmission",
  "dir": "topics/evolution/tutorials/mtb_transmission",
  "symlink": null,
  "id": "evolution/mtb_transmission",
  "video_library": {
    "tutorial": null,
    "slides": null,
    "demo": null,
    "both": null,
    "session": null
  },
  "hands_on": true,
  "slides": false,
  "mod_date": "2024-03-12 15:54:16 +0000",
  "pub_date": "2022-03-16 08:35:43 +0000",
  "version": 15,
  "workflows": [
    {
      "workflow": "Galaxy-Workflow-From_BAMs_to_drug_resistance_prediction_with_TB-profiler.ga",
      "tests": false,
      "url": "https://training.galaxyproject.org/training-material/topics/evolution/tutorials/mtb_transmission/workflows/Galaxy-Workflow-From_BAMs_to_drug_resistance_prediction_with_TB-profiler.ga",
      "path": "topics/evolution/tutorials/mtb_transmission/workflows/Galaxy-Workflow-From_BAMs_to_drug_resistance_prediction_with_TB-profiler.ga",
      "wfid": "evolution-mtb_transmission",
      "wfname": "galaxy-workflow-from_bams_to_drug_resistance_prediction_with_tb-profiler",
      "trs_endpoint": "https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/evolution-mtb_transmission/versions/galaxy-workflow-from_bams_to_drug_resistance_prediction_with_tb-profiler",
      "license": null,
      "creators": [

      ],
      "name": "From BAMs to drug resistance prediction with TB-profiler",
      "title": "From BAMs to drug resistance prediction with TB-profiler",
      "test_results": null,
      "modified": "2024-03-31 23:39:52 +0000",
      "mermaid": "flowchart TD\n  0[\"ℹ️ Input Collection\\nMTB single-end BAMs\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"ℹ️ Input Collection\\nMTB paired-end BAMs\"];\n  style 1 stroke:#2c3143,stroke-width:4px;\n  2[\"Merge collections\"];\n  0 -->|output| 2;\n  1 -->|output| 2;\n  3[\"Samtools view BAM > SAM\"];\n  2 -->|output| 3;\n  aa220027-9d10-4328-b2c2-e4d139d5d5bd[\"Output\\nSamtools view on input dataset(s): filtered alignments\"];\n  3 --> aa220027-9d10-4328-b2c2-e4d139d5d5bd;\n  style aa220027-9d10-4328-b2c2-e4d139d5d5bd stroke:#2c3143,stroke-width:4px;\n  4[\"Sed MTB_anc to Chromosome\"];\n  3 -->|outputsam| 4;\n  5[\"Samtools view SAM > BAM\"];\n  4 -->|output| 5;\n  6[\"TB-profiler\"];\n  5 -->|outputsam| 6;\n  7[\"Get drug resistance profile\"];\n  6 -->|output_txt| 7;\n  8[\"Add Sample Name\"];\n  7 -->|output| 8;\n  9[\"Concatenate DR profiles in a single table\"];\n  8 -->|output| 9;\n  10[\"Cleanup the table\"];\n  9 -->|out_file1| 10;"
    },
    {
      "workflow": "Galaxy-Workflow-From_Fastqs_to_VCFs_and_BAMs.ga",
      "tests": false,
      "url": "https://training.galaxyproject.org/training-material/topics/evolution/tutorials/mtb_transmission/workflows/Galaxy-Workflow-From_Fastqs_to_VCFs_and_BAMs.ga",
      "path": "topics/evolution/tutorials/mtb_transmission/workflows/Galaxy-Workflow-From_Fastqs_to_VCFs_and_BAMs.ga",
      "wfid": "evolution-mtb_transmission",
      "wfname": "galaxy-workflow-from_fastqs_to_vcfs_and_bams",
      "trs_endpoint": "https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/evolution-mtb_transmission/versions/galaxy-workflow-from_fastqs_to_vcfs_and_bams",
      "license": null,
      "creators": [

      ],
      "name": "From Fastqs to VCFs and BAMs",
      "title": "From Fastqs to VCFs and BAMs",
      "test_results": null,
      "modified": "2024-03-31 23:39:52 +0000",
      "mermaid": "flowchart TD\n  0[\"ℹ️ Input Collection\\nSingle-End FASTQs\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"ℹ️ Input Collection\\nPaired-End FASTQs\"];\n  style 1 stroke:#2c3143,stroke-width:4px;\n  2[\"ℹ️ Input Dataset\\nMycobacterium_tuberculosis_ancestral_reference.gbk\"];\n  style 2 stroke:#2c3143,stroke-width:4px;\n  3[\"Trimmomatic\"];\n  0 -->|output| 3;\n  4[\"Trimmomatic\"];\n  1 -->|output| 4;\n  5[\"Mapping and variant calling of SINGLE END FASTQs with snippy\"];\n  3 -->|fastq_out| 5;\n  2 -->|output| 5;\n  6[\"Mapping and variant calling of PAIRED END FASTQs with snippy\"];\n  4 -->|fastq_out_paired| 6;\n  2 -->|output| 6;\n  7[\"Merge PE/SE VCFs in a single collection with all samples\"];\n  5 -->|snpvcf| 7;\n  6 -->|snpvcf| 7;\n  8[\"Merge PE/SE BAMs in a single collection with all samples Part the workflow ”Identifying DR with TB-profiler\"];\n  5 -->|snpsbam| 8;\n  6 -->|snpsbam| 8;\n  9[\"TB Variant Filter\"];\n  7 -->|output| 9;"
    },
    {
      "workflow": "main_workflow.ga",
      "tests": false,
      "url": "https://training.galaxyproject.org/training-material/topics/evolution/tutorials/mtb_transmission/workflows/main_workflow.ga",
      "path": "topics/evolution/tutorials/mtb_transmission/workflows/main_workflow.ga",
      "wfid": "evolution-mtb_transmission",
      "wfname": "main_workflow",
      "trs_endpoint": "https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/evolution-mtb_transmission/versions/main_workflow",
      "license": null,
      "creators": [

      ],
      "name": "From VCFs to SNP distance matrix",
      "title": "From VCFs to SNP distance matrix",
      "test_results": null,
      "modified": "2024-03-31 23:39:52 +0000",
      "mermaid": "flowchart TD\n  0[\"ℹ️ Input Collection\\nCollection of VCFs to analyze\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"ℹ️ Input Dataset\\nReference genome of the MTBC ancestor\"];\n  style 1 stroke:#2c3143,stroke-width:4px;\n  2[\"Filter TB variants\"];\n  0 -->|output| 2;\n  3[\"Generate the complete genome of each of the samples\"];\n  2 -->|output1| 3;\n  1 -->|output| 3;\n  ce5dd7a2-c33d-46b4-9f02-68c2bdfcf31a[\"Output\\n#{input_file}\"];\n  3 --> ce5dd7a2-c33d-46b4-9f02-68c2bdfcf31a;\n  style ce5dd7a2-c33d-46b4-9f02-68c2bdfcf31a stroke:#2c3143,stroke-width:4px;\n  4[\"Concatenate genomes to build a MSA\"];\n  3 -->|output_file| 4;\n  5[\"Keep only variable positions\"];\n  4 -->|out_file1| 5;\n  6[\"Calculate SNP distances\"];\n  5 -->|output_fasta| 6;"
    }
  ],
  "api": "https://training.galaxyproject.org/training-material/api/topics/evolution/tutorials/mtb_transmission/tutorial.json",
  "tools": [
    "Grep1",
    "__MERGE_COLLECTION__",
    "toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_cat/0.1.1",
    "toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_easyjoin_tool/1.1.2",
    "toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_grep_tool/1.1.1",
    "toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_replace_in_line/1.1.2",
    "toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_sed_tool/1.1.1",
    "toolshed.g2.bx.psu.edu/repos/iuc/bcftools_consensus/bcftools_consensus/1.15.1+galaxy3",
    "toolshed.g2.bx.psu.edu/repos/iuc/bcftools_consensus/bcftools_consensus/1.9+galaxy2",
    "toolshed.g2.bx.psu.edu/repos/iuc/samtools_view/samtools_view/1.13+galaxy2",
    "toolshed.g2.bx.psu.edu/repos/iuc/snippy/snippy/3.2",
    "toolshed.g2.bx.psu.edu/repos/iuc/snippy/snippy/4.6.0+galaxy0",
    "toolshed.g2.bx.psu.edu/repos/iuc/snp_dists/snp_dists/0.6.3+galaxy0",
    "toolshed.g2.bx.psu.edu/repos/iuc/snp_dists/snp_dists/0.8.2+galaxy0",
    "toolshed.g2.bx.psu.edu/repos/iuc/snp_sites/snp_sites/2.5.1+galaxy0",
    "toolshed.g2.bx.psu.edu/repos/iuc/tb_variant_filter/tb_variant_filter/0.1.3+galaxy0",
    "toolshed.g2.bx.psu.edu/repos/iuc/tb_variant_filter/tb_variant_filter/0.3.5+galaxy2",
    "toolshed.g2.bx.psu.edu/repos/iuc/tb_variant_filter/tb_variant_filter/0.3.6+galaxy0",
    "toolshed.g2.bx.psu.edu/repos/iuc/tbprofiler/tb_profiler_profile/3.0.8+galaxy0",
    "toolshed.g2.bx.psu.edu/repos/mvdbeek/add_input_name_as_column/addName/0.2.0",
    "toolshed.g2.bx.psu.edu/repos/nml/collapse_collections/collapse_dataset/5.1.0",
    "toolshed.g2.bx.psu.edu/repos/pjbriggs/trimmomatic/trimmomatic/0.38.1",
    "upload1"
  ],
  "supported_servers": {
    "exact": [
      {
        "url": "https://usegalaxy.eu",
        "name": "UseGalaxy.eu",
        "usegalaxy": true
      }
    ],
    "inexact": [
      {
        "url": "https://usegalaxy.no/",
        "name": "UseGalaxy.no",
        "usegalaxy": false
      },
      {
        "url": "https://usegalaxy.org",
        "name": "UseGalaxy.org (Main)",
        "usegalaxy": true
      }
    ]
  },
  "topic_name_human": "Evolution",
  "admin_install": {
    "install_tool_dependencies": true,
    "install_repository_dependencies": true,
    "install_resolver_dependencies": true,
    "tools": [
      {
        "name": "text_processing",
        "owner": "bgruening",
        "revisions": "d698c222f354",
        "tool_panel_section_label": "Text Manipulation",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "text_processing",
        "owner": "bgruening",
        "revisions": "d698c222f354",
        "tool_panel_section_label": "Text Manipulation",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "text_processing",
        "owner": "bgruening",
        "revisions": "d698c222f354",
        "tool_panel_section_label": "Text Manipulation",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "text_processing",
        "owner": "bgruening",
        "revisions": "d698c222f354",
        "tool_panel_section_label": "Text Manipulation",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "text_processing",
        "owner": "bgruening",
        "revisions": "d698c222f354",
        "tool_panel_section_label": "Text Manipulation",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "bcftools_consensus",
        "owner": "iuc",
        "revisions": "147de996e34f",
        "tool_panel_section_label": "Variant Calling",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "bcftools_consensus",
        "owner": "iuc",
        "revisions": "a87ae767b01d",
        "tool_panel_section_label": "Variant Calling",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "samtools_view",
        "owner": "iuc",
        "revisions": "0dbf49c414ae",
        "tool_panel_section_label": "SAM/BAM",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "snippy",
        "owner": "iuc",
        "revisions": "c9a8ef2aa380",
        "tool_panel_section_label": "Variant Calling",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "snippy",
        "owner": "iuc",
        "revisions": "d220115f882b",
        "tool_panel_section_label": "Variant Calling",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "snp_dists",
        "owner": "iuc",
        "revisions": "1959cc43b414",
        "tool_panel_section_label": "Phylogenetics",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "snp_dists",
        "owner": "iuc",
        "revisions": "f78492521996",
        "tool_panel_section_label": "Phylogenetics",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "snp_sites",
        "owner": "iuc",
        "revisions": "5804f786060d",
        "tool_panel_section_label": "Phylogenetics",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "tb_variant_filter",
        "owner": "iuc",
        "revisions": "3b1e7c170b10",
        "tool_panel_section_label": "Annotation",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "tb_variant_filter",
        "owner": "iuc",
        "revisions": "e7aff4a85df5",
        "tool_panel_section_label": "Annotation",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "tb_variant_filter",
        "owner": "iuc",
        "revisions": "ee4a90760848",
        "tool_panel_section_label": "Annotation",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "tbprofiler",
        "owner": "iuc",
        "revisions": "809dfc93d593",
        "tool_panel_section_label": "Annotation",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "add_input_name_as_column",
        "owner": "mvdbeek",
        "revisions": "3284b72eef56",
        "tool_panel_section_label": "Text Manipulation",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "collapse_collections",
        "owner": "nml",
        "revisions": "90981f86000f",
        "tool_panel_section_label": "Collection Operations",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "trimmomatic",
        "owner": "pjbriggs",
        "revisions": "d94aff5ee623",
        "tool_panel_section_label": "FASTA/FASTQ",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      }
    ]
  },
  "admin_install_yaml": "---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: text_processing\n  owner: bgruening\n  revisions: d698c222f354\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: text_processing\n  owner: bgruening\n  revisions: d698c222f354\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: text_processing\n  owner: bgruening\n  revisions: d698c222f354\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: text_processing\n  owner: bgruening\n  revisions: d698c222f354\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: text_processing\n  owner: bgruening\n  revisions: d698c222f354\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bcftools_consensus\n  owner: iuc\n  revisions: 147de996e34f\n  tool_panel_section_label: Variant Calling\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bcftools_consensus\n  owner: iuc\n  revisions: a87ae767b01d\n  tool_panel_section_label: Variant Calling\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: samtools_view\n  owner: iuc\n  revisions: 0dbf49c414ae\n  tool_panel_section_label: SAM/BAM\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: snippy\n  owner: iuc\n  revisions: c9a8ef2aa380\n  tool_panel_section_label: Variant Calling\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: snippy\n  owner: iuc\n  revisions: d220115f882b\n  tool_panel_section_label: Variant Calling\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: snp_dists\n  owner: iuc\n  revisions: 1959cc43b414\n  tool_panel_section_label: Phylogenetics\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: snp_dists\n  owner: iuc\n  revisions: f78492521996\n  tool_panel_section_label: Phylogenetics\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: snp_sites\n  owner: iuc\n  revisions: 5804f786060d\n  tool_panel_section_label: Phylogenetics\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: tb_variant_filter\n  owner: iuc\n  revisions: 3b1e7c170b10\n  tool_panel_section_label: Annotation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: tb_variant_filter\n  owner: iuc\n  revisions: e7aff4a85df5\n  tool_panel_section_label: Annotation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: tb_variant_filter\n  owner: iuc\n  revisions: ee4a90760848\n  tool_panel_section_label: Annotation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: tbprofiler\n  owner: iuc\n  revisions: 809dfc93d593\n  tool_panel_section_label: Annotation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: add_input_name_as_column\n  owner: mvdbeek\n  revisions: 3284b72eef56\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: collapse_collections\n  owner: nml\n  revisions: 90981f86000f\n  tool_panel_section_label: Collection Operations\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: trimmomatic\n  owner: pjbriggs\n  revisions: d94aff5ee623\n  tool_panel_section_label: FASTA/FASTQ\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n",
  "tours": false,
  "video": false,
  "translations": {
    "tutorial": [

    ],
    "slides": [

    ],
    "video": false
  },
  "license": "CC-BY-4.0",
  "type": "tutorial",
  "contributors": [
    {
      "name": "Galo A. Goig",
      "joined": "2022-03",
      "id": "GaloGS",
      "url": "https://training.galaxyproject.org/training-material/api/contributors/GaloGS.json",
      "page": "https://training.galaxyproject.org/training-material/hall-of-fame/GaloGS/"
    },
    {
      "name": "Daniela Brites",
      "joined": "2022-03",
      "id": "dbrites",
      "url": "https://training.galaxyproject.org/training-material/api/contributors/dbrites.json",
      "page": "https://training.galaxyproject.org/training-material/hall-of-fame/dbrites/"
    },
    {
      "name": "Christoph Stritt",
      "joined": "2022-03",
      "id": "cstritt",
      "url": "https://training.galaxyproject.org/training-material/api/contributors/cstritt.json",
      "page": "https://training.galaxyproject.org/training-material/hall-of-fame/cstritt/"
    },
    {
      "name": "Wolfgang Maier",
      "orcid": "0000-0002-9464-6640",
      "matrix": "wm75:matrix.org",
      "joined": "2017-09",
      "elixir_node": "de",
      "fediverse": "https://scholar.social/@zerodivision",
      "fediverse_flavor": "mastodon",
      "affiliations": [
        "by-covid",
        "uni-freiburg"
      ],
      "id": "wm75",
      "url": "https://training.galaxyproject.org/training-material/api/contributors/wm75.json",
      "page": "https://training.galaxyproject.org/training-material/hall-of-fame/wm75/"
    }
  ]
}