{"layout":"tutorial_hands_on","title":"Converting NCBI Data to the AnnData Format","subtopic":"datamanipulation","priority":3,"zenodo_link":"https://zenodo.org/record/10101768","questions":["How do I understand NCBI data?","How can I convert raw gene data to the AnnData format?","How do I manually and automatically add metadata to my AnnData object?"],"objectives":["Analyse gene data from NCBI.","Convert raw gene expression data into the AnnData format.","Add metadata to the AnnData object to prepare it for analysis."],"time_estimation":"1H","key_points":["Single cell data often requires additional processing and conversion before it is able to be analysed.","Metadata and annotations can be added in both manually and automatically with various tools and resources."],"tags":["data management","data import"],"contributions":{"authorship":["hexhowells"],"editing":["nomadscientist","pavanvidem","mtekman","hexylena"],"testing":["pavanvidem"],"funding":["elixir-fair-data"]},"follow_up_training":[{"type":"internal","topic_name":"single-cell"}],"js_requirements":{"mathjax":null,"mermaid":false},"short_id":"T00380","url":"/topics/single-cell/tutorials/scrna-ncbi-anndata/tutorial.html","topic_name":"single-cell","tutorial_name":"scrna-ncbi-anndata","dir":"topics/single-cell/tutorials/scrna-ncbi-anndata","symlink":null,"id":"single-cell/scrna-ncbi-anndata","ref_tutorials":["<p>The goal of this tutorial is to take raw NCBI data from some published research, convert the raw data into the AnnData format then add metadata to the object so that it can be used for further processing / analysis. Here we will look at the steps to obtain, understand, and manipulate the data in order for it to be properly processed.</p>\n\n<p>The <a href=\"https://www.ncbi.nlm.nih.gov/\">NCBI Database</a> is a large repository for storing and accessing various types of biological data such as genome sequences, protein sequences, academic literature, etc. NCBI is a invaluable tool used for researchers and scientists, as a result it is important to know how to understand and utilise NCBI’s data resources.</p>\n\n<h1 id=\"obtaining-the-data\">Obtaining the Data</h1>\n\n<p>The first step is the obtain the data. For this tutorial, we will use data from the paper <span class=\"citation\"><a href=\"#Song2022\">Song <i>et al.</i> 2022</a></span>. The data for this research is stored in the Gene Expression Omnibus (GEO).</p>\n\n<blockquote class=\"notranslate hands_on gtn-cyoa\" id=\"gtn-cyoa\">\n\t<div class=\"box-title\" aria-label=\"hands-on box: choose your own tutorial\"><i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\"></span> Hands-on: Choose Your Own Tutorial</div>\n\t<p>This is a \"Choose Your Own Tutorial\" section, where you can select between multiple paths. Click one of the buttons below to select how you want to follow the tutorial</p>\n\t\n\t<p>\n\t\tIf you have experience finding and downloading data from GEO then you can use the Zenodo link to load the data directly into Galaxy, if you don't have experience with GEO then you can manually download, prepare, and load the data into Galaxy.\n\t</p>\n\t\n\t\n\t\t<input id=\"cyoa-opt1\" type=\"radio\" name=\"cyoa\" value=\"Manual\" onclick=\"cyoaChoice('Manual', 'gtn-cyoa')\" />\n\t\t<label for=\"cyoa-opt1\" class=\"select btn btn-secondary\">Manual</label>\n\t\n\t\n\t\t<input id=\"cyoa-opt2\" type=\"radio\" name=\"cyoa\" value=\"Zenodo\" onclick=\"cyoaChoice('Zenodo', 'gtn-cyoa')\" />\n\t\t<label for=\"cyoa-opt2\" class=\"select btn btn-secondary\">Zenodo</label>\n\t\n\t\n\t\n\n\t\n\t<script>\n\t\tfunction ready(fn) {\n\t\t\tif (document.readyState != 'loading'){\n\t\t\t\tfn();\n\t\t\t} else {\n\t\t\t\tdocument.addEventListener('DOMContentLoaded', fn);\n\t\t\t}\n\t\t}\n\t\tready(function() {\n\t\t\tcyoaDefault(\"Zenodo\", \"gtn-cyoa\");\n\t\t})\n\t</script>\n\t\n</blockquote>\n\n<div class=\"Manual\">\n  <blockquote class=\"hands_on\">\n    <hands-on-title>Download and extract the data from GEO</hands-on-title>\n\n    <ol>\n      <li>Using a web browser navigate to the GEO repository for the paper\n        <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE176031\n</code></pre></div>        </div>\n      </li>\n      <li>\n        <p>Copy the <code class=\"language-plaintext highlighter-rouge\">(http)</code> link located in the supplemental materials section of the page</p>\n      </li>\n      <li>\n        <p>Import the data into Galaxy</p>\n\n        <!--SNIPPET-->\n        <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-via-links\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-via-links\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing via links</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>\n        <p><!--END_SNIPPET--></p>\n      </li>\n      <li>\n        <p>Change the datatype to <code class=\"language-plaintext highlighter-rouge\">tar</code></p>\n\n        <!--SNIPPET-->\n        <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-changing-the-datatype\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-changing-the-datatype\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Changing the datatype</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, click <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Datatypes</strong> tab on the top</li>   <li>In the <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Assign Datatype</strong>, select <code class=\"language-plaintext highlighter-rouge\">tar</code> from “<em>New type</em>” dropdown     <ul>       <li>Tip: you can start typing the datatype into the field to filter the dropdown menu</li>     </ul>   </li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n        <p><!--END_SNIPPET--></p>\n      </li>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/imgteam/unzip/unzip/6.0+galaxy0\" title=\"Unzip tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Unzip</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 6.0+galaxy0)</span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“input_file”</em>: <code class=\"language-plaintext highlighter-rouge\">tar</code> file you just imported</li>\n        </ul>\n      </li>\n    </ol>\n  </blockquote>\n</div>\n\n<div class=\"Zenodo\">\n  <blockquote class=\"hands_on\">\n    <hands-on-title>Downloading the data from Zenodo</hands-on-title>\n\n    <ol>\n      <li>Create a new history for this tutorial</li>\n      <li>\n        <p>Import the following files from <a href=\"https://zenodo.org/record/10101768\">Zenodo</a></p>\n\n        <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/10101768/files/GSM5353214_PA_AUG_PB_1A_S1_dge.txt\nhttps://zenodo.org/record/10101768/files/GSM5353215_PA_AUG_PB_1B_S2_dge.txt\nhttps://zenodo.org/record/10101768/files/GSM5353216_PA_PB1A_Pool_1_3_S50_L002_dge.txt\nhttps://zenodo.org/record/10101768/files/GSM5353217_PA_PB1A_Pool_2_S107_L004_dge.txt\nhttps://zenodo.org/record/10101768/files/GSM5353218_PA_PB1B_Pool_1_2_S74_L003_dge.txt\nhttps://zenodo.org/record/10101768/files/GSM5353219_PA_PB1B_Pool_2_S24_L001_dge.txt\nhttps://zenodo.org/record/10101768/files/GSM5353220_PA_PB1B_Pool_3_S51_L002_dge.txt\nhttps://zenodo.org/record/10101768/files/GSM5353221_PA_PB2A_Pool_1_3_S25_L001_dge.txt\nhttps://zenodo.org/record/10101768/files/GSM5353222_PA_PB2B_Pool_1_3_S52_L002_dge.txt\nhttps://zenodo.org/record/10101768/files/GSM5353223_PA_PB2B_Pool_2_S26_L001_dge.txt\n</code></pre></div>        </div>\n\n        <!--SNIPPET-->\n        <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-via-links-1\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-via-links-1\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing via links</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>\n        <p><!--END_SNIPPET--></p>\n      </li>\n      <li>\n        <p>Check that the datatype is <code class=\"language-plaintext highlighter-rouge\">tabular</code></p>\n\n        <!--SNIPPET-->\n        <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-changing-the-datatype-1\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-changing-the-datatype-1\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Changing the datatype</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, click <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Datatypes</strong> tab on the top</li>   <li>In the <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Assign Datatype</strong>, select <code class=\"language-plaintext highlighter-rouge\">tabular</code> from “<em>New type</em>” dropdown     <ul>       <li>Tip: you can start typing the datatype into the field to filter the dropdown menu</li>     </ul>   </li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n        <p><!--END_SNIPPET--></p>\n      </li>\n    </ol>\n\n  </blockquote>\n</div>\n\n<p>We now have the raw gene expression data that we will process. However, we will need to manually add some metadata, which requires finding out some more information about our files.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Finding the metadata</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Follow  the link for the paper (<a href=\"https://pubmed.ncbi.nlm.nih.gov/35013146/\">https://pubmed.ncbi.nlm.nih.gov/35013146/</a>), where you can see a link for accessing the full text. Accessing the full text takes us the following page <a href=\"https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8748675/\">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8748675/</a></p>\n    </li>\n    <li>\n      <p>Downloading the paper and looking under <strong>Methods</strong> we can see that there are 2 biopsy samples for patients 1-3. For this tutorial we will be processing the first 3 patient’s data, therefore we will need to find more information about the biopsy samples.</p>\n    </li>\n  </ol>\n  <figure id=\"figure-1\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-ncbi-anndata/patient_samples_paper.png\" alt=\"Snippet of paper about patient biopsies. \" width=\"587\" height=\"225\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-ncbi-anndata/patient_samples_paper.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 1</strong>:</span> Snippet of paper about patient biopsies</figcaption></figure>\n\n  <ol>\n    <li>\n      <p>On the NCBI page containing the paper we can scroll down to see a <strong>Supplementary Materials</strong> section. Under this section we should see various <code class=\"language-plaintext highlighter-rouge\">.xlsx</code> files (Excel spreadsheets). These will contain metadata about the work done in the paper.</p>\n    </li>\n    <li>\n      <p>Looking through each file we can eventually find the spreadsheet <code class=\"language-plaintext highlighter-rouge\">41467_2021_27322_MOESM2_ESM.xlsx</code> which contains information about each patient including the biopsy sample IDs and tumor specimens. So we will want to download this in order to extract out the required information!</p>\n    </li>\n  </ol>\n\n  <figure id=\"figure-2\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-ncbi-anndata/clinical_info_spreadsheet.png\" alt=\"Snippet of clinical info. \" width=\"1206\" height=\"205\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-ncbi-anndata/clinical_info_spreadsheet.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 2</strong>:</span> Snippet of clinical info</figcaption></figure>\n\n  <ol>\n    <li>Download Supplementary Dataset 1 (<code class=\"language-plaintext highlighter-rouge\">41467_2021_27322_MOESM2_ESM.xlsx</code>).</li>\n  </ol>\n\n</blockquote>\n\n<p>This one spreadsheet contains all the information we need to further understand our data.</p>\n\n<h2 id=\"understanding-the-data\">Understanding the Data</h2>\n\n<p>If we look at that excel file <code class=\"language-plaintext highlighter-rouge\">41467_2021_27322_MOESM2_ESM.xlsx</code>, we can see multiple sheets.</p>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>How many different patients are in this study?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>Navigating to <code class=\"language-plaintext highlighter-rouge\">Clinical_info</code> shows us that the data consists of 11 different patients, with some patients having multiple different samples of different tumor specimens.</li>\n    </ol>\n\n  </blockquote>\n</blockquote>\n\n<p>For this tutorial, we are only going to process the first 3 patients. A summary of the relevant data can be seen below:</p>\n\n<table>\n  <thead>\n    <tr>\n      <th style=\"text-align: left\">PatientID</th>\n      <th style=\"text-align: left\">Biopsy samples</th>\n      <th style=\"text-align: left\">Tumor Specimen</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td style=\"text-align: left\">Patient 1</td>\n      <td style=\"text-align: left\">AUG_PB1A</td>\n      <td style=\"text-align: left\">left-mid</td>\n    </tr>\n    <tr>\n      <td style=\"text-align: left\"> </td>\n      <td style=\"text-align: left\">AUG_PB1B</td>\n      <td style=\"text-align: left\">right-mid</td>\n    </tr>\n    <tr>\n      <td style=\"text-align: left\">Patient 2</td>\n      <td style=\"text-align: left\">MAY_PB1A</td>\n      <td style=\"text-align: left\">right-mid</td>\n    </tr>\n    <tr>\n      <td style=\"text-align: left\"> </td>\n      <td style=\"text-align: left\">MAY_PB1B</td>\n      <td style=\"text-align: left\">right-apex</td>\n    </tr>\n    <tr>\n      <td style=\"text-align: left\">Patient 3</td>\n      <td style=\"text-align: left\">MAY_PB2A</td>\n      <td style=\"text-align: left\">right-anterior</td>\n    </tr>\n    <tr>\n      <td style=\"text-align: left\"> </td>\n      <td style=\"text-align: left\">MAY_PB2B</td>\n      <td style=\"text-align: left\">right-mid</td>\n    </tr>\n  </tbody>\n</table>\n\n<p>We can see that each patient has 2 different samples from different tumor locations. This is important information that needs to be added to our dataset so that we can separate it during analysis, if needed.</p>\n\n<p>Unfortunately, the names of the files don’t exactly match the data in our excel sheet. This can make finding the right samples a bit difficult! A summary of which samples match which file can be found below:</p>\n\n<ul>\n  <li><strong>AUG_PB1A</strong> —&gt; <strong>PA_AUG_PB_1A</strong></li>\n  <li><strong>AUG_PB1B</strong> —&gt; <strong>PA_AUG_PB_1B</strong></li>\n  <li><strong>MAY_PB1A</strong> —&gt; <strong>PA_PB1A</strong></li>\n  <li><strong>MAY_PB1B</strong> —&gt; <strong>PA_PB1B</strong></li>\n  <li><strong>MAY_PB2A</strong> —&gt; <strong>PA_PB2A</strong></li>\n  <li><strong>MAY_PB2B</strong> —&gt; <strong>PA_PB2B</strong></li>\n</ul>\n\n<p>You may also notice that we have multiple sample files with the same name suffixed with <code class=\"language-plaintext highlighter-rouge\">_Pool_X</code>. These are <em>replicates</em>, where multiple samples are taken of the same tumor area in order to get a more comprehensive view of the gene data of the tumor. We will need to combine these replicates during processing.</p>\n\n<p>These replicate files can be confirmed by looking under the <strong>Methods</strong> section of the paper where it states that one to four arrays were used per sample.</p>\n\n<figure id=\"figure-3\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-ncbi-anndata/replicates_paper.png\" alt=\"Snippet of paper about sample arrays. \" width=\"483\" height=\"100\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-ncbi-anndata/replicates_paper.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 3</strong>:</span> Snippet of paper about sample arrays</figcaption></figure>\n\n<div class=\"Manual\">\n\n  <p>We now need to find the files relating to each patient. Selecting the output <i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <strong>Unzip</strong> tool shows you 53 files in a <i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> dataset collection. We will work with the 10 files associated with our target patients.</p>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title>Unhiding 10 target files</hands-on-title>\n\n    <ol>\n      <li>\n        <p>In the <i class=\"fas fa-columns\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-history</span> Galaxy history panel, select the <em>Include hidden</em> icon <i class=\"fas fa-eye-slash\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-show-hidden</span> to see the 53 files in your dataset collection.</p>\n      </li>\n      <li>Scroll down to visualise the following 10 samples (likely in opposite order to this!):\n        <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>GSM5353214_PA_AUG_PB_1A_S1_dge.txt\nGSM5353215_PA_AUG_PB_1B_S2_dge.txt\nGSM5353216_PA_PB1A_Pool_1_3_S50_L002_dge.txt\nGSM5353217_PA_PB1A_Pool_2_S107_L004_dge.txt\nGSM5353218_PA_PB1B_Pool_1_2_S74_L003_dge.txt\nGSM5353219_PA_PB1B_Pool_2_S24_L001_dge.txt\nGSM5353220_PA_PB1B_Pool_3_S51_L002_dge.txt\nGSM5353221_PA_PB2A_Pool_1_3_S25_L001_dge.txt\nGSM5353222_PA_PB2B_Pool_1_3_S52_L002_dge.txt\nGSM5353223_PA_PB2B_Pool_2_S26_L001_dge.txt\n</code></pre></div>        </div>\n      </li>\n      <li>\n        <p>For each of those 10 samples, select the <em>Unhide</em> icon <i class=\"fas fa-eye-slash\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-show-hidden</span>. This will move them from <i class=\"fas fa-eye-slash\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-show-hidden</span> <em>Hidden</em> to <em>Active</em>.</p>\n      </li>\n      <li>\n        <p>Navigate back to the <i class=\"fa fa-map-marker\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-show-active</span> <em>Active</em> datasets list, where you will now see your 10 target samples.</p>\n      </li>\n      <li>\n        <p>In the <i class=\"fas fa-columns\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-history</span> Galaxy history panel, click the <i class=\"far fa-check-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-selector</span> <em>Select items</em> to allow you to select multiple datasets from your history</p>\n      </li>\n      <li>\n        <p>Select all 10 samples</p>\n      </li>\n      <li>\n        <p>Select the highlighted rectangle <code class=\"language-plaintext highlighter-rouge\">10 of X</code> (the X may be different depending on what you’ve imported!) to give you a menu, from which you select <code class=\"language-plaintext highlighter-rouge\">Change data type</code></p>\n      </li>\n      <li>Select the dropdown menu and either type in or scroll to find <code class=\"language-plaintext highlighter-rouge\">tabular.gz</code></li>\n    </ol>\n\n  </blockquote>\n</div>\n\n<h1 id=\"creating-the-anndata-object\">Creating the AnnData object</h1>\n\n<p>The next step is to convert all of the raw files into AnnData objects, this can be done one at a time or all at once by selecting <code class=\"language-plaintext highlighter-rouge\">multiple datasets</code> when choosing the input and highlighting all the raw data files.</p>\n\n<blockquote class=\"tip\">\n  <tip-title>Tag your datasets</tip-title>\n  <p>Before starting to process the data, it is generally a good idea to add tags to each sample in order to keep track of what data is being processed. Below is some of the imported data with added tags for the patient and sample id. We suggest you replicate this in your history.</p>\n\n  <figure id=\"figure-4\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-ncbi-anndata/metadata.png\" alt=\"Imported data with tags. \" width=\"498\" height=\"793\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-ncbi-anndata/metadata.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 4</strong>:</span> Imported data with tags</figcaption></figure>\n\n</blockquote>\n<!--SNIPPET-->\n<blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-adding-a-tag\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-adding-a-tag\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Adding a tag</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ol>   <li>Click on the dataset to expand it</li>   <li>Click on <strong>Add Tags</strong> <i class=\"fas fa-tags\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-tags</span></li>   <li>Add a tag  starting with <code class=\"language-plaintext highlighter-rouge\">#</code>     <ul>       <li>Tags starting with <code class=\"language-plaintext highlighter-rouge\">#</code> will be automatically propagated to the outputs of tools using this dataset.</li>     </ul>   </li>   <li>Press <kbd>Enter</kbd></li>   <li>Check that the tag appears below the dataset name</li> </ol> </blockquote>\n<p><!--END_SNIPPET--></p>\n<blockquote class=\"hands_on\">\n  <hands-on-title>Convert raw data to AnnData</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/anndata_import/anndata_import/0.7.5+galaxy1\" title=\"Import AnnData and loom tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Import AnnData and loom</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.7.5+galaxy1)</span> with the following parameters:\n      <ul>\n        <li><em>“hd5 format to be created”</em>: <code class=\"language-plaintext highlighter-rouge\">Anndata file</code>\n          <ul>\n            <li><em>“Format for the annotated data matrix?”</em>: <code class=\"language-plaintext highlighter-rouge\">Tabular, CSV, TSV</code></li>\n            <li><em>“Annotated data matrix”</em>\n              <ul>\n                <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>Multiple datasets</em>: <code class=\"language-plaintext highlighter-rouge\">Select all imported files</code></li>\n              </ul>\n            </li>\n            <li><em>“Does the first column store the row names?”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.7.5+galaxy1\" title=\"Inspect AnnData tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Inspect AnnData</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.7.5+galaxy1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">select any one of the AnnData files</code></li>\n        <li><em>“What to inspect?”</em>: <code class=\"language-plaintext highlighter-rouge\">Key-indexed observations annotation (obs)</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>Examine <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> the <i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Inspect AnnData”</em> output. You will find a list of genes - however, the <code class=\"language-plaintext highlighter-rouge\">obs</code> (observations) layer in the AnnData object should store cell data. The <code class=\"language-plaintext highlighter-rouge\">var</code> (variables) should store the genes data. We need to transpose all of our AnnData objects. We will speed up the process by selecting all of the AnnData objects and processing them at once.</p>\n\n<blockquote class=\"comment\">\n  <comment-title>Check your data</comment-title>\n  <p>Whilst for this specific data, the object needed to be transposed, this won’t always be the case! The easiest way is to check the <code class=\"language-plaintext highlighter-rouge\">obs</code> data of the AnnData object using the <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> <strong>Inspect AnnData</strong> tool. The <i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <code class=\"language-plaintext highlighter-rouge\">obs</code> file should have a column containing short nucleotide sequences (something like <strong>CGGAAGTGATAC</strong>). If that’s the case, then the data doesn’t need to be transposed, because those are the cell barcodes!</p>\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Transpose AnnData objects</hands-on-title>\n\n  <ol>\n    <li>\n      <p><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/anndata_manipulate/anndata_manipulate/0.7.5+galaxy1\" title=\"Manipulate AnnData tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Manipulate AnnData</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.7.5+galaxy1)</span> with the following parameters:</p>\n\n      <ul>\n        <li><em>“Annotated data matrix”</em>\n          <ul>\n            <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>Multiple datasets</em>: <code class=\"language-plaintext highlighter-rouge\">Select all AnnData files</code></li>\n          </ul>\n        </li>\n        <li><em>“Function to manipulate the object”</em>: <code class=\"language-plaintext highlighter-rouge\">Transpose the data matrix, leaving observations and variables interchanged</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>Now, we have all the AnnData objects with the data in the correct orientation. We can combine them into a single AnnData object, which will make the data easier to work with. This combination operation will add an additional column called <code class=\"language-plaintext highlighter-rouge\">batch</code> which tells us which AnnData object each bit of data came from. This will be useful for further processing!</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Combine AnnData objects</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/anndata_manipulate/anndata_manipulate/0.7.5+galaxy1\" title=\"Manipulate AnnData tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Manipulate AnnData</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.7.5+galaxy1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Select first Manipulate AnnData (transpose) output</code></li>\n        <li><em>“Function to manipulate the object”</em>: <code class=\"language-plaintext highlighter-rouge\">Concatenate along the observations axis</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix to add”</em>: <code class=\"language-plaintext highlighter-rouge\">Select all other Manipulate AnnData (transpose) outputs</code></li>\n            <li><em>“Join method”</em>: <code class=\"language-plaintext highlighter-rouge\">Intersection of variables</code></li>\n            <li><em>“Key to add the batch annotation to obs”</em>: <code class=\"language-plaintext highlighter-rouge\">batch</code></li>\n            <li><em>“Separator to join the existing index names with the batch category”</em>: <code class=\"language-plaintext highlighter-rouge\">-</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> output <code class=\"language-plaintext highlighter-rouge\">Combined Object</code></li>\n  </ol>\n\n</blockquote>\n\n<p>Now we have all of our gene expression data stored in a single AnnData object! We just need to add our metadata!</p>\n\n<h1 id=\"annotating-the-data\">Annotating the data</h1>\n\n<p>The next step is to annotate our data using the information gathered from the excel sheet earlier. We will do this by leveraging the <code class=\"language-plaintext highlighter-rouge\">batch</code> column generated when the objects were combined for each individual patient/sample (indicated by the batch number). We will add in the relevant annotations. First, let’s extract the observation data so we can manipulate it.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title></hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.7.5+galaxy1\" title=\"Inspect AnnData tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Inspect AnnData</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.7.5+galaxy1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Combined Object</code></li>\n        <li><em>“What to inspect?”</em>: <code class=\"language-plaintext highlighter-rouge\">Key-indexed observations annotation (obs)</code></li>\n      </ul>\n    </li>\n    <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> output <code class=\"language-plaintext highlighter-rouge\">Observation data</code></li>\n  </ol>\n\n</blockquote>\n\n<p>For each new column, we need to replace the relevant batch numbers with the appropriate metadata. After that, we can cut the modified column out so it is separated. We will repeat this process for each piece of metadata we want to add. All the relevant data can be found in the first table of this tutorial.</p>\n\n<p>Let’s now add the replicate column which tells us which cells are part of pools of the same patient and tumor location.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Create replicate metadata</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_replace_in_column/1.1.3\" title=\"Replace Text tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Replace Text</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.1.3)</span> <em>in a specific column</em> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“File to process”</em>: <code class=\"language-plaintext highlighter-rouge\">Observation data</code></li>\n        <li><em>“1: Replacement”</em>\n          <ul>\n            <li><em>“in column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 2</code></li>\n            <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">2|4|7|8</code></li>\n            <li><em>“Replace with”</em>: <code class=\"language-plaintext highlighter-rouge\">poolA</code></li>\n          </ul>\n        </li>\n        <li><strong>+ Insert Replacement</strong></li>\n        <li><em>“2: Replacement”</em>\n          <ul>\n            <li><em>“in column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 2</code></li>\n            <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">3|5|9</code></li>\n            <li><em>“Replace with”</em>: <code class=\"language-plaintext highlighter-rouge\">poolB</code></li>\n          </ul>\n        </li>\n        <li><strong>+ Insert Replacement</strong></li>\n        <li><em>“3: Replacement”</em>\n          <ul>\n            <li><em>“in column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 2</code></li>\n            <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">6</code></li>\n            <li><em>“Replace with”</em>: <code class=\"language-plaintext highlighter-rouge\">poolC</code></li>\n          </ul>\n        </li>\n        <li><strong>+ Insert Replacement</strong></li>\n        <li><em>“4: Replacement”</em>\n          <ul>\n            <li><em>“in column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 2</code></li>\n            <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">0|1</code></li>\n            <li><em>“Replace with”</em>: <code class=\"language-plaintext highlighter-rouge\">NA</code></li>\n          </ul>\n        </li>\n        <li><strong>+ Insert Replacement</strong></li>\n        <li><em>“5: Replacement”</em>\n          <ul>\n            <li><em>“in column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 2</code></li>\n            <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">batch</code></li>\n            <li><em>“Replace with”</em>: <code class=\"language-plaintext highlighter-rouge\">replicate</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"Cut1\" title=\"Cut tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Cut</strong></span> with the following parameters:\n      <ul>\n        <li><em>“Cut columns”</em>: <code class=\"language-plaintext highlighter-rouge\">c2</code></li>\n        <li><em>“Delimited by”</em>: <code class=\"language-plaintext highlighter-rouge\">Tab</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“From”</em>: <code class=\"language-plaintext highlighter-rouge\">output of Replace Text</code></li>\n      </ul>\n    </li>\n    <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> output <code class=\"language-plaintext highlighter-rouge\">Replicate Metadata</code></li>\n  </ol>\n\n</blockquote>\n\n<p>Next we will add the metadata indicating which patient each row came from.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Create patient data</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_replace_in_column/1.1.3\" title=\"Replace Text tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Replace Text</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.1.3)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“File to process”</em>: <code class=\"language-plaintext highlighter-rouge\">Observation data</code></li>\n        <li><em>“1: Replacement”</em>\n          <ul>\n            <li><em>“in column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 2</code></li>\n            <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">0|1</code></li>\n            <li><em>“Replace with”</em>: <code class=\"language-plaintext highlighter-rouge\">patient1</code></li>\n          </ul>\n        </li>\n        <li><strong>+ Insert Replacement</strong></li>\n        <li><em>“2: Replacement”</em>\n          <ul>\n            <li><em>“in column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 2</code></li>\n            <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">2|3|4|5|6</code></li>\n            <li><em>“Replace with”</em>: <code class=\"language-plaintext highlighter-rouge\">patient2</code></li>\n          </ul>\n        </li>\n        <li><strong>+ Insert Replacement</strong></li>\n        <li><em>“3: Replacement”</em>\n          <ul>\n            <li><em>“in column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 2</code></li>\n            <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">7|8|9</code></li>\n            <li><em>“Replace with”</em>: <code class=\"language-plaintext highlighter-rouge\">patient3</code></li>\n          </ul>\n        </li>\n        <li><strong>+ Insert Replacement</strong></li>\n        <li><em>“5: Replacement”</em>\n          <ul>\n            <li><em>“in column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 2</code></li>\n            <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">batch</code></li>\n            <li><em>“Replace with”</em>: <code class=\"language-plaintext highlighter-rouge\">patient</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"Cut1\" title=\"Cut tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Cut</strong></span> with the following parameters:\n      <ul>\n        <li><em>“Cut columns”</em>: <code class=\"language-plaintext highlighter-rouge\">c2</code></li>\n        <li><em>“Delimited by”</em>: <code class=\"language-plaintext highlighter-rouge\">Tab</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“From”</em>: <code class=\"language-plaintext highlighter-rouge\">output of Replace Text</code></li>\n      </ul>\n    </li>\n    <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> output <code class=\"language-plaintext highlighter-rouge\">Patient Metadata</code></li>\n  </ol>\n\n</blockquote>\n\n<p>We will now add a column to indicate which sample each row came from using the sample ID’s described earlier.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Create sample ID metadata</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_replace_in_column/1.1.3\" title=\"Replace Text tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Replace Text</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.1.3)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“File to process”</em>: <code class=\"language-plaintext highlighter-rouge\">Observation data</code></li>\n        <li><em>“1: Replacement”</em>\n          <ul>\n            <li><em>“in column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 2</code></li>\n            <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">0</code></li>\n            <li><em>“Replace with”</em>: <code class=\"language-plaintext highlighter-rouge\">AUG_PB1A</code></li>\n          </ul>\n        </li>\n        <li><strong>+ Insert Replacement</strong></li>\n        <li><em>“2: Replacement”</em>\n          <ul>\n            <li><em>“in column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 2</code></li>\n            <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">1$</code></li>\n            <li><em>“Replace with”</em>: <code class=\"language-plaintext highlighter-rouge\">AUG_PB1B</code></li>\n          </ul>\n        </li>\n        <li><strong>+ Insert Replacement</strong></li>\n        <li><em>“3: Replacement”</em>\n          <ul>\n            <li><em>“in column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 2</code></li>\n            <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">(2$)|3</code></li>\n            <li><em>“Replace with”</em>: <code class=\"language-plaintext highlighter-rouge\">MAY_PB1A</code></li>\n          </ul>\n        </li>\n        <li><strong>+ Insert Replacement</strong></li>\n        <li><em>“4: Replacement”</em>\n          <ul>\n            <li><em>“in column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 2</code></li>\n            <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">4|5|6</code></li>\n            <li><em>“Replace with”</em>: <code class=\"language-plaintext highlighter-rouge\">MAY_PB1B</code></li>\n          </ul>\n        </li>\n        <li><strong>+ Insert Replacement</strong></li>\n        <li><em>“5: Replacement”</em>\n          <ul>\n            <li><em>“in column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 2</code></li>\n            <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">7</code></li>\n            <li><em>“Replace with”</em>: <code class=\"language-plaintext highlighter-rouge\">MAY_PB2A</code></li>\n          </ul>\n        </li>\n        <li><strong>+ Insert Replacement</strong></li>\n        <li><em>“6: Replacement”</em>\n          <ul>\n            <li><em>“in column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 2</code></li>\n            <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">8|9</code></li>\n            <li><em>“Replace with”</em>: <code class=\"language-plaintext highlighter-rouge\">MAY_PB2B</code></li>\n          </ul>\n        </li>\n        <li><strong>+ Insert Replacement</strong></li>\n        <li><em>“7: Replacement”</em>\n          <ul>\n            <li><em>“in column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 2</code></li>\n            <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">batch</code></li>\n            <li><em>“Replace with”</em>: <code class=\"language-plaintext highlighter-rouge\">specimenID</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"Cut1\" title=\"Cut tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Cut</strong></span> with the following parameters:\n      <ul>\n        <li><em>“Cut columns”</em>: <code class=\"language-plaintext highlighter-rouge\">c2</code></li>\n        <li><em>“Delimited by”</em>: <code class=\"language-plaintext highlighter-rouge\">Tab</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“From”</em>: <code class=\"language-plaintext highlighter-rouge\">output of Replace Text</code></li>\n      </ul>\n    </li>\n    <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> output <code class=\"language-plaintext highlighter-rouge\">Specimen Metadata</code></li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"details\">\n  <details-title>$ parameter</details-title>\n  <p>You may have noticed that some of the parameters in the previous tool used the $ symbol. This is due to how the <span><strong>Replace Text</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i></span> tool works. The tool will replace and <strong>update</strong> the data for every insert operation, meaning that lines that have already been updated could be updated again.</p>\n\n  <p>Since we are replacing our batch ID’s with identifiers that include numbers, we want to prevent them from being updated again. Appending the pattern with the <code class=\"language-plaintext highlighter-rouge\">$</code> symbol tells the tool to only replace the pattern if it is not followed by any other character (so the 1 in <code class=\"language-plaintext highlighter-rouge\">AUG_PB1A</code> won’t be replaced as it is followed by an ‘A’).</p>\n</blockquote>\n\n<p>Finally we will add the tumor column which indicates which tumor sample each row belongs to.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Create tumor metadata</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_replace_in_column/1.1.3\" title=\"Replace Text tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Replace Text</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.1.3)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“File to process”</em>: <code class=\"language-plaintext highlighter-rouge\">Observation data</code></li>\n        <li><em>“1: Replacement”</em>\n          <ul>\n            <li><em>“in column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 2</code></li>\n            <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">0</code></li>\n            <li><em>“Replace with”</em>: <code class=\"language-plaintext highlighter-rouge\">left-mid</code></li>\n          </ul>\n        </li>\n        <li><strong>+ Insert Replacement</strong></li>\n        <li><em>“2: Replacement”</em>\n          <ul>\n            <li><em>“in column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 2</code></li>\n            <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">1|2|3|8|9</code></li>\n            <li><em>“Replace with”</em>: <code class=\"language-plaintext highlighter-rouge\">right-mid</code></li>\n          </ul>\n        </li>\n        <li><strong>+ Insert Replacement</strong></li>\n        <li><em>“3: Replacement”</em>\n          <ul>\n            <li><em>“in column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 2</code></li>\n            <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">4|5|6</code></li>\n            <li><em>“Replace with”</em>: <code class=\"language-plaintext highlighter-rouge\">right-apex</code></li>\n          </ul>\n        </li>\n        <li><strong>+ Insert Replacement</strong></li>\n        <li><em>“4: Replacement”</em>\n          <ul>\n            <li><em>“in column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 2</code></li>\n            <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">7</code></li>\n            <li><em>“Replace with”</em>: <code class=\"language-plaintext highlighter-rouge\">right-anterior</code></li>\n          </ul>\n        </li>\n        <li><strong>+ Insert Replacement</strong></li>\n        <li><em>“5: Replacement”</em>\n          <ul>\n            <li><em>“in column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 2</code></li>\n            <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">batch</code></li>\n            <li><em>“Replace with”</em>: <code class=\"language-plaintext highlighter-rouge\">tumorSpecimen</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"Cut1\" title=\"Cut tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Cut</strong></span> with the following parameters:\n      <ul>\n        <li><em>“Cut columns”</em>: <code class=\"language-plaintext highlighter-rouge\">c2</code></li>\n        <li><em>“Delimited by”</em>: <code class=\"language-plaintext highlighter-rouge\">Tab</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“From”</em>: <code class=\"language-plaintext highlighter-rouge\">output of Replace Text</code></li>\n      </ul>\n    </li>\n    <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> output <code class=\"language-plaintext highlighter-rouge\">Tumor Metadata</code></li>\n  </ol>\n\n</blockquote>\n\n<p>With all the individual metadata columns created, we can now combine them together to make a single tabular file containing our metadata. Since the <code class=\"language-plaintext highlighter-rouge\">Paste</code> operation only allows us to combine two columns at once we will need to run the tool a few times to add all the columns together.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Combine metadata</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"Paste1\" title=\"Paste tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Paste</strong></span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Paste”</em>: <code class=\"language-plaintext highlighter-rouge\">Replicate Metadata</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“and”</em>: <code class=\"language-plaintext highlighter-rouge\">Patient Metadata</code></li>\n        <li><em>“Delimit by”</em>: <code class=\"language-plaintext highlighter-rouge\">Tab</code></li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"Paste1\" title=\"Paste tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Paste</strong></span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Paste”</em>: <code class=\"language-plaintext highlighter-rouge\">Output of previous Paste</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“and”</em>: <code class=\"language-plaintext highlighter-rouge\">Specimen Metadata</code></li>\n        <li><em>“Delimit by”</em>: <code class=\"language-plaintext highlighter-rouge\">Tab</code></li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"Paste1\" title=\"Paste tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Paste</strong></span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Paste”</em>: <code class=\"language-plaintext highlighter-rouge\">Output of previous Paste</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“and”</em>: <code class=\"language-plaintext highlighter-rouge\">Tumor Metadata</code></li>\n        <li><em>“Delimit by”</em>: <code class=\"language-plaintext highlighter-rouge\">Tab</code></li>\n      </ul>\n    </li>\n    <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> output <code class=\"language-plaintext highlighter-rouge\">Cell Metadata</code></li>\n  </ol>\n\n</blockquote>\n\n<p>After processing the <code class=\"language-plaintext highlighter-rouge\">Cell Metadata</code> table should look like the following:</p>\n\n<figure id=\"figure-5\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-ncbi-anndata/cell_metadata.png\" alt=\"Cell Metadata Table. \" width=\"1157\" height=\"525\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-ncbi-anndata/cell_metadata.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 5</strong>:</span> Cell Metadata Table</figcaption></figure>\n\n<p>With the metadata table ready, we can add it to our original combined object!</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Add metadata to AnnData object</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/anndata_manipulate/anndata_manipulate/0.7.5+galaxy1\" title=\"Manipulate AnnData tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Manipulate AnnData</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.7.5+galaxy1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Combined Object</code></li>\n        <li><em>“Function to manipulate the object”</em>: <code class=\"language-plaintext highlighter-rouge\">Add new annotation(s) for observations of variables</code>\n          <ul>\n            <li><em>“What to annotate?”</em>: <code class=\"language-plaintext highlighter-rouge\">Observations (obs)</code></li>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Table with new annotations”</em>: <code class=\"language-plaintext highlighter-rouge\">Cell Metadata</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> output <code class=\"language-plaintext highlighter-rouge\">Annotated Object</code></li>\n  </ol>\n\n</blockquote>\n\n<p><i class=\"far fa-thumbs-up\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">congratulations</span> Congratulations! You have successfully interpreted the milieu of files in a published dataset, transformed the data into a usable format, and added all the relevant annotations to the AnnData object! All that’s left to do is to add some quality control metrics using automated tools!</p>\n\n<h1 id=\"adding-quality-control-metrics\">Adding quality control metrics</h1>\n\n<p>With the manual annotations added, we need to do some further processing to add some statistical metadata about the genes. This is done automatically by running two different tools.</p>\n\n<p>First, we will run the <code class=\"language-plaintext highlighter-rouge\">Scanpy FilterCells</code> tool without actually filtering. This tool will add some metadata about the counts and numbers of expressed genes.</p>\n\n<blockquote class=\"warning\">\n  <warning-title>Scanpy FilterCells version issue</warning-title>\n  <p>The <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_filter_cells/scanpy_filter_cells/1.8.1+galaxy9\" title=\"Scanpy FilterCells tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Scanpy FilterCells</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.8.1+galaxy9)</span> tool (used below) does not work in the latest version (<strong>1.8.1+galaxy93</strong>), switch to version <strong>1.8.1+galaxy9</strong> in order to run the tool without error.</p>\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Add initial metadata</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_filter_cells/scanpy_filter_cells/1.8.1+galaxy9\" title=\"Scanpy FilterCells tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Scanpy FilterCells</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.8.1+galaxy9)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in AnnData/Loom format”</em>: <code class=\"language-plaintext highlighter-rouge\">Annotated Object</code></li>\n        <li><em>“Name of the column in <code class=\"language-plaintext highlighter-rouge\">anndata.var</code> that contains gene name”</em>: <code class=\"language-plaintext highlighter-rouge\">_index</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>The final tool, <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> <strong>AnnData Operations</strong>, will add the rest of our metadata. This is mostly information about the mitochondrial genes present in the object, roughly counted by flagging genes that start with <strong>MT-</strong>.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Add final metadata</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/anndata_ops/anndata_ops/1.8.1+galaxy9\" title=\"AnnData Operations tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>AnnData Operations</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.8.1+galaxy9)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in hdf5 AnnData format”</em>: <code class=\"language-plaintext highlighter-rouge\">Output of Scanpy FilterCells</code></li>\n        <li><strong>+ Insert Flag genes that start with these names</strong></li>\n        <li><em>“1: Parameters to select cells to keep”</em>\n          <ul>\n            <li><em>“starts with”</em>: <code class=\"language-plaintext highlighter-rouge\">MT-</code></li>\n            <li><em>“Var name”</em>: <code class=\"language-plaintext highlighter-rouge\">mito</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>\n      <p><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> output <code class=\"language-plaintext highlighter-rouge\">Final Object</code></p>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.7.5+galaxy1\" title=\"Inspect AnnData tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Inspect AnnData</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.7.5+galaxy1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Final Object</code></li>\n        <li><em>“What to inspect?”</em>: <code class=\"language-plaintext highlighter-rouge\">Key-indexed observations annotation (obs)</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>With that run we should be finished! Check the <i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <code class=\"language-plaintext highlighter-rouge\">obs</code> file to see all the metadata that we’ve added in throughout the tutorial.</p>\n\n<blockquote class=\"warning\">\n  <warning-title>Check your final object!</warning-title>\n  <p>The above tools will sometimes run without error but not produce the correct results - just because they run doesn’t mean all the parameters and inputs were set properly! When <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> inspecting the <i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <code class=\"language-plaintext highlighter-rouge\">obs</code> file of the final AnnData object, you should see that all the columns contain data. If any of the columns are blank, then something has gone wrong!</p>\n</blockquote>\n\n<p><i class=\"far fa-thumbs-up\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">congratulations</span> Congratulations! Now your data is ready for further processing or analysis! You can compare your analysis results with this <a href=\"https://usegalaxy.eu/u/videmp/h/ncbi-to-anndata\">example history</a> and redo the whole analysis with a single click using this <a href=\"https://usegalaxy.eu/u/videmp/w/ncbi-to-anndata\">workflow</a>.</p>\n"],"ref_slides":[],"hands_on":true,"slides":false,"mod_date":"2024-04-10 10:22:37 +0000","pub_date":"2023-12-13 18:43:30 +0000","version":51,"workflows":[{"workflow":"NCBI_to_Anndata.ga","tests":true,"url":"https://training.galaxyproject.org/training-material/topics/single-cell/tutorials/scrna-ncbi-anndata/workflows/NCBI_to_Anndata.ga","path":"topics/single-cell/tutorials/scrna-ncbi-anndata/workflows/NCBI_to_Anndata.ga","wfid":"single-cell-scrna-ncbi-anndata","wfname":"ncbi_to_anndata","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/single-cell-scrna-ncbi-anndata/versions/ncbi_to_anndata","license":"CC-BY-4.0","creators":[{"class":"Person","identifier":"0009-0008-9422-6380","name":"Morgan Howells"},{"class":"Person","identifier":"0000-0002-5192-126X","name":"Pavankumar Videm"}],"name":"NCBI to Anndata","title":"NCBI to Anndata","test_results":null,"modified":"2024-06-24 07:14:30 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\nGSM5353219_PA_PB1B_Pool_2_S24_L001_dge.txt\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"ℹ️ Input Dataset\\nGSM5353223_PA_PB2B_Pool_2_S26_L001_dge.txt\"];\n  style 1 stroke:#2c3143,stroke-width:4px;\n  2[\"ℹ️ Input Dataset\\nGSM5353218_PA_PB1B_Pool_1_2_S74_L003_dge.txt\"];\n  style 2 stroke:#2c3143,stroke-width:4px;\n  3[\"ℹ️ Input Dataset\\nGSM5353216_PA_PB1A_Pool_1_3_S50_L002_dge.txt\"];\n  style 3 stroke:#2c3143,stroke-width:4px;\n  4[\"ℹ️ Input Dataset\\nGSM5353221_PA_PB2A_Pool_1_3_S25_L001_dge.txt\"];\n  style 4 stroke:#2c3143,stroke-width:4px;\n  5[\"ℹ️ Input Dataset\\nGSM5353215_PA_AUG_PB_1B_S2_dge.txt\"];\n  style 5 stroke:#2c3143,stroke-width:4px;\n  6[\"ℹ️ Input Dataset\\nGSM5353222_PA_PB2B_Pool_1_3_S52_L002_dge.txt\"];\n  style 6 stroke:#2c3143,stroke-width:4px;\n  7[\"ℹ️ Input Dataset\\nGSM5353220_PA_PB1B_Pool_3_S51_L002_dge.txt\"];\n  style 7 stroke:#2c3143,stroke-width:4px;\n  8[\"ℹ️ Input Dataset\\nGSM5353217_PA_PB1A_Pool_2_S107_L004_dge.txt\"];\n  style 8 stroke:#2c3143,stroke-width:4px;\n  9[\"ℹ️ Input Dataset\\nGSM5353214_PA_AUG_PB_1A_S1_dge.txt\"];\n  style 9 stroke:#2c3143,stroke-width:4px;\n  10[\"Import Anndata and loom\"];\n  0 -->|output| 10;\n  11[\"Import Anndata and loom\"];\n  1 -->|output| 11;\n  12[\"Import Anndata and loom\"];\n  2 -->|output| 12;\n  13[\"Import Anndata and loom\"];\n  3 -->|output| 13;\n  14[\"Import Anndata and loom\"];\n  4 -->|output| 14;\n  15[\"Import Anndata and loom\"];\n  5 -->|output| 15;\n  16[\"Import Anndata and loom\"];\n  6 -->|output| 16;\n  17[\"Import Anndata and loom\"];\n  7 -->|output| 17;\n  18[\"Import Anndata and loom\"];\n  8 -->|output| 18;\n  19[\"Import Anndata and loom\"];\n  9 -->|output| 19;\n  20[\"Manipulate AnnData\"];\n  10 -->|anndata| 20;\n  21[\"Manipulate AnnData\"];\n  11 -->|anndata| 21;\n  22[\"Manipulate AnnData\"];\n  12 -->|anndata| 22;\n  23[\"Manipulate AnnData\"];\n  13 -->|anndata| 23;\n  24[\"Manipulate AnnData\"];\n  14 -->|anndata| 24;\n  25[\"Manipulate AnnData\"];\n  15 -->|anndata| 25;\n  26[\"Manipulate AnnData\"];\n  16 -->|anndata| 26;\n  27[\"Manipulate AnnData\"];\n  17 -->|anndata| 27;\n  28[\"Manipulate AnnData\"];\n  18 -->|anndata| 28;\n  29[\"Manipulate AnnData\"];\n  19 -->|anndata| 29;\n  30[\"Manipulate AnnData\"];\n  29 -->|anndata| 30;\n  23 -->|anndata| 30;\n  24 -->|anndata| 30;\n  21 -->|anndata| 30;\n  25 -->|anndata| 30;\n  22 -->|anndata| 30;\n  27 -->|anndata| 30;\n  28 -->|anndata| 30;\n  26 -->|anndata| 30;\n  20 -->|anndata| 30;\n  31[\"Inspect AnnData\"];\n  30 -->|anndata| 31;\n  32[\"Replace Text\"];\n  31 -->|obs| 32;\n  33[\"Replace Text\"];\n  31 -->|obs| 33;\n  34[\"Replace Text\"];\n  31 -->|obs| 34;\n  35[\"Replace Text\"];\n  31 -->|obs| 35;\n  36[\"Cut\"];\n  32 -->|outfile| 36;\n  37[\"Cut\"];\n  33 -->|outfile| 37;\n  38[\"Cut\"];\n  34 -->|outfile| 38;\n  39[\"Cut\"];\n  35 -->|outfile| 39;\n  40[\"Paste\"];\n  37 -->|out_file1| 40;\n  36 -->|out_file1| 40;\n  41[\"Paste\"];\n  40 -->|out_file1| 41;\n  38 -->|out_file1| 41;\n  42[\"Paste\"];\n  41 -->|out_file1| 42;\n  39 -->|out_file1| 42;\n  43[\"Manipulate AnnData\"];\n  30 -->|anndata| 43;\n  42 -->|out_file1| 43;\n  44[\"Scanpy FilterCells\"];\n  43 -->|anndata| 44;\n  45[\"AnnData Operations\"];\n  44 -->|output_h5ad| 45;\n  98fdc079-8b71-4841-a9aa-a3adda888616[\"Output\\noutput_h5ad\"];\n  45 --> 98fdc079-8b71-4841-a9aa-a3adda888616;\n  style 98fdc079-8b71-4841-a9aa-a3adda888616 stroke:#2c3143,stroke-width:4px;\n  46[\"Inspect AnnData\"];\n  45 -->|output_h5ad| 46;\n  e4df8425-3c1e-439c-abe5-42b705eed1b3[\"Output\\nobs\"];\n  46 --> e4df8425-3c1e-439c-abe5-42b705eed1b3;\n  style e4df8425-3c1e-439c-abe5-42b705eed1b3 stroke:#2c3143,stroke-width:4px;"}],"api":"https://training.galaxyproject.org/training-material/api/topics/single-cell/tutorials/scrna-ncbi-anndata/tutorial.json","tools":["Cut1","Paste1","toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_replace_in_column/1.1.3","toolshed.g2.bx.psu.edu/repos/ebi-gxa/anndata_ops/anndata_ops/1.8.1+galaxy0","toolshed.g2.bx.psu.edu/repos/ebi-gxa/anndata_ops/anndata_ops/1.8.1+galaxy9","toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_filter_cells/scanpy_filter_cells/1.8.1+galaxy9","toolshed.g2.bx.psu.edu/repos/imgteam/unzip/unzip/6.0+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/anndata_import/anndata_import/0.7.5+galaxy1","toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.7.5+galaxy1","toolshed.g2.bx.psu.edu/repos/iuc/anndata_manipulate/anndata_manipulate/0.7.5+galaxy1"],"supported_servers":{"exact":[{"url":"https://usegalaxy.eu","name":"UseGalaxy.eu","usegalaxy":true}],"inexact":[{"url":"https://usegalaxy.org.au","name":"UseGalaxy.org.au","usegalaxy":true}]},"topic_name_human":"Single Cell","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"text_processing","owner":"bgruening","revisions":"d698c222f354","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"anndata_ops","owner":"ebi-gxa","revisions":"890fb06a2893","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"anndata_ops","owner":"ebi-gxa","revisions":"825dfd66e3fb","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"scanpy_filter_cells","owner":"ebi-gxa","revisions":"e9283529cba1","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"unzip","owner":"imgteam","revisions":"57f0914ddb7b","tool_panel_section_label":"Collection Operations","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"anndata_import","owner":"iuc","revisions":"fb9e030ffae4","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"anndata_inspect","owner":"iuc","revisions":"ee98d611afc6","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"anndata_manipulate","owner":"iuc","revisions":"3d748954434b","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: text_processing\n  owner: bgruening\n  revisions: d698c222f354\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: anndata_ops\n  owner: ebi-gxa\n  revisions: 890fb06a2893\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: anndata_ops\n  owner: ebi-gxa\n  revisions: 825dfd66e3fb\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_filter_cells\n  owner: ebi-gxa\n  revisions: e9283529cba1\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: unzip\n  owner: imgteam\n  revisions: 57f0914ddb7b\n  tool_panel_section_label: Collection Operations\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: anndata_import\n  owner: iuc\n  revisions: fb9e030ffae4\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: anndata_inspect\n  owner: iuc\n  revisions: ee98d611afc6\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: anndata_manipulate\n  owner: iuc\n  revisions: 3d748954434b\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":false,"slides_recordings":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial","contributors":[{"name":"Morgan Howells","email":"hexhowells@gmail.com","orcid":"0009-0008-9422-6380","joined":"2023-06","id":"hexhowells","url":"https://training.galaxyproject.org/training-material/api/contributors/hexhowells.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/hexhowells/"},{"name":"Wendi Bacon","email":"wendi.bacon@open.ac.uk","twitter":"WendiBacon1","matrix":"nomadscientist:matrix.org","joined":"2020-03","elixir_node":"uk","orcid":"0000-0002-8170-8806","bio":"Lecturer at The Open University","fediverse":"https://mstdn.science/@wendibacon1","fediverse_flavor":"mastodon","affiliations":["elixir-europe"],"id":"nomadscientist","url":"https://training.galaxyproject.org/training-material/api/contributors/nomadscientist.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/nomadscientist/"},{"name":"Pavankumar Videm","orcid":"0000-0002-5192-126X","joined":"2017-09","affiliations":["uni-freiburg","elixir-europe"],"id":"pavanvidem","url":"https://training.galaxyproject.org/training-material/api/contributors/pavanvidem.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/pavanvidem/"},{"name":"Mehmet Tekman","email":"mtekman89@gmail.com","joined":"2018-11","elixir_node":"de","affiliations":["uni-freiburg"],"former_affiliations":["elixir-europe"],"id":"mtekman","url":"https://training.galaxyproject.org/training-material/api/contributors/mtekman.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/mtekman/"},{"name":"Helena Rasche","orcid":"0000-0001-9760-8992","maintainer_contact":"gitter","matrix":"hexylena:matrix.org","joined":"2017-09","elixir_node":"nl","affiliations":["gallantries","by-covid","erasmusmc","elixir-europe","elixir-converge"],"former_affiliations":["deNBI","avans-atgm","uni-freiburg"],"contact_for_training":false,"location":{"country":"NL","lat":51.91,"lon":4.46},"id":"hexylena","url":"https://training.galaxyproject.org/training-material/api/contributors/hexylena.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/hexylena/"},{"name":"Pavankumar Videm","orcid":"0000-0002-5192-126X","joined":"2017-09","affiliations":["uni-freiburg","elixir-europe"],"id":"pavanvidem","url":"https://training.galaxyproject.org/training-material/api/contributors/pavanvidem.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/pavanvidem/"},{"name":"ELIXIR-UK: FAIR Data Stewardship training","short_name":"ELIXIR Fair Data","github":false,"joined":"2023-06","funder":true,"funding_id":"MR/V038966/1","funding_system":"ukri","funding_statement":"This work has been funded by the ELIXIR-UK FAIR Data Stewardship training UKRI award (MR/V038966/1)","id":"elixir-fair-data","url":"https://training.galaxyproject.org/training-material/api/funders/elixir-fair-data.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/elixir-fair-data/"}]}