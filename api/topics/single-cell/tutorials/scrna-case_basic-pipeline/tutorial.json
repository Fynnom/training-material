{"layout":"tutorial_hands_on","title":"Filter, plot and explore single-cell RNA-seq data with Scanpy","subtopic":"single-cell-CS","priority":3,"zenodo_link":"https://zenodo.org/record/7053673","redirect_from":["/topics/transcriptomics/tutorials/scrna-seq-basic-pipeline/tutorial","/topics/transcriptomics/tutorials/scrna-case_basic-pipeline/tutorial","/short/single-cell/scrna-case_basic-pipeline","/short/T00247"],"answer_histories":[{"label":"UseGalaxy.eu","history":"https://usegalaxy.eu/u/j.jakiela/h/filter-plot-and-explore-single-cell-rna-seq-data-updated","date":"2023-10-10"},{"label":"Older version","history":"https://usegalaxy.eu/u/wendi.bacon.training/h/cs3filter-plot-and-explore-single-cell-rna-seq-data---answer-key-2","date":"2024-02-28"}],"input_histories":[{"label":"UseGalaxy.eu","history":"https://usegalaxy.eu/u/j.jakiela/h/filter-plot-explore-tutorial-input"}],"questions":["Is my single cell dataset a quality dataset?","How do I generate and annotate cell clusters?","How do I pick thresholds and parameters in my analysis? What's a \"reasonable\" number, and will the world collapse if I pick the wrong one?"],"objectives":["Interpret quality control plots to direct parameter decisions","Repeat analysis from matrix to clustering","Identify decision-making points","Appraise data outputs and decisions","Explain why single cell analysis is an iterative (i.e. the first plots you generate are not final, but rather you go back and re-analyse your data repeatedly) process"],"time_estimation":"3H","key_points":["Single cell data is huge, and must have its many (# genes) dimensions reduced for analysis","Analysis is more subjective than we think, and biological understanding of the samples as well as many iterations of analysis are important to give us our best change of attaining real biological insights"],"requirements":[{"type":"internal","topic_name":"single-cell","tutorials":["scrna-case_alevin","scrna-case_alevin-combine-datasets"]}],"tags":["10x","paper-replication"],"contributions":{"authorship":["nomadscientist"],"editing":["hexylena","wee-snufkin"],"testing":["wee-snufkin"]},"follow_up_training":[{"type":"internal","topic_name":"single-cell","tutorials":["scrna-case_JUPYTER-trajectories","scrna-case_monocle3-trajectories"]}],"js_requirements":{"mathjax":null,"mermaid":false},"short_id":"T00247","url":"/topics/single-cell/tutorials/scrna-case_basic-pipeline/tutorial.html","topic_name":"single-cell","tutorial_name":"scrna-case_basic-pipeline","dir":"topics/single-cell/tutorials/scrna-case_basic-pipeline","symlink":null,"id":"single-cell/scrna-case_basic-pipeline","ref_tutorials":["<p>You’ve done all the work to make a single cell matrix, with gene counts and mitochondrial counts and buckets of cell metadata from all your variables of interest. Now it’s time to fully process our data, to remove low quality cells, to reduce the many dimensions of data that make it difficult to work with, and ultimately to try to define our clusters and to find our biological meaning and insights! There are many packages for analysing single cell data - Seurat <span class=\"citation\"><a href=\"#Satija2015\">Satija <i>et al.</i> 2015</a></span>, Scanpy <span class=\"citation\"><a href=\"#Wolf2018\">Wolf <i>et al.</i> 2018</a></span>, Monocle <span class=\"citation\"><a href=\"#Trapnell2014\">Trapnell <i>et al.</i> 2014</a></span>, Scater <span class=\"citation\"><a href=\"#McCarthy2017\">McCarthy <i>et al.</i> 2017</a></span>, and so forth. We’re working with Scanpy, because currently Galaxy hosts the most Scanpy tools of all of those options.</p>\n\n<blockquote class=\"comment\">\n  <comment-title>Tutorials everywhere?</comment-title>\n  <p>This tutorial is similar to another fantastic tutorial: <a href=\"/training-material/topics/single-cell/tutorials/scrna-scanpy-pbmc3k/tutorial.html\">Clustering 3k PBMC</a>. That tutorial will go into much further depth on the analysis, in particular the visualisation and science behind identifying marker genes. Their experimental data is clean and well annotated, which illustrates the steps beautifully. Here, we work more as a case study with messier data, to help empower you in making choices during the analysis. We highly recommend you work through all the galaxy single cell tutorials to build confidence and expertise! For trainers, note that there are small-group options in this tutorial.</p>\n</blockquote>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n  <p>In this tutorial, we will cover:</p>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#get-data\" id=\"markdown-toc-get-data\">Get data</a></li>\n  <li><a href=\"#important-tips-for-easier-analysis\" id=\"markdown-toc-important-tips-for-easier-analysis\">Important tips for easier analysis</a></li>\n  <li><a href=\"#filtering\" id=\"markdown-toc-filtering\">Filtering</a>    <ol>\n      <li><a href=\"#generate-qc-plots\" id=\"markdown-toc-generate-qc-plots\">Generate QC Plots</a></li>\n      <li><a href=\"#analysing-the-plots\" id=\"markdown-toc-analysing-the-plots\">Analysing the plots</a></li>\n      <li><a href=\"#apply-the-thresholds\" id=\"markdown-toc-apply-the-thresholds\">Apply the thresholds</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#processing\" id=\"markdown-toc-processing\">Processing</a></li>\n  <li><a href=\"#preparing-coordinates\" id=\"markdown-toc-preparing-coordinates\">Preparing coordinates</a>    <ol>\n      <li><a href=\"#principal-components\" id=\"markdown-toc-principal-components\">Principal components</a></li>\n      <li><a href=\"#neighborhood-graph\" id=\"markdown-toc-neighborhood-graph\">Neighborhood graph</a></li>\n      <li><a href=\"#dimensionality-reduction-for-visualisation\" id=\"markdown-toc-dimensionality-reduction-for-visualisation\">Dimensionality reduction for visualisation</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#cell-clusters--gene-markers\" id=\"markdown-toc-cell-clusters--gene-markers\">Cell clusters &amp; gene markers</a>    <ol>\n      <li><a href=\"#findmarkers\" id=\"markdown-toc-findmarkers\">FindMarkers</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#plotting\" id=\"markdown-toc-plotting\">Plotting!</a></li>\n  <li><a href=\"#insights-into-the-beyond\" id=\"markdown-toc-insights-into-the-beyond\">Insights into the beyond</a>    <ol>\n      <li><a href=\"#biological-interpretation\" id=\"markdown-toc-biological-interpretation\">Biological Interpretation</a></li>\n      <li><a href=\"#technical-assessment\" id=\"markdown-toc-technical-assessment\">Technical Assessment</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#interactive-visualisations\" id=\"markdown-toc-interactive-visualisations\">Interactive visualisations</a></li>\n  <li><a href=\"#conclusion\" id=\"markdown-toc-conclusion\">Conclusion</a></li>\n</ol>\n\n</blockquote>\n\n<h2 id=\"get-data\">Get data</h2>\n\n<p>We’ve provided you with experimental data to analyse from a mouse dataset of fetal growth restriction <span class=\"citation\"><a href=\"#Bacon2018\">Bacon <i>et al.</i> 2018</a></span>. This is the full dataset generated from <a href=\"/training-material/topics/single-cell/tutorials/scrna-case_alevin-combine-datasets/tutorial.html\">this tutorial</a> if you used the full FASTQ files rather than the subsampled ones (see the <a href=\"https://www.ebi.ac.uk/gxa/sc/experiments/E-MTAB-6945/results/tsne\">study in Single Cell Expression Atlas</a> and the <a href=\"https://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-6945/\">project submission</a>). You can find this dataset in this <a href=\"https://usegalaxy.eu/u/j.jakiela/h/filter-plot-explore-tutorial-input\">input history</a> or download from Zenodo below.</p>\n\n<p>You can access the data for this tutorial in multiple ways:</p>\n\n<ol>\n  <li>\n    <p><strong>Your own history</strong> - If you’re feeling confident that you successfully ran a workflow on all 7 samples from the previous tutorial, and that your resulting 7 AnnData objects look right (you can compare with the <a href=\"https://usegalaxy.eu/u/j.jakiela/h/all-total-samples-processed-after-alevin-into-single-object\">answer key history</a>), then you can use those! Be careful, in the previous tutorials we worked on downsampled datasets, but here we start with the object containing total data from all the samples! To avoid a million-line history, I recommend dragging the resultant datasets into a fresh history:</p>\n\n    <!--SNIPPET-->\n    <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-copy-a-dataset-between-histories\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-copy-a-dataset-between-histories\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Copy a dataset between histories</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>There 3 ways to copy datasets between histories</p>   <ol>   <li>     <p>From the original history</p>     <ol>       <li>Click on the <i class=\"fas fa-cog\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-gear</span> icon which is on the top of the list of datasets in the history panel</li>       <li>Click on <strong>Copy Datasets</strong></li>       <li>         <p>Select the desired files</p>       </li>       <li>         <p>Give a relevant name to the “New history”</p>       </li>       <li>Validate by ‘Copy History Items’</li>       <li>Click on the new history name in the green box that have just appear to switch to this history</li>     </ol>   </li>   <li>     <p>Using the <i class=\"fas fa-columns\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-columns</span> <strong>Show Histories Side-by-Side</strong></p>     <ol>       <li>Click on the <i class=\"fas fa-caret-down\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-dropdown</span> dropdown arrow top right of the history panel (<strong>History options</strong>)</li>       <li>Click on <i class=\"fas fa-columns\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-columns</span> <strong>Show Histories Side-by-Side</strong></li>       <li>If your target history is not present         <ol>           <li>Click on ‘Select histories’</li>           <li>Click on your target history</li>           <li>Validate by ‘Change Selected’</li>         </ol>       </li>       <li>Drag the dataset to copy from its original history</li>       <li>Drop it in the target history</li>     </ol>   </li>   <li>     <p>From the target history</p>     <ol>       <li>Click on <strong>User</strong> in the top bar</li>       <li>Click on <strong>Datasets</strong></li>       <li>Search for the dataset to copy</li>       <li>Click on its name</li>       <li>Click on <strong>Copy to current History</strong></li>     </ol>   </li> </ol> </blockquote>\n    <p><!--END_SNIPPET--></p>\n  </li>\n  <li>\n    <p><strong>Importing from a history</strong> - You can import <a href=\"https://usegalaxy.eu/u/j.jakiela/h/filter-plot-explore-tutorial-input\">this history</a></p>\n\n    <!--SNIPPET-->\n    <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-a-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-a-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing a history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ol>   <li>Open the link to the shared history</li>   <li>Click on the <i class=\"fas fa-plus\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">new-history</span> <em>Import history</em> button on the top right</li>   <li>Enter a title for the new history</li>   <li>Click on <strong>Import</strong></li> </ol> </blockquote>\n    <p><!--END_SNIPPET--></p>\n  </li>\n  <li>\n    <p><strong>Uploading from Zenodo</strong> (see below)</p>\n  </li>\n</ol>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Option 3: Uploading from Zenodo</hands-on-title>\n\n  <ol>\n    <li>Create a new history for this tutorial</li>\n    <li>\n      <p>Import the AnnData object from <a href=\"https://zenodo.org/record/7053673\">Zenodo</a></p>\n\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/7053673/files/Mito-counted_AnnData\n</code></pre></div>      </div>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-via-links\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-via-links\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing via links</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the datasets <code class=\"language-plaintext highlighter-rouge\">Mito-counted AnnData</code></li>\n    <li>\n      <p>Check that the datatype is <code class=\"language-plaintext highlighter-rouge\">h5ad</code></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-changing-the-datatype\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-changing-the-datatype\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Changing the datatype</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, click <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Datatypes</strong> tab on the top</li>   <li>In the <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Assign Datatype</strong>, select <code class=\"language-plaintext highlighter-rouge\">h5ad</code> from “<em>New type</em>” dropdown     <ul>       <li>Tip: you can start typing the datatype into the field to filter the dropdown menu</li>     </ul>   </li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<ol>\n  <li><strong>Importing data from EBI Single Cell Expression Atlas</strong></li>\n</ol>\n\n<p>You can also pull the data from publicly available <a href=\"https://www.ebi.ac.uk/gxa/sc/home\">Single Cell Expression Atlas</a>. You can simply access the dataset we are working on by using the tool <em>EBI SCXA Data Retrieval</em> with experiment id of <a href=\"https://www.ebi.ac.uk/gxa/sc/experiments/E-MTAB-6945/downloads\">E-MTAB-6945</a>. This <a href=\"/training-material/topics/single-cell/tutorials/EBI-retrieval/tutorial.html\">short tutorial</a> will show you how to use this tool and modify the output so that it’s compatible with this tutorial and its workflow.</p>\n\n<h1 id=\"important-tips-for-easier-analysis\">Important tips for easier analysis</h1>\n\n<!--SNIPPET-->\n<blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-using-tutorial-mode\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-using-tutorial-mode\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Using tutorial mode</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>Tools are frequently updated to new versions. Your Galaxy may have multiple versions of the same tool available. By default, you will be shown the latest version of the tool. This may NOT be the same tool used in the tutorial you are accessing. Furthermore, if you use a newer tool in one step, and try using an older tool in the next step… this may fail! To ensure you use the same tool versions of a given tutorial, use the <strong>Tutorial mode</strong> feature.</p>   <ul>   <li>Open your Galaxy server</li>   <li>Click on the <i class=\"fas fa-graduation-cap\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">curriculum</span> icon on the top menu, this will open the GTN inside Galaxy.</li>   <li>Navigate to your tutorial</li>   <li>Tool names in tutorials will be blue buttons that open the correct tool for you</li>   <li><strong>Note:</strong> this does not work for all tutorials (yet)   <img src=\"/training-material/topics/contributing/images/88277962-ddda4a80-cce1-11ea-92cd-41b1df063db0.gif\" alt=\"gif showing how GTN-in-Galaxy works\" /></li>   <li>You can click anywhere in the grey-ed out area outside of the tutorial box to return back to the Galaxy analytical interface</li> </ul>   <blockquote class=\"warning\">   <warning-title>Not all browsers work!</warning-title>   <ul>     <li>We’ve had some issues with Tutorial mode on Safari for Mac users.</li>     <li>Try a <strong>different browser</strong> if you aren’t seeing the button.</li>   </ul> </blockquote> </blockquote>\n<p><!--END_SNIPPET--></p>\n\n<!--SNIPPET-->\n<blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-use-our-single-cell-lab\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-use-our-single-cell-lab\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Use our Single Cell Lab</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>Did you know we have a unique Single Cell Lab with all our single cell tools highlighted to make it easier to use on Galaxy? We recommend this site for all your single cell analysis needs, particularly for newer users.</p>   <p>The Single Cell Lab currently uses the main European Galaxy infrastructure and power, it’s just organised better for users of particular analyses…like single cell!</p>   <p>Try it out! All your histories/workflows/logins from the general <a href=\"https://usegalaxy.eu\">European Galaxy server</a> will be there!</p>   <ul>   <li><i class=\"fa fa-tv\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">subdomain</span> <a href=\"https://singlecell.usegalaxy.eu\">Single Cell Lab</a></li> </ul> </blockquote>\n<p><!--END_SNIPPET--></p>\n\n<!--SNIPPET-->\n<blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-troubleshooting-errors\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-troubleshooting-errors\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Troubleshooting errors</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>When something goes wrong in Galaxy, there are a number of things you can do to find out what it was. Error messages can help you figure out whether it was a problem with one of the settings of the tool, or with the input data, or maybe there is a bug in the tool itself and the problem should be reported. Below are the steps you can follow to troubleshoot your Galaxy errors.</p>   <ol>   <li><strong>Expand</strong> the red history dataset by clicking on it.     <ul>       <li>Sometimes you can already see an error message here</li>     </ul>   </li>   <li>     <p><strong>View the error message</strong> by clicking on the <strong>bug icon</strong> <i class=\"fas fa-bug\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-bug</span></p>   </li>   <li><strong>Check the logs.</strong> Output (stdout) and error logs (stderr) of the tool are available:     <ul>       <li>Expand the history item</li>       <li>Click on the <i class=\"fas fa-info-circle\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">details</span> icon</li>       <li>Scroll down to the <strong>Job Information</strong> section to view the 2 logs:         <ul>           <li>Tool Standard Output</li>           <li>Tool Standard Error</li>         </ul>       </li>       <li>For more information about specific tool errors, please see the <a href=\"/training-material/faqs/galaxy/index.html#troubleshooting\">Troubleshooting section</a></li>     </ul>   </li>   <li><strong>Submit a bug report!</strong> If you are still unsure what the problem is.     <ul>       <li>Click on the bug icon <i class=\"fas fa-bug\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-bug</span></li>       <li>Write down any information you think might help solve the problem         <ul>           <li>See <a href=\"/training-material/faqs/galaxy/analysis_troubleshooting_reporting.html\">this FAQ</a> on how to write good bug reports</li>         </ul>       </li>       <li>Click <strong><i class=\"fas fa-bug\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-bug</span> Report</strong> button</li>     </ul>   </li>   <li><strong>Ask for help!</strong>     <ul>       <li>Where?         <ul>           <li>In the <a href=\"https://matrix.to/#/#Galaxy-Training-Network_galaxy-single-cell:gitter.im\">Single cell user community</a></li>           <li>In the <a href=\"https://gitter.im/Galaxy-Training-Network/Lobby\">GTN Matrix Channel</a></li>           <li>In the <a href=\"https://gitter.im/galaxyproject/Lobby\">Galaxy Matrix Channel</a></li>           <li>Browse the <a href=\"https://help.galaxyproject.org/\">Galaxy Help Forum</a> to see if others have encountered the same problem before (or post your question).</li>         </ul>       </li>       <li>When asking for help, it is useful to <a href=\"/training-material/faqs/galaxy/histories_sharing.html\">share a link to your history</a></li>     </ul>   </li> </ol> </blockquote>\n<p><!--END_SNIPPET--></p>\n\n<h1 id=\"filtering\">Filtering</h1>\n\n<p>You have generated an annotated AnnData object from your raw scRNA-seq fastq files. However, you have only completed a ‘rough’ filter of your dataset - there will still be a number of ‘cells’ that are actually just background from empty droplets or simply low-quality. There will also be genes that could be sequencing artifacts or that appear with such low frequency that statistical tools will fail to analyse them. This background garbage of both cells and genes not only makes it harder to distinguish real biological information from the noise, but also makes it computationally heavy to analyse. These spurious reads take a lot of computational power to analyse! First on our agenda is to filter this matrix to give us cleaner data to extract meaningful insight from, and to allow faster analysis.</p>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>What information is stored in your AnnData object? The last tool to generate this object counted the mitochondrial associated genes in your matrix. Where is that data stored?</li>\n    <li>While you are figuring that out, how many genes and cells are in your object?</li>\n  </ol>\n\n  <blockquote class=\"tip\">\n    <tip-title>Hint</tip-title>\n    <p>You want to use the same tool you used in the previous tutorial to examine your AnnData, since it’s not necessarily as simple as examining the Anndata dataset in the history!</p>\n\n    <blockquote class=\"hands_on\">\n      <hands-on-title>Inspecting AnnData Objects</hands-on-title>\n\n      <ol>\n        <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.7.5+galaxy1\" title=\"Inspect AnnData tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Inspect AnnData</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.7.5+galaxy1)</span> with the following parameters:\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Mito-counted AnnData</code></li>\n            <li><em>“What to inspect?”</em>: <code class=\"language-plaintext highlighter-rouge\">General information about the object</code></li>\n          </ul>\n        </li>\n        <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.7.5+galaxy1\" title=\"Inspect AnnData tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Inspect AnnData</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.7.5+galaxy1)</span> with the following parameters:\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Mito-counted AnnData</code></li>\n            <li><em>“What to inspect?”</em>: <code class=\"language-plaintext highlighter-rouge\">Key-indexed observations annotation (obs)</code></li>\n          </ul>\n        </li>\n        <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.7.5+galaxy1\" title=\"Inspect AnnData tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Inspect AnnData</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.7.5+galaxy1)</span> with the following parameters:\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Mito-counted AnnData</code></li>\n            <li><em>“What to inspect?”</em>: <code class=\"language-plaintext highlighter-rouge\">Key-indexed annotation of variables/features (var)</code></li>\n          </ul>\n        </li>\n      </ol>\n    </blockquote>\n  </blockquote>\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>If you examine your AnnData object, you’ll find a number of different quality control metrics for both cells <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> <strong>obs</strong> and <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> genes <strong>var</strong>.\n        <ul>\n          <li>For instance, you can see a <code class=\"language-plaintext highlighter-rouge\">n_cells</code> under <strong>var</strong>, which counts the number of cells that gene appears in.</li>\n          <li>In the <strong>obs</strong>, you have both discrete and log-based metrics for <code class=\"language-plaintext highlighter-rouge\">n_genes</code>, how many genes are counted in a cell, and <code class=\"language-plaintext highlighter-rouge\">n_counts</code>, how many UMIs are counted per cell. So, for instance, you might count multiple GAPDHs in a cell. Your <code class=\"language-plaintext highlighter-rouge\">n_counts</code> should thus be higher than <code class=\"language-plaintext highlighter-rouge\">n_genes</code>.</li>\n          <li>But what about the mitochondria?? Within the cells information <strong>obs</strong>, the <code class=\"language-plaintext highlighter-rouge\">total_counts_mito</code>,  <code class=\"language-plaintext highlighter-rouge\">log1p_total_counts_mito</code>, and <code class=\"language-plaintext highlighter-rouge\">pct_counts_mito</code> has been calculated for each cell.</li>\n        </ul>\n      </li>\n      <li>You can see in the <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> <strong>General information about the object</strong> output that the matrix is <code class=\"language-plaintext highlighter-rouge\">31178 x 35734</code>. This is <code class=\"language-plaintext highlighter-rouge\">obs x vars</code>, or rather, <code class=\"language-plaintext highlighter-rouge\">cells x genes</code>, so there are <code class=\"language-plaintext highlighter-rouge\">31178 cells</code> and <code class=\"language-plaintext highlighter-rouge\">35734 genes</code> in the matrix.</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<p><i class=\"fas fa-hourglass-half\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">time</span> <strong>Top time-saving advice</strong> - turn the 3 <strong>Inspect AnnData</strong> outputs above into a workflow for quick access!</p>\n\n<!--SNIPPET-->\n<blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-extracting-a-workflow-from-your-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-extracting-a-workflow-from-your-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Extracting a workflow from your history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ol>   <li>     <p><strong>Clean up</strong> your history: remove any failed (red) jobs from your history by clicking on the <i class=\"fas fa-trash\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-delete</span> button.</p>     <p>This will make the creation of the workflow easier.</p>   </li>   <li>     <p>Click on <i class=\"fas fa-cog\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-gear</span> (<strong>History options</strong>) at the top of your history panel and select <strong>Extract workflow</strong>.</p>     <p><img src=\"/training-material/topics/introduction/images/history_menu_extract_workflow.png\" alt=\"`Extract Workflow` entry in the history options menu\" /></p>     <p>The central panel will show the content of the history in reverse order (oldest on top), and you will be able to choose which steps to include in the workflow.</p>   </li>   <li>     <p>Replace the <strong>Workflow name</strong> to something more descriptive.</p>   </li>   <li>     <p><strong>Rename</strong> each workflow input in the boxes at the top of the second column.</p>   </li>   <li>     <p>If there are any steps that shouldn’t be included in the workflow, you can <strong>uncheck</strong> them in the first column of boxes.</p>   </li>   <li>     <p>Click on the <strong>Create Workflow</strong> button near the top.</p>     <p>You will get a message that the workflow was created.</p>   </li> </ol> </blockquote>\n<p><!--END_SNIPPET--></p>\n\n<h2 id=\"generate-qc-plots\">Generate QC Plots</h2>\n\n<p>We want to filter our cells, but first we need to know what our data looks like. There are a number of subjective choices to make within scRNA-seq analysis, for instance we now need to make our best informed decisions about where to set our thresholds (more on that soon!). We’re going to plot our data a few different ways. Different bioinformaticians might prefer to see the data in different ways, and here we are only generating some of the myriad of plots you can use. Ultimately you need to go with what makes the most sense to you.</p>\n\n<p><i class=\"fas fa-hourglass-half\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">time</span> <strong>Top time-saving advice</strong> - turn the following QC plots into a workflow so you can re-run it easily throughout analysing your own data!.</p>\n\n<h3 id=\"creating-the-plots\">Creating the plots</h3>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Making QC plots</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/scanpy_plot/scanpy_plot/1.7.1+galaxy1\" title=\"Plot with scanpy tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Plot with scanpy</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.7.1+galaxy1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Mito-counted AnnData</code></li>\n        <li><em>“Method used for plotting”</em>: <code class=\"language-plaintext highlighter-rouge\">Generic: Violin plot, using 'pl.violin'</code>\n          <ul>\n            <li><em>“Keys for accessing variables”</em>: <code class=\"language-plaintext highlighter-rouge\">Subset of variables in 'adata.var_names' or fields of '.obs'</code>\n              <ul>\n                <li><em>“Keys for accessing variables”</em>: <code class=\"language-plaintext highlighter-rouge\">log1p_total_counts,log1p_n_genes_by_counts,pct_counts_mito</code></li>\n              </ul>\n            </li>\n            <li><em>“The key of the observation grouping to consider”</em>: <code class=\"language-plaintext highlighter-rouge\">genotype</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>\n      <p><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> output <code class=\"language-plaintext highlighter-rouge\">Violin - genotype - log</code></p>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/scanpy_plot/scanpy_plot/1.7.1+galaxy1\" title=\"Plot with scanpy tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Plot with scanpy</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.7.1+galaxy1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Mito-counted AnnData</code></li>\n        <li><em>“Method used for plotting”</em>: <code class=\"language-plaintext highlighter-rouge\">Generic: Violin plot, using 'pl.violin'</code>\n          <ul>\n            <li><em>“Keys for accessing variables”</em>: <code class=\"language-plaintext highlighter-rouge\">Subset of variables in 'adata.var_names' or fields of '.obs'</code>\n              <ul>\n                <li><em>“Keys for accessing variables”</em>: <code class=\"language-plaintext highlighter-rouge\">log1p_total_counts,log1p_n_genes_by_counts,pct_counts_mito</code></li>\n              </ul>\n            </li>\n            <li><em>“The key of the observation grouping to consider”</em>: <code class=\"language-plaintext highlighter-rouge\">sex</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>\n      <p><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> output <code class=\"language-plaintext highlighter-rouge\">Violin - sex - log</code></p>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/scanpy_plot/scanpy_plot/1.7.1+galaxy1\" title=\"Plot with scanpy tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Plot with scanpy</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.7.1+galaxy1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Mito-counted AnnData</code></li>\n        <li><em>“Method used for plotting”</em>: <code class=\"language-plaintext highlighter-rouge\">Generic: Violin plot, using 'pl.violin'</code>\n          <ul>\n            <li><em>“Keys for accessing variables”</em>: <code class=\"language-plaintext highlighter-rouge\">Subset of variables in 'adata.var_names' or fields of '.obs'</code>\n              <ul>\n                <li><em>“Keys for accessing variables”</em>: <code class=\"language-plaintext highlighter-rouge\">log1p_total_counts,log1p_n_genes_by_counts,pct_counts_mito</code></li>\n              </ul>\n            </li>\n            <li><em>“The key of the observation grouping to consider”</em>: <code class=\"language-plaintext highlighter-rouge\">batch</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>\n      <p><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> output <code class=\"language-plaintext highlighter-rouge\">Violin - batch - log</code></p>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/scanpy_plot/scanpy_plot/1.7.1+galaxy1\" title=\"Plot with scanpy tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Plot with scanpy</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.7.1+galaxy1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Mito-counted AnnData</code></li>\n        <li><em>“Method used for plotting”</em>: <code class=\"language-plaintext highlighter-rouge\">Generic: Scatter plot along observations or variables axes, using 'pl.scatter'</code>\n          <ul>\n            <li><em>“Plotting tool that computed coordinates”</em>: <code class=\"language-plaintext highlighter-rouge\">Using coordinates</code>\n              <ul>\n                <li><em>“x coordinate”</em>: <code class=\"language-plaintext highlighter-rouge\">log1p_total_counts</code></li>\n                <li><em>“y coordinate”</em>: <code class=\"language-plaintext highlighter-rouge\">pct_counts_mito</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>\n      <p><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> output <code class=\"language-plaintext highlighter-rouge\">Scatter - mito x UMIs</code></p>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/scanpy_plot/scanpy_plot/1.7.1+galaxy1\" title=\"Plot with scanpy tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Plot with scanpy</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.7.1+galaxy1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Mito-counted AnnData</code></li>\n        <li><em>“Method used for plotting”</em>: <code class=\"language-plaintext highlighter-rouge\">Generic: Scatter plot along observations or variables axes, using 'pl.scatter'</code>\n          <ul>\n            <li><em>“Plotting tool that computed coordinates”</em>: <code class=\"language-plaintext highlighter-rouge\">Using coordinates</code>\n              <ul>\n                <li><em>“x coordinate”</em>: <code class=\"language-plaintext highlighter-rouge\">log1p_n_genes_by_counts</code></li>\n                <li><em>“y coordinate”</em>: <code class=\"language-plaintext highlighter-rouge\">pct_counts_mito</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>\n      <p><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> output <code class=\"language-plaintext highlighter-rouge\">Scatter - mito x genes</code></p>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/scanpy_plot/scanpy_plot/1.7.1+galaxy1\" title=\"Plot with scanpy tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Plot with scanpy</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.7.1+galaxy1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Mito-counted AnnData</code></li>\n        <li><em>“Method used for plotting”</em>: <code class=\"language-plaintext highlighter-rouge\">Generic: Scatter plot along observations or variables axes, using 'pl.scatter'</code>\n          <ul>\n            <li><em>“Plotting tool that computed coordinates”</em>: <code class=\"language-plaintext highlighter-rouge\">Using coordinates</code>\n              <ul>\n                <li><em>“x coordinate”</em>: <code class=\"language-plaintext highlighter-rouge\">log1p_total_counts</code></li>\n                <li><em>“y coordinate”</em>: <code class=\"language-plaintext highlighter-rouge\">log1p_n_genes_by_counts</code></li>\n                <li><em>“Color by”</em>: <code class=\"language-plaintext highlighter-rouge\">pct_counts_mito</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> output <code class=\"language-plaintext highlighter-rouge\">Scatter - genes x UMIs</code></li>\n  </ol>\n\n</blockquote>\n\n<h2 id=\"analysing-the-plots\">Analysing the plots</h2>\n\n<p>That’s a lot of information! Let’s attack this in sections and see what questions these plots can help us answer. The <em>scratchbook</em> <i class=\"fas fa-th\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-scratchbook</span> may help here to look at the different plots at the same time!</p>\n\n<!--SNIPPET-->\n<blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-using-the-window-manager-to-view-multiple-datasets\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-using-the-window-manager-to-view-multiple-datasets\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Using the Window Manager to view multiple datasets</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>If you would like to view two or more datasets at once, you can use the <strong>Window Manager</strong> feature in Galaxy:</p>   <ol>   <li><strong>Click</strong> on the <em>Window Manager</em> icon <i class=\"fas fa-th\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-scratchbook</span> on the top menu bar.     <ul>       <li>You should see a little checkmark on the icon now</li>     </ul>   </li>   <li><strong>View</strong> <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> a dataset by clicking on the eye icon <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> to view the output     <ul>       <li>You should see the output in a window overlayed over Galaxy</li>       <li>You can resize this window by dragging the bottom-right corner</li>     </ul>   </li>   <li><strong>Click</strong> outside the file to exit the Window Manager</li>   <li><strong>View</strong> <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> a second dataset from your history     <ul>       <li>You should now see a second window with the new dataset</li>       <li>This makes it easier to compare the two outputs</li>     </ul>   </li>   <li>Repeat this for as many files as you would like to compare</li>   <li>You can turn off the <strong>Window Manager</strong> <i class=\"fas fa-th\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-scratchbook</span> by clicking on the icon again</li> </ol> </blockquote>\n<p><!--END_SNIPPET--></p>\n\n<blockquote class=\"question\">\n  <question-title>Batch Variation</question-title>\n\n  <p>Are there differences in sequencing depth across the samples?</p>\n  <ol>\n    <li>Which plot(s) addresses this?</li>\n    <li>How do you interpret it?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>The plot <code class=\"language-plaintext highlighter-rouge\">violin - batch - log</code> will have what you’re looking for!\n        <figure id=\"figure-1\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-violin-batch-log.png\" alt=\"Violin - batch - log. \" width=\"2018\" height=\"413\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-violin-batch-log.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 1</strong>:</span> Violin - batch - log (Raw)</figcaption></figure>\n      </li>\n      <li>Keeping in mind that this is a log scale - which means that small differences can mean large differences - the violin plots probably look pretty similar.\n        <ul>\n          <li><code class=\"language-plaintext highlighter-rouge\">N703</code> and <code class=\"language-plaintext highlighter-rouge\">N707</code> might be a bit lower on genes and counts (or UMIs), but the differences aren’t catastrophic.</li>\n          <li>The <code class=\"language-plaintext highlighter-rouge\">pct_counts_mito</code> looks pretty similar across the batches, so this also looks good.</li>\n          <li>Nothing here would cause us to eliminate a sample from our analysis, but if you see a sample looking completely different from the rest, you would need to question why that is and consider eliminating it from your experiment!</li>\n        </ul>\n      </li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title>Biological Variables</question-title>\n\n  <p>Are there differences in sequencing depth across sex? Genotype?</p>\n  <ol>\n    <li>Which plot(s) addresses this?</li>\n    <li>How do you interpret the <code class=\"language-plaintext highlighter-rouge\">sex</code> differences?</li>\n    <li>How do you interpret the <code class=\"language-plaintext highlighter-rouge\">genotype</code> differences?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>Similar to above, the plots <code class=\"language-plaintext highlighter-rouge\">violin - sex - log</code> and <code class=\"language-plaintext highlighter-rouge\">violin - genotype - log</code> will have what you’re looking for!\n        <figure id=\"figure-2\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-violin-sex-log.png\" alt=\"Violin - sex - log. \" width=\"2018\" height=\"413\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-violin-sex-log.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 2</strong>:</span> Violin - sex - log (Raw)</figcaption></figure>\n        <figure id=\"figure-3\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-violin-genotype-log.png\" alt=\"Violin - genotype - log. \" width=\"2018\" height=\"413\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-violin-genotype-log.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 3</strong>:</span> Violin - genotype - log (Raw)</figcaption></figure>\n      </li>\n      <li>There isn’t a major difference in sequencing depth across sex, I would say - though you are welcome to disagree!\n        <ul>\n          <li>It is clear there are far fewer female cells, which makes sense given that only one sample was female. <em>Note - that was an unfortunate discovery made long after generating libraries. It’s quite hard to identify the sex of a neonate in the lab! In practice, try hard to not let such a confounding factor into your data! You could consider re-running all the following analysis without that female sample, if you wish.</em></li>\n        </ul>\n      </li>\n      <li>In <code class=\"language-plaintext highlighter-rouge\">Violin - genotype - log</code>, however, we can see there is a difference. The <code class=\"language-plaintext highlighter-rouge\">knockout</code> samples clearly have fewer genes and counts. From an experimental point of view, we can consider, does this make sense?\n        <ul>\n          <li>Would we biologically expect that those cells would be smaller or having fewer transcripts? Possibly, in this case, given that these cells were generated by growth restricted neonatal mice, and in which case we don’t need to worry about our good data, but rather keep this in mind when generating clusters, as we don’t want depth to define clusters, we want biology to!</li>\n          <li>On the other hand, it may be that those cells didn’t survive dissociation as well as the healthy ones (in which case we’d expect higher mitochondrial-associated genes, which we don’t see, so we can rule that out!).</li>\n          <li>Maybe we unluckily poorly prepared libraries for specifically those knockout samples. There are only three, so maybe those samples are under-sequenced.</li>\n          <li>So what do we do about all of this?\n            <ul>\n              <li>Ideally, we consider re-sequencing all the samples but with a higher concentration of the knockout samples in the library. Any bioinformatician will tell you that the best way to get clean data is in the lab, not the computer! Sadly, absolute best practice isn’t necessarily always a realistic option in the lab - for instance, that mouse line was long gone! - so sometimes, we have to make the best of it. There are options to try and address such discrepancy in sequencing depth. Thus, we’re going to take these samples forward and see if we can find biological insight despite the technical differences.</li>\n            </ul>\n          </li>\n        </ul>\n      </li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<p>Now that we’ve assessed the differences in our samples, we will look at the libraries overall to identify appropriate thresholds for our analysis.</p>\n\n<blockquote class=\"question\">\n  <question-title>Filter Thresholds: genes</question-title>\n\n  <p>What threshold should you set for <code class=\"language-plaintext highlighter-rouge\">log1p_n_genes_by_counts</code>?</p>\n  <ol>\n    <li>Which plot(s) addresses this?</li>\n    <li>What number would you pick?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>Any plot with <code class=\"language-plaintext highlighter-rouge\">log1p_n_genes_by_counts</code> would do here, actually! Some people prefer scatterplots to violins.</li>\n    </ol>\n    <figure id=\"figure-4\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-scatter-genesxmito.png\" alt=\"Scatter-genesxmito. \" width=\"609\" height=\"413\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-scatter-genesxmito.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 4</strong>:</span> Scatter - mito x genes (Raw)</figcaption></figure>\n\n    <ol>\n      <li>In <code class=\"language-plaintext highlighter-rouge\">Scatter - mito x genes</code> you can see how cells with <code class=\"language-plaintext highlighter-rouge\">log1p_n_genes_by_counts</code> up to around, perhaps, <code class=\"language-plaintext highlighter-rouge\">5.7</code> (around 300 genes) often have high <code class=\"language-plaintext highlighter-rouge\">pct_counts_mito</code>.\n        <ul>\n          <li>You can plot this as just <code class=\"language-plaintext highlighter-rouge\">n_counts</code> and see this same trend at around 300 genes, but with this data the log format is clearer so that’s how we’re presenting it.</li>\n          <li>You could also use the violin plots to come up with the threshold, and thus also take batch into account. It’s good to look at the violins as well, because you don’t want to accidentally cut out an entire sample (i.e. N703 and N707).</li>\n          <li>Some bioinformaticians would recommend filtering each sample individually, but this is difficult in larger scale and in this case (you’re welcome to give it a go! You’d have to filter separately and then concatenate), it won’t make a notable difference in the final interpretation.</li>\n        </ul>\n      </li>\n    </ol>\n\n  </blockquote>\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title>Filter Thresholds: UMIs</question-title>\n\n  <p>What threshold should you set for <code class=\"language-plaintext highlighter-rouge\">log1p_total_counts</code>?</p>\n  <ol>\n    <li>Which plot(s) addresses this?</li>\n    <li>What number would you pick?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>As before, any plot with <code class=\"language-plaintext highlighter-rouge\">log1p_total_counts</code> will do! Again, we’ll use a scatterplot here, but you can use a violin plot if you wish!</li>\n    </ol>\n    <figure id=\"figure-5\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-scatter-countsxmito.png\" alt=\"Scatter-countsxmito. \" width=\"609\" height=\"413\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-scatter-countsxmito.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 5</strong>:</span> Scatterplot - mito x UMIs (Raw)</figcaption></figure>\n\n    <ol>\n      <li>We can see that we will need to set a higher threshold (which makes sense, as you’d expect more UMI’s per cell rather than unique genes!). Again, perhaps being a bit aggressive in our threshold, we might choose <code class=\"language-plaintext highlighter-rouge\">6.3</code>, for instance (which amounts to around 500 counts/cell).\n        <ul>\n          <li>In an ideal world, you’ll see a clear population of real cells separated from a clear population of debris. Many samples, like this one, are under-sequenced, and such separation would likely be seen after deeper sequencing!</li>\n        </ul>\n      </li>\n    </ol>\n\n  </blockquote>\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title>Filter Thresholds: mito</question-title>\n\n  <p>What threshold should you set for <code class=\"language-plaintext highlighter-rouge\">pct_counts_mito</code>?</p>\n  <ol>\n    <li>Which plot(s) addresses this?</li>\n    <li>What number would you pick?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>Any plot with <code class=\"language-plaintext highlighter-rouge\">pct_counts_mito</code> would do here, however the scatterplots are likely the easiest to interpret. We’ll use the same as last time.</li>\n    </ol>\n    <figure id=\"figure-6\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-scatter-countsxmito.png\" alt=\"Scatter-countsxmito. \" width=\"609\" height=\"413\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-scatter-countsxmito.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 6</strong>:</span> Scatterplot - mito x UMIs (Raw)</figcaption></figure>\n\n    <ol>\n      <li>We can see a clear trend wherein cells that have around 5% mito counts or higher also have far fewer total counts. These cells are low quality, will muddy our data, and are likely stressed or ruptured prior to encapsulation in a droplet. While 5% is quite a common cut-off, this is quite messy data, so just for kicks we’ll go more aggressive with a <code class=\"language-plaintext highlighter-rouge\">4.5%</code>.\n        <ul>\n          <li>In general, you must adapt all cut-offs to your data - metabolically active cells might have higher mitochondrial RNA in general, and you don’t want to lose a cell population because of a cut-off.</li>\n        </ul>\n      </li>\n    </ol>\n\n  </blockquote>\n</blockquote>\n\n<h2 id=\"apply-the-thresholds\">Apply the thresholds</h2>\n\n<p>It’s now time to apply these thresholds to our data! First, a reminder of how many cells and genes are in your object: <code class=\"language-plaintext highlighter-rouge\">31178 cells</code> and <code class=\"language-plaintext highlighter-rouge\">35734 genes</code>. Let’s see how that changes each time!</p>\n\n<blockquote class=\"details\">\n  <details-title>Working in a group? Decision-time!</details-title>\n  <p>If you are working in a group, you can now divide up a decision here with one <em>control</em> and the rest varied numbers so that you can compare results throughout the tutorials.</p>\n  <ul>\n    <li>Control\n      <ul>\n        <li><strong>log1p_n_genes_by_counts</strong> &gt; <code class=\"language-plaintext highlighter-rouge\">5.7</code></li>\n        <li><strong>log1p_total_counts</strong> &gt; <code class=\"language-plaintext highlighter-rouge\">6.3</code></li>\n        <li><strong>pct_counts_mito</strong> &lt; <code class=\"language-plaintext highlighter-rouge\">4.5%</code></li>\n      </ul>\n    </li>\n    <li>Everyone else: Choose your own thresholds and compare results!</li>\n  </ul>\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Filter cells by log1p_n_genes_by_counts</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_filter_cells/scanpy_filter_cells/1.8.1+galaxy0\" title=\"Scanpy FilterCells tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Scanpy FilterCells</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.8.1+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in AnnData/Loom format”</em>: <code class=\"language-plaintext highlighter-rouge\">Mito-counted AnnData</code></li>\n        <li>In <em>“Parameters to select cells to keep”</em>:\n          <ul>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Parameters to select cells to keep”</em>\n              <ul>\n                <li><em>“Name of parameter to filter on”</em>: <code class=\"language-plaintext highlighter-rouge\">log1p_n_genes_by_counts</code></li>\n                <li><em>“Min value”</em>: <code class=\"language-plaintext highlighter-rouge\">5.7</code></li>\n                <li><em>“Max value”</em>: <code class=\"language-plaintext highlighter-rouge\">20.0</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>\n      <p><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> output as <code class=\"language-plaintext highlighter-rouge\">Genes-filtered Object</code></p>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/scanpy_plot/scanpy_plot/1.7.1+galaxy1\" title=\"Plot with scanpy tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Plot with scanpy</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.7.1+galaxy1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Genes-filtered Object</code></li>\n        <li><em>“Method used for plotting”</em>: <code class=\"language-plaintext highlighter-rouge\">Generic: Violin plot, using 'pl.violin'</code>\n          <ul>\n            <li><em>“Keys for accessing variables”</em>: <code class=\"language-plaintext highlighter-rouge\">Subset of variables in 'adata.var_names' or fields of '.obs'</code>\n              <ul>\n                <li><em>“Keys for accessing variables”</em>: <code class=\"language-plaintext highlighter-rouge\">log1p_total_counts,log1p_n_genes_by_counts,pct_counts_mito</code></li>\n              </ul>\n            </li>\n            <li><em>“The key of the observation grouping to consider”</em>: <code class=\"language-plaintext highlighter-rouge\">genotype</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>\n      <p><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> output <code class=\"language-plaintext highlighter-rouge\">Violin - Filterbygenes</code></p>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.7.5+galaxy1\" title=\"Inspect AnnData tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Inspect AnnData</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.7.5+galaxy1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Genes-filtered Object</code></li>\n        <li><em>“What to inspect?”</em>: <code class=\"language-plaintext highlighter-rouge\">General information about the object</code></li>\n      </ul>\n    </li>\n    <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> output <code class=\"language-plaintext highlighter-rouge\">General - Filterbygenes</code></li>\n  </ol>\n</blockquote>\n\n<p>Note that the <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> <strong>Scanpy Filtercells</strong> allows you to put <i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> multiple parameters at the same time (i.e. filter <code class=\"language-plaintext highlighter-rouge\">log1p_total_counts</code>, <code class=\"language-plaintext highlighter-rouge\">log1p_n_genes_by_counts</code>,and <code class=\"language-plaintext highlighter-rouge\">pct_counts_mito</code>) in the same step. The only reason we aren’t doing that here is so you can see what each filter accomplishes. As such, examine your plot and general information.</p>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>Interpret the violin plot</li>\n    <li>How many genes &amp; cells do you have in your object now?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <figure id=\"figure-7\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-violin-raw-filteredgenes.png\" alt=\"Violinplot-filteronce. \" width=\"2805\" height=\"1045\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-violin-raw-filteredgenes.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 7</strong>:</span> Raw vs 1st filter - genes/cell</figcaption></figure>\n    <ol>\n      <li>The only part that seems to change is the <code class=\"language-plaintext highlighter-rouge\">log1p_n_genes_by_counts</code>.  You can see a flatter bottom to the violin plot - this is the lower threshold set. Ideally, this would create a beautiful violin plot because there would be a clear population of low-gene number cells. Sadly not the case here, but still a reasonable filter.</li>\n      <li>In <code class=\"language-plaintext highlighter-rouge\">General - Filterbygenes</code>, you can see you now have <code class=\"language-plaintext highlighter-rouge\">17,040 cells x 35,734 genes</code>.</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Filter cells by log1p_total_counts</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_filter_cells/scanpy_filter_cells/1.8.1+galaxy0\" title=\"Scanpy FilterCells tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Scanpy FilterCells</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.8.1+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in AnnData/Loom format”</em>: <code class=\"language-plaintext highlighter-rouge\">Genes-filtered Object</code></li>\n        <li>In <em>“Parameters to select cells to keep”</em>:\n          <ul>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Parameters to select cells to keep”</em>\n              <ul>\n                <li><em>“Name of parameter to filter on”</em>: <code class=\"language-plaintext highlighter-rouge\">log1p_total_counts</code></li>\n                <li><em>“Min value”</em>: <code class=\"language-plaintext highlighter-rouge\">6.3</code></li>\n                <li><em>“Max value”</em>: <code class=\"language-plaintext highlighter-rouge\">20.0</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>\n      <p><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> output as <code class=\"language-plaintext highlighter-rouge\">Counts-filtered Object</code></p>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/scanpy_plot/scanpy_plot/1.7.1+galaxy1\" title=\"Plot with scanpy tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Plot with scanpy</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.7.1+galaxy1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Counts-filtered Object</code></li>\n        <li><em>“Method used for plotting”</em>: <code class=\"language-plaintext highlighter-rouge\">Generic: Violin plot, using 'pl.violin'</code>\n          <ul>\n            <li><em>“Keys for accessing variables”</em>: <code class=\"language-plaintext highlighter-rouge\">Subset of variables in 'adata.var_names' or fields of '.obs'</code>\n              <ul>\n                <li><em>“Keys for accessing variables”</em>: <code class=\"language-plaintext highlighter-rouge\">log1p_total_counts,log1p_n_genes_by_counts,pct_counts_mito</code></li>\n              </ul>\n            </li>\n            <li><em>“The key of the observation grouping to consider”</em>: <code class=\"language-plaintext highlighter-rouge\">genotype</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>\n      <p><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> output <code class=\"language-plaintext highlighter-rouge\">Violin - Filterbycounts</code></p>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.7.5+galaxy1\" title=\"Inspect AnnData tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Inspect AnnData</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.7.5+galaxy1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Counts-filtered Object</code></li>\n        <li><em>“What to inspect?”</em>: <code class=\"language-plaintext highlighter-rouge\">General information about the object</code></li>\n      </ul>\n    </li>\n    <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> output <code class=\"language-plaintext highlighter-rouge\">General - Filterbycounts</code></li>\n  </ol>\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>Interpret the violin plot</li>\n    <li>How many genes &amp; cells do you have in your object now?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <figure id=\"figure-8\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-violin-filteredgenesxfilteredcounts.png\" alt=\"Violinplot-filtertwice. \" width=\"2759\" height=\"1090\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-violin-filteredgenesxfilteredcounts.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 8</strong>:</span> 1st filter vs 2nd filter - counts/cell</figcaption></figure>\n    <ol>\n      <li>We will focus on the <code class=\"language-plaintext highlighter-rouge\">log1p_total_counts</code> as that shows the biggest change. Similar to above, the bottom of the violin shape has flattered due to the threshold.</li>\n      <li>In <code class=\"language-plaintext highlighter-rouge\">General - Filterbycounts</code>, you can see you now have <code class=\"language-plaintext highlighter-rouge\">8,678 cells x 35,734 genes</code>.</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Filter cells by pct_counts_mito</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_filter_cells/scanpy_filter_cells/1.8.1+galaxy0\" title=\"Scanpy FilterCells tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Scanpy FilterCells</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.8.1+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in AnnData/Loom format”</em>: <code class=\"language-plaintext highlighter-rouge\">Counts-filtered Object</code></li>\n        <li>In <em>“Parameters to select cells to keep”</em>:\n          <ul>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Parameters to select cells to keep”</em>\n              <ul>\n                <li><em>“Name of parameter to filter on”</em>: <code class=\"language-plaintext highlighter-rouge\">pct_counts_mito</code></li>\n                <li><em>“Min value”</em>: <code class=\"language-plaintext highlighter-rouge\">0</code></li>\n                <li><em>“Max value”</em>: <code class=\"language-plaintext highlighter-rouge\">4.5</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>\n      <p><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> output as <code class=\"language-plaintext highlighter-rouge\">Mito-filtered Object</code></p>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/scanpy_plot/scanpy_plot/1.7.1+galaxy1\" title=\"Plot with scanpy tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Plot with scanpy</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.7.1+galaxy1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Mito-filtered Object</code></li>\n        <li><em>“Method used for plotting”</em>: <code class=\"language-plaintext highlighter-rouge\">Generic: Violin plot, using 'pl.violin'</code>\n          <ul>\n            <li><em>“Keys for accessing variables”</em>: <code class=\"language-plaintext highlighter-rouge\">Subset of variables in 'adata.var_names' or fields of '.obs'</code>\n              <ul>\n                <li><em>“Keys for accessing variables”</em>: <code class=\"language-plaintext highlighter-rouge\">log1p_total_counts,log1p_n_genes_by_counts,pct_counts_mito</code></li>\n              </ul>\n            </li>\n            <li><em>“The key of the observation grouping to consider”</em>: <code class=\"language-plaintext highlighter-rouge\">genotype</code></li>\n            <li>In <em>“Violin plot attributes”</em>:\n              <ul>\n                <li><em>“Add a stripplot on top of the violin plot”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code>\n                  <ul>\n                    <li><em>“Add a jitter to the stripplot”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n                  </ul>\n                </li>\n                <li><em>“Display keys in multiple panels”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>\n      <p><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> output <code class=\"language-plaintext highlighter-rouge\">Violin - Filterbymito</code></p>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.7.5+galaxy1\" title=\"Inspect AnnData tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Inspect AnnData</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.7.5+galaxy1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Mito-filtered Object</code></li>\n        <li><em>“What to inspect?”</em>: <code class=\"language-plaintext highlighter-rouge\">General information about the object</code></li>\n      </ul>\n    </li>\n    <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> output <code class=\"language-plaintext highlighter-rouge\">General - Filterbymito</code></li>\n  </ol>\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>Interpret the violin plot</li>\n    <li>How many genes &amp; cells do you have in your object now?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <figure id=\"figure-9\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-violin-mitofilter.png\" alt=\"Violinplot-filtermito. \" width=\"2649\" height=\"1035\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-violin-mitofilter.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 9</strong>:</span> Violin plots after filtering genes, counts, and mito content/cell</figcaption></figure>\n    <ol>\n      <li>If we carefully check the axes, we can see that the <code class=\"language-plaintext highlighter-rouge\">pct_counts_mito</code> has shrunk.</li>\n      <li>In <code class=\"language-plaintext highlighter-rouge\">General - Filterbymito</code>, you can see you now have <code class=\"language-plaintext highlighter-rouge\">8,605 cells x 35,734 genes</code>.</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<p>Here’s a quick overall summary for easy visualisation if you fancy it.</p>\n<figure id=\"figure-10\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-violins2gether.png\" alt=\"Violinplot-Summary. \" width=\"4931\" height=\"3501\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-violins2gether.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 10</strong>:</span> Filtering summary</figcaption></figure>\n\n<p>Fantastic work! However, you’ve now removed a whole heap of cells, and since the captured genes are sporadic (i.e. a small percentage of the overall transcriptome per cell) this means there are a number of genes in your matrix that are currently not in any of the remaining cells. Genes that do not appear in any cell, or even in only 1 or 2 cells, will make some analytical tools break and overall will not be biologically informative. So let’s remove them! Note that <code class=\"language-plaintext highlighter-rouge\">3</code> is not necessarily the best number, rather it is a fairly conservative threshold. You could go as high as 10 or more.</p>\n\n<blockquote class=\"details\">\n  <details-title>Working in a group? Decision-time!</details-title>\n  <p>If you are working in a group, you can now divide up a decision here with one <em>control</em> and the rest varied numbers so that you can compare results throughout the tutorials.</p>\n  <ul>\n    <li>Variable: <strong>n_cells</strong></li>\n    <li>Control &gt; <code class=\"language-plaintext highlighter-rouge\">3</code></li>\n    <li>Everyone else: Choose your own thresholds and compare results! Note if you go less than 3 (or even remove this step entirely), future tools are likely to fail due to empty gene data.</li>\n  </ul>\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Filter genes</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_filter_genes/scanpy_filter_genes/1.8.1+galaxy0\" title=\"Scanpy FilterGenes tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Scanpy FilterGenes</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.8.1+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in AnnData/Loom format”</em>: <code class=\"language-plaintext highlighter-rouge\">Mito-filtered Object</code></li>\n        <li>In <em>“Parameters to select genes to keep”</em>:\n          <ul>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Parameters to select genes to keep”</em>\n              <ul>\n                <li><em>“Name of parameter to filter on”</em>: <code class=\"language-plaintext highlighter-rouge\">n_cells</code></li>\n                <li><em>“Min value”</em>: <code class=\"language-plaintext highlighter-rouge\">3</code></li>\n                <li><em>“Max value”</em>: <code class=\"language-plaintext highlighter-rouge\">1000000000</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>\n      <p><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> output as <code class=\"language-plaintext highlighter-rouge\">Filtered Object</code></p>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.7.5+galaxy1\" title=\"Inspect AnnData tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Inspect AnnData</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.7.5+galaxy1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Filtered Object</code></li>\n        <li><em>“What to inspect?”</em>: <code class=\"language-plaintext highlighter-rouge\">General information about the object</code></li>\n      </ul>\n    </li>\n    <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> output <code class=\"language-plaintext highlighter-rouge\">General - Filtered object</code></li>\n  </ol>\n</blockquote>\n\n<p>In practice, you’ll likely choose your thresholds then set up all these filters to run without checking plots in between each one. But it’s nice to see how they work!</p>\n\n<p>Using the final <code class=\"language-plaintext highlighter-rouge\">General - Filtered object</code>, we can summarise the results of our filtering:</p>\n\n<table>\n  <thead>\n    <tr>\n      <th> </th>\n      <th>Cells</th>\n      <th>Genes</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>Raw</td>\n      <td>31178</td>\n      <td>35734</td>\n    </tr>\n    <tr>\n      <td>Filter genes/cell</td>\n      <td>17040</td>\n      <td>35734</td>\n    </tr>\n    <tr>\n      <td>Filter counts/cell</td>\n      <td>8678</td>\n      <td>35734</td>\n    </tr>\n    <tr>\n      <td>Filter mito/cell</td>\n      <td>8605</td>\n      <td>35734</td>\n    </tr>\n    <tr>\n      <td>Filter cells/gene</td>\n      <td>8605</td>\n      <td>15395</td>\n    </tr>\n  </tbody>\n</table>\n\n<p><i class=\"far fa-thumbs-up\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">congratulations</span> Congratulations! You have filtered your object! Now it should be a lot easier to analyse.</p>\n\n<h1 id=\"processing\">Processing</h1>\n\n<p>So currently, you have a matrix that is 8605 cells by 15395 genes. This is still quite big data. We have two issues here - firstly, you already know there are differences in how many transcripts and genes have been counted per cell. This technical variable can obscure biological differences. Secondly, we like to plot things on x/y plots, so for instance <em>Gapdh</em> could be on one axis, and <em>Actin</em> can be on another, and you plot cells on that 2-dimensional axis based on how many of each transcript they possess. While that would be fine, adding in a 3rd dimension (or, indeed, in this case, 15393 more dimensions), is a bit trickier! So our next steps are to transform our big data object into something that is easy to analyse and easy to visualise.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Normalisation</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_normalise_data/scanpy_normalise_data/1.8.1+galaxy0\" title=\"Scanpy NormaliseData tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Scanpy NormaliseData</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.8.1+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in AnnData/Loom format”</em>: <code class=\"language-plaintext highlighter-rouge\">Filtered Object</code></li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<p>Normalisation helps reduce the differences between gene and UMI counts by fitting total counts to 10,000 per cell. The inherent log-transform (by log(count+1)) aligns the gene expression level better with a normal distribution. This is fairly standard to prepare for any future dimensionality reduction.</p>\n\n<p>Now we need to look at reducing our gene dimensions. We have loads of genes, but not all of them are different from cell to cell. For instance, housekeeping genes are defined as not changing much from cell to cell, so we could remove these from our data to simplify the dataset. We will flag genes that vary across the cells for future analysis.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Find variable genes</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_find_variable_genes/scanpy_find_variable_genes/1.8.1+galaxy0\" title=\"Scanpy FindVariableGenes tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Scanpy FindVariableGenes</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.8.1+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in AnnData/Loom format”</em>: <code class=\"language-plaintext highlighter-rouge\">output_h5ad</code> (output of <strong>Scanpy NormaliseData</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Flavor of computing normalised dispersion”</em>: <code class=\"language-plaintext highlighter-rouge\">Seurat</code></li>\n        <li><em>“Number of top variable genes to keep, mandatory if flavor=’seurat_v3’“</em>: `` (remove the automated 2000 here and leave the space blank)</li>\n      </ul>\n    </li>\n    <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> plot output <code class=\"language-plaintext highlighter-rouge\">Use_me_FVG</code></li>\n  </ol>\n</blockquote>\n\n<p>Next up, we’re going to scale our data so that all genes have the same variance and a zero mean. This is important to set up our data for further dimensionality reduction. It also helps negate sequencing depth differences between samples, since the gene levels across the cells become comparable. Note, that the differences from scaling etc. are not the values you have at the end - i.e. if your cell has average GAPDH levels, it will not appear as a ‘0’ when you calculate gene differences between clusters.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Scaling data</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_scale_data/scanpy_scale_data/1.8.1+galaxy0\" title=\"Scanpy ScaleData tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Scanpy ScaleData</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.8.1+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in AnnData/Loom format”</em>: <code class=\"language-plaintext highlighter-rouge\">Use_me_FVG</code> (output of <strong>Scanpy FindVariableGenes</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Truncate to this value after scaling”</em>: <code class=\"language-plaintext highlighter-rouge\">10.0</code></li>\n      </ul>\n    </li>\n    <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> plot output <code class=\"language-plaintext highlighter-rouge\">Use_me_Scaled</code></li>\n  </ol>\n</blockquote>\n\n<p><i class=\"far fa-thumbs-up\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">congratulations</span> Congratulations! You have processed your object!</p>\n\n<blockquote class=\"comment\">\n  <comment-title></comment-title>\n  <p>At this point, we might want to remove or regress out the effects of unwanted variation on our data. A common example of this is the cell cycle, which can affect which genes are expressed and how much material is present in our cells. If you’re interested in learning how to do this, then you can move over to the <a href=\"/training-material/topics/single-cell/tutorials/scrna-case_cell-cycle/tutorial.html\">Removing the Effects of the Cell Cycle</a> tutorial now – then return here to complete your analysis.</p>\n</blockquote>\n\n<h1 id=\"preparing-coordinates\">Preparing coordinates</h1>\n\n<p>We still have too many dimensions. Transcript changes are not usually singular - which is to say, genes were in pathways and in groups. It would be easier to analyse our data if we could more easily group these changes.</p>\n\n<h2 id=\"principal-components\">Principal components</h2>\n<p>Principal components are calculated from highly dimensional data to find the most spread in the dataset. So in our, <code class=\"language-plaintext highlighter-rouge\">3248</code> highly variable gene dimensions, there will be one line (axis) that yields the most spread and variation across the cells. That will be our first principal component. We can calculate the first <code class=\"language-plaintext highlighter-rouge\">x</code> principal components in our data to drastically reduce the number of dimensions.</p>\n\n<blockquote class=\"comment\">\n  <comment-title>3248???</comment-title>\n  <p>Where did the <code class=\"language-plaintext highlighter-rouge\">3248</code> come from? The quickest way to figure out how many highly variable genes you have, in my opinion, is to re-run <i class=\"fas fa-redo\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-refresh</span> the <strong>Scanpy FindVariableGenes</strong> tool and select the parameter to <em>Remove genes not marked as highly variable</em>. Then you can Inspect your resulting object and you’ll see only 3248 genes. The following processing steps will use only the highly variable genes for their calculations, but I strongly suggest you keep even the nonvariable genes in (i.e., use the original output of your FindVariableGenes tool with way more than 3248 genes!), as a general rule. This tutorial will not work at the end plotting stage if you only take forward the 3248 or 2000 (if you set a limit on it) highly variable genes.</p>\n</blockquote>\n\n<blockquote class=\"warning\">\n  <warning-title>Check your AnnData object!</warning-title>\n  <p>Your AnnData object should have far more than 3248 genes in it (if you followed our settings and tool versions, you’d have a matrix 8605 × 15395 (cells x genes). Make sure to use that AnnData object output from FindVariableGenes, rather than the 3248 or 2000 output from your testing in the section above labelled ‘3248’.</p>\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Calculate Principal Components</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_run_pca/scanpy_run_pca/1.8.1+galaxy0\" title=\"Scanpy RunPCA tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Scanpy RunPCA</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.8.1+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in AnnData/Loom format”</em>: <code class=\"language-plaintext highlighter-rouge\">Use_me_Scaled</code> (output of <strong>Scanpy ScaleData</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Number of PCs to produce”</em>: <code class=\"language-plaintext highlighter-rouge\">50</code></li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/scanpy_plot/scanpy_plot/1.7.1+galaxy1\" title=\"Plot with scanpy tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Plot with scanpy</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.7.1+galaxy1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">output_h5ad</code> (output of <strong>Scanpy RunPCA</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Method used for plotting”</em>: <code class=\"language-plaintext highlighter-rouge\">PCA: Scatter plot in PCA coordinates, using 'pl.pca_variance_ratio'</code></li>\n      </ul>\n      <ul>\n        <li><em>“Number of PCs to show”</em>: <code class=\"language-plaintext highlighter-rouge\">50</code></li>\n      </ul>\n    </li>\n    <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> plot output <code class=\"language-plaintext highlighter-rouge\">PCA Variance</code></li>\n  </ol>\n</blockquote>\n\n<p>Why 50 principal components you ask? Well, we’re pretty confident 50 is an over-estimate. Examine <code class=\"language-plaintext highlighter-rouge\">PCA Variance</code>.</p>\n\n<figure id=\"figure-11\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-pcavariance.png\" alt=\"PCA-variance. \" width=\"575\" height=\"453\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-pcavariance.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 11</strong>:</span> Variability explained per PC</figcaption></figure>\n\n<p>We can see that there is really not much variation explained past component 19. So we might save ourselves a great deal of time and muddied data by focusing on the top <code class=\"language-plaintext highlighter-rouge\">20</code> PCs.</p>\n\n<h2 id=\"neighborhood-graph\">Neighborhood graph</h2>\n\n<p>We’re still looking at around 20 dimensions at this point. We need to identify how similar a cell is to another cell, across every cell across these dimensions. For this, we will use the k-nearest neighbor (kNN) graph, to identify which cells are close together and which are not. The kNN graph plots connections between cells if their distance (when plotted in this 20 dimensional space!) is amonst the k-th smallest distances from that cell to other cells. This will be crucial for identifying clusters, and is necessary for plotting a UMAP. From <a href=\"https://github.com/lmcinnes/umap\">UMAP developers</a>: “Larger neighbor values will result in more global structure being preserved at the loss of detailed local structure. In general this parameter should often be in the range 5 to 50, with a choice of 10 to 15 being a sensible default”.</p>\n\n<blockquote class=\"details\">\n  <details-title>Working in a group? Decision-time!</details-title>\n  <p>If you are working in a group, you can now divide up a decision here with one <em>control</em> and the rest varied numbers so that you can compare results throughout the tutorials.</p>\n  <ul>\n    <li>Control\n      <ul>\n        <li><strong>Number of PCs to use</strong> = <code class=\"language-plaintext highlighter-rouge\">20</code></li>\n        <li><strong>Maximum number of neighbours used</strong> = <code class=\"language-plaintext highlighter-rouge\">15</code></li>\n      </ul>\n    </li>\n    <li>Everyone else: Use the PC variance plot to pick your own PC number, and choose your own neighbour maximum as well!b</li>\n  </ul>\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>ComputeGraph</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_compute_graph/scanpy_compute_graph/1.8.1+galaxy1\" title=\"Scanpy ComputeGraph tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Scanpy ComputeGraph</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.8.1+galaxy1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in AnnData/Loom format”</em>: <code class=\"language-plaintext highlighter-rouge\">output_h5ad</code> (output of <strong>Scanpy RunPCA</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Use programme defaults”</em>: <i class=\"fas fa-toggle-on\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-toggle</span> <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n        <li><em>“Maximum number of neighbours used”</em>: <code class=\"language-plaintext highlighter-rouge\">15</code></li>\n        <li><em>“Use the indicated representation”</em>: <code class=\"language-plaintext highlighter-rouge\">X_pca</code></li>\n        <li><em>“Number of PCs to use”</em>: <code class=\"language-plaintext highlighter-rouge\">20</code></li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<h2 id=\"dimensionality-reduction-for-visualisation\">Dimensionality reduction for visualisation</h2>\n\n<p>Two major visualisations for this data are tSNE and UMAP. We must calculate the coordinates for both prior to visualisation. For tSNE, the parameter <a href=\"https://www.nature.com/articles/s41467-019-13056-x\"><strong>perplexity</strong></a> can be changed to best represent the data, while for UMAP the main change would be to change the kNN graph above itself, by changing the <strong>neighbours</strong>.</p>\n\n<blockquote class=\"details\">\n  <details-title>Working in a group? Decision-time!</details-title>\n  <p>If you are working in a group, you can now divide up a decision here with one <em>control</em> and the rest varied numbers so that you can compare results throughout the tutorials.</p>\n  <ul>\n    <li>Control\n      <ul>\n        <li><strong>Perplexity</strong> = <code class=\"language-plaintext highlighter-rouge\">30</code></li>\n      </ul>\n    </li>\n    <li>Everyone else: Choose your own perplexity, between 5 and 50!</li>\n  </ul>\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Calculating tSNE &amp; UMAP</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_run_tsne/scanpy_run_tsne/1.8.1+galaxy1\" title=\"Scanpy RunTSNE tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Scanpy RunTSNE</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.8.1+galaxy1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in AnnData/Loom format”</em>: <code class=\"language-plaintext highlighter-rouge\">output_h5ad</code> (output of <strong>Scanpy ComputeGraph</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Use the indicated representation”</em>: <code class=\"language-plaintext highlighter-rouge\">X_pca</code></li>\n        <li><em>“Use programme defaults”</em>: <i class=\"fas fa-toggle-on\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-toggle</span> <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n        <li><em>“The perplexity is related to the number of nearest neighbours, select a value between 5 and 50”</em>: <code class=\"language-plaintext highlighter-rouge\">30</code></li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_run_umap/scanpy_run_umap/1.8.1+galaxy0\" title=\"Scanpy RunUMAP tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Scanpy RunUMAP</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.8.1+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in AnnData/Loom format”</em>: <code class=\"language-plaintext highlighter-rouge\">output_h5ad</code> (output of <strong>Scanpy RunTSNE</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Use programme defaults”</em>: <i class=\"fas fa-toggle-on\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-toggle</span> <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<p><i class=\"far fa-thumbs-up\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">congratulations</span> Congratulations! You have prepared your object and created neighborhood coordinates. We can now use those to call some clusters!</p>\n\n<h1 id=\"cell-clusters--gene-markers\">Cell clusters &amp; gene markers</h1>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>Let’s take a step back here. What is it, exactly, that you are trying to get from your data? What do you want to visualise, and what information do you need from your data to gain insight?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <p>Really we need two things - firstly, we need to make sure our experiment was set up well. This is to say, our biological replicates should overlap and our variables should, ideally, show some difference. Secondly, we want insight - we want to know which cell types are in our data, which genes drive those cell types, and in this case, how they might be affected by our biological variable of growth restriction. How does this affect the developing cells, and what genes drive this? So let’s add in information about cell clusters and gene markers!</p>\n\n  </blockquote>\n\n</blockquote>\n\n<p>Finally, let’s identify clusters! Unfortunately, it’s not as majestic as biologists often think - the maths doesn’t necessarily identify true cell clusters. Every algorithm for identifying cell clusters falls short of a biologist knowing their data, knowing what cells should be there, and proving it in the lab. Sigh. So, we’re going to make the best of it as a starting point and see what happens! We will define clusters from the kNN graph, based on how many connections cells have with one another. Roughly, this will depend on a <strong>resolution</strong> parameter for how granular you want to be.</p>\n\n<blockquote class=\"details\">\n  <details-title>Working in a group? Decision-time!</details-title>\n  <p>Oh yes, yet another decision! Single cell analysis is sadly not straight forward.</p>\n  <ul>\n    <li>Control\n      <ul>\n        <li><strong>Resolution, high value for more and smaller clusters</strong> = <code class=\"language-plaintext highlighter-rouge\">0.6</code></li>\n        <li><strong>Clustering algorithm</strong> = <code class=\"language-plaintext highlighter-rouge\">Louvain</code></li>\n      </ul>\n    </li>\n    <li>Everyone else: Pick your own number. If it helps, this sample should have a lot of very similar cells in it. It contains developing T-cells, so you aren’t expecting massive differences between cells, like you would in, say, an entire embryo, with all sorts of unrelated cell types.</li>\n    <li>Everyone else: Consider the newer <strong>Leiden</strong> clustering method. Note that in future parameters, you will likely need to specify ‘leiden’ rather than ‘louvain’, which is the default, if you choose this clustering method.</li>\n  </ul>\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>FindClusters</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_find_cluster/scanpy_find_cluster/1.8.1+galaxy0\" title=\"Scanpy FindCluster tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Scanpy FindCluster</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.8.1+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in AnnData/Loom format”</em>: <code class=\"language-plaintext highlighter-rouge\">output_h5ad</code> (output of <strong>Scanpy RunUMAP</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Use programme defaults”</em>: <i class=\"fas fa-toggle-on\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-toggle</span> <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n        <li><em>“Resolution, high value for more and smaller clusters”</em>: <code class=\"language-plaintext highlighter-rouge\">0.6</code></li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<p>Nearly plotting time! But one final piece is to add in SOME gene information. Let’s focus on genes driving the clusters.</p>\n\n<h2 id=\"findmarkers\">FindMarkers</h2>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>FindMarkers</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_find_markers/scanpy_find_markers/1.8.1+galaxy0\" title=\"Scanpy FindMarkers tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Scanpy FindMarkers</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.8.1+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in AnnData/Loom format”</em>: <code class=\"language-plaintext highlighter-rouge\">output_h5ad</code> (output of <strong>Scanpy FindClusters</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n      </ul>\n    </li>\n    <li>\n      <p><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> output table (not h5ad) <code class=\"language-plaintext highlighter-rouge\">Markers - cluster</code></p>\n    </li>\n    <li><strong>Rename</strong>  <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> output h5ad file <code class=\"language-plaintext highlighter-rouge\">Final object</code></li>\n  </ol>\n\n  <p>But we are also interested in differences across genotype, so let’s also check that (note that in this case, it’s turning it almost into bulk RNA-seq, because you’re comparing all cells of a certain genotype against all cells of the other)</p>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_find_markers/scanpy_find_markers/1.8.1+galaxy0\" title=\"Scanpy FindMarkers tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Scanpy FindMarkers</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.8.1+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in AnnData/Loom format”</em>: <code class=\"language-plaintext highlighter-rouge\">Final object</code></li>\n        <li><em>“The sample grouping/clustering to use”</em>: <code class=\"language-plaintext highlighter-rouge\">genotype</code></li>\n        <li><em>“Use programme defaults”</em>: <i class=\"fas fa-toggle-on\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-toggle</span> <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n      </ul>\n    </li>\n    <li>\n      <p><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> output table (not h5ad) <code class=\"language-plaintext highlighter-rouge\">Markers - genotype</code></p>\n    </li>\n    <li>Do not <strong>Rename</strong> the output AnnData object (in fact, you can delete it!). You have the genotype marker table to enjoy, but we want to keep the cluster comparisons, rather than gene comparisons, stored in the AnnData object for later.</li>\n  </ol>\n\n</blockquote>\n\n<p>Now, there’s a small problem here, which is that if you <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> inspect the output marker tables, you won’t see gene names, you’ll see Ensembl IDs. While this is a more bioinformatically accurate way of doing this (not every ID has a gene name!), we might want to look at more well-recognised gene names, so let’s pop some of that information in!</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Adding in Gene Names</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.7.5+galaxy1\" title=\"Inspect AnnData tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Inspect AnnData</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.7.5+galaxy1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Final object</code></li>\n        <li><em>“What to inspect?”</em>: <code class=\"language-plaintext highlighter-rouge\">Key-indexed annotation of variables/features (var)</code></li>\n      </ul>\n    </li>\n  </ol>\n\n  <p>This gives us our table of all the possible genes with their names.</p>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"join1\" title=\"Join two Datasets side by side on a specified field tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Join two Datasets side by side on a specified field</strong></span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Join”</em>: <i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> Select multiple files: <code class=\"language-plaintext highlighter-rouge\">Markers - cluster</code> and <code class=\"language-plaintext highlighter-rouge\">Markers - genotype</code></li>\n        <li><em>“using column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 4</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“with”</em>: <code class=\"language-plaintext highlighter-rouge\">var</code> (output of <strong>Inspect AnnData</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“and column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 2</code></li>\n        <li><em>“Keep lines of first input that do not join with second input”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        <li><em>“Keep lines of first input that are incomplete”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        <li><em>“Fill empty columns”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n        <li><em>“Keep the header lines”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n      </ul>\n    </li>\n  </ol>\n\n  <p>We have lots of extra information we don’t need in our marker gene tables, so…</p>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"Cut1\" title=\"Cut columns from a table tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Cut columns from a table</strong></span> with the following parameters:\n      <ul>\n        <li><em>“Cut columns”</em>: <code class=\"language-plaintext highlighter-rouge\">c1,c2,c3,c4,c11,c5,c6,c7,c8</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“From”</em>: <i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> Select multiple files: <code class=\"language-plaintext highlighter-rouge\">out_file1</code> and <code class=\"language-plaintext highlighter-rouge\">output_file2</code> (outputs of <strong>Join two Datasets</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n      </ul>\n    </li>\n    <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> output tables <code class=\"language-plaintext highlighter-rouge\">Markers - cluster - named</code> and <code class=\"language-plaintext highlighter-rouge\">Markers - genotype - named</code></li>\n  </ol>\n</blockquote>\n\n<p><i class=\"far fa-thumbs-up\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">congratulations</span> Well done! It’s time for the best bit, the plotting!</p>\n\n<h1 id=\"plotting\">Plotting!</h1>\n\n<p>It’s time! Let’s plot it all!\nBut first, let’s pick some marker genes from the <code class=\"language-plaintext highlighter-rouge\">Markers-cluster</code> list that you made as well. I’ll be honest, in practice, you’d now be spending a lot of time looking up what each gene does (thank you google!). There are burgeoning automated-annotation tools, however, so long as you have a good reference (a well annotated dataset that you’ll use as the ideal). In the mean time, let’s do this the old-fashioned way, and just copy a bunch of the markers in the original paper.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Plot the cells!</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_plot_embed/scanpy_plot_embed/1.8.1+galaxy0\" title=\"Scanpy PlotEmbed tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Scanpy PlotEmbed</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.8.1+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in AnnData/Loom format”</em>: <code class=\"language-plaintext highlighter-rouge\">Final object</code></li>\n        <li><em>“name of the embedding to plot”</em>: <code class=\"language-plaintext highlighter-rouge\">pca</code></li>\n        <li><em>“color by attributes, comma separated texts”</em>: <code class=\"language-plaintext highlighter-rouge\">louvain,sex,batch,genotype,Il2ra,Cd8b1,Cd8a,Cd4,Itm2a,Aif1,log1p_total_counts</code></li>\n        <li><em>“Field for gene symbols”</em>: <code class=\"language-plaintext highlighter-rouge\">Symbol</code></li>\n        <li><em>“Use raw attributes if present”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n        <li><i class=\"fas fa-hourglass-half\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">time</span> <em>You can re-run <i class=\"fas fa-redo\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-refresh</span> the same tool again, but change <code class=\"language-plaintext highlighter-rouge\">pca</code> to <code class=\"language-plaintext highlighter-rouge\">tsne</code> and then finally to <code class=\"language-plaintext highlighter-rouge\">umap</code> in order to skip the following two steps.</em></li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_plot_embed/scanpy_plot_embed/1.8.1+galaxy0\" title=\"Scanpy PlotEmbed tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Scanpy PlotEmbed</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.8.1+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in AnnData/Loom format”</em>: <code class=\"language-plaintext highlighter-rouge\">Final object</code></li>\n        <li><em>“name of the embedding to plot”</em>: <code class=\"language-plaintext highlighter-rouge\">tsne</code></li>\n        <li><em>“color by attributes, comma separated texts”</em>: <code class=\"language-plaintext highlighter-rouge\">louvain,sex,batch,genotype,Il2ra,Cd8b1,Cd8a,Cd4,Itm2a,Aif1,log1p_total_counts</code></li>\n        <li><em>“Field for gene symbols”</em>: <code class=\"language-plaintext highlighter-rouge\">Symbol</code></li>\n        <li><em>“Use raw attributes if present”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_plot_embed/scanpy_plot_embed/1.8.1+galaxy0\" title=\"Scanpy PlotEmbed tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Scanpy PlotEmbed</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.8.1+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in AnnData/Loom format”</em>: <code class=\"language-plaintext highlighter-rouge\">Final object</code></li>\n        <li><em>“name of the embedding to plot”</em>: <code class=\"language-plaintext highlighter-rouge\">umap</code></li>\n        <li><em>“color by attributes, comma separated texts”</em>: <code class=\"language-plaintext highlighter-rouge\">louvain,sex,batch,genotype,Il2ra,Cd8b1,Cd8a,Cd4,Itm2a,Aif1,log1p_total_counts</code></li>\n        <li><em>“Field for gene symbols”</em>: <code class=\"language-plaintext highlighter-rouge\">Symbol</code></li>\n        <li><em>“Use raw attributes if present”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<p><i class=\"far fa-thumbs-up\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">congratulations</span> Congratulations! You now have plots galore!</p>\n\n<h1 id=\"insights-into-the-beyond\">Insights into the beyond</h1>\n\n<p>Now it’s the fun bit! We can see where genes are expressed, and start considering and interpreting the biology of it. At this point, it’s really about what information you want to get from your data - the following is only the tip of the iceberg. However, a brief exploration is good, because it may help give you ideas going forward with for your own data. Let us start interrogating our data!</p>\n\n<h2 id=\"biological-interpretation\">Biological Interpretation</h2>\n\n<blockquote class=\"question\">\n  <question-title>Appearance is everything</question-title>\n\n  <p>Which visualisation is the most useful for getting an overview of our data, <em>pca</em>, <em>tsne</em>, or <em>umap</em>?</p>\n  <figure id=\"figure-12\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-3visualisations.png\" alt=\"PCA-tSNE-UMAP. \" width=\"2351\" height=\"1008\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-3visualisations.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 12</strong>:</span> Louvain clustering by dimension reduction</figcaption></figure>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <p>You can see why a PCA is generally not enough to see clusters in samples - keep in mind, you’re only seeing components 1 and 2! - and therefore why the tSNE and UMAP visualisation dimensionality reductions are so useful. But there is not necessarily a clear winner between tSNE and UMAP, but I think UMAP is slightly clearer with its clusters, so we’ll stick with that for the rest of the analysis.</p>\n\n  </blockquote>\n\n</blockquote>\n\n<p>Note that the cluster numbering is based on size alone - clusters 0 and 1 are not necessarily related, they are just the clusters containing the most cells. It would be nice to know what exactly these cells are. This analysis (googling all of the marker genes, both checking where the ones you know are as well as going through the marker tables you generated!) is a fun task for any individual experiment, so we’re going to speed past that and nab the assessment from the original paper!</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>Clusters</th>\n      <th>Marker</th>\n      <th>Cell type</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>4</td>\n      <td>Il2ra</td>\n      <td>Double negative (early T-cell)</td>\n    </tr>\n    <tr>\n      <td>0,1,2,6</td>\n      <td>Cd8b1, Cd8a, Cd4</td>\n      <td>Double positive (middle T-cell)</td>\n    </tr>\n    <tr>\n      <td>5</td>\n      <td>Cd8b1, Cd8a, Cd4 - high</td>\n      <td>Double positive (late middle T-cell)</td>\n    </tr>\n    <tr>\n      <td>3</td>\n      <td>Itm2a</td>\n      <td>Mature T-cell</td>\n    </tr>\n    <tr>\n      <td>7</td>\n      <td>Aif1</td>\n      <td>Macrophages</td>\n    </tr>\n  </tbody>\n</table>\n\n<figure id=\"figure-13\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-markergeneumaps.png\" alt=\"Marker Gene UMAPs. \" width=\"3931\" height=\"1641\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-markergeneumaps.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 13</strong>:</span> Known marker gene locations</figcaption></figure>\n\n<p>The authors weren’t interested in further annotation of the DP cells, so neither are we. Sometimes that just happens. The maths tries to call similar (ish) sized clusters, whether it is biologically relevant or not. Or, the question being asked doesn’t really require such granularity of clusters.</p>\n\n<blockquote class=\"details\">\n  <details-title>Working in a group? Important!</details-title>\n  <p>If you have deviated from any of the original parameters in this tutorial, you will likely have a different number of clusters. You will, therefore, need to change the ‘Annotating clusters’ <em>“Comma-separated list of new categories”</em> accordingly. Best of luck!</p>\n\n</blockquote>\n\n<h3 id=\"annotating-clusters\">Annotating Clusters</h3>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Annotating clusters</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/anndata_manipulate/anndata_manipulate/0.7.5+galaxy1\" title=\"Manipulate AnnData tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Manipulate AnnData</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.7.5+galaxy1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Final object</code></li>\n        <li><em>“Function to manipulate the object”</em>: <code class=\"language-plaintext highlighter-rouge\">Rename categories of annotation</code></li>\n        <li><em>“Key for observations or variables annotation”</em>: <code class=\"language-plaintext highlighter-rouge\">louvain</code></li>\n        <li><em>“Comma-separated list of new categories”</em>: <code class=\"language-plaintext highlighter-rouge\">DP-M4,DP-M3,DP-M1,T-mat,DN,DP-L,DP-M2,Macrophages</code></li>\n        <li>Hang on here, though. This unfortunately deletes the original cluster numbering. Just in case you might want this back, we can add that annotation back in.</li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/anndata_ops/anndata_ops/1.8.1+galaxy0\" title=\"AnnData Operations tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>AnnData Operations</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.8.1+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in hdf5 AnnData format”</em>: <code class=\"language-plaintext highlighter-rouge\">Final object</code></li>\n        <li><em>“Copy observations (such as clusters)”</em>: <i class=\"fas fa-toggle-on\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-toggle</span> <em>Yes</em></li>\n        <li><strong>Keys from obs to copy</strong></li>\n        <li><em>”+ Insert Keys from obs to copy”</em></li>\n        <li><em>“Key contains”</em>: <code class=\"language-plaintext highlighter-rouge\">louvain</code></li>\n        <li>\n          <p><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“AnnData objects with obs to copy”</em>: (output of <strong>Manipulate AnnData</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</p>\n        </li>\n        <li>You’ve added the new cell annotations in, now titled <code class=\"language-plaintext highlighter-rouge\">louvain_0</code>. What, that’s not good enough? You want to change the title as well? So be it.</li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/anndata_ops/anndata_ops/1.8.1+galaxy0\" title=\"AnnData Operations tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>AnnData Operations</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.8.1+galaxy0)</span> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in hdf5 AnnData format”</em>: (output of <strong>AnnData Operations</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><strong>Change field names in AnnData observations</strong></li>\n        <li><i class=\"fas fa-plus\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-new</span> <em>”+ Insert Change field names in AnnData observations”</em></li>\n        <li><strong>1: Change field names in AnnData observations</strong></li>\n        <li><em>“Original name”</em>: <code class=\"language-plaintext highlighter-rouge\">louvain_0</code></li>\n        <li><em>“New name”</em>: <code class=\"language-plaintext highlighter-rouge\">cell_type</code></li>\n      </ul>\n    </li>\n    <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> output h5ad <code class=\"language-plaintext highlighter-rouge\">Final cell annotated object</code>\n      <ul>\n        <li>Time to re-plot! <i class=\"fas fa-hourglass-half\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">time</span> Feel free to re-run <i class=\"fas fa-redo\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-refresh</span> the <strong>Scanpy PlotEmbed</strong> tool <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> on the new object plotting <code class=\"language-plaintext highlighter-rouge\">cell_type</code> to speed this up. Otherwise…</li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_plot_embed/scanpy_plot_embed/1.8.1+galaxy0\" title=\"Scanpy PlotEmbed tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Scanpy PlotEmbed</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.8.1+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in AnnData/Loom format”</em>: <code class=\"language-plaintext highlighter-rouge\">Final cell annotated object</code></li>\n        <li><em>“name of the embedding to plot”</em>: <code class=\"language-plaintext highlighter-rouge\">umap</code></li>\n        <li><em>“color by attributes, comma separated texts”</em>: <code class=\"language-plaintext highlighter-rouge\">sex,batch,genotype,Il2ra,Cd8b1,Cd8a,Cd4,Itm2a,Aif1,Hba-a1,log1p_total_counts,cell_type</code></li>\n        <li><em>“Field for gene symbols”</em>: <code class=\"language-plaintext highlighter-rouge\">Symbol</code></li>\n        <li><em>“Use raw attributes if present”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<figure id=\"figure-14\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-annotatedcells.png\" alt=\"Annotated cell types. \" width=\"779\" height=\"500\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-annotatedcells.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 14</strong>:</span> Our annotated UMAP</figcaption></figure>\n\n<p>Now that we know what we’re dealing with, let’s examine the effect of our variable, proper science!</p>\n\n<blockquote class=\"question\">\n  <question-title>Genotype</question-title>\n\n  <p>Are there any differences in genotype? Or in biological terms, is there an impact of growth restriction on T-cell development in the thymus?</p>\n\n  <figure id=\"figure-15\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-genotypedifferences.png\" alt=\"Genotype Images. \" width=\"3189\" height=\"1051\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-genotypedifferences.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 15</strong>:</span> Genotype differences</figcaption></figure>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <p>We can see that DP-L, which seems to be extending away from the DP-M bunch, as well as the mature T-cells (or particularly the top half) are missing some knockout cells. Perhaps there is some sort of inhibition here? INTERESTING! What next? We might look further at the transcripts present in both those populations, and perhaps also look at the genotype marker table… So much to investigate! But before we set you off to explore to your heart’s delight, let’s also look at this a bit more technically.</p>\n\n  </blockquote>\n\n</blockquote>\n\n<h2 id=\"technical-assessment\">Technical Assessment</h2>\n\n<p>Is our analysis real? Is it right? Well, we can assess that a little bit.</p>\n\n<blockquote class=\"question\">\n  <question-title>Batch effect</question-title>\n\n  <p>Is there a batch effect?</p>\n\n  <figure id=\"figure-16\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-batcheffect.png\" alt=\"Batch effect. \" width=\"422\" height=\"343\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-batcheffect.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 16</strong>:</span> Batch effect?</figcaption></figure>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <p>While some shifts are expected and nothing to be concerned about, DP-L looks to be mainly comprised of N705. There might be a bit of batch effect, so you could consider using batch correction on this dataset. However, if we focus our attention on the other cluster - mature T-cells -  where there is batch mixing, we can still assess this biologically even without batch correction.\nAdditionally, we will also look at the confounding effect of sex.</p>\n\n    <figure id=\"figure-17\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-sex-batch.png\" alt=\"Sex effect. \" width=\"3015\" height=\"760\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-sex-batch.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 17</strong>:</span> Sex differences</figcaption></figure>\n\n    <p>We note that the one female sample - unfortunately one of the mere three knockout samples - seems to be distributed in the same areas as the knockout samples at large, so luckily, this doesn’t seem to be a confounding factor and we can still learn from our data. Ideally, this experiment would be re-run with either more female samples all around or swapping out this female from the male sample.</p>\n\n  </blockquote>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title>Depth effect</question-title>\n\n  <p>Are there any clusters or differences being driven by sequencing depth, a technical and random factor?</p>\n\n  <figure id=\"figure-18\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-umap-totalcounts.png\" alt=\"Sequencing depth. \" width=\"1921\" height=\"740\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-umap-totalcounts.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 18</strong>:</span> Counts across clusters</figcaption></figure>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <p>Eureka! This explains the odd DP shift between wildtype and knockout cells - the left side of the DP cells simply have a higher sequencing depth (UMIs/cell) than the ones on the right side. Well, that explains some of the sub-cluster that we’re seeing in that splurge. Importantly, we don’t see that the DP-L or (mostly) the mature T-cell clusters are similarly affected. So, whilst again, this variable of sequencing depth might be something to regress out somehow, it doesn’t seem to be impacting our dataset. The less you can regress/modify your data, in general, the better - you want to stay as true as you can to the raw data, and only use maths to correct your data when you really need to (and not to create insights where there are none!).</p>\n\n  </blockquote>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title>Sample purity</question-title>\n\n  <p>Do you think we processed these samples well enough?</p>\n\n  <figure id=\"figure-19\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-hba.png\" alt=\"Sequencing depth. \" width=\"503\" height=\"514\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-hba.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 19</strong>:</span> Hemoglobin across clusters</figcaption></figure>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <p>We have seen in the previous images that these clusters are not very tight or distinct, so we could consider stronger filtering. Additionally, hemoglobin - a red blood cell marker that should NOT be found in T-cells - appears throughout the entire sample in low numbers. This suggests some background in the media the cells were in, and we might consider in the wet lab trying to get a purer, happier sample, or in the dry lab, techniques such as SoupX or others to remove this background. Playing with filtering settings (increasing minimum counts/cell, etc.) is often the place to start in these scenarios.</p>\n\n  </blockquote>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title>Clustering resolution</question-title>\n\n  <p>Do you think the clustering is appropriate? i.e. are there single clusters that you think should be separate, and multiple clusters that could be combined?</p>\n\n  <figure id=\"figure-20\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-umap-itm2a.png\" alt=\"Itm2a Expression. \" width=\"1973\" height=\"754\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-umap-itm2a.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 20</strong>:</span> Itm2a across clusters</figcaption></figure>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <p>Important to note, lest all bioinformaticians combine forces to attack the biologists: just because a cluster doesn’t look like a cluster by eye is NOT enough to say it’s not a cluster! But looking at the biology here, we struggled to find marker genes to distinguish the DP population, which we know is also affected by depth of sequencing. That’s a reasonable argument that DP-M1, DP-M2, and DP-M3 might not be all that different. Maybe we need more depth of sequencing across all the DP cells, or to compare these explicitly to each other (consider variations on FindMarkers!). However, DP-L is both seemingly leaving the DP cluster and also has fewer knockout cells, so we might go and look at what DP-L is expressing in the marker genes. If we look at T-mat further, we can see that its marker gene - Itm2a - is only expressed in half of the cluster. You might consider sub-clustering this to investigate further, either through changing the resolution or through analysing this cluster alone.\nIf we look at the differences between genotypes alone (so the pseudo-bulk), we can see that most of the genes in that list are actually ribosomal. This might be a housekeeping background, this might be cell cycle related, this might be biological, or all three. You might consider investigating the cycling status of the cells, or even regressing this out (which is what the authors did).</p>\n  </blockquote>\n\n</blockquote>\n\n<p>Ultimately, there are quite a lot ways to analyse the data, both within the confines of this tutorial (the many parameters that could be changed throughout) and outside of it (batch correction, sub-clustering, cell-cycle scoring, inferred trajectories, etc.) Most analyses will still yield the same general output, though: there are fewer knockout cells in the mature T-cell population.</p>\n\n<p><i class=\"far fa-thumbs-up\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">congratulations</span> Congratulations! You have interpreted your plots in several important ways!</p>\n\n<h1 id=\"interactive-visualisations\">Interactive visualisations</h1>\n\n<p>Before we leave you to explore the unknown, you might have noticed that the above interpretations are only a few of the possible options. Plus you might have had fun trying to figure out which sample is which genotype is which sex and flicking back and forth between plots repeatedly. Figuring out which plots will be your <em>final publishable</em> plots takes a lot of time and testing. Luckily, there is a helpful interactive viewer <span class=\"citation\"><a href=\"#Cakir2020\">Cakir <i>et al.</i> 2020</a></span> export tool <span class=\"citation\"><a href=\"#Moreno2020.04.08.032698\">Moreno <i>et al.</i> 2020</a></span> that can help you explore without having to produce new plots over and over!</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Cellxgene</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"interactive_tool_cellxgene\" title=\"Interactive CellXgene Environment tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Interactive CellXgene Environment</strong></span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Concatenate dataset”</em>: <code class=\"language-plaintext highlighter-rouge\">Final cell annotated object</code></li>\n      </ul>\n    </li>\n    <li>When ready, you will see a message\n      <ul>\n        <li><i class=\"fas fa-info-circle\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">details</span> <em>There is an InteractiveTool result view available, click here to display</em> &lt;—- Click there!</li>\n      </ul>\n    </li>\n  </ol>\n\n  <p>Sometimes this link can aggravate a firewall or something similar. It should be fine to go to the site. You will be asked to <code class=\"language-plaintext highlighter-rouge\">name your annotation</code>, so do so to start playing around!</p>\n\n  <ol>\n    <li>\n      <p>You can also access it by going to <code class=\"language-plaintext highlighter-rouge\">User</code> in the top menu of Galaxy, then selecting <code class=\"language-plaintext highlighter-rouge\">Active Interactive Tools</code></p>\n    </li>\n    <li>\n      <p>You will need to <code class=\"language-plaintext highlighter-rouge\">STOP</code> this active environment in Galaxy by going to <code class=\"language-plaintext highlighter-rouge\">User</code>, <code class=\"language-plaintext highlighter-rouge\">Interactive Tools</code>, selecting the environment, and selecting <code class=\"language-plaintext highlighter-rouge\">Stop</code>. You may also want to delete the dataset in the history, because otherwise it continues appearing as if it’s processing.</p>\n    </li>\n  </ol>\n</blockquote>\n\n<p>Be warned - this visualisation tool is a powerful option for exploring your data, but it takes some time to get used to. Consider exploring it as your own tutorial for another day!</p>\n\n<h1 id=\"conclusion\">Conclusion</h1>\n\n<blockquote class=\"details\">\n  <details-title>Working in a group? The finale!</details-title>\n  <p>Hopefully, no matter which pathway of analysis you took, you found the same general interpretations. If not, this is a good time to discuss and consider with your group why that might be - what decision was ‘wrong’ or ‘ill-advised’, and how would you go about ensuring you correctly interpreted your data in the future? Top tip - trial and error is a good idea, believe it or not, and the more ways you find the same insight, the more confident you can be! But nothing beats experimental validation…\nFor those that did not take the ‘control’ options, please</p>\n  <ol>\n    <li><strong>Rename</strong> your history (by clicking on the history title) as <code class=\"language-plaintext highlighter-rouge\">DECISION-Filtering and Plotting Single-cell RNA-seq Data</code></li>\n    <li>\n      <p>Add a history annotation <i class=\"fas fa-comment\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">history-annotate</span> that includes which parameters you changed/steps you changed from the <em>control</em></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-sharing-your-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-sharing-your-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Sharing your History</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>Sharing your history allows others to import and access the datasets, parameters, and steps of your history.</p>   <p>Access the history sharing menu via the History Options dropdown (<i class=\"fas fa-bars\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-history-options</span>), and clicking “<i class=\"fas fa-share-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">history-share</span> Share or Publish”</p>   <ol>   <li><strong>Share via link</strong>     <ul>       <li>Open the <strong>History Options</strong> <i class=\"fas fa-bars\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-history-options</span> menu at the top of your history panel and select “<i class=\"fas fa-share-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">history-share</span> Share or Publish”         <ul>           <li><i class=\"fas fa-toggle-on\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-toggle</span> <strong>Make History accessible</strong></li>           <li>A <strong>Share Link</strong> will appear that you give to others</li>         </ul>       </li>       <li>Anybody who has this link can view and copy your history</li>     </ul>   </li>   <li><strong>Publish your history</strong>     <ul>       <li><i class=\"fas fa-toggle-on\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-toggle</span> <strong>Make History publicly available in Published Histories</strong></li>       <li>Anybody on this Galaxy server will see your history listed under the <em>Shared Data</em> menu</li>     </ul>   </li>   <li><strong>Share only with another user</strong>.     <ul>       <li>Click the <strong>Share with a user</strong> button at the bottom</li>       <li>Enter an email address for the user you want to share with</li>       <li>Your history will be shared only with this user.</li>     </ul>   </li>   <li><strong>Finding histories others have shared with me</strong>     <ul>       <li>Click on <strong>User</strong> menu on the top bar</li>       <li>Select <strong>Histories shared with me</strong></li>       <li>Here you will see all the histories others have shared with you directly</li>     </ul>   </li> </ol>   <p><strong>Note:</strong> If you want to make changes to your history without affecting the shared version, make a copy by going to <strong>History Options</strong> <i class=\"fas fa-bars\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-history-options</span> icon in your history and clicking <em>Copy this History</em></p> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>Feel free to explore any other similar histories</li>\n  </ol>\n</blockquote>\n\n<p><i class=\"far fa-thumbs-up\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">congratulations</span> Congratulations! You’ve made it to the end! You might find this <a href=\"https://usegalaxy.eu/u/wendi.bacon.training/h/cs3filter-plot-and-explore-single-cell-rna-seq-data---answer-key-2\">example control history</a> (<a href=\"https://usegalaxy.eu/u/j.jakiela/h/filter-plot-and-explore-single-cell-rna-seq-data-updated\">updated version</a>) helpful to compare with, or this <a href=\"https://usegalaxy.eu/u/j.jakiela/w/copy-of-filter-plot-and-explore-single-cell-rna-seq-data-imported-from-uploaded-file-3\">workflow</a>.</p>\n\n<p>In this tutorial, you moved from technical processing to biological exploration. By analysing real data - both the exciting and the messy! - you have, hopefully, experienced what it’s like to analyse and question a dataset, potentially without clear cut-offs or clear answers. If you were working in a group, you each analysed the data in different ways, and most likely found similar insights. One of the biggest problems in analysing scRNA-seq is the lack of a clearly defined pathway or parameters. You have to make the best call you can as you move through your analysis, and ultimately, when in doubt, try it multiple ways and see what happens!</p>\n\n<!--SNIPPET-->\n<blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-how-can-i-talk-with-other-users\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-how-can-i-talk-with-other-users\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: How can I talk with other users?</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p><i class=\"far fa-comments\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">feedback</span> To discuss with like-minded scientists, join our <a href=\"http://gxy.io/gtn-slack\">Galaxy Training Network chatspace in Slack</a> and discuss with fellow users of Galaxy single cell analysis tools on <a href=\"https://gtnsmrgsbord.slack.com/archives/C06PBRR40D7\">#single-cell-users</a></p>   <p>We also post new tutorials / workflows there from time to time, as well as any other news.</p>   <p><i class=\"far fa-hand-point-right\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">point-right</span> If you’d like to contribute ideas, requests or feedback as part of the wider community building single-cell and spatial resources within Galaxy, you can also join our <a href=\"https://galaxyproject.org/community/sig/singlecell/\">Single cell &amp; sPatial Omics Community of Practice</a>.</p>   <p><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> You can request tools here on our <a href=\"https://docs.google.com/spreadsheets/d/15hqgqA-RMDhXR-ylKhRF-Dab9Ij2arYSKiEVoPl2df4/edit?usp=sharing\">Single Cell and Spatial Omics Community Tool Request Spreadsheet</a></p> </blockquote>\n<p><!--END_SNIPPET--></p>\n","<h1 id=\"introducción\">Introducción</h1>\n\n<p>Has hecho el trabajo para crear una matriz de células únicas, con recuentos de genes y mitocondrias y con grupos de metadatos celulares de todas tus variables de interés (si no, por favor consulta <a href=\"/training-material/topics/single-cell/tutorials/scrna-case_alevin/tutorial.html\">este tutorial</a> para hacerlo). Ahora analizaremos completamente nuestros datos para eliminar las células con poca calidad, para reducir las dimensiones de los datos que dificultan el trabajo, y finalmente, para intentar definir nuestros agrupamientos ¡y darles significado biológico! Hay muchos paquetes para analizar datos de células únicas - Seurat <span class=\"citation\"><a href=\"#Satija2015\">Satija <i>et al.</i> 2015</a></span>, Scanpy <span class=\"citation\"><a href=\"#Wolf2018\">Wolf <i>et al.</i> 2018</a></span>, Monocle <span class=\"citation\"><a href=\"#Trapnell2014\">Trapnell <i>et al.</i> 2014</a></span>, Scater <span class=\"citation\"><a href=\"#McCarthy2017\">McCarthy <i>et al.</i> 2017</a></span>, etc. Aquí trabajaremos con Scanpy porque es la opción con más herramientas disponibles en Galaxy.</p>\n\n<blockquote class=\"comment\">\n  <comment-title>¿Tutoriales por todos lados?</comment-title>\n  <p>Este tutorial es similar a otro tutorial fantástico: <a href=\"/training-material/topics/single-cell/tutorials/scrna-scanpy-pbmc3k/tutorial.html\">Clustering 3k PBMC</a>. Este tutorial profundiza mucho más en el análisis, en particular en la visualización y la ciencia tras la identificación de marcadores. Todos los pasos se ilustran a la perfección ya que los datos experimentales están limpios y bien anotados. Aquí, trabajaremos con datos más desorganizados para ayudarte a tomar decisiones durante el análisis. Te recomendamos que sigas los tutoriales de célula única disponibles para aumentar tu confianza y experiencia. Para instructores: ten en cuenta que este tutorial dispone de opciones para grupos pequeños.</p>\n</blockquote>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n  <p>En este tutorial cubriremos:</p>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#introducción\" id=\"markdown-toc-introducción\">Introducción</a>    <ol>\n      <li><a href=\"#obtener-datos\" id=\"markdown-toc-obtener-datos\">Obtener datos</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#filtrado\" id=\"markdown-toc-filtrado\">Filtrado</a>    <ol>\n      <li><a href=\"#generar-gráficos-de-control-de-calidad\" id=\"markdown-toc-generar-gráficos-de-control-de-calidad\">Generar gráficos de control de calidad</a></li>\n      <li><a href=\"#analizando-los-gráficos\" id=\"markdown-toc-analizando-los-gráficos\">Analizando los gráficos</a></li>\n      <li><a href=\"#aplica-los-umbrales\" id=\"markdown-toc-aplica-los-umbrales\">Aplica los umbrales</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#procesamiento\" id=\"markdown-toc-procesamiento\">Procesamiento</a></li>\n  <li><a href=\"#preparación-de-coordenadas\" id=\"markdown-toc-preparación-de-coordenadas\">Preparación de coordenadas</a>    <ol>\n      <li><a href=\"#componentes-principales\" id=\"markdown-toc-componentes-principales\">Componentes principales</a></li>\n      <li><a href=\"#gráfico-de-vecindad\" id=\"markdown-toc-gráfico-de-vecindad\">Gráfico de vecindad</a></li>\n      <li><a href=\"#visualización-de-la-reducción-de-dimensionalidades\" id=\"markdown-toc-visualización-de-la-reducción-de-dimensionalidades\">Visualización de la reducción de dimensionalidades</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#clusters-de-células-y-marcadores-génicos\" id=\"markdown-toc-clusters-de-células-y-marcadores-génicos\">Clusters de células y marcadores génicos</a>    <ol>\n      <li><a href=\"#encuentra-marcadores\" id=\"markdown-toc-encuentra-marcadores\">Encuentra marcadores</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#a-visualizar-mediante-gráficos\" id=\"markdown-toc-a-visualizar-mediante-gráficos\">¡A visualizar mediante gráficos!</a></li>\n  <li><a href=\"#mirando-más-allá\" id=\"markdown-toc-mirando-más-allá\">Mirando más allá</a>    <ol>\n      <li><a href=\"#interpretación-biológica\" id=\"markdown-toc-interpretación-biológica\">Interpretación biológica</a></li>\n      <li><a href=\"#evaluación-técnica\" id=\"markdown-toc-evaluación-técnica\">Evaluación técnica</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#visualizaciones-interactivas\" id=\"markdown-toc-visualizaciones-interactivas\">Visualizaciones interactivas</a></li>\n  <li><a href=\"#conclusión\" id=\"markdown-toc-conclusión\">Conclusión</a></li>\n</ol>\n\n</blockquote>\n\n<h2 id=\"obtener-datos\">Obtener datos</h2>\n\n<p>Te proporcionamos un conjunto de datos experimentales de ratón de restricción en el crecimiento fetal <span class=\"citation\"><a href=\"#Bacon2018\">Bacon <i>et al.</i> 2018</a></span>. Este es el conjunto de datos generado a partir de <a href=\"/training-material/topics/single-cell/tutorials/scrna-case_alevin/tutorial.html\">este tutorial</a> si usaste los ficheros FASTQ completos en vez de los reducidos (ver el estudio del Single Cell Expression Atlas <a href=\"https://www.ebi.ac.uk/gxa/sc/experiments/E-MTAB-6945/results/tsne\">aquí</a> y todos los datos del proyecto <a href=\"https://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-6945/\">aquí</a>). Puedes encontrar estos datos en este <a href=\"https://humancellatlas.usegalaxy.eu/u/wendi.bacon.training/h/filter-plot-and-explore-single-cell-rna-seq-data---input\">historial de entrada</a> o descargarlo del link a Zenodo que aparece más abajo.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Subir o cargar los datos</hands-on-title>\n\n  <ol>\n    <li>Crear un nuevo historial para este tutorial</li>\n    <li>\n      <p>Importar el objeto AnnData de <a href=\"https://zenodo.org/record/4624461\">Zenodo</a></p>\n\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/4624461/files/Mito-counted_AnnData\n</code></pre></div>      </div>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importación-por-medio-de-enlaces\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importación-por-medio-de-enlaces\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Consejo: Importación por medio de enlaces</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copia los enlaces</li>   <li>     <p>Abre el manejador de carga de datos de Galaxy (<i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> en la parte superior derecha del panel de herramientas)</p>   </li>   <li>Selecciona ‘Pegar/Traer datos’ <strong>Paste/Fetch Data</strong></li>   <li>     <p>Copia los enlaces en el campo de textos</p>   </li>   <li>     <p>Presiona ‘Iniciar’ <strong>Start</strong></p>   </li>   <li>     <p><strong>Close</strong> Cierra la ventana.</p>   </li>   <li>Galaxy utiliza los URLs como nombres de forma predeterminada , así que los tendrás que cambiar a algunos que sean más útiles o informativos. the window</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li><strong>Cambiar nombre</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> de los conjuntos de datos <code class=\"language-plaintext highlighter-rouge\">Mito-counted AnnData</code></li>\n    <li>\n      <p>Verificar que el tipo o formato de los datos es <code class=\"language-plaintext highlighter-rouge\">h5ad</code></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-cambiar-el-tipo-de-datos\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-cambiar-el-tipo-de-datos\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Consejo: Cambiar el tipo de datos</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Selecciona sobre el <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>icono del lápiz</strong> para editar los atributos del conjunto de datos</li>   <li>Selecciona en la pestaña <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Datatypes</strong> en la parte superior del panel central</li>   <li>Selecciona <code class=\"language-plaintext highlighter-rouge\">h5ad</code></li>   <li>Da clic en el botón <strong>Change datatype</strong></li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h1 id=\"filtrado\">Filtrado</h1>\n\n<p>Has generado un objeto anotado de tipo AnnData a partir de tus archivos FASTQ de secuenciación de ARN de células únicas sin procesar. Sin embargo, sólo has completado un filtrado “aproximado” de tus datos - todavía hay muchas “celdas” que son fondos procedentes de gotas vacías o simplemente de baja calidad. Habrá también genes que podrían ser artefactos o que aparecen con tan baja frecuencia que las herramientas estadísticas fallan al analizarlos. Este ruido tanto en las células como en los genes no sólo hace difícil distinguir la información biológica real del ruido, sino que también intensifica la parte computacional del análisis. ¡Las lecturas espurias consumen gran parte de la capacidad computacional de analizar! Lo primero que tenemos que hacer pues es filtrar la matriz para obtener datos limpios y poder extraer información significativa para acelerar el análisis.</p>\n\n<blockquote class=\"question\">\n  <question-title>Preguntas</question-title>\n\n  <ol>\n    <li>¿Qué información se almacena en tu objeto AnnData? La última herramienta para generar este objeto contó los genes asociados a la mitocondria en tu matriz. ¿Dónde están almacenados los datos?</li>\n    <li>Mientras lo averiguas, ¿cuántos genes y células hay en tu objeto?</li>\n  </ol>\n\n  <blockquote class=\"tip\">\n    <tip-title>Pista</tip-title>\n    <p>Es preferible usar la misma herramienta que usaste en el tutorial previo para examinar tu AnnData, porque ¡no es tan sencillo como examinar el conjunto de datos Anndata en el historial!</p>\n\n    <blockquote class=\"hands_on\">\n      <hands-on-title>Inspeccionando objetos AnnData</hands-on-title>\n\n      <ol>\n        <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.7.5+galaxy0\" title=\"Inspect AnnData tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Inspect AnnData</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.7.5+galaxy0)</span> con los siguientes parámetros:\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Mito-counted AnnData</code></li>\n            <li><em>“What to inspect?”</em>: <code class=\"language-plaintext highlighter-rouge\">General information about the object</code></li>\n          </ul>\n        </li>\n        <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.7.5+galaxy0\" title=\"Inspect AnnData tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Inspect AnnData</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.7.5+galaxy0)</span> con los siguientes parámetros:\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Mito-counted AnnData</code></li>\n            <li><em>“What to inspect?”</em>: <code class=\"language-plaintext highlighter-rouge\">Key-indexed observations annotation (obs)</code></li>\n          </ul>\n        </li>\n        <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.7.5+galaxy0\" title=\"Inspect AnnData tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Inspect AnnData</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.7.5+galaxy0)</span> con los siguientes parámetros:\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Mito-counted AnnData</code></li>\n            <li><em>“What to inspect?”</em>: <code class=\"language-plaintext highlighter-rouge\">Key-indexed annotation of variables/features (var)</code></li>\n          </ul>\n        </li>\n      </ol>\n    </blockquote>\n  </blockquote>\n  <blockquote class=\"solution\">\n    <solution-title>Respuestas</solution-title>\n\n    <ol>\n      <li>Si examinas tu objeto AnnData encontrarás un número de métricas de control de calidad diferentes tanto para células <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> <strong>obs</strong> como <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> genes <strong>var</strong>.\n        <ul>\n          <li>Por ejemplo, puedes ver <code class=\"language-plaintext highlighter-rouge\">n_cells</code> bajo <strong>var</strong>, que cuenta el número de células en las que aparece el gen.</li>\n          <li>En <strong>obs</strong>, tienes métricas discretas y basadas en registros para <code class=\"language-plaintext highlighter-rouge\">n_genes</code>, cuántos genes se cuentan en una célula, y <code class=\"language-plaintext highlighter-rouge\">n_counts</code>, cuántas UMIs se cuentan por célula. Así que, por ejemplo, puedes contar múltiples GAPDHs en una célula. Por lo tanto, tu <code class=\"language-plaintext highlighter-rouge\">n_counts</code> debería ser más alto que <code class=\"language-plaintext highlighter-rouge\">n_genes</code>.</li>\n          <li>¿Pero qué ocurre con la mitocondria? Dentro de la información de las células <strong>obs</strong>, se han calculado<code class=\"language-plaintext highlighter-rouge\">total_counts_mito</code>,  <code class=\"language-plaintext highlighter-rouge\">log1p_total_counts_mito</code>, y <code class=\"language-plaintext highlighter-rouge\">pct_counts_mito</code> para cada célula.</li>\n        </ul>\n      </li>\n      <li>Puedes verlo en la salida de <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> **General information about the object ** que la matriz es <code class=\"language-plaintext highlighter-rouge\">25281 x 35734</code>. Esto es <code class=\"language-plaintext highlighter-rouge\">obs x vars</code>, o mejor, <code class=\"language-plaintext highlighter-rouge\">células x genes</code>, así que existen <code class=\"language-plaintext highlighter-rouge\">25281 células</code> y <code class=\"language-plaintext highlighter-rouge\">35734 genes</code> en la matriz.</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<p><i class=\"fas fa-hourglass-half\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">time</span> <strong>Buen consejo para ahorrar tiempo</strong> - ¡convierte las tres salidas de <strong>Inspect AnnData</strong> señaladas arriba en un workflow para tener acceso rápido!</p>\n\n<!--SNIPPET-->\n<blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-extraer-un-flujo-de-trabajo-de-tu-historial\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-extraer-un-flujo-de-trabajo-de-tu-historial\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Consejo: Extraer un flujo de trabajo de tu historial</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ol>   <li>Elimina cualquier trabajo fallido o no deseado de tu historial.</li>   <li>Haz clic en <strong>Opciones de historial</strong> (icono de engranaje <i class=\"fas fa-cog\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-gear</span>) en la parte superior del panel de historial.</li>   <li>Selecciona <strong>Extraer flujo de trabajo</strong></li>   <li>Verifica los pasos, ingresa un nombre para tu flujo de trabajo y presiona el botón <strong>Crear flujo de trabajo</strong>.</li> </ol> </blockquote>\n<p><!--END_SNIPPET--></p>\n\n<h2 id=\"generar-gráficos-de-control-de-calidad\">Generar gráficos de control de calidad</h2>\n\n<p>Queremos filtrar nuestras células, pero primero necesitamos saber cómo se ven nuestros datos. Hay un número de elecciones subjetivas por hacer en el análisis de scRNA-seq, por ejemplo ahora necesitamos nuestras mejores decisiones basadas en dónde establecer nuestros umbrales (¡más sobre eso, muy pronto!). Vamos a graficar nuestros datos en distintas formas. Distintas personas dedicadas a la bioinformática podrían preferir ver los datos de formas diferentes, y acá sólo estamos generando algunos de la miríada de gráficos que se pueden usar. En última instancia, necesitas avanzar con lo que tenga más sentido para ti.</p>\n\n<p><i class=\"fas fa-hourglass-half\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">time</span> <strong>Buen consejo para ahorrar tiempo</strong> - ¡convierte los siguientes gráficos QC en un workflow así puedes ejecutarlos de nuevo fácilmente mientras analizas tus datos!</p>\n\n<h3 id=\"creando-los-gráficos\">Creando los gráficos</h3>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Haciendo gráficos QC</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/scanpy_plot/scanpy_plot/1.7.1+galaxy0\" title=\"Plot with scanpy tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Plot with scanpy</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.7.1+galaxy0)</span> con los siguientes parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Mito-counted AnnData</code></li>\n        <li><em>“Method used for plotting”</em>: <code class=\"language-plaintext highlighter-rouge\">Generic: Violin plot, using 'pl.violin'</code>\n          <ul>\n            <li><em>“Keys for accessing variables”</em>: <code class=\"language-plaintext highlighter-rouge\">Subset of variables in 'adata.var_names' or fields of '.obs'</code>\n              <ul>\n                <li><em>“Keys for accessing variables”</em>: <code class=\"language-plaintext highlighter-rouge\">log1p_total_counts,log1p_n_genes_by_counts,pct_counts_mito</code></li>\n              </ul>\n            </li>\n            <li><em>“The key of the observation grouping to consider”</em>: <code class=\"language-plaintext highlighter-rouge\">genotype</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>\n      <p><strong>Cambiar nombre</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> salida <code class=\"language-plaintext highlighter-rouge\">Violin - genotype - log</code></p>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/scanpy_plot/scanpy_plot/1.7.1+galaxy0\" title=\"Plot with scanpy tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Plot with scanpy</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.7.1+galaxy0)</span> con los siguientes parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Mito-counted AnnData</code></li>\n        <li><em>“Method used for plotting”</em>: <code class=\"language-plaintext highlighter-rouge\">Generic: Violin plot, using 'pl.violin'</code>\n          <ul>\n            <li><em>“Keys for accessing variables”</em>: <code class=\"language-plaintext highlighter-rouge\">Subset of variables in 'adata.var_names' or fields of '.obs'</code>\n              <ul>\n                <li><em>“Keys for accessing variables”</em>: <code class=\"language-plaintext highlighter-rouge\">log1p_total_counts,log1p_n_genes_by_counts,pct_counts_mito</code></li>\n              </ul>\n            </li>\n            <li><em>“The key of the observation grouping to consider”</em>: <code class=\"language-plaintext highlighter-rouge\">sex</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>\n      <p><strong>Cambiar nombre</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> de salida a <code class=\"language-plaintext highlighter-rouge\">Violin - sex - log</code></p>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/scanpy_plot/scanpy_plot/1.7.1+galaxy0\" title=\"Plot with scanpy tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Plot with scanpy</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.7.1+galaxy0)</span> con los siguientes parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Mito-counted AnnData</code></li>\n        <li><em>“Method used for plotting”</em>: <code class=\"language-plaintext highlighter-rouge\">Generic: Violin plot, using 'pl.violin'</code>\n          <ul>\n            <li><em>“Keys for accessing variables”</em>: <code class=\"language-plaintext highlighter-rouge\">Subset of variables in 'adata.var_names' or fields of '.obs'</code>\n              <ul>\n                <li><em>“Keys for accessing variables”</em>: <code class=\"language-plaintext highlighter-rouge\">log1p_total_counts,log1p_n_genes_by_counts,pct_counts_mito</code></li>\n              </ul>\n            </li>\n            <li><em>“The key of the observation grouping to consider”</em>: <code class=\"language-plaintext highlighter-rouge\">batch</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>\n      <p><strong>Cambiar nombre</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> de salida a <code class=\"language-plaintext highlighter-rouge\">Violin - batch - log</code></p>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/scanpy_plot/scanpy_plot/1.7.1+galaxy0\" title=\"Plot with scanpy tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Plot with scanpy</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.7.1+galaxy0)</span> con los siguientes parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Mito-counted AnnData</code></li>\n        <li><em>“Method used for plotting”</em>: <code class=\"language-plaintext highlighter-rouge\">Generic: Scatter plot along observations or variables axes, using 'pl.scatter'</code>\n          <ul>\n            <li><em>“Plotting tool that computed coordinates”</em>: <code class=\"language-plaintext highlighter-rouge\">Using coordinates</code>\n              <ul>\n                <li><em>“x coordinate”</em>: <code class=\"language-plaintext highlighter-rouge\">log1p_total_counts</code></li>\n                <li><em>“y coordinate”</em>: <code class=\"language-plaintext highlighter-rouge\">pct_counts_mito</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>\n      <p><strong>Cambiar nombre</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> de salida a <code class=\"language-plaintext highlighter-rouge\">Scatter - mito x UMIs</code></p>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/scanpy_plot/scanpy_plot/1.7.1+galaxy0\" title=\"Plot with scanpy tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Plot with scanpy</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.7.1+galaxy0)</span> con los siguientes parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Mito-counted AnnData</code></li>\n        <li><em>“Method used for plotting”</em>: <code class=\"language-plaintext highlighter-rouge\">Generic: Scatter plot along observations or variables axes, using 'pl.scatter'</code>\n          <ul>\n            <li><em>“Plotting tool that computed coordinates”</em>: <code class=\"language-plaintext highlighter-rouge\">Using coordinates</code>\n              <ul>\n                <li><em>“x coordinate”</em>: <code class=\"language-plaintext highlighter-rouge\">log1p_n_genes_by_counts</code></li>\n                <li><em>“y coordinate”</em>: <code class=\"language-plaintext highlighter-rouge\">pct_counts_mito</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>\n      <p><strong>Cambiar nombre</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> de salida a <code class=\"language-plaintext highlighter-rouge\">Scatter - mito x genes</code></p>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/scanpy_plot/scanpy_plot/1.7.1+galaxy0\" title=\"Plot with scanpy tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Plot with scanpy</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.7.1+galaxy0)</span> con los siguientes parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Mito-counted AnnData</code></li>\n        <li><em>“Method used for plotting”</em>: <code class=\"language-plaintext highlighter-rouge\">Generic: Scatter plot along observations or variables axes, using 'pl.scatter'</code>\n          <ul>\n            <li><em>“Plotting tool that computed coordinates”</em>: <code class=\"language-plaintext highlighter-rouge\">Using coordinates</code>\n              <ul>\n                <li><em>“x coordinate”</em>: <code class=\"language-plaintext highlighter-rouge\">log1p_total_counts</code></li>\n                <li><em>“y coordinate”</em>: <code class=\"language-plaintext highlighter-rouge\">log1p_n_genes_by_counts</code></li>\n                <li><em>“Color by”</em>: <code class=\"language-plaintext highlighter-rouge\">pct_counts_mito</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li><strong>Cambiar nombre</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> de salida a <code class=\"language-plaintext highlighter-rouge\">Scatter - genes x UMIs</code></li>\n  </ol>\n\n</blockquote>\n\n<h2 id=\"analizando-los-gráficos\">Analizando los gráficos</h2>\n\n<p>¡Eso fue mucha información! Abordemos por secciones y veamos qué preguntas pueden ayudar a resolver estos gráficos. El <em>scratchbook</em> <i class=\"fas fa-th\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-scratchbook</span> puede ser útil aquí para ver los distintos gráficos al mismo tiempo.</p>\n\n<!--SNIPPET-->\n<blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-uso-del-cuaderno-de-apuntes-para-ver-varios-conjuntos-de-datos\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-uso-del-cuaderno-de-apuntes-para-ver-varios-conjuntos-de-datos\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Consejo: Uso del cuaderno de apuntes para ver varios conjuntos de datos</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>Si deseas ver dos o más conjuntos de datos al mismo tiempo, puedes usar la función <strong>Scratchbook</strong> en Galaxy:     1. <strong>Haz clic</strong> en el icono <em>Scratchbook</em> <i class=\"fas fa-th\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-scratchbook</span> en la barra de menú superior.        - Debería aparecer ver una pequeña marca de verificación en el icono     2. <strong>Ver</strong> <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> un conjunto de datos haciendo clic en el icono de ojo <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> para ver el resultado.        - Deberías ver la salida en una ventana emergente sobre Galaxy        - Puedes cambiar el tamaño de esta ventana arrastrando la esquina inferior derecha     3. <strong>Haz clic</strong> fuera del archivo para salir del Scratchbook     4. <strong>Ver</strong> <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> un segundo conjunto de datos de tu historial        - Ahora deberías poder ver una segunda ventana con el nuevo conjunto de datos        - Esto hace que sea más fácil comparar las dos salidas.     5. Repite estos pasos para todos los archivos que desees comparar.     6. Puedes desactivar <strong>Scratchbook</strong> <i class=\"fas fa-th\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-scratchbook</span> haciendo clic en el icono nuevamente.</p> </blockquote>\n<p><!--END_SNIPPET--></p>\n\n<blockquote class=\"question\">\n  <question-title>Pregunta - Variación en lote</question-title>\n\n  <p>¿Existen diferencias en la profundidad de secuenciación a lo largo de las muestras?</p>\n  <ol>\n    <li>¿Qué gráfico(s) da(n) cuenta de esto?</li>\n    <li>¿Cómo lo interpretas?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title>Respuesta</solution-title>\n\n    <ol>\n      <li>¡El diagrama <code class=\"language-plaintext highlighter-rouge\">violin - batch - log</code> tendrá todo lo que buscas!\n        <figure id=\"figure-1\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-violin-batch-log.png\" alt=\"Violin - batch - log. \" width=\"2018\" height=\"413\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-violin-batch-log.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figura 1</strong>:</span> Violin - lote - log (Datos crudos)</figcaption></figure>\n      </li>\n      <li>Teniendo en cuenta que está en escala logarítmica - lo que significa que pequeñas diferencias pueden significar grandes diferencias - la representación en forma de violín tiene probablemente un aspecto similar.\n        <ul>\n          <li><code class=\"language-plaintext highlighter-rouge\">N707</code> y <code class=\"language-plaintext highlighter-rouge\">N703</code> podría presentar unos valores de conteo y de genes (o UMIs) un poco bajos, pero las diferencias no son catastróficas.</li>\n          <li>El <code class=\"language-plaintext highlighter-rouge\">pct_counts_mito</code> se mantiene similar en los diferentes lotes, una buena señal.</li>\n          <li>En este caso, nada parece indicar que tengamos que eliminar una muestra de nuestro análisis, pero si ves algo completamente diferente del resto, ¡tendrás que cuestionarte por qué y eliminarlo de tu experimento!</li>\n        </ul>\n      </li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title>Pregunta - Variables biológicas</question-title>\n\n  <p>¿Hay diferencias en la profundidad de secuenciación en los diferentes sexos? ¿Genotipos?</p>\n  <ol>\n    <li>¿Qué gráfico aborda esto?</li>\n    <li>¿Cómo interpretas las diferencias en <code class=\"language-plaintext highlighter-rouge\">sex</code>?</li>\n    <li>¿Cómo interpretas las diferencias en <code class=\"language-plaintext highlighter-rouge\">genotype</code>?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title>Respuesta</solution-title>\n\n    <ol>\n      <li>Al igual que anteriormente, los diagramas <code class=\"language-plaintext highlighter-rouge\">violin - sex - log</code> y <code class=\"language-plaintext highlighter-rouge\">violin - genotype - log</code> tendrán lo que buscas.\n        <figure id=\"figure-2\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-violin-sex-log.png\" alt=\"Violin - sex - log. \" width=\"2018\" height=\"413\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-violin-sex-log.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figura 2</strong>:</span> Violin - sexo - log (Datos crudos)</figcaption></figure>\n        <figure id=\"figure-3\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-violin-genotype-log.png\" alt=\"Violin - genotype - log. \" width=\"2018\" height=\"413\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-violin-genotype-log.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figura 3</strong>:</span> Violin - genotipo - log (Datos crudos)</figcaption></figure>\n      </li>\n      <li>No hay grandes diferencias en profundidad de secuenciación en los diferentes sexos diría yo - ¡aunque tú puedes no estar de acuerdo!\n        <ul>\n          <li>Está claro que hay menos células femeninas, cosa que tiene sentido dado que sólo una de las muestras era femenina. <em>Nota - esto fue un descubrimiento desafortunado tras la generación de librerías. ¡Es bastante difícil identificar el sexo de neonatos en el laboratorio! En la práctica, intenta no dejar que un factor así influya en tus datos! Podrías considerar volver a ejecutar todos los análisis que vienen a continuación sin la muestra femenina si quieres.</em></li>\n        </ul>\n      </li>\n      <li>Sin embargo, en el gráfico <code class=\"language-plaintext highlighter-rouge\">Violin - genotype - log</code>, podemos ver que hay una diferencia. Las muestras <code class=\"language-plaintext highlighter-rouge\">knockout</code> tienen claramente menos genes y conteos. Desde el punto de vista experimental, ¿tiene esto sentido?\n        <ul>\n          <li>¿Sería esperado desde el punto de vista biológico que esas células sean menores o tengan menos transcritos? Posiblemente, en este caso, dado que esas células fueron generadas de ratones neonatales con restricción de crecimiento y en cuyo caso no tenemos que preocuparnos sobre buenos datos, sino tener en mente esto cuando generamos agrupaciones, ya que queremos definir la profundidad de los clusters, ¡queremos que la biología lo haga!</li>\n          <li>Por otro lado, podría ser que esas células no sobrevivieron la disociación tan bien como las células sanas (en cuyo caso esperaríamos más genes asociados a la mitocondria, que no vemos, ¡así que podemos descartarlo!).</li>\n          <li>Quizás preparamos pobremente las librerías para esas muestras knockout concretamente. Hay solo tres, así que puede que esas muestras estén poco secuenciadas.</li>\n          <li>Entonces, ¿Qué hacemos con todo esto?\n            <ul>\n              <li>Idealmente, consideramos la re-secuenciación de todas las muestras pero con una concentración más alta de muestras knockout en la librería.\nCualquier persona experta en bioinformática te diría que la mejor forma de obtener datos limpios es en el laboratorio ¡y no en el ordenador! Desgraciadamente, las mejores prácticas no son necesariamente una opción realista en el laboratorio - por ejemplo, ¡la línea celular de ratón fue larga! - así que a veces, tenemos que obtener lo mejor de nuestros datos. Hay opciones para intentar abordar la discrepancia en la profundidad de secuenciación. Por tanto, vamos a continuar con las muestras y ver si podemos encontrar relevancia biológica a pesar de las diferencias técnicas.</li>\n            </ul>\n          </li>\n        </ul>\n      </li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<p>Ahora que hemos evaluado la diferencia en nuestras muestras, miraremos a las librerías en general para identificar los umbrales apropiados para nuestro análisis.</p>\n\n<blockquote class=\"question\">\n  <question-title>Pregunta - Filtrar umbrales</question-title>\n\n  <p>¿Qué umbral deberías fijar para <code class=\"language-plaintext highlighter-rouge\">log1p_n_genes_by_counts</code>?</p>\n  <ol>\n    <li>¿Qué diagramas abordan esto?</li>\n    <li>¿Qué número elegirías?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title>Respuesta</solution-title>\n\n    <ol>\n      <li>Cualquier diagrama con <code class=\"language-plaintext highlighter-rouge\">log1p_n_genes_by_counts</code> funcionaría aquí en realidad. Algunas personas prefieren diagramas de dispersión frente a los diagramas de violín.</li>\n    </ol>\n    <figure id=\"figure-4\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-scatter-genesxmito.png\" alt=\"Scatter-genesxmito. \" width=\"609\" height=\"413\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-scatter-genesxmito.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figura 4</strong>:</span> Dispersión - mito x genes (Datos crudos)</figcaption></figure>\n\n    <ol>\n      <li>En <code class=\"language-plaintext highlighter-rouge\">Scatter - mito x genes</code> puedes ver cómo las células con <code class=\"language-plaintext highlighter-rouge\">log1p_n_genes_by_counts</code> hasta, quizás, <code class=\"language-plaintext highlighter-rouge\">5.7</code> (sobre 300 genes) a menudo tienen alto <code class=\"language-plaintext highlighter-rouge\">pct_counts_mito</code>.\n        <ul>\n          <li>Puedes representar esto como <code class=\"language-plaintext highlighter-rouge\">n_counts</code> y ver la misma tendencia alrededor de 300 genes, pero con estos datos el formato logarítmico es más claro, y así lo presentaremos.</li>\n          <li>Podrías usar también el diagrama de violín para encontrar un umbral y por tanto también tener en cuenta los lotes. Es bueno mirar el diagrama de violín también, porque no queremos eliminar completamente una muestra de forma accidental (por ejemplo, N703 y N707).</li>\n          <li>Algunas personas expertas en bioinformática recomendarían filtrar cada muestra individualmente, pero esto es difícil a larga escala y en este caso (¡te invitamos a intentarlo! Tendrías que filtrar por separado y concatenar después), no habría una diferencia notable en la interpretación final.</li>\n        </ul>\n      </li>\n    </ol>\n\n  </blockquote>\n\n  <p>¿Qué umbral deberías fijar para <code class=\"language-plaintext highlighter-rouge\">log1p_total_counts</code>?</p>\n  <ol>\n    <li>¿Qué diagramas abordan esto?</li>\n    <li>¿Qué número elegirías?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title>Respuesta</solution-title>\n\n    <ol>\n      <li>Como anteriormente, ¡cualquier diagrama con <code class=\"language-plaintext highlighter-rouge\">log1p_n_total_counts</code> funcionaría! De nuevo, usaremos un diagrama de dispersión aquí, ¡pero puedes usar un diagram de violín si quieres!</li>\n    </ol>\n    <figure id=\"figure-5\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-scatter-countsxmito.png\" alt=\"Scatter-countsxmito. \" width=\"609\" height=\"413\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-scatter-countsxmito.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figura 5</strong>:</span> Gráfico de dispersión - mito x UMIs (Datos crudos)</figcaption></figure>\n\n    <ol>\n      <li>Podemos ver que necesitaremos fijar un umbral más alto (lo que tiene sentido, ya que esperaríamos más UMIs por célula que genes únicos). De nuevo, quizás siendo un poco agresivos en nuestros umbrales, podríamos elegir <code class=\"language-plaintext highlighter-rouge\">6.3</code>, por ejemplo (que equivale a unos 500 conteos/célula).\n        <ul>\n          <li>En un mundo ideal, verás claramente una población de células reales separada de una clara población de células restantes. Muchas muestras, como esta, han sido poco secuenciadas y esa separación se vería probablemente mejor tras la secuenciación profunda!</li>\n        </ul>\n      </li>\n    </ol>\n\n  </blockquote>\n\n  <p>¿Qué umbral elegirías para <code class=\"language-plaintext highlighter-rouge\">pct_counts_mito</code>?</p>\n  <ol>\n    <li>¿Qué diagramas abordan esto?</li>\n    <li>¿Qué número elegirías?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title>Respuesta</solution-title>\n\n    <ol>\n      <li>Cualquier plot con <code class=\"language-plaintext highlighter-rouge\">pct_counts_mito</code> funcionaría bien, sin embargo, los diagramas de dispersión son más fáciles de interpretar. Los usaremos igual que la última vez.</li>\n    </ol>\n    <figure id=\"figure-6\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-scatter-countsxmito.png\" alt=\"Scatter-countsxmito. \" width=\"609\" height=\"413\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-scatter-countsxmito.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figura 6</strong>:</span> Gráfico de dispersión - mito x UMIs (Datos crudos)</figcaption></figure>\n\n    <ol>\n      <li>Podemos ver una tendencia clara donde las células que tienen sobre un 5% de conteo mito o superior también tienen muchos menos conteos totales. Estas células tienen baja calidad, enturbiarán nuestros datos, y han estado posiblemente sometidas a condiciones de estrés o ruptura previa a la encapsulación en la gota. Aunque el 5% es un corte bastante común, estos datos son bastante complicados, así que solo por diversión elegiremos un umbral más agresivo de un <code class=\"language-plaintext highlighter-rouge\">4.5%</code>.\n        <ul>\n          <li>En general debes adaptar tus puntos de corte a tus datos - las células más activas metabólicamente podrían tener un RNA mitocondrial más alto, y no quieres perder parte de la población de células debido a un corte muy agresivo.</li>\n        </ul>\n      </li>\n    </ol>\n\n  </blockquote>\n</blockquote>\n\n<h2 id=\"aplica-los-umbrales\">Aplica los umbrales</h2>\n\n<p>¡Es el momento de aplicar estos umbrales a tus datos! Pero primero recordemos cuántas células y genes se encuentran en tu objeto: <code class=\"language-plaintext highlighter-rouge\">25281 células</code> y <code class=\"language-plaintext highlighter-rouge\">35734 genes</code>. ¡Veamos cómo van cambiando estos conteos!</p>\n\n<blockquote class=\"details\">\n  <details-title>¿Estás trabajando en grupo? ¡Hora decisiva!</details-title>\n  <p>Si estás trabajando en grupo, en este punto puedes tomar diversas direcciones, una con un <em>control</em> y el resto con variaciones en los números con las cuales puedas comparar los resultados a lo largo de los tutoriales.</p>\n  <ul>\n    <li>Control\n      <ul>\n        <li><strong>log1p_n_genes_by_counts</strong> &gt; <code class=\"language-plaintext highlighter-rouge\">5.7</code></li>\n        <li><strong>log1p_total_counts</strong> &gt; <code class=\"language-plaintext highlighter-rouge\">6.3</code></li>\n        <li><strong>pct_counts_mito</strong> &lt; <code class=\"language-plaintext highlighter-rouge\">4.5%</code></li>\n      </ul>\n    </li>\n    <li>Todos los demás: ¡Seleccionen sus propios umbrales y comparen los resultados!</li>\n  </ul>\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Filtra las células por log1p_n_genes_by_counts</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_filter_cells/scanpy_filter_cells/1.6.0+galaxy0\" title=\"Scanpy FilterCells tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Scanpy FilterCells</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.6.0+galaxy0)</span> con los siguientes parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in AnnData/Loom format”</em>: <code class=\"language-plaintext highlighter-rouge\">Mito-counted AnnData</code></li>\n        <li>En <em>“Parameters to select cells to keep”</em>:\n          <ul>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Parameters to select cells to keep”</em>\n              <ul>\n                <li><em>“Name of parameter to filter on”</em>: <code class=\"language-plaintext highlighter-rouge\">log1p_n_genes_by_counts</code></li>\n                <li><em>“Min value”</em>: <code class=\"language-plaintext highlighter-rouge\">5.7</code></li>\n                <li><em>“Max value”</em>: <code class=\"language-plaintext highlighter-rouge\">20.0</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>\n      <p><strong>Cambiar nombre</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> de salida a <code class=\"language-plaintext highlighter-rouge\">Genes-filtered Object</code></p>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/scanpy_plot/scanpy_plot/1.7.1+galaxy0\" title=\"Plot con scanpy tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Plot con scanpy</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.7.1+galaxy0)</span> con los siguientes parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Genes-filtered Object</code></li>\n        <li><em>“Method used for plotting”</em>: <code class=\"language-plaintext highlighter-rouge\">Generic: Violin plot, using 'pl.violin'</code>\n          <ul>\n            <li><em>“Keys for accessing variables””</em>: <code class=\"language-plaintext highlighter-rouge\">Subset of variables in 'adata.var_names' or fields of '.obs'</code>\n              <ul>\n                <li><em>“Keys for accessing variables”</em>: <code class=\"language-plaintext highlighter-rouge\">log1p_total_counts,log1p_n_genes_by_counts,pct_counts_mito</code></li>\n              </ul>\n            </li>\n            <li><em>“he key of the observation grouping to consider”</em>: <code class=\"language-plaintext highlighter-rouge\">genotype</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>\n      <p><strong>Cambiar nombre</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> de salida a <code class=\"language-plaintext highlighter-rouge\">Violin - Filterbygenes</code></p>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.7.5+galaxy0\" title=\"Inspect AnnData tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Inspect AnnData</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.7.5+galaxy0)</span> con los siguientes parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Genes-filtered Object</code></li>\n        <li><em>“What to inspect??”</em>: <code class=\"language-plaintext highlighter-rouge\">General information about the object</code></li>\n      </ul>\n    </li>\n    <li><strong>Cambiar nombre</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> de salida a <code class=\"language-plaintext highlighter-rouge\">General - Filterbygenes</code></li>\n  </ol>\n</blockquote>\n\n<p>Nota que <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> <strong>Scanpy Filtercells</strong> te permite poner <i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> múltiples parámetros al mismo tiempo (ejm. los filtros <code class=\"language-plaintext highlighter-rouge\">log1p_total_counts</code>, <code class=\"language-plaintext highlighter-rouge\">log1p_n_genes_by_counts</code>,y <code class=\"language-plaintext highlighter-rouge\">pct_counts_mito</code>) en el mismo paso. La única razón por la que no estamos haciendo eso aquí es para que puedas ver lo que cada filtro logra. Como tal, examina tu plot y la información general.</p>\n\n<blockquote class=\"question\">\n  <question-title>Preguntas</question-title>\n\n  <ol>\n    <li>Interpreta el gráfico de violín</li>\n    <li>¿Cuántos genes y células tienes ahora en tu objeto?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title>Solución</solution-title>\n\n    <figure id=\"figure-7\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-violin-raw-filteredgenes.png\" alt=\"Violinplot-filteronce. \" width=\"2805\" height=\"1045\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-violin-raw-filteredgenes.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figura 7</strong>:</span> Datos crudos vs el primer filtrado - genes/células</figcaption></figure>\n    <ol>\n      <li>La única parte que parece haber cambiado es <code class=\"language-plaintext highlighter-rouge\">log1p_n_genes_by_counts</code>. Observa que la parte inferior del gráfico de violín está más plano - este es el umbral más bajo que se ha establecido. Idealmente, esto hubiera creado un hermoso diagrama de violín debido a que habría una clara población de células con bajo número de genes. Desafortunadamente, este no es el caso, pero sigue siendo un filtro razonable.</li>\n      <li>Puedes ver en <code class=\"language-plaintext highlighter-rouge\">General - Filterbygenes</code> que ahora tienes <code class=\"language-plaintext highlighter-rouge\">14,501 cells x 35,734 genes</code>.</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Filtrar células con base en log1p_total_counts</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_filter_cells/scanpy_filter_cells/1.6.0+galaxy0\" title=\"Scanpy FilterCells tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Scanpy FilterCells</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.6.0+galaxy0)</span> con los siguientes parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“nput object in AnnData/Loom format”</em>: <code class=\"language-plaintext highlighter-rouge\">Genes-filtered Object</code></li>\n        <li>En <em>“Parameters to select cells to keep”</em>:\n          <ul>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Parameters to select cells to keep”</em>\n              <ul>\n                <li><em>“Name of parameter to filter on”</em>: <code class=\"language-plaintext highlighter-rouge\">log1p_total_counts</code></li>\n                <li><em>“Min value”</em>: <code class=\"language-plaintext highlighter-rouge\">6.3</code></li>\n                <li><em>“Max value”</em>: <code class=\"language-plaintext highlighter-rouge\">20.0</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>\n      <p><strong>Cambiar nombre</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> de salida a <code class=\"language-plaintext highlighter-rouge\">Counts-filtered Object</code></p>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/scanpy_plot/scanpy_plot/1.7.1+galaxy0\" title=\"Plot with  scanpy tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Plot with  scanpy</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.7.1+galaxy0)</span> utilizando los siguientes parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Counts-filtered Object</code></li>\n        <li><em>“Method used for plotting”</em>: <code class=\"language-plaintext highlighter-rouge\">Generic: Violin plot, using 'pl.violin'</code>\n          <ul>\n            <li><em>“Keys for accessing variables”</em>: <code class=\"language-plaintext highlighter-rouge\">Subset of variables in 'adata.var_names' or fields of '.obs'</code>\n              <ul>\n                <li><em>“Keys for accessing variables”</em>: <code class=\"language-plaintext highlighter-rouge\">log1p_total_counts,log1p_n_genes_by_counts,pct_counts_mito</code></li>\n              </ul>\n            </li>\n            <li><em>“The key of the observation grouping to consider”</em>: <code class=\"language-plaintext highlighter-rouge\">genotype</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>\n      <p><strong>Cambiar nombre</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> de salida a <code class=\"language-plaintext highlighter-rouge\">Violin - Filterbycounts</code></p>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.7.5+galaxy0\" title=\"Inspect  AnnData tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Inspect  AnnData</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.7.5+galaxy0)</span> con los siguientes parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Counts-filtered Object</code></li>\n        <li><em>“What to inspect?”</em>: <code class=\"language-plaintext highlighter-rouge\">General information about the object</code></li>\n      </ul>\n    </li>\n    <li><strong>Cambiar nombre</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> de la salida a <code class=\"language-plaintext highlighter-rouge\">General - Filterbycounts</code></li>\n  </ol>\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title>Preguntas</question-title>\n\n  <ol>\n    <li>Interpreta el gráfico de violín</li>\n    <li>¿Cuántos genes y células tienes ahora en tu objeto?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title>Solución</solution-title>\n\n    <figure id=\"figure-8\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-violin-filteredgenesxfilteredcounts.png\" alt=\"Violinplot-filtertwice. \" width=\"2759\" height=\"1090\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-violin-filteredgenesxfilteredcounts.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figura 8</strong>:</span> 1er filtro vs 2do filtro - conteos/célula</figcaption></figure>\n    <ol>\n      <li>Nos enfocaremos en <code class=\"language-plaintext highlighter-rouge\">log1p_total_counts</code>. De manera similar a la superior, la parte inferior de la forma del violín se ha aplanado debido al umbral.</li>\n      <li>En <code class=\"language-plaintext highlighter-rouge\">General - Filterbycounts</code>, puedes ver que ahora tienes <code class=\"language-plaintext highlighter-rouge\">7,916 cells x 35,734 genes</code>.</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Filtrar células con base en pct_counts_mito</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_filter_cells/scanpy_filter_cells/1.6.0+galaxy0\" title=\"Scanpy FilterCells tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Scanpy FilterCells</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.6.0+galaxy0)</span> utilizando los siguientes parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in AnnData/Loom format”</em>: <code class=\"language-plaintext highlighter-rouge\">Counts-filtered Object</code></li>\n        <li>En <em>“Parameters to select cells to keep”</em>:\n          <ul>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Parameters to select cells to keep”</em>\n              <ul>\n                <li><em>“Name of parameter to filter on”</em>: <code class=\"language-plaintext highlighter-rouge\">pct_counts_mito</code></li>\n                <li><em>“Min value”</em>: <code class=\"language-plaintext highlighter-rouge\">0</code></li>\n                <li><em>“Max value”</em>: <code class=\"language-plaintext highlighter-rouge\">4.5</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>\n      <p><strong>Cambiar nombre</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> de la salida a <code class=\"language-plaintext highlighter-rouge\">Mito-filtered Object</code></p>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/scanpy_plot/scanpy_plot/1.7.1+galaxy0\" title=\"Plot with scanpy tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Plot with scanpy</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.7.1+galaxy0)</span> utilizando los siguientes parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Mito-filtered Object</code></li>\n        <li><em>“Method used for plotting”</em>: <code class=\"language-plaintext highlighter-rouge\">Generic: Violin plot, using 'pl.violin'</code>\n          <ul>\n            <li><em>“Keys for accessing variables”</em>: <code class=\"language-plaintext highlighter-rouge\">Subset of variables in 'adata.var_names' or fields of '.obs'</code>\n              <ul>\n                <li><em>“Keys for accessing variables”</em>: <code class=\"language-plaintext highlighter-rouge\">log1p_total_counts,log1p_n_genes_by_counts,pct_counts_mito</code></li>\n              </ul>\n            </li>\n            <li><em>“The key of the observation grouping to consider”</em>: <code class=\"language-plaintext highlighter-rouge\">genotype</code></li>\n            <li>En <em>“Violin plot attributes”</em>:\n              <ul>\n                <li><em>“Add a stripplot on top of the violin plot”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code>\n                  <ul>\n                    <li><em>“Add a jitter to the stripplot”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n                  </ul>\n                </li>\n                <li><em>“Display keys in multiple panels”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>\n      <p><strong>Cambiar nombre</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> de salida a <code class=\"language-plaintext highlighter-rouge\">Violin - Filterbymito</code></p>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.7.5+galaxy0\" title=\"Inspect  AnnData tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Inspect  AnnData</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.7.5+galaxy0)</span> con los siguientes parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Mito-filtered Object</code></li>\n        <li><em>“What to inspect?”</em>: <code class=\"language-plaintext highlighter-rouge\">General information about the object</code></li>\n      </ul>\n    </li>\n    <li><strong>Cambiar nombre</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> de salida a <code class=\"language-plaintext highlighter-rouge\">General - Filterbymito</code></li>\n  </ol>\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title>Preguntas</question-title>\n\n  <ol>\n    <li>Interpretar el gráfico de violín</li>\n    <li>¿Cuántos genes y células tienes ahora en tu objeto?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title>Solución</solution-title>\n\n    <figure id=\"figure-9\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-violin-mitofilter.png\" alt=\"Violinplot-filtermito. \" width=\"2649\" height=\"1035\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-violin-mitofilter.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figura 9</strong>:</span> Gráficos de violín después del filtrado de genes, conteos y mito contenido/célula</figcaption></figure>\n    <ol>\n      <li>Si observamos los ejes detalladamente podemos ver que el <code class=\"language-plaintext highlighter-rouge\">pct_counts_mito</code> se ha reducido.</li>\n      <li>En <code class=\"language-plaintext highlighter-rouge\">General - Filterbymito</code>, puedes ver que ahora tienes <code class=\"language-plaintext highlighter-rouge\">7,874 × cells x 35,734 genes</code>.</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<p>Si te es de ayuda, aquí tenemos un vistazo al resumen general.</p>\n<figure id=\"figure-10\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-violins2gether.png\" alt=\"Violinplot-Summary. \" width=\"4931\" height=\"3501\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-violins2gether.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figura 10</strong>:</span> Resumen de filtrado</figcaption></figure>\n\n<p>¡Excelente trabajo! Sin embargo, eliminaste un montón de células, y ya que los genes capturados son esporádicos (ejemplo, un pequeño porcentaje del transcriptoma completo por célula), esto significa que hay un número de genes en tu matriz que al momento no están en ninguna de las células restantes. Los genes que no aparecen en ninguna célula, ni siquiera en una o dos células, causarán que algunas de las herramientas analíticas funcionen incorrectamente (o dejen de funcionar) y en general, no serán informativos con respecto a la biología del fenómeno analizado. !Entonces eliminemos estos genes! Nota que <code class=\"language-plaintext highlighter-rouge\">3</code> no es necesariamente el mejor número, más bien es un umbral bastante conservador. Podrías subir hasta 10 o más.</p>\n\n<blockquote class=\"details\">\n  <details-title>¿Estás trabajando en grupo? ¡Tomemos algunas decisiones!</details-title>\n  <p>Ahora pueden trabajar en equipos y hacer distintos análisis, un equipo optando por un <em>control</em> y el resto variando números de tal forma que puedan comparar resultados a lo largo de los tutoriales.</p>\n  <ul>\n    <li>Variable: <strong>n_cells</strong></li>\n    <li>Control &gt; <code class=\"language-plaintext highlighter-rouge\">3</code></li>\n    <li>Todos los demás: ¡Escojan sus propios umbrales y comparen resultados! Noten que si dan valores menores a 3 (o si omiten este paso por completo), es muy posible que las herramientas que utilizaremos posteriormente no funcionen debido a la falta de datos de genes.</li>\n  </ul>\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Filtrado de genes</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_filter_genes/scanpy_filter_genes/1.6.0+galaxy0\" title=\"Scanpy FilterGenes tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Scanpy FilterGenes</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.6.0+galaxy0)</span> con los siguientes parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in AnnData/Loom format”</em>: <code class=\"language-plaintext highlighter-rouge\">Mito-filtered Object</code></li>\n        <li>En <em>“Parameters to select genes to keep”</em>:\n          <ul>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Parameters to select genes to keep”</em>\n              <ul>\n                <li><em>“Name of parameter to filter on”</em>: <code class=\"language-plaintext highlighter-rouge\">n_cells</code></li>\n                <li><em>“Min value”</em>: <code class=\"language-plaintext highlighter-rouge\">3</code></li>\n                <li><em>“Max value”</em>: <code class=\"language-plaintext highlighter-rouge\">1000000000</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>\n      <p><strong>Cambiar nombre</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> de salida a <code class=\"language-plaintext highlighter-rouge\">Filtered Object</code></p>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.7.5+galaxy0\" title=\"Inspect  AnnData tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Inspect  AnnData</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.7.5+galaxy0)</span> con los siguientes parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Matriz anotada de datos”</em>: <code class=\"language-plaintext highlighter-rouge\">Filtered Object</code></li>\n        <li><em>“¿Qué inspeccionar?”</em>: <code class=\"language-plaintext highlighter-rouge\">General information about the object</code></li>\n      </ul>\n    </li>\n    <li><strong>Cambiar nombre</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> de salida a <code class=\"language-plaintext highlighter-rouge\">General - Filtered object</code></li>\n  </ol>\n</blockquote>\n\n<p>En la práctica, es muy probable que escojas umbrales y después configures el sistema para aplicar todos estos filtros omitiendo la revisión de gráficos de resultados intermedios. Sin embargo, es muy informativo ver cómo se van modificando los datos con estos filtros.</p>\n\n<p>Utilizando el <code class=\"language-plaintext highlighter-rouge\">General - Filtered object</code> final, puedes obtener un resumen de tus resultados de filtrado:</p>\n\n<table>\n  <thead>\n    <tr>\n      <th> </th>\n      <th>Células</th>\n      <th>Genes</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>Datos crudos</td>\n      <td>25281</td>\n      <td>35734</td>\n    </tr>\n    <tr>\n      <td>Filtro genes/célula</td>\n      <td>14501</td>\n      <td>35734</td>\n    </tr>\n    <tr>\n      <td>Filtro conteos/célula</td>\n      <td>7916</td>\n      <td>35734</td>\n    </tr>\n    <tr>\n      <td>Filtro mito/célula</td>\n      <td>7874</td>\n      <td>35734</td>\n    </tr>\n    <tr>\n      <td>Filtro células/gene</td>\n      <td>7874</td>\n      <td>14832</td>\n    </tr>\n  </tbody>\n</table>\n\n<p><i class=\"far fa-thumbs-up\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">congratulations</span> ¡Felicitaciones, has filtrado tu objeto! Ahora será más fácil su análisis.</p>\n\n<h1 id=\"procesamiento\">Procesamiento</h1>\n\n<p>Por el momento tienes una matriz de 7874 células por 14832 genes. Estos son muchos datos. Tenemos dos problemas aquí - primero, ya sabes que hay diferencias en cuántos transcritos y genes han sido cuantificados por células. Esta variable técnica puede no dejar muy en claro diferencias biológicas. Segundo, nos encanta visualizar resultados en gráficos x/y. Por ejemplo, <em>Gapdh</em> puede ser uno de los ejes, y <em>Actin</em> puede ser otro, y grafica las células en los ejes bidimensionales con base en cuántos transcritos posee cada una. Esto puede ser bueno, pero añadir una tercera dimensión (o en este caso, 14830 dimensiones más) es un poco más complejo. Por tanto, nuestros siguientes pasos se enfocan en transformar nuestro enorme objeto de datos en algo que sea más fácil de analizar y visualizar.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Normalización</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_normalise_data/scanpy_normalise_data/1.6.0+galaxy0\" title=\"Scanpy NormaliseData tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Scanpy NormaliseData</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.6.0+galaxy0)</span> con los siguientes parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in AnnData/Loom format”</em>: <code class=\"language-plaintext highlighter-rouge\">Filtered Object</code></li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<p>La normalización ayuda a reducir las diferencias entre los genes y los conteos UMI por medio del ajuste de conteos totales a 10,000 por célula. La transformación logarítmica “log-transform(by log(cont+1))” alinea de mejor manera los niveles de expresión génica a una distribución normal. Este es un procedimiento común al prepararnos para cualquier reducción de dimensionalidad.</p>\n\n<p>Ahora tenemos que considerar la reducción de las dimensiones de nuestros genes. Tenemos muchísimos genes, pero no todos ellos son diferentes de célula a célula. Por ejemplo, los genes de mantenimiento (housekeeping) se caracterizan por no tener mucho cambio de célula a célula, por tanto podremos moverlos para simplificar el conjunto de datos. Marcaremos los genes que muestran variación entre células para su análisis posterior.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Encuentra los genes variables</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_find_variable_genes/scanpy_find_variable_genes/1.6.0+galaxy0\" title=\"Scanpy FindVariableGenes tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Scanpy FindVariableGenes</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.6.0+galaxy0)</span> con los siguientes parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in AnnData/Loom format”</em>: <code class=\"language-plaintext highlighter-rouge\">output_h5ad</code> (salida de  <strong>Scanpy NormaliseData</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Flavor of computing normalised dispersion”</em>: <code class=\"language-plaintext highlighter-rouge\">Seurat</code></li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<p>Ahora vamos a escalar nuestros datos de tal manera que todos los genes tengan la misma varianza y cero de media. Es importante configurar nuestros datos para reducciones de dimensionalidad subsecuentes. También ayuda a anular las diferencias de profundidad de secuenciación entre muestras. Nota que las diferencias de escala, entre otras, no son los valores que tendrás al final (ejemplo, si tu célula tiene niveles promedio de GAPDH), no aparecerá como ‘0’ cuando calcules las diferencias de genes entre clusters.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Escalar datos</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_scale_data/scanpy_scale_data/1.6.0+galaxy0\" title=\"Scanpy ScaleData tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Scanpy ScaleData</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.6.0+galaxy0)</span> utilizando los siguiente parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in AnnData/Loom format”</em>: <code class=\"language-plaintext highlighter-rouge\">output_h5ad</code> (salida de <strong>Scanpy FindVariableGenes</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Truncate to this value after scaling”</em>: <code class=\"language-plaintext highlighter-rouge\">10.0</code></li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<p><i class=\"far fa-thumbs-up\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">congratulations</span> ¡Felicitaciones, has procesado tu objeto!</p>\n\n<h1 id=\"preparación-de-coordenadas\">Preparación de coordenadas</h1>\n\n<p>Seguimos teniendo demasiadas dimensiones. Los cambios de transcritos usualmente no son singulares, es decir, los genes estaban en rutas (metabólicas, biológicas, etc.) y en grupos. Sería más fácil analizar nuestros datos si pudiéramos agrupar estos cambios.</p>\n\n<h2 id=\"componentes-principales\">Componentes principales</h2>\n<p>Los componentes principales se calculan a partir de datos con alta dimensionalidad para poder encontrar la mayor dispersión en el conjunto de datos. Así es que, en nuestras <code class=\"language-plaintext highlighter-rouge\">2262</code> dimensiones con gran variabilidad, tendremos una línea (eje) que refleje la mayor dispersión y variación a través de las células. Ese será nuestro Componente Principal. Podemos calcular los primeros componentes principales <code class=\"language-plaintext highlighter-rouge\">x</code> en nuestros datos para reducir drásticamente el número de dimensiones.</p>\n\n<blockquote>\n  <comment-title>¿2262?</comment-title>\n  <p>¿De dónde proviene el <code class=\"language-plaintext highlighter-rouge\">2262</code>? La forma más rápida de figurar cuantos genes tienes con alta variabilidad, en mi opinión, es volver a ejecutar <i class=\"fas fa-redo\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-refresh</span> la herramienta <strong>Scanpy FindVariableGenes</strong> y seleccionar el parámetro <em>Remove genes not marked as highly variable</em> (“eliminar genes que no están marcados con alta variabilidad”). Después puedes inspeccionar el objeto resultante y verás que hay sólo 2262 genes. En los siguientes pasos el proceso únicamente utilizará los genes con alta variabilidad para realizar sus cálculos, pero como regla general, te recomiendo encarecidamente que incluyas los genes no variables (ejemplo, utiliza la salida general de tu herramienta FindVariableGenes, la cual contiene más de 2262 genes). Este tutorial no funcionará al final de la etapa de graficación si únicamente utilizas solo los 2262 o 2000 genes con alta variabilidad (si es que le impones algún límite).</p>\n</blockquote>\n\n<blockquote class=\"comment hands_on\">\n  <hands-on-title>Cálculo de los Componentes Principales</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_run_pca/scanpy_run_pca/1.6.0+galaxy1\" title=\"Scanpy RunPCA tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Scanpy RunPCA</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.6.0+galaxy1)</span> utilizando los siguientes parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in AnnData/Loom format”</em>: <code class=\"language-plaintext highlighter-rouge\">output_h5ad</code> (salida de <strong>Scanpy ScaleData</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Number of PCs to producer”</em>: <code class=\"language-plaintext highlighter-rouge\">50</code></li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/scanpy_plot/scanpy_plot/1.7.1+galaxy0\" title=\"Plot with scanpy tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Plot with scanpy</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.7.1+galaxy0)</span> utilizando los siguientes parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">output_h5ad</code> (salida de <strong>Scanpy RunPCA</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Method used for plotting”</em>: <code class=\"language-plaintext highlighter-rouge\">PCA: Scatter plot in PCA coordinates, using 'pl.pca_variance_ratio'</code></li>\n      </ul>\n      <ul>\n        <li><em>“Number of PCs to show”</em>: <code class=\"language-plaintext highlighter-rouge\">50</code></li>\n      </ul>\n    </li>\n    <li><strong>Cambiar nombre</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> del gráfico de salida a <code class=\"language-plaintext highlighter-rouge\">PCA Variance</code></li>\n  </ol>\n</blockquote>\n\n<p>¿Te cuestionas el por qué 50 Componentes Principales? Bueno, estamos bastante seguros de que 50 es una sobreestimación. Examina <code class=\"language-plaintext highlighter-rouge\">PCA Variance</code>.</p>\n\n<figure id=\"figure-11\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-pcavariance.png\" alt=\"PCA-variance. \" width=\"575\" height=\"453\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-pcavariance.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figura 11</strong>:</span> Variabilidad explicada por CP</figcaption></figure>\n\n<p>Podemos ver que en realidad no existe mucha variación que pueda ser explicada una vez que pasamos del componente 19. Así es que nos ahorraremos un buen de tiempo y datos confusos si nos enfocamos en los primeros <code class=\"language-plaintext highlighter-rouge\">20</code> CPs.</p>\n\n<h2 id=\"gráfico-de-vecindad\">Gráfico de vecindad</h2>\n\n<p>En este punto seguimos enfocándonos en aproximadamente 20 dimensiones. Necesitamos identificar qué tan similar es una célula comparada con otra, esto a través de cada célula y a través de estas dimensiones. Para esto, utilizaremos el gráfico de “k-nearest neighbor” (kNN - k vecindades más cercanas), para identificar qué células se encuentran más cercanas unas de otras y cuáles no. El gráfico kNN muestra las conexiones entre las células si sus distancias son casi las k-ésimas distancias más cortas de esa célula con respecto a las otras (¡cuando son graficadas en este espacio de 20 dimensiones). Esto será crucial para identificar clusters, y es necesario para graficar un UMAP. Asignar valores mayores de vecindad dará pie a la preservación de una estructura más global a costa de la pérdida de una estructura local detallada. En general, a este parámetro frecuentemente se le asignan valores entre el 5 y el 50, con la opción de asignar por defecto valores de 10 a 15](https://github.com/lmcinnes/umap).</p>\n\n<blockquote class=\"details\">\n  <details-title>¿Estás trabajando en grupos? ¡Tomemos decisiones!</details-title>\n  <p>Si estás trabajando en grupos ahora pueden dividir el trabajo, unos pueden trabajar con un  <em>control</em> y el resto trabajar con distintos números para que puedan comparar sus resultados posteriormente por lo que resta del tutorial.</p>\n  <ul>\n    <li>Control\n      <ul>\n        <li><strong>Number of PCs to use</strong> = <code class=\"language-plaintext highlighter-rouge\">20</code></li>\n        <li><strong>Maximum number of neighbours used</strong> = <code class=\"language-plaintext highlighter-rouge\">15</code></li>\n      </ul>\n    </li>\n    <li>Todos los demás: Utiliza el gráfico de varianza de CP para seleccionar tu propio número de CP y selecciona tu propio número máximo de vecinos a utilizar.</li>\n  </ul>\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Cómputo de gráfico - ComputeGraph</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_compute_graph/scanpy_compute_graph/1.6.0+galaxy4\" title=\"Scanpy ComputeGraph tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Scanpy ComputeGraph</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.6.0+galaxy4)</span> utilizando los siguientes parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in AnnData/Loom format”</em>: <code class=\"language-plaintext highlighter-rouge\">output_h5ad</code> (salida de <strong>Scanpy RunPCA</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Use programme defaults”</em>: <i class=\"fas fa-toggle-on\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-toggle</span> <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n        <li><em>“Maximum number of neighbours used”</em>: <code class=\"language-plaintext highlighter-rouge\">15</code></li>\n        <li><em>“Number of PCs to use”</em>: <code class=\"language-plaintext highlighter-rouge\">20</code></li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<h2 id=\"visualización-de-la-reducción-de-dimensionalidades\">Visualización de la reducción de dimensionalidades</h2>\n\n<p>Dos visualizaciones importantes en estos datos son tSNE y UMAP. Debemos calcular las coordenadas para ambos antes de la visualización. Para tSNE, el parámetro <a href=\"https://www.nature.com/articles/s41467-019-13056-x\"><strong>perplexity</strong></a> puede ser cambiado de tal manera que represente de mejor forma a los datos, mientras que para UMAP el cambio principal sería el modificar en sí mismo el gráfico kNN, por medio del cambio de <strong>neighbours</strong> (vecinos).</p>\n\n<blockquote class=\"details\">\n  <details-title>¿Estás trabajando en grupos? ¡Tomemos decisiones!</details-title>\n  <p>Si estás trabajando en grupos ahora pueden dividir el trabajo, unos pueden trabajar con un <em>control</em> y el resto trabajar con distintos números para que posteriormente puedan comparar sus resultados por lo que resta del tutorial.</p>\n  <ul>\n    <li>Control\n      <ul>\n        <li><strong>Perplejidad</strong> = <code class=\"language-plaintext highlighter-rouge\">30</code></li>\n      </ul>\n    </li>\n    <li>Todos los demás: Seleccionen su propia perplejidad, ¡entre 5 y 50!</li>\n  </ul>\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Cálculo de  tSNE y UMAP</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_run_tsne/scanpy_run_tsne/1.6.0+galaxy2\" title=\"Scanpy RunTSNE tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Scanpy RunTSNE</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.6.0+galaxy2)</span> utilizando los siguientes parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in AnnData/Loom format”</em>: <code class=\"language-plaintext highlighter-rouge\">output_h5ad</code> (salida de <strong>Scanpy ComputeGraph</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Use programme defaults”</em>: <i class=\"fas fa-toggle-on\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-toggle</span> <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n        <li><em>“The perplexity is related to the number of nearest neighbours, select a value between 5 and 50”</em>: <code class=\"language-plaintext highlighter-rouge\">30</code></li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_run_umap/scanpy_run_umap/1.6.0+galaxy1\" title=\"Scanpy RunUMAP tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Scanpy RunUMAP</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.6.0+galaxy1)</span> utilizando los siguientes parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in AnnData/Loom format”</em>: <code class=\"language-plaintext highlighter-rouge\">output_h5ad</code> (salida de <strong>Scanpy RunTSNE</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Use programme defaults”</em>: <i class=\"fas fa-toggle-on\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-toggle</span> <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<p><i class=\"far fa-thumbs-up\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">congratulations</span> ¡Felicitaciones! Has preparado tu objeto y creado las coordenadas de la vecindad. ¡Ahora podemos utilizarlos para ver algunos clusters!</p>\n\n<h1 id=\"clusters-de-células-y-marcadores-génicos\">Clusters de células y marcadores génicos</h1>\n\n<blockquote class=\"question\">\n  <question-title>Pregunta</question-title>\n\n  <p>Tomemos un poco de distancia y examinemos qué tenemos. ¿Qué es exactamente lo que quieres obtener de tus datos?¿Qué quieres visualizar y qué necesitas de tus datos para obtener información?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title>Solución</solution-title>\n\n    <p>En realidad necesitamos dos cosas - primero, necesitamos asegurarnos que nuestro experimento fue bien configurado. Es decir, que nuestras réplicas biológicas deberían superponerse, e idealmente, nuestras variables deberían mostrar diferencias entre sí. Segundo, queremos obtener conocimiento a partir de este experimento - queremos saber qué tipo de células se encuentran presentes en nuestros datos, qué genes controlan este tipo de células, y en este caso, cómo podrían verse afectados por nuestra variable biológica de restricción del crecimiento. ¿Cómo afecta esto a las células en desarrollo y que genes lo controlan? Por tanto, ¡añadamos información sobre los agrupamientos de células y los marcadores génicos!</p>\n\n  </blockquote>\n\n</blockquote>\n\n<p>Por fin, ¡identifiquemos clusters! Por desgracia, esto no es tan “majestuoso” como los biólogos creen  - las matemáticas empleadas no necesariamente identifican clusters de células verdaderos. Cada algoritmo utilizado para identificar clusters de células se queda corto en el contexto de un biólogo que conoce bien sus datos, que sabe qué células deberían estar presentes, y que puede probarlo en el laboratorio. Por tanto, ¡vamos a aprovecharlo al máximo como punto de partida y veremos qué sucede! Vamos a definir los clusters del gráfico kNN con base en cuántas conexiones tienen las células unas con otras. Aproximadamente, esto dependerá de un parámetro de “resolución” (<strong>resolution</strong>) para identificar qué tan granular quieres hacer este proceso.</p>\n\n<blockquote class=\"details\">\n  <details-title>¿Estás trabajando en grupos? ¡Tomemos decisiones!</details-title>\n  <p>Ah sí, ¡también tenemos que tomar otra decisión! Lamentablemente, el análisis de células únicas no es algo tan sencillo.</p>\n  <ul>\n    <li>Control\n      <ul>\n        <li><strong>Resolución, valores altos para obtener mayor nùmero de clusters de menor tamaño</strong> = <code class=\"language-plaintext highlighter-rouge\">0.6</code></li>\n        <li><strong>Algoritmo de agrupamiento</strong> = <code class=\"language-plaintext highlighter-rouge\">Louvain</code></li>\n      </ul>\n    </li>\n    <li>Todos los demás: Escojan un valor. Si es de ayuda, en este ejemplo deberás ver un montón de células muy similares. Contiene células-T en desarrollo, por tanto no se esperan diferencias masivas entre células, como las que esperarías, por así decirlo, en un embrión entero, con todo tipo de células no relacionadas.</li>\n    <li>Todos los demás: Consideren el nuevo método de agurpamiento <strong>Leiden</strong>. Nota que para los parámetros que utilizaremos subsecuentemente, es muy probable que necesites especificar ‘leiden’ en lugar de ‘louvain’, qué es el valor por defecto si escoges este método de agrupamiento.</li>\n  </ul>\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Encontrar agrupamientos - FindClusters</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_find_cluster/scanpy_find_cluster/1.6.0+galaxy4\" title=\"Scanpy FindCluster tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Scanpy FindCluster</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.6.0+galaxy4)</span> utilizando los siguientes parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in AnnData/Loom format”</em>: <code class=\"language-plaintext highlighter-rouge\">output_h5ad</code> (salida de <strong>Scanpy RunUMAP</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Utilizar los valores por defecto del programa”</em>: <i class=\"fas fa-toggle-on\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-toggle</span> <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n        <li><em>“Resolución, valores altos para mayor cantidad de clusters de menor tamaño”</em>: <code class=\"language-plaintext highlighter-rouge\">0.6</code></li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<p>¡Ya casi es hora de graficar! Pero añadamos una pieza final ALGUNA información génica. Enfoquémonos en los genes que están dando pie a los clusters.</p>\n\n<h2 id=\"encuentra-marcadores\">Encuentra marcadores</h2>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Encuentra marcadores</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_find_markers/scanpy_find_markers/1.6.0+galaxy3\" title=\"Scanpy FindMarkers tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Scanpy FindMarkers</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.6.0+galaxy3)</span>  con los siguientes parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in AnnData/Loom format”</em>: <code class=\"language-plaintext highlighter-rouge\">output_h5ad</code> (salida de <strong>Scanpy FindClusters</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Use programme defaults”</em>: <i class=\"fas fa-toggle-on\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-toggle</span> <code class=\"language-plaintext highlighter-rouge\">No</code> &lt;— Confía en mí, hay un fallo extraño en algunas versiones de la herramienta que se soluciona simplemente marcando <code class=\"language-plaintext highlighter-rouge\">No</code> aquí &gt;</li>\n      </ul>\n    </li>\n    <li>\n      <p><strong>Cambiar nombre</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> tabla de salida (not h5ad) <code class=\"language-plaintext highlighter-rouge\">Markers - cluster</code></p>\n    </li>\n    <li><strong>Cambiar nombre</strong>  <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> del documento de salida h5ad <code class=\"language-plaintext highlighter-rouge\">Final object</code></li>\n  </ol>\n\n  <p>Pero también estamos interesados en las diferencias entre los genotipos, así que también comprobemos eso (ten en cuenta que en este caso se está convirtiendo en un análisis de RNA-seq masivo, porque estamos comparando todas las células de un determinado genotipo contra todas las células del otro)</p>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_find_markers/scanpy_find_markers/1.6.0+galaxy4\" title=\"Scanpy FindMarkers tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Scanpy FindMarkers</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.6.0+galaxy4)</span> con los siguientes parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in AnnData/Loom format”</em>: <code class=\"language-plaintext highlighter-rouge\">Final object</code></li>\n        <li><em>“The sample grouping/clustering to use”</em>: <code class=\"language-plaintext highlighter-rouge\">genotype</code></li>\n        <li><em>“Use programme defaults”</em>: <i class=\"fas fa-toggle-on\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-toggle</span> <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n      </ul>\n    </li>\n    <li>\n      <p><strong>Cambiar nombre</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> de la tabla de salida (no h5ad) a <code class=\"language-plaintext highlighter-rouge\">Markers - genotype</code></p>\n    </li>\n    <li>No <strong>Cambiar el nombre</strong> del objeto de salida AnnData (de hecho, puedes eliminarlo). Tienes la tabla de marcadores de genotipo para disfrutarla, pero queremos mantener las comparaciones de agrupamiento, en lugar de las comparaciones de genes, almacenadas en el objeto AnnData para más tarde.</li>\n  </ol>\n\n</blockquote>\n\n<p>Ahora, hay un pequeño problema aquí, y es que cuando inspeccionas la tabla de salida de marcadores, no verás nombres de genes, sino que verás los IDs de Ensembl. Aunque esta es una forma más precisa de hacerlo desde el punto de vista bioinformático (¡cada ID no tiene un nombre de gen!), es probable que queramos ver los nombres de los genes más reconocidos ¡así que introduzcamos algo de esa información!</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Añadir los nombres de los genes</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.7.5+galaxy0\" title=\"Inspect AnnData tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Inspect AnnData</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.7.5+galaxy0)</span> con los siguientes parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Final object</code></li>\n        <li><em>“What to inspect?”</em>: <code class=\"language-plaintext highlighter-rouge\">Key-indexed annotation of variables/features (var)</code></li>\n      </ul>\n    </li>\n  </ol>\n\n  <p>Esto proporciona a nuestra tabla todos los posibles genes con sus nombres.</p>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"join1\" title=\"Join two Datasets side by side on a specified field tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Join two Datasets side by side on a specified field</strong></span> con los siguientes parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Join”</em>: <i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> Select multiple files: <code class=\"language-plaintext highlighter-rouge\">Markers - cluster</code> and <code class=\"language-plaintext highlighter-rouge\">Markers - genotype</code></li>\n        <li><em>“using column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 4</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“with”</em>: <code class=\"language-plaintext highlighter-rouge\">var</code> (salida de <strong>Inspect AnnData</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“and column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 2</code></li>\n        <li><em>“Keep lines of first input that do not join with second input”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        <li><em>“Keep lines of first input that are incomplete”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        <li><em>“Fill empty columns”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n        <li><em>“Keep the header lines”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n      </ul>\n    </li>\n  </ol>\n\n  <p>Tenemos una gran cantidad de información extra en nuestra tabla de marcadores de genes que no necesitamos, así que..</p>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"Cut1\" title=\"Cut columns from a table tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Cut columns from a table</strong></span> con los siguientes parámetros:\n      <ul>\n        <li><em>“Cut columns”</em>: <code class=\"language-plaintext highlighter-rouge\">c1,c2,c3,c4,c11,c5,c6,c7,c8</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“From”</em>: <i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> Selecciona varios documentos: <code class=\"language-plaintext highlighter-rouge\">out_file1</code> y <code class=\"language-plaintext highlighter-rouge\">output_file2</code> (salidas de <strong>Join two Datasets</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n      </ul>\n    </li>\n    <li><strong>Cambiar nombre</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> tablas de salida <code class=\"language-plaintext highlighter-rouge\">Markers - cluster - named</code> and <code class=\"language-plaintext highlighter-rouge\">Markers - genotype - named</code></li>\n  </ol>\n</blockquote>\n\n<p><i class=\"far fa-thumbs-up\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">congratulations</span> ¡Bien hecho! Ha llegado la hora de la mejor parte, ¡la representación gráfica!</p>\n\n<h1 id=\"a-visualizar-mediante-gráficos\">¡A visualizar mediante gráficos!</h1>\n\n<p>¡Ya es hora! ¡Vamos a representar gráficamente todo!\nPero primero, escojamos algunos genes marcadores de la lista de “agrupamiento de marcadores” que también hiciste. Para ser honesto, en la práctica, ahora estarías gastando un montón de tiempo buscando lo que hace cada gen (gracias a Google). Sin embargo, existen cada vez más herramientas de anotación automatizada, siempre y cuando tengas una buena referencia (conjunto de datos bien anotado que usarás como ideal). Mientras tanto, hagamos esto a la antigua, y simplemente copiemos un montón de marcadores en el documento original.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>¡Representemos gráficamente las células!</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_plot_embed/scanpy_plot_embed/1.6.0+galaxy0\" title=\"Scanpy PlotEmbed tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Scanpy PlotEmbed</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.6.0+galaxy0)</span> con los siguientes parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in AnnData/Loom format”</em>: <code class=\"language-plaintext highlighter-rouge\">Final object</code></li>\n        <li><em>“name of the embedding to plot”</em>: <code class=\"language-plaintext highlighter-rouge\">pca</code></li>\n        <li><em>“color by attributes, comma separated texts”</em>: <code class=\"language-plaintext highlighter-rouge\">louvain,sex,batch,genotype,Il2ra,Cd8b1,Cd8a,Cd4,Itm2a,Aif1,Hba-a1,log1p_total_counts</code></li>\n        <li><em>“Field for gene symbols”</em>: <code class=\"language-plaintext highlighter-rouge\">Symbol</code></li>\n        <li><i class=\"fas fa-hourglass-half\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">time</span> <em>Puedes volver a ejecutar  <i class=\"fas fa-redo\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-refresh</span> la misma herramienta de nuevo, pero cambia <code class=\"language-plaintext highlighter-rouge\">pca</code>por <code class=\"language-plaintext highlighter-rouge\">tsne</code>y finalmente por <code class=\"language-plaintext highlighter-rouge\">umap</code> para saltarte los dos pasos siguientes.</em></li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_plot_embed/scanpy_plot_embed/1.6.0+galaxy0\" title=\"Scanpy PlotEmbed tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Scanpy PlotEmbed</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.6.0+galaxy0)</span> con los siguientes parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in AnnData/Loom format”</em>: <code class=\"language-plaintext highlighter-rouge\">Final object</code></li>\n        <li><em>“name of the embedding to plot”</em>: <code class=\"language-plaintext highlighter-rouge\">tsne</code></li>\n        <li><em>“color by attributes, comma separated texts”</em>: <code class=\"language-plaintext highlighter-rouge\">louvain,sex,batch,genotype,Il2ra,Cd8b1,Cd8a,Cd4,Itm2a,Aif1,Hba-a1,log1p_total_counts</code></li>\n        <li><em>“Field for gene symbols”</em>: <code class=\"language-plaintext highlighter-rouge\">Symbol</code></li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_plot_embed/scanpy_plot_embed/1.6.0+galaxy0\" title=\"Scanpy PlotEmbed tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Scanpy PlotEmbed</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.6.0+galaxy0)</span> con los siguientes parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in AnnData/Loom format”</em>: <code class=\"language-plaintext highlighter-rouge\">Final object</code></li>\n        <li><em>“name of the embedding to plot”</em>: <code class=\"language-plaintext highlighter-rouge\">umap</code></li>\n        <li><em>“color by attributes, comma separated texts”</em>: <code class=\"language-plaintext highlighter-rouge\">louvain,sex,batch,genotype,Il2ra,Cd8b1,Cd8a,Cd4,Itm2a,Aif1,Hba-a1,log1p_total_counts</code></li>\n        <li><em>“Field for gene symbols”</em>: <code class=\"language-plaintext highlighter-rouge\">Symbol</code></li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<p><i class=\"far fa-thumbs-up\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">congratulations</span> ¡Enhorabuena! ¡Ahora tienes un sinfín de gráficos!</p>\n\n<h1 id=\"mirando-más-allá\">Mirando más allá</h1>\n\n<p>¡Ahora viene la parte divertida! Podemos ver dónde se expresan los genes, y empezar a interpretar su papel biológico. En este momento, se decide qué información realmente quieres obtener de tus datos, lo siguiente es sólo la punta del iceberg. Sin embargo, una breve exploración es adecuada, porque puede ayudarte a sacar ideas de como seguir con tus propios datos. ¡Empecemos a interrogar nuestros datos!</p>\n\n<h2 id=\"interpretación-biológica\">Interpretación biológica</h2>\n\n<blockquote class=\"question\">\n  <question-title>Pregunta - La apariencia lo es todo</question-title>\n\n  <p>¿Qué visualización es la más útil para obtener una visión general de nuestros datos, <em>pca</em>, <em>tsne</em> o <em>umap</em>?</p>\n\n  <figure id=\"figure-12\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-3visualisations.png\" alt=\"PCA-tSNE-UMAP. \" width=\"2351\" height=\"1008\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-3visualisations.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figura 12</strong>:</span> Agrupamiento de Louvain por reducción de dimensión</figcaption></figure>\n\n  <blockquote class=\"solution\">\n    <solution-title>Solución</solution-title>\n\n    <p>Puedes ver por qué un PCA generalmente no es suficiente para ver agrupaciones de muestras - ten en cuenta que, sólo estás viendo los componentes 1 y 2 y, por lo tanto,he aquí la razón por la cual las visualizaciones de reducción de la dimensionalidad tSNE y UMAP son tan útiles. Pero no hay necesariamente un claro ganador entre tSNE y UMAP, aunque creo que UMAP es ligeramente más claro con sus agrupamientos, así que nos ceñiremos a esto para el resto del análisis.</p>\n\n  </blockquote>\n\n</blockquote>\n\n<p>Ten en cuenta que la numeración de las agrupaciones se basa únicamente en el tamaño: las agrupaciones 0 y 1 no están necesariamente relacionadas, sino que son las que contienen más células. Sería conveniente saber cuáles son exactamente estas células. Este análisis (buscar en Google todos los genes marcadores, así como comprobar dónde están los que conoces y revisar las tablas de marcadores que has generado) es una tarea entretenida para cualquier experimento individual, así que vamos a pasar deprisa y utilizar la evaluación del artículo original.</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>Agrupación</th>\n      <th>Marcador</th>\n      <th>Tipo de célula</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>3</td>\n      <td>Il2ra</td>\n      <td>Doble negativa (célula T temprana)</td>\n    </tr>\n    <tr>\n      <td>0,1,4,6</td>\n      <td>Cd8b1, Cd8a, Cd4</td>\n      <td>Doble positiva (célula T medial)</td>\n    </tr>\n    <tr>\n      <td>5</td>\n      <td>Cd8b1, Cd8a, Cd4 - high</td>\n      <td>Doble positiva (célula T tardía)</td>\n    </tr>\n    <tr>\n      <td>2</td>\n      <td>Itm2a</td>\n      <td>Célula T madura</td>\n    </tr>\n    <tr>\n      <td>7</td>\n      <td>Hba-a1</td>\n      <td>Células sanguíneas</td>\n    </tr>\n    <tr>\n      <td>8</td>\n      <td>Aif1</td>\n      <td>Macrófagos</td>\n    </tr>\n  </tbody>\n</table>\n\n<figure id=\"figure-13\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-markergeneumaps.png\" alt=\"Marker Gene UMAPs. \" width=\"3931\" height=\"1641\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-markergeneumaps.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figura 13</strong>:</span> Ubicaciones conocidas de genes marcadores</figcaption></figure>\n\n<p>Los autores no estaban interesados en seguir anotando las células DP, así que nosotros tampoco. A veces, esto ocurre. Las matemáticas intentan llamar a las agrupaciones de tamaño similar, sean o no biológicamente relevantes. O bien, la pregunta que se hace no precisa realmente tal granularidad de agrupaciones.</p>\n\n<h3 id=\"anotando-agrupaciones\">Anotando agrupaciones</h3>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Anotando agrupaciones</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/anndata_manipulate/anndata_manipulate/0.7.5+galaxy0\" title=\"Manipulate AnnData tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Manipulate AnnData</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.7.5+galaxy0)</span> con los siguientes parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Final object</code></li>\n        <li><em>“Function to manipulate the object”</em>: <code class=\"language-plaintext highlighter-rouge\">Rename categories of annotation</code></li>\n        <li><em>“Key for observations or variables annotation”</em>: <code class=\"language-plaintext highlighter-rouge\">louvain</code></li>\n        <li><em>“Comma-separated list of new categories”</em>: <code class=\"language-plaintext highlighter-rouge\">DP-M1,DP-M2,T-mat,DN,DP-M3,DP-L,DP-M4,RBC,Macrophages</code></li>\n        <li>Un momento… Lamentablemente esto elimina la numeración original de las agrupaciones. En caso de que quieras recuperarla, se puede volver a añadir la anotación.</li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/anndata_ops/anndata_ops/1.6.0+galaxy1\" title=\"AnnData Operations tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>AnnData Operations</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.6.0+galaxy1)</span> con los siguientes parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in hdf5 AnnData format”</em>: <code class=\"language-plaintext highlighter-rouge\">Final object</code></li>\n        <li><em>“Copy observations (such as clusters)”</em>: <i class=\"fas fa-toggle-on\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-toggle</span> <em>Yes</em></li>\n        <li><strong>“Keys from obs to copy”</strong></li>\n        <li><em>“Keys from obs to copy”</em></li>\n        <li><em>“Key contains”</em>: <code class=\"language-plaintext highlighter-rouge\">louvain</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“AnnData objects with obs to copy”</em>: (output of <strong>Manipulate AnnData</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li>Has añadido las nuevas anotaciones de las células, ahora titulada  `louvain_0´. ¿Qué, no es suficiente? ¿Quieres cambiar el título también? Que así sea.</li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/anndata_ops/anndata_ops/1.6.0+galaxy1\" title=\"AnnData Operations tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>AnnData Operations</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.6.0+galaxy1)</span> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> con los siguientes parámetros::\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in hdf5 AnnData format”</em>: (output of <strong>AnnData Operations</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Change field names in AnnData observations”</em></li>\n        <li><i class=\"fas fa-plus\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-new</span> <em>“Insert Change field names in AnnData observations”</em></li>\n        <li><em>“1: Change field names in AnnData observations”</em></li>\n        <li><em>“Original name”</em>: <code class=\"language-plaintext highlighter-rouge\">louvain_0</code></li>\n        <li><em>“New name”</em>: <code class=\"language-plaintext highlighter-rouge\">cell_type</code></li>\n      </ul>\n    </li>\n    <li><strong>Cambiar nombre</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> de salida h5ad a <code class=\"language-plaintext highlighter-rouge\">Final cell annotated object</code>\n      <ul>\n        <li>¡Es hora de volver a visualizar con gráficos! <i class=\"fas fa-hourglass-half\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">time</span> Siéntete libre de volver a ejecutar <i class=\"fas fa-redo\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-refresh</span> la herramienta <strong>Scanpy PlotEmbed</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> en el nuevo objeto que visualiza gráficamente <code class=\"language-plaintext highlighter-rouge\">cell_type</code> para acelerar esto. De lo contrario…</li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_plot_embed/scanpy_plot_embed/1.6.0+galaxy0\" title=\"Scanpy PlotEmbed tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Scanpy PlotEmbed</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.6.0+galaxy0)</span> con los siguientes parámetros::\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in AnnData/Loom format”</em>: <code class=\"language-plaintext highlighter-rouge\">Final cell annotated object</code></li>\n        <li><em>“name of the embedding to plot”</em>: <code class=\"language-plaintext highlighter-rouge\">umap</code></li>\n        <li><em>“color by attributes, comma separated texts”</em>: <code class=\"language-plaintext highlighter-rouge\">cell_type,sex,batch,genotype,Il2ra,Cd8b1,Cd8a,Cd4,Itm2a,Aif1,Hba-a1,log1p_total_counts</code></li>\n        <li><em>“Field for gene symbols”</em>: <code class=\"language-plaintext highlighter-rouge\">Symbol</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<figure id=\"figure-14\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-annotatedcells.png\" alt=\"Annotated cell types. \" width=\"779\" height=\"500\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-annotatedcells.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figura 14</strong>:</span> Nuestro UMAP anotado</figcaption></figure>\n\n<p>Ahora que sabemos a qué nos enfrentamos, vamos a examinar el efecto de nuestra variable, ¡ciencia en estado puro!</p>\n\n<blockquote class=\"question\">\n  <question-title>Pregunta - Genotipo</question-title>\n\n  <p>¿Existen diferencias en el genotipo? O bien en términos biológicos, ¿hay un impacto de la restricción del crecimiento en el desarrollo de las células T en el timo?</p>\n\n  <figure id=\"figure-15\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-genotypedifferences.png\" alt=\"Genotype Images. \" width=\"3189\" height=\"1051\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-genotypedifferences.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figura 15</strong>:</span> Diferencias de genotipo</figcaption></figure>\n\n  <blockquote class=\"solution\">\n    <solution-title>Solución</solution-title>\n\n    <p>Podemos ver que DP-L,  parece alejarse del grupo de DP-M, así como las células T maduras (o en particular la mitad superior) carecen de algunas células knockout. ¿Quizás existe algún tipo de inhibición aquí? ¡INTERESANTE! ¿Y ahora qué? Podríamos seguir examinando los transcritos presentes en esas dos poblaciones, y quizás también mirar la tabla de marcadores de genotipo… ¡Hay mucho que investigar! Pero antes de que te pongas a explorar a tu antojo, analicemos también esto un poco más técnicamente.</p>\n\n  </blockquote>\n\n</blockquote>\n\n<h2 id=\"evaluación-técnica\">Evaluación técnica</h2>\n\n<p>¿Es real nuestro análisis? ¿Es correcto? Bueno, podemos evaluarlo un poco.</p>\n\n<blockquote class=\"question\">\n  <question-title>Pregunta - Efecto de lote ”Batch effect”</question-title>\n\n  <p>¿existe un efecto de lote “batch effect”?</p>\n\n  <figure id=\"figure-16\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-batcheffect.png\" alt=\"Batch effect. \" width=\"422\" height=\"343\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-batcheffect.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figura 16</strong>:</span> Efecto de lote?</figcaption></figure>\n\n  <blockquote class=\"solution\">\n    <solution-title>Solución</solution-title>\n\n    <p>Si bien se esperan algunos cambios, no hay nada de qué preocuparse, DP-L parece estar limitado a  sólo dos muestras: N706 y N705. Ahora, para ser justos, ambas son de fenotipo normal, pero aún así, no es bueno que sólo el 50% de las muestras de fenotipo normal estén realmente en ese grupo. ¿Se puede decir que es la razón por la que no hay células knockout allí? Es posible que haya un poco de efecto de lote “batch effect”, por lo que se debería considerar el uso de la corrección de lote en este conjunto de datos. Sin embargo, si centramos nuestra atención en el otro agrupamiento -células T maduras- en el que hay mezcla de lotes, todavía podemos evaluar esto biológicamente incluso sin corrección de lotes.\nAdemás, también analizaremos el effecto de confusión del sexo.</p>\n\n    <figure id=\"figure-17\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-sex-batch.png\" alt=\"Sex effect. \" width=\"3015\" height=\"760\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-sex-batch.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figura 17</strong>:</span> Diferencias de sexo</figcaption></figure>\n\n    <p>Observamos que la única muestra femenina -desgraciadamente, una de las tres muestras knockout- parece estar distribuida en las mismas zonas que las muestras knockout en general, por lo que, afortunadamente, no parece ser un factor de confusión y podemos seguir aprendiendo de nuestros datos. Lo ideal sería volver a realizar este experimento con más muestras de hembras o sustituir esta muestra de hembras por la de machos.</p>\n\n  </blockquote>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title>Pregunta - Efecto de profundidad</question-title>\n\n  <p>¿Existen agrupaciones o diferencias impulsadas por la profundidad de la secuenciación, un factor técnico y aleatorio?</p>\n\n  <figure id=\"figure-18\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-umap-totalcounts.png\" alt=\"Sequencing depth. \" width=\"1921\" height=\"740\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-umap-totalcounts.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figura 18</strong>:</span> Conteo a través de grupos</figcaption></figure>\n\n  <blockquote class=\"solution\">\n    <solution-title>Solución</solution-title>\n\n    <p>¡Eureka! Esto explica el extraño cambio de DP entre las células de fenotipo normal y las de knockout: el lado derecho de las células DP simplemente tiene una mayor profundidad de secuenciación (UMIs/célula) que las del lado izquierdo. Eso explica parte del subgrupo que estamos viendo en esa franja. Es importante destacar que no vemos que las agrupaciones de DP-L o (sobre todo) de células T maduras se vean afectadas de forma similar. Así que, aunque de nuevo, esta variable de la profundidad de secuenciación podría ser algo a lo que habría que retroceder de alguna manera, no parece estar afectando a nuestro conjunto de datos. En general, cuanto menos se retroceda/modifique los datos, mejor: hay que ser lo más fiel posible a los datos en crudo y sólo utilizar las matemáticas para corregir los datos cuando sea realmente necesario (¡y no para crear ideas donde no las hay!).</p>\n\n  </blockquote>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title>Pregunta - Pureza de la muestras</question-title>\n\n  <p>¿Crees que hemos procesado estas muestras lo suficientemente bien?</p>\n\n  <figure id=\"figure-19\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-hba.png\" alt=\"Sequencing depth. \" width=\"503\" height=\"514\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-hba.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figura 19</strong>:</span> Hemoglobina a través de grupos</figcaption></figure>\n\n  <blockquote class=\"solution\">\n    <solution-title>Solución</solution-title>\n\n    <p>Hemos visto en las imágenes anteriores que estos agrupamientos no están muy compactados o definidos, por lo que podríamos considerar un filtrado más severo. Por ejemplo, aunque la hemoglobina es alta en la agrupación de los hematíes, aparece en toda la muestra en números bajos. Esto sugiere que hay un fondo en el medio en el que estaban las células, y podríamos considerar en el laboratorio húmedo “wet lab” tratar de obtener una muestra más pura y de mejor calidad, o en el laboratorio seco “dry lab”, emplear técnicas como SoupX u otras para eliminar este fondo. Jugar con los ajustes de filtrado (aumentando los recuentos mínimos por célula, etc.) suele ser el punto de partida en estos escenarios.</p>\n\n  </blockquote>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title>Pregunta -Resolución de agrupaciones</question-title>\n\n  <p>¿Consideras que la agrupación es adecuada? es decir, ¿hay agrupaciones individuales que crees que deberían estar separadas, y agrupaciones múltiples que podrían combinarse?</p>\n\n  <figure id=\"figure-20\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-umap-itm2a.png\" alt=\"Itm2a Expression. \" width=\"1973\" height=\"754\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-umap-itm2a.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figura 20</strong>:</span> Itm2a a través de grupos</figcaption></figure>\n\n  <blockquote class=\"solution\">\n    <solution-title>Solución</solution-title>\n\n    <p>Es importante tener en cuenta, por si acaso todos los bioinformáticos combinan sus fuerzas para atacar a los biólogos: ¡que una agrupación no parezca una agrupación a simple vista NO es suficiente para decir que no es una agrupación! Pero si nos fijamos en la biología aquí, nos esforzamos por encontrar genes marcadores para distinguir la población DP, que sabemos que también se ve afectada por la profundidad de la secuenciación. Es un argumento razonable que DP-M1, DP-M2 y DP-M3 podrían no ser tan diferentes. Tal vez necesitemos más profundidad de secuenciación en todas las células DP, o compararlas explícitamente entre sí (¡considera las variaciones de FindMarkers!). Sin embargo, DP-L parece salir del grupo de DP y también tiene menos células knockout, por lo que podríamos ver lo que DP-L está expresando en los genes marcadores. Si miramos más a T-mat, podemos ver que su gen marcador -Itm2a- sólo se expresa en la mitad superior del agrupamiento. Podrías considerar la posibilidad de subclasificar esto para indagar más, ya sea cambiando la resolución o analizando esta agrupación sola.\nSi miramos las diferencias entre solo los genotipos (por así decir, el “pseudo-bulk”) podemos ver que la mayoría de los genes en esa lista son realmente ribosomales. Esto podría ser un fondo constitutivo, podría estar relacionado con el ciclo celular, podría ser biológico, o las tres cosas. Se podría considerar la posibilidad de analizar el estado del ciclo de las células, o incluso hacer una regresión (que es lo que hicieron los autores).</p>\n  </blockquote>\n\n</blockquote>\n\n<p>Por último, existen muchas maneras de analizar los datos, tanto dentro de los ámbitos de este tutorial (los muchos parámetros que se pueden cambiar) como fuera de él (corrección de lotes, subclasificación, evaluación del ciclo celular, trayectorias, etc.). La mayoría de los análisis seguirán dando el mismo resultado general, sin embargo: hay menos células knockout en la población de células T maduras.</p>\n\n<p><i class=\"far fa-thumbs-up\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">congratulations</span> ¡Felicidades! Has interpretado tus gráficos de varias maneras importantes!</p>\n\n<h1 id=\"visualizaciones-interactivas\">Visualizaciones interactivas</h1>\n\n<p>Antes de que te dejemos explorar lo desconocido, habrás notado que las interpretaciones anteriores son sólo algunas de las opciones posibles. Más aún, es posible que te hayas divertido intentando averiguar qué muestra es de qué genotipo y qué sexo, y pasando repetidamente de un gráfico a otro. Averiguar qué gráficos serán los definitivos y publicables requiere mucho tiempo y muchos intentos ¡Por suerte, existe un útil visor interactivo <span class=\"citation\"><a href=\"#Cakir2020\">Cakir <i>et al.</i> 2020</a></span> <span class=\"citation\"><a href=\"#Moreno2020.04.08.032698\">Moreno <i>et al.</i> 2020</a></span> que puede ayudarte a explorar sin tener que producir nuevos gráficos una y otra vez!</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Cellxgene</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"interactive_tool_cellxgene\" title=\"Interactive CellXgene Environment tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Interactive CellXgene Environment</strong></span> con los siguientes parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Concatenate dataset”</em>: <code class=\"language-plaintext highlighter-rouge\">Final cell annotated object</code></li>\n      </ul>\n    </li>\n    <li>Cuando estés listo, verás un mensaje\n      <ul>\n        <li><i class=\"fas fa-info-circle\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">details</span> <em>Hay una vista de resultados de la herramienta interactiva disponible, haz clic aquí para mostrarla</em> &lt;—- ¡Haz clic ahí!</li>\n      </ul>\n    </li>\n  </ol>\n\n  <p>A veces este enlace puede perturbar un cortafuegos o algo similar. Debería funcionar para ir al sitio web. Se te pedirá que “nombres tu anotación”, así que ¡hazlo para empezar a divertirte!</p>\n\n  <ol>\n    <li>\n      <p>También puedes acceder a ella yendo a “Usuario” en el menú superior de Galaxy, y luego seleccionando “Herramientas interactivas activas”</p>\n    </li>\n    <li>\n      <p>Tendrás que “Detener” este entorno activo en Galaxy yendo a “Usuario”, “Herramientas Interactivas”, seleccionando el entorno, y seleccionando “Detener”. También puedes borrar el conjunto de datos en el historial, porque de lo contrario sigue apareciendo como si estuviera procesando.</p>\n    </li>\n  </ol>\n</blockquote>\n\n<p>Estás advertido: esta herramienta de visualización es una poderosa opción para explorar tus datos, pero lleva algún tiempo acostumbrarse a ella. ¡Considera la posibilidad de explorarlo como tu propio tutorial para otro día!</p>\n\n<h1 id=\"conclusión\">Conclusión</h1>\n\n<blockquote class=\"details\">\n  <details-title>¿Trabajando en grupo? ¡El final!</details-title>\n  <p>Es de esperar que, independientemente de la vía de análisis que hayas tomado, hayas encontrado las mismas interpretaciones generales. Si no es así, este es un buen momento para hablar y considerar con tu grupo por qué puede ser así: ¿qué decisión fue “errónea” o “desacertada”, y cómo te asegurarias de interpretar correctamente tus datos en el futuro? El mejor consejo: probar y equivocarse es una buena idea, lo creas o no, y cuantas más formas encuentres de la misma manera, más seguro estarás. Pero no hay nada mejor que la validación experimental…\nPara aquellos que no tomaron las opciones de “control”, por favor haced lo siguiente:</p>\n  <blockquote>\n    <ol>\n      <li><strong>Cambia de nombre</strong> de tu historial (haciendo clic en el título del historial) a “DECISIÓN-Filtrado y representación visual de datos de ARN seq de célula única”</li>\n      <li>\n        <p>Añade una anotación en el historial <i class=\"fas fa-comment\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">history-annotate</span> que incluya los parámetros que has cambiado/los pasos que has cambiado respecto al <em>control</em></p>\n\n        <!--SNIPPET-->\n        <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-compartiendo-un-historial\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-compartiendo-un-historial\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Consejo: Compartiendo un historial</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>Compartir tu historial permite a otros importar y acceder a los conjuntos de datos, parámetros y pasos de tu historial.</p>   <ol>   <li><strong>Compartir a través de un enlace</strong>     <ul>       <li>Abre el menú <strong>Opciones de historial</strong> <i class=\"fas fa-cog\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-gear</span> (icono de engranaje) en la parte superior del panel de historial         <ul>           <li><i class=\"fas fa-toggle-on\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-toggle</span> <strong>Hacer que el historial sea accesible</strong></li>           <li>Aparecerá un <strong>Compartir enlace</strong> que puedes dar a otros usuarios.</li>         </ul>       </li>       <li>Cualquiera que tenga este enlace puede ver y copiar tu historial.</li>     </ul>   </li>   <li><strong>Publica tu historial</strong>     <ul>       <li><i class=\"fas fa-toggle-on\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-toggle</span> <strong>Hacer que el historial esté disponible públicamente en Historias publicadas</strong></li>       <li>Cualquiera en este servidor Galaxy podrá ver tu historial en el menú <em>Datos compartidos</em></li>     </ul>   </li>   <li><strong>Comparte solo con otro usuario</strong>.     <ul>       <li>Haz clic en el botón <strong>Compartir con un usuario</strong> en la parte inferior</li>       <li>Ingresa una dirección de correo electrónico del usuario con el que deseas compartir</li>       <li>Tu historial se compartirá solo con este usuario.</li>     </ul>   </li>   <li><strong>Encontrar historiales que otros han compartido conmigo</strong>     <ul>       <li>Haz clic en el menú <strong>Usuario</strong> en la barra superior</li>       <li>Selecciona <strong>Historiales compartidos conmigo</strong></li>       <li>Aquí verás todos los historiales que otros han compartido contigo directamente ** Nota: ** Si deseas realizar cambios en tu historial sin afectar la versión compartida, crea una copia mediante al ícono <i class=\"fas fa-cog\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-gear</span> <em>Opciones de historial</em> en tu historial y haciendo clic en <em>Copiar</em></li>     </ul>   </li> </ol> </blockquote>\n        <p><!--END_SNIPPET--></p>\n      </li>\n      <li>Siéntete libre de explorar cualquier otra historia similar</li>\n    </ol>\n  </blockquote>\n</blockquote>\n\n<p><i class=\"far fa-thumbs-up\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">congratulations</span> ¡Felicitaciones! ¡Has llegado al final! Puede que te resulte útil esta <a href=\"https://humancellatlas.usegalaxy.eu/u/wendi.bacon.training/h/filter-plot-and-explore-single-cell-rna-seq-data---answer-key\">historia ejemplo control</a> para comparar, o este <a href=\"https://humancellatlas.usegalaxy.eu/u/wendi.bacon.training/w/filter-plot-and-explore-single-cell-rna-seq-data\">workflow</a>.</p>\n\n<p>En este tutorial, has pasado del procesamiento técnico a la exploración biológica. Al analizar datos reales -¡tanto los emocionantes como los desordenados! - has experimentado lo que es analizar y cuestionar un conjunto de datos, potencialmente sin límites claros o respuestas claras. Si has trabajado en grupo, cada uno de vosotros ha analizado los datos de forma diferente, y lo más probable es que hayáis encontrado ideas similares. Uno de los mayores problemas en el análisis de scRNA-seq es la falta de una vía o parámetros claramente definidos. Hay que tomar la mejor decisión posible a medida que se avanza en el análisis y, en última instancia, en caso de duda, ¡probar de varias maneras y ver qué pasa!</p>\n\n<p>Para debatir con científicos afines, ¡únete a nuestro canal Gitter para todo lo relacionado con Galaxy-single cell! <a href=\"https://gitter.im/Galaxy-Training-Network/galaxy-single-cell?utm_source=badge&amp;utm_medium=badge&amp;utm_campaign=pr-badge\"><a href=\"https://badges.gitter.im/Galaxy-Training-Network/galaxy-single-cell.svg\" rel=\"noopener noreferrer\"><img src=\"https://badges.gitter.im/Galaxy-Training-Network/galaxy-single-cell.svg\" alt=\"Gitter. \" loading=\"lazy\" /></a></a></p>\n"],"ref_slides":[],"video_library":{"tutorial":{"description":"You’ve done all the work to make a single cell matrix, with gene counts and mitochondrial counts and buckets of cell metadata from all your variables of interest, now it’s time to fully process our data, to remove low quality cells, to reduce the many dimensions of data that make it difficult to work with, and ultimately to try to define our clusters and to find our biological meaning and insights!","materials":[{"link":"topics/single-cell/tutorials/scrna-case_basic-pipeline/tutorial.html","type":"Tutorial"}],"tags":["transcriptomics","single-cell"],"type":"Demo","versions":[{"captions":["nomadscientist"],"date":"2021-02-15","galaxy_version":"21.01","length":"30M","link":"M6iepSJh0EQ","speakers":["nomadscientist"]}],"gtn_id":"single-cell/scrna-case_basic-pipeline","title":"Filter, plot and explore single-cell RNA-seq data (Scanpy)","captioned":true},"slides":null,"demo":null,"both":null,"session":null},"hands_on":true,"slides":false,"mod_date":"2024-06-13 18:29:51 +0000","pub_date":"2021-03-24 11:32:22 +0000","version":40,"workflows":[{"workflow":"CS3_Filter,_Plot_and_Explore_Single-cell_RNA-seq_Data.ga","tests":false,"url":"https://training.galaxyproject.org/training-material/topics/single-cell/tutorials/scrna-case_basic-pipeline/workflows/CS3_Filter,_Plot_and_Explore_Single-cell_RNA-seq_Data.ga","path":"topics/single-cell/tutorials/scrna-case_basic-pipeline/workflows/CS3_Filter,_Plot_and_Explore_Single-cell_RNA-seq_Data.ga","wfid":"single-cell-scrna-case_basic-pipeline","wfname":"cs3_filter,_plot_and_explore_single-cell_rna-seq_data","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/single-cell-scrna-case_basic-pipeline/versions/cs3_filter,_plot_and_explore_single-cell_rna-seq_data","license":null,"creators":[],"name":"CS3_Filter, Plot and Explore Single-cell RNA-seq Data","title":"CS3_Filter, Plot and Explore Single-cell RNA-seq Data","test_results":null,"modified":"2024-06-14 00:15:06 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\nMito-counted AnnData\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"Inspect AnnData\"];\n  0 -->|output| 1;\n  2[\"Scanpy FilterCells\"];\n  0 -->|output| 2;\n  08175d7f-f4f4-413c-ad86-f59587ff692e[\"Output\\nGenes-filtered Object\"];\n  2 --> 08175d7f-f4f4-413c-ad86-f59587ff692e;\n  style 08175d7f-f4f4-413c-ad86-f59587ff692e stroke:#2c3143,stroke-width:4px;\n  3[\"Plot\"];\n  0 -->|output| 3;\n  bfc499ee-630a-498b-9be6-696d9bb78837[\"Output\\nScatter - genes x UMIs\"];\n  3 --> bfc499ee-630a-498b-9be6-696d9bb78837;\n  style bfc499ee-630a-498b-9be6-696d9bb78837 stroke:#2c3143,stroke-width:4px;\n  4[\"Plot\"];\n  0 -->|output| 4;\n  f2c78ef3-7d31-4930-954c-0133cce27a41[\"Output\\nScatter - mito x genes\"];\n  4 --> f2c78ef3-7d31-4930-954c-0133cce27a41;\n  style f2c78ef3-7d31-4930-954c-0133cce27a41 stroke:#2c3143,stroke-width:4px;\n  5[\"Plot\"];\n  0 -->|output| 5;\n  348818e6-9def-41fd-a390-6f8525c57cd8[\"Output\\nViolin - genotype - log\"];\n  5 --> 348818e6-9def-41fd-a390-6f8525c57cd8;\n  style 348818e6-9def-41fd-a390-6f8525c57cd8 stroke:#2c3143,stroke-width:4px;\n  6[\"Plot\"];\n  0 -->|output| 6;\n  844f5e7c-78c8-4f28-8e15-cea35ada8fef[\"Output\\nViolin - batch - log\"];\n  6 --> 844f5e7c-78c8-4f28-8e15-cea35ada8fef;\n  style 844f5e7c-78c8-4f28-8e15-cea35ada8fef stroke:#2c3143,stroke-width:4px;\n  7[\"Inspect AnnData\"];\n  0 -->|output| 7;\n  8[\"Plot\"];\n  0 -->|output| 8;\n  3b1232c5-d16a-434d-806e-79fd77f7c05f[\"Output\\nScatter - mito x UMIs\"];\n  8 --> 3b1232c5-d16a-434d-806e-79fd77f7c05f;\n  style 3b1232c5-d16a-434d-806e-79fd77f7c05f stroke:#2c3143,stroke-width:4px;\n  9[\"Inspect AnnData\"];\n  0 -->|output| 9;\n  10[\"Plot\"];\n  0 -->|output| 10;\n  a639cdc0-da40-4df9-8348-23117528b24a[\"Output\\nViolin - sex - log\"];\n  10 --> a639cdc0-da40-4df9-8348-23117528b24a;\n  style a639cdc0-da40-4df9-8348-23117528b24a stroke:#2c3143,stroke-width:4px;\n  11[\"Plot\"];\n  2 -->|output_h5ad| 11;\n  69bf3e42-63e2-4b5b-9d63-5aac9d6b5691[\"Output\\nViolin - Filterbygenes\"];\n  11 --> 69bf3e42-63e2-4b5b-9d63-5aac9d6b5691;\n  style 69bf3e42-63e2-4b5b-9d63-5aac9d6b5691 stroke:#2c3143,stroke-width:4px;\n  12[\"Scanpy FilterCells\"];\n  2 -->|output_h5ad| 12;\n  f378cb4e-0a77-49d9-b92a-752dbea4b09a[\"Output\\nCounts-filtered Object\"];\n  12 --> f378cb4e-0a77-49d9-b92a-752dbea4b09a;\n  style f378cb4e-0a77-49d9-b92a-752dbea4b09a stroke:#2c3143,stroke-width:4px;\n  13[\"Inspect AnnData\"];\n  2 -->|output_h5ad| 13;\n  f9e862db-eb22-4124-8fe0-0fdcfcfb8393[\"Output\\nGeneral - Filterbygenes\"];\n  13 --> f9e862db-eb22-4124-8fe0-0fdcfcfb8393;\n  style f9e862db-eb22-4124-8fe0-0fdcfcfb8393 stroke:#2c3143,stroke-width:4px;\n  14[\"Inspect AnnData\"];\n  12 -->|output_h5ad| 14;\n  794f72b5-c2c3-46a0-ac15-b9f1e94941d2[\"Output\\nGeneral - Filterbycounts\"];\n  14 --> 794f72b5-c2c3-46a0-ac15-b9f1e94941d2;\n  style 794f72b5-c2c3-46a0-ac15-b9f1e94941d2 stroke:#2c3143,stroke-width:4px;\n  15[\"Scanpy FilterCells\"];\n  12 -->|output_h5ad| 15;\n  b915da66-6435-4871-baa0-3e494ba73c96[\"Output\\nMito-filtered Object\"];\n  15 --> b915da66-6435-4871-baa0-3e494ba73c96;\n  style b915da66-6435-4871-baa0-3e494ba73c96 stroke:#2c3143,stroke-width:4px;\n  16[\"Plot\"];\n  12 -->|output_h5ad| 16;\n  3aef86d7-d34d-4b24-bc97-bf8c97d8d2fa[\"Output\\nViolin - Filterbycounts\"];\n  16 --> 3aef86d7-d34d-4b24-bc97-bf8c97d8d2fa;\n  style 3aef86d7-d34d-4b24-bc97-bf8c97d8d2fa stroke:#2c3143,stroke-width:4px;\n  17[\"Inspect AnnData\"];\n  15 -->|output_h5ad| 17;\n  cd94a4c6-5665-4bdf-88ea-4f4d41efa893[\"Output\\nGeneral - Filterbymito\"];\n  17 --> cd94a4c6-5665-4bdf-88ea-4f4d41efa893;\n  style cd94a4c6-5665-4bdf-88ea-4f4d41efa893 stroke:#2c3143,stroke-width:4px;\n  18[\"Scanpy FilterGenes\"];\n  15 -->|output_h5ad| 18;\n  ee63ef0a-98ed-45cb-b144-1154f84ae452[\"Output\\nFiltered Object\"];\n  18 --> ee63ef0a-98ed-45cb-b144-1154f84ae452;\n  style ee63ef0a-98ed-45cb-b144-1154f84ae452 stroke:#2c3143,stroke-width:4px;\n  19[\"Plot\"];\n  15 -->|output_h5ad| 19;\n  7e48a14f-08fd-45ab-b613-606bf64dcf9d[\"Output\\nViolin - Filterbymito\"];\n  19 --> 7e48a14f-08fd-45ab-b613-606bf64dcf9d;\n  style 7e48a14f-08fd-45ab-b613-606bf64dcf9d stroke:#2c3143,stroke-width:4px;\n  20[\"Inspect AnnData\"];\n  18 -->|output_h5ad| 20;\n  d59efa9b-d049-4f0e-8bd8-8ae982a45d0a[\"Output\\nGeneral - Filtered object\"];\n  20 --> d59efa9b-d049-4f0e-8bd8-8ae982a45d0a;\n  style d59efa9b-d049-4f0e-8bd8-8ae982a45d0a stroke:#2c3143,stroke-width:4px;\n  21[\"Scanpy NormaliseData\"];\n  18 -->|output_h5ad| 21;\n  22[\"Scanpy FindVariableGenes\"];\n  21 -->|output_h5ad| 22;\n  23[\"Scanpy ScaleData\"];\n  22 -->|output_h5ad| 23;\n  24[\"Scanpy RunPCA\"];\n  23 -->|output_h5ad| 24;\n  25[\"Plot\"];\n  24 -->|output_h5ad| 25;\n  993dea99-990f-460a-beb9-46e5c97ee898[\"Output\\nPCA Variance\"];\n  25 --> 993dea99-990f-460a-beb9-46e5c97ee898;\n  style 993dea99-990f-460a-beb9-46e5c97ee898 stroke:#2c3143,stroke-width:4px;\n  26[\"Scanpy ComputeGraph\"];\n  24 -->|output_h5ad| 26;\n  27[\"Scanpy RunTSNE\"];\n  26 -->|output_h5ad| 27;\n  28[\"Scanpy RunUMAP\"];\n  27 -->|output_h5ad| 28;\n  29[\"Scanpy FindCluster\"];\n  28 -->|output_h5ad| 29;\n  30[\"Scanpy FindMarkers\"];\n  29 -->|output_h5ad| 30;\n  308b4961-4d50-442b-9bca-bbb1992426ba[\"Output\\nMarkers - cluster\"];\n  30 --> 308b4961-4d50-442b-9bca-bbb1992426ba;\n  style 308b4961-4d50-442b-9bca-bbb1992426ba stroke:#2c3143,stroke-width:4px;\n  035bbbce-fb57-48c8-83d5-2b0cd0376541[\"Output\\nFinal object\"];\n  30 --> 035bbbce-fb57-48c8-83d5-2b0cd0376541;\n  style 035bbbce-fb57-48c8-83d5-2b0cd0376541 stroke:#2c3143,stroke-width:4px;\n  31[\"Scanpy FindMarkers\"];\n  29 -->|output_h5ad| 31;\n  1705e219-192a-4f52-9b26-64fcbcd303ea[\"Output\\nMarkers - genotype\"];\n  31 --> 1705e219-192a-4f52-9b26-64fcbcd303ea;\n  style 1705e219-192a-4f52-9b26-64fcbcd303ea stroke:#2c3143,stroke-width:4px;\n  32[\"Scanpy PlotEmbed\"];\n  30 -->|output_h5ad| 32;\n  33[\"Scanpy PlotEmbed\"];\n  30 -->|output_h5ad| 33;\n  34[\"Manipulate AnnData\"];\n  30 -->|output_h5ad| 34;\n  35[\"Scanpy PlotEmbed\"];\n  30 -->|output_h5ad| 35;\n  36[\"Inspect AnnData\"];\n  30 -->|output_h5ad| 36;\n  37[\"AnnData Operations\"];\n  34 -->|anndata| 37;\n  30 -->|output_h5ad| 37;\n  38[\"Join two Datasets\"];\n  30 -->|output_tsv| 38;\n  36 -->|var| 38;\n  39[\"Join two Datasets\"];\n  31 -->|output_tsv| 39;\n  36 -->|var| 39;\n  40[\"AnnData Operations\"];\n  37 -->|output_h5ad| 40;\n  a6d48df0-403f-4efc-a75f-9504a960884e[\"Output\\nFinal cell annotated object\"];\n  40 --> a6d48df0-403f-4efc-a75f-9504a960884e;\n  style a6d48df0-403f-4efc-a75f-9504a960884e stroke:#2c3143,stroke-width:4px;\n  41[\"Cut\"];\n  38 -->|out_file1| 41;\n  0ee7f9b6-b065-4e26-93df-6e6e2fe458a9[\"Output\\nMarkers - cluster - named\"];\n  41 --> 0ee7f9b6-b065-4e26-93df-6e6e2fe458a9;\n  style 0ee7f9b6-b065-4e26-93df-6e6e2fe458a9 stroke:#2c3143,stroke-width:4px;\n  42[\"Cut\"];\n  39 -->|out_file1| 42;\n  fdb88faa-9b76-4edb-b89b-427c098a473e[\"Output\\nMarkers - genotype - named\"];\n  42 --> fdb88faa-9b76-4edb-b89b-427c098a473e;\n  style fdb88faa-9b76-4edb-b89b-427c098a473e stroke:#2c3143,stroke-width:4px;\n  43[\"Scanpy PlotEmbed\"];\n  40 -->|output_h5ad| 43;"},{"workflow":"Filter,-Plot-and-Explore-Single-cell-RNA-seq-Data-updated.ga","tests":true,"url":"https://training.galaxyproject.org/training-material/topics/single-cell/tutorials/scrna-case_basic-pipeline/workflows/Filter,-Plot-and-Explore-Single-cell-RNA-seq-Data-updated.ga","path":"topics/single-cell/tutorials/scrna-case_basic-pipeline/workflows/Filter,-Plot-and-Explore-Single-cell-RNA-seq-Data-updated.ga","wfid":"single-cell-scrna-case_basic-pipeline","wfname":"filter,-plot-and-explore-single-cell-rna-seq-data-updated","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/single-cell-scrna-case_basic-pipeline/versions/filter,-plot-and-explore-single-cell-rna-seq-data-updated","license":"CC-BY-4.0","creators":[{"class":"Person","identifier":"0000-0002-8170-8806","name":"Wendi Bacon"},{"class":"Person","identifier":"0009-0001-2017-8805","name":"Julia Jakiela"}],"name":"Filter, Plot and Explore Single-cell RNA-seq Data updated","title":"Filter, Plot and Explore Single-cell RNA-seq Data updated","test_results":null,"modified":"2024-06-14 00:15:06 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\nMito-counted AnnData\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"Inspect AnnData\"];\n  0 -->|output| 1;\n  2[\"Scanpy FilterCells\"];\n  0 -->|output| 2;\n  6a00b14b-d3f8-4771-963a-76115c8eaf2f[\"Output\\nGenes-filtered Object\"];\n  2 --> 6a00b14b-d3f8-4771-963a-76115c8eaf2f;\n  style 6a00b14b-d3f8-4771-963a-76115c8eaf2f stroke:#2c3143,stroke-width:4px;\n  3[\"Plot\"];\n  0 -->|output| 3;\n  c123842e-b2d2-43ad-81f0-6ba3b45d4021[\"Output\\nScatter - genes x UMIs\"];\n  3 --> c123842e-b2d2-43ad-81f0-6ba3b45d4021;\n  style c123842e-b2d2-43ad-81f0-6ba3b45d4021 stroke:#2c3143,stroke-width:4px;\n  4[\"Plot\"];\n  0 -->|output| 4;\n  f1020d4d-555e-42fa-ba21-52a151b91a5b[\"Output\\nScatter - mito x genes\"];\n  4 --> f1020d4d-555e-42fa-ba21-52a151b91a5b;\n  style f1020d4d-555e-42fa-ba21-52a151b91a5b stroke:#2c3143,stroke-width:4px;\n  5[\"Plot\"];\n  0 -->|output| 5;\n  a7fe6020-8f1e-470a-9ed3-f2b5e95516e0[\"Output\\nViolin - genotype - log\"];\n  5 --> a7fe6020-8f1e-470a-9ed3-f2b5e95516e0;\n  style a7fe6020-8f1e-470a-9ed3-f2b5e95516e0 stroke:#2c3143,stroke-width:4px;\n  6[\"Plot\"];\n  0 -->|output| 6;\n  15e501bc-8ddb-4519-89eb-dde431ea96c1[\"Output\\nViolin - batch - log\"];\n  6 --> 15e501bc-8ddb-4519-89eb-dde431ea96c1;\n  style 15e501bc-8ddb-4519-89eb-dde431ea96c1 stroke:#2c3143,stroke-width:4px;\n  7[\"Inspect AnnData\"];\n  0 -->|output| 7;\n  8[\"Plot\"];\n  0 -->|output| 8;\n  eff22f46-baa6-4e00-ba82-d5e12ce26ff0[\"Output\\nScatter - mito x UMIs\"];\n  8 --> eff22f46-baa6-4e00-ba82-d5e12ce26ff0;\n  style eff22f46-baa6-4e00-ba82-d5e12ce26ff0 stroke:#2c3143,stroke-width:4px;\n  9[\"Inspect AnnData\"];\n  0 -->|output| 9;\n  10[\"Plot\"];\n  0 -->|output| 10;\n  56677ca4-129c-476c-85ec-69d1bb3d800d[\"Output\\nViolin - sex - log\"];\n  10 --> 56677ca4-129c-476c-85ec-69d1bb3d800d;\n  style 56677ca4-129c-476c-85ec-69d1bb3d800d stroke:#2c3143,stroke-width:4px;\n  11[\"Plot\"];\n  2 -->|output_h5ad| 11;\n  acb61ea4-bcb9-45db-beef-e2bf1a176701[\"Output\\nViolin - Filterbygenes\"];\n  11 --> acb61ea4-bcb9-45db-beef-e2bf1a176701;\n  style acb61ea4-bcb9-45db-beef-e2bf1a176701 stroke:#2c3143,stroke-width:4px;\n  12[\"Scanpy FilterCells\"];\n  2 -->|output_h5ad| 12;\n  51853662-4519-4229-a2ea-b22a53e7ef73[\"Output\\nCounts-filtered Object\"];\n  12 --> 51853662-4519-4229-a2ea-b22a53e7ef73;\n  style 51853662-4519-4229-a2ea-b22a53e7ef73 stroke:#2c3143,stroke-width:4px;\n  13[\"Inspect AnnData\"];\n  2 -->|output_h5ad| 13;\n  362a7fe6-24bb-4398-ae48-870f4b4bb774[\"Output\\nGeneral - Filterbygenes\"];\n  13 --> 362a7fe6-24bb-4398-ae48-870f4b4bb774;\n  style 362a7fe6-24bb-4398-ae48-870f4b4bb774 stroke:#2c3143,stroke-width:4px;\n  14[\"Inspect AnnData\"];\n  12 -->|output_h5ad| 14;\n  edf24149-9341-4fe7-b10c-3fcf092faaa5[\"Output\\nGeneral - Filterbycounts\"];\n  14 --> edf24149-9341-4fe7-b10c-3fcf092faaa5;\n  style edf24149-9341-4fe7-b10c-3fcf092faaa5 stroke:#2c3143,stroke-width:4px;\n  15[\"Scanpy FilterCells\"];\n  12 -->|output_h5ad| 15;\n  a88ec405-265f-4a59-a75e-34e3b05b0096[\"Output\\nMito-filtered Object\"];\n  15 --> a88ec405-265f-4a59-a75e-34e3b05b0096;\n  style a88ec405-265f-4a59-a75e-34e3b05b0096 stroke:#2c3143,stroke-width:4px;\n  16[\"Plot\"];\n  12 -->|output_h5ad| 16;\n  a7c8b0d9-82d3-4438-a212-b5f7c56d36b8[\"Output\\nViolin - Filterbycounts\"];\n  16 --> a7c8b0d9-82d3-4438-a212-b5f7c56d36b8;\n  style a7c8b0d9-82d3-4438-a212-b5f7c56d36b8 stroke:#2c3143,stroke-width:4px;\n  17[\"Inspect AnnData\"];\n  15 -->|output_h5ad| 17;\n  56882809-e19f-451a-8010-bc55dcee482f[\"Output\\nGeneral - Filterbymito\"];\n  17 --> 56882809-e19f-451a-8010-bc55dcee482f;\n  style 56882809-e19f-451a-8010-bc55dcee482f stroke:#2c3143,stroke-width:4px;\n  18[\"Scanpy FilterGenes\"];\n  15 -->|output_h5ad| 18;\n  00846477-dec5-408a-83b2-105fff7ce05b[\"Output\\nFiltered Object\"];\n  18 --> 00846477-dec5-408a-83b2-105fff7ce05b;\n  style 00846477-dec5-408a-83b2-105fff7ce05b stroke:#2c3143,stroke-width:4px;\n  19[\"Plot\"];\n  15 -->|output_h5ad| 19;\n  7582e113-2004-4255-a1f3-d3123373f342[\"Output\\nViolin - Filterbymito\"];\n  19 --> 7582e113-2004-4255-a1f3-d3123373f342;\n  style 7582e113-2004-4255-a1f3-d3123373f342 stroke:#2c3143,stroke-width:4px;\n  20[\"Inspect AnnData\"];\n  18 -->|output_h5ad| 20;\n  2d870a40-c602-4a1c-afef-450489354d39[\"Output\\nGeneral - Filtered object\"];\n  20 --> 2d870a40-c602-4a1c-afef-450489354d39;\n  style 2d870a40-c602-4a1c-afef-450489354d39 stroke:#2c3143,stroke-width:4px;\n  21[\"Scanpy NormaliseData\"];\n  18 -->|output_h5ad| 21;\n  22[\"Scanpy FindVariableGenes\"];\n  21 -->|output_h5ad| 22;\n  a0eb92b1-0263-4179-b7af-4bd9bcc9c960[\"Output\\nUse_me_FVG\"];\n  22 --> a0eb92b1-0263-4179-b7af-4bd9bcc9c960;\n  style a0eb92b1-0263-4179-b7af-4bd9bcc9c960 stroke:#2c3143,stroke-width:4px;\n  23[\"Scanpy ScaleData\"];\n  22 -->|output_h5ad| 23;\n  5776dbb9-0cac-40c0-9bae-9accae16a7a0[\"Output\\nUse_me_Scaled\"];\n  23 --> 5776dbb9-0cac-40c0-9bae-9accae16a7a0;\n  style 5776dbb9-0cac-40c0-9bae-9accae16a7a0 stroke:#2c3143,stroke-width:4px;\n  24[\"Scanpy RunPCA\"];\n  23 -->|output_h5ad| 24;\n  25[\"Plot\"];\n  24 -->|output_h5ad| 25;\n  f0b6f578-050f-4936-9ee7-9956b0760c6f[\"Output\\nPCA Variance\"];\n  25 --> f0b6f578-050f-4936-9ee7-9956b0760c6f;\n  style f0b6f578-050f-4936-9ee7-9956b0760c6f stroke:#2c3143,stroke-width:4px;\n  26[\"Scanpy ComputeGraph\"];\n  24 -->|output_h5ad| 26;\n  27[\"Scanpy RunTSNE\"];\n  26 -->|output_h5ad| 27;\n  28[\"Scanpy RunUMAP\"];\n  27 -->|output_h5ad| 28;\n  29[\"Scanpy FindCluster\"];\n  28 -->|output_h5ad| 29;\n  30[\"Scanpy FindMarkers\"];\n  29 -->|output_h5ad| 30;\n  7cfe5c9c-1c80-41b4-b669-633b1d7d40e3[\"Output\\nMarkers - cluster\"];\n  30 --> 7cfe5c9c-1c80-41b4-b669-633b1d7d40e3;\n  style 7cfe5c9c-1c80-41b4-b669-633b1d7d40e3 stroke:#2c3143,stroke-width:4px;\n  98e98405-951e-4c6c-be01-3c925ae35449[\"Output\\nFinal object\"];\n  30 --> 98e98405-951e-4c6c-be01-3c925ae35449;\n  style 98e98405-951e-4c6c-be01-3c925ae35449 stroke:#2c3143,stroke-width:4px;\n  31[\"Scanpy FindMarkers\"];\n  29 -->|output_h5ad| 31;\n  1e9f229d-eb34-4a5b-a6d9-e70c7b0581f4[\"Output\\nMarkers - genotype\"];\n  31 --> 1e9f229d-eb34-4a5b-a6d9-e70c7b0581f4;\n  style 1e9f229d-eb34-4a5b-a6d9-e70c7b0581f4 stroke:#2c3143,stroke-width:4px;\n  32[\"Scanpy PlotEmbed\"];\n  30 -->|output_h5ad| 32;\n  33[\"Scanpy PlotEmbed\"];\n  30 -->|output_h5ad| 33;\n  34[\"Manipulate AnnData\"];\n  30 -->|output_h5ad| 34;\n  35[\"Scanpy PlotEmbed\"];\n  30 -->|output_h5ad| 35;\n  36[\"Inspect AnnData\"];\n  30 -->|output_h5ad| 36;\n  37[\"AnnData Operations\"];\n  34 -->|anndata| 37;\n  30 -->|output_h5ad| 37;\n  38[\"Join two Datasets\"];\n  30 -->|output_tsv| 38;\n  36 -->|var| 38;\n  39[\"Join two Datasets\"];\n  31 -->|output_tsv| 39;\n  36 -->|var| 39;\n  40[\"AnnData Operations\"];\n  37 -->|output_h5ad| 40;\n  10bd70f8-ffcb-442b-9647-e5b947b6d35e[\"Output\\nFinal cell annotated object\"];\n  40 --> 10bd70f8-ffcb-442b-9647-e5b947b6d35e;\n  style 10bd70f8-ffcb-442b-9647-e5b947b6d35e stroke:#2c3143,stroke-width:4px;\n  41[\"Cut\"];\n  38 -->|out_file1| 41;\n  4f822c1c-91c5-4be4-8f9b-d5bdda0a037e[\"Output\\nMarkers - cluster - named\"];\n  41 --> 4f822c1c-91c5-4be4-8f9b-d5bdda0a037e;\n  style 4f822c1c-91c5-4be4-8f9b-d5bdda0a037e stroke:#2c3143,stroke-width:4px;\n  42[\"Cut\"];\n  39 -->|out_file1| 42;\n  3b471f3d-263d-4299-9b7d-8a8ae1aa556e[\"Output\\nMarkers - genotype - named\"];\n  42 --> 3b471f3d-263d-4299-9b7d-8a8ae1aa556e;\n  style 3b471f3d-263d-4299-9b7d-8a8ae1aa556e stroke:#2c3143,stroke-width:4px;\n  43[\"Scanpy PlotEmbed\"];\n  40 -->|output_h5ad| 43;"}],"api":"https://training.galaxyproject.org/training-material/api/topics/single-cell/tutorials/scrna-case_basic-pipeline/tutorial.json","tools":["Cut1","interactive_tool_cellxgene","join1","toolshed.g2.bx.psu.edu/repos/ebi-gxa/anndata_ops/anndata_ops/1.8.1+galaxy0","toolshed.g2.bx.psu.edu/repos/ebi-gxa/anndata_ops/anndata_ops/1.8.1+galaxy91","toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_compute_graph/scanpy_compute_graph/1.8.1+galaxy1","toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_compute_graph/scanpy_compute_graph/1.8.1+galaxy9","toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_filter_cells/scanpy_filter_cells/1.8.1+galaxy0","toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_filter_cells/scanpy_filter_cells/1.8.1+galaxy9","toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_filter_genes/scanpy_filter_genes/1.8.1+galaxy0","toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_filter_genes/scanpy_filter_genes/1.8.1+galaxy9","toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_find_cluster/scanpy_find_cluster/1.8.1+galaxy0","toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_find_cluster/scanpy_find_cluster/1.8.1+galaxy9","toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_find_markers/scanpy_find_markers/1.8.1+galaxy0","toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_find_markers/scanpy_find_markers/1.8.1+galaxy9","toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_find_variable_genes/scanpy_find_variable_genes/1.8.1+galaxy0","toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_find_variable_genes/scanpy_find_variable_genes/1.8.1+galaxy9","toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_normalise_data/scanpy_normalise_data/1.8.1+galaxy0","toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_normalise_data/scanpy_normalise_data/1.8.1+galaxy9","toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_plot_embed/scanpy_plot_embed/1.8.1+galaxy0","toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_plot_embed/scanpy_plot_embed/1.8.1+galaxy9","toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_run_pca/scanpy_run_pca/1.8.1+galaxy0","toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_run_pca/scanpy_run_pca/1.8.1+galaxy9","toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_run_tsne/scanpy_run_tsne/1.8.1+galaxy1","toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_run_tsne/scanpy_run_tsne/1.8.1+galaxy9","toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_run_umap/scanpy_run_umap/1.8.1+galaxy0","toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_run_umap/scanpy_run_umap/1.8.1+galaxy9","toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_scale_data/scanpy_scale_data/1.8.1+galaxy0","toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_scale_data/scanpy_scale_data/1.8.1+galaxy9","toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.7.5+galaxy1","toolshed.g2.bx.psu.edu/repos/iuc/anndata_manipulate/anndata_manipulate/0.7.5+galaxy1","toolshed.g2.bx.psu.edu/repos/iuc/scanpy_plot/scanpy_plot/1.7.1+galaxy1"],"supported_servers":{"exact":[{"url":"https://usegalaxy.eu","name":"UseGalaxy.eu","usegalaxy":true}],"inexact":[{"url":"https://usegalaxy.org.au","name":"UseGalaxy.org.au","usegalaxy":true}]},"topic_name_human":"Single Cell","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"anndata_ops","owner":"ebi-gxa","revisions":"890fb06a2893","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"anndata_ops","owner":"ebi-gxa","revisions":"7ebc22f77d86","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"scanpy_compute_graph","owner":"ebi-gxa","revisions":"bc9e8de21efb","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"scanpy_compute_graph","owner":"ebi-gxa","revisions":"6417cccad133","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"scanpy_filter_cells","owner":"ebi-gxa","revisions":"55ccc0a121bc","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"scanpy_filter_cells","owner":"ebi-gxa","revisions":"e9283529cba1","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"scanpy_filter_genes","owner":"ebi-gxa","revisions":"da611a744112","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"scanpy_filter_genes","owner":"ebi-gxa","revisions":"474a69c47184","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"scanpy_find_cluster","owner":"ebi-gxa","revisions":"ad6995afd2e6","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"scanpy_find_cluster","owner":"ebi-gxa","revisions":"2ccd9f9e2cd0","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"scanpy_find_markers","owner":"ebi-gxa","revisions":"49653e680ea4","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"scanpy_find_markers","owner":"ebi-gxa","revisions":"81c34e67f262","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"scanpy_find_variable_genes","owner":"ebi-gxa","revisions":"4667fe07bd68","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"scanpy_find_variable_genes","owner":"ebi-gxa","revisions":"2861ca3bfe4d","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"scanpy_normalise_data","owner":"ebi-gxa","revisions":"8d9c22419c56","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"scanpy_normalise_data","owner":"ebi-gxa","revisions":"6b97ffba31da","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"scanpy_plot_embed","owner":"ebi-gxa","revisions":"56d22aa6cb3b","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"scanpy_plot_embed","owner":"ebi-gxa","revisions":"35f6611fb8c3","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"scanpy_run_pca","owner":"ebi-gxa","revisions":"3ee74b58c72d","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"scanpy_run_pca","owner":"ebi-gxa","revisions":"59028945c857","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"scanpy_run_tsne","owner":"ebi-gxa","revisions":"8b0d6f6f44c8","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"scanpy_run_tsne","owner":"ebi-gxa","revisions":"181d61d2f3cd","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"scanpy_run_umap","owner":"ebi-gxa","revisions":"fe562424a0a6","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"scanpy_run_umap","owner":"ebi-gxa","revisions":"bd4a244faeb8","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"scanpy_scale_data","owner":"ebi-gxa","revisions":"5605f8452eb3","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"scanpy_scale_data","owner":"ebi-gxa","revisions":"f86b2c3bc459","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"anndata_inspect","owner":"iuc","revisions":"ee98d611afc6","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"anndata_manipulate","owner":"iuc","revisions":"3d748954434b","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"scanpy_plot","owner":"iuc","revisions":"aa0c474463c2","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: anndata_ops\n  owner: ebi-gxa\n  revisions: 890fb06a2893\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: anndata_ops\n  owner: ebi-gxa\n  revisions: 7ebc22f77d86\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_compute_graph\n  owner: ebi-gxa\n  revisions: bc9e8de21efb\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_compute_graph\n  owner: ebi-gxa\n  revisions: 6417cccad133\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_filter_cells\n  owner: ebi-gxa\n  revisions: 55ccc0a121bc\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_filter_cells\n  owner: ebi-gxa\n  revisions: e9283529cba1\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_filter_genes\n  owner: ebi-gxa\n  revisions: da611a744112\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_filter_genes\n  owner: ebi-gxa\n  revisions: 474a69c47184\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_find_cluster\n  owner: ebi-gxa\n  revisions: ad6995afd2e6\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_find_cluster\n  owner: ebi-gxa\n  revisions: 2ccd9f9e2cd0\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_find_markers\n  owner: ebi-gxa\n  revisions: 49653e680ea4\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_find_markers\n  owner: ebi-gxa\n  revisions: 81c34e67f262\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_find_variable_genes\n  owner: ebi-gxa\n  revisions: 4667fe07bd68\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_find_variable_genes\n  owner: ebi-gxa\n  revisions: 2861ca3bfe4d\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_normalise_data\n  owner: ebi-gxa\n  revisions: 8d9c22419c56\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_normalise_data\n  owner: ebi-gxa\n  revisions: 6b97ffba31da\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_plot_embed\n  owner: ebi-gxa\n  revisions: 56d22aa6cb3b\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_plot_embed\n  owner: ebi-gxa\n  revisions: 35f6611fb8c3\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_run_pca\n  owner: ebi-gxa\n  revisions: 3ee74b58c72d\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_run_pca\n  owner: ebi-gxa\n  revisions: 59028945c857\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_run_tsne\n  owner: ebi-gxa\n  revisions: 8b0d6f6f44c8\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_run_tsne\n  owner: ebi-gxa\n  revisions: 181d61d2f3cd\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_run_umap\n  owner: ebi-gxa\n  revisions: fe562424a0a6\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_run_umap\n  owner: ebi-gxa\n  revisions: bd4a244faeb8\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_scale_data\n  owner: ebi-gxa\n  revisions: 5605f8452eb3\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_scale_data\n  owner: ebi-gxa\n  revisions: f86b2c3bc459\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: anndata_inspect\n  owner: iuc\n  revisions: ee98d611afc6\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: anndata_manipulate\n  owner: iuc\n  revisions: 3d748954434b\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_plot\n  owner: iuc\n  revisions: aa0c474463c2\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial","contributors":[{"name":"Wendi Bacon","email":"wendi.bacon@open.ac.uk","twitter":"WendiBacon1","matrix":"nomadscientist:matrix.org","joined":"2020-03","elixir_node":"uk","orcid":"0000-0002-8170-8806","bio":"Lecturer at The Open University","fediverse":"https://mstdn.science/@wendibacon1","fediverse_flavor":"mastodon","affiliations":["elixir-europe"],"id":"nomadscientist","url":"https://training.galaxyproject.org/training-material/api/contributors/nomadscientist.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/nomadscientist/"},{"name":"Helena Rasche","orcid":"0000-0001-9760-8992","maintainer_contact":"gitter","matrix":"hexylena:matrix.org","joined":"2017-09","elixir_node":"nl","affiliations":["gallantries","by-covid","erasmusmc","elixir-europe","elixir-converge"],"former_affiliations":["deNBI","avans-atgm","uni-freiburg"],"contact_for_training":false,"location":{"country":"NL","lat":51.91,"lon":4.46},"id":"hexylena","url":"https://training.galaxyproject.org/training-material/api/contributors/hexylena.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/hexylena/"},{"name":"Julia Jakiela","email":"juliajot36@gmail.com","joined":"2022-06","id":"wee-snufkin","url":"https://training.galaxyproject.org/training-material/api/contributors/wee-snufkin.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/wee-snufkin/"},{"name":"Julia Jakiela","email":"juliajot36@gmail.com","joined":"2022-06","id":"wee-snufkin","url":"https://training.galaxyproject.org/training-material/api/contributors/wee-snufkin.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/wee-snufkin/"}]}