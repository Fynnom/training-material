{"layout":"tutorial_hands_on","subtopic":"datamanipulation","priority":2,"title":"Importing files from public atlases","questions":["How do I use the EBI Single Cell Expression Atlas and Human Cell Atlas?","How can I reformat and manipulate the downloaded files to create the correct input for downstream analysis?"],"objectives":["You will retrieve raw data from the EBI Single Cell Expression Atlas and Human Cell Atlas.","You will manipulate the metadata and matrix files.","You will combine the metadata and matrix files into an AnnData or Seurat object for downstream analysis."],"time_estimation":"15m","key_points":["The EMBL-EBI Single-cell Expression Atlas contains high quality datasets.","Metadata manipulation is key for generating the correctly formatted files.","To use Scanpy tools, you have to transform your metadata into an AnnData object.","To use Seurat tools, you have to transform your metadata into a Seurat object."],"contributions":{"authorship":["wee-snufkin","nomadscientist"],"funding":["elixir-fair-data"]},"requirements":[{"type":"internal","topic_name":"single-cell","tutorials":["scrna-case_alevin","scrna-case_alevin-combine-datasets"]}],"follow_up_training":[{"type":"internal","topic_name":"single-cell","tutorials":["scrna-case_basic-pipeline"]}],"tags":["data import","data management"],"js_requirements":{"mathjax":null,"mermaid":false},"short_id":"T00374","url":"/topics/single-cell/tutorials/EBI-retrieval/tutorial.html","topic_name":"single-cell","tutorial_name":"EBI-retrieval","dir":"topics/single-cell/tutorials/EBI-retrieval","symlink":null,"id":"single-cell/EBI-retrieval","ref_tutorials":["<h1 id=\"introduction\">Introduction</h1>\n\n<p>Public single cell datasets seem to accumulate by the second. Well annotated, quality datasets are slightly trickier to find. which is why projects like the <a href=\"https://www.ebi.ac.uk/gxa/sc/home\">Single Cell Expression Atlas</a> (SCXA) exist - to curate datasets for public use. Here, we will guide you through transforming data imported from the SCXA repository into the input file required for the <a href=\"/training-material/topics/single-cell/tutorials/scrna-case_basic-pipeline/tutorial.html\">Filter, Plot, Explore tutorial</a> and we will also show how to use the public atlases for your own research.</p>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n  <p>In this tutorial, we will cover:</p>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#introduction\" id=\"markdown-toc-introduction\">Introduction</a></li>\n  <li><a href=\"#getting-data-from-the-single-cell-expression-atlas\" id=\"markdown-toc-getting-data-from-the-single-cell-expression-atlas\">Getting data from the Single Cell Expression Atlas</a>    <ol>\n      <li><a href=\"#examine-the-imported-files\" id=\"markdown-toc-examine-the-imported-files\">Examine the imported files</a></li>\n      <li><a href=\"#metadata-manipulation\" id=\"markdown-toc-metadata-manipulation\">Metadata manipulation</a></li>\n      <li><a href=\"#check-mitochondrial-gene-name-format\" id=\"markdown-toc-check-mitochondrial-gene-name-format\">Check mitochondrial gene name format</a></li>\n      <li><a href=\"#creating-the-anndata-object\" id=\"markdown-toc-creating-the-anndata-object\">Creating the AnnData object</a></li>\n      <li><a href=\"#anndata-manipulation\" id=\"markdown-toc-anndata-manipulation\">AnnData manipulation</a></li>\n      <li><a href=\"#conclusion\" id=\"markdown-toc-conclusion\">Conclusion</a></li>\n      <li><a href=\"#creating-the-seurat-object\" id=\"markdown-toc-creating-the-seurat-object\">Creating the Seurat Object</a></li>\n      <li><a href=\"#conclusion-1\" id=\"markdown-toc-conclusion-1\">Conclusion</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#human-cell-atlas-matrix-downloader\" id=\"markdown-toc-human-cell-atlas-matrix-downloader\">Human Cell Atlas Matrix Downloader</a></li>\n</ol>\n\n</blockquote>\n\n<h1 id=\"getting-data-from-the-single-cell-expression-atlas\">Getting data from the Single Cell Expression Atlas</h1>\n\n<p>Galaxy has a specific tool for importing data from the SCXA (<span class=\"citation\"><a href=\"#Moreno2020.04.08.032698\">Moreno <i>et al.</i> 2020</a></span>), which combines all the preprocessing steps shown in <a href=\"/training-material/topics/single-cell/tutorials/scrna-case_alevin/tutorial.html\">the previous tutorial</a> into one! For this tutorial, the dataset can be seen <a href=\"https://www.ebi.ac.uk/gxa/sc/experiments/E-MTAB-6945/downloads\">at the EBI</a> with experiment ID of <code class=\"language-plaintext highlighter-rouge\">E-MTAB-6945</code>.</p>\n\n<blockquote class=\"details\">\n  <details-title> How to access other experiments? </details-title>\n\n  <p>You can search datasets according to various criteria either using search box in <strong>Home</strong> tab or choosing kingdom, experiment collection, technology type (and others) in <strong>Browse experiments</strong> tab. When you find the experiment you are interested in, just click on it and the experiment ID will be displayed in the website URL, as shown below.</p>\n\n  <figure id=\"figure-1\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-data/exp_id.jpg\" alt=\"Arrow pointing to the website URL where you can find experiment ID.\" width=\"1757\" height=\"627\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-data/exp_id.jpg\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 1</strong>:</span> Where to find experiment ID on the EBI Single Cell Expression Atlas website.</figcaption></figure>\n\n  <p>Once you know the experiment ID, you can use EBI SCXA Data Retrieval tool in Galaxy!</p>\n\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Retrieving data from Single Cell Expression Atlas</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/retrieve_scxa/retrieve_scxa/v0.0.2+galaxy2\" title=\"EBI SCXA Data Retrieval tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>EBI SCXA Data Retrieval</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version v0.0.2+galaxy2)</span> with the following parameters:\n      <ul>\n        <li><em>“SC-Atlas experiment accession”</em>: <code class=\"language-plaintext highlighter-rouge\">E-MTAB-6945</code></li>\n        <li><em>“Choose the type of matrix to download”</em>: <code class=\"language-plaintext highlighter-rouge\">Raw filtered counts</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>It’s important to note that this matrix is processed somewhat through the SCXA pipeline, which is quite similar to the pre-processing that has been shown in this case study tutorial series. The resultant datasets contain any and all metadata provided by the SCXA pipeline as well as the metadata contributed by the original authors (for instance, more cell or gene annotations). So while the AnnData object generated at the end of this tutorial will be similar to that generated using the <a href=\"/training-material/topics/single-cell/tutorials/scrna-case_alevin/tutorial.html\">Alevin workflows</a> on the original FASTQ files, some of the metadata will be slightly different. Relevant results and interpretation will not change, however!</p>\n\n<h2 id=\"examine-the-imported-files\">Examine the imported files</h2>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>What format has this tool imported?</li>\n  </ol>\n\n  <blockquote class=\"tip\">\n    <tip-title></tip-title>\n\n    <p>Selecting the title of each resultant dataset will expand the dataset in the Galaxy history.</p>\n  </blockquote>\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <p>Matrix Market Format! We can tell this because our first file helpfully says <code class=\"language-plaintext highlighter-rouge\">MatrixMarket</code> in the first line.</p>\n    <figure id=\"figure-2\" style=\"max-width: 90%;\"><img src=\"../../tutorials/EBI-retrieval/images/matrix-output.png\" alt=\"Green box containing first output, the matrix.mtx file. Columns are labelled 14458, 5218, and 5308559. \" width=\"273\" height=\"410\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../tutorials/EBI-retrieval/images/matrix-output.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 2</strong>:</span> Matrix Market Output</figcaption></figure>\n\n    <p>This <i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <code class=\"language-plaintext highlighter-rouge\">matrix.mtx</code> file, in Matrix Market format, contains a column referring to each gene (column 1), to each cell (column 2), and the expression values themselves in the final column. To be useful, then, we need to know which genes and cells the numbers are referring to. That’s why this format comes with two more files.</p>\n\n    <figure id=\"figure-3\" style=\"max-width: 90%;\"><img src=\"../../tutorials/EBI-retrieval/images/genes-output.png\" alt=\"Green box containing second output, the genes.tsv file. The first column contains EnsemblIDs such as ENSMUSG######, while the second column contains gene names. There are 14,457 lines.\" width=\"274\" height=\"414\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../tutorials/EBI-retrieval/images/genes-output.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 3</strong>:</span> Genes Output</figcaption></figure>\n\n    <p>The <i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <code class=\"language-plaintext highlighter-rouge\">genes.tsv</code> file lists each EnsemblID and its gene name. The lines (14,457) corresponds with the 14458 in the Matrix file…but the 14458 contains a header, so that’s why it has one more than the genes file!</p>\n\n    <figure id=\"figure-4\" style=\"max-width: 90%;\"><img src=\"../../tutorials/EBI-retrieval/images/cells-output.png\" alt=\"Green box containing third output, the barcodes.tsv file. The file consists of 5,217 lines and a single column containing the cell barcode, variations of ERR2704656-AAAACACTCTGA.\" width=\"275\" height=\"414\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../tutorials/EBI-retrieval/images/cells-output.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 4</strong>:</span> Cells Output</figcaption></figure>\n\n    <p>The <i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <code class=\"language-plaintext highlighter-rouge\">barcodes.tsv</code> file lists each barcode. The lines (5,217) again correspond with the 5,218 lines in the Matrix file…which adds in the header again!</p>\n\n    <figure id=\"figure-5\" style=\"max-width: 90%;\"><img src=\"../../tutorials/EBI-retrieval/images/cell-metadata.png\" alt=\"Green box containing fourth output, the exp_design.tsv file. The file consists of 5,218 lines and numerous columns starting with 'Assay' and 'Sample Characteristic'.\" width=\"281\" height=\"410\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../tutorials/EBI-retrieval/images/cell-metadata.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 5</strong>:</span> Experimental Design</figcaption></figure>\n\n    <p>Finally, and helpfully, the tool also includes cell metadata where the <code class=\"language-plaintext highlighter-rouge\">Assay</code> column corresponds with the barcodes in the <i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <code class=\"language-plaintext highlighter-rouge\">barcodes.tsv</code> file. While this is not a required file to create an AnnData object from the three matrix market files, it is extremely necessary for actually interpreting the data. Imagine not knowing which barcodes came from which sample!</p>\n\n  </blockquote>\n</blockquote>\n\n<h2 id=\"metadata-manipulation\">Metadata manipulation</h2>\n\n<p>At this point you might want to do some modifications in the files before downstream analysis. That can include re-formating the cell metadata or changing the names of the column headers, it all depends on your dataset and how you want to perfrom your analysis. It’s also fine to transform those files straight away. Here, we will show an extended version of metadata manipulation which allows us to create an input file consistent with <a href=\"/training-material/topics/single-cell/tutorials/scrna-case_basic-pipeline/tutorial.html\">the next tutorial</a> workflow.</p>\n\n<p>Before creating an AnnData object, we need to make a small modification in experimental design table. The dataset contains information about the 7 experimental samples (N701 – N707). However, in the <i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <code class=\"language-plaintext highlighter-rouge\">exp_design.tsv</code> dataset, which contains the cell metadata, these samples are just numbered from 1 to 7.</p>\n\n<blockquote class=\"details\">\n  <details-title>How did we know this?</details-title>\n\n  <p>You can preview this column in the the <i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <code class=\"language-plaintext highlighter-rouge\">exp_design.tsv</code> dataset by selecting the <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> in the <i class=\"fas fa-columns\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-history</span> Galaxy history. If you scroll to the right, and move to the column <code class=\"language-plaintext highlighter-rouge\">Sample Characteristic[individual]</code>, you will find the batch information. Don’t worry, we’re about to rename and reformat this whole dataset to more useful titles. Make a note of the number of that column - number 12 - as we will need it to change the batch number to a batch name shortly.</p>\n\n</blockquote>\n\n<p>The plotting tool that we will use later will fail if the entries are integers and not categorical values, so we will change <code class=\"language-plaintext highlighter-rouge\">1</code> to <code class=\"language-plaintext highlighter-rouge\">N01</code> and so on.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title> Change batch numbers into names </hands-on-title>\n\n  <ol>\n    <li>\n      <p>Change the datatype of <i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <code class=\"language-plaintext highlighter-rouge\">EBI SCXA Data Retrieval on E-MTAB-6945 exp_design.tsv</code> to <code class=\"language-plaintext highlighter-rouge\">tabular</code>:</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-changing-the-datatype\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-changing-the-datatype\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Changing the datatype</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, click <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Datatypes</strong> tab on the top</li>   <li>In the <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Assign Datatype</strong>, select <code class=\"language-plaintext highlighter-rouge\">tabular</code> from “<em>New type</em>” dropdown     <ul>       <li>Tip: you can start typing the datatype into the field to filter the dropdown menu</li>     </ul>   </li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/galaxyp/regex_find_replace/regexColumn1/1.0.3\" title=\"Column Regex Find And Replace tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Column Regex Find And Replace</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.0.3)</span> with the following parameters:</p>\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Select cells from”</em>: <code class=\"language-plaintext highlighter-rouge\">EBI SCXA Data Retrieval on E-MTAB-6945 exp_design.tsv</code></li>\n        <li><em>“using column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 12</code></li>\n        <li>In <em>“Check”</em>:\n          <ul>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Check”</em>\n              <ul>\n                <li><em>“Find Regex”</em>: <code class=\"language-plaintext highlighter-rouge\">1</code></li>\n                <li><em>“Replacement”</em>: <code class=\"language-plaintext highlighter-rouge\">N01</code></li>\n              </ul>\n            </li>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Check”</em>\n              <ul>\n                <li><em>“Find Regex”</em>: <code class=\"language-plaintext highlighter-rouge\">2</code></li>\n                <li><em>“Replacement”</em>: <code class=\"language-plaintext highlighter-rouge\">N02</code></li>\n              </ul>\n            </li>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Check”</em>\n              <ul>\n                <li><em>“Find Regex”</em>: <code class=\"language-plaintext highlighter-rouge\">3</code></li>\n                <li><em>“Replacement”</em>: <code class=\"language-plaintext highlighter-rouge\">N03</code></li>\n              </ul>\n            </li>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Check”</em>\n              <ul>\n                <li><em>“Find Regex”</em>: <code class=\"language-plaintext highlighter-rouge\">4</code></li>\n                <li><em>“Replacement”</em>: <code class=\"language-plaintext highlighter-rouge\">N04</code></li>\n              </ul>\n            </li>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Check”</em>\n              <ul>\n                <li><em>“Find Regex”</em>: <code class=\"language-plaintext highlighter-rouge\">5</code></li>\n                <li><em>“Replacement”</em>: <code class=\"language-plaintext highlighter-rouge\">N05</code></li>\n              </ul>\n            </li>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Check”</em>\n              <ul>\n                <li><em>“Find Regex”</em>: <code class=\"language-plaintext highlighter-rouge\">6</code></li>\n                <li><em>“Replacement”</em>: <code class=\"language-plaintext highlighter-rouge\">N06</code></li>\n              </ul>\n            </li>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Check”</em>\n              <ul>\n                <li><em>“Find Regex”</em>: <code class=\"language-plaintext highlighter-rouge\">7</code></li>\n                <li><em>“Replacement”</em>: <code class=\"language-plaintext highlighter-rouge\">N07</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>While we’re renaming things, let’s also fix our titles.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title> Change cell metadata titles </hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_find_and_replace/1.1.4\" title=\"Replace parts of text tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Replace parts of text</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.1.4)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Select lines from”</em>: output from <strong>Column Regex and Replace</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n        <li>In <em>“Find and Replace”</em>:\n          <ul>\n            <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">\"Sample Characteristic[genotype]\"</code></li>\n            <li><em>“Replace with”</em>: <code class=\"language-plaintext highlighter-rouge\">genotype</code></li>\n          </ul>\n        </li>\n        <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Find and Replace”</em>\n          <ul>\n            <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">\"Sample Characteristic[individual]\"</code></li>\n            <li><em>“Replace with”</em>: <code class=\"language-plaintext highlighter-rouge\">batch</code></li>\n          </ul>\n        </li>\n        <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Find and Replace”</em>\n          <ul>\n            <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">\"Sample Characteristic[sex]\"</code></li>\n            <li><em>“Replace with”</em>: <code class=\"language-plaintext highlighter-rouge\">sex</code></li>\n          </ul>\n        </li>\n        <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Find and Replace”</em>\n          <ul>\n            <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">\"Sample Characteristic[cell type]\"</code></li>\n            <li><em>“Replace with”</em>: <code class=\"language-plaintext highlighter-rouge\">cell_type</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>Rename <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> output <code class=\"language-plaintext highlighter-rouge\">Cell metadata</code></li>\n  </ol>\n</blockquote>\n\n<h2 id=\"check-mitochondrial-gene-name-format\">Check mitochondrial gene name format</h2>\n\n<p>We might like to flag mitochondrial genes. They can be identified quite easily since - depending on the species and formatting convention - their names often start with <code class=\"language-plaintext highlighter-rouge\">mt</code>. Since tools for flagging mitochondrial genes are often case-sensitive, it might be a good idea to check the formatting of the mitochondrial genes in our dataset.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title> Check the format of mitochondrial genes names </hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_grep_tool/1.1.1\" title=\"Search in textfiles tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Search in textfiles</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.1.1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span>  <em>“Select lines from”</em>: <code class=\"language-plaintext highlighter-rouge\">EBI SCXA Data Retrieval on E-MTAB-6945 genes.tsv (Raw filtered counts)</code></li>\n        <li><em>“that”</em>: <code class=\"language-plaintext highlighter-rouge\">Match</code></li>\n        <li><em>“Regular Expression”</em>: <code class=\"language-plaintext highlighter-rouge\">mt</code></li>\n        <li><em>“Match type”</em>: <code class=\"language-plaintext highlighter-rouge\">case insensitive</code></li>\n        <li><em>“Output”</em>: <code class=\"language-plaintext highlighter-rouge\">Highlighted HTML (for easier viewing)</code></li>\n      </ul>\n    </li>\n    <li>Rename <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> output <code class=\"language-plaintext highlighter-rouge\">Mito genes check</code></li>\n  </ol>\n\n</blockquote>\n\n<p>If you click on that dataset, you will see all the genes containing <code class=\"language-plaintext highlighter-rouge\">mt</code> in their name. We can now clearly see that mitochondrial genes in our dataset start with <code class=\"language-plaintext highlighter-rouge\">mt-</code>. Keep that in mind, we might use it in a moment!</p>\n\n<p>Now we can create our single cell object!</p>\n\n<blockquote class=\"notranslate hands_on gtn-cyoa\" id=\"gtn-cyoa\">\n\t<div class=\"box-title\" aria-label=\"hands-on box: choose your own tutorial\"><i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\"></span> Hands-on: Choose Your Own Tutorial</div>\n\t<p>This is a \"Choose Your Own Tutorial\" section, where you can select between multiple paths. Click one of the buttons below to select how you want to follow the tutorial</p>\n\t\n\t<p>\n\t\tYou can choose whether you want to create an AnnData object for Scanpy Analysis or an RDS object for Seurat Analysis. Galaxy has more resources for Scanpy analysis, but sometimes Seurat might have what you want. The two packages are constantly trying to outdo the other! It often depends on what is more 'standard' in your work environment!\n\t</p>\n\t\n\t\n\t\t<input id=\"cyoa-opt1\" type=\"radio\" name=\"cyoa\" value=\"Scanpy\" onclick=\"cyoaChoice('Scanpy', 'gtn-cyoa')\" />\n\t\t<label for=\"cyoa-opt1\" class=\"select btn btn-secondary\">Scanpy</label>\n\t\n\t\n\t\t<input id=\"cyoa-opt2\" type=\"radio\" name=\"cyoa\" value=\"Seurat\" onclick=\"cyoaChoice('Seurat', 'gtn-cyoa')\" />\n\t\t<label for=\"cyoa-opt2\" class=\"select btn btn-secondary\">Seurat</label>\n\t\n\t\n\t\n\n\t\n\t<script>\n\t\tfunction ready(fn) {\n\t\t\tif (document.readyState != 'loading'){\n\t\t\t\tfn();\n\t\t\t} else {\n\t\t\t\tdocument.addEventListener('DOMContentLoaded', fn);\n\t\t\t}\n\t\t}\n\t\tready(function() {\n\t\t\tcyoaDefault(\"Scanpy\", \"gtn-cyoa\");\n\t\t})\n\t</script>\n\t\n</blockquote>\n\n<div class=\"Scanpy\">\n\n  <h2 id=\"creating-the-anndata-object\">Creating the AnnData object</h2>\n\n  <p>We will do several modifications within the AnnData object so that you can follow <a href=\"/training-material/topics/single-cell/tutorials/scrna-case_basic-pipeline/tutorial.html\">the next tutorial</a>.</p>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title> Create the AnnData Object </hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_read_10x/scanpy_read_10x/1.8.1+galaxy9\" title=\"Scanpy Read10x tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Scanpy Read10x</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.8.1+galaxy9)</span></li>\n      <li>Make sure you are using version <strong>1.8.1+galaxy9</strong> of the tool (change by clicking on <i class=\"fas fa-cubes\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool-versions</span> Versions button):</li>\n    </ol>\n    <figure id=\"figure-6\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/version.png\" alt=\"List of available tool versions shown when clicking on the 'Versions' button on the top of the page.\" width=\"444\" height=\"562\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/version.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 6</strong>:</span> How to change the version of the tool</figcaption></figure>\n\n    <ol>\n      <li>Set the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Expression matrix in sparse matrix format (.mtx)”</em>: <code class=\"language-plaintext highlighter-rouge\">EBI SCXA Data Retrieval on E-MTAB-6945 matrix.mtx (Raw filtered counts)</code></li>\n          <li><em>“Gene table”</em>:  <code class=\"language-plaintext highlighter-rouge\">EBI SCXA Data Retrieval on E-MTAB-6945 genes.tsv (Raw filtered counts)</code></li>\n          <li><em>“Barcode/cell table”</em>: <code class=\"language-plaintext highlighter-rouge\">EBI SCXA Data Retrieval on E-MTAB-6945 barcodes.tsv (Raw filtered counts)</code></li>\n          <li><em>“Cell metadata table”</em>: <code class=\"language-plaintext highlighter-rouge\">Cell metadata</code></li>\n        </ul>\n      </li>\n      <li>Rename <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> output <code class=\"language-plaintext highlighter-rouge\">AnnData object</code></li>\n    </ol>\n\n  </blockquote>\n\n  <h2 id=\"anndata-manipulation\">AnnData manipulation</h2>\n\n  <p>We will now change the header of the column containing gene names from <code class=\"language-plaintext highlighter-rouge\">gene_symbols</code> to <code class=\"language-plaintext highlighter-rouge\">Symbol</code>. This edit is only needed to make our AnnData object compatible with this tutorial’s workflow. We will also flag the mitochondrial genes.</p>\n\n  <p>And the good news is that we can do both those steps using only one tool!</p>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title> Modify AnnData object </hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/anndata_ops/anndata_ops/1.8.1+galaxy92\" title=\"AnnData Operations tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>AnnData Operations</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.8.1+galaxy92)</span></li>\n      <li>Make sure you are using version <strong>1.8.1+galaxy92</strong> of the tool (change by clicking on <i class=\"fas fa-cubes\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool-versions</span> Versions button)</li>\n      <li>Set the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> In <em>“Input object in hdf5 AnnData format”</em>: <code class=\"language-plaintext highlighter-rouge\">AnnData object</code></li>\n          <li>In <em>“Change field names in AnnData var”</em>:\n            <ul>\n              <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Change field names in AnnData var”</em>\n                <ul>\n                  <li><em>“Original name”</em>: <code class=\"language-plaintext highlighter-rouge\">gene_symbols</code></li>\n                  <li><em>“New name”</em>: <code class=\"language-plaintext highlighter-rouge\">Symbol</code></li>\n                </ul>\n              </li>\n            </ul>\n          </li>\n          <li><em>“Gene symbols field in AnnData”</em>: <code class=\"language-plaintext highlighter-rouge\">Symbol</code></li>\n          <li>In <em>“Flag genes that start with these names”</em>:\n            <ul>\n              <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Flag genes that start with these names”</em>\n                <ul>\n                  <li><em>“Starts with”</em>: <code class=\"language-plaintext highlighter-rouge\">mt-</code></li>\n                  <li><em>“Var name”</em>: <code class=\"language-plaintext highlighter-rouge\">mito</code></li>\n                </ul>\n              </li>\n            </ul>\n          </li>\n        </ul>\n      </li>\n      <li>Rename <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> output <code class=\"language-plaintext highlighter-rouge\">Mito-counted AnnData for downstream analysis</code></li>\n    </ol>\n\n  </blockquote>\n\n  <p>And that’s all! What’s even more exciting about the <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> <strong>AnnData Operations</strong> tool is that it automatically calculates a bunch of metrics, such as <code class=\"language-plaintext highlighter-rouge\">log1p_mean_counts</code>, <code class=\"language-plaintext highlighter-rouge\">log1p_total_counts</code>, <code class=\"language-plaintext highlighter-rouge\">mean_counts</code>, <code class=\"language-plaintext highlighter-rouge\">n_cells</code>, <code class=\"language-plaintext highlighter-rouge\">n_cells_by_counts</code>, <code class=\"language-plaintext highlighter-rouge\">n_counts</code>, <code class=\"language-plaintext highlighter-rouge\">pct_dropout_by_counts</code>, and <code class=\"language-plaintext highlighter-rouge\">total_counts</code>. Amazing, isn’t it?</p>\n\n  <h2 id=\"conclusion\">Conclusion</h2>\n  <p>Now you can use this object as input for the <a href=\"/training-material/topics/single-cell/tutorials/scrna-case_basic-pipeline/tutorial.html\">Filter, Plot, Explore tutorial</a> and its associated workflow!</p>\n\n  <p>Even though this tutorial was designed specifically to modify the AnnData object to be compatible with the subsequent tutorial, it also shows useful tools that you can use for your own, independent data analysis. You can find the <a href=\"https://singlecell.usegalaxy.eu/u/j.jakiela/w/workflow-constructed-from-history-ebi-workflow\">workflow</a> and the <a href=\"https://singlecell.usegalaxy.eu/u/j.jakiela/h/ebi-scxa---anndata-scanpy-or-seurat-object-1\">answer key history</a>. However, if you want to use the workflow from this tutorial, you have to keep in mind that different datasets may have different column names. So you have to check them first, and only then you can modify them.</p>\n\n</div>\n\n<div class=\"Seurat\">\n\n  <h2 id=\"creating-the-seurat-object\">Creating the Seurat Object</h2>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title> Create the Seurat Object </hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/seurat_read10x/seurat_read10x/3.2.3+galaxy0\" title=\"Seurat Read10x tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Seurat Read10x</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 3.2.3+galaxy0)</span></li>\n      <li>Set the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Expression matrix in sparse matrix format (.mtx)”</em>: <code class=\"language-plaintext highlighter-rouge\">EBI SCXA Data Retrieval on E-MTAB-6945 matrix.mtx (Raw filtered counts)</code></li>\n          <li><em>“Gene table”</em>:  <code class=\"language-plaintext highlighter-rouge\">EBI SCXA Data Retrieval on E-MTAB-6945 genes.tsv (Raw filtered counts)</code></li>\n          <li><em>“Barcode/cell table”</em>: <code class=\"language-plaintext highlighter-rouge\">EBI SCXA Data Retrieval on E-MTAB-6945 barcodes.tsv (Raw filtered counts)</code></li>\n          <li><em>“Cell metadata”</em>: <code class=\"language-plaintext highlighter-rouge\">Cell metadata</code></li>\n        </ul>\n      </li>\n      <li>Rename <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> output <code class=\"language-plaintext highlighter-rouge\">Seurat object</code></li>\n    </ol>\n\n    <p>You can also choose if you want to create Seurat object, Loom or Single Cell Experiment by selecting your option in <em>“Choose the format of the output”</em>.</p>\n\n  </blockquote>\n\n  <h2 id=\"conclusion-1\">Conclusion</h2>\n  <p>And you’re there! You now have a usable Seurat object for analysis with Seurat tools in your history! <i class=\"far fa-thumbs-up\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">congratulations</span> Congrats!</p>\n\n</div>\n\n<!---\nHCA doesn't work well for other datasets for now...\nhttps://github.com/galaxyproject/training-material/issues/4567 \n-->\n\n<h1 id=\"human-cell-atlas-matrix-downloader\">Human Cell Atlas Matrix Downloader</h1>\n\n<p>Another public atlas that you can use to access the datasets is <a href=\"https://data.humancellatlas.org/\">Human Cell Atlas data portal</a>. We will show you the tool in Galaxy which allows to retrieve expression matrices and metadata for any public experiment available in that repository.</p>\n\n<p>To use it, simply set the project title, project label or project UUID, which can be found at the <a href=\"https://data.humancellatlas.org/explore/projects\">HCA data browser</a>, and select the desired matrix format (Matrix Market or Loom).</p>\n\n<figure id=\"figure-7\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-data/HCA.jpg\" alt=\"Image showing project UUID as a final fragment of link address, project title (self-explanatory) and project label as an entry in the box on the right side of the page.\" width=\"1869\" height=\"973\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-data/HCA.jpg\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 7</strong>:</span> Where to find project title, project label and project UUID</figcaption></figure>\n\n<p>For projects that have more than one organism, one needs to be specified. Otherwise, there is no need to set the species.</p>\n\n<p>Let’s use the suggested example of the project <em>Single cell transcriptome analysis of human pancreas</em>. If you check this project in HCA, you’ll find out that it’s actually its label. But it will work the same if you enter the title or UUID!</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Create AnnData object</hands-on-title>\n\n  <p><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/hca_matrix_downloader/hca_matrix_downloader/v0.0.4+galaxy0\" title=\"Human Cell Atlas Matrix Downloader tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Human Cell Atlas Matrix Downloader</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version v0.0.4+galaxy0)</span> with the following parameters:</p>\n  <ul>\n    <li><em>“Human Cell Atlas project name/label/UUID”</em>: <code class=\"language-plaintext highlighter-rouge\">Single cell transcriptome analysis of human pancreas</code></li>\n    <li><em>“Choose the format of matrix to download”</em>:  <code class=\"language-plaintext highlighter-rouge\">Matrix Market</code></li>\n  </ul>\n</blockquote>\n\n<blockquote class=\"details\">\n  <details-title>What will be the output?</details-title>\n\n  <p>When “Matrix Market” is seleted, outputs are in 10X-compatible Matrix Market format:</p>\n  <ul>\n    <li><strong>Matrix (txt)</strong>: Contains the expression values for genes (rows) and cells (columns) in raw counts. This text file is formatted as a Matrix Market file, and as such it is accompanied by separate files for the gene identifiers and the cells identifiers.</li>\n    <li><strong>Genes (tsv)</strong>: Identifiers (column repeated) for the genes present in the matrix of expression, in the same order as the matrix rows.</li>\n    <li><strong>Barcodes (tsv)</strong>: Identifiers for the cells of the data matrix. The file is ordered to match the columns of the matrix.</li>\n    <li><strong>Experiment Design file (tsv)</strong>: Contains metadata for the different cells of the experiment.</li>\n  </ul>\n\n  <p>When “Loom” is selected, output is a single Loom HDF5 file:</p>\n  <ul>\n    <li><strong>Loom (h5)</strong>: Contains expression values for genes (rows) and cells (columns) in raw counts, cell metadata table and gene metadata table, in a <a href=\"http://linnarssonlab.org/loompy/format/index.html\">single HDF5 file</a>.</li>\n  </ul>\n\n</blockquote>\n\n<p>If you chose <strong>Loom</strong> format and you need to convert your file to other datatype, you can use <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/sceasy_convert/sceasy_convert/0.0.7+galaxy1\" title=\"SCEasy tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>SCEasy</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.0.7+galaxy1)</span> (more details in the next section). If you chose <strong>Matrix Market</strong> format, you can then transform the output to AnnData or Seurat, as shown in the EBI SCXA example above. Below, you will find an example of transforming the output to AnnData object.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Create AnnData object</hands-on-title>\n\n  <p><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_read_10x/scanpy_read_10x/1.8.1+galaxy0\" title=\"Scanpy Read10x tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Scanpy Read10x</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.8.1+galaxy0)</span> with the following parameters:</p>\n  <ul>\n    <li><em>“Expression matrix in sparse matrix format (.mtx)”</em>: <code class=\"language-plaintext highlighter-rouge\">Human Cell Atlas Matrix Downloader on matrix.mtx</code></li>\n    <li><em>“Gene table”</em>:  <code class=\"language-plaintext highlighter-rouge\">Human Cell Atlas Matrix Downloader on genes.tsv</code></li>\n    <li><em>“Barcode/cell table”</em>: <code class=\"language-plaintext highlighter-rouge\">Human Cell Atlas Matrix Downloader on barcodes.tsv</code></li>\n    <li><em>“Cell metadata table”</em>: <code class=\"language-plaintext highlighter-rouge\">Human Cell Atlas Matrix Downloader on exp_design.tsv</code></li>\n  </ul>\n</blockquote>\n\n<blockquote class=\"tip\">\n  <tip-title>Flagging genes by using AnnData Operations</tip-title>\n\n  <p>After you create AnnData file, you can additionally use the <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/anndata_ops/anndata_ops/1.8.1+galaxy92\" title=\"AnnData Operations tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>AnnData Operations</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.8.1+galaxy92)</span> tool before downstream analysis. It’s quite a useful tool since not only does it flag mitochondrial genes, but also automatically calculates a bunch of metrics, such as <code class=\"language-plaintext highlighter-rouge\">log1p_mean_counts</code>, <code class=\"language-plaintext highlighter-rouge\">log1p_total_counts</code>, <code class=\"language-plaintext highlighter-rouge\">mean_counts</code>, <code class=\"language-plaintext highlighter-rouge\">n_cells</code>, <code class=\"language-plaintext highlighter-rouge\">n_cells_by_counts</code>, <code class=\"language-plaintext highlighter-rouge\">n_counts</code>, <code class=\"language-plaintext highlighter-rouge\">pct_dropout_by_counts</code>, and <code class=\"language-plaintext highlighter-rouge\">total_counts</code>.</p>\n\n  <p>When you use it to flag mitochondrial genes, here are some formatting tips:</p>\n  <ul>\n    <li>Remember to check the name of the column with gene symbols</li>\n    <li>This tool is case sensitive</li>\n    <li>No parentheses needed when typing in the values</li>\n    <li>Including a dash is important to identify mitochondrial genes (eg. <strong>MT-</strong>)</li>\n  </ul>\n</blockquote>\n\n"],"ref_slides":[],"hands_on":true,"slides":false,"mod_date":"2023-12-15 13:30:34 +0000","pub_date":"2023-11-14 17:16:58 +0000","version":29,"workflows":[{"workflow":"EBI-SCXA-to-AnnData-(Scanpy)-or-Seurat-Object.ga","tests":true,"url":"https://training.galaxyproject.org/training-material/topics/single-cell/tutorials/EBI-retrieval/workflows/EBI-SCXA-to-AnnData-(Scanpy)-or-Seurat-Object.ga","path":"topics/single-cell/tutorials/EBI-retrieval/workflows/EBI-SCXA-to-AnnData-(Scanpy)-or-Seurat-Object.ga","wfid":"single-cell-EBI-retrieval","wfname":"ebi-scxa-to-anndata-(scanpy)-or-seurat-object","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/single-cell-EBI-retrieval/versions/ebi-scxa-to-anndata-(scanpy)-or-seurat-object","license":"CC-BY-4.0","creators":[{"class":"Person","identifier":"0009-0001-2017-8805","name":"Julia Jakiela"}],"name":"EBI SCXA to AnnData (Scanpy) or Seurat Object","title":"EBI SCXA to AnnData (Scanpy) or Seurat Object","test_results":null,"modified":"2024-06-24 07:14:30 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Parameter\\nSC-Atlas experiment accession\"];\n  style 0 fill:#ded,stroke:#393,stroke-width:4px;\n  1[\"EBI SCXA Data Retrieval\"];\n  0 -->|output| 1;\n  2[\"Rename batch numbers\"];\n  1 -->|design_tsv| 2;\n  3[\"Mito genes check\"];\n  1 -->|genes_tsv| 3;\n  b0762cfd-58bd-4c39-ae41-2dca4289c541[\"Output\\nMito genes check\"];\n  3 --> b0762cfd-58bd-4c39-ae41-2dca4289c541;\n  style b0762cfd-58bd-4c39-ae41-2dca4289c541 stroke:#2c3143,stroke-width:4px;\n  4[\"Rename cell metadata headers\"];\n  2 -->|out_file1| 4;\n  5[\"Create AnnData\"];\n  1 -->|barcode_tsv| 5;\n  4 -->|outfile| 5;\n  1 -->|genes_tsv| 5;\n  1 -->|matrix_mtx| 5;\n  938cd594-61cf-4037-a58b-c09c065db505[\"Output\\nAnnData object\"];\n  5 --> 938cd594-61cf-4037-a58b-c09c065db505;\n  style 938cd594-61cf-4037-a58b-c09c065db505 stroke:#2c3143,stroke-width:4px;\n  6[\"Seurat Read10x\"];\n  1 -->|barcode_tsv| 6;\n  1 -->|genes_tsv| 6;\n  1 -->|matrix_mtx| 6;\n  4 -->|outfile| 6;\n  c24e9d83-c175-40a2-9c36-eeb486fe323e[\"Output\\nSeurat object\"];\n  6 --> c24e9d83-c175-40a2-9c36-eeb486fe323e;\n  style c24e9d83-c175-40a2-9c36-eeb486fe323e stroke:#2c3143,stroke-width:4px;\n  7[\"AnnData Operations\"];\n  5 -->|output_h5ad| 7;\n  b47f801f-bedb-4136-a5e9-378a815a1799[\"Output\\nMito-counted AnnData for downstream analysis\"];\n  7 --> b47f801f-bedb-4136-a5e9-378a815a1799;\n  style b47f801f-bedb-4136-a5e9-378a815a1799 stroke:#2c3143,stroke-width:4px;"}],"api":"https://training.galaxyproject.org/training-material/api/topics/single-cell/tutorials/EBI-retrieval/tutorial.json","tools":["toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_find_and_replace/1.1.4","toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_grep_tool/1.1.1","toolshed.g2.bx.psu.edu/repos/ebi-gxa/anndata_ops/anndata_ops/1.8.1+galaxy92","toolshed.g2.bx.psu.edu/repos/ebi-gxa/hca_matrix_downloader/hca_matrix_downloader/v0.0.4+galaxy0","toolshed.g2.bx.psu.edu/repos/ebi-gxa/retrieve_scxa/retrieve_scxa/v0.0.2+galaxy2","toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_read_10x/scanpy_read_10x/1.8.1+galaxy0","toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_read_10x/scanpy_read_10x/1.8.1+galaxy9","toolshed.g2.bx.psu.edu/repos/ebi-gxa/seurat_read10x/seurat_read10x/3.2.3+galaxy0","toolshed.g2.bx.psu.edu/repos/galaxyp/regex_find_replace/regexColumn1/1.0.3","toolshed.g2.bx.psu.edu/repos/iuc/sceasy_convert/sceasy_convert/0.0.7+galaxy1"],"supported_servers":{"exact":[{"url":"https://usegalaxy.eu","name":"UseGalaxy.eu","usegalaxy":true}],"inexact":[]},"topic_name_human":"Single Cell","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"text_processing","owner":"bgruening","revisions":"d698c222f354","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"text_processing","owner":"bgruening","revisions":"d698c222f354","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"anndata_ops","owner":"ebi-gxa","revisions":"a0274bc43b7e","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"hca_matrix_downloader","owner":"ebi-gxa","revisions":"c3c85b67d118","tool_panel_section_label":"Single Cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"retrieve_scxa","owner":"ebi-gxa","revisions":"72b6e1747e37","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"scanpy_read_10x","owner":"ebi-gxa","revisions":"d253d69ff19f","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"scanpy_read_10x","owner":"ebi-gxa","revisions":"9afcfcd1d215","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"seurat_read10x","owner":"ebi-gxa","revisions":"301cf1b4b43d","tool_panel_section_label":"Single Cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"regex_find_replace","owner":"galaxyp","revisions":"503bcd6ebe4b","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"sceasy_convert","owner":"iuc","revisions":"d70139524747","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: text_processing\n  owner: bgruening\n  revisions: d698c222f354\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: text_processing\n  owner: bgruening\n  revisions: d698c222f354\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: anndata_ops\n  owner: ebi-gxa\n  revisions: a0274bc43b7e\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: hca_matrix_downloader\n  owner: ebi-gxa\n  revisions: c3c85b67d118\n  tool_panel_section_label: Single Cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: retrieve_scxa\n  owner: ebi-gxa\n  revisions: 72b6e1747e37\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_read_10x\n  owner: ebi-gxa\n  revisions: d253d69ff19f\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_read_10x\n  owner: ebi-gxa\n  revisions: 9afcfcd1d215\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: seurat_read10x\n  owner: ebi-gxa\n  revisions: 301cf1b4b43d\n  tool_panel_section_label: Single Cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: regex_find_replace\n  owner: galaxyp\n  revisions: 503bcd6ebe4b\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: sceasy_convert\n  owner: iuc\n  revisions: d70139524747\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":false,"slides_recordings":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial","contributors":[{"name":"Julia Jakiela","email":"juliajot36@gmail.com","joined":"2022-06","id":"wee-snufkin","url":"https://training.galaxyproject.org/training-material/api/contributors/wee-snufkin.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/wee-snufkin/"},{"name":"Wendi Bacon","email":"wendi.bacon@open.ac.uk","twitter":"WendiBacon1","matrix":"nomadscientist:matrix.org","joined":"2020-03","elixir_node":"uk","orcid":"0000-0002-8170-8806","bio":"Lecturer at The Open University","fediverse":"https://mstdn.science/@wendibacon1","fediverse_flavor":"mastodon","affiliations":["elixir-europe"],"id":"nomadscientist","url":"https://training.galaxyproject.org/training-material/api/contributors/nomadscientist.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/nomadscientist/"},{"name":"ELIXIR-UK: FAIR Data Stewardship training","short_name":"ELIXIR Fair Data","github":false,"joined":"2023-06","funder":true,"funding_id":"MR/V038966/1","funding_system":"ukri","funding_statement":"This work has been funded by the ELIXIR-UK FAIR Data Stewardship training UKRI award (MR/V038966/1)","id":"elixir-fair-data","url":"https://training.galaxyproject.org/training-material/api/funders/elixir-fair-data.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/elixir-fair-data/"}]}