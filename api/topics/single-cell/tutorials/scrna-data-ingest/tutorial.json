{"layout":"tutorial_hands_on","subtopic":"datamanipulation","priority":1,"title":"Converting between common single cell data formats","questions":["What are the most popular single cell datatypes?","What if the format of my files is different than that used in the tutorial I want to follow?","Where should I start the analysis, depending on the format of my data?","How do I ingest data into Galaxy?","How do I convert datasets between formats?"],"objectives":["You will identify different single cell files formats.","You will import single cell data into Galaxy using different methods.","You will manipulate the metadata and matrix files.","You will perform conversions between the most common single cell formats.","You will downsample FASTQ files."],"time_estimation":"1H","key_points":["Single cell data from different sources may have unfamiliar formatting and thus may require different ways of ingesting it into Galaxy.","There are many ways of importing single cell files into Galaxy and converting between single cell formats."],"contributions":{"authorship":["wee-snufkin","hexhowells","nomadscientist"],"editing":["hexylena"],"testing":["pavanvidem","mtekman"],"funding":["elixir-fair-data"]},"zenodo_link":"https://zenodo.org/record/4574153","follow_up_training":[{"type":"internal","topic_name":"single-cell"}],"tags":["data management","data import"],"js_requirements":{"mathjax":null,"mermaid":false},"short_id":"T00418","url":"/topics/single-cell/tutorials/scrna-data-ingest/tutorial.html","topic_name":"single-cell","tutorial_name":"scrna-data-ingest","dir":"topics/single-cell/tutorials/scrna-data-ingest","symlink":null,"id":"single-cell/scrna-data-ingest","ref_tutorials":["<p>You finally decided to analyse some single cell data, you got your files either from the lab or publicly available sources, you opened the first tutorial available on Galaxy Training Network and… you hit the wall! The format of your files is not compatible with the one used in tutorial! Have you been there? \nThis tutorial was created to help you overcome that problem and ensure data interoperability in single cell analysis. Once you get your data into Galaxy in the right format, that’s already 50% of success. Additionally, by using format conversion, you will be able to use different packages presented in tutorials that may require different datatypes.</p>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n  <p>In this tutorial, we will cover:</p>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#single-cell-datatypes\" id=\"markdown-toc-single-cell-datatypes\">Single cell datatypes</a></li>\n  <li><a href=\"#data-import\" id=\"markdown-toc-data-import\">Data import</a></li>\n  <li><a href=\"#sceasy-tool\" id=\"markdown-toc-sceasy-tool\">SCEasy Tool</a></li>\n  <li><a href=\"#seurat---anndata\" id=\"markdown-toc-seurat---anndata\">Seurat -&gt; AnnData</a>    <ol>\n      <li><a href=\"#quick-one-tool-method\" id=\"markdown-toc-quick-one-tool-method\">Quick one tool method</a></li>\n      <li><a href=\"#convert-to-anndata-object-compatible-with-filter-plot-explore-workflow\" id=\"markdown-toc-convert-to-anndata-object-compatible-with-filter-plot-explore-workflow\">Convert to AnnData object compatible with Filter, Plot, Explore workflow</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#anndata---seurat\" id=\"markdown-toc-anndata---seurat\">AnnData -&gt; Seurat</a>    <ol>\n      <li><a href=\"#quick-one-step-method\" id=\"markdown-toc-quick-one-step-method\">Quick one step method</a></li>\n      <li><a href=\"#manual-conversion\" id=\"markdown-toc-manual-conversion\">Manual conversion</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#anndata---singlecellexperiment-sce\" id=\"markdown-toc-anndata---singlecellexperiment-sce\">AnnData -&gt; SingleCellExperiment (SCE)</a>    <ol>\n      <li><a href=\"#quick-single-tool-method\" id=\"markdown-toc-quick-single-tool-method\">Quick single tool method</a></li>\n      <li><a href=\"#convert-manually\" id=\"markdown-toc-convert-manually\">Convert manually</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#anndata---cell-data-set-cds\" id=\"markdown-toc-anndata---cell-data-set-cds\">Anndata -&gt; Cell Data Set (CDS)</a>    <ol>\n      <li><a href=\"#cds-input-for-monocle3-tutorial-use-for-pre-processed-data\" id=\"markdown-toc-cds-input-for-monocle3-tutorial-use-for-pre-processed-data\">CDS input for Monocle3 tutorial (use for pre-processed data)</a></li>\n      <li><a href=\"#get-data\" id=\"markdown-toc-get-data\">Get data</a></li>\n      <li><a href=\"#extracting-annotations\" id=\"markdown-toc-extracting-annotations\">Extracting annotations</a></li>\n      <li><a href=\"#cell-metadata\" id=\"markdown-toc-cell-metadata\">Cell metadata</a></li>\n      <li><a href=\"#gene-annotations\" id=\"markdown-toc-gene-annotations\">Gene annotations</a></li>\n      <li><a href=\"#expression-matrix\" id=\"markdown-toc-expression-matrix\">Expression matrix</a></li>\n      <li><a href=\"#creating-cds-object\" id=\"markdown-toc-creating-cds-object\">Creating CDS object</a></li>\n      <li><a href=\"#general-anndata-to-cds-conversion\" id=\"markdown-toc-general-anndata-to-cds-conversion\">General AnnData to CDS conversion</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#downsampling-fastq-files\" id=\"markdown-toc-downsampling-fastq-files\">Downsampling FASTQ files</a></li>\n</ol>\n\n</blockquote>\n\n<h1 id=\"single-cell-datatypes\">Single cell datatypes</h1>\n\n<p>To start with, here are the most common formats and datatypes that you might come across if you work with single cell data:</p>\n<ul>\n  <li><strong>Tabular</strong> - simply using TSV, CSV or TXT formats to store expression matrix as well as cell and gene metadata.</li>\n  <li><strong>MTX</strong> - it’s just a sparse matrix format with genes on the rows and cells on the columns as output by Cell Ranger.</li>\n  <li><strong>HDF5</strong> - Hierarchical Data Format - can store datasets and groups. A dataset is a  a multidimensional array of data elements, together with supporting metadata. A group is a structure for organizing objects in an HDF5 file. This format allows for storing both the count matrices and all metadata in a single file rather than having separate features, barcodes and matrix files.</li>\n  <li><strong>AnnData objects</strong> - <a href=\"https://anndata.readthedocs.io/en/latest/\">anndata</a> is a Python package for handling annotated data matrices. In Galaxy, you’ll see AnnData objects in <strong>h5ad</strong> format, which is based on the standard HDF5 (h5) format. There are lots of Python tools that work with this format, such as Scanpy, MUON, Cell Oracle, SquidPy, etc.</li>\n  <li><strong>Loom</strong> - it is simply an HDF5 file that contains specific groups containing the main matrix as well as row and column attributes and can be read by any language supporting HDF5. <a href=\"https://linnarssonlab.org/loompy/\">Loompy</a> has been released as a Python API to interact with loom files, and <a href=\"https://github.com/mojaveazure/loomR\">loomR</a> is its implementation in R.</li>\n  <li><strong>Zarr</strong> - a Python package providing an implementation of compressed, chunked, N-dimensional arrays, designed for use in parallel computing. The Zarr file format offers powerful compression options, supports multiple data store backends, and can read/write your NumPy arrays.</li>\n  <li><strong>Seurat objects</strong> - a representation of single-cell expression data for R, in Galaxy you might see them in <strong>rdata</strong> format.</li>\n  <li><strong>Single Cell Experiment (SCE) object</strong> - defines a S4 class for storing data from single-cell experiments and provides a more formalized approach towards construction and accession of data. The S4 system is one of R’s systems for object oriented programing. In Galaxy you might see SCE objects in <strong>rdata</strong> format.</li>\n  <li><strong>CellDataSet (CDS) object</strong> - the main class used by Monocle to hold single cell expression data. In Galaxy you might see CDS objects in <strong>rdata</strong> format.</li>\n</ul>\n\n<!---\nTO FURTHER IMPROVE THE TUTORIAL:\ninclude images showing the structure of those files\n-->\n\n<!--SNIPPET-->\n<blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-using-tutorial-mode\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-using-tutorial-mode\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Using tutorial mode</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>Tools are frequently updated to new versions. Your Galaxy may have multiple versions of the same tool available. By default, you will be shown the latest version of the tool. This may NOT be the same tool used in the tutorial you are accessing. Furthermore, if you use a newer tool in one step, and try using an older tool in the next step… this may fail! To ensure you use the same tool versions of a given tutorial, use the <strong>Tutorial mode</strong> feature.</p>   <ul>   <li>Open your Galaxy server</li>   <li>Click on the <i class=\"fas fa-graduation-cap\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">curriculum</span> icon on the top menu, this will open the GTN inside Galaxy.</li>   <li>Navigate to your tutorial</li>   <li>Tool names in tutorials will be blue buttons that open the correct tool for you</li>   <li><strong>Note:</strong> this does not work for all tutorials (yet)   <img src=\"/training-material/topics/contributing/images/88277962-ddda4a80-cce1-11ea-92cd-41b1df063db0.gif\" alt=\"gif showing how GTN-in-Galaxy works\" /></li>   <li>You can click anywhere in the grey-ed out area outside of the tutorial box to return back to the Galaxy analytical interface</li> </ul>   <blockquote class=\"warning\">   <warning-title>Not all browsers work!</warning-title>   <ul>     <li>We’ve had some issues with Tutorial mode on Safari for Mac users.</li>     <li>Try a <strong>different browser</strong> if you aren’t seeing the button.</li>   </ul> </blockquote> </blockquote>\n<p><!--END_SNIPPET--></p>\n\n<h1 id=\"data-import\">Data import</h1>\n<p>As you can see above, there are multiple ways to store single cell data. Therefore, there are also many ways how you can get that data! \nObviously, before any format conversion, we need to import the data. In our tutorials we often use <a href=\"https://zenodo.org/\">Zenodo</a> links, but you can also upload the files directly from your computer. There are also publicly available resources which you can easily access through public atlases, such as <a href=\"https://www.ebi.ac.uk/gxa/sc/home\">Single Cell Expression Atlas</a> or <a href=\"https://data.humancellatlas.org/\">Human Cell Atlas data portal</a>. We created a <a href=\"/training-material/topics/single-cell/tutorials/EBI-retrieval/tutorial.html\">dedicated tutorial</a> to show how to use those atlases to retrieve data. But today we’re here to focus on data conversion!</p>\n\n<h1 id=\"sceasy-tool\">SCEasy Tool</h1>\n<p>In Galaxy Toolshed there is a wonderful tool called <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/sceasy_convert/sceasy_convert/0.0.7+galaxy2\" title=\"SCEasy tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>SCEasy</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.0.7+galaxy2)</span> which allows you to convert between common single cell formats, such as:</p>\n<ul>\n  <li>AnnData to CellDataSet (CDS)</li>\n  <li>AnnData to Seurat</li>\n  <li>Loom to AnnData</li>\n  <li>Loom to SingleCellExperiment (SCE)</li>\n  <li>SingleCellExperiment (SCE) to AnnData</li>\n  <li>SingleCellExperiment (SCE) to Loom</li>\n  <li>Seurat to AnnData</li>\n  <li>Seurat to SingleCellExperiment (SCE)</li>\n</ul>\n\n<blockquote class=\"warning\">\n  <warning-title>Two SCEasy tools</warning-title>\n\n  <p>As of the writing of this tutorial, the updated SCEasy tool is called <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/sceasy_convert/sceasy_convert/0.0.7+galaxy2\" title=\"SCEasy Converter tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>SCEasy Converter</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.0.7+galaxy2)</span> and it’s only available on <em>usegalaxy.eu</em>. The second tool is called <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/sceasy_convert/sceasy_convert/0.0.5+galaxy1\" title=\"SCEasy convert tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>SCEasy convert</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.0.5+galaxy1)</span> and it works on <em>usegalaxy.org</em>, however has limited conversion options. Both tools should be visible on <em>singlecell.usegalaxy.eu</em> if you try to find them in the search box.</p>\n\n</blockquote>\n\n<p>In this tutorial you will see multiple examples of SCEasy Tool in action. However, sometimes it is useful to know how to do this conversion manually or at least to know how it all works and better understand the structure of the files. Therefore, we also have examples showing how to convert objects manually or prepare the input files for some of our single cell tutorials and workflows.</p>\n\n<h1 id=\"seurat---anndata\">Seurat -&gt; AnnData</h1>\n<p>As mentioned above, there are two SCEasy tools currently available. When we speak about conversion to AnnData, the latest tool <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/sceasy_convert/sceasy_convert/0.0.7+galaxy2\" title=\"SCEasy Converter tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>SCEasy Converter</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.0.7+galaxy2)</span> converts Seurat into the latest version of AnnData object. However, currently it is not possible to use that output with downstream EBI single-cell tools because they only support older versions of the AnnData. If you need to use those tools, the solution is to take advantage of the second SCEasy tool <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/sceasy_convert/sceasy_convert/0.0.5+galaxy1\" title=\"SCEasy convert tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>SCEasy convert</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.0.5+galaxy1)</span> which has limited conversion options but can generate AnnData files compatible with the EBI single-cell tools that we are going to use next in the workflow. \nOur Seurat starting file was generated by pulling data from <a href=\"https://www.ebi.ac.uk/gxa/sc/home\">Single Cell Expression Atlas</a> and transforming it into the desired format, what was shown in the <a href=\"/training-material/topics/single-cell/tutorials/EBI-retrieval/tutorial.html\">data import tutorial</a>. It will be our toy dataset.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Get toy data</hands-on-title>\n\n  <ol>\n    <li>Create a new history for this tutorial</li>\n    <li>\n      <p>Import the AnnData object from <a href=\"https://zenodo.org/records/10397653\">Zenodo</a></p>\n\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/records/10397653/files/Seurat_object.rdata\n</code></pre></div>      </div>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-via-links\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-via-links\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing via links</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Alternatively, you can import history where we created the Seurat object: <a href=\"https://singlecell.usegalaxy.eu/u/j.jakiela/h/ebi-scxa---anndata-scanpy-or-seurat-object-1\">Input history</a></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-a-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-a-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing a history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ol>   <li>Open the link to the shared history</li>   <li>Click on the <i class=\"fas fa-plus\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">new-history</span> <em>Import history</em> button on the top right</li>   <li>Enter a title for the new history</li>   <li>Click on <strong>Import</strong></li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the dataset <code class=\"language-plaintext highlighter-rouge\">Seurat object</code></li>\n    <li>\n      <p>Check that the datatype is <code class=\"language-plaintext highlighter-rouge\">rdata</code></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-changing-the-datatype\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-changing-the-datatype\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Changing the datatype</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, click <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Datatypes</strong> tab on the top</li>   <li>In the <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Assign Datatype</strong>, select <code class=\"language-plaintext highlighter-rouge\">rdata</code> from “<em>New type</em>” dropdown     <ul>       <li>Tip: you can start typing the datatype into the field to filter the dropdown menu</li>     </ul>   </li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"notranslate hands_on gtn-cyoa\" id=\"gtn-cyoaseurat2anndata\">\n\t<div class=\"box-title\" aria-label=\"hands-on box: choose your own tutorial\"><i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\"></span> Hands-on: Choose Your Own Tutorial</div>\n\t<p>This is a \"Choose Your Own Tutorial\" section, where you can select between multiple paths. Click one of the buttons below to select how you want to follow the tutorial</p>\n\t\n\t<p>\n\t\tChoose below if you just want to convert your object quickly or see how it all happens behind the scenes!\n\t</p>\n\t\n\t\n\t\t<input id=\"cyoa-opt1seurat2anndata\" type=\"radio\" name=\"cyoaseurat2anndata\" value=\"Quick-one-tool-method\" onclick=\"cyoaChoice('Quick-one-tool-method', 'gtn-cyoaseurat2anndata')\" />\n\t\t<label for=\"cyoa-opt1seurat2anndata\" class=\"select btn btn-secondary\">Quick one tool method</label>\n\t\n\t\n\t\t<input id=\"cyoa-opt2seurat2anndata\" type=\"radio\" name=\"cyoaseurat2anndata\" value=\"Convert-to-AnnData-object-compatible-with-Filter-Plot-Explore-workflow\" onclick=\"cyoaChoice('Convert-to-AnnData-object-compatible-with-Filter-Plot-Explore-workflow', 'gtn-cyoaseurat2anndata')\" />\n\t\t<label for=\"cyoa-opt2seurat2anndata\" class=\"select btn btn-secondary\">Convert to AnnData object compatible with Filter, Plot, Explore workflow</label>\n\t\n\t\n\t\n\n\t\n\t<script>\n\t\tfunction ready(fn) {\n\t\t\tif (document.readyState != 'loading'){\n\t\t\t\tfn();\n\t\t\t} else {\n\t\t\t\tdocument.addEventListener('DOMContentLoaded', fn);\n\t\t\t}\n\t\t}\n\t\tready(function() {\n\t\t\tcyoaDefault(\"Quick-one-tool-method\", \"gtn-cyoaseurat2anndata\");\n\t\t})\n\t</script>\n\t\n</blockquote>\n\n<div class=\"Quick-one-tool-method\">\n\n  <h2 id=\"quick-one-tool-method\">Quick one tool method</h2>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title> SCEasy Converter </hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/sceasy_convert/sceasy_convert/0.0.7+galaxy2\" title=\"SCEasy Converter tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>SCEasy Converter</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.0.7+galaxy2)</span> with the following parameters:\n        <ul>\n          <li><em>“Convert From / To”</em>: <code class=\"language-plaintext highlighter-rouge\">Seurat to AnnData</code></li>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in rds,rdata format”</em>: <code class=\"language-plaintext highlighter-rouge\">Seurat object</code></li>\n        </ul>\n      </li>\n      <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the output: <code class=\"language-plaintext highlighter-rouge\">AnnData object</code></li>\n    </ol>\n\n  </blockquote>\n\n  <p>And that’s it! Please note that the output file is the newest AnnData version and is not compatible with EBI tools used in <a href=\"https://singlecell.usegalaxy.eu/u/j.jakiela/w/copy-of-filter-plot-and-explore-single-cell-rna-seq-data-imported-from-uploaded-file-3\">Filter, Plot, Explore workflow</a>.</p>\n\n</div>\n\n<div class=\"Convert-to-AnnData-object-compatible-with-Filter,-Plot,-Explore-workflow\">\n\n  <h2 id=\"convert-to-anndata-object-compatible-with-filter-plot-explore-workflow\">Convert to AnnData object compatible with Filter, Plot, Explore workflow</h2>\n\n  <p>Here, we use the other SCEasy tool which generates older version of the AnnData which is compatible with the EBI single-cell tools that we are going to use next in the workflow.</p>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title> Seurat to AnnData with SCEasy convert </hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/sceasy_convert/sceasy_convert/0.0.5+galaxy1\" title=\"SCEasy convert tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>SCEasy convert</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.0.5+galaxy1)</span> with the following parameters:\n        <ul>\n          <li><em>“Direction of conversion”</em>: <code class=\"language-plaintext highlighter-rouge\">Seurat to AnnData</code></li>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in Seurat RDS format”</em>: <code class=\"language-plaintext highlighter-rouge\">Seurat object</code>\n(if the dataset does not show up in the corresponding input field, just drag the dataset from the history panel and drop into the input field)</li>\n          <li><em>“Name of the assay to be transferred”</em>: <code class=\"language-plaintext highlighter-rouge\">RNA</code></li>\n          <li><em>“Data type of the assay to be transferred”</em>: <code class=\"language-plaintext highlighter-rouge\">data</code></li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the output <code class=\"language-plaintext highlighter-rouge\">Converted EBI-compatible AnnData file</code>.</p>\n      </li>\n      <li>\n        <p>Check that the datatype is <code class=\"language-plaintext highlighter-rouge\">h5ad</code></p>\n\n        <!--SNIPPET-->\n        <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-changing-the-datatype-1\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-changing-the-datatype-1\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Changing the datatype</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, click <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Datatypes</strong> tab on the top</li>   <li>In the <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Assign Datatype</strong>, select <code class=\"language-plaintext highlighter-rouge\">h5ad</code> from “<em>New type</em>” dropdown     <ul>       <li>Tip: you can start typing the datatype into the field to filter the dropdown menu</li>     </ul>   </li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n        <p><!--END_SNIPPET--></p>\n      </li>\n    </ol>\n\n  </blockquote>\n\n  <p>Now, if we do small modification to metadata, we can use the generated dataset as an input file in the workflow we created in the <a href=\"/training-material/topics/single-cell/tutorials/scrna-case_basic-pipeline/tutorial.html\">previous tutorial</a>! Let’s see how it works:</p>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title> Modify AnnData object</hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/anndata_ops/anndata_ops/1.8.1+galaxy92\" title=\"AnnData Operations tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>AnnData Operations</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.8.1+galaxy92)</span></li>\n      <li>Make sure you are using version <strong>1.8.1+galaxy92</strong> of the tool (change by clicking on <i class=\"fas fa-cubes\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool-versions</span> Versions button)</li>\n      <li>Set the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> In <em>“Input object in hdf5 AnnData format”</em>: <code class=\"language-plaintext highlighter-rouge\">Converted EBI-compatible AnnData file</code></li>\n          <li>In <em>“Change field names in AnnData var”</em>:\n            <ul>\n              <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Change field names in AnnData var”</em>\n                <ul>\n                  <li><em>“Original name”</em>: <code class=\"language-plaintext highlighter-rouge\">name</code></li>\n                  <li><em>“New name”</em>: <code class=\"language-plaintext highlighter-rouge\">Symbol</code></li>\n                </ul>\n              </li>\n            </ul>\n          </li>\n          <li><em>“Gene symbols field in AnnData”</em>: <code class=\"language-plaintext highlighter-rouge\">Symbol</code></li>\n          <li>In <em>“Flag genes that start with these names”</em>:\n            <ul>\n              <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Flag genes that start with these names”</em>\n                <ul>\n                  <li><em>“Starts with”</em>: <code class=\"language-plaintext highlighter-rouge\">mt-</code></li>\n                  <li><em>“Var name”</em>: <code class=\"language-plaintext highlighter-rouge\">mito</code></li>\n                </ul>\n              </li>\n            </ul>\n          </li>\n        </ul>\n      </li>\n      <li>Rename <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> output <code class=\"language-plaintext highlighter-rouge\">AnnData for Filter, Plot, Explore workflow</code></li>\n    </ol>\n\n  </blockquote>\n\n  <p>The object is ready to start its journey through the <a href=\"https://singlecell.usegalaxy.eu/u/j.jakiela/w/copy-of-filter-plot-and-explore-single-cell-rna-seq-data-imported-from-uploaded-file-3\">Filter, Plot, Explore workflow</a>. All thanks to one conversion tool - how awesome that is!</p>\n\n</div>\n\n<h1 id=\"anndata---seurat\">AnnData -&gt; Seurat</h1>\n\n<p>Let’s get an <strong>AnnData object</strong> that we can further work on. It’s the object used in <a href=\"/training-material/topics/single-cell/tutorials/scrna-case_basic-pipeline/tutorial.html\">many tutorials</a>, so check it out if you’re curious.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Get toy data</hands-on-title>\n\n  <ol>\n    <li>Create a new history for this tutorial</li>\n    <li>\n      <p>Import the AnnData object from <a href=\"https://zenodo.org/record/4574153\">Zenodo</a></p>\n\n      <p>If you do this tutorial just for learning purposes, you can download the downsampled dataset which will be much quicker to process:</p>\n\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/10391629/files/Downsampled_annotated_AnnData.h5ad\n</code></pre></div>      </div>\n\n      <p>If you want to use the full dataset used in the other single-cell case study tutorials, here it is! Please note, it will take much longer to process it, so we will only show the conversions on the downsampled objects.</p>\n\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/7053673/files/Mito-counted_AnnData\n</code></pre></div>      </div>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-via-links-1\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-via-links-1\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing via links</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the datasets <code class=\"language-plaintext highlighter-rouge\">Downsampled AnnData object</code></li>\n    <li>\n      <p>Check that the datatype is <code class=\"language-plaintext highlighter-rouge\">h5ad</code></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-changing-the-datatype-2\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-changing-the-datatype-2\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Changing the datatype</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, click <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Datatypes</strong> tab on the top</li>   <li>In the <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Assign Datatype</strong>, select <code class=\"language-plaintext highlighter-rouge\">h5ad</code> from “<em>New type</em>” dropdown     <ul>       <li>Tip: you can start typing the datatype into the field to filter the dropdown menu</li>     </ul>   </li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"notranslate hands_on gtn-cyoa\" id=\"gtn-cyoaanndata2seurat\">\n\t<div class=\"box-title\" aria-label=\"hands-on box: choose your own tutorial\"><i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\"></span> Hands-on: Choose Your Own Tutorial</div>\n\t<p>This is a \"Choose Your Own Tutorial\" section, where you can select between multiple paths. Click one of the buttons below to select how you want to follow the tutorial</p>\n\t\n\t<p>\n\t\tChoose below if you just want to convert your object quickly or see how it all happens behind the scenes!\n\t</p>\n\t\n\t\n\t\t<input id=\"cyoa-opt1anndata2seurat\" type=\"radio\" name=\"cyoaanndata2seurat\" value=\"Quick-one-step-method\" onclick=\"cyoaChoice('Quick-one-step-method', 'gtn-cyoaanndata2seurat')\" />\n\t\t<label for=\"cyoa-opt1anndata2seurat\" class=\"select btn btn-secondary\">Quick one step method</label>\n\t\n\t\n\t\t<input id=\"cyoa-opt2anndata2seurat\" type=\"radio\" name=\"cyoaanndata2seurat\" value=\"Manual-conversion\" onclick=\"cyoaChoice('Manual-conversion', 'gtn-cyoaanndata2seurat')\" />\n\t\t<label for=\"cyoa-opt2anndata2seurat\" class=\"select btn btn-secondary\">Manual conversion</label>\n\t\n\t\n\t\n\n\t\n\t<script>\n\t\tfunction ready(fn) {\n\t\t\tif (document.readyState != 'loading'){\n\t\t\t\tfn();\n\t\t\t} else {\n\t\t\t\tdocument.addEventListener('DOMContentLoaded', fn);\n\t\t\t}\n\t\t}\n\t\tready(function() {\n\t\t\tcyoaDefault(\"Quick-one-step-method\", \"gtn-cyoaanndata2seurat\");\n\t\t})\n\t</script>\n\t\n</blockquote>\n\n<div class=\"Quick-one-step-method\">\n\n  <h2 id=\"quick-one-step-method\">Quick one step method</h2>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title> SCEasy Converter </hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/sceasy_convert/sceasy_convert/0.0.7+galaxy2\" title=\"SCEasy Converter tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>SCEasy Converter</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.0.7+galaxy2)</span> with the following parameters:\n        <ul>\n          <li><em>“Convert From / To”</em>: <code class=\"language-plaintext highlighter-rouge\">AnnData to Seurat</code></li>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in h5ad,h5 format”</em>: <code class=\"language-plaintext highlighter-rouge\">Downsampled AnnData object</code></li>\n        </ul>\n      </li>\n      <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the output: <code class=\"language-plaintext highlighter-rouge\">Seurat object</code></li>\n    </ol>\n\n  </blockquote>\n\n</div>\n\n<div class=\"Manual-conversion\">\n\n  <h2 id=\"manual-conversion\">Manual conversion</h2>\n\n  <p>Most of our manual conversions involve extracting tables from different data objects and importing them into the target object.\nFirst, we will extract observations (cell metadata) and the full matrix from our AnnData.</p>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title> Inspect AnnData </hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.10.3+galaxy0\" title=\"Inspect AnnData tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Inspect AnnData</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.10.3+galaxy0)</span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Downsampled AnnData object</code></li>\n          <li><em>“What to inspect?”</em>: <code class=\"language-plaintext highlighter-rouge\">Key-indexed observations annotation (obs)</code></li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the output <code class=\"language-plaintext highlighter-rouge\">Observations</code>.</p>\n      </li>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.10.3+galaxy0\" title=\"Inspect AnnData tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Inspect AnnData</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.10.3+galaxy0)</span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Downsampled AnnData object</code></li>\n          <li><em>“What to inspect?”</em>: <code class=\"language-plaintext highlighter-rouge\">The full data matrix</code></li>\n        </ul>\n      </li>\n      <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the output <code class=\"language-plaintext highlighter-rouge\">Matrix</code>.</li>\n    </ol>\n\n  </blockquote>\n\n  <blockquote class=\"question\">\n    <question-title></question-title>\n\n    <p>What are the rows, and what are the columns in the retrieved Matrix?</p>\n\n    <blockquote class=\"solution\">\n      <solution-title></solution-title>\n\n      <p>If you just click on the <code class=\"language-plaintext highlighter-rouge\">Matrix</code> dataset, you will see a preview showing barcodes in the first column, and genes in the first row.</p>\n\n    </blockquote>\n\n  </blockquote>\n\n  <p>However, the next tool we need expects a matrix wherein the genes are listed in the first column and the barcodes are listed in the first row. Therefore, we need to transpose the current matrix.</p>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title> Transpose the matrix </hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/datamash_transpose/datamash_transpose/1.8+galaxy0\" title=\"Transpose tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Transpose</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.8+galaxy0)</span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input tabular dataset”</em>: <code class=\"language-plaintext highlighter-rouge\">Matrix</code></li>\n        </ul>\n      </li>\n    </ol>\n\n  </blockquote>\n\n  <p>And now we are ready to input that data into <strong>DropletUtils</strong> tool, which will separate this matrix into the cells, genes, and matrix tabular files needed to build a Seurat object.</p>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title> DropletUtils </hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/dropletutils/dropletutils/1.10.0+galaxy2\" title=\"DropletUtils tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>DropletUtils</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.10.0+galaxy2)</span> with the following parameters:\n        <ul>\n          <li><em>“Format for the input matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Tabular</code></li>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Count Data”</em>: output of <strong>Transpose</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n          <li><em>“Operation”</em>: <code class=\"language-plaintext highlighter-rouge\">Filter for Barcodes</code>\n            <ul>\n              <li><em>“Method”</em>: <code class=\"language-plaintext highlighter-rouge\">DefaultDrops</code>\n                <ul>\n                  <li><em>“Expected Number of Cells”</em>: <code class=\"language-plaintext highlighter-rouge\">338</code></li>\n                  <li><em>“Upper Quantile”</em>: <code class=\"language-plaintext highlighter-rouge\">1.0</code></li>\n                  <li><em>“Lower Proportion”</em>: <code class=\"language-plaintext highlighter-rouge\">0.0</code></li>\n                </ul>\n              </li>\n              <li><em>“Format for output matrices”</em>: <code class=\"language-plaintext highlighter-rouge\">Bundled (barcodes.tsv, genes.tsv, matrix.mtx)</code></li>\n              <li><em>“Random Seed”</em>: <code class=\"language-plaintext highlighter-rouge\">100</code></li>\n            </ul>\n          </li>\n        </ul>\n      </li>\n    </ol>\n\n  </blockquote>\n\n  <p>Finally, let’s combine those files that we have just generated and turn them into the Seurat object!</p>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title> Create Seurat object </hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/seurat_read10x/seurat_read10x/3.2.3+galaxy0\" title=\"Seurat Read10x tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Seurat Read10x</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 3.2.3+galaxy0)</span> with the following parameters:\n        <ul>\n          <li><em>“Choose the format of the input”</em>: <code class=\"language-plaintext highlighter-rouge\">10X-type MTX</code></li>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Expression matrix in sparse matrix format (.mtx)”</em>: <code class=\"language-plaintext highlighter-rouge\">DropletUtils 10X Matrices</code></li>\n          <li><em>“Gene table”</em>: <code class=\"language-plaintext highlighter-rouge\">DropletUtils 10X Genes</code></li>\n          <li><em>“Barcode/cell table”</em>: <code class=\"language-plaintext highlighter-rouge\">DropletUtils 10X Barcodes</code></li>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Cell Metadata”</em>: <code class=\"language-plaintext highlighter-rouge\">Observations</code></li>\n          <li><em>“Choose the format of the output”</em>: <code class=\"language-plaintext highlighter-rouge\">RDS with a Seurat object</code></li>\n        </ul>\n      </li>\n      <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the output <code class=\"language-plaintext highlighter-rouge\">Converted Seurat object</code>.</li>\n    </ol>\n\n  </blockquote>\n\n  <p>As usual, you can check the <a href=\"https://usegalaxy.eu/u/j.jakiela/h/anndata-to-seurat-conversion\">example history</a> and the dedicated <a href=\"https://usegalaxy.eu/u/j.jakiela/w/anndata---seurat-conversion\">workflow</a>.</p>\n\n</div>\n\n<h1 id=\"anndata---singlecellexperiment-sce\">AnnData -&gt; SingleCellExperiment (SCE)</h1>\n<p>We will work on the same AnnData object so if you create a new history for this exercise, you can either get this file from Zenodo again or just copy this dataset from the previous history.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Get toy data</hands-on-title>\n\n  <ol>\n    <li>Create a new history for this section</li>\n    <li>\n      <p>Import the files from <a href=\"https://zenodo.org/record/10391629\">Zenodo</a></p>\n\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/10391629/files/Downsampled_annotated_AnnData.h5ad\n</code></pre></div>      </div>\n    </li>\n  </ol>\n\n</blockquote>\n\n<!--SNIPPET-->\n<blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-copy-a-dataset-between-histories\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-copy-a-dataset-between-histories\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Copy a dataset between histories</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>There 3 ways to copy datasets between histories</p>   <ol>   <li>     <p>From the original history</p>     <ol>       <li>Click on the <i class=\"fas fa-cog\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-gear</span> icon which is on the top of the list of datasets in the history panel</li>       <li>Click on <strong>Copy Datasets</strong></li>       <li>         <p>Select the desired files</p>       </li>       <li>         <p>Give a relevant name to the “New history”</p>       </li>       <li>Validate by ‘Copy History Items’</li>       <li>Click on the new history name in the green box that have just appear to switch to this history</li>     </ol>   </li>   <li>     <p>Using the <i class=\"fas fa-columns\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-columns</span> <strong>Show Histories Side-by-Side</strong></p>     <ol>       <li>Click on the <i class=\"fas fa-caret-down\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-dropdown</span> dropdown arrow top right of the history panel (<strong>History options</strong>)</li>       <li>Click on <i class=\"fas fa-columns\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-columns</span> <strong>Show Histories Side-by-Side</strong></li>       <li>If your target history is not present         <ol>           <li>Click on ‘Select histories’</li>           <li>Click on your target history</li>           <li>Validate by ‘Change Selected’</li>         </ol>       </li>       <li>Drag the dataset to copy from its original history</li>       <li>Drop it in the target history</li>     </ol>   </li>   <li>     <p>From the target history</p>     <ol>       <li>Click on <strong>User</strong> in the top bar</li>       <li>Click on <strong>Datasets</strong></li>       <li>Search for the dataset to copy</li>       <li>Click on its name</li>       <li>Click on <strong>Copy to current History</strong></li>     </ol>   </li> </ol> </blockquote>\n<p><!--END_SNIPPET--></p>\n\n<blockquote class=\"notranslate hands_on gtn-cyoa\" id=\"gtn-cyoaanndata2sce\">\n\t<div class=\"box-title\" aria-label=\"hands-on box: choose your own tutorial\"><i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\"></span> Hands-on: Choose Your Own Tutorial</div>\n\t<p>This is a \"Choose Your Own Tutorial\" section, where you can select between multiple paths. Click one of the buttons below to select how you want to follow the tutorial</p>\n\t\n\t<p>\n\t\tChoose below if you just want to convert your object quickly or see how it all happens behind the scenes!\n\t</p>\n\t\n\t\n\t\t<input id=\"cyoa-opt1anndata2sce\" type=\"radio\" name=\"cyoaanndata2sce\" value=\"Quick-single-tool-method\" onclick=\"cyoaChoice('Quick-single-tool-method', 'gtn-cyoaanndata2sce')\" />\n\t\t<label for=\"cyoa-opt1anndata2sce\" class=\"select btn btn-secondary\">Quick single tool method</label>\n\t\n\t\n\t\t<input id=\"cyoa-opt2anndata2sce\" type=\"radio\" name=\"cyoaanndata2sce\" value=\"Convert-manually\" onclick=\"cyoaChoice('Convert-manually', 'gtn-cyoaanndata2sce')\" />\n\t\t<label for=\"cyoa-opt2anndata2sce\" class=\"select btn btn-secondary\">Convert manually</label>\n\t\n\t\n\t\n\n\t\n\t<script>\n\t\tfunction ready(fn) {\n\t\t\tif (document.readyState != 'loading'){\n\t\t\t\tfn();\n\t\t\t} else {\n\t\t\t\tdocument.addEventListener('DOMContentLoaded', fn);\n\t\t\t}\n\t\t}\n\t\tready(function() {\n\t\t\tcyoaDefault(\"Quick-single-tool-method\", \"gtn-cyoaanndata2sce\");\n\t\t})\n\t</script>\n\t\n</blockquote>\n\n<div class=\"Quick-single-tool-method\">\n\n  <h2 id=\"quick-single-tool-method\">Quick single tool method</h2>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title> SCEasy Converter </hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/sceasy_convert/sceasy_convert/0.0.7+galaxy2\" title=\"SCEasy Converter tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>SCEasy Converter</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.0.7+galaxy2)</span> with the following parameters:\n        <ul>\n          <li><em>“Convert From / To”</em>: <code class=\"language-plaintext highlighter-rouge\">AnnData to Seurat</code></li>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in h5ad,h5 format”</em>: <code class=\"language-plaintext highlighter-rouge\">Downsampled AnnData object</code></li>\n        </ul>\n      </li>\n      <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the output: <code class=\"language-plaintext highlighter-rouge\">Seurat object</code></li>\n      <li>We will use SCEasy again! <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/sceasy_convert/sceasy_convert/0.0.7+galaxy2\" title=\"SCEasy Converter tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>SCEasy Converter</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.0.7+galaxy2)</span> with the following parameters:\n        <ul>\n          <li><em>“Convert From / To”</em>: <code class=\"language-plaintext highlighter-rouge\">Seurat to SingleCellexperiment</code></li>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in rds,rdata format”</em>: <code class=\"language-plaintext highlighter-rouge\">Seurat object</code></li>\n        </ul>\n      </li>\n      <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the output: <code class=\"language-plaintext highlighter-rouge\">SCE object</code></li>\n    </ol>\n\n  </blockquote>\n\n</div>\n\n<div class=\"Convert-manually\">\n\n  <h2 id=\"convert-manually\">Convert manually</h2>\n\n  <p>First, we will extract observations and the full matrix from our AnnData.</p>\n\n  <blockquote class=\"tip\">\n    <tip-title>Skip some steps!</tip-title>\n\n    <p>If you are following this entire tutorial (rather than using a specific section necessary!), you can stay in the your previous history and just reuse outputs to build different single cell objects!</p>\n  </blockquote>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title> Inspect AnnData </hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.10.3+galaxy0\" title=\"Inspect AnnData tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Inspect AnnData</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.10.3+galaxy0)</span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Downsampled AnnData object</code></li>\n          <li><em>“What to inspect?”</em>: <code class=\"language-plaintext highlighter-rouge\">Key-indexed observations annotation (obs)</code></li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the output <code class=\"language-plaintext highlighter-rouge\">Observations</code>.</p>\n      </li>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.10.3+galaxy0\" title=\"Inspect AnnData tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Inspect AnnData</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.10.3+galaxy0)</span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Downsampled AnnData object</code></li>\n          <li><em>“What to inspect?”</em>: <code class=\"language-plaintext highlighter-rouge\">The full data matrix</code></li>\n        </ul>\n      </li>\n      <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the output <code class=\"language-plaintext highlighter-rouge\">Matrix</code>.</li>\n    </ol>\n\n  </blockquote>\n\n  <blockquote class=\"question\">\n    <question-title></question-title>\n\n    <p>What are the rows, and what are the columns in the retrieved Matrix?</p>\n\n    <blockquote class=\"solution\">\n      <solution-title></solution-title>\n\n      <p>If you just click on the <code class=\"language-plaintext highlighter-rouge\">Matrix</code> dataset, you will see a preview, showing barcodes in the first column, while genes are in the first row.</p>\n\n    </blockquote>\n\n  </blockquote>\n\n  <p>However, the next tool we need expects a matrix wherein the genes are listed in the first column and the barcodes are listed in the first row. Therefore, we need to transpose the current matrix.</p>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title> Transpose the matrix </hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/datamash_transpose/datamash_transpose/1.8+galaxy0\" title=\"Transpose tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Transpose</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.8+galaxy0)</span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input tabular dataset”</em>: <code class=\"language-plaintext highlighter-rouge\">Matrix</code></li>\n        </ul>\n      </li>\n    </ol>\n\n  </blockquote>\n\n  <p>And now we are ready to input that data to <strong>DropletUtils</strong> tool.</p>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title> DropletUtils </hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/dropletutils/dropletutils/1.10.0+galaxy2\" title=\"DropletUtils tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>DropletUtils</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.10.0+galaxy2)</span> with the following parameters:\n        <ul>\n          <li><em>“Format for the input matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Tabular</code></li>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Count Data”</em>: output of <strong>Transpose</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n          <li><em>“Operation”</em>: <code class=\"language-plaintext highlighter-rouge\">Filter for Barcodes</code>\n            <ul>\n              <li><em>“Method”</em>: <code class=\"language-plaintext highlighter-rouge\">DefaultDrops</code>\n                <ul>\n                  <li><em>“Expected Number of Cells”</em>: <code class=\"language-plaintext highlighter-rouge\">338</code></li>\n                  <li><em>“Upper Quantile”</em>: <code class=\"language-plaintext highlighter-rouge\">1.0</code></li>\n                  <li><em>“Lower Proportion”</em>: <code class=\"language-plaintext highlighter-rouge\">0.0</code></li>\n                </ul>\n              </li>\n              <li><em>“Format for output matrices”</em>: <code class=\"language-plaintext highlighter-rouge\">Bundled (barcodes.tsv, genes.tsv, matrix.mtx)</code></li>\n              <li><em>“Random Seed”</em>: <code class=\"language-plaintext highlighter-rouge\">100</code></li>\n            </ul>\n          </li>\n        </ul>\n      </li>\n    </ol>\n\n  </blockquote>\n\n  <p>Finally, let’s combine those files that we have just generated and turn them into the SingleCellExperiment!</p>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title> Create SCE object </hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/dropletutils_read_10x/dropletutils_read_10x/1.0.4+galaxy0\" title=\"DropletUtils Read10x tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>DropletUtils Read10x</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.0.4+galaxy0)</span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Expression matrix in sparse matrix format (.mtx)”</em>: <code class=\"language-plaintext highlighter-rouge\">DropletUtils 10X Matrices</code></li>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Gene table”</em>: <code class=\"language-plaintext highlighter-rouge\">DropletUtils 10X Genes</code></li>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Barcode/cell table”</em>: <code class=\"language-plaintext highlighter-rouge\">DropletUtils 10X Barcodes</code></li>\n          <li><em>“Should metadata file be added?”</em>: <i class=\"fas fa-toggle-on\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-toggle</span> <code class=\"language-plaintext highlighter-rouge\">Yes</code>\n            <ul>\n              <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Metadata file”</em>: <code class=\"language-plaintext highlighter-rouge\">Observations</code></li>\n              <li><em>“Cell ID column”</em>: <code class=\"language-plaintext highlighter-rouge\">index</code></li>\n            </ul>\n          </li>\n        </ul>\n      </li>\n      <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the output <code class=\"language-plaintext highlighter-rouge\">Converted SCE object</code>.</li>\n    </ol>\n\n  </blockquote>\n\n  <p>As usual, you can check the <a href=\"https://usegalaxy.eu/u/j.jakiela/h/anndata-to-singlecellexperiment-sce-conversion\">example history</a> and the dedicated <a href=\"https://usegalaxy.eu/u/j.jakiela/w/anndata-to-singlecellexperiment-sce-conversion\">workflow</a>.</p>\n\n</div>\n\n<h1 id=\"anndata---cell-data-set-cds\">Anndata -&gt; Cell Data Set (CDS)</h1>\n<p>Cell Data Set (CDS) format is usually used when working with a package called Monocle3 (<span class=\"citation\"><a href=\"#monocle3\">cole-trapnell-lab</a></span>). Below we show two methods on how to transform AnnData to CDS object, one of which creates an input file for <a href=\"/training-material/topics/single-cell/tutorials/scrna-case_monocle3-trajectories/tutorial.html\">Monocle 3 tutorial</a>.</p>\n\n<blockquote class=\"notranslate hands_on gtn-cyoa\" id=\"gtn-cyoaanndata2cds\">\n\t<div class=\"box-title\" aria-label=\"hands-on box: choose your own tutorial\"><i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\"></span> Hands-on: Choose Your Own Tutorial</div>\n\t<p>This is a \"Choose Your Own Tutorial\" section, where you can select between multiple paths. Click one of the buttons below to select how you want to follow the tutorial</p>\n\t\n\t<p>\n\t\tYou can choose whether you want just to transform AnnData to CDS or to create CDS input file for Monocle3 tutorial to proceed with the downstream analysis described in that tutorial. Please note that depending on your dataset, you might need to refer to the first method which uses both annotated and unprocessed matrices. If you did some pre-processing on your AnnData object, then you might need to choose the first method anyway since Monocle3 performs its own pre-processing, so we would also need an unprocessed expression matrix alongside annotated (pre-processed) AnnData. That method is more expanded and specific, while the general one just shows the main principle of the conversion.\n\t</p>\n\t\n\t\n\t\t<input id=\"cyoa-opt1anndata2cds\" type=\"radio\" name=\"cyoaanndata2cds\" value=\"Create-CDS-input-for-Monocle3-tutorial\" onclick=\"cyoaChoice('Create-CDS-input-for-Monocle3-tutorial', 'gtn-cyoaanndata2cds')\" />\n\t\t<label for=\"cyoa-opt1anndata2cds\" class=\"select btn btn-secondary\">Create CDS input for Monocle3 tutorial</label>\n\t\n\t\n\t\t<input id=\"cyoa-opt2anndata2cds\" type=\"radio\" name=\"cyoaanndata2cds\" value=\"General-AnnData-to-CDS-conversion\" onclick=\"cyoaChoice('General-AnnData-to-CDS-conversion', 'gtn-cyoaanndata2cds')\" />\n\t\t<label for=\"cyoa-opt2anndata2cds\" class=\"select btn btn-secondary\">General AnnData to CDS conversion</label>\n\t\n\t\n\t\n\n\t\n\t<script>\n\t\tfunction ready(fn) {\n\t\t\tif (document.readyState != 'loading'){\n\t\t\t\tfn();\n\t\t\t} else {\n\t\t\t\tdocument.addEventListener('DOMContentLoaded', fn);\n\t\t\t}\n\t\t}\n\t\tready(function() {\n\t\t\tcyoaDefault(\"General-AnnData-to-CDS-conversion\", \"gtn-cyoaanndata2cds\");\n\t\t})\n\t</script>\n\t\n</blockquote>\n\n<div class=\"Create-CDS-input-for-Monocle3-tutorial\">\n\n  <h2 id=\"cds-input-for-monocle3-tutorial-use-for-pre-processed-data\">CDS input for Monocle3 tutorial (use for pre-processed data)</h2>\n  <p>The <a href=\"/training-material/topics/single-cell/tutorials/scrna-case_monocle3-trajectories/tutorial.html\">dedicated tutorial</a> shows how to perform trajectory analysis using Monocle3 which is the next step in the single-cell case study tutorial series, right after <a href=\"/training-material/topics/single-cell/tutorials/scrna-case_alevin-combine-datasets/tutorial.html\">pre-processing tutorial</a> and <a href=\"/training-material/topics/single-cell/tutorials/scrna-case_basic-pipeline/tutorial.html\">analysing the metadata</a>. To keep the continuity of the series, we will continue to work on the case study data from a mouse model of fetal growth restriction <span class=\"citation\"><a href=\"#Bacon2018\">Bacon <i>et al.</i> 2018</a></span> (see <a href=\"https://www.ebi.ac.uk/gxa/sc/experiments/E-MTAB-6945/results/tsne\">the study in Single Cell Expression Atlas</a> and <a href=\"https://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-6945/\">the project submission</a>). After successfully completing this section with the mentioned dataset, you can use it directly in the <a href=\"https://humancellatlas.usegalaxy.eu/u/j.jakiela/w/copy-of-trajectory-analysis-using-monocle3-1\">Monocle3 tutorial workflow</a>.\nIf you work on your own data, you might also need to follow this method since it shows how to deal with already pre-processed datasets. Since Monocle3 performs its own pre-processing, you will need both annotated and unprocessed matrices.</p>\n\n  <h2 id=\"get-data\">Get data</h2>\n  <p>Monocle3 works great with annotated data, so we will make use of our annotated AnnData object, generated in the <a href=\"/training-material/topics/single-cell/tutorials/scrna-case_basic-pipeline/tutorial.html\">previous tutorial</a>. We will also need a ‘clean’ expression matrix, extracted from the AnnData object just before we started the processing.\nYou have two options for uploading these datasets. Importing via history is often faster.</p>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title>Option 1: Data upload - Import history</hands-on-title>\n\n    <ol>\n      <li>\n        <p>Import history from: <a href=\"https://humancellatlas.usegalaxy.eu/u/j.jakiela/h/monocle3-input-files\">input history</a></p>\n\n        <!--SNIPPET-->\n        <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-a-history-1\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-a-history-1\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing a history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ol>   <li>Open the link to the shared history</li>   <li>Click on the <i class=\"fas fa-plus\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">new-history</span> <em>Import history</em> button on the top right</li>   <li>Enter a title for the new history</li>   <li>Click on <strong>Import</strong></li> </ol> </blockquote>\n        <p><!--END_SNIPPET--></p>\n      </li>\n      <li>\n        <p><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the history to your name of choice.</p>\n      </li>\n    </ol>\n\n  </blockquote>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title>Option 2: Data upload - Add to history</hands-on-title>\n\n    <ol>\n      <li>Create a new history for this tutorial</li>\n      <li>\n        <p>Import the AnnData object from <a href=\"https://zenodo.org/records/7078524\">Zenodo</a></p>\n\n        <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/records/7078524/files/AnnData_before_processing.h5ad\nhttps://zenodo.org/records/7078524/files/Annotated_AnnData.h5ad\n</code></pre></div>        </div>\n      </li>\n      <li>\n        <p>Check that the datatype is <code class=\"language-plaintext highlighter-rouge\">h5ad</code></p>\n\n        <!--SNIPPET-->\n        <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-changing-the-datatype-3\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-changing-the-datatype-3\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Changing the datatype</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, click <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Datatypes</strong> tab on the top</li>   <li>In the <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Assign Datatype</strong>, select <code class=\"language-plaintext highlighter-rouge\">h5ad</code> from “<em>New type</em>” dropdown     <ul>       <li>Tip: you can start typing the datatype into the field to filter the dropdown menu</li>     </ul>   </li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n        <p><!--END_SNIPPET--></p>\n      </li>\n    </ol>\n\n  </blockquote>\n\n  <h2 id=\"extracting-annotations\">Extracting annotations</h2>\n  <p>To run Monocle, we need cell metadata, gene metadata, and an expression matrix file of genes by cells. (In theory, the expression matrix alone could do, but then we wouldn’t have all those useful annotations that we worked on so hard in the previous tutorials!). In order to get these files, we will extract the gene and cell annotations from our AnnData object.</p>\n\n  <blockquote class=\"question\">\n    <question-title></question-title>\n\n    <p>How many lines do you expect to be in the gene and cell metadata files?</p>\n\n    <blockquote class=\"solution\">\n      <solution-title></solution-title>\n\n      <p>If you click on the step with uploaded annotated AnnData file, you will see on a small preview that this object has 8605 observations and 15395 variables, so we expect to get a cell metadata file with 8605 lines and gene metadata file with 15395 lines (without headers of course!).</p>\n\n    </blockquote>\n\n  </blockquote>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title>Extracting annotations</hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.10.3+galaxy0\" title=\"Inspect AnnData tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Inspect AnnData</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.10.3+galaxy0)</span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Annotated_AnnData</code></li>\n          <li><em>“What to inspect?”</em>: <code class=\"language-plaintext highlighter-rouge\">Key-indexed observations annotation (obs)</code></li>\n        </ul>\n      </li>\n      <li>\n        <p>Rename <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the observations annotation <code class=\"language-plaintext highlighter-rouge\">Extracted cell annotations (obs)</code></p>\n      </li>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.10.3+galaxy0\" title=\"Inspect AnnData tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Inspect AnnData</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.10.3+galaxy0)</span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Annotated_AnnData</code></li>\n          <li><em>“What to inspect?”</em>: <code class=\"language-plaintext highlighter-rouge\">Key-indexed annotation of variables/features (var)</code></li>\n        </ul>\n      </li>\n      <li>Rename <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the annotation of variables <code class=\"language-plaintext highlighter-rouge\">Extracted gene annotations (var)</code></li>\n    </ol>\n\n  </blockquote>\n\n  <p>Quick and easy, isn’t it? However, we need to make some minor changes before we can input these files into the Monocle toolsuite.</p>\n\n  <h2 id=\"cell-metadata\">Cell metadata</h2>\n  <p>Our current dataset is not just T-cells: as you might remember from the last tutorial, we identified a cluster of macrophages as well. This might be a problem, because the trajectory algorithm will try to find relationships between all the cells (even if they are not necessarily related!), rather than only the T-cells that we are interested in. We need to remove those unwanted cell types to make the analysis more accurate.</p>\n\n  <p>The <strong>Manipulate AnnData</strong> tool allows you to filter observations or variables, and that would be the most obvious way to remove those cells. However, given that we don’t need an AnnData object, it’s a lot quicker to edit a table rather than manipulate an AnnData object. Ultimately, we need cell metadata, gene metadata and expression matrix files that have macrophages removed, and that have the correct metadata that Monocle looks for. With some table manipulation, we’ll end up with three separate files, ready to be passed onto Monocle3.</p>\n\n  <blockquote class=\"question\">\n    <question-title></question-title>\n\n    <p>Where is the information about cell types stored?</p>\n\n    <blockquote class=\"solution\">\n      <solution-title></solution-title>\n\n      <p>We have already extracted the cell annotations file - in one of the columns you can find the information about cell type, assigned to each cell.</p>\n      <figure id=\"figure-1\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy-monocle/example_cell_annotations.png\" alt=\"Cell annotations along the top, n_genes, n_counts, louvain, cell_type with a cell barcode and subsequent metadata as each row. \" width=\"452\" height=\"209\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy-monocle/example_cell_annotations.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 1</strong>:</span> Example cell annotations</figcaption></figure>\n\n    </blockquote>\n\n  </blockquote>\n\n  <p>Click on <code class=\"language-plaintext highlighter-rouge\">Extracted cell annotations (obs)</code> file to see a small preview window. This shows you that the column containing the cell types has number 22.  We’ll need that to filter out unwanted cell types!</p>\n\n  <blockquote class=\"warning\">\n    <warning-title>Check the column number!</warning-title>\n    <p>If you are working on a different dataset, the number of the ‘cell_type’ column might be different, so make sure you check it on a preview and use the correct number!</p>\n  </blockquote>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title>Filter out macrophages</hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"Filter1\" title=\"Filter tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Filter</strong></span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Filter”</em>: <code class=\"language-plaintext highlighter-rouge\">Extracted cell annotations (obs)</code></li>\n          <li><em>“With following condition”</em>: <code class=\"language-plaintext highlighter-rouge\">c22!='Macrophages'</code></li>\n          <li><em>“Number of header lines to skip”</em>: <code class=\"language-plaintext highlighter-rouge\">1</code></li>\n          <li>That’s it - our cell annotation file is ready for Monocle! Let’s rename it accordingly.</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the output: <code class=\"language-plaintext highlighter-rouge\">Cells input data for Monocle3</code></p>\n\n        <blockquote class=\"details\">\n          <details-title>Parameters</details-title>\n\n          <ul>\n            <li><code class=\"language-plaintext highlighter-rouge\">c22</code> means column no. 22 - that’s the column with cell types, and it will be filtered for the macrophages</li>\n            <li><code class=\"language-plaintext highlighter-rouge\">!=</code> means ‘not equal to’ - we want to keep the cell types which ARE NOT macrophages</li>\n          </ul>\n        </blockquote>\n\n        <blockquote class=\"tip\">\n          <tip-title>Other unwanted cell types</tip-title>\n\n          <p>It might happen that during clustering you’ll find another cell type that you want to get rid of for the trajectory analysis. Then simply re-run this tool on already filtered file and change ‘Macrophages’ to another unwanted cell type.</p>\n        </blockquote>\n      </li>\n    </ol>\n  </blockquote>\n\n  <h2 id=\"gene-annotations\">Gene annotations</h2>\n  <p>Sometimes certain functionalities require a specific indication of where the data should be taken from. Monocle3 tools expect that the genes column is named ‘gene_short_name’. Let’s check what the name of that column is in our dataset currently.</p>\n\n  <blockquote class=\"question\">\n    <question-title></question-title>\n\n    <ol>\n      <li>Where can you check the header of a column containing genes names?</li>\n      <li>What is the name of this column?</li>\n    </ol>\n\n    <blockquote class=\"solution\">\n      <solution-title></solution-title>\n\n      <ol>\n        <li>Our extracted gene annotations file! Either by clicking on the eye icon <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">solution</span> or having a look at the small preview window.</li>\n        <li>In our dataset the gene names are stored in a column called ‘Symbol’ - we need to change that!</li>\n      </ol>\n      <figure id=\"figure-2\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy-monocle/window_in_history.png\" alt=\"The dataset in the history has a preview window showing the columns of the extracted gene annotation with each gene as a row and the metadata - index, ID, symbol - as the column names. \" width=\"259\" height=\"415\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy-monocle/window_in_history.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 2</strong>:</span> Preview window in the history</figcaption></figure>\n\n    </blockquote>\n\n  </blockquote>\n\n  <p>Let’s click on the <code class=\"language-plaintext highlighter-rouge\">Extracted gene annotations (var)</code> file to see a small preview. We can see that the gene names are in the third column with a header <code class=\"language-plaintext highlighter-rouge\">Symbol</code>. Keep that in mind - we’ll use that in a second!</p>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title>Changing the column name</hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/galaxyp/regex_find_replace/regexColumn1/1.0.2\" title=\"Column Regex Find And Replace tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Column Regex Find And Replace</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.0.2)</span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Select cells from”</em>: <code class=\"language-plaintext highlighter-rouge\">Extracted gene annotations (var)</code></li>\n          <li><em>“using column”</em>: <code class=\"language-plaintext highlighter-rouge\">c3</code> or <code class=\"language-plaintext highlighter-rouge\">Column: 3</code></li>\n          <li>In <em>“Check”</em>:\n            <ul>\n              <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Check”</em>\n                <ul>\n                  <li><em>“Find Regex”</em>: <code class=\"language-plaintext highlighter-rouge\">Symbol</code></li>\n                  <li><em>“Replacement”</em>: <code class=\"language-plaintext highlighter-rouge\">gene_short_name</code></li>\n                </ul>\n              </li>\n            </ul>\n          </li>\n        </ul>\n      </li>\n      <li>\n        <p>Check that the datatype is <code class=\"language-plaintext highlighter-rouge\">tabular</code></p>\n\n        <!--SNIPPET-->\n        <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-changing-the-datatype-4\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-changing-the-datatype-4\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Changing the datatype</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, click <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Datatypes</strong> tab on the top</li>   <li>In the <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Assign Datatype</strong>, select <code class=\"language-plaintext highlighter-rouge\">tabular</code> from “<em>New type</em>” dropdown     <ul>       <li>Tip: you can start typing the datatype into the field to filter the dropdown menu</li>     </ul>   </li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n        <p><!--END_SNIPPET--></p>\n        <ul>\n          <li>Voila! That’s the gene input for Monocle! Just a quick rename…</li>\n        </ul>\n      </li>\n      <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the output: <code class=\"language-plaintext highlighter-rouge\">Genes input data for Monocle3</code></li>\n    </ol>\n\n  </blockquote>\n\n  <h2 id=\"expression-matrix\">Expression matrix</h2>\n  <p>Last, but not least! And in fact, the most important! The expression matrix contains all the values representing the expression level of a particular gene in a cell. This is why in theory the expression matrix is the only input file required by Monocle3. Without annotation files the CDS data can still be generated - it will be quite bare and rather unhelpful for interpretation, but it’s possible to process.\nSo, the values in the expression matrix are just numbers. But do you remember that we have already done some processing such as normalisation and the calculation of principal components in the AnnData object in the previous tutorial? That affected our expression matrix. Preprocessing is one of the steps in the Monocle3 workflow, so we want to make sure that the calculations are done on a ‘clean’ expression matrix. If we apply too many operations on our raw data, it will be too ‘deformed’ to be reliable. The point of the analysis is to use algorithms that make the enormous amount of data understandable in order to draw meaningful conclusions in accordance with biology.\nSo how do we do that?</p>\n\n  <blockquote class=\"question\">\n    <question-title></question-title>\n\n    <ol>\n      <li>How many cells and genes are there in the <code class=\"language-plaintext highlighter-rouge\">Anndata_before_processing</code> file?</li>\n      <li>How many lines are there in <code class=\"language-plaintext highlighter-rouge\">Cells input data for Monocle3</code>?</li>\n      <li>How many lines are there in <code class=\"language-plaintext highlighter-rouge\">Genes input data for Monocle3</code>?</li>\n    </ol>\n\n    <blockquote class=\"solution\">\n      <solution-title></solution-title>\n      <p>You can answer all the questions just by clicking on the given file and looking at the preview window.</p>\n      <ol>\n        <li>[n_obs x n_vars] = 31178 x 35734, so there are 31178 cells and 35734 genes.</li>\n        <li>8570 lines, including a header, which makes 8569 cells.</li>\n        <li>15396 lines, including a header, which makes 15395 genes.</li>\n      </ol>\n\n    </blockquote>\n\n  </blockquote>\n\n  <p>As you can see, there are way more genes and cells in the unprocessed AnnData file, so the expression matrix is much bigger than we need it to be. If the genes and cells we prepared for Monocle3 are not the same as in the expression matrix, Monocle3 will crash. Therefore, we have to filter that big, clean matrix and adjust it to our already prepared genes and cells files. But first, let’s extract the matrix from the unprocessed AnnData object.</p>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title>Extracting matrix</hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.10.3+galaxy0\" title=\"Inspect AnnData tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Inspect AnnData</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.10.3+galaxy0)</span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">AnnData_before_processing</code></li>\n          <li><em>“What to inspect?”</em>: <code class=\"language-plaintext highlighter-rouge\">The full data matrix</code></li>\n        </ul>\n      </li>\n      <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the output: <code class=\"language-plaintext highlighter-rouge\">Unprocessed expression matrix</code></li>\n    </ol>\n\n  </blockquote>\n\n  <p>If you have a look at the preview of <code class=\"language-plaintext highlighter-rouge\">Unprocessed expression matrix</code>, you’ll see that the first column contains the cell barcodes, while the first row - the gene IDs. We would like to keep only the values corresponding to the cells and genes that are included in <code class=\"language-plaintext highlighter-rouge\">Cells input data for Monocle3</code> and <code class=\"language-plaintext highlighter-rouge\">Genes input data for Monocle3</code>. How do we do it? First, we compare the cell barcodes from <code class=\"language-plaintext highlighter-rouge\">Cells input data for Monocle3</code> to those in <code class=\"language-plaintext highlighter-rouge\">Unprocessed expression matrix</code> and ask Galaxy to keep the values of the matrix for which the barcodes in both files are the same. Then, we’ll do the same for gene IDs. We will cut the first columns from <code class=\"language-plaintext highlighter-rouge\">Cells input data for Monocle3</code> and <code class=\"language-plaintext highlighter-rouge\">Genes input data for Monocle3</code> to be able to compare those columns side by side with the matrix file.</p>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title>Cutting out the columns</hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"Cut1\" title=\"Cut tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Cut</strong></span> with the following parameters:\n        <ul>\n          <li><em>“Cut columns”</em>: <code class=\"language-plaintext highlighter-rouge\">c1</code></li>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“From”</em>: <code class=\"language-plaintext highlighter-rouge\">Cells input data for Monocle3</code></li>\n        </ul>\n      </li>\n      <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the output: <code class=\"language-plaintext highlighter-rouge\">Cells IDs</code></li>\n      <li><span class=\"tool\" data-tool=\"Cut1\" title=\"Cut tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Cut</strong></span> with the following parameters:\n        <ul>\n          <li><em>“Cut columns”</em>: <code class=\"language-plaintext highlighter-rouge\">c1</code></li>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“From”</em>: <code class=\"language-plaintext highlighter-rouge\">Genes input data for Monocle3</code></li>\n        </ul>\n      </li>\n      <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the output: <code class=\"language-plaintext highlighter-rouge\">Genes IDs</code></li>\n    </ol>\n\n  </blockquote>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title> Filter matrix values by cell barcodes</hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"join1\" title=\"Join two Datasets tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Join two Datasets</strong></span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Join”</em>: <code class=\"language-plaintext highlighter-rouge\">Cells IDs</code></li>\n          <li><em>“using column”</em>: <code class=\"language-plaintext highlighter-rouge\">c1</code>or <code class=\"language-plaintext highlighter-rouge\">Column: 1</code></li>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“with”</em>: <code class=\"language-plaintext highlighter-rouge\">Unprocessed expression matrix</code></li>\n          <li><em>“and column”</em>: <code class=\"language-plaintext highlighter-rouge\">c1</code>or <code class=\"language-plaintext highlighter-rouge\">Column: 1</code></li>\n          <li><em>“Keep lines of first input that do not join with second input”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n          <li><em>“Keep lines of first input that are incomplete”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n          <li><em>“Fill empty columns”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n          <li><em>“Keep the header lines”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        </ul>\n      </li>\n      <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the output: <code class=\"language-plaintext highlighter-rouge\">Pre-filtered matrix (by cells)</code></li>\n    </ol>\n\n  </blockquote>\n\n  <p>Look at the preview of the output file. First of all, you can see that there are 8570 lines (8569 cells) instead of 31178 cells that were present in the matrix. That’s exactly what we wanted to achieve - now we have raw information for the T-cells that we have filtered. However, the step that we have already performed left us with the matrix whose first and second columns are the same - let’s get rid of one of those!</p>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title>Remove duplicate column (cells IDs)</hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_cut_tool/1.1.0\" title=\"Advanced Cut tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Advanced Cut</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.1.0)</span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“File to cut”</em>: <code class=\"language-plaintext highlighter-rouge\">Pre-filtered matrix (by cells)</code></li>\n          <li><em>“Operation”</em>: <code class=\"language-plaintext highlighter-rouge\">Discard</code></li>\n          <li><em>“Cut by”</em>: <code class=\"language-plaintext highlighter-rouge\">fields</code>\n            <ul>\n              <li><em>“List of Fields”</em>: <code class=\"language-plaintext highlighter-rouge\">c1</code></li>\n            </ul>\n          </li>\n        </ul>\n      </li>\n      <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the output: <code class=\"language-plaintext highlighter-rouge\">Filtered matrix (by cells)</code></li>\n    </ol>\n\n  </blockquote>\n\n  <p>Now we will perform the same steps, but for gene IDs. But gene IDs are currently in the first row, so we need to transpose the matrix, and from there we can repeat the same steps as above for Gene IDs.</p>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title>Filter matrix by gene IDs</hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/datamash_transpose/datamash_transpose/1.1.0+galaxy2\" title=\"Transpose tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Transpose</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.1.0+galaxy2)</span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input tabular dataset”</em>: <code class=\"language-plaintext highlighter-rouge\">Filtered matrix (by cells)</code></li>\n          <li>The matrix is now ready to be filtered by gene IDs!</li>\n        </ul>\n      </li>\n      <li><span class=\"tool\" data-tool=\"join1\" title=\"Join two Datasets tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Join two Datasets</strong></span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Join”</em>: <code class=\"language-plaintext highlighter-rouge\">Genes IDs</code></li>\n          <li><em>“using column”</em>: <code class=\"language-plaintext highlighter-rouge\">c1</code> or <code class=\"language-plaintext highlighter-rouge\">Column: 1</code></li>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“with”</em>: output of <strong>Transpose</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n          <li><em>“and column”</em>: <code class=\"language-plaintext highlighter-rouge\">c1</code> or <code class=\"language-plaintext highlighter-rouge\">Column: 1</code></li>\n          <li><em>“Keep lines of first input that do not join with second input”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n          <li><em>“Keep lines of first input that are incomplete”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n          <li><em>“Fill empty columns”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n          <li><em>“Keep the header lines”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        </ul>\n      </li>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_cut_tool/1.1.0\" title=\"Advanced Cut tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Advanced Cut</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.1.0)</span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“File to cut”</em>: output of <strong>Join two Datasets</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n          <li><em>“Operation”</em>: <code class=\"language-plaintext highlighter-rouge\">Discard</code></li>\n          <li><em>“Cut by”</em>: <code class=\"language-plaintext highlighter-rouge\">fields</code>\n            <ul>\n              <li><em>“List of Fields”</em>: <code class=\"language-plaintext highlighter-rouge\">c1</code></li>\n            </ul>\n          </li>\n          <li>Monocle3 requires that in the matrix rows are genes, and columns are cells - that is what we’ve got, so there is no need to transpose matrix again. The expression matrix is ready! Let’s just rename it…</li>\n        </ul>\n      </li>\n      <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the output: <code class=\"language-plaintext highlighter-rouge\">Expression matrix for Monocle3</code></li>\n    </ol>\n\n  </blockquote>\n\n  <p><i class=\"far fa-thumbs-up\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">congratulations</span> Finally! We have prepared all the files to pass them onto the Monocle3 workflow!</p>\n\n  <h2 id=\"creating-cds-object\">Creating CDS object</h2>\n  <p>Monocle3 turns the expression matrix, cell and gene annotations into an object called cell_data_set (CDS), which holds single-cell expression data.</p>\n\n  <blockquote class=\"details\">\n    <details-title>Input files</details-title>\n\n    <p>Here is what <a href=\"https://cole-trapnell-lab.github.io/monocle3/docs/starting/\">Monocle3 documentation</a> says about the required three input files:</p>\n    <ul>\n      <li><strong>expression_matrix</strong>: a numeric matrix of expression values, where rows are genes, and columns are cells. Must have the same number of columns as the cell_metadata has rows and the same number of rows as the gene_metadata has rows.</li>\n      <li><strong>cell_metadata</strong>: a data frame, where rows are cells, and columns are cell attributes (such as cell type, culture condition, day captured, etc.)</li>\n      <li><strong>gene_metadata</strong>: a data frame, where rows are features (e.g. genes), and columns are gene attributes, such as biotype, gc content, etc. One of its columns should be named “gene_short_name”, which represents the gene symbol or simple name (generally used for plotting) for each gene.</li>\n    </ul>\n\n  </blockquote>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title>Create CDS object</hands-on-title>\n\n    <blockquote class=\"details\">\n      <details-title>Data format</details-title>\n\n      <p>You can provide expression matrix as TSV, CSV, MTX or RDS file, while genes and cells metadata as TSV, CSV or RDS files. In our case all three files are tabular, so we will set the format to TSV.</p>\n    </blockquote>\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/monocle3_create/monocle3_create/0.1.4+galaxy2\" title=\"Monocle3 create tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Monocle3 create</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.1.4+galaxy2)</span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Expression matrix, genes as rows, cells as columns. Required input. Provide as TSV, CSV or RDS.”</em>: <code class=\"language-plaintext highlighter-rouge\">Expression matrix for Monocle3</code></li>\n          <li><em>“Format of expression matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">TSV</code></li>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Per-cell annotation, optional. Row names must match the column names of the expression matrix. Provide as TSV, CSV or RDS.”</em>: <code class=\"language-plaintext highlighter-rouge\">Cells input data for Monocle3</code></li>\n          <li><em>“Format of cell metadata”</em>: <code class=\"language-plaintext highlighter-rouge\">TSV</code></li>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Per-gene annotation, optional. Row names must match the row names of the expression matrix. Provide as TSV, CSV or RDS.”</em>: <code class=\"language-plaintext highlighter-rouge\">Genes input data for Monocle3</code></li>\n          <li><em>“Format of gene annotation”</em>: <code class=\"language-plaintext highlighter-rouge\">TSV</code></li>\n        </ul>\n      </li>\n      <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the output: <code class=\"language-plaintext highlighter-rouge\">CDS input for Monocle3 tutorial</code></li>\n    </ol>\n  </blockquote>\n\n  <p>It was quite a long conversion, but we did it! If you’re interested, the “Tip” below describes how we could possibly speed up the process using alternative tools.</p>\n\n  <blockquote class=\"tip\">\n    <tip-title> Alternative tools </tip-title>\n\n    <p>Generally in coding you can use different ways to achieve the same result. Similarly, in Galaxy you can use different tools but the outcome will be the same.\nFor example, we could have used some tools on our starting AnnData object to remove macrophages and rename the column header, and afterwards extract observations and variables. It is a good practice to use methods from the libraries (such as Scanpy below) rather than dealing with text files rows and columns. The shown approach works well, but it might be problematic with much bigger datasets sizes. Then, you can use the following route:</p>\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_filter_cells/scanpy_filter_cells/1.8.1+galaxy93\" title=\"Scanpy FilterCells tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Scanpy FilterCells</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.8.1+galaxy93)</span> on annotated Anndata to remove macrophages.</li>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/anndata_ops/anndata_ops/1.8.1+galaxy92\" title=\"AnnData Operations tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>AnnData Operations</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.8.1+galaxy92)</span> to change the genes name from <em>Symbol</em> to <em>gene_short_name</em>.</li>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.10.3+galaxy0\" title=\"Inspect AnnData tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Inspect AnnData</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.10.3+galaxy0)</span> to extract genes and cells (to be used for Monocle).</li>\n      <li>Follow further steps to filter unprocessed matrix.</li>\n    </ol>\n\n    <p>You’ve probably used the mentioned tools before, so <strong>challenge yourself</strong> and try to replicate the process using the tools above!</p>\n  </blockquote>\n\n  <p>You might want to consult your results with this <a href=\"https://singlecell.usegalaxy.eu/u/j.jakiela/h/anndata---cds-conversion-for-monocle3-tutorial\">control history</a>, or check out the <a href=\"https://singlecell.usegalaxy.eu/u/j.jakiela/w/copy-of-trajectory-analysis-using-monocle3\">workflow</a>. \nAnd now you have your input file ready to start the <a href=\"/training-material/topics/single-cell/tutorials/scrna-case_monocle3-trajectories/tutorial.html\">Monocle3 tutorial</a>!</p>\n\n</div>\n\n<div class=\"General-AnnData-to-CDS-conversion\">\n\n  <h2 id=\"general-anndata-to-cds-conversion\">General AnnData to CDS conversion</h2>\n  <p>In fact, you can do this conversion just in one step - check the <i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tip</span> <strong>Tip</strong> below!</p>\n\n  <blockquote class=\"tip\">\n    <tip-title>Conversion in a single step</tip-title>\n\n    <p>As mentioned in the previous section, SCEasy tool can do this conversion in a single step. Let’s try that out!</p>\n\n    <blockquote class=\"hands_on\">\n      <hands-on-title> SCEasy Converter </hands-on-title>\n\n      <ol>\n        <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/sceasy_convert/sceasy_convert/0.0.7+galaxy2\" title=\"SCEasy Converter tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>SCEasy Converter</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.0.7+galaxy2)</span> with the following parameters:\n          <ul>\n            <li><em>“Convert From / To”</em>: <code class=\"language-plaintext highlighter-rouge\">AnnData to CellDataSet</code></li>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in h5ad,h5 format”</em>: <code class=\"language-plaintext highlighter-rouge\">Downsampled AnnData object</code></li>\n          </ul>\n        </li>\n        <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the output: <code class=\"language-plaintext highlighter-rouge\">CDS object</code></li>\n      </ol>\n\n    </blockquote>\n\n  </blockquote>\n\n  <p>Below we will also show the manual conversion, just to make you familiar with the structure of the files and operations needed. \nWe will continue working on previously used dataset, so you can copy it from your history or download from Zenodo.</p>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title>Get toy data again</hands-on-title>\n\n    <ol>\n      <li>\n        <p>Create a new history for this tutorial</p>\n      </li>\n      <li>\n        <p>You can either copy the previously used dataset from your history:</p>\n\n        <!--SNIPPET-->\n        <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-copy-a-dataset-between-histories-1\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-copy-a-dataset-between-histories-1\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Copy a dataset between histories</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>There 3 ways to copy datasets between histories</p>   <ol>   <li>     <p>From the original history</p>     <ol>       <li>Click on the <i class=\"fas fa-cog\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-gear</span> icon which is on the top of the list of datasets in the history panel</li>       <li>Click on <strong>Copy Datasets</strong></li>       <li>         <p>Select the desired files</p>       </li>       <li>         <p>Give a relevant name to the “New history”</p>       </li>       <li>Validate by ‘Copy History Items’</li>       <li>Click on the new history name in the green box that have just appear to switch to this history</li>     </ol>   </li>   <li>     <p>Using the <i class=\"fas fa-columns\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-columns</span> <strong>Show Histories Side-by-Side</strong></p>     <ol>       <li>Click on the <i class=\"fas fa-caret-down\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-dropdown</span> dropdown arrow top right of the history panel (<strong>History options</strong>)</li>       <li>Click on <i class=\"fas fa-columns\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-columns</span> <strong>Show Histories Side-by-Side</strong></li>       <li>If your target history is not present         <ol>           <li>Click on ‘Select histories’</li>           <li>Click on your target history</li>           <li>Validate by ‘Change Selected’</li>         </ol>       </li>       <li>Drag the dataset to copy from its original history</li>       <li>Drop it in the target history</li>     </ol>   </li>   <li>     <p>From the target history</p>     <ol>       <li>Click on <strong>User</strong> in the top bar</li>       <li>Click on <strong>Datasets</strong></li>       <li>Search for the dataset to copy</li>       <li>Click on its name</li>       <li>Click on <strong>Copy to current History</strong></li>     </ol>   </li> </ol> </blockquote>\n        <p><!--END_SNIPPET--></p>\n\n        <p>Or, alternatively, download the dataset from <a href=\"https://zenodo.org/record/4574153\">Zenodo</a></p>\n\n        <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/10391629/files/Downsampled_annotated_AnnData.h5ad\n</code></pre></div>        </div>\n      </li>\n      <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the datasets <code class=\"language-plaintext highlighter-rouge\">Downsampled AnnData object</code></li>\n      <li>\n        <p>Check that the datatype is <code class=\"language-plaintext highlighter-rouge\">h5ad</code></p>\n\n        <!--SNIPPET-->\n        <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-changing-the-datatype-5\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-changing-the-datatype-5\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Changing the datatype</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, click <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Datatypes</strong> tab on the top</li>   <li>In the <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Assign Datatype</strong>, select <code class=\"language-plaintext highlighter-rouge\">h5ad</code> from “<em>New type</em>” dropdown     <ul>       <li>Tip: you can start typing the datatype into the field to filter the dropdown menu</li>     </ul>   </li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n        <p><!--END_SNIPPET--></p>\n      </li>\n    </ol>\n\n  </blockquote>\n\n  <p>Now we just need to extract information about cells, genes and an expression matrix.</p>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title> Inspect AnnData </hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.10.3+galaxy0\" title=\"Inspect AnnData tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Inspect AnnData</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.10.3+galaxy0)</span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Downsampled AnnData object</code></li>\n          <li><em>“What to inspect?”</em>: <code class=\"language-plaintext highlighter-rouge\">Key-indexed observations annotation (obs)</code></li>\n        </ul>\n      </li>\n    </ol>\n\n    <p><strong>Rename</strong>  <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the output <code class=\"language-plaintext highlighter-rouge\">Cell barcodes (obs)</code>.</p>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.10.3+galaxy0\" title=\"Inspect AnnData tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Inspect AnnData</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.10.3+galaxy0)</span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">Downsampled AnnData object</code></li>\n          <li><em>“What to inspect?”</em>: <code class=\"language-plaintext highlighter-rouge\">Key-indexed annotation of variables/features (var)</code></li>\n        </ul>\n      </li>\n    </ol>\n\n    <p><strong>Rename</strong>  <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the output <code class=\"language-plaintext highlighter-rouge\">Genes (var)</code>.</p>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.10.3+galaxy0\" title=\"Inspect AnnData tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Inspect AnnData</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.10.3+galaxy0)</span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">output</code> (Input dataset)</li>\n          <li><em>“What to inspect?”</em>: <code class=\"language-plaintext highlighter-rouge\">The full data matrix</code></li>\n        </ul>\n      </li>\n    </ol>\n\n    <p><strong>Rename</strong>  <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the output <code class=\"language-plaintext highlighter-rouge\">Expression matrix</code>.</p>\n\n  </blockquote>\n\n  <p>Hold on here! As mentioned, if you’re converting your files to CDS, you’ll probably be working with Monocle. There is one function in downstream analysis in Monocle that requires a specific name of the column containing gene symbols, and that is <code class=\"language-plaintext highlighter-rouge\">gene_short_name</code>. If you use Galaxy buttons for the analysis, you won’t be able to change that name after you create CDS file, so a good piece of advice is to rename it at this stage. There is no harm in doing this, and it might save you some time and frustration later on. You only need to check which column contains the gene symbols and what is its header - you can check that in the preview window, simply by clicking on the <code class=\"language-plaintext highlighter-rouge\">Genes</code> dataset. In our case, that’s column 3 and its name is <code class=\"language-plaintext highlighter-rouge\">Symbol</code>. Let’s change that!</p>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title>Changing the column name</hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/galaxyp/regex_find_replace/regexColumn1/1.0.2\" title=\"Column Regex Find And Replace tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Column Regex Find And Replace</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.0.2)</span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Select cells from”</em>: <code class=\"language-plaintext highlighter-rouge\">Genes</code></li>\n          <li><em>“using column”</em>: <code class=\"language-plaintext highlighter-rouge\">c3</code> or <code class=\"language-plaintext highlighter-rouge\">Column: 3</code></li>\n          <li>In <em>“Check”</em>:\n            <ul>\n              <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Check”</em>\n                <ul>\n                  <li><em>“Find Regex”</em>: <code class=\"language-plaintext highlighter-rouge\">Symbol</code></li>\n                  <li><em>“Replacement”</em>: <code class=\"language-plaintext highlighter-rouge\">gene_short_name</code></li>\n                </ul>\n              </li>\n            </ul>\n          </li>\n        </ul>\n      </li>\n      <li>\n        <p>Check that the datatype is <code class=\"language-plaintext highlighter-rouge\">tabular</code>. If not, change it.</p>\n\n        <!--SNIPPET-->\n        <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-changing-the-datatype-6\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-changing-the-datatype-6\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Changing the datatype</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, click <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Datatypes</strong> tab on the top</li>   <li>In the <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Assign Datatype</strong>, select <code class=\"language-plaintext highlighter-rouge\">tabular</code> from “<em>New type</em>” dropdown     <ul>       <li>Tip: you can start typing the datatype into the field to filter the dropdown menu</li>     </ul>   </li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n        <p><!--END_SNIPPET--></p>\n      </li>\n      <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the output: <code class=\"language-plaintext highlighter-rouge\">Genes renamed</code></li>\n    </ol>\n\n  </blockquote>\n\n  <p>We’re almost there, but there is one last modification we have to do - transpose the matrix to have the genes as rows and cells as columns.</p>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title> Transpose the matrix </hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/datamash_transpose/datamash_transpose/1.8+galaxy1\" title=\"Transpose tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Transpose</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.8+galaxy1)</span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input tabular dataset”</em>: <code class=\"language-plaintext highlighter-rouge\">Expression matrix</code></li>\n        </ul>\n      </li>\n    </ol>\n  </blockquote>\n\n  <p>And the final step is to create the CDS file using Monocle tool!</p>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title> Create Cell Data Set </hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/monocle3_create/monocle3_create/0.1.4+galaxy2\" title=\"Monocle3 create tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Monocle3 create</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.1.4+galaxy2)</span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Expression matrix, genes as rows, cells as columns. Required input. Provide as TSV, CSV or RDS.”</em>: output of <strong>Transpose</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n          <li><em>“Format of expression matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">TSV</code></li>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Per-cell annotation, optional. Row names must match the column names of the expression matrix. Provide as TSV, CSV or RDS.”</em>: <code class=\"language-plaintext highlighter-rouge\">Cell barcodes (obs)</code></li>\n          <li><em>“Format of cell metadata”</em>: <code class=\"language-plaintext highlighter-rouge\">TSV</code></li>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Per-gene annotation, optional. Row names must match the row names of the expression matrix. Provide as TSV, CSV or RDS.”</em>: <code class=\"language-plaintext highlighter-rouge\">Genes renamed</code></li>\n          <li><em>“Format of gene annotation”</em>: <code class=\"language-plaintext highlighter-rouge\">TSV</code></li>\n        </ul>\n      </li>\n      <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the output: <code class=\"language-plaintext highlighter-rouge\">CDS Monocle file</code></li>\n    </ol>\n  </blockquote>\n\n  <p>As usual, you can check the <a href=\"https://usegalaxy.eu/u/j.jakiela/h/anndata-to-cell-data-set-cds-conversion\">example history</a> and the dedicated <a href=\"https://usegalaxy.eu/u/j.jakiela/w/anndata-to-cell-data-set-cds-conversion\">workflow</a> (it doesn’t include the step on renaming the column header though).</p>\n\n</div>\n\n<h1 id=\"downsampling-fastq-files\">Downsampling FASTQ files</h1>\n<p>Sometimes, it is useful to work on smaller subsets of data (especially for teaching / learning purposes). Here is an example of how you can downsample your FASTQ files.\nFirst, let’s get some toy data. We just need two FASTQ files - one containing barcodes, the other with transcripts.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Get toy data</hands-on-title>\n\n  <ol>\n    <li>Create a new history for this section <em>“Downsampling FASTQ Files”</em></li>\n    <li>\n      <p>Import the files from <a href=\"https://zenodo.org/record/4574153\">Zenodo</a></p>\n\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/4574153/files/SLX-7632.TAAGGCGA.N701.s_1.r_1.fq-400k.fastq\nhttps://zenodo.org/record/4574153/files/SLX-7632.TAAGGCGA.N701.s_1.r_2.fq-400k.fastq\n</code></pre></div>      </div>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-via-links-2\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-via-links-2\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing via links</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>Funnily enough, those files are already downsampled, so you won’t have to wait for too long to download them. We are not going to analyse that data anyway, it’s just for demonstration purposes.\nQuickly check which file contains barcodes and which file contains transcripts. If you click on the two datasets, you will see that one has shorter sequences, while the other has longer. It’s quite straight-forward to deduce that shorter sequences are barcodes.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Rename the files</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Rename file <code class=\"language-plaintext highlighter-rouge\">s_1.r_1</code> as <code class=\"language-plaintext highlighter-rouge\">Barcodes</code></p>\n    </li>\n    <li>\n      <p>Rename file <code class=\"language-plaintext highlighter-rouge\">s_1.r_2</code> as <code class=\"language-plaintext highlighter-rouge\">Transcripts</code></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-renaming-a-dataset\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-renaming-a-dataset\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Renaming a dataset</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, change the <strong>Name</strong> field</li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>Now we will convert the FASTQ files to tabular:</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title> FASTQ to tabular </hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/devteam/fastq_to_tabular/fastq_to_tabular/1.1.5\" title=\"FASTQ to Tabular tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>FASTQ to Tabular</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.1.5)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“FASTQ file to convert”</em>: <i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> Select multiple files: <code class=\"language-plaintext highlighter-rouge\">Barcodes</code> and <code class=\"language-plaintext highlighter-rouge\">Transcripts</code></li>\n      </ul>\n    </li>\n    <li><strong>Rename</strong>  <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the datasets <code class=\"language-plaintext highlighter-rouge\">Barcodes tabular</code> and <code class=\"language-plaintext highlighter-rouge\">Transcripts tabular</code></li>\n  </ol>\n\n</blockquote>\n\n<p>Now let’s select the number of the reads we would like to keep. It’s totally up to you, we choose <code class=\"language-plaintext highlighter-rouge\">100000</code> here.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title> Downsampling </hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_tail_tool/1.1.0\" title=\"Select last tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Select last</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.1.0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Text file”</em>: <i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> Select multiple files:   <code class=\"language-plaintext highlighter-rouge\">Barcodes tabular</code> and <code class=\"language-plaintext highlighter-rouge\">Transcripts tabular</code></li>\n        <li><em>“Operation”</em>: <code class=\"language-plaintext highlighter-rouge\">Keep last lines</code></li>\n        <li><em>“Number of lines”</em>: <code class=\"language-plaintext highlighter-rouge\">100000</code></li>\n      </ul>\n    </li>\n    <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the dataset <code class=\"language-plaintext highlighter-rouge\">Barcodes cut</code> and <code class=\"language-plaintext highlighter-rouge\">Transcripts cut</code></li>\n  </ol>\n\n</blockquote>\n\n<p>All done, now we just need to go back to FASTQ from Tabular again!</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title> Tabular to FASTQ </hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/devteam/tabular_to_fastq/tabular_to_fastq/1.1.5\" title=\"Tabular to FASTQ tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Tabular to FASTQ</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.1.5)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Tabular file to convert”</em>: <code class=\"language-plaintext highlighter-rouge\">Barcodes cut</code> (output of <strong>Select last</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Identifier column”</em>: <code class=\"language-plaintext highlighter-rouge\">c1</code> or <code class=\"language-plaintext highlighter-rouge\">Column 1</code></li>\n        <li><em>“Sequence column”</em>: <code class=\"language-plaintext highlighter-rouge\">c2</code> or <code class=\"language-plaintext highlighter-rouge\">Column 2</code></li>\n        <li><em>“Quality column”</em>: <code class=\"language-plaintext highlighter-rouge\">c3</code> or <code class=\"language-plaintext highlighter-rouge\">Column 3</code></li>\n      </ul>\n    </li>\n    <li><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the dataset <code class=\"language-plaintext highlighter-rouge\">Downsampled barcode read</code> and <code class=\"language-plaintext highlighter-rouge\">Downsampled transcript read</code></li>\n  </ol>\n\n</blockquote>\n\n<p>And that’s all! Your downsampled data is ready to use. You can check your answers in this <a href=\"https://usegalaxy.eu/u/j.jakiela/h/how-to-downsample-fastq-files\">example history</a> or if you want to accelerate this process, feel free to use the <a href=\"https://singlecell.usegalaxy.eu/u/j.jakiela/w/workflow-constructed-from-history-copy-of-cs1generating-a-single-cell-matrix-using-alevin---how-to-downsample\">workflow</a> next time!</p>\n"],"ref_slides":[],"hands_on":true,"slides":false,"mod_date":"2024-04-10 10:22:37 +0000","pub_date":"2024-02-13 12:28:05 +0000","version":77,"workflows":[{"workflow":"AnnData-to-Cell-Data-Set-(CDS)-conversion.ga","tests":true,"url":"https://training.galaxyproject.org/training-material/topics/single-cell/tutorials/scrna-data-ingest/workflows/AnnData-to-Cell-Data-Set-(CDS)-conversion.ga","path":"topics/single-cell/tutorials/scrna-data-ingest/workflows/AnnData-to-Cell-Data-Set-(CDS)-conversion.ga","wfid":"single-cell-scrna-data-ingest","wfname":"anndata-to-cell-data-set-(cds)-conversion","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/single-cell-scrna-data-ingest/versions/anndata-to-cell-data-set-(cds)-conversion","license":"CC-BY-4.0","creators":[{"class":"Person","identifier":"0009-0001-2017-8805","name":"Julia Jakiela"}],"name":"AnnData to Cell Data Set (CDS) conversion","title":"AnnData to Cell Data Set (CDS) conversion","test_results":null,"modified":"2024-06-14 10:38:32 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\nAnnData\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"Inspect AnnData\"];\n  0 -->|output| 1;\n  7bdb825c-6a89-4a34-bbd9-a79c309c9750[\"Output\\nInspect AnnData: obs\"];\n  1 --> 7bdb825c-6a89-4a34-bbd9-a79c309c9750;\n  style 7bdb825c-6a89-4a34-bbd9-a79c309c9750 stroke:#2c3143,stroke-width:4px;\n  2[\"Inspect AnnData\"];\n  0 -->|output| 2;\n  79a2e3e5-4bd6-42de-864c-a5dc2412cb86[\"Output\\nInspect AnnData: var\"];\n  2 --> 79a2e3e5-4bd6-42de-864c-a5dc2412cb86;\n  style 79a2e3e5-4bd6-42de-864c-a5dc2412cb86 stroke:#2c3143,stroke-width:4px;\n  3[\"Inspect AnnData\"];\n  0 -->|output| 3;\n  7a254954-7e32-4e8a-bd4c-a79abf9db8d8[\"Output\\nInspect AnnData: X\"];\n  3 --> 7a254954-7e32-4e8a-bd4c-a79abf9db8d8;\n  style 7a254954-7e32-4e8a-bd4c-a79abf9db8d8 stroke:#2c3143,stroke-width:4px;\n  4[\"Transpose\"];\n  3 -->|X| 4;\n  5[\"Monocle3 create\"];\n  1 -->|obs| 5;\n  4 -->|out_file| 5;\n  2 -->|var| 5;\n  6bf4a0ea-3cb9-470c-9863-0a7eb0bc3d8c[\"Output\\nCDS Monocle file\"];\n  5 --> 6bf4a0ea-3cb9-470c-9863-0a7eb0bc3d8c;\n  style 6bf4a0ea-3cb9-470c-9863-0a7eb0bc3d8c stroke:#2c3143,stroke-width:4px;"},{"workflow":"AnnData-to-Seurat-conversion.ga","tests":true,"url":"https://training.galaxyproject.org/training-material/topics/single-cell/tutorials/scrna-data-ingest/workflows/AnnData-to-Seurat-conversion.ga","path":"topics/single-cell/tutorials/scrna-data-ingest/workflows/AnnData-to-Seurat-conversion.ga","wfid":"single-cell-scrna-data-ingest","wfname":"anndata-to-seurat-conversion","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/single-cell-scrna-data-ingest/versions/anndata-to-seurat-conversion","license":"CC-BY-4.0","creators":[{"class":"Person","identifier":"0009-0001-2017-8805","name":"Julia Jakiela"},{"class":"Person","identifier":"0009-0008-9422-6380","name":"Morgan Howells"}],"name":"AnnData to Seurat conversion","title":"AnnData to Seurat conversion","test_results":null,"modified":"2024-06-14 10:38:32 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\nAnnData\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"Inspect AnnData\"];\n  0 -->|output| 1;\n  6d03d713-8d71-4f6a-9f83-cd999f423ebf[\"Output\\nInspect AnnData: obs\"];\n  1 --> 6d03d713-8d71-4f6a-9f83-cd999f423ebf;\n  style 6d03d713-8d71-4f6a-9f83-cd999f423ebf stroke:#2c3143,stroke-width:4px;\n  2[\"Inspect AnnData\"];\n  0 -->|output| 2;\n  ea025a8a-6f3a-4e38-a3af-db406886c7de[\"Output\\nInspect AnnData: X\"];\n  2 --> ea025a8a-6f3a-4e38-a3af-db406886c7de;\n  style ea025a8a-6f3a-4e38-a3af-db406886c7de stroke:#2c3143,stroke-width:4px;\n  3[\"Transpose\"];\n  2 -->|X| 3;\n  4[\"DropletUtils\"];\n  3 -->|out_file| 4;\n  5[\"Seurat Read10x\"];\n  4 -->|barcodes_out| 5;\n  4 -->|genes_out| 5;\n  4 -->|matrix_out| 5;\n  1 -->|obs| 5;\n  e5fec5dc-4706-48e5-8326-05e70290552d[\"Output\\nConverted Seurat object\"];\n  5 --> e5fec5dc-4706-48e5-8326-05e70290552d;\n  style e5fec5dc-4706-48e5-8326-05e70290552d stroke:#2c3143,stroke-width:4px;"},{"workflow":"AnnData-to-SingleCellExperiment-(SCE)-conversion.ga","tests":true,"url":"https://training.galaxyproject.org/training-material/topics/single-cell/tutorials/scrna-data-ingest/workflows/AnnData-to-SingleCellExperiment-(SCE)-conversion.ga","path":"topics/single-cell/tutorials/scrna-data-ingest/workflows/AnnData-to-SingleCellExperiment-(SCE)-conversion.ga","wfid":"single-cell-scrna-data-ingest","wfname":"anndata-to-singlecellexperiment-(sce)-conversion","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/single-cell-scrna-data-ingest/versions/anndata-to-singlecellexperiment-(sce)-conversion","license":"CC-BY-4.0","creators":[{"class":"Person","identifier":"0009-0001-2017-8805","name":"Julia Jakiela"},{"class":"Person","identifier":"0009-0008-9422-6380","name":"Morgan Howells"}],"name":"AnnData to SingleCellExperiment (SCE) conversion","title":"AnnData to SingleCellExperiment (SCE) conversion","test_results":null,"modified":"2024-06-14 10:38:32 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\nAnnData\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"ℹ️ Input Parameter\\nCell ID column\"];\n  style 1 fill:#ded,stroke:#393,stroke-width:4px;\n  2[\"Inspect AnnData\"];\n  0 -->|output| 2;\n  8b9200c2-96e6-40fa-a8e9-1e99638c733f[\"Output\\nInspect AnnData: obs\"];\n  2 --> 8b9200c2-96e6-40fa-a8e9-1e99638c733f;\n  style 8b9200c2-96e6-40fa-a8e9-1e99638c733f stroke:#2c3143,stroke-width:4px;\n  3[\"Inspect AnnData\"];\n  0 -->|output| 3;\n  9fc4ce5a-8384-484d-b1cd-c0f5137cf821[\"Output\\nInspect AnnData: X\"];\n  3 --> 9fc4ce5a-8384-484d-b1cd-c0f5137cf821;\n  style 9fc4ce5a-8384-484d-b1cd-c0f5137cf821 stroke:#2c3143,stroke-width:4px;\n  4[\"Transpose\"];\n  3 -->|X| 4;\n  5[\"DropletUtils\"];\n  4 -->|out_file| 5;\n  6[\"DropletUtils Read10x\"];\n  1 -->|output| 6;\n  2 -->|obs| 6;\n  5 -->|barcodes_out| 6;\n  5 -->|genes_out| 6;\n  5 -->|matrix_out| 6;\n  3256e23f-2026-407d-aa25-0f8c0f3ae3f7[\"Output\\nConverted SCE object\"];\n  6 --> 3256e23f-2026-407d-aa25-0f8c0f3ae3f7;\n  style 3256e23f-2026-407d-aa25-0f8c0f3ae3f7 stroke:#2c3143,stroke-width:4px;"}],"api":"https://training.galaxyproject.org/training-material/api/topics/single-cell/tutorials/scrna-data-ingest/tutorial.json","tools":["Cut1","Filter1","join1","toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_cut_tool/1.1.0","toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_tail_tool/1.1.0","toolshed.g2.bx.psu.edu/repos/devteam/fastq_to_tabular/fastq_to_tabular/1.1.5","toolshed.g2.bx.psu.edu/repos/devteam/tabular_to_fastq/tabular_to_fastq/1.1.5","toolshed.g2.bx.psu.edu/repos/ebi-gxa/anndata_ops/anndata_ops/1.8.1+galaxy92","toolshed.g2.bx.psu.edu/repos/ebi-gxa/dropletutils_read_10x/dropletutils_read_10x/1.0.4+galaxy0","toolshed.g2.bx.psu.edu/repos/ebi-gxa/monocle3_create/monocle3_create/0.1.4+galaxy2","toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_filter_cells/scanpy_filter_cells/1.8.1+galaxy93","toolshed.g2.bx.psu.edu/repos/ebi-gxa/sceasy_convert/sceasy_convert/0.0.5+galaxy1","toolshed.g2.bx.psu.edu/repos/ebi-gxa/seurat_read10x/seurat_read10x/3.2.3+galaxy0","toolshed.g2.bx.psu.edu/repos/galaxyp/regex_find_replace/regexColumn1/1.0.2","toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.10.3+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.7.5+galaxy1","toolshed.g2.bx.psu.edu/repos/iuc/datamash_transpose/datamash_transpose/1.1.0+galaxy2","toolshed.g2.bx.psu.edu/repos/iuc/datamash_transpose/datamash_transpose/1.8+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/datamash_transpose/datamash_transpose/1.8+galaxy1","toolshed.g2.bx.psu.edu/repos/iuc/dropletutils/dropletutils/1.10.0+galaxy2","toolshed.g2.bx.psu.edu/repos/iuc/sceasy_convert/sceasy_convert/0.0.7+galaxy2"],"supported_servers":{"exact":[{"url":"https://usegalaxy.eu","name":"UseGalaxy.eu","usegalaxy":true}],"inexact":[]},"topic_name_human":"Single Cell","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"text_processing","owner":"bgruening","revisions":"d698c222f354","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"text_processing","owner":"bgruening","revisions":"d698c222f354","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"fastq_to_tabular","owner":"devteam","revisions":"4b347702c4aa","tool_panel_section_label":"FASTA/FASTQ","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"tabular_to_fastq","owner":"devteam","revisions":"2dcfbbf9071a","tool_panel_section_label":"FASTA/FASTQ","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"anndata_ops","owner":"ebi-gxa","revisions":"a0274bc43b7e","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"dropletutils_read_10x","owner":"ebi-gxa","revisions":"ca62f52e0d7f","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"monocle3_create","owner":"ebi-gxa","revisions":"ada68a9d0aec","tool_panel_section_label":"Monocle3","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"scanpy_filter_cells","owner":"ebi-gxa","revisions":"356fa6c27341","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"sceasy_convert","owner":"ebi-gxa","revisions":"f62bc418173f","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"seurat_read10x","owner":"ebi-gxa","revisions":"301cf1b4b43d","tool_panel_section_label":"Single Cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"regex_find_replace","owner":"galaxyp","revisions":"399da6b5ec21","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"anndata_inspect","owner":"iuc","revisions":"6f0d0c784f09","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"anndata_inspect","owner":"iuc","revisions":"ee98d611afc6","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"datamash_transpose","owner":"iuc","revisions":"ac092723240d","tool_panel_section_label":"Join, Subtract and Group","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"datamash_transpose","owner":"iuc","revisions":"374cb875d38a","tool_panel_section_label":"Join, Subtract and Group","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"datamash_transpose","owner":"iuc","revisions":"a513e3fbb4c5","tool_panel_section_label":"Join, Subtract and Group","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"dropletutils","owner":"iuc","revisions":"a9caad671439","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"sceasy_convert","owner":"iuc","revisions":"2062be7efc84","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: text_processing\n  owner: bgruening\n  revisions: d698c222f354\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: text_processing\n  owner: bgruening\n  revisions: d698c222f354\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: fastq_to_tabular\n  owner: devteam\n  revisions: 4b347702c4aa\n  tool_panel_section_label: FASTA/FASTQ\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: tabular_to_fastq\n  owner: devteam\n  revisions: 2dcfbbf9071a\n  tool_panel_section_label: FASTA/FASTQ\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: anndata_ops\n  owner: ebi-gxa\n  revisions: a0274bc43b7e\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: dropletutils_read_10x\n  owner: ebi-gxa\n  revisions: ca62f52e0d7f\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: monocle3_create\n  owner: ebi-gxa\n  revisions: ada68a9d0aec\n  tool_panel_section_label: Monocle3\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_filter_cells\n  owner: ebi-gxa\n  revisions: 356fa6c27341\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: sceasy_convert\n  owner: ebi-gxa\n  revisions: f62bc418173f\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: seurat_read10x\n  owner: ebi-gxa\n  revisions: 301cf1b4b43d\n  tool_panel_section_label: Single Cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: regex_find_replace\n  owner: galaxyp\n  revisions: 399da6b5ec21\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: anndata_inspect\n  owner: iuc\n  revisions: 6f0d0c784f09\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: anndata_inspect\n  owner: iuc\n  revisions: ee98d611afc6\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: datamash_transpose\n  owner: iuc\n  revisions: ac092723240d\n  tool_panel_section_label: Join, Subtract and Group\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: datamash_transpose\n  owner: iuc\n  revisions: 374cb875d38a\n  tool_panel_section_label: Join, Subtract and Group\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: datamash_transpose\n  owner: iuc\n  revisions: a513e3fbb4c5\n  tool_panel_section_label: Join, Subtract and Group\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: dropletutils\n  owner: iuc\n  revisions: a9caad671439\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: sceasy_convert\n  owner: iuc\n  revisions: 2062be7efc84\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":false,"slides_recordings":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial","contributors":[{"name":"Julia Jakiela","email":"juliajot36@gmail.com","joined":"2022-06","id":"wee-snufkin","url":"https://training.galaxyproject.org/training-material/api/contributors/wee-snufkin.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/wee-snufkin/"},{"name":"Morgan Howells","email":"hexhowells@gmail.com","orcid":"0009-0008-9422-6380","joined":"2023-06","id":"hexhowells","url":"https://training.galaxyproject.org/training-material/api/contributors/hexhowells.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/hexhowells/"},{"name":"Wendi Bacon","email":"wendi.bacon@open.ac.uk","twitter":"WendiBacon1","matrix":"nomadscientist:matrix.org","joined":"2020-03","elixir_node":"uk","orcid":"0000-0002-8170-8806","bio":"Lecturer at The Open University","fediverse":"https://mstdn.science/@wendibacon1","fediverse_flavor":"mastodon","affiliations":["elixir-europe"],"id":"nomadscientist","url":"https://training.galaxyproject.org/training-material/api/contributors/nomadscientist.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/nomadscientist/"},{"name":"Helena Rasche","orcid":"0000-0001-9760-8992","maintainer_contact":"gitter","matrix":"hexylena:matrix.org","joined":"2017-09","elixir_node":"nl","affiliations":["gallantries","by-covid","erasmusmc","elixir-europe","elixir-converge"],"former_affiliations":["deNBI","avans-atgm","uni-freiburg"],"contact_for_training":false,"location":{"country":"NL","lat":51.91,"lon":4.46},"id":"hexylena","url":"https://training.galaxyproject.org/training-material/api/contributors/hexylena.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/hexylena/"},{"name":"Pavankumar Videm","orcid":"0000-0002-5192-126X","joined":"2017-09","affiliations":["uni-freiburg","elixir-europe"],"id":"pavanvidem","url":"https://training.galaxyproject.org/training-material/api/contributors/pavanvidem.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/pavanvidem/"},{"name":"Mehmet Tekman","email":"mtekman89@gmail.com","joined":"2018-11","elixir_node":"de","affiliations":["uni-freiburg"],"former_affiliations":["elixir-europe"],"id":"mtekman","url":"https://training.galaxyproject.org/training-material/api/contributors/mtekman.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/mtekman/"},{"name":"ELIXIR-UK: FAIR Data Stewardship training","short_name":"ELIXIR Fair Data","github":false,"joined":"2023-06","funder":true,"funding_id":"MR/V038966/1","funding_system":"ukri","funding_statement":"This work has been funded by the ELIXIR-UK FAIR Data Stewardship training UKRI award (MR/V038966/1)","id":"elixir-fair-data","url":"https://training.galaxyproject.org/training-material/api/funders/elixir-fair-data.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/elixir-fair-data/"}]}