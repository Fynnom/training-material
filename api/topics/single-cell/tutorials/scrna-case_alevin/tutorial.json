{"layout":"tutorial_hands_on","title":"Generating a single cell matrix using Alevin","subtopic":"single-cell-CS","priority":1,"zenodo_link":"https://zenodo.org/record/4574153","redirect_from":["/topics/transcriptomics/tutorials/droplet-quantification-preprocessing/tutorial","/topics/transcriptomics/tutorials/scrna-case_alevin/tutorial","/short/single-cell/scrna-case_alevin","/short/T00245"],"questions":["I have some single cell FASTQ files I want to analyse. Where do I start?"],"answer_histories":[{"label":"UseGalaxy.eu","history":"https://usegalaxy.eu/u/j.jakiela/h/generating-a-single-cell-matrix-alevin","date":"2024-03-22"},{"label":"Older Alevin version","history":"https://humancellatlas.usegalaxy.eu/u/wendi.bacon.training/h/cs1pre-processing-with-alevin---answer-key","date":"2024-01-01"}],"input_histories":[{"label":"UseGalaxy.eu","history":"https://humancellatlas.usegalaxy.eu/u/wendi.bacon.training/h/cs1pre-processing-with-alevin---input-1"}],"objectives":["Generate a cellxgene matrix for droplet-based single cell sequencing data","Interpret quality control (QC) plots to make informed decisions on cell thresholds","Find relevant information in GTF files for the particulars of their study, and include this in data matrix metadata"],"time_estimation":"2H","key_points":["Create a scanpy-accessible AnnData object from FASTQ files, including relevant gene metadata"],"tags":["10x","paper-replication"],"contributions":{"authorship":["nomadscientist","pinin4fjords"],"editing":["hexylena"],"testing":["wee-snufkin"]},"requirements":[{"type":"internal","topic_name":"single-cell","tutorials":["scrna-intro","scrna-umis"]}],"gitter":"Galaxy-Training-Network/galaxy-single-cell","follow_up_training":[{"type":"internal","topic_name":"single-cell","tutorials":["scrna-case_alevin-combine-datasets"]}],"recordings":[{"captioners":["nomadscientist"],"date":"2021-02-15","galaxy_version":"21.01","length":"30M","youtube_id":"3ytm2AU6QUc","speakers":["nomadscientist"]}],"js_requirements":{"mathjax":null,"mermaid":false},"short_id":"T00245","url":"/topics/single-cell/tutorials/scrna-case_alevin/tutorial.html","topic_name":"single-cell","tutorial_name":"scrna-case_alevin","dir":"topics/single-cell/tutorials/scrna-case_alevin","symlink":null,"id":"single-cell/scrna-case_alevin","ref_tutorials":["<p>This tutorial will take you from raw FASTQ files to a cell x gene data matrix in AnnData format. What’s a data matrix, and what’s AnnData format? Well you’ll find out! Importantly, this is the first step in processing single cell data in order to start analysing it. Currently you have a bunch of strings of <code class=\"language-plaintext highlighter-rouge\">ATGGGCTT</code> etc. in your sequencing files, and what you need to know is how many cells you have and what genes appear in those cells. These steps are the most computationally heavy in the single cell world, as you’re starting with 100s of millions of reads, each with 4 lines of text. Later on in analysis, this data becomes simple gene counts such as ‘Cell A has 4 GAPDHs’, which is a lot easier to store! Because of this data overload, we have downsampled the FASTQ files to speed up the analysis a bit. Saying that, you’re still having to map loads of reads to the massive murine genome, so get yourself a cup of coffee and prepare to analyse!</p>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n  <p>In this tutorial, we will cover:</p>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#generating-a-matrix\" id=\"markdown-toc-generating-a-matrix\">Generating a matrix</a>    <ol>\n      <li><a href=\"#get-data\" id=\"markdown-toc-get-data\">Get Data</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#important-tips-for-easier-analysis\" id=\"markdown-toc-important-tips-for-easier-analysis\">Important tips for easier analysis</a>    <ol>\n      <li><a href=\"#generate-a-transcript-to-gene-map\" id=\"markdown-toc-generate-a-transcript-to-gene-map\">Generate a transcript to gene map</a></li>\n      <li><a href=\"#generate-a-transcriptome-index--quantify\" id=\"markdown-toc-generate-a-transcriptome-index--quantify\">Generate a transcriptome index &amp; quantify!</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#basic-qc\" id=\"markdown-toc-basic-qc\">Basic QC</a>    <ol>\n      <li><a href=\"#generate-an-unprocessed-matrix-in-a-usable-format\" id=\"markdown-toc-generate-an-unprocessed-matrix-in-a-usable-format\">Generate an unprocessed matrix in a usable format</a></li>\n      <li><a href=\"#adding-in-gene-metadata\" id=\"markdown-toc-adding-in-gene-metadata\">Adding in Gene metadata</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#emptydrops\" id=\"markdown-toc-emptydrops\">emptyDrops</a></li>\n  <li><a href=\"#analysing-multiple-fastq-files\" id=\"markdown-toc-analysing-multiple-fastq-files\">Analysing multiple FASTQ files</a></li>\n  <li><a href=\"#mitochondrial-flagging\" id=\"markdown-toc-mitochondrial-flagging\">Mitochondrial flagging</a></li>\n  <li><a href=\"#conclusion\" id=\"markdown-toc-conclusion\">Conclusion</a></li>\n</ol>\n\n</blockquote>\n\n<h1 id=\"generating-a-matrix\">Generating a matrix</h1>\n\n<p>In this section, we will show you the principles of the initial phase of single-cell RNA-seq analysis: generating expression measures in a matrix. We’ll concentrate on droplet-based (rather than plate-based) methodology, since this is the process with most differences with respect to conventional approaches developed for bulk RNA-seq.</p>\n\n<p>Droplet-based data consists of three components: cell barcodes, unique molecular identifiers (UMIs) and cDNA reads. To generate cell-wise quantifications we need to:</p>\n\n<ul>\n  <li>Process cell barcodes, working out which ones correspond to ‘real’ cells, which to sequencing artefacts, and possibly correct any barcodes likely to be the product of sequencing errors by comparison to more frequent sequences.</li>\n  <li>Map biological sequences to the reference genome or transcriptome.</li>\n  <li>‘De-duplicate’ using the UMIs.</li>\n</ul>\n\n<p>This used to be a complex process involving multiple algorithms, or was performed with technology-specific methods (such as 10X’s ‘Cellranger’ tool)  but is now much simpler thanks to the advent of a few new methods. When selecting methodology for your own work you should consider:</p>\n\n<ul>\n  <li><a href=\"https://github.com/alexdobin/STAR\">STARsolo</a> - a droplet-based scRNA-seq-specific variant of the popular genome alignment method STAR. Produces results very close to those of Cellranger (which itself uses STAR under the hood).</li>\n  <li><a href=\"https://www.kallistobus.tools/\">Kallisto/ bustools</a> - developed by the originators of the transcriptome quantification method, Kallisto.</li>\n  <li><a href=\"https://salmon.readthedocs.io/en/latest/alevin.html\">Alevin</a> - another transcriptome analysis method developed by the authors of the Salmon tool.</li>\n</ul>\n\n<p>We’re going to use Alevin <span class=\"citation\"><a href=\"#article-Alevin\">Srivastava <i>et al.</i> 2019</a></span> for demonstration purposes, but we do not endorse one method over another.</p>\n\n<h2 id=\"get-data\">Get Data</h2>\n\n<p>We’ve provided you with some example data to play with, a small subset of the reads in a mouse dataset of fetal growth restriction <span class=\"citation\"><a href=\"#Bacon2018\">Bacon <i>et al.</i> 2018</a></span> (see the <a href=\"https://www.ebi.ac.uk/gxa/sc/experiments/E-MTAB-6945/results/tsne\">study in Single Cell Expression Atlas</a> and the <a href=\"https://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-6945/\">project submission</a>). This is a study using the Drop-seq chemistry, however this tutorial is almost identical to a 10x chemistry. We will point out the one tool parameter change you will need to run 10x samples. This data is not carefully curated, standard tutorial data - it’s real, it’s messy, it desperately needs filtering, it has background RNA running around, and most of all it will give you a chance to practice your analysis as if this data were yours.</p>\n\n<p>Down-sampled reads and some associated annotation can be imported below. How did I downsample these FASTQ files? Check out <a href=\"https://humancellatlas.usegalaxy.eu/u/wendi.bacon.training/h/pre-processing-with-alevin---part-1---how-to-downsample\">this history</a> to find out!</p>\n\n<p>Additionally, to map your reads, you will need a transcriptome to align against (a FASTA) as well as the gene information for each transcript (a gtf) file. You can download these for your species of interest <a href=\"https://www.ensembl.org/info/data/ftp/index.html\">from Ensembl</a>. These files are included in the data import step below. Keep in mind, these are big files, so the fastest way to get these into your Galaxy account is through importing them by history.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Option 1: Data upload - Import history</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Import history from: <a href=\"https://humancellatlas.usegalaxy.eu/u/wendi.bacon.training/h/cs1pre-processing-with-alevin---input-1\">example input history</a></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-a-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-a-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing a history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ol>   <li>Open the link to the shared history</li>   <li>Click on the <i class=\"fas fa-plus\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">new-history</span> <em>Import history</em> button on the top right</li>   <li>Enter a title for the new history</li>   <li>Click on <strong>Import</strong></li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the the history to your name of choice.</p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Option 2: Data upload - Add to history</hands-on-title>\n\n  <ol>\n    <li>Create a new history for this tutorial</li>\n    <li>\n      <p>Import the Experimental Design table, sequencing reads 1 &amp; 2, the GTF and fasta files from <a href=\"https://zenodo.org/record/4574153\">Zenodo</a></p>\n\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/4574153/files/Experimental_Design.tabular\nhttps://zenodo.org/record/4574153/files/Mus_musculus.GRCm38.100.gtf.gff\nhttps://zenodo.org/record/4574153/files/Mus_musculus.GRCm38.cdna.all.fa.fasta\nhttps://zenodo.org/record/4574153/files/SLX-7632.TAAGGCGA.N701.s_1.r_1.fq-400k.fastq\nhttps://zenodo.org/record/4574153/files/SLX-7632.TAAGGCGA.N701.s_1.r_2.fq-400k.fastq\n</code></pre></div>      </div>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-via-links\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-via-links\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing via links</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>Rename <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the datasets: Change <code class=\"language-plaintext highlighter-rouge\">SLX-7632.TAAGGCGA.N701.s_1.r_1.fq-400k</code> to <code class=\"language-plaintext highlighter-rouge\">N701-Read1</code> and <code class=\"language-plaintext highlighter-rouge\">SLX-7632.TAAGGCGA.N701.s_1.r_2.fq-400k.fastq</code> to <code class=\"language-plaintext highlighter-rouge\">N701-Read2</code>.</li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>Have a look at the files you now have in your history.</p>\n  <ol>\n    <li>Which of the FASTQ files do you think contains the barcode sequences?</li>\n    <li>Given the chemistry this study should have, are the barcode/UMI reads the correct length?</li>\n    <li>What is the ‘N701’ referring to?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>Read 1 (SLX-7632.TAAGGCGA.N701.s_1.r_1.fq-400k) contains the cell barcode and UMI because it is significantly shorter (indeed, 20 bp!) compared to the longer, r_2 transcript read. For ease, it’s better to rename these files N701-Read1 and N701-Read2.</li>\n      <li>You can see Read 1 is only 20 bp long, which for original Drop-Seq is 12 bp for cell barcode and 8 bp for UMI. This is correct! Be warned - 10x Chromium (and many technologies) change their chemistry over time, so particularly when you are accessing public data, you want to check and make sure you have your numbers correct!</li>\n      <li>‘N701’ is referring to an index read. This sample was run alongside 6 other samples, each denoted by an Illumina Nextera Index (N70X). Later, this will tell you batch information. If you look at the ‘Experimental Design’ file, you’ll see that the N701 sample was from a male wildtype neonatal thymus.</li>\n    </ol>\n  </blockquote>\n</blockquote>\n\n<h1 id=\"important-tips-for-easier-analysis\">Important tips for easier analysis</h1>\n\n<!--SNIPPET-->\n<blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-using-tutorial-mode\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-using-tutorial-mode\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Using tutorial mode</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>Tools are frequently updated to new versions. Your Galaxy may have multiple versions of the same tool available. By default, you will be shown the latest version of the tool. This may NOT be the same tool used in the tutorial you are accessing. Furthermore, if you use a newer tool in one step, and try using an older tool in the next step… this may fail! To ensure you use the same tool versions of a given tutorial, use the <strong>Tutorial mode</strong> feature.</p>   <ul>   <li>Open your Galaxy server</li>   <li>Click on the <i class=\"fas fa-graduation-cap\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">curriculum</span> icon on the top menu, this will open the GTN inside Galaxy.</li>   <li>Navigate to your tutorial</li>   <li>Tool names in tutorials will be blue buttons that open the correct tool for you</li>   <li><strong>Note:</strong> this does not work for all tutorials (yet)   <img src=\"/training-material/topics/contributing/images/88277962-ddda4a80-cce1-11ea-92cd-41b1df063db0.gif\" alt=\"gif showing how GTN-in-Galaxy works\" /></li>   <li>You can click anywhere in the grey-ed out area outside of the tutorial box to return back to the Galaxy analytical interface</li> </ul>   <blockquote class=\"warning\">   <warning-title>Not all browsers work!</warning-title>   <ul>     <li>We’ve had some issues with Tutorial mode on Safari for Mac users.</li>     <li>Try a <strong>different browser</strong> if you aren’t seeing the button.</li>   </ul> </blockquote> </blockquote>\n<p><!--END_SNIPPET--></p>\n\n<!--SNIPPET-->\n<blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-use-our-single-cell-lab\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-use-our-single-cell-lab\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Use our Single Cell Lab</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>Did you know we have a unique Single Cell Lab with all our single cell tools highlighted to make it easier to use on Galaxy? We recommend this site for all your single cell analysis needs, particularly for newer users.</p>   <p>The Single Cell Lab currently uses the main European Galaxy infrastructure and power, it’s just organised better for users of particular analyses…like single cell!</p>   <p>Try it out! All your histories/workflows/logins from the general <a href=\"https://usegalaxy.eu\">European Galaxy server</a> will be there!</p>   <ul>   <li><i class=\"fa fa-tv\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">subdomain</span> <a href=\"https://singlecell.usegalaxy.eu\">Single Cell Lab</a></li> </ul> </blockquote>\n<p><!--END_SNIPPET--></p>\n\n<!--SNIPPET-->\n<blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-troubleshooting-errors\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-troubleshooting-errors\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Troubleshooting errors</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>When something goes wrong in Galaxy, there are a number of things you can do to find out what it was. Error messages can help you figure out whether it was a problem with one of the settings of the tool, or with the input data, or maybe there is a bug in the tool itself and the problem should be reported. Below are the steps you can follow to troubleshoot your Galaxy errors.</p>   <ol>   <li><strong>Expand</strong> the red history dataset by clicking on it.     <ul>       <li>Sometimes you can already see an error message here</li>     </ul>   </li>   <li>     <p><strong>View the error message</strong> by clicking on the <strong>bug icon</strong> <i class=\"fas fa-bug\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-bug</span></p>   </li>   <li><strong>Check the logs.</strong> Output (stdout) and error logs (stderr) of the tool are available:     <ul>       <li>Expand the history item</li>       <li>Click on the <i class=\"fas fa-info-circle\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">details</span> icon</li>       <li>Scroll down to the <strong>Job Information</strong> section to view the 2 logs:         <ul>           <li>Tool Standard Output</li>           <li>Tool Standard Error</li>         </ul>       </li>       <li>For more information about specific tool errors, please see the <a href=\"/training-material/faqs/galaxy/index.html#troubleshooting\">Troubleshooting section</a></li>     </ul>   </li>   <li><strong>Submit a bug report!</strong> If you are still unsure what the problem is.     <ul>       <li>Click on the bug icon <i class=\"fas fa-bug\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-bug</span></li>       <li>Write down any information you think might help solve the problem         <ul>           <li>See <a href=\"/training-material/faqs/galaxy/analysis_troubleshooting_reporting.html\">this FAQ</a> on how to write good bug reports</li>         </ul>       </li>       <li>Click <strong><i class=\"fas fa-bug\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-bug</span> Report</strong> button</li>     </ul>   </li>   <li><strong>Ask for help!</strong>     <ul>       <li>Where?         <ul>           <li>In the <a href=\"https://matrix.to/#/#Galaxy-Training-Network_galaxy-single-cell:gitter.im\">Single cell user community</a></li>           <li>In the <a href=\"https://gitter.im/Galaxy-Training-Network/Lobby\">GTN Matrix Channel</a></li>           <li>In the <a href=\"https://gitter.im/galaxyproject/Lobby\">Galaxy Matrix Channel</a></li>           <li>Browse the <a href=\"https://help.galaxyproject.org/\">Galaxy Help Forum</a> to see if others have encountered the same problem before (or post your question).</li>         </ul>       </li>       <li>When asking for help, it is useful to <a href=\"/training-material/faqs/galaxy/histories_sharing.html\">share a link to your history</a></li>     </ul>   </li> </ol> </blockquote>\n<p><!--END_SNIPPET--></p>\n\n<h2 id=\"generate-a-transcript-to-gene-map\">Generate a transcript to gene map</h2>\n\n<p>Gene-level, rather than transcript-level, quantification is standard in scRNA-seq, which means that the expression level of alternatively spliced RNA molecules are combined to create gene-level values. Droplet-based scRNA-seq techniques only sample one end each transcript, so lack the full-molecule coverage that would be required to accurately quantify different transcript isoforms.</p>\n\n<p>To generate gene-level quantifications based on transcriptome quantification, Alevin and similar tools require a conversion between transcript and gene identifiers. We can derive a transcript-gene conversion from the gene annotations available in genome resources such as Ensembl. The transcripts in such a list need to match the ones we will use later to build a binary transcriptome index. If you were using spike-ins, you’d need to add these to the transcriptome and the transcript-gene mapping.</p>\n\n<p>In your example data you will see the murine reference annotation as retrieved from Ensembl in GTF format. This annotation contains gene, exon, transcript and all sorts of other information on the sequences. We will use these to generate the transcript/ gene mapping by passing that information to a tool that extracts just the transcript identifiers we need.</p>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>Which of the ‘attributes’ in the last column of the GTF files contains the transcript and gene identifiers?</p>\n\n  <blockquote class=\"tip\">\n    <tip-title>Hint</tip-title>\n\n    <p>The file is organised such that the last column (headed ‘Group’) contains a wealth of information in the format: attribute1 “information associated with attribute 1”;attribute2 “information associated with attribute 2” etc.</p>\n  </blockquote>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n    <p><em>gene_id</em> and <em>transcript_id</em> are each followed by “ensembl gene_id” and “ensembl transcript_id”</p>\n  </blockquote>\n</blockquote>\n\n<p>It’s now time to parse the GTF file using the <a href=\"https://bioconductor.org/packages/release/bioc/html/rtracklayer.html\">rtracklayer</a> package in R. This parsing will give us a conversion table with a list of transcript identifiers and their corresponding gene identifiers for counting. Additionally, because we will be generating our own binary index (more later!), we also need to input our FASTA so that it can be filtered to only contain transcriptome information found in the GTF.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Generate a filtered FASTA and transcript-gene map</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/gtf2gene_list/_ensembl_gtf2gene_list/1.52.0+galaxy0\" title=\"GTF2GeneList tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>GTF2GeneList</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.52.0+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Ensembl GTF file”</em>: <code class=\"language-plaintext highlighter-rouge\">GTF file in the history</code> <i class=\"fas fa-columns\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-history</span></li>\n        <li><em>“Feature type for which to derive annotation”</em>: <code class=\"language-plaintext highlighter-rouge\">transcript</code> (Your sequences are transcript sequencing, so this is your starting point)</li>\n        <li><em>“Field to place first in output table”</em>: <code class=\"language-plaintext highlighter-rouge\">transcript_id</code> (This is accessing the column you identified above!)</li>\n        <li><em>“Suppress header line in output?”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code> (The next tool (Alevin) does not expect a header)</li>\n        <li><em>“Comma-separated list of field names to extract from the GTF (default: use all fields)”</em>: <code class=\"language-plaintext highlighter-rouge\">transcript_id,gene_id</code> (This calls the first column to be the transcript_id, and the second the gene_id. Thus, your key can turn transcripts into genes)</li>\n        <li><em>“Append version to transcript identifiers?”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code> (The Ensembl FASTA files usually have these, and since we need the FASTA transcriptome and the GTF gene information to work together, we need to append these!)</li>\n        <li><em>“Flag mitochondrial features?”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n        <li><em>“Provide a cDNA file for extracting annotations and/ or possible filtering?”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“FASTA-format cDNA/transcript file”</em>: <code class=\"language-plaintext highlighter-rouge\">FASTA file in your history</code> <i class=\"fas fa-columns\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-history</span></li>\n        <li><em>“Annotation field to match with sequences”</em>: <code class=\"language-plaintext highlighter-rouge\">transcript_id</code></li>\n        <li><em>“Filter the cDNA file to match the annotations?”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n      </ul>\n    </li>\n    <li>\n      <p>Rename <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the annotation table to <code class=\"language-plaintext highlighter-rouge\">Map</code></p>\n    </li>\n    <li>Rename <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the uncompressed filtered FASTA file to <code class=\"language-plaintext highlighter-rouge\">Filtered FASTA</code></li>\n  </ol>\n</blockquote>\n\n<h2 id=\"generate-a-transcriptome-index--quantify\">Generate a transcriptome index &amp; quantify!</h2>\n\n<p>Alevin collapses the steps involved in dealing with dscRNA-seq into a single process. Such tools need to compare the sequences in your sample to a reference containing all the likely transcript sequences (a ‘transcriptome’). This will contain the biological transcript sequences known for a given species, and perhaps also technical sequences such as ‘spike ins’ if you have those.</p>\n\n<blockquote class=\"details\">\n  <details-title>How does Alevin work?</details-title>\n\n  <p>To be able to search a transcriptome quickly, Alevin needs to convert the text (FASTA) format sequences into something it can search quickly, called an ‘index’. The index is in a binary rather than human-readable format, but allows fast lookup by Alevin. Because the types of biological and technical sequences we need to include in the index can vary between experiments, and because we often want to use the most up-to-date reference sequences from Ensembl or NCBI, we can end up re-making the indices quite often. Making these indices is time-consuming! Have a look at the uncompressed FASTA to see what it starts with.</p>\n\n</blockquote>\n\n<p>We now have:</p>\n\n<ul>\n  <li>Barcode/ UMI reads</li>\n  <li>cDNA reads</li>\n  <li>transcript/ gene mapping</li>\n  <li>filtered FASTA</li>\n</ul>\n\n<p>We can now run Alevin. In some public instances, Alevin won’t show up if you search for it. Instead, you may have to click the Single Cell tab at the left and scroll down to the Alevin tool. Alternatively, use Tutorial Mode as described above and you’ll easily navigate to all the tools, and their versions will all be the tried and tested ones of this tutorial. It’s often a good idea to check your tool versions. To identify which version of a tool you are using, select <i class=\"fas fa-cubes\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool-versions</span> ‘Versions’ and choose the appropriate version. In this case the tutorial was built with Alevin Galaxy Version 1.9.0+galaxy2.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Running Alevin</hands-on-title>\n\n  <ol>\n    <li>\n      <p><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/alevin/alevin/1.10.1+galaxy0\" title=\"Alevin tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Alevin</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.10.1+galaxy0)</span></p>\n\n      <blockquote class=\"question\">\n        <question-title></question-title>\n\n        <p>Try to fill in the parameters of Alevin using what you know!</p>\n\n        <blockquote class=\"tip\">\n          <tip-title>Strandedness?</tip-title>\n\n          <p>The Salmon documentation on ‘Fragment Library Types’ and running the Alevin command is here: <a href=\"https://salmon.readthedocs.io/en/latest/library_type.html\">salmon.readthedocs.io/en/latest/library_type.html</a> and <a href=\"https://salmon.readthedocs.io/en/latest/alevin.html\">salmon.readthedocs.io/en/latest/alevin.html</a>. These links will help here, although keep in mind the image there is drawn with the RNA 5’ on top, whereas in this scRNA-seq protocol, the polyA is captured by its 3’ tail and thus effectively the bottom or reverse strand…)</p>\n        </blockquote>\n\n        <blockquote class=\"solution\">\n          <solution-title></solution-title>\n          <ul>\n            <li><em>“Select a reference transcriptome from your history or use a built-in index?”</em>: <code class=\"language-plaintext highlighter-rouge\">Use one from the history</code>\n              <ul>\n                <li>You are going to generate the binary index using your filtered FASTA!</li>\n              </ul>\n            </li>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Transcripts FASTA file”</em>: <code class=\"language-plaintext highlighter-rouge\">Filtered FASTA</code></li>\n            <li><em>“Single or paired-end reads?”</em>: <code class=\"language-plaintext highlighter-rouge\">Paired-end</code></li>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Mate pair 1”</em>: <code class=\"language-plaintext highlighter-rouge\">N701-Read1</code></li>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Mate pair 2”</em>: <code class=\"language-plaintext highlighter-rouge\">N701-Read2</code></li>\n            <li><em>“Specify the strandedness of the reads”</em>: <code class=\"language-plaintext highlighter-rouge\">Infer automatically (A)</code></li>\n            <li><em>“Type of single-cell protocol”</em>: <code class=\"language-plaintext highlighter-rouge\">DropSeq Single Cell protocol</code></li>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Transcript to gene map file”</em>: <code class=\"language-plaintext highlighter-rouge\">Map</code></li>\n            <li>In <em>“Extra output files”</em>:\n              <ul>\n                <li><i class=\"far fa-check-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-check</span> <code class=\"language-plaintext highlighter-rouge\">Salmon Quant log file</code></li>\n                <li>\n                  <p><i class=\"far fa-check-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-check</span> <code class=\"language-plaintext highlighter-rouge\">Features used by the CB classification and their counts at each cell level (--dumpFeatures)</code></p>\n                </li>\n                <li>Of course you are welcome to select more options and explore the output files (<i class=\"fas fa-exclamation-triangle\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">warning</span> warning: <em>“Per cell level parsimonious Umi graph (–dumpUmiGraph)”</em> will generate over 2 thousand single files), but for this tutorial you will only need to select those specified.</li>\n              </ul>\n            </li>\n            <li>In <em>“Advanced options”</em>:\n              <ul>\n                <li><em>“Dump cell v transcripts count matrix in MTX format”</em>: <i class=\"fas fa-toggle-on\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-toggle</span> <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n              </ul>\n            </li>\n          </ul>\n        </blockquote>\n      </blockquote>\n    </li>\n  </ol>\n</blockquote>\n\n<blockquote class=\"comment\">\n  <comment-title>What if I'm running a 10x sample?</comment-title>\n\n  <p>The main parameter that needs changing for a 10X Chromium sample is the ‘Protocol’ parameter of Alevin. Just select the correct 10x Chemistry there instead.</p>\n</blockquote>\n\n<blockquote class=\"comment\">\n  <comment-title>Alevin file names</comment-title>\n\n  <p>You will notice that the names of the output files of Alevin are written in a certain convention, mentioning which tool was used and on which files, for example: <em>“Alevin on data X, data Y, and others: whitelist”</em>. Remember that you can always rename the files if you wish! For simplicity, when we refer to those files in the tutorial, we skip the information about tool and only use the second part of the name - in this case it would be simply <em>“whitelist”</em>.</p>\n</blockquote>\n\n<p>This tool will take a while to run. Alevin produces many file outputs, not all of which we’ll use. You can refer to the <a href=\"https://salmon.readthedocs.io/en/latest/alevin.html\">Alevin documentation</a> if you’re curious what they all are, but we’re most interested in is:</p>\n\n<ul>\n  <li>the matrix itself (<em>per-cell gene-count matrix (MTX)</em> - the count by gene and cell)</li>\n  <li>the row (cell/ barcode) identifiers (<em>row index (CB-ids)</em>) and</li>\n  <li>the column (gene) labels (<em>column headers (gene-ids)</em>).</li>\n</ul>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>After you’ve run Alevin, <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> look through all the different files. Can you find:</p>\n  <ol>\n    <li>The Mapping Rate?</li>\n    <li>How many cells are present in the matrix output?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>Inspect <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> the file <i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>Salmon log file</em>. You can see the mapping rate is a paltry <code class=\"language-plaintext highlighter-rouge\">25.45%</code>. This is a terrible mapping rate. Why might this be? Remember this was downsampled, and specifically by taking only the last 400,000 reads of the FASTQ file. The overall mapping rate of the file is more like 50%, which is still quite poor, but for early Drop-Seq samples and single-cell data in general, you might expect a slightly poorer mapping rate. 10x samples are much better these days! This is real data, not test data, after all!</li>\n      <li>Inspect <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> the file <i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>row index (CB-ids)</em>, and you can see it has <code class=\"language-plaintext highlighter-rouge\">2163</code> lines. The rows refer to the cells in the cell x gene matrix. According to this (rough) estimate, your sample has 2163 cells in it!</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<blockquote class=\"warning\">\n  <warning-title>Choose the appropriate input going forward!</warning-title>\n  <p>Make certain to use <strong>per-cell gene-count matrix (MTX)</strong> file going forward.</p>\n</blockquote>\n\n<p><i class=\"far fa-thumbs-up\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">congratulations</span> Congratulations - you’ve made an expression matrix! We could almost stop here. But it’s sensible to do some basic QC, and one of the things we can do is look at a barcode rank plot.</p>\n\n<h1 id=\"basic-qc\">Basic QC</h1>\n\n<p>The question we’re looking to answer here, is: “do we mostly have a single cell per droplet”? That’s what experimenters are normally aiming for, but it’s not entirely straightforward to get exactly one cell per droplet. Sometimes almost no cells make it into droplets, other times we have too many cells in each droplet. At a minimum, we should easily be able to distinguish droplets with cells from those without.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Generate a raw barcode QC plot</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/droplet_barcode_plot/_dropletBarcodePlot/1.6.1+galaxy2\" title=\"Droplet barcode rank plot tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Droplet barcode rank plot</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.6.1+galaxy2)</span> with the following parameters:\n      <ul>\n        <li><em>“Input MTX-format matrix?”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“A two-column tab-delimited file, with barcodes in the first column and frequencies in the second”</em>: Output of Alevin <code class=\"language-plaintext highlighter-rouge\">raw CB classification frequencies</code></li>\n        <li><em>“Label to place in plot title”</em>: <code class=\"language-plaintext highlighter-rouge\">Barcode rank plot (raw barcode frequencies)</code></li>\n      </ul>\n    </li>\n    <li>Rename <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the image output <code class=\"language-plaintext highlighter-rouge\">Barcode Plot - raw barcode frequencies</code></li>\n  </ol>\n</blockquote>\n\n<figure id=\"figure-1\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-raw_barcodes-400k.png\" alt=\"raw droplet barcode plots-400k. \" width=\"1000\" height=\"600\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-raw_barcodes-400k.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 1</strong>:</span> 400k subsample raw</figcaption></figure>\n\n<p>Now, the image generated here (400k) isn’t the most informative - but you are dealing with a fraction of the reads! If you run the total sample (so identical steps above, but with significantly more time!) you’d get the image below.</p>\n\n<figure id=\"figure-2\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-raw_barcodes-total.png\" alt=\"raw droplet barcode plots-total. \" width=\"1000\" height=\"600\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-raw_barcodes-total.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 2</strong>:</span> Total sample - 32,579,453 reads - raw</figcaption></figure>\n\n<p>This is our own formulation of the barcode plot based on a <a href=\"https://github.com/COMBINE-lab/salmon/issues/362#issuecomment-490160480\">discussion</a> we had with community members. The left hand plots with the smooth lines are the main plots, showing the UMI counts for individual cell barcodes ranked from high to low. We expect a sharp drop-off between cell-containing droplets and ones that are empty or contain only cell debris. Now, this data is not an ideal dataset, so for perspective, in an ideal world with a very clean 10x run, data will look a bit more like the following taken from the lung atlas (see the <a href=\"https://www.ebi.ac.uk/gxa/sc/experiments/E-MTAB-6653/results/tsne\">study in Single Cell Expression Atlas</a> and the <a href=\"https://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-6653/\">project submission</a>).</p>\n\n<figure id=\"figure-3\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-lung-atlas-barcodes-raw.png\" alt=\"raw droplet barcode plots - lung atlas. \" width=\"1000\" height=\"600\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-lung-atlas-barcodes-raw.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 3</strong>:</span> Pretty data - raw</figcaption></figure>\n\n<p>In that plot, you can see the clearer ‘knee’ bend, showing the cut-off between empty droplets and cell-containing droplets.</p>\n\n<p>The right hand plots are density plots from the first one, and the thresholds are generated either using <a href=\"https://bioconductor.org/packages/release/bioc/html/DropletUtils.html\">dropletUtils</a> or by the method described in the discussion mentioned above. We could use any of these thresholds to select cells, assuming that anything with fewer counts is not a valid cell. By default, Alevin does something similar, and we can learn something about that by plotting just the barcodes Alevin retains.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Generate Alevin's barcode QC plot</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/droplet_barcode_plot/_dropletBarcodePlot/1.6.1+galaxy2\" title=\"Droplet barcode rank plot tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Droplet barcode rank plot</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.6.1+galaxy2)</span> with the following parameters:\n      <ul>\n        <li><em>“Input MTX-format matrix?”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        <li><em>“Matrix-market format matrix file, with cells by column (overrides –barcode-frequencies if supplied)”</em>: <code class=\"language-plaintext highlighter-rouge\">per-cell gene-count matrix (MTX)</code></li>\n        <li><em>“For use with –mtx-matrix: force interpretation of matrix to assume cells are by row, rather than by column (default)”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        <li><em>“Label to place in plot title”</em>: <code class=\"language-plaintext highlighter-rouge\">Barcode rank plot (Alevin-processed)</code></li>\n      </ul>\n    </li>\n    <li>Rename <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the image output <code class=\"language-plaintext highlighter-rouge\">Barcode Plot - Alevin processed barcodes</code></li>\n  </ol>\n</blockquote>\n\n<figure id=\"figure-4\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-alevin-barcodes-400k.png\" alt=\"raw droplet barcode plots - 400k. \" width=\"1000\" height=\"600\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-alevin-barcodes-400k.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 4</strong>:</span> 400k subsample - Alevin processed</figcaption></figure>\n\n<p>And the full sample looks like:</p>\n\n<figure id=\"figure-5\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-alevin-barcodes-total.png\" alt=\"raw droplet barcode plots - total. \" width=\"1000\" height=\"600\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-alevin-barcodes-total.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 5</strong>:</span> Total sample - 32,579,453 reads - Alevin processed</figcaption></figure>\n\n<p>And to round this off, here’s the lung atlas plot.</p>\n\n<figure id=\"figure-6\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-alevin-barcodes-lung.png\" alt=\"raw droplet barcode plots - total. \" width=\"1000\" height=\"600\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-alevin-barcodes-lung.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 6</strong>:</span> Pretty data - Alevin processed</figcaption></figure>\n\n<p>You should see a completely vertical drop-off where Alevin has trunctated the distribution (after excluding any cell barcode that had &lt;10 UMI, Alevin then chose a threshold based off the curve and removed all barcodes with fewer UMIs).</p>\n\n<p>In experiments with relatively simple characteristics, this ‘knee detection’ method works relatively well. But some populations (such as our sample!) present difficulties. For instance, sub-populations of small cells may not be distinguished from empty droplets based purely on counts by barcode. Some libraries produce multiple ‘knees’ for multiple sub-populations. The <a href=\"https://genomebiology.biomedcentral.com/articles/10.1186/s13059-019-1662-y\">emptyDrops</a> method has become a popular way of dealing with this. emptyDrops still retains barcodes with very high counts, but also adds in barcodes that can be statistically distinguished from the ambient profiles, even if total counts are similar. In order to ultimately run emptyDrops (or indeed, whatever tool you like that accomplishes biologically relevant thresholding), we first need to re-run Alevin, but prevent it from applying its own less than ideal thresholds.</p>\n\n<p>To use emptyDrops effectively, we need to go back and re-run Alevin, stopping it from applying it’s own thresholds. Click the re-run icon <i class=\"fas fa-redo\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-refresh</span> on any Alevin output in your history, because almost every parameter is the same as before, except you need to change the following:</p>\n\n<h2 id=\"generate-an-unprocessed-matrix-in-a-usable-format\">Generate an unprocessed matrix in a usable format</h2>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Stopping Alevin from thresholding</hands-on-title>\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/alevin/alevin/1.10.1+galaxy0\" title=\"Alevin tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Alevin</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.10.1+galaxy0)</span> (Click re-run on the last Alevin output)\n      <ul>\n        <li><em>“Advanced options”</em></li>\n        <li><em>“Fraction of cellular barcodes to keep”</em>: ‘1’ - i.e. keep them all!</li>\n        <li><em>“Minimum frequency for a barcode to be considered”</em>: ‘3’ - This will only remove cell barcodes with a frequency of less than 3, a low bar to pass but useful way of avoiding processing a bunch of almost certainly empty barcodes</li>\n      </ul>\n    </li>\n  </ol>\n\n  <!--SNIPPET-->\n  <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-re-running-a-tool\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-re-running-a-tool\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Re-running a tool</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ol>   <li><strong>Expand</strong> one of the output datasets of the tool (by clicking on it)</li>   <li><strong>Click</strong> re-run <i class=\"fas fa-redo\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-refresh</span> the tool</li> </ol>   <p>This is useful if you want to run the tool again but with slightly different paramters, or if you just want to check which parameter setting you used.</p> </blockquote>\n  <p><!--END_SNIPPET--></p>\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>How many cells are in the output now?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li><code class=\"language-plaintext highlighter-rouge\">22952</code> cells are in the quants_mat_rows now! Far more than the Alevin-filtered <code class=\"language-plaintext highlighter-rouge\">2163</code>. This needs some serious filtering with EmptyDrops!</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<p>Alevin outputs MTX format, which we can pass to the dropletUtils package and run emptyDrops. Unfortunately the matrix is in the wrong orientation for tools expecting files like those produced by 10X software (which dropletUtils does). We need to ‘transform’ the matrix such that cells are in columns and genes are in rows.</p>\n\n<blockquote class=\"warning\">\n  <warning-title>Be careful!</warning-title>\n  <p>Don’t mix up files from the different Alevin runs! Use the later run, which has higher numbers in the history!</p>\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Transform matrix</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/salmon_kallisto_mtx_to_10x/_salmon_kallisto_mtx_to_10x/0.0.1+galaxy6\" title=\"salmonKallistoMtxTo10x tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>salmonKallistoMtxTo10x</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.0.1+galaxy6)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“.mtx-format matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">per-cell gene-count matrix (MTX)</code> (output of <strong>Alevin</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Tab-delimited genes file”</em>: <code class=\"language-plaintext highlighter-rouge\">column headers (gene-ids)</code> (output of <strong>Alevin</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Tab-delimited barcodes file”</em>: <code class=\"language-plaintext highlighter-rouge\">row index (CB-ids)</code> (output of <strong>Alevin</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n      </ul>\n    </li>\n    <li>Rename <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> ‘salmonKallistoMtxTo10x….:genes’ to <code class=\"language-plaintext highlighter-rouge\">Gene table</code></li>\n    <li>Rename <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> ‘salmonKallistoMtxTo10x….:barcodes’ to <code class=\"language-plaintext highlighter-rouge\">Barcode table</code></li>\n    <li>Rename <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> ‘salmonKallistoMtxTo10x….:matrix’ to <code class=\"language-plaintext highlighter-rouge\">Matrix table</code></li>\n  </ol>\n</blockquote>\n\n<p>The output is a matrix in the correct orientation for the rest of our tools. However, our matrix is looking a bit sparse - for instance, click on <code class=\"language-plaintext highlighter-rouge\">Gene table</code>. I don’t know about you, but I’d struggle to have a good biological discussion using only Ensembl gene_ids! What I’d really like is the more understandable ‘GAPDH’ or other gene acronym, as well as information on mitochondrial genes so that I can assess if my cells were stressed out or not. In order to prepare our data for emptyDrops, we’re going to combine this information into an object, and it’s easiest to add in that information now.</p>\n\n<h2 id=\"adding-in-gene-metadata\">Adding in Gene metadata</h2>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>Where can we find this gene information?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <p>Our old friend the GTF file!</p>\n\n  </blockquote>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>Which of the ‘attributes’ in the last column of that file contains the gene acronym?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <p>gene_name</p>\n\n  </blockquote>\n\n</blockquote>\n\n<p>We’re now going to re-run <i class=\"fas fa-redo\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-refresh</span> the tool that extracts information from our GTF file.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Generate gene information</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/gtf2gene_list/_ensembl_gtf2gene_list/1.52.0+galaxy0\" title=\"GTF2GeneList tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>GTF2GeneList</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.52.0+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><em>“Feature type for which to derive annotation”</em>: <code class=\"language-plaintext highlighter-rouge\">gene</code></li>\n        <li><em>“Field to place first in output table”</em>: <code class=\"language-plaintext highlighter-rouge\">gene_id</code></li>\n        <li><em>“Suppress header line in output?”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        <li><em>“Comma-separated list of field names to extract from the GTF (default: use all fields)”</em>: <code class=\"language-plaintext highlighter-rouge\">gene_id,gene_name,mito</code></li>\n        <li><em>“Append version to transcript identifiers?”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        <li><em>“Flag mitochondrial features?”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code> - note, this will auto-fill a bunch of acronyms for searching in the GTF for mitochondrial associated genes. This is good!</li>\n        <li><em>“Filter the cDNA file to match the annotations?”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code> - we don’t need to, we’re done with the FASTA!</li>\n      </ul>\n    </li>\n    <li>Check that the output file type is <code class=\"language-plaintext highlighter-rouge\">tabular</code>. If not, change the file type by clicking the ‘Edit attributes’<i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> on the dataset in the history (as if you were renaming the file.) Then click <code class=\"language-plaintext highlighter-rouge\">Datatypes</code> and type in <code class=\"language-plaintext highlighter-rouge\">tabular</code>. Click <code class=\"language-plaintext highlighter-rouge\">Change datatype</code>.)</li>\n    <li>Rename <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the annotation table to <code class=\"language-plaintext highlighter-rouge\">Gene Information</code></li>\n  </ol>\n</blockquote>\n\n<p>Inspect <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> the <strong>Gene Information</strong> object in the history. Now you have made a new key for gene_id, with gene name and a column of mitochondrial information (false = not mitochondrial, true = mitochondrial). We need to add this information into the salmonKallistoMtxTo10x output ‘Gene table’. But we need to keep ‘Gene table’ in the same order, since it is referenced in the ‘Matrix table’ by row.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Combine MTX Gene Table with Gene Information</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"join1\" title=\"Join two Datasets tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Join two Datasets</strong></span> with the following parameters:\n      <ul>\n        <li><em>“Join”</em>: <code class=\"language-plaintext highlighter-rouge\">Gene Table</code></li>\n        <li><em>“Using column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 1</code></li>\n        <li><em>“with”</em>: <code class=\"language-plaintext highlighter-rouge\">Gene Information</code></li>\n        <li><em>“and column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 1</code></li>\n        <li><em>“Keep lines of first input that do not join with second input”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        <li><em>“Keep lines of first input that are incomplete”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        <li><em>“Fill empty columns”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n        <li><em>“Keep the header lines”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n      </ul>\n\n      <p>If you inspect <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> the object, you’ll see we have joined these tables and now have quite a few gene_id repeats. Let’s take those out, while keeping the order of the original ‘Gene Table’.</p>\n    </li>\n    <li><span class=\"tool\" data-tool=\"Cut1\" title=\"Cut columns from a table tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Cut columns from a table</strong></span> with the following parameters:\n      <ul>\n        <li><em>“Cut columns”</em>: <code class=\"language-plaintext highlighter-rouge\">c1,c4,c5</code></li>\n        <li><em>“Delimited by”</em>: <code class=\"language-plaintext highlighter-rouge\">Tab</code></li>\n        <li><em>“From”</em>: output of <strong>Join two Datasets</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n      </ul>\n    </li>\n    <li>Rename output <code class=\"language-plaintext highlighter-rouge\">Annotated Gene Table</code></li>\n  </ol>\n</blockquote>\n\n<p>Inspect <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> your <code class=\"language-plaintext highlighter-rouge\">Annotated Gene Table</code>. That’s more like it! You now have <code class=\"language-plaintext highlighter-rouge\">gene_id</code>, <code class=\"language-plaintext highlighter-rouge\">gene_name</code>, and <code class=\"language-plaintext highlighter-rouge\">mito</code>. Now let’s get back to your journey to emptyDrops and sophisticated thresholding of empty droplets!</p>\n\n<h1 id=\"emptydrops\">emptyDrops</h1>\n\n<p>emptyDrops <span class=\"citation\"><a href=\"#article-emptyDrops\">Lun <i>et al.</i> 2019</a></span> works with a specific form of R object called a SingleCellExperiment. We need to convert our transformed MTX files into that form, using the DropletUtils Read10x tool:</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Converting to SingleCellExperiment format</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/dropletutils_read_10x/dropletutils_read_10x/1.0.4+galaxy0\" title=\"DropletUtils Read10x tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>DropletUtils Read10x</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.0.4+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Expression matrix in sparse matrix format (.mtx)”</em>: <code class=\"language-plaintext highlighter-rouge\">Matrix table</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Gene Table”</em>: <code class=\"language-plaintext highlighter-rouge\">Annotated Gene Table</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Barcode/cell table”</em>: <code class=\"language-plaintext highlighter-rouge\">Barcode table</code></li>\n        <li><em>“Should metadata file be added?”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n      </ul>\n    </li>\n    <li>Rename <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> output: <code class=\"language-plaintext highlighter-rouge\">SCE Object</code></li>\n  </ol>\n</blockquote>\n\n<p>Fantastic! Now that our matrix is combined into an object, specifically the SingleCellExperiment format, we can now run emptyDrops! Let’s get rid of those background droplets containing no cells!</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Emptydrops</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/dropletutils_empty_drops/dropletutils_empty_drops/1.0.4+galaxy0\" title=\"DropletUtils emptyDrops tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>DropletUtils emptyDrops</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.0.4+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“SingleCellExperiment rdata object”</em>: <code class=\"language-plaintext highlighter-rouge\">SCE Object</code></li>\n        <li><em>“Should barcodes estimated to have no cells be removed from the output object?”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n      </ul>\n    </li>\n    <li>\n      <p>Rename <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <code class=\"language-plaintext highlighter-rouge\">serialised SingleCellExperiment</code> output as <code class=\"language-plaintext highlighter-rouge\">Emptied-Object</code></p>\n    </li>\n    <li>Rename <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <code class=\"language-plaintext highlighter-rouge\">tabular output</code> as <code class=\"language-plaintext highlighter-rouge\">Emptied-Tabular Output</code></li>\n  </ol>\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>How many cell barcodes remain after the emptyDrops treatment? Why might that be?</p>\n\n  <blockquote class=\"tip\">\n    <tip-title>Hint</tip-title>\n    <p>If you click on the <code class=\"language-plaintext highlighter-rouge\">Emptied-Object</code> in the <i class=\"fas fa-columns\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-history</span> history, the text in that window says <code class=\"language-plaintext highlighter-rouge\">38 barcodes</code> or something similar to that - there is an element of random in the algorithm, so yours might differ slightly. Why is this so low?? And why might the number be different?\nConsider…is this a complete set of data?</p>\n  </blockquote>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <p>Remember this is a subsampled dataset. If you look carefully at the parameters of emptyDrops, you’ll see it set a minimum threshold at 100 UMI. If you look at the barcode plots above for the 400k read sample, you’ll see this is far too stringent for this subsampled data! To satisfy your curiosity, this minimum threshold would yield <code class=\"language-plaintext highlighter-rouge\">4332</code> barcodes for the total sample. Also, the number may vary slightly as the output depends on a large number of random iterations.</p>\n\n  </blockquote>\n\n</blockquote>\n\n<p>We will nevertheless proceed with your majestic annotated expression matrix of 38 cells, ready to go for further processing and analysis! However, the next tutorials we will link to use a tool suite called Scanpy <span class=\"citation\"><a href=\"#Wolf2018\">Wolf <i>et al.</i> 2018</a></span>. You need to convert this SingleCellExperiment object into a format called <code class=\"language-plaintext highlighter-rouge\">annData</code>, which is a variant of a file format called <code class=\"language-plaintext highlighter-rouge\">hdf5</code>.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Converting to AnnData format</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/sceasy_convert/sceasy_convert/0.0.7+galaxy2\" title=\"SCEasy Converter tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>SCEasy Converter</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.0.7+galaxy2)</span> with the following parameters:\n      <ul>\n        <li><em>“Convert From / To”</em>: <code class=\"language-plaintext highlighter-rouge\">SingleCellExperiment to AnnData</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in sce,rds,rdata.sce format”</em>: <code class=\"language-plaintext highlighter-rouge\">Emptied-Object</code> (if the dataset does not show up in the corresponding input field or displays as ‘unavailable’, don’t worry - just drag the dataset from the history panel and drop into the input field)</li>\n      </ul>\n    </li>\n    <li>Rename <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> output <code class=\"language-plaintext highlighter-rouge\">N701-400k-AnnData</code></li>\n  </ol>\n\n</blockquote>\n\n<p><i class=\"far fa-thumbs-up\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">congratulations</span> Congrats! Your object is ready to for the scanpy pipeline! You can can check your work against the <a href=\"https://usegalaxy.eu/u/j.jakiela/h/generating-a-single-cell-matrix-alevin\">example history</a>. You can also compare how the subsampled datasets you’ve generated compare with the <a href=\"https://singlecell.usegalaxy.eu/u/j.jakiela/h/generating-a-single-cell-matrix-using-alevin---n701-total-sample\">total sample</a>.</p>\n\n<p>However, it may be that you want to combine this object with others like it, for instance, maybe you ran 5 samples, and you are starting with 10 FASTQ files…</p>\n\n<h1 id=\"analysing-multiple-fastq-files\">Analysing multiple FASTQ files</h1>\n\n<p>This sample was originally one of seven. So to run the other <a href=\"https://humancellatlas.usegalaxy.eu/u/wendi.bacon.training/h/alevin-tutorial---all-samples---400k\">12 downsampled FASTQ files</a>, you can use a <a href=\"https://usegalaxy.eu/u/j.jakiela/w/alevin-sc-matrix\">workflow</a> and run them all at once! All these samples are going to take a while, so go and have several cups of tea… Or, better yet, I have <a href=\"https://usegalaxy.eu/u/j.jakiela/h/alevin-workflow---all-samples-downsampled-fastq\">run them myself</a>. To combine the resultant files into a single matrix, you can look at the next tutorial in this case study: <a href=\"/training-material/topics/single-cell/tutorials/scrna-case_alevin-combine-datasets/tutorial.html\">Combining datasets after pre-processing</a></p>\n\n<h1 id=\"mitochondrial-flagging\">Mitochondrial flagging</h1>\n\n<p>We have assumed you will be combining multiple files - but if that’s not the case, you’ll need to perform this step to turn your column of <code class=\"language-plaintext highlighter-rouge\">true</code> and <code class=\"language-plaintext highlighter-rouge\">false</code> labelling the mitochondrial genes into some metrics telling you the % of mitochondrial genes in each cell. You can follow that step here: <a href=\"/training-material/topics/single-cell/tutorials/scrna-case_alevin-combine-datasets/tutorial.html#mitochondrial-reads\">Mitochondrial calculations</a>.</p>\n\n<h1 id=\"conclusion\">Conclusion</h1>\n\n<figure id=\"figure-7\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-alevin-part1workflow.png\" alt=\"Workflow Part 1. \" width=\"1070\" height=\"884\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-alevin-part1workflow.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 7</strong>:</span> Workflow  - Steps 1-3</figcaption></figure>\n\n<p>We have:</p>\n\n<ul>\n  <li>Examined raw read data, annotations and necessary input files for quantification.</li>\n  <li>Run Alevin in two different parameterisations, both allowing Alevin to make its own calls on what constitutes empty droplets, and applying emptyDrops instead.</li>\n  <li>Deployed barcode rank plots as a way of quickly assessing the signal present in droplet datasets.</li>\n  <li>Applied the necessary conversion to pass these data to downstream processes.</li>\n</ul>\n\n<!--SNIPPET-->\n<blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-how-can-i-talk-with-other-users\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-how-can-i-talk-with-other-users\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: How can I talk with other users?</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p><i class=\"far fa-comments\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">feedback</span> To discuss with like-minded scientists, join our <a href=\"http://gxy.io/gtn-slack\">Galaxy Training Network chatspace in Slack</a> and discuss with fellow users of Galaxy single cell analysis tools on <a href=\"https://gtnsmrgsbord.slack.com/archives/C06PBRR40D7\">#single-cell-users</a></p>   <p>We also post new tutorials / workflows there from time to time, as well as any other news.</p>   <p><i class=\"far fa-hand-point-right\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">point-right</span> If you’d like to contribute ideas, requests or feedback as part of the wider community building single-cell and spatial resources within Galaxy, you can also join our <a href=\"https://galaxyproject.org/community/sig/singlecell/\">Single cell &amp; sPatial Omics Community of Practice</a>.</p>   <p><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> You can request tools here on our <a href=\"https://docs.google.com/spreadsheets/d/15hqgqA-RMDhXR-ylKhRF-Dab9Ij2arYSKiEVoPl2df4/edit?usp=sharing\">Single Cell and Spatial Omics Community Tool Request Spreadsheet</a></p> </blockquote>\n<p><!--END_SNIPPET--></p>\n","<p>Este tutorial te ayudará a pasar de datos crudos de secuenciación en archivos FASTQ a una matriz de datos en formato AnnData donde cada célula es una fila y cada gen es una columna. Pero, ¿Qué es una matriz de datos y cuál es el formato AnnData? Lo averiguaremos a su debido tiempo. Enfatizamos que este es el primer paso para procesar datos de secuenciación de células únicas para poder realizar su análisis.</p>\n\n<p>De momento, en tus archivos de secuenciación tienes un montón de cadenas del tipo <code class=\"language-plaintext highlighter-rouge\">ATGGGCTT</code>, etc. y lo que necesitas saber es cuántas células tienes y qué genes aparecen en ellas. En la segunda parte de este tutorial abordaremos la combinación de archivos FASTQ y el cómo añadir metadatos (por ejemplo, SEXO o GENOTIPO) para análisis posteriores. Estos son los pasos que requieren más recursos computacionales en los análisis de células únicas, ya que partimos de cientos de millones de lecturas, cada una de ellas con cuatro líneas de texto. Posteriormente, en el análisis, estos datos se convertirán en simples conteos de genes, por ejemplo ‘La célula A tiene 4 GAPDHs’ (‘Cell A has 4 GAPDHs’), que es mucho más sencillo de almacenar.</p>\n\n<p>Debido a la enorme cantidad de datos, hemos reducido la resolución de los archivos FASTQ para poder acelerar el análisis. Una vez que hemos aclarado este punto, todavía tienes que mapear enormes cantidades de lecturas al inmenso genoma murino, así que ¡ve por una taza de café y prepárate para iniciar el análisis!</p>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n  <p>En este tutorial abordaremos:</p>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#generar-una-matriz\" id=\"markdown-toc-generar-una-matriz\">Generar una matriz</a>    <ol>\n      <li><a href=\"#obtener-datos\" id=\"markdown-toc-obtener-datos\">Obtener datos</a></li>\n      <li><a href=\"#generar-un-mapa-de-correspondencia-de-transcritos-a-genes\" id=\"markdown-toc-generar-un-mapa-de-correspondencia-de-transcritos-a-genes\">Generar un mapa de correspondencia de transcritos a genes</a></li>\n      <li><a href=\"#generar-el-índice-de-un-transcriptoma-y-cuantificar\" id=\"markdown-toc-generar-el-índice-de-un-transcriptoma-y-cuantificar\">Generar el índice de un transcriptoma y cuantificar</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#control-de-calidad-básico\" id=\"markdown-toc-control-de-calidad-básico\">Control de calidad básico</a>    <ol>\n      <li><a href=\"#generar-una-matriz-sin-procesamiento-en-un-formato-utilizable\" id=\"markdown-toc-generar-una-matriz-sin-procesamiento-en-un-formato-utilizable\">Generar una matriz sin procesamiento en un formato utilizable</a></li>\n      <li><a href=\"#añadir-metadatos-de-genes\" id=\"markdown-toc-añadir-metadatos-de-genes\">Añadir metadatos de genes</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#emptydrops\" id=\"markdown-toc-emptydrops\">emptyDrops</a></li>\n  <li><a href=\"#combinar-archivos-fastq\" id=\"markdown-toc-combinar-archivos-fastq\">Combinar archivos FASTQ</a>    <ol>\n      <li><a href=\"#datos\" id=\"markdown-toc-datos\">Datos</a></li>\n      <li><a href=\"#concatenación-de-objetos\" id=\"markdown-toc-concatenación-de-objetos\">Concatenación de objetos</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#añadir-el-lote-de-metadatos-batch-metadata\" id=\"markdown-toc-añadir-el-lote-de-metadatos-batch-metadata\">Añadir el lote de metadatos (batch metadata)</a></li>\n  <li><a href=\"#lecturas-mitocondriales\" id=\"markdown-toc-lecturas-mitocondriales\">Lecturas mitocondriales</a></li>\n  <li><a href=\"#extraer-datos-de-secuenciación-de-arn-de-células-únicas-desde-bases-de-datos-públicas\" id=\"markdown-toc-extraer-datos-de-secuenciación-de-arn-de-células-únicas-desde-bases-de-datos-públicas\">Extraer datos de secuenciación de ARN de células únicas desde bases de datos públicas</a></li>\n  <li><a href=\"#conclusion\" id=\"markdown-toc-conclusion\">Conclusion</a></li>\n</ol>\n\n</blockquote>\n\n<h1 id=\"generar-una-matriz\">Generar una matriz</h1>\n\n<p>En esta sección te mostraremos los principios de la fase inicial del análisis de Secuenciación de ARN de células únicas, que se basa en generar mediciones de expresión en una matriz. Por simplicidad, nos referiremos a este análisis por sus siglas en inglés scRNA-Seq (single-cell RNA-Seq). Nos concentramos en la metodología basada en goteo (en lugar de las metodologías basadas en placas), ya que es el proceso con más diferencias con respecto a los enfoques convencionales desarrollados para secuenciación de ARN general.</p>\n\n<p>Los datos provenientes de metodologías de goteo están constituidos por tres componentes: códigos de barras, identificadores únicos moleculares (Unique molecular Identifier, o UMIs por sus siglas en inglés) y lecturas de ADN codificante (proveniente de ADN complementario o cDNA). Para poder generar cuantificaciones a nivel celula necesitaremos:</p>\n\n<ul>\n  <li>Procesar los códigos de barras, identificar cuáles corresponden a células ‘reales’, cuáles son meros artefactos, y posiblemente corregir códigos de barras que pudiesen ser producto de errores de secuenciación por medio de comparaciones con secuencias de mayor frecuencia.</li>\n  <li>Mapear secuencias biológicas a su genoma o transcriptoma de referencia.</li>\n  <li>Eliminar duplicados usando UMIs.</li>\n</ul>\n\n<p>Este solía ser un proceso complejo que involucraba múltiples algoritmos, o que se realizaba con métodos dedicados a tecnologías específicas (como la herramienta ‘Cellranger’ para 10X); pero ahora el proceso es más simple gracias al surgimiento de otros métodos. En el momento de seleccionar una metodología para tu proyecto podrías considerar las siguientes herramientas:</p>\n\n<ul>\n  <li><a href=\"https://github.com/alexdobin/STAR\">STARsolo</a> - una variante del popular método de alineamiento de genoma ‘STAR’ que es específica para el análisis de datos de secuenciación de ARN de células únicas basados en técnicas de goteos (dscRNA-Seq). Produce resultados muy cercanos a los de Cellranger (que a su vez utiliza STAR en parte de sus procesos).</li>\n  <li><a href=\"https://www.kallistobus.tools/\">Kallisto/ bustools</a> - desarrollado por los creadores del método de cuantificación de transcriptoma, Kallisto.</li>\n  <li><a href=\"https://salmon.readthedocs.io/en/latest/alevin.html\">Alevin</a> - otro método de análisis de transcriptoma desarrollado por los autores de la herramienta ‘Salmon’.</li>\n</ul>\n\n<p>Utilizaremos Alevin <span class=\"citation\"><a href=\"#article-Alevin\">Srivastava <i>et al.</i> 2019</a></span> con propósitos demostrativos, sin embargo no avalamos ningún método en particular.</p>\n\n<blockquote class=\"comment\">\n  <comment-title>Comentario</comment-title>\n  <ul>\n    <li>Notas sobre la traducción y uso de términos técnicos\nEn este tutorial manejaremos algunos términos en el idioma original ya que simplificará la búsqueda posterior de información sobre el tema. Estas notas aparecerán en este tipo de recuadros y los términos estarán listados con la viñeta “•”.</li>\n    <li>scRNA-Seq,\tsecuenciación de ARN de células únicas</li>\n    <li>dscRNA-Sea, secuenciación de ARN de células únicas</li>\n    <li>basados en técnicas de goteos</li>\n    <li>RNA-Seq,\tSecuenciación de ARN</li>\n    <li>UMIs,\t\tIdentificadores únicos moleculares</li>\n  </ul>\n</blockquote>\n\n<h2 id=\"obtener-datos\">Obtener datos</h2>\n\n<p>Hemos puesto a tu disposición un conjunto de datos de muestra para que practiques con ellos. Estos datos son un subconjunto de lecturas de datos provenientes de ratones con restricción de crecimiento fetal <span class=\"citation\"><a href=\"#Bacon2018\">Bacon <i>et al.</i> 2018</a></span> (ver <a href=\"https://www.ebi.ac.uk/gxa/sc/experiments/E-MTAB-6945/results/tsne\">aquí</a> el estudio de células únicas disponible en la base de datos ‘Expression Atlas’ y <a href=\"https://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-6945/\">aquí</a> la remisión del proyecto a la plataforma ArrayExpress).</p>\n\n<p>Utilizamos la tecnología Drop-seq para este estudio. Sin embargo, el análisis que abordaremos en este tutorial es casi idéntico al que se realiza al utilizar la tecnología 10x. Estos datos no han sido curados meticulosamente, los datos del tutorial son algo caóticos ya que provienen de un experimento real. Necesitan filtrado urgentemente ya que contienen ARNs que le agregan ruido de fondo, sin embargo, te darán la oportunidad de practicar un análisis como si fuera el tuyo propio.</p>\n\n<p>Puedes descargar las lecturas de muestra y su anotación asociada desde el repositorio Zenodo. También puedes importar <a href=\"https://humancellatlas.usegalaxy.eu/u/wendi.bacon.training/h/input---pre-processing-with-alevin\">este historial de ejemplo</a>. ¿Cómo bajamos la resolución de estos archivos FASTQ? ¡Descubre aquí <a href=\"https://humancellatlas.usegalaxy.eu/u/wendi.bacon.training/h/pre-processing-with-alevin---part-1---how-to-downsample\">la historia</a> de cómo se llevó esto a cabo!\nAdicionalmente, necesitarás un transcriptoma (en formato FASTA) contra el cual podrás mapear tus lecturas, así como la información génica de cada transcrito (en un archivo tipo GTF). Adicionalmente, estos archivos están disponibles en el historial anteriormente mencionado, al igual que en los enlaces de Zenodo mostrados en la parte inferior de este párrafo, así que puede que tarden un buen rato en importarse. Puedes acceder a <a href=\"https://www.ensembl.org/info/data/ftp/index.html\">Ensembl si deseas bajar datos</a> para tu especie de interés.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Práctica: Cargar datos - Parte 1</hands-on-title>\n\n  <ol>\n    <li>Crear un historial nuevo para este tutorial</li>\n    <li>\n      <p>Importar la tabla de diseño experimental, las lecturas de secuenciación 1 y 2, y los archivos GTF y fasta desde <a href=\"https://zenodo.org/record/4574153\">Zenodo</a></p>\n\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/4574153/files/Experimental_Design.tabular\nhttps://zenodo.org/record/4574153/files/Mus_musculus.GRCm38.100.gtf.gff\nhttps://zenodo.org/record/4574153/files/Mus_musculus.GRCm38.cdna.all.fa.fasta\nhttps://zenodo.org/record/4574153/files/SLX-7632.TAAGGCGA.N701.s_1.r_1.fq-400k.fastq\nhttps://zenodo.org/record/4574153/files/SLX-7632.TAAGGCGA.N701.s_1.r_2.fq-400k.fastq\n</code></pre></div>      </div>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importación-por-medio-de-enlaces\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importación-por-medio-de-enlaces\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Consejo: Importación por medio de enlaces</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copia los enlaces</li>   <li>     <p>Abre el manejador de carga de datos de Galaxy (<i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> en la parte superior derecha del panel de herramientas)</p>   </li>   <li>Selecciona ‘Pegar/Traer datos’ <strong>Paste/Fetch Data</strong></li>   <li>     <p>Copia los enlaces en el campo de textos</p>   </li>   <li>     <p>Presiona ‘Iniciar’ <strong>Start</strong></p>   </li>   <li>     <p><strong>Close</strong> Cierra la ventana.</p>   </li>   <li>Galaxy utiliza los URLs como nombres de forma predeterminada , así que los tendrás que cambiar a algunos que sean más útiles o informativos. the window</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>Cambiar el nombre <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> de los conjuntos de datos</li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title>Preguntas</question-title>\n\n  <p>Dale un vistazo a los archivos que ahora están en tu historial.</p>\n  <ol>\n    <li>¿Cuál de los archivos FASTQ crees que contiene las secuencias de los códigos de barras?</li>\n    <li>Dada la metodología química que implica este estudio, ¿tienen las lecturas de códigos de barras/UMIs la longitud correcta?</li>\n    <li>¿A que se refiere el término ‘N701’?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title>Soluciones</solution-title>\n\n    <ol>\n      <li>La lectura 1 (SLX-7632.TAAGGCGA.N701.s_1.r_1.fq-400k)  contiene el código de barras de la célula y el UMI ya que es significativamente más corta (¡solo 20pb!), en comparación con r_2 que es la lectura más larga de transcrito. Cambiaremos de nombre a estos archivos y los llamaremos N701-Read1 y N701-Read2 para hacer más claro el análisis.</li>\n      <li>Puedes ver que la lectura 1 solo tiene 20pb de longitud, ya que el código de barras de Drop-Seq es de 12pb de longitud y el UMI de 8pb. ¡Esto es correcto! Pero ten precaución, la tecnología 10x Chromiun (y muchas otras) cambian sus reactivos (y longitudes de cebadores y adaptadores) con el paso del tiempo. En particular, ten esto en cuenta cuando accedas a datos públicos, verifica y asegurate de que estés utilizando los números correctos.</li>\n      <li>El término ‘N701’ se refiere al índice de la lectura. Esta muestra se tomó junto con otras seis, cada una de ellas se denotó con un índice Nextera (N70X). Posteriormente, esto te proporcionará información del lote del que provienen. Observa el archivo ‘Diseno experimental’ (‘Experimental design’), notarás que la muestra N701 proviene del timo de neonato macho tipo normal (‘wild-type’).</li>\n    </ol>\n  </blockquote>\n</blockquote>\n\n<h2 id=\"generar-un-mapa-de-correspondencia-de-transcritos-a-genes\">Generar un mapa de correspondencia de transcritos a genes</h2>\n\n<p>En el análisis de Secuenciación de ARN de células únicas tomamos por defecto la cuantificación a nivel génico, en lugar de a nivel transcrito. Esto significa que los niveles de expresión de una molécula de ARN con splicing alternativo son combinados con el propósito de generar valores a nivel génico. Las técnicas de scRNA-Seq basadas en goteo solo muestrean un extremo de cada transcrito, por tanto carecen de cobertura completa de moléculas, la cual es requerida para poder cuantificar con exactitud las diversas isoformas de los transcritos.</p>\n\n<p>Para poder generar las cuantificaciones a nivel génico con base en la cuantificación de transcriptoma, la herramienta Alevin y otras similares requieren de la conversión entre identificadores de transcritos e identificadores de genes. Podemos derivar una conversión transcritos-genes a partir de anotaciones génicas disponibles en plataformas de recursos genómicos como Ensembl. Los transcritos en este tipo de listas necesitan coincidir con los que usaremos posteriormente para construir un índice binario de transcriptoma. Si estás utilizando controles tipo ‘spike-in’ necesitarás añadirlos al transcriptoma y al mapeo de transcritos a genes.</p>\n\n<p>Notarás en tus datos de ejemplo que la anotación de referencia murina se obtuvo en formato GTF desde Ensembl. Esta anotación contiene genes, exones, transcritos y todo tipo de información adicional de las secuencias. Utilizaremos esta información para generar el mapeo de correspondencia transcrito/genes. Esto lo haremos por medio del traspaso de información a una herramienta que extrae exclusivamente los identificadores de transcrito que necesitamos.</p>\n\n<blockquote class=\"comment\">\n  <comment-title>Comentario</comment-title>\n  <p>Nota sobre la traducción y uso de términos técnicos</p>\n  <ul>\n    <li>Spike-in,\ttranscrito de ARN de cantidad y secuencia conocida utilizado para calibrar mediciones en ensayos de hibridación de ARN. Nos referiremos a este control con su nombre en el idioma inglés ya que su traducción no es utilizada comúnmente.</li>\n  </ul>\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title>Preguntas</question-title>\n\n  <p>¿Cuál de los ‘atributos’ en la última columna de los archivos GTF contiene los identificadores de transcrito y de gen?</p>\n\n  <blockquote class=\"tip\">\n    <tip-title>Una pequeña pista</tip-title>\n\n    <p>El archivo está organizado de tal modo que la última columna (con el nombre ‘Group’ en el encabezado) contiene una gran cantidad de información: attribute1 “información asociada con el atributo1”;attribute2 “información asociada con el atributo 2” etc.</p>\n  </blockquote>\n\n  <blockquote class=\"solution\">\n    <solution-title>Solución</solution-title>\n    <p>A gene_id y transcript_id les sigue “ensembl gene_id” y “ensembl transcript_id”</p>\n  </blockquote>\n</blockquote>\n\n<p>Ahora es el momento de analizar el archivo GTF utilizando el paquete de R <a href=\"https://bioconductor.org/packages/release/bioc/html/rtracklayer.html\">rtracklayer</a>. Este análisis proporcionará una tabla de conversión con un listado de identificadores de transcritos y sus genes correspondientes para hacer conteos. Adicionalmente, ya que generaremos nuestro propio índice binario (más sobre esto en secciones posteriores), también necesitaremos proporcionar nuestro archivo FASTA para que pueda ser filtrado y que al final solo contenga la información del transcriptoma que está contenida en el archivo GTF.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Práctica: Generar un archivo FASTA filtrado y un mapa de correspondencia de transcritos a genes</hands-on-title>\n\n  <ol>\n    <li>Ejecutar la herramienta GTF2GeneList <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/gtf2gene_list/_ensembl_gtf2gene_list/1.42.1+galaxy6\" title=\"GTF2GeneList tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>GTF2GeneList</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.42.1+galaxy6)</span> utilizando los siguiente parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Ensembl GTF file”</em>: <code class=\"language-plaintext highlighter-rouge\">GTF file in the history</code> <i class=\"fas fa-columns\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-history</span></li>\n        <li><em>“Feature type for which to derive annotation”</em>: <code class=\"language-plaintext highlighter-rouge\">transcript</code> (Tus secuencias provienen de secuenciación de transcriptoma, por tanto este es tu punto inicial)</li>\n        <li><em>“Field to place first in output table”</em>: <code class=\"language-plaintext highlighter-rouge\">transcript_id</code> (Esto da acceso a la columna que identificaste en la parte anterior)</li>\n        <li><em>“Suppress header line in output?”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code> (La siguiente herramienta (Alevin) no toma encabezados)</li>\n        <li><em>“Comma-separated list of field names to extract from the GTF (default: use all fields)”</em>: <code class=\"language-plaintext highlighter-rouge\">transcript_id,gene_id</code> (Esto hace que la primera columna sea transpript_id, y la segunda sea gene_id. Por tanto, tu clave puede convertir transcritos a genes)</li>\n        <li><em>“Append version to transcript identifiers?”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code> (Por lo general el archivo FASTA de Ensembl contiene esta información, y ya que necesitaremos que el transcriptoma en formato FASTA y la información de genes del archivo GTF trabajen en conjunto, necesitaremos añadir la información de uno al final del otro)</li>\n        <li><em>“Flag mitochondrial features?”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n        <li><em>“Filter a FASTA-format cDNA file to match annotations?”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“FASTA-format cDNA/transcript file”</em>: <code class=\"language-plaintext highlighter-rouge\">FASTA file in your history</code> <i class=\"fas fa-columns\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-history</span></li>\n        <li><em>“Annotation field to match with sequences”</em>: <code class=\"language-plaintext highlighter-rouge\">transcript_id</code></li>\n      </ul>\n    </li>\n    <li>\n      <p>Cambiar el nombre <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> de la tabla de anotación a <code class=\"language-plaintext highlighter-rouge\">Map</code></p>\n    </li>\n    <li>Cambiar el nombre <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> del archivo FASTA filtrado - no comprimido a <code class=\"language-plaintext highlighter-rouge\">Filtered FASTA</code></li>\n  </ol>\n</blockquote>\n\n<h2 id=\"generar-el-índice-de-un-transcriptoma-y-cuantificar\">Generar el índice de un transcriptoma y cuantificar</h2>\n\n<p>Alevin reduce a un solo proceso los pasos requeridos para realizar dscRNA-Seq. Dichas herramientas requieren comparar las secuencias de tu muestra a una referencia que contenga todas las secuencias probables de transcritos (un ‘transcriptoma). Esto contendrá las secuencias biológicas de los transcritos conocidos en una especie determinada, y quizás también contendrá secuencias técnicas como ‘spike ins’.</p>\n\n<blockquote class=\"details\">\n  <details-title>¿Cómo trabaja Alevin?</details-title>\n\n  <p>Alevin necesita convertir las secuencias de texto contenidas dentro del formato FASTA a algo con lo que pueda realizar búsquedas rápidamente dentro del transcriptoma, ese ‘algo’ es un archivo llamado ‘índice’ (‘index’). El índice es un archivo binario (un tipo de archivos optimizados para el uso de ordenadores y que no es legible ‘por humanos’), pero permite que Alevin realice búsquedas rápidas. El índice puede variar entre experimentos debido al tipo de secuencias técnicas y biológicas que necesitamos incluir en él, y ya que frecuentemente queremos utilizar las referencias más actualizadas, ya sea que provengan de Ensembl o NCBI, a menudo pudiésemos terminar reconstruyendo los índices. El generar estos índices requiere mucho tiempo. Échale un vistazo al archivo FASTA no comprimido para que veas cómo es la estructura inicial.</p>\n\n</blockquote>\n\n<p>Ahora tenemos:</p>\n\n<ul>\n  <li>Lecturas de códigos de barras/UMIs</li>\n  <li>Lecturas de cDNA</li>\n  <li>Mapeo de correspondencias de transcritos a genes</li>\n  <li>Archivo FASTA filtrado</li>\n</ul>\n\n<p>Ahora podemos ejecutar Alevin. Esta herramienta no aparecerá en las búsquedas dentro de algunas de las instancias públicas. Si esto sucede, haz click sobre la pestaña Single Cell en la parte izquierda de la pantalla y desplázate hacia abajo hasta encontrar la herramienta Alevin. Consejo: Si haces click sobre las herramientas (tools) dentro de la opción ‘tutorial’ de Galaxy siempre tendrás la versión correcta de la herramienta. En este caso: Galaxy Version 1.3.0+galaxy2 - debe ser la versión por defecto; si no lo es, haz click sobre ‘Versiones’ (‘Versions’) y escoge dicha versión.</p>\n\n<figure id=\"figure-1\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-tutorial-in-galaxy.png\" alt=\"Tutorial option in Galaxy. \" width=\"1513\" height=\"751\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-tutorial-in-galaxy.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figura 1</strong>:</span> La opción de tutorial está situada en la parte superior derecha de Galaxy</figcaption></figure>\n\n<figure id=\"figure-2\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-tutorial-option-filler.png\" alt=\"Accessing tools in the tutorial option within Galaxy. \" width=\"1910\" height=\"920\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-tutorial-option-filler.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figura 2</strong>:</span> Haz click sobre la herramienta en el tutorial de Galaxy</figcaption></figure>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Practica: Ejecutando Alevin</hands-on-title>\n\n  <ol>\n    <li>\n      <p><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/alevin/alevin/1.3.0+galaxy2\" title=\"Alevin tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Alevin</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.3.0+galaxy2)</span></p>\n\n      <blockquote class=\"question\">\n        <question-title>Preguntas</question-title>\n\n        <p>Intenta dar valores a los parámetros de Alevin utilizando lo que sabes por el momento.</p>\n\n        <blockquote class=\"tip\">\n          <tip-title>Sobre la direccionalidad de las cadenas de RNA (Strandness)</tip-title>\n\n          <p>La documentación sobre ‘Tipos de bibliotecas de fragmentos’ (‘Fragment Library Types‘) de de la herramienta salmón, el ejecutar el comando de Alevin (<a href=\"https://salmon.readthedocs.io/en/latest/library_type.html]\">salmon.readthedocs.io/en/latest/library_type.html</a> y <a href=\"https://salmon.readthedocs.io/en/latest/alevin.html\">salmon.readthedocs.io/en/latest/alevin.html</a>) nos serán de ayuda en este caso; aunque ten en cuenta que la imagen ahí se dibuja con el ARN 5’ en la parte superior, mientras que en este protocolo de scRNA-Seq el segmento polyA es capturado por su extremo 3’, y, por lo tanto, efectivamente la hebra inferior o inversa.)</p>\n        </blockquote>\n\n        <blockquote class=\"solution\">\n          <solution-title>Solución: valores de los parámetros</solution-title>\n          <ul>\n            <li><em>“Select a reference transcriptome from your history or use a built-in index?”</em>: <code class=\"language-plaintext highlighter-rouge\">Use one from the history</code>\n              <ul>\n                <li>Vas a generar el índice binario utilizando tu archivo FASTA filtrado</li>\n              </ul>\n            </li>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Transcripts FASTA file”</em>: <code class=\"language-plaintext highlighter-rouge\">Filtered FASTA</code></li>\n            <li><em>“Single or paired-end reads?”</em>: <code class=\"language-plaintext highlighter-rouge\">Paired-end</code></li>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“file1”</em>: <code class=\"language-plaintext highlighter-rouge\">N701-Read1</code></li>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“file2”</em>: <code class=\"language-plaintext highlighter-rouge\">N701-Read2</code></li>\n            <li><em>“Relative orientation of reads within a pair”</em>: <code class=\"language-plaintext highlighter-rouge\">Mates are oriented towards each other (IR)</code></li>\n            <li><em>“Specify the strandedness of the reads”</em>: <code class=\"language-plaintext highlighter-rouge\">read comes from the reverse strand (SR)</code></li>\n            <li><em>“Protocol”</em>: <code class=\"language-plaintext highlighter-rouge\">DropSeq Single Cell protocol</code></li>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Transcript to gene map file”</em>: <code class=\"language-plaintext highlighter-rouge\">Map</code></li>\n            <li><em>“Retrieve all output files”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n            <li>In <em>“Optional commands”</em>:\n              <ul>\n                <li><em>“dumpFeatures”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n                <li><em>“dumpMTX”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n              </ul>\n            </li>\n          </ul>\n        </blockquote>\n      </blockquote>\n    </li>\n  </ol>\n</blockquote>\n\n<blockquote class=\"comment\">\n  <comment-title>Comentario</comment-title>\n  <p>Notas sobre la traducción de algunos de los valores de los parámetros:\nEn este tutorial manejaremos algunos términos en el idioma original ya que simplificará la búsqueda posterior de información sobre el tema. Estas notas aparecerán en estos recuadros y los términos estarán listados con la viñeta “•”.</p>\n  <ul>\n    <li>“Select a reference transcriptome from your history or use a built-in index?”: Use one from the history</li>\n    <li>\n      <ul>\n        <li>“¿Seleccionar un transcriptoma de referencia desde tu historial o utilizar un índice pre-integrado?”: <code class=\"language-plaintext highlighter-rouge\">Utilizar uno del historial</code></li>\n      </ul>\n    </li>\n    <li>“Transcripts FASTA file”: <code class=\"language-plaintext highlighter-rouge\">Filtered FASTA</code></li>\n    <li>\n      <ul>\n        <li>“Archivo FASTA de transcritos”: <code class=\"language-plaintext highlighter-rouge\">FASTA filtrado</code></li>\n      </ul>\n    </li>\n    <li>“Single or paired-end reads?”: <code class=\"language-plaintext highlighter-rouge\">Paired-end</code></li>\n    <li>\n      <ul>\n        <li>“¿Lecturas single-end o paired-end?”: <code class=\"language-plaintext highlighter-rouge\">Paired-end</code></li>\n      </ul>\n    </li>\n    <li>“Relative orientation of reads within a pair”: <code class=\"language-plaintext highlighter-rouge\">Mates are oriented towards each other (IR)</code>`</li>\n    <li>\n      <ul>\n        <li>“Orientación relativa de las lecturas dentro de un par”: <code class=\"language-plaintext highlighter-rouge\">Las lecturas pares están orientadas unas hacia las otras (IR)</code>`</li>\n      </ul>\n    </li>\n    <li>“Specify the strandedness of the reads”: <code class=\"language-plaintext highlighter-rouge\">read comes from the reverse strand (SR)</code>`</li>\n    <li>\n      <ul>\n        <li>“Especificar la direccionalidad de las lecturas”: <code class=\"language-plaintext highlighter-rouge\">las lecturas provienen de las cadenas inversas (SR)</code>`</li>\n      </ul>\n    </li>\n    <li>“Retrieve all output files”: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n    <li>\n      <ul>\n        <li>“Recobrar todos los archivos de salida”: <code class=\"language-plaintext highlighter-rouge\">Sí</code>`</li>\n      </ul>\n    </li>\n  </ul>\n</blockquote>\n\n<blockquote class=\"comment\">\n  <comment-title>¿Qué sucede si estoy procesando una muestra 10x??</comment-title>\n\n  <p>En Alevin, “Protocol” (Protocolo) es el parámetro principal que debe cambiarse para una muestra 10X Chromium. Simplemente selecciona los reactivos correspondientes a la química de 10x en lugar de Drop-seq.</p>\n</blockquote>\n\n<p>Esta herramienta tomará algo de tiempo para ejecutarse. Alevin produce muchos archivos de salida, no utilizaremos todos estos archivos. Puedes consultar la <a href=\"https://salmon.readthedocs.io/en/latest/alevin.html\">documentación de Alevin</a> si deseas saber más sobre estos archivos, sin embargo, los archivos que más nos interesan son:</p>\n\n<ul>\n  <li>La matriz generada (quants_mat.mtx.gz - el conteo de genes y células)</li>\n  <li>Los identificadores de fila <code class=\"language-plaintext highlighter-rouge\">cell/ barcode</code> (quants_mat_rows.txt), y</li>\n  <li>Las etiquetas en la columna <code class=\"language-plaintext highlighter-rouge\">gene</code> (quants_mat_cols.txt).</li>\n</ul>\n\n<p>Este es el formato “matrix market” (MTX).</p>\n\n<blockquote class=\"question\">\n  <question-title>Preguntas</question-title>\n\n  <p>Echa un vistazo a los diversos archivos generados después de ejecutar Alevin. ¿Puedes localizar las siguientes dos cosas?…</p>\n  <ol>\n    <li>¿Cuál es la tasa de mapeo?</li>\n    <li>¿Cuántas células están presentes en la matriz de salida?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title>Solución</solution-title>\n\n    <ol>\n      <li>Inspecciona <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> el archivo <i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> meta_info.json. Puedes ver que la tasa de mapeo es un insignificante <code class=\"language-plaintext highlighter-rouge\">24.75%</code>. Esta tasa es terrible. ¿Por qué sucede esto? Recuerda que este archivo fue submuestreado, siendo específicos, solo tomamos las últimas 400,000 lecturas del archivo FASTQ. La tasa general de mapeo del archivo es de alrededor del 50%, que sigue siendo una tasa muy baja, pero en general se pueden esperar tasas de mapeos ligeramente menores para muestras que fueron procesadas durante los inicios de las técnicas Drop-Seq y la secuenciación de ARN de células únicas. Actualmente las muestras procesadas con la técnica 10x son mucho mejores. Después de todo, los datos que estamos utilizando son reales, no son datos de prueba.</li>\n      <li>Inspecciona <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> el archivo <i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> ‘quants_mat_rows.txt’, y podrás ver que contiene <code class=\"language-plaintext highlighter-rouge\">2163</code> líneas. Las filas hacen referencia a las células en la matriz de correspondencia de células a genes. Según esta estimación (aproximada), tu muestra contiene 2163 células.</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<blockquote class=\"warning\">\n  <warning-title>De aquí en adelante selecciona la entrada apropiada.</warning-title>\n  <p>Asegurate de usar el archivo <strong>quants_mat.mtx.gz</strong>, NO EL ARCHIVO <em>quants_tier.mtx.gz</em>.</p>\n</blockquote>\n\n<p><i class=\"far fa-thumbs-up\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">congratulations</span> Felicidades - ¡has generado una matriz de expresión! Podríamos terminar en este punto, pero es necesario verificar la calidad de los datos, y una de las cosas que podemos hacer es visualizar un gráfico de rangos de los códigos de barras.</p>\n\n<h1 id=\"control-de-calidad-básico\">Control de calidad básico</h1>\n\n<p>La pregunta que buscamos contestar aquí es: “En su mayoría, ¿tenemos una sola célula por gota?”. Este es el principal objetivo, pero no es del todo sencillo obtener exactamente una sola célula por cada gota. En algunas ocasiones casi ninguna célula logra depositarse en las gotas, en otras ocasiones tenemos demasiadas células por gota. Cuando menos deberíamos poder distinguir fácilmente las gotas que contienen células de las que no las contienen.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Práctica: Generar un gráfico inicial de control de calidad (QC)</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/droplet_barcode_plot/_dropletBarcodePlot/1.6.1+galaxy2\" title=\"Droplet barcode rank plot tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Droplet barcode rank plot</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.6.1+galaxy2)</span> Gráfico de rangos de códigos de barras obtenido por técnicas de goteo (Droplet barcode rank plot) con los siguientes parámetros:\n      <ul>\n        <li><em>“Input MTX-format matrix?”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“A two-column tab-delimited file, with barcodes in the first column and frequencies in the second”</em>: <code class=\"language-plaintext highlighter-rouge\">raw_cb_frequencies.txt</code></li>\n        <li><em>“Label to place in plot title”</em>: <code class=\"language-plaintext highlighter-rouge\">Barcode rank plot (raw barcode frequencies)</code></li>\n      </ul>\n    </li>\n    <li>Cambiar el nombre <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> a la imagen de salida <code class=\"language-plaintext highlighter-rouge\">Barcode Plot - raw barcode frequencies</code></li>\n  </ol>\n</blockquote>\n\n<figure id=\"figure-3\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-raw_barcodes-400k.png\" alt=\"raw droplet barcode plots-400k. \" width=\"1000\" height=\"600\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-raw_barcodes-400k.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figura 3</strong>:</span> Subconjunto de datos crudos, 400k cadenas</figcaption></figure>\n\n<p>La imagen aquí generada (4000k) no es muy informativa - pero ten en cuenta que tan solo estás manejando una fracción de las lecturas. Si procesas la muestra completa (que involucra los mismos pasos mencionados en la parte superior, pero que tardaría mucho más tiempo) obtendrás la imagen siguiente.</p>\n\n<figure id=\"figure-4\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-raw_barcodes-total.png\" alt=\"raw droplet barcode plots-total. \" width=\"1000\" height=\"600\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-raw_barcodes-total.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figura 4</strong>:</span> Muestra completa - 32,579,453 lecturas - datos crudos</figcaption></figure>\n\n<p>Esta es la formulación del gráfico de código de barras que basamos en una <a href=\"https://github.com/COMBINE-lab/salmon/issues/362#issuecomment-490160480\">discusión</a> que entablamos con miembros de la comunidad científica. Los gráficos de líneas suaves de la izquierda son los principales; estos gráficos muestran, clasificados de los más bajos a los más altos, los conteos de UMIs para códigos de barras individuales. Esperamos una fuerte caída entre las gotas que contienen células y las gotas vacías o que solo contienen restos celulares. Este no es un conjunto de datos ideal, así que en perspectiva, en un mundo ideal un conjunto de datos muy limpio proveniente de procesados 10x, los datos se asemejarían un poco más a la siguiente imagen del atlas de pulmón (ver <a href=\"https://www.ebi.ac.uk/gxa/sc/experiments/E-MTAB-6653/results/tsne\">aquí</a> el estudio del Atlas de Expresión de Células Únicas y la remisión del proyecto <a href=\"https://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-6653/\">aquí</a>).</p>\n\n<figure id=\"figure-5\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-lung-atlas-barcodes-raw.png\" alt=\"raw droplet barcode plots - lung atlas. \" width=\"1000\" height=\"600\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-lung-atlas-barcodes-raw.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figura 5</strong>:</span> Datos ‘bonitos’ - crudos</figcaption></figure>\n\n<p>En este gráfico puedes ver más claramente una flexión tipo “rodilla”, mostrando el corte entre las gotas vacías y las gotas que contienen células.</p>\n\n<p>A la derecha encontramos los gráficos de densidad de la primera, y los umbrales generados ya sea utilizando <a href=\"https://bioconductor.org/packages/release/bioc/html/DropletUtils.html\">dropletUtils</a> o por medio del método descrito en la discusión que se mencionó con anterioridad (en la parte superior). Podremos utilizar cualquiera de estos umbrales para seleccionar células, asumiendo que cualquier medición con conteos menores es una célula válida. Alevin hace algo similar por defecto, y podemos aprender algo de esto graficando únicamente los códigos de barras que retiene Alevin.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Práctica: Obtener el gráfico de código de barras de Alevin</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/droplet_barcode_plot/_dropletBarcodePlot/1.6.1+galaxy2\" title=\"Droplet barcode rank plot tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Droplet barcode rank plot</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.6.1+galaxy2)</span> Genera el gráfico de código de barras basado en goteos utilizando los siguientes parámetros:\n      <ul>\n        <li><em>“Input MTX-format matrix?”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        <li><em>“Matrix-market format matrix file, with cells by column (overrides –barcode-frequencies if supplied)”</em>: <code class=\"language-plaintext highlighter-rouge\">quants_mat.mtx</code></li>\n        <li><em>“For use with –mtx-matrix: force interpretation of matrix to assume cells are by row, rather than by column (default)”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        <li><em>“Label to place in plot title”</em>: <code class=\"language-plaintext highlighter-rouge\">Barcode rank plot (Alevin-processed)</code></li>\n        <li><em>“Number of bins used in barcode count frequency distribution”</em>: <code class=\"language-plaintext highlighter-rouge\">50</code></li>\n        <li><em>“Above-baseline multiplier to calculate roryk threshold”</em>: <code class=\"language-plaintext highlighter-rouge\">1.5</code></li>\n      </ul>\n    </li>\n    <li>Cambiar el nombre <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> de la imagen de salida <code class=\"language-plaintext highlighter-rouge\">Barcode Plot - Alevin processed barcodes</code></li>\n  </ol>\n</blockquote>\n\n<figure id=\"figure-6\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-alevin-barcodes-400k.png\" alt=\"raw droplet barcode plots - 400k. \" width=\"1000\" height=\"600\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-alevin-barcodes-400k.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figura 6</strong>:</span> 400k sub-muestreo - Alevin procesado</figcaption></figure>\n\n<p>Y la muestra completa se ve como la siguiente figura:</p>\n\n<figure id=\"figure-7\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-alevin-barcodes-total.png\" alt=\"raw droplet barcode plots - total. \" width=\"1000\" height=\"600\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-alevin-barcodes-total.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figura 7</strong>:</span> Muestra total - 32,579,453 lecturas - Alevin procesado</figcaption></figure>\n\n<p>Y concluyendo, he aquí el gráfico del atlas de pulmón.</p>\n\n<figure id=\"figure-8\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-alevin-barcodes-lung.png\" alt=\"raw droplet barcode plots - total. \" width=\"1000\" height=\"600\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-alevin-barcodes-lung.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figura 8</strong>:</span> Datos bonitos - Alevin procesado</figcaption></figure>\n\n<p>Debes ver una caída casi vertical de la curva, que es donde Alevin truncó la distribución (después de haber excluido muchos códigos de barra celulares que tuvieron &lt;10 UMI, Alevin posteriormente selecciona un umbral basándose en la curva y elimina los códigos de barras con menos UMIs)</p>\n\n<p>Este método de ‘detección intensa’ funciona relativamente bien en experimentos con características relativamente sencillas. Pero algunas poblaciones presentan dificultades (¡como en nuestra muestra!). Por ejemplo, si nos basamos únicamente en los conteos de códigos de barras, puede ocurrir que subpoblaciones de células pequeñas no se puedan distinguir de las gotas vacías. Algunas bibliotecas producen múltiples flexiones tipo “rodilla” para múltiples subpoblaciones. El método <a href=\"https://genomebiology.biomedcentral.com/articles/10.1186/s13059-019-1662-y\">emptyDrops</a> se ha convertido en una forma popular de lidiar con este problema. EmptyDrops retiene los códigos de barras con conteos altos, pero también añade los códigos de barras que pueden ser estadísticamente diferenciados de los perfiles ambientales, incluso si los conteos totales son similares. Para que podamos ejecutar emptyDrops (o cualquier herramienta de tu elección que logre aplicar umbrales biológicamente relevantes), primero necesitamos volver a ejecutar Alevin, pero previniendo que este aplique sus propios umbrales, ya que no son los óptimos.</p>\n\n<p>Para poder utilizar emptyDrops de manera efectiva, necesitamos regresar y volver a ejecutar Alevin previniendo que aplique sus propios umbrales. Haz click sobre el icono de ‘volver a ejecutar’ en cualquier salida de Alevin dentro de tu historial ya que casi todos los parámetros son los mismos que antes, con la excepción de que necesitas cambiar los valores siguientes:</p>\n\n<h2 id=\"generar-una-matriz-sin-procesamiento-en-un-formato-utilizable\">Generar una matriz sin procesamiento en un formato utilizable</h2>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Práctica: Prevenir que Alevin utilice sus propios umbrales</hands-on-title>\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/alevin/alevin/1.3.0+galaxy2\" title=\"Alevin tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Alevin</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.3.0+galaxy2)</span> (Haz clic sobre la última salida de Alevin para volver a ejecutar)\n      <ul>\n        <li><em>“Optional commands”</em></li>\n        <li><em>“keepCBFraction”</em>: ‘1’ - por ejemplo conservarlos todos</li>\n        <li><em>“freqThreshold”</em>: ‘3’ - Esto solo eliminará los códigos de barras celulares que tengan una frecuencia menor de 3, un criterio bajo de aceptación, pero es una forma útil de evitar procesar un monton de códigos de barras que es casi seguro que estan vacíos.</li>\n      </ul>\n    </li>\n  </ol>\n\n  <!--SNIPPET-->\n  <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-para-volver-a-ejecutar-una-herramienta\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-para-volver-a-ejecutar-una-herramienta\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Consejo: Para volver a ejecutar una herramienta</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ol>   <li><strong>Expande</strong> uno de los conjuntos de datos de la salida de la herramienta haciendo clic sobre él</li>   <li><strong>Selecciona</strong> volver a ejecutar <i class=\"fas fa-redo\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-refresh</span> de la herramienta</li> </ol>   <p>Esto es de utilidad si quieres volver a correr la herramienta variando ligeramente los valores de los parámetros, o si deseas verificar la configuración de parámetros que utilizaste.</p> </blockquote>\n  <p><!--END_SNIPPET--></p>\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title>Pregunta</question-title>\n\n  <p>¿Cuántas células hay ahora en la salida?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title>Solución</solution-title>\n\n    <ol>\n      <li>¡Ahora hay <code class=\"language-plaintext highlighter-rouge\">22539</code> células en quants_mat_rows! Muchas más que las <code class=\"language-plaintext highlighter-rouge\">2163</code> que Alevin filtró. ¡Esto necesita ser filtrado en serio con emptyDrops!</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<p>Alevin da salida a un formato MTX, el cual puede ser la entrada del paquete dropletUtils y procesarse en emptyDrops. Desafortunadamente la matriz tiene una orientación equivocada. La matriz no puede ser procesada por herramientas cuya entrada son archivos como los que produce el software 10X. Necesitamos ‘transformar’ la matriz de tal forma que las células esten en columnas y los genes en filas.</p>\n\n<blockquote class=\"warning\">\n  <warning-title></warning-title>\n  <p>¡No mezcles los archivos de distintas ejecuciones de Alevin! Utiliza la última ejecución, la cual tiene los números más altos en el historial.</p>\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Práctica: Transformación de la matriz</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/salmon_kallisto_mtx_to_10x/_salmon_kallisto_mtx_to_10x/0.0.1+galaxy5\" title=\"salmonKallistoMtxTo10x tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>salmonKallistoMtxTo10x</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.0.1+galaxy5)</span> con los siguientes parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“.mtx-format matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">quants_mat.mtx.gz</code> (la salida de la herramienta <strong>Alevin</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Tab-delimited genes file”</em>: <code class=\"language-plaintext highlighter-rouge\">quants_mat_cols.txt</code> (la salida de la herramienta <strong>Alevin</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Tab-delimited barcodes file”</em>: <code class=\"language-plaintext highlighter-rouge\">quants_mat_rows.txt</code> (la salida de la herramienta <strong>Alevin</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n      </ul>\n    </li>\n    <li>Cambiar el nombre <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> de ‘salmonKallistoMtxTo10x….:genes’ a <code class=\"language-plaintext highlighter-rouge\">Gene table</code></li>\n    <li>Cambiar el nombre <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> de ‘salmonKallistoMtxTo10x….:barcodes’ a <code class=\"language-plaintext highlighter-rouge\">Barcode table</code></li>\n    <li>Cambiar el nombre <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> de ‘salmonKallistoMtxTo10x….:matrix’ a <code class=\"language-plaintext highlighter-rouge\">Matrix table</code></li>\n  </ol>\n</blockquote>\n\n<p>La salida es una matriz que contendrá la orientación correcta para poder ser utilizada por las herramientas en el análisis subsecuente. Sin embargo, nuestra matriz se ve un poco dispersa, por ejemplo, haz clic en <code class=\"language-plaintext highlighter-rouge\">Gene table</code>. No se tú, pero a mí me costaría entablar una buena discusión biológica utilizando únicamente los gene_ids de Ensembl. Lo que en realidad me gustaría es tener información más ‘humanamente entendible’, como la del tipo ‘GAPDH’ o con otro tipo de acrónimos de genes; también me gustaría tener información sobre genes mitocondriales para poder evaluar si mis células están bajo algún tipo de estrés o no. Con el objetivo de preparar nuestros datos para meterlos a emptyDrops, vamos a combinar esta información y depositarla en un objeto; ahora es más sencillo añadir dicha información.</p>\n\n<h2 id=\"añadir-metadatos-de-genes\">Añadir metadatos de genes</h2>\n\n<blockquote class=\"question\">\n  <question-title>Pregunta</question-title>\n\n  <p>¿Dónde podemos encontrar esta información sobre los genes?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title>Solución</solution-title>\n\n    <p>Dentro de un archivo GTF, nuestro viejo amigo.</p>\n\n  </blockquote>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title>Pregunta</question-title>\n\n  <p>¿Cual de los ‘atributos’ dentro de la última columna del archivo contiene el acrónimo de los genes?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title>Solución</solution-title>\n\n    <p>gene_name</p>\n\n  </blockquote>\n\n</blockquote>\n\n<p>Ahora vamos a volver a ejecutar la herramienta que extrae información contenida dentro de nuestro archivo GTF.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Práctica: Generar información de genes</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/gtf2gene_list/_ensembl_gtf2gene_list/1.42.1+galaxy6\" title=\"GTF2GeneList tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>GTF2GeneList</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.42.1+galaxy6)</span> con los siguientes parámetros:\n      <ul>\n        <li><em>“Feature type for which to derive annotation”</em>: <code class=\"language-plaintext highlighter-rouge\">gene</code></li>\n        <li><em>“Field to place first in output table”</em>: <code class=\"language-plaintext highlighter-rouge\">gene_id</code></li>\n        <li><em>“Suppress header line in output?”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        <li><em>“Comma-separated list of field names to extract from the GTF (default: use all fields)”</em>: <code class=\"language-plaintext highlighter-rouge\">gene_id,gene_name,mito</code></li>\n        <li><em>“Append version to transcript identifiers?”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        <li><em>“Flag mitochondrial features?”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code> - nota, esto va a rellenar automáticamente campos con un montón de genes asociados a la mitocondria (que se encontraron en el archivo GTF). ¡Esto es bueno!</li>\n        <li><em>“Filter a FASTA-format cDNA file to match annotations?”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code> - - no lo necesitamos, ¡hemos terminado con nuestro archivo FASTA!</li>\n      </ul>\n    </li>\n    <li>Verifica que el archivo de salida sea del tipo <code class=\"language-plaintext highlighter-rouge\">tabular</code>. Si no lo es, cambia el tipo de archivo haciendo click sobre ‘Editar atributos’<i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> que está en el historial del conjunto de datos (como si estuvieras cambiando el nombre al archivo). Después haz click sobre <code class=\"language-plaintext highlighter-rouge\">Datatypes</code> y teclea <code class=\"language-plaintext highlighter-rouge\">tabular</code>. Haz clic sobre <code class=\"language-plaintext highlighter-rouge\">Change datatype</code>.)</li>\n    <li>Cambiar el nombre <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> de la tabla de anotación a <code class=\"language-plaintext highlighter-rouge\">Gene Information</code></li>\n  </ol>\n</blockquote>\n\n<p>Inspecciona <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> el objeto <strong>Gene Information</strong> del historial. Ahora has incluido un nuevo campo para gene_id, esto incluye el nombre de los genes y una columna para información mitocondrial (false = not mitochondrial, true = mitochondrial). Necesitamos añadir esta información a la tabla de salida ‘Gene table’ proveniente de la herramienta salmonKallistoMtxto10x. Sin embargo, necesitamos mantener la tabla ‘Gene table’ en el mismo orden, ya que se hace referencia a ella en las filas de la tabla ‘Matrix table’.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Práctica: Combinar la tabla de genes MTX con la información de los genes</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"join1\" title=\"Join two Datasets tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Join two Datasets</strong></span> con los siguientes parámetros:\n      <ul>\n        <li><em>“Join”</em>: <code class=\"language-plaintext highlighter-rouge\">Gene Table</code></li>\n        <li><em>“Using column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 1</code></li>\n        <li><em>“with”</em>: <code class=\"language-plaintext highlighter-rouge\">Gene Information</code></li>\n        <li><em>“and column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 1</code></li>\n        <li><em>“Keep lines of first input that do not join with second input”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        <li><em>“Keep lines of first input that are incomplete”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        <li><em>“Fill empty columns”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n        <li><em>“Keep the header lines”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n      </ul>\n\n      <p>Si inspeccionas <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> el objeto, verás que hemos unido estas tablas y que ahora tiene algunos pocos gene_id repetidos. Eliminemos estas repeticiones manteniendo a su vez el orden original de la tabla ‘Gene Table’.</p>\n    </li>\n    <li><span class=\"tool\" data-tool=\"Cut1\" title=\"Cut columns from a table tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Cut columns from a table</strong></span> con los siguientes parámetros:\n      <ul>\n        <li><em>“Cut columns”</em>: <code class=\"language-plaintext highlighter-rouge\">c1,c4,c5</code></li>\n        <li><em>“Delimited by”</em>: <code class=\"language-plaintext highlighter-rouge\">Tab</code></li>\n        <li><em>“From”</em>: la salida de la herramienta <strong>Join two Datasets</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n      </ul>\n    </li>\n    <li>Cambiar el nombre <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> de la salida a <code class=\"language-plaintext highlighter-rouge\">Annotated Gene Table</code></li>\n  </ol>\n</blockquote>\n\n<p>Inspecciona <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> tu tabla <code class=\"language-plaintext highlighter-rouge\">Annotated Gene Table</code>. ¡Esto es más parecido a lo que buscamos! Tenemos <code class=\"language-plaintext highlighter-rouge\">gene_id</code>, <code class=\"language-plaintext highlighter-rouge\">gene_name</code>, y <code class=\"language-plaintext highlighter-rouge\">mito</code>. ¡Ahora regresemos a nuestro trayecto inicial con rumbo hacia emptyDrops y su forma sofisticada de utilizar umbrales para detectar gotas vacías!</p>\n\n<h1 id=\"emptydrops\">emptyDrops</h1>\n\n<p>La herramienta emptyDrops <span class=\"citation\"><a href=\"#article-emptyDrops\">Lun <i>et al.</i> 2019</a></span> trabaja con un tipo específico de objeto R llamado SingleCellExperiment. Necesitamos convertir nuestros archivos transformados MTX a este tipo de objetos, esto lo haremos utilizando la herramienta Read10x de DropletUtils:</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Práctica: Convertir al formato SingleCellExperiment</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/dropletutils_read_10x/dropletutils_read_10x/1.0.3+galaxy2\" title=\"DropletUtils Read10x tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>DropletUtils Read10x</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.0.3+galaxy2)</span> con los siguientes parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Expression matrix in sparse matrix format (.mtx)”</em>: <code class=\"language-plaintext highlighter-rouge\">Matrix table</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Gene Table”</em>: <code class=\"language-plaintext highlighter-rouge\">Annotated Gene Table</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Barcode/cell table”</em>: <code class=\"language-plaintext highlighter-rouge\">Barcode table</code></li>\n        <li><em>“Should metadata file be added?”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n      </ul>\n    </li>\n    <li>Cambiar el nombre <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> de salida: <code class=\"language-plaintext highlighter-rouge\">SCE Object</code></li>\n  </ol>\n</blockquote>\n\n<p>¡Fantástico! Ya hemos convertido la matriz en el objeto que ocupamos, siendo más específicos, la hemos convertido al formato SingleCellExperiment, ¡Ahora podemos ejecutar emptyDrops! Pero primero deshagámonos de esas gotas que no contienen células.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Práctica: emptyDrops</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/dropletutils_empty_drops/dropletutils_empty_drops/1.0.3+galaxy1\" title=\"DropletUtils emptyDrops tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>DropletUtils emptyDrops</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.0.3+galaxy1)</span> con los siguientes parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“SingleCellExperiment rdata object”</em>: <code class=\"language-plaintext highlighter-rouge\">SCE Object</code></li>\n        <li><em>“Should barcodes estimated to have no cells be removed from the output object?”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n      </ul>\n    </li>\n    <li>\n      <p>Cambiar el nombre <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> de la salida de <code class=\"language-plaintext highlighter-rouge\">serialised SingleCellExperiment</code> a <code class=\"language-plaintext highlighter-rouge\">Stringent-Object</code></p>\n    </li>\n    <li>Cambiar el nombre <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> de <code class=\"language-plaintext highlighter-rouge\">tabular output</code> a <code class=\"language-plaintext highlighter-rouge\">Stringent-Tabular Output</code></li>\n  </ol>\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title>Pregunta</question-title>\n\n  <p>¿Cuántos códigos de barras de células quedan después de procesar emptyDrops? ¿Por qué será esto?</p>\n\n  <blockquote class=\"tip\">\n    <tip-title>Pista</tip-title>\n    <p>Si haces clic sobre el <code class=\"language-plaintext highlighter-rouge\">Stringent-Object</code> en el historial <i class=\"fas fa-columns\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-history</span>, el texto de la ventana dice <code class=\"language-plaintext highlighter-rouge\">22 barcodes</code> o algo similar.  ¿Por qué es tan bajo?\nToma en consideración, ¿Es este un conjunto de datos completo?</p>\n  </blockquote>\n\n  <blockquote class=\"solution\">\n    <solution-title>Solución</solution-title>\n\n    <p>Recuerda que este conjunto de datos está submestreado. Si observas detenidamente los parámetros de emptyDrops, verás que la herramienta estableció un umbral mínimo de 100 UMI. Analizando los gráficos de códigos de barras mostrados en este tutorial, para la muestra de 400k lecturas, verás que este umbral es demasiado riguroso para la muestra submuestreada. Saliendo de dudas, este umbral mínimo daría como resultado <code class=\"language-plaintext highlighter-rouge\">3011</code> códigos de barras para la muestra total.</p>\n\n  </blockquote>\n\n</blockquote>\n\n<p>Ejecutemos de nuevo y cambiemos parámetros; volvamos a ejecutar la herramienta con un umbral mínimo más laxo.</p>\n\n<blockquote class=\"details\">\n  <details-title>¿Estás trabajando en equipo? ¡Hora de tomar decisiones!</details-title>\n  <p>Si estáis trabajando en equipo en este punto tenéis la oportunidad de tomar diversas rutas, la primera utilizando un control y el resto variando números para que podáis comparar resultados a lo largo de los tutoriales.</p>\n  <ul>\n    <li>Variable: <strong>UMI count lower bound</strong></li>\n    <li>Control:  <code class=\"language-plaintext highlighter-rouge\">5</code></li>\n    <li>Todos los demás: Tomad en consideración los gráficos de rangos de códigos de barras y seleccionad diversos límites inferiores.</li>\n  </ul>\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Práctica: emptyDrops - ¡Intentemoslo de nuevo!</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/dropletutils_empty_drops/dropletutils_empty_drops/1.0.3+galaxy1\" title=\"DropletUtils emptyDrops tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>DropletUtils emptyDrops</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.0.3+galaxy1)</span> con los siguiente parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“SingleCellExperiment rdata object”</em>: <code class=\"language-plaintext highlighter-rouge\">SCE Object</code></li>\n        <li><em>“UMI count lower bound”</em>: <code class=\"language-plaintext highlighter-rouge\">5</code> - aquí puedes usar diversos valores y ver que sucede</li>\n        <li><em>“Should barcodes estimated to have no cells be removed from the output object?”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n      </ul>\n    </li>\n    <li>\n      <p>Cambiar el nombre <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> de la salida <code class=\"language-plaintext highlighter-rouge\">serialised SingleCellExperiment</code> a <code class=\"language-plaintext highlighter-rouge\">&lt;pon tu número aquí&gt;UMI-Object</code></p>\n    </li>\n    <li>Cambiar el nombre <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> de la salida <code class=\"language-plaintext highlighter-rouge\">tabular output</code> a <code class=\"language-plaintext highlighter-rouge\">&lt;pon tu número aquí&gt;UMI-Tabular Output</code></li>\n  </ol>\n</blockquote>\n\n<p>¡En este punto debes tener <code class=\"language-plaintext highlighter-rouge\">111</code> códigos de barras! Ahora tienes una matriz de expresión anotada y lista para los procesos y análisis subsecuentes, ¡Bien hecho! Sin embargo, en los siguientes tutoriales nos vincularemos al uso de una herramienta llamada Scanpy. Por tanto, necesitarás convertir este objeto SingleCellExperiment a un formato llamado <code class=\"language-plaintext highlighter-rouge\">annData</code>, el cual es una variante de un archivo que utiliza un formato llamado <code class=\"language-plaintext highlighter-rouge\">hdf5</code>.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Práctica: Conversión al formato AnnData</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/sceasy_convert/sceasy_convert/0.0.5+galaxy1\" title=\"SCEasy convert tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>SCEasy convert</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.0.5+galaxy1)</span> con los siguientes parámetros:\n      <ul>\n        <li><em>“Direction of conversion”</em>: <code class=\"language-plaintext highlighter-rouge\">SingleCellExperiment to AnnData</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in SingleCellExperiment RDS format”</em>: <code class=\"language-plaintext highlighter-rouge\">&lt;pon tu número aquí&gt;UMI-Object</code></li>\n        <li><em>“Name of the assay to be transferred as main layer”</em>: <code class=\"language-plaintext highlighter-rouge\">counts</code></li>\n      </ul>\n    </li>\n    <li>Cambiar el nombre <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> de la salida a <code class=\"language-plaintext highlighter-rouge\">N701-400k-AnnData</code></li>\n  </ol>\n\n</blockquote>\n\n<p><i class=\"far fa-thumbs-up\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">congratulations</span> ¡Felicidades! Tu objeto está listo para el pipeline de Scanpy. Ahora puedes verificar tu trabajo comparándolo con el mostrado en este <a href=\"https://humancellatlas.usegalaxy.eu/u/wendi.bacon.training/h/pre-processing-with-alevin---part-1---answer-key\">historial de ejemplo</a>.</p>\n\n<p>Sin embargo, quizá quieras combinar este objeto con otros parecidos a él. Por ejemplo, es posible que hayas procesado 5 muestras, y que hayas empezado a partir de 10 archivos FASTQ…</p>\n\n<h1 id=\"combinar-archivos-fastq\">Combinar archivos FASTQ</h1>\n\n<p>Esta muestra es una de siete iniciales. Entonces, puedes utilizar un <a href=\"https://humancellatlas.usegalaxy.eu/u/wendi.bacon.training/w/pre-processing-with-alevin---part-1-imported-from-uploaded-file\">flujo de trabajo</a> para procesar los otros <a href=\"https://humancellatlas.usegalaxy.eu/u/wendi.bacon.training/h/alevin-tutorial---all-samples---400k\">12 archivos FASTQ submuestreados</a>. Nota que, por desgracia, la muestra submuestreada N705 contiene mayormente lecturas chatarra; por tanto, emptyDrops no funciona. Debido a esto, yo la procesé con Alevin. Por supuesto, la muestra completa funciona bien con emptyDrops. Va a tomar un buen rato el procesado de todas estas muestras, así que mientras tanto ve por uno, o varios cafecitos… O aún mejor, <a href=\"https://humancellatlas.usegalaxy.eu/u/wendi.bacon.training/h/pre-processing-with-alevin---part-2---input-generation\">yo ya procesé las muestras</a>, y las deposité en un <a href=\"https://humancellatlas.usegalaxy.eu/u/wendi.bacon.training/h/pre-processing-with-alevin---part-2---input\">nuevo historial</a> para que lo puedas importar y empezar con un historial limpio. Alternativamente, puedes obtener estos datos desde el repositorio Zenodo.</p>\n\n<h2 id=\"datos\">Datos</h2>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Práctica: Cargar datos - Combinar archivos</hands-on-title>\n\n  <ol>\n    <li>Crear un historial huevo para este tutorial (si es que no estás importando el historial mencionado en la parte superior)</li>\n    <li>\n      <p>Importar los diversos archivos AnnData y la tabla de diseño experimental\n desde <a href=\"https://zenodo.org/record/4574153#.YD56YS-l2uU\">Zenodo</a></p>\n\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/4574153/files/Experimental_Design.tabular\nhttps://zenodo.org/record/4574153/files/N701-400k-AnnData.h5ad\nhttps://zenodo.org/record/4574153/files/N702-400k-AnnData.h5ad\nhttps://zenodo.org/record/4574153/files/N703-400k-AnnData.h5ad\nhttps://zenodo.org/record/4574153/files/N704-400k-AnnData.h5ad\nhttps://zenodo.org/record/4574153/files/N705-400k-AnnData.h5ad\nhttps://zenodo.org/record/4574153/files/N706-400k-AnnData.h5ad\nhttps://zenodo.org/record/4574153/files/N707-400k-AnnData.h5ad\n</code></pre></div>      </div>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importación-por-medio-de-enlaces-1\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importación-por-medio-de-enlaces-1\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Consejo: Importación por medio de enlaces</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copia los enlaces</li>   <li>     <p>Abre el manejador de carga de datos de Galaxy (<i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> en la parte superior derecha del panel de herramientas)</p>   </li>   <li>Selecciona ‘Pegar/Traer datos’ <strong>Paste/Fetch Data</strong></li>   <li>     <p>Copia los enlaces en el campo de textos</p>   </li>   <li>     <p>Presiona ‘Iniciar’ <strong>Start</strong></p>   </li>   <li>     <p><strong>Close</strong> Cierra la ventana.</p>   </li>   <li>Galaxy utiliza los URLs como nombres de forma predeterminada , así que los tendrás que cambiar a algunos que sean más útiles o informativos. the window</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>Cambiar de nombre al conjunto de datos</li>\n    <li>\n      <p>Verifica que el tipo de datos sea <code class=\"language-plaintext highlighter-rouge\">h5ad</code> de lo contrario ¡Necesitarás cambiar cada tipo de datos al formato <code class=\"language-plaintext highlighter-rouge\">h5ad</code>!</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-cambiar-el-tipo-de-datos\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-cambiar-el-tipo-de-datos\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Consejo: Cambiar el tipo de datos</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Selecciona sobre el <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>icono del lápiz</strong> para editar los atributos del conjunto de datos</li>   <li>Selecciona en la pestaña <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Datatypes</strong> en la parte superior del panel central</li>   <li>Selecciona <code class=\"language-plaintext highlighter-rouge\">datatypes</code></li>   <li>Da clic en el botón <strong>Change datatype</strong></li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>Inspecciona <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> el archivo de texto <code class=\"language-plaintext highlighter-rouge\">Experimental Design</code>. Este muestra cómo cada <code class=\"language-plaintext highlighter-rouge\">N70X</code>  corresponde a una muestra, y si dicha muestra proviene de un macho o hembra. Estos serán metadatos importantes para agregar a nuestra muestra, los cuales añadiremos de forma similar a la forma en que añadiste los metadatos <code class=\"language-plaintext highlighter-rouge\">gene_name</code> y <code class=\"language-plaintext highlighter-rouge\">mito</code> en secciones anteriores.</p>\n\n<h2 id=\"concatenación-de-objetos\">Concatenación de objetos</h2>\n<blockquote class=\"hands_on\">\n  <hands-on-title>Práctica: Concatenación de objetos AnnData</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/anndata_manipulate/anndata_manipulate/0.7.5+galaxy0\" title=\"Manipulate AnnData tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Manipulate AnnData</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.7.5+galaxy0)</span> con los siguientes parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">N701-400k-AnnData</code></li>\n        <li><em>“Function to manipulate the object”</em>: ‘Concatenate along the observations axis’</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix to add”</em>: ‘Select all the other matrix files from bottom to top’</li>\n        <li><em>“Join method”</em>: <code class=\"language-plaintext highlighter-rouge\">Intersection of variables</code></li>\n        <li><em>“Key to add the batch annotation to obs”</em>: <code class=\"language-plaintext highlighter-rouge\">batch</code></li>\n        <li><em>“Separator to join the existing index names with the batch category”</em>: <code class=\"language-plaintext highlighter-rouge\">-</code></li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<p>¡Demos un vistazo a lo que hemos hecho! Desafortunadamente, los objetos AnnData son bastante complicados, así que aquí el icono del ojo <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> no nos será de mucha ayuda. En lugar de esto, de aquí en adelante vamos a utilizar una herramienta para visualizar nuestro objeto.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Práctica: Inspección de objetos AnnData</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.7.5+galaxy0\" title=\"Inspect AnnData tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Inspect AnnData</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.7.5+galaxy0)</span> con los siguiente parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: la salida de la herramienta <strong>Manipulate AnnData</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n        <li><em>“What to inspect?”</em>: <code class=\"language-plaintext highlighter-rouge\">General information about the object</code></li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.7.5+galaxy0\" title=\"Inspect AnnData tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Inspect AnnData</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.7.5+galaxy0)</span>  con los siguiente parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: la salida de la herramienta <strong>Manipulate AnnData</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n        <li><em>“What to inspect?”</em>: <code class=\"language-plaintext highlighter-rouge\">Key-indexed observations annotation (obs)</code></li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.7.5+galaxy0\" title=\"Inspect AnnData tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Inspect AnnData</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.7.5+galaxy0)</span>  con los siguiente parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: la salida de la herramienta <strong>Manipulate AnnData</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n        <li><em>“What to inspect?”</em>: <code class=\"language-plaintext highlighter-rouge\">Key-indexed annotation of variables/features (var)</code></li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<p>Ya hemos visualizado las tres salidas de <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> <strong>Inspect AnnData</strong>.</p>\n\n<blockquote class=\"question\">\n  <question-title>Preguntas</question-title>\n\n  <ol>\n    <li>¿Cuántas células tienes ahora?</li>\n    <li>¿Dónde está almacenada la información del lote (<code class=\"language-plaintext highlighter-rouge\">batch</code>)?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title>Soluciones</solution-title>\n\n    <ol>\n      <li>Si verificas la salida <strong>General information</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>, podrás ver que ahora tienes <code class=\"language-plaintext highlighter-rouge\">4079 células</code>, ya que la matriz ahora tiene 4079 células y 35,734 genes. También puedes observar esto en los tamaños de los archivos <strong>obs</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> (células) and <strong>var</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> (genes).</li>\n      <li>En la anotación de observaciones indexadas por clave <strong>Key-indexed observations annotation (obs)</strong>. Las diferentes versiones de la herramienta ‘Manipulate’ colocarán las columnas del lote (<code class=\"language-plaintext highlighter-rouge\">batch</code>) en diferentes ubicaciones. La versión de la herramienta utilizada en este curso asigna a la novena columna (<code class=\"language-plaintext highlighter-rouge\">9</code>) en la posición de más a la derecha, la cual determina el ‘lote’ (<code class=\"language-plaintext highlighter-rouge\">batch</code>). Lote (batch) se refiere al orden en que se agregaron las matrices. Los archivos se agregan desde la parte inferior del historial hacia arriba, ¡Así que ten cuidado en cómo configuras tus historiales al ejecutar esto!</li>\n    </ol>\n  </blockquote>\n\n</blockquote>\n\n<h1 id=\"añadir-el-lote-de-metadatos-batch-metadata\">Añadir el lote de metadatos (batch metadata)</h1>\n\n<p>Configura el historial de ejemplo con los índices más antiguos en la parte inferior.</p>\n\n<figure id=\"figure-9\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-history-files-ascending.png\" alt=\"Ordered history. \" width=\"328\" height=\"642\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-history-files-ascending.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figura 9</strong>:</span> Nota como N701 es el más bajo, en orden ascendente al N707</figcaption></figure>\n\n<p>Por tanto, cuando se concatenan, el lote (<code class=\"language-plaintext highlighter-rouge\">batch</code>) aparece de la siguiente manera:</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>Index</th>\n      <th>Batch</th>\n      <th>Genotype</th>\n      <th>Sex</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>N701</td>\n      <td>0</td>\n      <td>wildtype</td>\n      <td>male</td>\n    </tr>\n    <tr>\n      <td>N702</td>\n      <td>1</td>\n      <td>knockout</td>\n      <td>male</td>\n    </tr>\n    <tr>\n      <td>N703</td>\n      <td>2</td>\n      <td>knockout</td>\n      <td>female</td>\n    </tr>\n    <tr>\n      <td>N704</td>\n      <td>3</td>\n      <td>wildtype</td>\n      <td>male</td>\n    </tr>\n    <tr>\n      <td>N705</td>\n      <td>4</td>\n      <td>wildtype</td>\n      <td>male</td>\n    </tr>\n    <tr>\n      <td>N706</td>\n      <td>5</td>\n      <td>wildtype</td>\n      <td>male</td>\n    </tr>\n    <tr>\n      <td>N707</td>\n      <td>6</td>\n      <td>knockout</td>\n      <td>male</td>\n    </tr>\n  </tbody>\n</table>\n\n<p>Puede ser que los índices no se hayan importado en orden si utilizaste Zenodo para importar tus archivos (por ejemplo, N701 a N707, ascendentes). En ese caso necesitarás manipular de forma apropiada los parámetros de las siguientes herramientas para etiquetar tus lotes correctamente.</p>\n\n<p>Los dos metadatos más críticos en este experimento son <code class=\"language-plaintext highlighter-rouge\">sex</code> y <code class=\"language-plaintext highlighter-rouge\">genotype</code>. Posteriormente, vamos a colorear nuestros gráficos de células según los valores de estos parámetros, así que vamos a añadirlos ya.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Práctica: Etiquetas de sexo</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_replace_in_column/1.1.3\" title=\"Replace Text in a specific column tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Replace Text in a specific column</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.1.3)</span> con los siguientes parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“File to process”</em>: la salida de la herramienta <strong>Inspect AnnData: Key-indexed observations annotation (obs)</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li>\n          <p><em>“1. Replacement”</em></p>\n\n          <ul>\n            <li><em>“in column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 9</code> - or whichever column <code class=\"language-plaintext highlighter-rouge\">batch</code> is in</li>\n            <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">0|1|3|4|5|6</code></li>\n            <li><em>“Replace with”</em>: <code class=\"language-plaintext highlighter-rouge\">male</code></li>\n          </ul>\n        </li>\n        <li><strong>+ Insert Replacement</strong></li>\n        <li>\n          <p><em>“2. Replacement”</em></p>\n\n          <ul>\n            <li><em>“in column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 9</code></li>\n            <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">2</code></li>\n            <li><em>“Replace with”</em>: <code class=\"language-plaintext highlighter-rouge\">female</code></li>\n          </ul>\n        </li>\n        <li><strong>+ Insert Replacement</strong></li>\n        <li>\n          <p><em>“3. Replacement”</em></p>\n\n          <ul>\n            <li><em>“in column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 9</code></li>\n            <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">batch</code></li>\n            <li><em>“Replace with”</em>: <code class=\"language-plaintext highlighter-rouge\">sex</code></li>\n          </ul>\n        </li>\n      </ul>\n\n      <p>Ahora queremos únicamente la columna que contiene la información de sexo -  al final agregaremos esto en la anotación celular del objeto AnnData</p>\n    </li>\n    <li><span class=\"tool\" data-tool=\"Cut1\" title=\"Cut columns from a table tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Cut columns from a table</strong></span> con los siguientes parámetros:\n      <ul>\n        <li><em>“Cut columns”</em>: <code class=\"language-plaintext highlighter-rouge\">c9</code></li>\n        <li><em>“Delimited by”</em>: <code class=\"language-plaintext highlighter-rouge\">Tab</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“From”</em>: la salida de la herramienta <strong>Replace text</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n      </ul>\n    </li>\n    <li>Cambiar el nombre <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> de la salida a <code class=\"language-plaintext highlighter-rouge\">Sex metadata</code></li>\n  </ol>\n</blockquote>\n\n<p>Estuvo divertido, ahora hagámoslo de nuevo pero para el genotipo.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Práctica: Etiquetas de genotipo</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_replace_in_column/1.1.3\" title=\"Replace Text in a specific column tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Replace Text in a specific column</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.1.3)</span> con los siguientes parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“File to process”</em>: la salida de la herramienta <strong>Inspect AnnData: Key-indexed observations annotation (obs)</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n        <li>\n          <p><em>“1. Replacement”</em></p>\n\n          <ul>\n            <li><em>“in column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 9</code></li>\n            <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">0|3|4|5</code></li>\n            <li><em>“Replace with”</em>: <code class=\"language-plaintext highlighter-rouge\">wildtype</code></li>\n          </ul>\n        </li>\n        <li><strong>+ Insert Replacement</strong></li>\n        <li>\n          <p><em>“2. Replacement”</em></p>\n\n          <ul>\n            <li><em>“in column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 9</code></li>\n            <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">1|2|6</code></li>\n            <li><em>“Replace with”</em>: <code class=\"language-plaintext highlighter-rouge\">knockout</code></li>\n          </ul>\n        </li>\n        <li><strong>+ Insert Replacement</strong></li>\n        <li>\n          <p><em>“3. Replacement”</em></p>\n\n          <ul>\n            <li><em>“in column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 9</code></li>\n            <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">batch</code></li>\n            <li><em>“Replace with”</em>: <code class=\"language-plaintext highlighter-rouge\">genotype</code></li>\n          </ul>\n        </li>\n      </ul>\n\n      <p>Ahora queremos únicamente la columna que contiene la información de genotipo -  al final agregaremos esto en la anotación celular del objeto AnnData.</p>\n    </li>\n    <li><span class=\"tool\" data-tool=\"Cut1\" title=\"Cut columns from a table tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Cut columns from a table</strong></span> con los siguientes parámetros:\n      <ul>\n        <li><em>“Cut columns”</em>: <code class=\"language-plaintext highlighter-rouge\">c9</code></li>\n        <li><em>“Delimited by”</em>: <code class=\"language-plaintext highlighter-rouge\">Tab</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“From”</em>: la salida de la herramienta <strong>Replace text</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n      </ul>\n    </li>\n    <li>Cambiar el nombre <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> de la salida a <code class=\"language-plaintext highlighter-rouge\">Genotype metadata</code></li>\n  </ol>\n</blockquote>\n\n<p>Es posible que desees hacer esto con distintos tipos de metadatos - qué laboratorios manejaron las muestras, en qué día se procesaron, etc. Una vez que hayas agregado todas tus columnas de metadatos, podemos entonces adherirlas unas a otras antes de conectarlas al objeto AnnData.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Práctica: Combinar las columnas de metadatos</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"Paste1\" title=\"Paste two files side by side tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Paste two files side by side</strong></span> con los siguientes parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Paste”</em>: <code class=\"language-plaintext highlighter-rouge\">Genotype metadata</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“and”</em>: <code class=\"language-plaintext highlighter-rouge\">Sex metadata</code></li>\n        <li><em>“Delimit by”</em>: <code class=\"language-plaintext highlighter-rouge\">Tab</code></li>\n      </ul>\n    </li>\n    <li>Cambiar el nombre <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> de la salida a <code class=\"language-plaintext highlighter-rouge\">Cell Metadata</code></li>\n  </ol>\n</blockquote>\n\n<p>¡Agrégalo al objeto AnnData!</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Práctica: Añadir los metadatos al objeto AnnData</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/anndata_manipulate/anndata_manipulate/0.7.5+galaxy0\" title=\"Manipulate AnnData tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Manipulate AnnData</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.7.5+galaxy0)</span> con los siguientes parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: la salida de la herramienta <strong>Manipulate AnnData</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n        <li><em>“Function to manipulate the object”</em>: <code class=\"language-plaintext highlighter-rouge\">Add new annotation(s) for observations or variables</code></li>\n        <li><em>“What to annotate?”</em>: <code class=\"language-plaintext highlighter-rouge\">Observations (obs)</code>`</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Table with new annotations”</em>: <code class=\"language-plaintext highlighter-rouge\">Cell Metadata</code></li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<p>¡Perfecto! Ahora puedes ejecutar <strong>Inspect AnnData</strong> para verificación, pero primero limpiemos un poco más este objeto. Sería mucho mejor si “lote” (<code class=\"language-plaintext highlighter-rouge\">batch</code>) significara algo, en lugar de “el orden en el que la herramienta ‘Manipulate AnnData’ agregó mis conjuntos de datos”.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Práctica:  Etiquetado de lotes</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/anndata_manipulate/anndata_manipulate/0.7.5+galaxy0\" title=\"Manipulate AnnData tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Manipulate AnnData</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.7.5+galaxy0)</span> con los siguientes parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Annotated data matrix”</em>: la salida de la herramienta <strong>Manipulate AnnData - Add new annotations</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n        <li><em>“Function to manipulate the object”</em>: <code class=\"language-plaintext highlighter-rouge\">Rename categories of annotation</code></li>\n        <li><em>“Key for observations or variables annotation”</em>: <code class=\"language-plaintext highlighter-rouge\">batch</code></li>\n        <li><em>“Comma-separated list of new categories”</em>: <code class=\"language-plaintext highlighter-rouge\">N701,N702,N703,N704,N705,N706,N707</code></li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<p>¡Ya casi llegamos a donde queremos! Sin embargo, mientras que nos hemos enfocado en los metadatos de nuestras células (muestra, lote, genotipo, etc.) para etiquetar las ‘observaciones’ en nuestro objeto…</p>\n\n<h1 id=\"lecturas-mitocondriales\">Lecturas mitocondriales</h1>\n\n<p>¿Recuerdas cuando mencionamos mitocondrias en los inicios de este tutorial? Y en muestras de células únicas, ¿Cómo de frecuente el ARN mitocondrial es un indicador de estrés durante la disociación? Probablemente deberíamos hacer algo con nuestra columna de verdadero/falso (true/false) en la anotación de genes, la cual nos provee información sobre las células. Ya sea que hayas combinado los archivos FASTQ o que estés analizando solo un archivo necesitarás hacer esto (saltándose así las secciones 4 y 5).</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Práctica: Calculando el ARN mitocondrial en las células</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/anndata_ops/anndata_ops/0.0.3+galaxy1\" title=\"AnnData Operations tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>AnnData Operations</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.0.3+galaxy1)</span> con los siguientes parámetros:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input object in hdf5 AnnData format”</em>: la salida de la herramienta <strong>Manipulate AnnData - Rename categories</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n        <li><em>“Format of output object”</em>: <code class=\"language-plaintext highlighter-rouge\">AnnData format</code></li>\n        <li><em>“Copy AnnData to .raw”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n        <li><em>“Gene symbols field in AnnData”</em>: <code class=\"language-plaintext highlighter-rouge\">NA.</code></li>\n        <li><em>“Flag genes that start with these names”</em>: <code class=\"language-plaintext highlighter-rouge\">Insert Flag genes that start with these names</code></li>\n        <li><em>“Starts with”</em>: <code class=\"language-plaintext highlighter-rouge\">True</code></li>\n        <li><em>“Var name”</em>: <code class=\"language-plaintext highlighter-rouge\">mito</code></li>\n        <li><em>“Number of top genes”</em>: <code class=\"language-plaintext highlighter-rouge\">50</code></li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<p><i class=\"far fa-thumbs-up\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">congratulations</span> ¡Bien hecho! Te sugiero encarecidamente que juegues un poco e inspecciones tu objeto <strong>Inspect AnnData</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> final preprocesado de AnnData (<code class=\"language-plaintext highlighter-rouge\">Pre-processed object</code>) para que puedas ver la gran cantidad de información que ha sido agregada. ¡Ya está todo listo para continuar con el filtrado! Sin embargo, hay un truco que puede ahorrarte tiempo en el futuro…</p>\n\n<h1 id=\"extraer-datos-de-secuenciación-de-arn-de-células-únicas-desde-bases-de-datos-públicas\">Extraer datos de secuenciación de ARN de células únicas desde bases de datos públicas</h1>\n\n<p>Si te interesa analizar datos de acceso público, particularmente del <a href=\"https://www.ebi.ac.uk/gxa/sc/home\">Single Cell Expression Atlas</a>, quizá te interese la herramienta <span class=\"citation\"><a href=\"#Moreno2020.04.08.032698\">Moreno <i>et al.</i> 2020</a></span>, la cual más bien reduce estos pasos en uno. <a href=\"https://www.ebi.ac.uk/gxa/sc/experiments/E-MTAB-6945/downloads\">Aquí</a>  puedes encontrar el conjunto de datos para este tutorial, el cual tiene el número de identificación de experimento <code class=\"language-plaintext highlighter-rouge\">E-MTAB-6945</code>.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Práctica: Obtener datos de el Atlas de Expresión de Células Únicas</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/retrieve_scxa/retrieve_scxa/v0.0.2+galaxy2\" title=\"EBI SCXA Data Retrieval tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>EBI SCXA Data Retrieval</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version v0.0.2+galaxy2)</span> con los siguientes parámetros:\n      <ul>\n        <li><em>“SC-Atlas experiment accession”</em>: <code class=\"language-plaintext highlighter-rouge\">E-MTAB-6945</code></li>\n        <li><em>“Choose the type of matrix to download”</em>: <code class=\"language-plaintext highlighter-rouge\">Raw filtered counts</code></li>\n      </ul>\n\n      <p>Ahora necesitamos transformar estos datos en un objeto tipo AnnData</p>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_read_10x/scanpy_read_10x/1.6.0+galaxy0\" title=\"Scanpy Read10x tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Scanpy Read10x</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.6.0+galaxy0)</span> con los siguientes parámetros:\n      <ul>\n        <li><em>“Expression matrix in sparse matrix format (.mtx)”</em>: <code class=\"language-plaintext highlighter-rouge\">EBI SCXA Data Retrieval on E-MTAB-6945 matrix.mtx (Raw filtered counts)</code></li>\n        <li><em>“Gene table”</em>:  <code class=\"language-plaintext highlighter-rouge\">EBI SCXA Data Retrieval on E-MTAB-6945 genes.tsv (Raw filtered counts)</code></li>\n        <li><em>“Barcode/cell table”</em>: <code class=\"language-plaintext highlighter-rouge\">EBI SCXA Data Retrieval on E-MTAB-6945 barcodes.tsv (Raw filtered counts)</code></li>\n        <li><em>“Cell metadata table”</em>: <code class=\"language-plaintext highlighter-rouge\">EBI SCXA Data Retrieval on E-MTAB-6945 exp_design.tsv</code></li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<p>Es importante tener en cuenta que esta matriz es procesada de cierto modo por medio del pipeline SCXA, que es muy similar a este tutorial, y que contiene todos y cada uno de los metadatos proporcionados por su pipeline, así como sus autores (por ejemplo, más anotaciones celulares o de genes).</p>\n\n<h1 id=\"conclusion\">Conclusion</h1>\n\n<figure id=\"figure-10\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-alevin-part1workflow.png\" alt=\"Workflow Part 1. \" width=\"1070\" height=\"884\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-alevin-part1workflow.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figura 10</strong>:</span> Flujo de trabajo - Pasos 1-3</figcaption></figure>\n\n<figure id=\"figure-11\" style=\"max-width: 90%;\"><img src=\"../../images/scrna-casestudy/wab-alevin-part2workflow.png\" alt=\"Workflow Part 2. \" width=\"1255\" height=\"692\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/scrna-casestudy/wab-alevin-part2workflow.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figura 11</strong>:</span> Flujo de trabajo - Pasos 4-6</figcaption></figure>\n\n<p>¡Has llegado al final de esta sesión! Quizá te interese echarle un vistazo a un <a href=\"https://humancellatlas.usegalaxy.eu/u/wendi.bacon.training/h/pre-processing-with-alevin---part-2---answer-key-1\">ejemplo de un historial</a> y a la <a href=\"https://humancellatlas.usegalaxy.eu/u/wendi.bacon.training/w/pre-processing-with-alevin---part-2\">Parte 2 del flujo de trabajo</a>. Nota que según la forma en que ejecutes el flujo de trabajo este requerirá que cambies la columna (<code class=\"language-plaintext highlighter-rouge\">column</code>) que contiene el lote de metadatos. <a href=\"https://humancellatlas.usegalaxy.eu/u/wendi.bacon.training/h/pre-processing-with-alevin---part-2---total-anndata-example\">Aquí</a> puedes encontrar el objeto final que contiene todas las lecturas.</p>\n\n<p>Hemos:</p>\n\n<ul>\n  <li>Tomado lecturas crudas, anotaciones y los archivos de entrada necesarios para cuantificación.</li>\n  <li>Ejecutado Alevin con dos distintas configuraciones de parámetros, ambas permitiendo que la herramienta tome sus propias decisiones sobre qué es lo que constituyen las gotas vacías y, hemos aplicado emptyDrops en su lugar.</li>\n  <li>Desplegado gráficos de rangos de códigos de barras para valorar de manera rápida las señales presentes en los conjuntos de datos generados por técnicas de goteo.</li>\n  <li>Aplicado las conversiones necesarias para pasar estos datos a los procesos subsecuentes.</li>\n  <li>Obtenido datos con análisis parciales desde el Single Cell Expression Atlas.</li>\n</ul>\n\n<p>¡Únete a nuestro canal de Gitter de secuenciación de ARN de células únicas para tomar parte en discusiones con científicos con ideas afines a las tuyas! <a href=\"https://gitter.im/Galaxy-Training-Network/galaxy-single-cell?utm_source=badge&amp;utm_medium=badge&amp;utm_campaign=pr-badge\"><a href=\"https://badges.gitter.im/Galaxy-Training-Network/galaxy-single-cell.svg\" rel=\"noopener noreferrer\"><img src=\"https://badges.gitter.im/Galaxy-Training-Network/galaxy-single-cell.svg\" alt=\"Gitter. \" loading=\"lazy\" /></a></a></p>\n"],"ref_slides":[],"hands_on":true,"slides":false,"mod_date":"2024-06-13 17:53:27 +0000","pub_date":"2021-03-03 13:21:27 +0000","version":33,"workflows":[{"workflow":"Generating-a-single-cell-matrix-using-Alevin.ga","tests":true,"url":"https://training.galaxyproject.org/training-material/topics/single-cell/tutorials/scrna-case_alevin/workflows/Generating-a-single-cell-matrix-using-Alevin.ga","path":"topics/single-cell/tutorials/scrna-case_alevin/workflows/Generating-a-single-cell-matrix-using-Alevin.ga","wfid":"single-cell-scrna-case_alevin","wfname":"generating-a-single-cell-matrix-using-alevin","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/single-cell-scrna-case_alevin/versions/generating-a-single-cell-matrix-using-alevin","license":"CC-BY-4.0","creators":[{"class":"Person","identifier":"0009-0001-2017-8805","name":"Julia Jakiela"},{"class":"Person","identifier":"0000-0002-8170-8806","name":"Wendi Bacon"}],"name":"Generating a single cell matrix using Alevin","title":"Generating a single cell matrix using Alevin","test_results":null,"modified":"2024-06-17 13:07:06 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\nGTF file\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"ℹ️ Input Dataset\\nReference FASTA\"];\n  style 1 stroke:#2c3143,stroke-width:4px;\n  2[\"ℹ️ Input Dataset\\nRead 1 - containing cell barcode & UMI\"];\n  style 2 stroke:#2c3143,stroke-width:4px;\n  3[\"ℹ️ Input Dataset\\nRead 2 - containing transcript\"];\n  style 3 stroke:#2c3143,stroke-width:4px;\n  4[\"GTF2GeneList\"];\n  0 -->|output| 4;\n  5[\"Transcript-gene mapping\"];\n  1 -->|output| 5;\n  0 -->|output| 5;\n  773cb4ae-56c3-49c0-b582-ee69d620def3[\"Output\\nfasta_output\"];\n  5 --> 773cb4ae-56c3-49c0-b582-ee69d620def3;\n  style 773cb4ae-56c3-49c0-b582-ee69d620def3 stroke:#2c3143,stroke-width:4px;\n  a30424b5-1ddc-4324-9ff6-dc5883adcce0[\"Output\\nfeature_annotation\"];\n  5 --> a30424b5-1ddc-4324-9ff6-dc5883adcce0;\n  style a30424b5-1ddc-4324-9ff6-dc5883adcce0 stroke:#2c3143,stroke-width:4px;\n  6[\"Alevin Processed\"];\n  2 -->|output| 6;\n  3 -->|output| 6;\n  5 -->|fasta_output| 6;\n  1 -->|output| 6;\n  5 -->|feature_annotation| 6;\n  a87beb55-1baf-458e-bd09-bb5ac6ea6e9a[\"Output\\nraw_cb_frequency_txt\"];\n  6 --> a87beb55-1baf-458e-bd09-bb5ac6ea6e9a;\n  style a87beb55-1baf-458e-bd09-bb5ac6ea6e9a stroke:#2c3143,stroke-width:4px;\n  c9390a50-775c-4f0f-88e5-0984d570902c[\"Output\\nsalmon_quant_log\"];\n  6 --> c9390a50-775c-4f0f-88e5-0984d570902c;\n  style c9390a50-775c-4f0f-88e5-0984d570902c stroke:#2c3143,stroke-width:4px;\n  2cebc438-ddc0-41e0-89ba-49b4bd3e2160[\"Output\\nquants_mat_mtx\"];\n  6 --> 2cebc438-ddc0-41e0-89ba-49b4bd3e2160;\n  style 2cebc438-ddc0-41e0-89ba-49b4bd3e2160 stroke:#2c3143,stroke-width:4px;\n  89fa1aad-9ec6-4351-97d5-f05cac09e08e[\"Output\\nquants_mat_cols_txt\"];\n  6 --> 89fa1aad-9ec6-4351-97d5-f05cac09e08e;\n  style 89fa1aad-9ec6-4351-97d5-f05cac09e08e stroke:#2c3143,stroke-width:4px;\n  3b3dda80-5d35-4c51-9ca0-90a2f909755f[\"Output\\nquants_mat_rows_txt\"];\n  6 --> 3b3dda80-5d35-4c51-9ca0-90a2f909755f;\n  style 3b3dda80-5d35-4c51-9ca0-90a2f909755f stroke:#2c3143,stroke-width:4px;\n  7[\"Alevin - no processing\"];\n  2 -->|output| 7;\n  3 -->|output| 7;\n  5 -->|fasta_output| 7;\n  1 -->|output| 7;\n  5 -->|feature_annotation| 7;\n  25d4d8f6-d166-4470-80fe-d0fdb0702371[\"Output\\nquants_mat_rows_txt_1\"];\n  7 --> 25d4d8f6-d166-4470-80fe-d0fdb0702371;\n  style 25d4d8f6-d166-4470-80fe-d0fdb0702371 stroke:#2c3143,stroke-width:4px;\n  d9ed1457-792b-4eaf-a9fc-2407bcd90da7[\"Output\\nquants_mat_mtx_1\"];\n  7 --> d9ed1457-792b-4eaf-a9fc-2407bcd90da7;\n  style d9ed1457-792b-4eaf-a9fc-2407bcd90da7 stroke:#2c3143,stroke-width:4px;\n  40df6aa8-3dfa-4946-bbc8-cacf4ca2a20e[\"Output\\nquants_mat_cols_txt_1\"];\n  7 --> 40df6aa8-3dfa-4946-bbc8-cacf4ca2a20e;\n  style 40df6aa8-3dfa-4946-bbc8-cacf4ca2a20e stroke:#2c3143,stroke-width:4px;\n  8[\"Droplet rank plot - raw barcodes\"];\n  6 -->|raw_cb_frequency_txt| 8;\n  9[\"Droplet rank plot - Alevin barcodes\"];\n  6 -->|quants_mat_mtx| 9;\n  10[\"salmonKallistoMtxTo10x\"];\n  7 -->|quants_mat_rows_txt| 10;\n  7 -->|quants_mat_cols_txt| 10;\n  7 -->|quants_mat_mtx| 10;\n  11[\"Join two Datasets\"];\n  10 -->|genes_out| 11;\n  4 -->|feature_annotation| 11;\n  12[\"Cut\"];\n  11 -->|out_file1| 12;\n  13[\"DropletUtils Read10x\"];\n  10 -->|barcodes_out| 13;\n  12 -->|out_file1| 13;\n  10 -->|matrix_out| 13;\n  14[\"DropletUtils emptyDrops\"];\n  13 -->|output_rds| 14;\n  15[\"SCEasy Converter\"];\n  14 -->|output_rdata| 15;"}],"api":"https://training.galaxyproject.org/training-material/api/topics/single-cell/tutorials/scrna-case_alevin/tutorial.json","tools":["Cut1","join1","toolshed.g2.bx.psu.edu/repos/bgruening/alevin/alevin/1.10.1+galaxy0","toolshed.g2.bx.psu.edu/repos/ebi-gxa/droplet_barcode_plot/_dropletBarcodePlot/1.6.1+galaxy2","toolshed.g2.bx.psu.edu/repos/ebi-gxa/dropletutils_empty_drops/dropletutils_empty_drops/1.0.4+galaxy0","toolshed.g2.bx.psu.edu/repos/ebi-gxa/dropletutils_read_10x/dropletutils_read_10x/1.0.4+galaxy0","toolshed.g2.bx.psu.edu/repos/ebi-gxa/gtf2gene_list/_ensembl_gtf2gene_list/1.52.0+galaxy0","toolshed.g2.bx.psu.edu/repos/ebi-gxa/salmon_kallisto_mtx_to_10x/_salmon_kallisto_mtx_to_10x/0.0.1+galaxy6","toolshed.g2.bx.psu.edu/repos/iuc/sceasy_convert/sceasy_convert/0.0.7+galaxy2"],"supported_servers":{"exact":[{"url":"https://usegalaxy.eu","name":"UseGalaxy.eu","usegalaxy":true}],"inexact":[]},"topic_name_human":"Single Cell","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"alevin","owner":"bgruening","revisions":"e32b215b7c04","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"droplet_barcode_plot","owner":"ebi-gxa","revisions":"8f605643ccfd","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"dropletutils_empty_drops","owner":"ebi-gxa","revisions":"fa662ca7ae7f","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"dropletutils_read_10x","owner":"ebi-gxa","revisions":"ca62f52e0d7f","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"gtf2gene_list","owner":"ebi-gxa","revisions":"14b3f2a4523b","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"salmon_kallisto_mtx_to_10x","owner":"ebi-gxa","revisions":"88f5a0a6a818","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"sceasy_convert","owner":"iuc","revisions":"2062be7efc84","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: alevin\n  owner: bgruening\n  revisions: e32b215b7c04\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: droplet_barcode_plot\n  owner: ebi-gxa\n  revisions: 8f605643ccfd\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: dropletutils_empty_drops\n  owner: ebi-gxa\n  revisions: fa662ca7ae7f\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: dropletutils_read_10x\n  owner: ebi-gxa\n  revisions: ca62f52e0d7f\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: gtf2gene_list\n  owner: ebi-gxa\n  revisions: 14b3f2a4523b\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: salmon_kallisto_mtx_to_10x\n  owner: ebi-gxa\n  revisions: 88f5a0a6a818\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: sceasy_convert\n  owner: iuc\n  revisions: 2062be7efc84\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":false,"slides_recordings":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial","contributors":[{"name":"Wendi Bacon","email":"wendi.bacon@open.ac.uk","twitter":"WendiBacon1","matrix":"nomadscientist:matrix.org","joined":"2020-03","elixir_node":"uk","orcid":"0000-0002-8170-8806","bio":"Lecturer at The Open University","fediverse":"https://mstdn.science/@wendibacon1","fediverse_flavor":"mastodon","affiliations":["elixir-europe"],"id":"nomadscientist","url":"https://training.galaxyproject.org/training-material/api/contributors/nomadscientist.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/nomadscientist/"},{"name":"Jonathan Manning","email":"jmanning@ebi.ac.uk","joined":"2021-02","id":"pinin4fjords","url":"https://training.galaxyproject.org/training-material/api/contributors/pinin4fjords.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/pinin4fjords/"},{"name":"Helena Rasche","orcid":"0000-0001-9760-8992","maintainer_contact":"gitter","matrix":"hexylena:matrix.org","joined":"2017-09","elixir_node":"nl","affiliations":["gallantries","by-covid","erasmusmc","elixir-europe","elixir-converge"],"former_affiliations":["deNBI","avans-atgm","uni-freiburg"],"contact_for_training":false,"location":{"country":"NL","lat":51.91,"lon":4.46},"id":"hexylena","url":"https://training.galaxyproject.org/training-material/api/contributors/hexylena.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/hexylena/"},{"name":"Julia Jakiela","email":"juliajot36@gmail.com","joined":"2022-06","id":"wee-snufkin","url":"https://training.galaxyproject.org/training-material/api/contributors/wee-snufkin.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/wee-snufkin/"}]}