{"layout":"tutorial_hands_on","title":"Metabarcoding/eDNA through Obitools","zenodo_link":"https://zenodo.org/record/5932108","questions":["how to analyze DNA metabarcoding / eDNA data produced on Illumina sequencers using the OBITools?"],"objectives":["Deal with paired-end data to create consensus sequences","Clean, filter and anlayse data to obtain strong results"],"time_estimation":"1H","key_points":["From raw reads you can process, clean and filter data to obtain a list of species from environmental DNA (eDNA) samples."],"tags":["Genetic composition EBV class","Community composition EBV class","EBV dataset","EBV workflow","eDNA","Metabarcoding"],"contributions":{"authorship":["colineroyaux","onorvez","ecoissac","fboyer","yvanlebras"],"funding":["gallantries","pndb"]},"recordings":[{"captioners":["yvanlebras"],"date":"2022-03-03","galaxy_version":"21.09","length":"1H15M","youtube_id":"o2cUvb_lmLs","speakers":["yvanlebras"]}],"js_requirements":{"mathjax":null,"mermaid":false},"short_id":"T00124","url":"/topics/ecology/tutorials/Obitools-metabarcoding/tutorial.html","topic_name":"ecology","tutorial_name":"Obitools-metabarcoding","dir":"topics/ecology/tutorials/Obitools-metabarcoding","symlink":null,"id":"ecology/Obitools-metabarcoding","ref_tutorials":["<p>Based on this <a href=\"https://pythonhosted.org/OBITools/wolves.html\">OBITools official tutorial</a>, you will learn here how to analyze DNA metabarcoding data produced on Illumina sequencers using:</p>\n<ul>\n  <li>the OBITools on Galaxy</li>\n  <li>some classical Galaxy tools</li>\n</ul>\n\n<p>The data used in this tutorial correspond to the analysis of four wolf scats, using the protocol published in <span class=\"citation\"><a href=\"#Shehzad2012\">SHEHZAD <i>et al.</i> 2012</a></span> for assessing carnivore diet. After extracting DNA from the faeces, the DNA amplifications were carried out using the primers TTAGATACCCCACTATGC and TAGAACAGGCTCCTCTAG amplifying the 12S-V5 region (<span class=\"citation\"><a href=\"#Riaz2011\">Riaz <i>et al.</i> 2011</a></span>), together with a wolf blocking oligonucleotide.</p>\n\n<p>It is always a good idea to have a look at the intermediate results or to evaluate the best parameter for each step. Some commands are designed for that purpose, for example you can use :</p>\n\n<ul>\n  <li>obicount to count the number of sequence records in a file</li>\n  <li>obihead and obitail to view the first or last sequence records of a file</li>\n  <li>obistat to get some basic statistics (count, mean, standard deviation) on the attributes (key=value combinations) in the header of each sequence record (see The <a href=\"https://pythonhosted.org/OBITools/fasta.html\">extended OBITools fasta format in the fasta format description</a>)</li>\n  <li>any Galaxy tools corresponding to classical unix command such as less, awk, sort, wc to check your files.</li>\n</ul>\n\n<p>The OBITools programs imitate Unix standard programs because they usually act as filters. The main difference with classical Unix programs is that text files are not analyzed line per line but sequence record per sequence record (see below for a detailed description of a sequence record). Compared to packages for similar purposes like mothur (<span class=\"citation\"><a href=\"#Schloss2009\">Schloss <i>et al.</i> 2009</a></span>) or QIIME (<span class=\"citation\"><a href=\"#Caporaso2010\">Caporaso <i>et al.</i> 2010</a></span>), the OBITools mainly rely on filtering and sorting algorithms. This allows users to set up versatile data analysis pipelines</p>\n\n<p><a href=\"../../images/Obitools/fig-Pipeline.png\" rel=\"noopener noreferrer\"><img src=\"../../images/Obitools/fig-Pipeline.png\" alt=\"OBITools pipeline. \" width=\"1421\" height=\"1361\" loading=\"lazy\" /></a></p>\n\n<p>Most of the OBITools commands read sequence records from a file or from the stdin, make some computations on the sequence records and output annotated sequence records. As inputs, the OBITools are able to automatically recognize the most common sequence file formats (i.e. FASTA, FASTQ, EMBL, and GenBank). They are also able to read ecoPCR (<span class=\"citation\"><a href=\"#Ficetola2010\">Ficetola <i>et al.</i> 2010</a></span>) result files and ecoPCR/ecoPrimers formatted sequence databases (<span class=\"citation\"><a href=\"#Riaz2011\">Riaz <i>et al.</i> 2011</a></span>) as ordinary sequence files. File format outputs are more limited. By default, sequences without and with quality information are written in FASTA and FASTQ formats, respectively. However, dedicated options allow enforcing the output format, and the OBITools are also able to write sequences in the ecoPCR/ecoPrimers database format, to produce reference databases for these programs. In FASTA or FASTQ format, the attributes are written in the header line just after the id, following a key=value; format.</p>\n\n<p><a href=\"../../images/Obitools/fig-Record.png\" rel=\"noopener noreferrer\"><img src=\"../../images/Obitools/fig-Record.png\" alt=\"OBITools attributes records. \" width=\"1058\" height=\"935\" loading=\"lazy\" /></a></p>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n  <p>In this tutorial, we will cover:</p>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#manage-input-data\" id=\"markdown-toc-manage-input-data\">Manage input data</a>    <ol>\n      <li><a href=\"#get-data\" id=\"markdown-toc-get-data\">Get data</a></li>\n      <li><a href=\"#unzip-the-downloaded-archive\" id=\"markdown-toc-unzip-the-downloaded-archive\"><strong>Unzip</strong> the downloaded archive</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#use-obitools\" id=\"markdown-toc-use-obitools\">Use OBITools</a>    <ol>\n      <li><a href=\"#micro-assembly-of-paired-end-sequences-with-illuminapairedend\" id=\"markdown-toc-micro-assembly-of-paired-end-sequences-with-illuminapairedend\">Micro assembly of paired-end sequences with <strong>illuminapairedend</strong></a></li>\n      <li><a href=\"#remove-unaligned-sequence-records-with-obigrep\" id=\"markdown-toc-remove-unaligned-sequence-records-with-obigrep\">Remove unaligned sequence records with <strong>obigrep</strong></a></li>\n      <li><a href=\"#assign-each-sequence-record-to-the-corresponding-samplemarker-combination-with-ngsfilter\" id=\"markdown-toc-assign-each-sequence-record-to-the-corresponding-samplemarker-combination-with-ngsfilter\">Assign each sequence record to the corresponding sample/marker combination with <strong>NGSfilter</strong></a></li>\n      <li><a href=\"#dereplicate-reads-into-uniq-sequences-with-obiuniq\" id=\"markdown-toc-dereplicate-reads-into-uniq-sequences-with-obiuniq\">Dereplicate reads into uniq sequences with <strong>obiuniq</strong></a></li>\n      <li><a href=\"#limit-number-of-informations-with-obiannotate\" id=\"markdown-toc-limit-number-of-informations-with-obiannotate\">Limit number of informations with <strong>obiannotate</strong></a></li>\n      <li><a href=\"#computes-basic-statistics-for-attribute-values-with-obistat\" id=\"markdown-toc-computes-basic-statistics-for-attribute-values-with-obistat\">Computes basic statistics for attribute values with <strong>obistat</strong></a></li>\n      <li><a href=\"#filtering-sequances-by-count-and-length-with-obigrep\" id=\"markdown-toc-filtering-sequances-by-count-and-length-with-obigrep\">Filtering sequances by count and length with <strong>obigrep</strong></a></li>\n      <li><a href=\"#clean-the-sequences-for-pcrsequencing-errors-sequence-variants-with-obiclean\" id=\"markdown-toc-clean-the-sequences-for-pcrsequencing-errors-sequence-variants-with-obiclean\">Clean the sequences for PCR/sequencing errors (sequence variants) with <strong>obiclean</strong></a></li>\n      <li><a href=\"#taxonomic-assignment-of-sequences-with-ncbi-blast-blastn\" id=\"markdown-toc-taxonomic-assignment-of-sequences-with-ncbi-blast-blastn\">Taxonomic assignment of sequences with <strong>NCBI BLAST+ blastn</strong></a></li>\n      <li><a href=\"#filter-database-and-query-sequences-by-id-to-re-associate-informations-with-filter-sequences-by-id\" id=\"markdown-toc-filter-database-and-query-sequences-by-id-to-re-associate-informations-with-filter-sequences-by-id\">Filter database and query sequences by ID to re associate informations with <strong>Filter sequences by ID</strong></a></li>\n      <li><a href=\"#from-fasta-to-tabular-with-obitab\" id=\"markdown-toc-from-fasta-to-tabular-with-obitab\">From FASTA to tabular with <strong>Obitab</strong></a></li>\n      <li><a href=\"#create-a-final-synthesis-as-a-tabular-file\" id=\"markdown-toc-create-a-final-synthesis-as-a-tabular-file\">create a final synthesis as a tabular file</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#conclusion\" id=\"markdown-toc-conclusion\">Conclusion</a></li>\n</ol>\n\n</blockquote>\n\n<h1 id=\"manage-input-data\">Manage input data</h1>\n<p>The data needed to run the tutorial are the following:</p>\n\n<ul>\n  <li>FASTQ files resulting from a GA IIx (Illumina) paired-end (2 x 108 bp) sequencing assay of DNA extracted and amplified from four wolf faeces:\n    <ul>\n      <li>wolf_F.fastq</li>\n      <li>wolf_R.fastq</li>\n    </ul>\n  </li>\n  <li>the file describing the primers and tags used for all samples sequenced:\n    <ul>\n      <li>wolf_diet_ngsfilter.txt</li>\n    </ul>\n  </li>\n  <li>the tags correspond to short and specific sequences added on the 5’ end of each primer to distinguish the different samples</li>\n  <li>the file containing the reference database in a fasta format:\n  -db_v05_r117.fasta This reference database has been extracted from the release 117 of EMBL using ecoPCR</li>\n</ul>\n\n<h2 id=\"get-data\">Get data</h2>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Data upload</hands-on-title>\n\n  <ol>\n    <li>Create a new history for this tutorial</li>\n    <li>\n      <p>Import the zip archive containing input files from <a href=\"https://zenodo.org/record/5932108/files/wolf_tutorial.zip\">Zenodo</a></p>\n\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/5932108/files/wolf_tutorial.zip\n</code></pre></div>      </div>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-via-links\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-via-links\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing via links</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-data-from-a-data-library\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-data-from-a-data-library\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing data from a data library</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>As an alternative to uploading the data from a URL or your computer, the files may also have been made available from a <em>shared data library</em>:</p>   <ol>   <li>Go into <strong>Shared data</strong> (top panel) then <strong>Data libraries</strong></li>   <li>Navigate to  the correct folder as indicated by your instructor.     <ul>       <li>On most Galaxies tutorial data will be provided in a folder named <strong>GTN - Material –&gt; Topic Name -&gt; Tutorial Name</strong>.</li>     </ul>   </li>   <li>Select the desired files</li>   <li>Click on <strong>Add to History</strong> <i class=\"fas fa-caret-down\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-dropdown</span> near the top and select <strong>as Datasets</strong> from the dropdown menu</li>   <li>     <p>In the pop-up window, choose</p>     <ul>       <li><em>“Select history”</em>: the history you want to import the data to (or create a new one)</li>     </ul>   </li>   <li>Click on <strong>Import</strong></li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>Rename the dataset, here a zip archive, if needed</li>\n    <li>\n      <p>Check that the datatype is <code class=\"language-plaintext highlighter-rouge\">zip</code></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-changing-the-datatype\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-changing-the-datatype\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Changing the datatype</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, click <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Datatypes</strong> tab on the top</li>   <li>In the <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Assign Datatype</strong>, select <code class=\"language-plaintext highlighter-rouge\">datatypes</code> from “<em>New type</em>” dropdown     <ul>       <li>Tip: you can start typing the datatype into the field to filter the dropdown menu</li>     </ul>   </li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h2 id=\"unzip-the-downloaded-archive\"><strong>Unzip</strong> the downloaded archive</h2>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Unzip the downladed .zip archive and prepare unzipped files to be used by OBITools</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/imgteam/unzip/unzip/0.2\" title=\"Unzip tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Unzip</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.2)</span> with the following parameters:\n      <ul>\n        <li><em>“Extract single file”</em>: <code class=\"language-plaintext highlighter-rouge\">All files</code></li>\n      </ul>\n\n      <blockquote class=\"comment\">\n        <comment-title></comment-title>\n\n        <p>To work properly, this unzip Galaxy tool is waiting “simple” archive as input, this means without sub directory.</p>\n      </blockquote>\n    </li>\n    <li>\n      <p>Add to each datafile a tag and/or modify names (<em>optional</em>)</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-adding-a-tag\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-adding-a-tag\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Adding a tag</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ol>   <li>Click on the dataset to expand it</li>   <li>Click on <strong>Add Tags</strong> <i class=\"fas fa-tags\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-tags</span></li>   <li>Add a tag  starting with <code class=\"language-plaintext highlighter-rouge\">#</code>     <ul>       <li>Tags starting with <code class=\"language-plaintext highlighter-rouge\">#</code> will be automatically propagated to the outputs of tools using this dataset.</li>     </ul>   </li>   <li>Press <kbd>Enter</kbd></li>   <li>Check that the tag appears below the dataset name</li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Unhide all dataset from the resulting data collection so you can use these files independently.</p>\n    </li>\n    <li>Modify datatype from txt to tabular for the <code class=\"language-plaintext highlighter-rouge\">wolf_diet_ngsfilter</code> dataset</li>\n  </ol>\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>Why do we need to unhide manually datasets from the data collection?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>Data collection is a functionality often used to deal with multiple datasets on the same format who can be analysed in batch mode. Here, the data collection is populated with heterogenous datafiles, coming from an archive. We thus need to treat separately each dataset of the collection, and to do so, we need to unhide corresponding datasets from the history, as datasets inside collections are just like “symbolic link” to “classical” history datasets hidden by default.</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<h1 id=\"use-obitools\">Use OBITools</h1>\n\n<p>OBITools (<span class=\"citation\"><a href=\"#Boyer2015\">Boyer <i>et al.</i> 2015</a></span>) is a set of programs specifically designed for analyzing NGS data in a DNA metabarcoding context, taking into account taxonomic information. It is distributed as an open source software available on the following website: <a href=\"http://metabarcoding.org/obitools\">http://metabarcoding.org/obitools</a>.</p>\n\n<p>The OBITools commands consider a sequence record as an entity composed of five distinct elements. Two of them are mandatory, the identifier (id) and the DNA or protein sequence itself. The id is a single word composed of characters, digits, and other symbols like dots or underscores excluding spaces. Formally, the ids should be unique within a dataset and should identify each sequence record unambiguously, but only a few OBITools actually rely on this property. The three other elements composing a sequence record are optional. They consist in a sequence definition, a quality vector, and a set of attributes. The last element is a set of attributes qualifying the sequence, each attribute being described by a key=value pair. The set of attributes is the central concept of the OBITools system. When an OBITools command is run on the sequence records included in a dataset, the result of the computation often consist in the addition of new attributes completing the annotation of each sequence record. This strategy of sequence annotation allows the OBITools to return their results as a new sequence record file that can be used as the input of another OBITools program, ultimately creating complex pipelines (source: <a href=\"https://pythonhosted.org/OBITools/welcome.html\">OBITools Welcome</a>).</p>\n\n<h2 id=\"micro-assembly-of-paired-end-sequences-with-illuminapairedend\">Micro assembly of paired-end sequences with <strong>illuminapairedend</strong></h2>\n\n<p>When using the result of a paired-end sequencing assay with supposedly overlapping forward and reverse reads, the first step is to recover the assembled sequence.</p>\n\n<p>The forward and reverse reads of the same fragment are at the same line position in the two FASTQ files obtained after sequencing. Based on these two files, the assembly of the forward and reverse reads is done with the <strong>illuminapairedend</strong> utility that aligns the two reads and returns the reconstructed sequence.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Recover consensus sequences from overlapping forward and reverse reads.</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/obi_illumina_pairend/obi_illumina_pairend/1.2.13\" title=\"illuminapairedend tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>illuminapairedend</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.2.13)</span> with the following parameters:\n      <ul>\n        <li><em>“Read from file”</em>: <code class=\"language-plaintext highlighter-rouge\">wolf_F</code> for the 3p file</li>\n        <li><em>“Read from file”</em>: <code class=\"language-plaintext highlighter-rouge\">wolf_R</code> for the 5p file</li>\n        <li><em>“minimum score for keeping aligment”</em>: <code class=\"language-plaintext highlighter-rouge\">40.0</code></li>\n      </ul>\n\n      <blockquote class=\"comment\">\n        <comment-title></comment-title>\n\n        <p>Sequence records corresponding to the same read pair must be in the same order in the two files !</p>\n\n        <p>If the alignment score is below the defined score, here 40, the forward and reverse reads are not aligned but concatenated, and the value of the mode attribute in the sequence header is set to joined instead of alignment</p>\n      </blockquote>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h2 id=\"remove-unaligned-sequence-records-with-obigrep\">Remove unaligned sequence records with <strong>obigrep</strong></h2>\n\n<p>In this step we are going to use the value of the mode attribute in the sequence header of the illuminapairedend output file to discard sequences indicated as “joined”, so not assembled (“alignment”) (see explanation about this mode on the previous step)</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Remove unaligned sequence records</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/obi_grep/obi_grep/1.2.13\" title=\"obigrep tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>obigrep</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.2.13)</span> with the following parameters:\n      <ul>\n        <li><em>“Input sequences file”</em>: <code class=\"language-plaintext highlighter-rouge\">ilumimnapairedend fastq groomer output file</code></li>\n        <li><em>“Choose the sequence record selection option”</em>: <code class=\"language-plaintext highlighter-rouge\">predicat</code>\n          <ul>\n            <li><em>“Python boolean expression to be evaluated for each sequence record.”</em>: <code class=\"language-plaintext highlighter-rouge\">mode!=\"joined\"</code></li>\n          </ul>\n        </li>\n      </ul>\n\n      <blockquote class=\"tip\">\n        <tip-title>Verifying FastQ format and converting it</tip-title>\n\n        <ul>\n          <li>You can use <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/devteam/fastqc/fastqc/0.73+galaxy0\" title=\"FastQC tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>FastQC</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.73+galaxy0)</span> to look at the format of the sequencing encoding score then <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/devteam/fastq_groomer/fastq_groomer/1.1.5\" title=\"FASTQ GROOMER tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>FASTQ GROOMER</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.1.5)</span> to specify the guessed sequencing encoding score and create a fastqsanger file.</li>\n        </ul>\n\n      </blockquote>\n\n      <blockquote class=\"comment\">\n        <comment-title></comment-title>\n\n        <p>The obigrep command is in some way analog to the standard Unix grep command. It selects a subset of sequence records from a sequence file.</p>\n\n        <p>A sequence record is a complex object composed of an identifier, a set of attributes (key=value), a definition, and the sequence itself.</p>\n\n        <p>Instead of working text line by text line as the standard Unix tool, selection is done sequence record by sequence record. A large set of options allows refining selection on any of the sequence record elements.</p>\n\n        <p>Moreover obigrep allows specifying simultaneously several conditions (that take the value TRUE or FALSE) and only the sequence records that fulfill all the conditions (all conditions are TRUE) are selected. You can refer to <a href=\"https://pythonhosted.org/OBITools/scripts/obigrep.html\">https://pythonhosted.org/OBITools/scripts/obigrep.html</a> for more details</p>\n      </blockquote>\n    </li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>How do you verify the operation is successful?</li>\n    <li>How many sequences are kept? Discarded?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>you can search in the input file content the presence of <code class=\"language-plaintext highlighter-rouge\">mode=joined</code> and same on the output file (just clicking the eye to visualize the content of each file and typing CTRL+C for example to search <code class=\"language-plaintext highlighter-rouge\">mode=joined</code> in the file, or using a regex Galaxy tool for example). You can also at least look at the size of the output file, if smaller than input file, this is a first good indication.</li>\n      <li>You can use a Galaxy tool like <code class=\"language-plaintext highlighter-rouge\">Line/Word/Character count of a dataset</code> to count the number of lines of each dataset (input and output of obigrep) and divided by 4 (as in a FastQ file, each sequence is represented by a block of 4 lines). 45 276 sequences for input file. 44 717 for output file. Thus 559 sequences discarded.</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<h2 id=\"assign-each-sequence-record-to-the-corresponding-samplemarker-combination-with-ngsfilter\">Assign each sequence record to the corresponding sample/marker combination with <strong>NGSfilter</strong></h2>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Assigns sequence records to the corresponding experiment/sample based on DNA tags and primers</hands-on-title>\n\n  <blockquote class=\"comment\">\n    <comment-title></comment-title>\n\n    <p>Each sequence record is assigned to its corresponding sample and marker using the data provided in a text file (here wolf_diet_ngsfilter.txt). This text file contains one line per sample, with the name of the experiment (several experiments can be included in the same file), the name of the tags (for example: aattaac if the same tag has been used on each extremity of the PCR products, or aattaac:gaagtag if the tags were different), the sequence of the forward primer, the sequence of the reverse primer, the letter T or F for sample identification using the forward primer and tag only or using both primers and both tags, respectively.</p>\n  </blockquote>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/obi_ngsfilter/obi_ngsfilter/1.2.13\" title=\"NGSfilter tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>NGSfilter</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.2.13)</span> with the following parameters:\n      <ul>\n        <li><em>“Parameter file”</em>: <code class=\"language-plaintext highlighter-rouge\">wolf_diet_ngsfilter</code></li>\n        <li><em>“Read from file”</em>: <code class=\"language-plaintext highlighter-rouge\">obigrep output</code></li>\n        <li><em>“Number of errors allowed for matching primers”</em>: <code class=\"language-plaintext highlighter-rouge\">2</code></li>\n        <li><em>“Output data type”</em>: <code class=\"language-plaintext highlighter-rouge\">fastq</code></li>\n      </ul>\n\n      <blockquote class=\"tip\">\n        <tip-title>Be sure the text file is in tabular datatype</tip-title>\n\n        <ul>\n          <li>If you are sure the format is compatible with a tabular datatype, as this is the case here ;), you can manually change it, clicking on the eye of the “wolf_diet_ngsfilter.txt” dataset, then selecting the “Datatypes” section then affecting manually tabular and saving the operation</li>\n        </ul>\n\n      </blockquote>\n    </li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>How many sequences are not assigned?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>1391</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<h2 id=\"dereplicate-reads-into-uniq-sequences-with-obiuniq\">Dereplicate reads into uniq sequences with <strong>obiuniq</strong></h2>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Groups together sequence records</hands-on-title>\n\n  <blockquote class=\"comment\">\n    <comment-title></comment-title>\n\n    <p>The same DNA molecule can be sequenced several times. In order to reduce both file size and computations time, and to get easier interpretable results, it is convenient to work with unique sequences instead of reads. To dereplicate such reads into unique sequences, we use the obiuniq command.\nDefinition: Dereplicate reads into unique sequences</p>\n    <ul>\n      <li>compare all the reads in a data set to each other</li>\n      <li>group strictly identical reads together</li>\n      <li>output the sequence for each group and its count in the original dataset (in this way, all duplicated reads are removed)\n<em>Definition adapted from Seguritan and Rohwer (2001)</em></li>\n    </ul>\n  </blockquote>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/obi_uniq/obi_uniq/1.2.13\" title=\"obiuniq tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>obiuniq</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.2.13)</span> with the following parameters:\n      <ul>\n        <li><em>“Input sequences file”</em>: <code class=\"language-plaintext highlighter-rouge\">Trimmed and annotated file by NGSfilter</code></li>\n        <li><em>“Attribute to merge”</em>: <code class=\"language-plaintext highlighter-rouge\">sample</code></li>\n        <li><em>“Use specific option”</em>: <code class=\"language-plaintext highlighter-rouge\">merge</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>How many sequences you had and how many you finally obtain?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>From 43 326 to 3 962</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<h2 id=\"limit-number-of-informations-with-obiannotate\">Limit number of informations with <strong>obiannotate</strong></h2>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Adds/Edits sequence record annotations</hands-on-title>\n\n  <blockquote class=\"comment\">\n    <comment-title></comment-title>\n\n    <p>obiannotate is the command that allows adding/modifying/removing annotation attributes attached to sequence records.\nOnce such attributes are added, they can be used by the other OBITools commands for filtering purposes or for statistics computing.</p>\n\n    <p>Here, the goal is to keep only <code class=\"language-plaintext highlighter-rouge\">count</code> and <code class=\"language-plaintext highlighter-rouge\">merged_sample</code> key=value attributes!</p>\n  </blockquote>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/obi_annotate/obi_annotate/1.2.13\" title=\"obiannotate tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>obiannotate</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.2.13)</span> with the following parameters:\n      <ul>\n        <li><em>“Input sequences file”</em>: <code class=\"language-plaintext highlighter-rouge\">obiuniq output file</code></li>\n        <li>In <em>“Keep only attribute with key”</em>:\n          <ul>\n            <li><em>“key”</em>: <code class=\"language-plaintext highlighter-rouge\">count</code></li>\n            <li><em>“if you want to specify a second key”</em>: <code class=\"language-plaintext highlighter-rouge\">merged_sample</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h2 id=\"computes-basic-statistics-for-attribute-values-with-obistat\">Computes basic statistics for attribute values with <strong>obistat</strong></h2>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Computes basic statistics for attribute values</hands-on-title>\n\n  <blockquote class=\"comment\">\n    <comment-title></comment-title>\n\n    <p>stats computes basic statistics for attribute values of sequence records. The sequence records can be categorized or not using one or several -c options. By default, only the number of sequence records and the total count are computed for each category. Additional statistics can be computed for attribute values in each category, like:</p>\n    <ul>\n      <li>minimum value (-m option)</li>\n      <li>maximum value (-M option)</li>\n      <li>mean value (-a option)</li>\n      <li>variance (-v option)</li>\n      <li>standard deviation (-s option)</li>\n    </ul>\n\n    <p>The result is a contingency table with the different categories in rows, and the computed statistics in columns.</p>\n  </blockquote>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/obi_stat/obi_stat/1.2.13\" title=\"obistat tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>obistat</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.2.13)</span> with the following parameters:\n      <ul>\n        <li><em>“Input sequences file”</em>: <code class=\"language-plaintext highlighter-rouge\">obiannotate output file</code></li>\n        <li>In <em>“Category attribute”</em>:\n          <ul>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Category attribute”</em>\n              <ul>\n                <li><em>“How would you specify the category attribute key?”</em>: <code class=\"language-plaintext highlighter-rouge\">simply by a key of an attribute</code>\n                  <ul>\n                    <li><em>“Attribute used to categorize the sequence records”</em>: <code class=\"language-plaintext highlighter-rouge\">count</code></li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n        <li><em>“Use a specific option”</em>: <code class=\"language-plaintext highlighter-rouge\">no</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>Can you use this result to say how many sequences occuring only once? You would need to use Galaxy tools like <code class=\"language-plaintext highlighter-rouge\">Sort data in ascending or descending order</code> and ` Select first lines from a dataset` to answer the question</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>3131 sequences are occuring once.</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<h2 id=\"filtering-sequances-by-count-and-length-with-obigrep\">Filtering sequances by count and length with <strong>obigrep</strong></h2>\n\n<p>In this step, we are going to use <em>obigrep</em> in order to keep only the sequences having a count greater or equal to 10 and a length shorter than 80 bp.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>filter sequences with <b>obigrep</b></hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/obi_grep/obi_grep/1.2.13\" title=\"obigrep tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>obigrep</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.2.13)</span> with the following parameters:\n      <ul>\n        <li><em>“Input sequences file”</em>: <code class=\"language-plaintext highlighter-rouge\">obiannotate output file</code></li>\n        <li><em>“Choose the sequence record selection option”</em>: <code class=\"language-plaintext highlighter-rouge\">predicat</code>\n          <ul>\n            <li><em>“Python boolean expression to be evaluated for each sequence record.”</em>: <code class=\"language-plaintext highlighter-rouge\">count&gt;=10</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/obi_grep/obi_grep/1.2.13\" title=\"obigrep tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>obigrep</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.2.13)</span> with the following parameters:\n      <ul>\n        <li><em>“Input sequences file”</em>: <code class=\"language-plaintext highlighter-rouge\">obigrep output file</code></li>\n        <li><em>“Choose the sequence record selection option”</em>: <code class=\"language-plaintext highlighter-rouge\">lmin</code>\n          <ul>\n            <li><em>“lmin”</em>: <code class=\"language-plaintext highlighter-rouge\">80</code></li>\n          </ul>\n        </li>\n      </ul>\n\n      <blockquote class=\"comment\">\n        <comment-title></comment-title>\n        <p>Based on the previous observation, we set the cut-off for keeping sequences for further analysis to a count of 10\nBased on previous knowledge we also remove sequences with a length shorter than 80 bp (option -l) as we know that the amplified 12S-V5 barcode for vertebrates must have a length around 100bp</p>\n      </blockquote>\n    </li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>How many sequences are kept following the “count” filter?</li>\n    <li>How many sequences are kept following the “length” filter?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>178</li>\n      <li>175</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<h2 id=\"clean-the-sequences-for-pcrsequencing-errors-sequence-variants-with-obiclean\">Clean the sequences for PCR/sequencing errors (sequence variants) with <strong>obiclean</strong></h2>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Clean the sequences for PCR/sequencing errors (sequence variants)</hands-on-title>\n\n  <p>As a final denoising step, using the obiclean program, we keep the head sequences that are sequences with no variants with a count greater than 5% of their own count</p>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/obi_clean/obi_clean/1.2.13\" title=\"obiclean tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>obiclean</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.2.13)</span> with the following parameters:\n      <ul>\n        <li><em>“Input sequences file”</em>: <code class=\"language-plaintext highlighter-rouge\">obigrep output file</code></li>\n        <li><em>“attribute containing sample definition”</em>: <code class=\"language-plaintext highlighter-rouge\">merged_sample</code></li>\n        <li><em>“Maximum numbers of differences between two variant sequences (default: 1)”</em>: <code class=\"language-plaintext highlighter-rouge\">1</code></li>\n        <li><em>“Threshold ratio between counts (rare/abundant counts) of two sequence records so that the less abundant one is a variant of the more abundant (default: 1, i.e. all less abundant sequences are variants)”</em>: <code class=\"language-plaintext highlighter-rouge\">0.05</code></li>\n        <li><em>“Do you want to select only sequences with the head status in a least one sample?”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h2 id=\"taxonomic-assignment-of-sequences-with-ncbi-blast-blastn\">Taxonomic assignment of sequences with <strong>NCBI BLAST+ blastn</strong></h2>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Search nucleotide database with nucleotide query sequence(s) from OBITools treatments</hands-on-title>\n\n  <p>Once denoising has been done, the next step in diet analysis is to assign the barcodes to the corresponding species in order to get the complete list of species associated to each sample. Taxonomic assignment of sequences requires a reference database compiling all possible species to be identified in the sample. Assignment is then done based on sequence comparison between sample sequences and reference sequences. We here propose to use BLAST+ blastn.</p>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/devteam/ncbi_blast_plus/ncbi_blastn_wrapper/2.10.1+galaxy0\" title=\"NCBI BLAST+ blastn tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>NCBI BLAST+ blastn</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.10.1+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><em>“Nucleotide query sequence(s)”</em>: <code class=\"language-plaintext highlighter-rouge\">obiclean output file</code></li>\n        <li><em>“Subject database/sequences”</em>: <code class=\"language-plaintext highlighter-rouge\">FASTA file from your history</code></li>\n        <li><em>“Nucleotide FASTA subject file to use instead of a database”</em>: <code class=\"language-plaintext highlighter-rouge\">db_v05_r117</code></li>\n        <li><em>“Set expectation value cutoff”</em>: <code class=\"language-plaintext highlighter-rouge\">0.0001</code></li>\n        <li><em>“Output format”</em>: <code class=\"language-plaintext highlighter-rouge\">Tabular (extended 25 columns)</code></li>\n        <li><em>“Advanced Options”</em>: <code class=\"language-plaintext highlighter-rouge\">Show Advanced Options</code></li>\n        <li>*“Maximum hits to consider/show”: <code class=\"language-plaintext highlighter-rouge\">1</code></li>\n      </ul>\n\n      <blockquote class=\"comment\">\n        <comment-title></comment-title>\n\n        <p>Here we directly use the <code class=\"language-plaintext highlighter-rouge\">db_v05_r117</code> fasta file proposed on the <a href=\"https://pythonhosted.org/OBITools/wolves.html#step-by-step-analysis\">original obitools tutorial</a>. One can mention you can create such a fasta file using same obitools workflow describe before (using obigrep/obiuniq/obigrep/obiannotate) on downloaded EMBL datrabases and taxonomy treated by obitools ecoPCR tool.</p>\n      </blockquote>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h2 id=\"filter-database-and-query-sequences-by-id-to-re-associate-informations-with-filter-sequences-by-id\">Filter database and query sequences by ID to re associate informations with <strong>Filter sequences by ID</strong></h2>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Filter Blast results</hands-on-title>\n\n  <blockquote class=\"comment\">\n    <comment-title></comment-title>\n\n    <p>This tool allows you to re-associate all the reference sequences information, notably the <code class=\"language-plaintext highlighter-rouge\">species_name</code> one so you can see which species are potentially seen on the sample.\nWe will also use it to re-associate all the query sequences information, notably the <code class=\"language-plaintext highlighter-rouge\">merged_sample</code> and <code class=\"language-plaintext highlighter-rouge\">obiclean_count</code> attributes so we can better evaluate quality of the results.</p>\n  </blockquote>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/peterjc/seq_filter_by_id/seq_filter_by_id/0.2.7\" title=\"Filter sequences by ID tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Filter sequences by ID</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.2.7)</span> with the following parameters:\n      <ul>\n        <li><em>“Sequence file to be filtered”</em>: <code class=\"language-plaintext highlighter-rouge\">db_v05_r117</code></li>\n        <li><em>“Filter using the ID list from”</em>: <code class=\"language-plaintext highlighter-rouge\">tabular file</code></li>\n        <li><em>“Tabular file containing sequence identifiers”</em>: <code class=\"language-plaintext highlighter-rouge\">megablast on obiclean output</code></li>\n        <li><em>“Column(s) containing sequence identifiers”</em>: <code class=\"language-plaintext highlighter-rouge\">Column 2</code></li>\n        <li><em>“Output positive matches, negative matches, or both?”</em>: <code class=\"language-plaintext highlighter-rouge\">just positive match</code></li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/peterjc/seq_filter_by_id/seq_filter_by_id/0.2.7\" title=\"Filter sequences by ID tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Filter sequences by ID</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.2.7)</span> with the following parameters:\n      <ul>\n        <li><em>“Sequence file to be filtered”</em>: <code class=\"language-plaintext highlighter-rouge\">obiclean output data</code></li>\n        <li><em>“Filter using the ID list from”</em>: <code class=\"language-plaintext highlighter-rouge\">tabular file</code></li>\n        <li><em>“Tabular file containing sequence identifiers”</em>: <code class=\"language-plaintext highlighter-rouge\">megablast on obiclean output</code></li>\n        <li><em>“Column(s) containing sequence identifiers”</em>: <code class=\"language-plaintext highlighter-rouge\">Column 1</code></li>\n        <li><em>“Output positive matches, negative matches, or both?”</em>: <code class=\"language-plaintext highlighter-rouge\">just positive match</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h2 id=\"from-fasta-to-tabular-with-obitab\">From FASTA to tabular with <strong>Obitab</strong></h2>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Convert fasta filtered files in tabular ones</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/obi_tab/obi_tab/1.2.13\" title=\"obitab tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>obitab</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.2.13)</span> with the following parameters:\n      <ul>\n        <li><em>“Input sequences file”</em>: <code class=\"language-plaintext highlighter-rouge\">db_v05_r117 with matched ID</code></li>\n      </ul>\n\n      <blockquote class=\"comment\">\n        <comment-title></comment-title>\n\n        <p>This tool allows you to convert a fasta file into a tabular one so it is easier to read sequences definitions.</p>\n      </blockquote>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/obi_tab/obi_tab/1.2.13\" title=\"obitab tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>obitab</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.2.13)</span> with the following parameters:\n      <ul>\n        <li><em>“Input sequences file”</em>: <code class=\"language-plaintext highlighter-rouge\">obiclean on data 61 with matched ID</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h2 id=\"create-a-final-synthesis-as-a-tabular-file\">create a final synthesis as a tabular file</h2>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Join blast and obitab files then cut relevant column and apply filters</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"join1\" title=\"Join two datasets side by side on a specified field tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Join two datasets side by side on a specified field</strong></span> with the following parameters:\n      <ul>\n        <li><em>“Join”</em>: <code class=\"language-plaintext highlighter-rouge\">obitab on obiclean output file</code></li>\n        <li><em>“using column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column 1</code></li>\n        <li><em>“with”</em>: <code class=\"language-plaintext highlighter-rouge\">megablast output file</code></li>\n        <li><em>“using column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column 1</code></li>\n        <li><em>“Fill empty columns”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        <li><em>“Fill Columns by”</em>: <code class=\"language-plaintext highlighter-rouge\">Single fill value</code></li>\n        <li><em>“Fill value”</em>: <code class=\"language-plaintext highlighter-rouge\">NA</code></li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"join1\" title=\"Join two datasets side by side on a specified field tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Join two datasets side by side on a specified field</strong></span> with the following parameters:\n      <ul>\n        <li><em>“Join”</em>: last <code class=\"language-plaintext highlighter-rouge\">Join two Datasets output file</code></li>\n        <li><em>“using column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column 26</code></li>\n        <li><em>“with”</em>: <code class=\"language-plaintext highlighter-rouge\">obitab on db_v05_r117 with matched ID output file</code></li>\n        <li><em>“using column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column 1</code></li>\n        <li><em>“Fill empty columns”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        <li><em>“Fill Columns by”</em>: <code class=\"language-plaintext highlighter-rouge\">Single fill value</code></li>\n        <li><em>“Fill value”</em>: <code class=\"language-plaintext highlighter-rouge\">NA</code></li>\n      </ul>\n\n      <blockquote class=\"comment\">\n        <comment-title></comment-title>\n\n        <p>To have something easier to read and understand, we create a tabular file containing only columns with important informations (c1: query sequences names / c3-7: query counts / c50: reference sequences names / c54: family / c59: genus / c51: reference annotations).</p>\n      </blockquote>\n    </li>\n    <li><span class=\"tool\" data-tool=\"Cut1\" title=\"Cut columns from a table tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Cut columns from a table</strong></span> with the following parameters:\n      <ul>\n        <li><em>“Cut columns”</em>: <code class=\"language-plaintext highlighter-rouge\">c1,c3,c4,c5,c6,c7,c50,c54,c59,c51</code></li>\n        <li><em>“From”</em>: last <code class=\"language-plaintext highlighter-rouge\">Join two Datasets output file</code></li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"Filter1\" title=\"Filter data on any column using simple expressions tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Filter data on any column using simple expressions</strong></span> with the following parameters:\n      <ul>\n        <li><em>“Filter”</em>: <code class=\"language-plaintext highlighter-rouge\">Cut output file</code></li>\n        <li><em>“With following condition”</em>: <code class=\"language-plaintext highlighter-rouge\">c3&gt;1000 or c4&gt;1000 or c5&gt;1000 or c6&gt;1000</code></li>\n        <li><em>“Number of header lines to skip”</em>: <code class=\"language-plaintext highlighter-rouge\">1</code></li>\n      </ul>\n\n      <blockquote class=\"comment\">\n        <comment-title></comment-title>\n\n        <p>To keep only data with significative counts.</p>\n      </blockquote>\n    </li>\n  </ol>\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>How many species are identified? You can use <code class=\"language-plaintext highlighter-rouge\">Cut columns from a table</code> and <code class=\"language-plaintext highlighter-rouge\">unique occurences of each record</code> to isolate the <code class=\"language-plaintext highlighter-rouge\">species name</code> column of obitab results.</li>\n    <li>Can you deduce the diet of each sample? You can use tools like <code class=\"language-plaintext highlighter-rouge\">obitab</code> and <code class=\"language-plaintext highlighter-rouge\">Join two Datasets side by side on a specified field</code> to join megablast results to obigrep one and <code class=\"language-plaintext highlighter-rouge\">db_v05_r117 with matched ID</code></li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>1O</li>\n      <li>If we remove human sequences ;), some squirrel (sample:26a_F040644), deer (sample:15a_F730814 + sample:29a_F260619), stag (sample:29a_F260619 + sample:13a_F730603), marmot (sample:26a_F040644), doe (sample:29a_F260619), Grimm’s duiker (sample:29a_F260619).</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<h1 id=\"conclusion\">Conclusion</h1>\n\n<p>You just did a ecological analysis, finding diet from wolves faeces ! So now you know how to preprocess metabarcoding data on Galaxy, producing quantitative informations with quality checks and filtering results to interpret it and to have a synthesis table you can share broadly!</p>\n"],"ref_slides":[],"hands_on":true,"slides":false,"mod_date":"2024-05-29 14:28:52 +0000","pub_date":"2022-02-28 12:32:09 +0000","version":65,"workflows":[{"workflow":"main_workflow.ga","tests":false,"url":"https://training.galaxyproject.org/training-material/topics/ecology/tutorials/Obitools-metabarcoding/workflows/main_workflow.ga","path":"topics/ecology/tutorials/Obitools-metabarcoding/workflows/main_workflow.ga","wfid":"ecology-Obitools-metabarcoding","wfname":"main_workflow","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/ecology-Obitools-metabarcoding/versions/main_workflow","license":null,"creators":[],"name":"Workflow constructed from history 'Tuto Obitools'","title":"Workflow constructed from history 'Tuto Obitools'","test_results":null,"modified":"2024-06-24 07:13:56 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\nwolf_tutorial.zip?download=1\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"Illuminapairedend\"];\n  2[\"Unzip\"];\n  0 -->|output| 2;\n  3[\"FastQC\"];\n  1 -->|output| 3;\n  4[\"FASTQ Groomer\"];\n  1 -->|output| 4;\n  5[\"obigrep\"];\n  4 -->|output_file| 5;\n  6[\"Line/Word/Character count\"];\n  4 -->|output_file| 6;\n  7[\"Line/Word/Character count\"];\n  5 -->|output| 7;\n  8[\"NGSfilter\"];\n  5 -->|output| 8;\n  9[\"obiuniq\"];\n  8 -->|output| 9;\n  10[\"obiannotate\"];\n  9 -->|output| 10;\n  11[\"obistat\"];\n  10 -->|output| 11;\n  12[\"obigrep\"];\n  10 -->|output| 12;\n  13[\"obigrep\"];\n  12 -->|output| 13;\n  14[\"obiclean\"];\n  13 -->|output| 14;\n  15[\"NCBI BLAST+ blastn\"];\n  14 -->|output| 15;\n  16[\"Filter sequences by ID\"];\n  15 -->|output1| 16;\n  17[\"Filter sequences by ID\"];\n  15 -->|output1| 17;\n  14 -->|output| 17;\n  18[\"obitab\"];\n  16 -->|output_pos| 18;\n  19[\"obitab\"];\n  17 -->|output_pos| 19;\n  20[\"Join two Datasets\"];\n  19 -->|output| 20;\n  15 -->|output1| 20;\n  21[\"Join two Datasets\"];\n  20 -->|out_file1| 21;\n  18 -->|output| 21;\n  22[\"Cut\"];\n  21 -->|out_file1| 22;\n  23[\"Filter\"];\n  22 -->|out_file1| 23;"}],"api":"https://training.galaxyproject.org/training-material/api/topics/ecology/tutorials/Obitools-metabarcoding/tutorial.json","tools":["Cut1","Filter1","join1","toolshed.g2.bx.psu.edu/repos/devteam/fastq_groomer/fastq_groomer/1.1.5","toolshed.g2.bx.psu.edu/repos/devteam/fastqc/fastqc/0.73+galaxy0","toolshed.g2.bx.psu.edu/repos/devteam/ncbi_blast_plus/ncbi_blastn_wrapper/2.10.1+galaxy0","toolshed.g2.bx.psu.edu/repos/imgteam/unzip/unzip/0.2","toolshed.g2.bx.psu.edu/repos/iuc/obi_annotate/obi_annotate/1.2.13","toolshed.g2.bx.psu.edu/repos/iuc/obi_clean/obi_clean/1.2.13","toolshed.g2.bx.psu.edu/repos/iuc/obi_grep/obi_grep/1.2.13","toolshed.g2.bx.psu.edu/repos/iuc/obi_illumina_pairend/obi_illumina_pairend/1.2.13","toolshed.g2.bx.psu.edu/repos/iuc/obi_ngsfilter/obi_ngsfilter/1.2.13","toolshed.g2.bx.psu.edu/repos/iuc/obi_stat/obi_stat/1.2.13","toolshed.g2.bx.psu.edu/repos/iuc/obi_tab/obi_tab/1.2.13","toolshed.g2.bx.psu.edu/repos/iuc/obi_uniq/obi_uniq/1.2.13","toolshed.g2.bx.psu.edu/repos/peterjc/seq_filter_by_id/seq_filter_by_id/0.2.7","wc_gnu"],"supported_servers":{"exact":[{"url":"https://usegalaxy.eu","name":"UseGalaxy.eu","usegalaxy":true},{"url":"https://usegalaxy.no/","name":"UseGalaxy.no","usegalaxy":false},{"url":"https://usegalaxy.org.au","name":"UseGalaxy.org.au","usegalaxy":true}],"inexact":[{"url":"https://usegalaxy.cz/","name":"UseGalaxy.cz","usegalaxy":false},{"url":"https://usegalaxy.fr/","name":"UseGalaxy.fr","usegalaxy":false}]},"topic_name_human":"Ecology","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"fastq_groomer","owner":"devteam","revisions":"47e5dbc3e790","tool_panel_section_label":"FASTA/FASTQ","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"fastqc","owner":"devteam","revisions":"3d0c7bdf12f5","tool_panel_section_label":"FASTA/FASTQ","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"ncbi_blast_plus","owner":"devteam","revisions":"5edc472ec434","tool_panel_section_label":"NCBI Blast","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"unzip","owner":"imgteam","revisions":"38eec75fbe9b","tool_panel_section_label":"Collection Operations","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"obi_annotate","owner":"iuc","revisions":"d50dc96e3ce9","tool_panel_section_label":"DNA Metabarcoding","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"obi_clean","owner":"iuc","revisions":"08d873cdd5f6","tool_panel_section_label":"DNA Metabarcoding","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"obi_grep","owner":"iuc","revisions":"02bab5ff7c37","tool_panel_section_label":"DNA Metabarcoding","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"obi_illumina_pairend","owner":"iuc","revisions":"8cb6bd511879","tool_panel_section_label":"DNA Metabarcoding","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"obi_ngsfilter","owner":"iuc","revisions":"91a1ed0b486f","tool_panel_section_label":"DNA Metabarcoding","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"obi_stat","owner":"iuc","revisions":"5f4544915893","tool_panel_section_label":"DNA Metabarcoding","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"obi_tab","owner":"iuc","revisions":"4cf47c504672","tool_panel_section_label":"DNA Metabarcoding","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"obi_uniq","owner":"iuc","revisions":"d4bea99366f9","tool_panel_section_label":"DNA Metabarcoding","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"seq_filter_by_id","owner":"peterjc","revisions":"141612f8c3e3","tool_panel_section_label":"Filter and Sort","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: fastq_groomer\n  owner: devteam\n  revisions: 47e5dbc3e790\n  tool_panel_section_label: FASTA/FASTQ\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: fastqc\n  owner: devteam\n  revisions: 3d0c7bdf12f5\n  tool_panel_section_label: FASTA/FASTQ\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: ncbi_blast_plus\n  owner: devteam\n  revisions: 5edc472ec434\n  tool_panel_section_label: NCBI Blast\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: unzip\n  owner: imgteam\n  revisions: 38eec75fbe9b\n  tool_panel_section_label: Collection Operations\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: obi_annotate\n  owner: iuc\n  revisions: d50dc96e3ce9\n  tool_panel_section_label: DNA Metabarcoding\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: obi_clean\n  owner: iuc\n  revisions: '08d873cdd5f6'\n  tool_panel_section_label: DNA Metabarcoding\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: obi_grep\n  owner: iuc\n  revisions: 02bab5ff7c37\n  tool_panel_section_label: DNA Metabarcoding\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: obi_illumina_pairend\n  owner: iuc\n  revisions: 8cb6bd511879\n  tool_panel_section_label: DNA Metabarcoding\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: obi_ngsfilter\n  owner: iuc\n  revisions: 91a1ed0b486f\n  tool_panel_section_label: DNA Metabarcoding\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: obi_stat\n  owner: iuc\n  revisions: 5f4544915893\n  tool_panel_section_label: DNA Metabarcoding\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: obi_tab\n  owner: iuc\n  revisions: 4cf47c504672\n  tool_panel_section_label: DNA Metabarcoding\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: obi_uniq\n  owner: iuc\n  revisions: d4bea99366f9\n  tool_panel_section_label: DNA Metabarcoding\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: seq_filter_by_id\n  owner: peterjc\n  revisions: 141612f8c3e3\n  tool_panel_section_label: Filter and Sort\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":false,"slides_recordings":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial","contributors":[{"name":"Coline Royaux","email":"coline.royaux@mnhn.fr","twitter":"ColineRoyaux","orcid":"0000-0003-4308-5617","joined":"2020-11","elixir_node":"fr","affiliations":["pndb","gallantries","elixir-europe"],"id":"colineroyaux","url":"https://training.galaxyproject.org/training-material/api/contributors/colineroyaux.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/colineroyaux/"},{"name":"Olivier Norvez","email":"olivier.norvez@mnhn.fr","joined":"2022-02","elixir_node":"fr","affiliations":["elixir-europe"],"id":"onorvez","url":"https://training.galaxyproject.org/training-material/api/contributors/onorvez.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/onorvez/"},{"github":false,"name":"Eric Coissac","joined":"2022-02","id":"ecoissac","url":"https://training.galaxyproject.org/training-material/api/contributors/ecoissac.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/ecoissac/"},{"github":false,"name":"Frédéric Boyer","joined":"2022-02","id":"fboyer","url":"https://training.galaxyproject.org/training-material/api/contributors/fboyer.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/fboyer/"},{"name":"Yvan Le Bras","email":"yvan.le-bras@mnhn.fr","twitter":"Yvan2935","matrix":"yvanlebras:matrix.org","orcid":"0000-0002-8504-068X","joined":"2017-09","elixir_node":"fr","affiliations":["pndb","gallantries","fairease","fnso2019","elixir-europe"],"id":"yvanlebras","url":"https://training.galaxyproject.org/training-material/api/contributors/yvanlebras.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/yvanlebras/"},{"name":"Gallantries: Bridging Training Communities in Life Science, Environment and Health","short_name":"Gallantries","start_date":"2020-09-01","end_date":"2023-09-30","joined":"2020-09","avatar":"https://gallantries.github.io/assets/images/gallantries-logo.png","github":false,"funder":true,"url":"https://training.galaxyproject.org/training-material/api/funders/gallantries.json","funder_name":"Erasmus+ Programme","funding_id":"2020-1-NL01-KA203-064717","funding_system":"erasmusplus","funding_statement":"This project (<a href=\"https://erasmus-plus.ec.europa.eu/projects/search/details/2020-1-NL01-KA203-064717\"><code class=\"language-plaintext highlighter-rouge\">2020-1-NL01-KA203-064717</code></a>) is funded with the support of the Erasmus+ programme of the European Union. Their funding has supported a large number of tutorials within the GTN across a wide array of topics.\n<img src=\"https://gallantries.github.io/assets/images/logosbeneficaireserasmusright_en.jpg\" alt=\"eu flag with the text: with the support of the erasmus programme of the european union\" />\n<img src=\"https://www.erasmusplus.nl/assets/images/logo.png\" alt=\"erasmus plus logo\" />","members":["abretaud","bebatut","colineroyaux","fpsom","hexylena","shiltemann","yvanlebras"],"id":"gallantries","page":"https://training.galaxyproject.org/training-material/hall-of-fame/gallantries/"},{"name":"Pôle National de Données de Biodiversité","url":"https://training.galaxyproject.org/training-material/api/organisations/pndb.json","avatar":"/training-material/shared/images/PNDB_sub.png","github":false,"members":["colineroyaux","Marie59","yvanlebras","ThibaudGlinez"],"id":"pndb","page":"https://training.galaxyproject.org/training-material/hall-of-fame/pndb/"}]}