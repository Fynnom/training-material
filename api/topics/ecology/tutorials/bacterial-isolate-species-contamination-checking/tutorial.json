{"layout":"tutorial_hands_on","title":"Checking expected species and contamination in bacterial isolate","zenodo_link":"https://zenodo.org/record/10572227","questions":["What are the species in bacterial isolate sequencing data?"],"objectives":["Run a series of tool to identify species in bacterial isolate sequencing data","Visualize the species abundance"],"time_estimation":"1H","key_points":["Kraken assigns taxons to sequences","Bracken extracts species from Kraken assignations","Recentrifuge extracts stats and creates visualization from Kraken report"],"tags":["illumina","bacteria","microgalaxy"],"level":"Introductory","edam_ontology":["topic_3673","topic_0622","topic_3301","topic_3697"],"contributions":{"authorship":["bebatut"],"editing":["clsiguret"],"funding":["abromics"]},"js_requirements":{"mathjax":null,"mermaid":false},"short_id":"T00423","url":"/topics/ecology/tutorials/bacterial-isolate-species-contamination-checking/tutorial.html","topic_name":"ecology","tutorial_name":"bacterial-isolate-species-contamination-checking","dir":"topics/ecology/tutorials/bacterial-isolate-species-contamination-checking","symlink":null,"id":"ecology/bacterial-isolate-species-contamination-checking","ref_tutorials":["<p>Sequencing (determining of DNA/RNA nucleotide sequence) is used all over the world for all kinds of analysis. The product of these sequencers are reads, which are sequences of detected nucleotides.</p>\n\n<p>When sequencing bacterial isolates, it might be good to check if the expected species or strains can be identified in the data or if there is any contamination.</p>\n\n<p>To illustrate the process, we take quality-controlled data of a bacterial genome (KUN1163 sample) from sequencing data produced in “Complete Genome Sequences of Eight Methicillin-Resistant <em>Staphylococcus aureus</em> Strains Isolated from Patients in Japan” (<span class=\"citation\"><a href=\"#Hikichi_2019\">Hikichi <i>et al.</i> 2019</a></span>).</p>\n\n<blockquote class=\"quote\" cite=\"https://doi.org/10.1128%2Fmra.01212-19\">\n  <p>Methicillin-resistant <em>Staphylococcus aureus</em> (MRSA) is a major pathogen\ncausing nosocomial infections, and the clinical manifestations of MRSA\nrange from asymptomatic colonization of the nasal mucosa to soft tissue\ninfection to fulminant invasive disease. Here, we report the complete\ngenome sequences of eight MRSA strains isolated from patients in Japan.</p>\n</blockquote>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n  <p>In this tutorial, we will cover:</p>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#galaxy-and-data-preparation\" id=\"markdown-toc-galaxy-and-data-preparation\">Galaxy and data preparation</a></li>\n  <li><a href=\"#taxonomic-profiling\" id=\"markdown-toc-taxonomic-profiling\">Taxonomic profiling</a></li>\n  <li><a href=\"#species-extraction\" id=\"markdown-toc-species-extraction\">Species extraction</a></li>\n  <li><a href=\"#contamination-identification\" id=\"markdown-toc-contamination-identification\">Contamination identification</a></li>\n  <li><a href=\"#conclusion\" id=\"markdown-toc-conclusion\">Conclusion</a></li>\n</ol>\n\n</blockquote>\n\n<h1 id=\"galaxy-and-data-preparation\">Galaxy and data preparation</h1>\n\n<p>Any analysis should get its own Galaxy history. So let’s start by creating a new one and get the data (forward and reverse quality-controlled sequences) into it.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Prepare Galaxy and data</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Create a new history for this analysis</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-new-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-new-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a new history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>Click the <i class=\"fas fa-plus\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">new-history</span> icon at the top of the history panel:</p>   <p><img src=\"/training-material/shared/images/history_create_new.svg\" alt=\"UI for creating new history\" /></p>   <!-- the original drawing can be found here https://docs.google.com/drawings/d/1cCBrLAo4kDGic5QyB70rRiWJAKTenTU8STsKDaLcVU8/edit?usp=sharing --> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Rename the history</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-renaming-a-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-renaming-a-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Renaming a history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ol>   <li>Click on <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> (<strong>Edit</strong>) next to the history name (which by default is “Unnamed history”)</li>   <li>Type the new name</li>   <li>Click on <strong>Save</strong></li> </ol>   <p>If you do not have the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> (<strong>Edit</strong>) next to the history name:</p>   <ol>   <li>Click on <strong>Unnamed history</strong> (or the current name of the history) (<strong>Click to rename history</strong>) at the top of your history panel</li>   <li>Type the new name</li>   <li>Press <kbd>Enter</kbd></li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p><span class=\"tool\" data-tool=\"upload1\" title=\"Import tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Import</strong></span> the quality-controlled sequences from <a href=\"https://zenodo.org/record/10572227\">Zenodo</a> or from Galaxy shared data libraries:</p>\n\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/10572227/files/DRR187559_after_fastp_1.fastq.gz\nhttps://zenodo.org/record/10572227/files/DRR187559_after_fastp_2.fastq.gz\n</code></pre></div>      </div>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-via-links\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-via-links\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing via links</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-data-from-a-data-library\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-data-from-a-data-library\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing data from a data library</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>As an alternative to uploading the data from a URL or your computer, the files may also have been made available from a <em>shared data library</em>:</p>   <ol>   <li>Go into <strong>Shared data</strong> (top panel) then <strong>Data libraries</strong></li>   <li>Navigate to  the correct folder as indicated by your instructor.     <ul>       <li>On most Galaxies tutorial data will be provided in a folder named <strong>GTN - Material –&gt; Topic Name -&gt; Tutorial Name</strong>.</li>     </ul>   </li>   <li>Select the desired files</li>   <li>Click on <strong>Add to History</strong> <i class=\"fas fa-caret-down\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-dropdown</span> near the top and select <strong>as Datasets</strong> from the dropdown menu</li>   <li>     <p>In the pop-up window, choose</p>     <ul>       <li><em>“Select history”</em>: the history you want to import the data to (or create a new one)</li>     </ul>   </li>   <li>Click on <strong>Import</strong></li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h1 id=\"taxonomic-profiling\">Taxonomic profiling</h1>\n\n<p>To find out which microorganisms are present, we will compare the reads of the sample to a reference database, i.e. sequences of known microorganisms stored in a database, using <strong>Kraken2</strong> (<span class=\"citation\"><a href=\"#wood2019improved\">Wood <i>et al.</i> 2019</a></span>).</p>\n\n<!--SNIPPET-->\n<blockquote class=\"details\">   <div class=\"box-title details-title\" id=\"details-kraken2-and-the-k-mer-approach-for-taxonomy-classification\"><button class=\"gtn-boxify-button details\" type=\"button\" aria-controls=\"details-kraken2-and-the-k-mer-approach-for-taxonomy-classification\" aria-expanded=\"true\"><i class=\"fas fa-info-circle\" aria-hidden=\"true\"></i> <span>Details: Kraken2 and the k-mer approach for taxonomy classification</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>In the \\(k\\)-mer approach for taxonomy classification, we use a database containing DNA sequences of genomes whose taxonomy we already know. On a computer, the genome sequences are broken into short pieces of length \\(k\\) (called \\(k\\)-mers), usually 30bp.</p>   <p><strong>Kraken</strong> examines the \\(k\\)-mers within the query sequence, searches for them in the database, looks for where these are placed within the taxonomy tree inside the database, makes the classification with the most probable position, then maps \\(k\\)-mers to the lowest common ancestor (LCA) of all genomes known to contain the given \\(k\\)-mer.</p>   <p><img src=\"/training-material/topics/microbiome/faqs/images/kmers-kraken.jpg\" alt=\"Kraken2\" title=\"Kraken sequence classification algorithm. To classify a sequence, each k-mer in the sequence is mapped to the lowest common ancestor (LCA, i.e. the lowest node) of the genomes that contain that k-mer in the database. The taxa associated with the sequence's k-mers, as well as the taxa's ancestors, form a pruned subtree of the general taxonomy tree, which is used for classification. In the classification tree, each node has a weight equal to the number of k-mers in the sequence associated with the node's taxon. Each root-to-leaf (RTL) path in the classification tree is scored by adding all weights in the path, and the maximal RTL path in the classification tree is the classification path (nodes highlighted in yellow). The leaf of this classification path (the orange, leftmost leaf in the classification tree) is the classification used for the query sequence. Source: &lt;span class=&quot;citation&quot;&gt;&lt;a href=&quot;#Wood2014&quot;&gt;Wood and Salzberg 2014&lt;/a&gt;&lt;/span&gt;\" /></p>   <p><strong>Kraken2</strong> uses a compact hash table, a probabilistic data structure that allows for faster queries and lower memory requirements. It applies a spaced seed mask of <em>s</em> spaces to the minimizer and calculates a compact hash code, which is then used as a search query in its compact hash table; the lowest common ancestor (LCA) taxon associated with the compact hash code is then assigned to the k-mer.</p>   <p>You can find more information about the <strong>Kraken2</strong> algorithm in the paper <a href=\"https://genomebiology.biomedcentral.com/articles/10.1186/s13059-019-1891-0\"><em>Improved metagenomic analysis with Kraken 2</em></a>.</p> </blockquote>\n<p><!--END_SNIPPET--></p>\n\n<p>For this tutorial, we will use the PlusPF database which contains the Standard (archaea, bacteria, viral, plasmid, human, UniVec_Core), protozoa and fungi data.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title> Assign taxonomic labels with Kraken2</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/kraken2/kraken2/2.1.1+galaxy1\" title=\"Kraken2 tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Kraken2</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.1.1+galaxy1)</span> with the following parameters:\n      <ul>\n        <li><em>“Single or paired reads”</em>: <code class=\"language-plaintext highlighter-rouge\">Paired</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Forward strand”</em>: <code class=\"language-plaintext highlighter-rouge\">DRR187559_after_fastp_1</code></li>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Reverse strand”</em>: <code class=\"language-plaintext highlighter-rouge\">DRR187559_after_fastp_2</code></li>\n          </ul>\n        </li>\n        <li><em>“Minimum Base Quality”</em>: <code class=\"language-plaintext highlighter-rouge\">10</code></li>\n        <li>In <em>“Create Report”</em>:\n          <ul>\n            <li><em>“Print a report with aggregrate counts/clade to file”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n          </ul>\n        </li>\n        <li><em>“Select a Kraken2 database”</em>: <code class=\"language-plaintext highlighter-rouge\">PlusPF-16</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<ul>\n  <li>\n    <p><strong>Classification</strong>: tabular files with one line for each sequence classified by Kraken and 5 columns:</p>\n\n    <ol>\n      <li><code class=\"language-plaintext highlighter-rouge\">C</code>/<code class=\"language-plaintext highlighter-rouge\">U</code>: a one letter indicating if the sequence classified or unclassified</li>\n      <li>Sequence ID as in the input file</li>\n      <li>NCBI taxonomy ID assigned to the sequence, or 0 if unclassified</li>\n      <li>Length of sequence in bp (<code class=\"language-plaintext highlighter-rouge\">read1|read2</code> for paired reads)</li>\n      <li>\n        <p>A space-delimited list indicating the lowest common ancestor (LCA) mapping of each k-mer in the sequence</p>\n\n        <p>For example, <code class=\"language-plaintext highlighter-rouge\">562:13 561:4 A:31 0:1 562:3</code> would indicate that:</p>\n        <ol>\n          <li>The first 13 k-mers mapped to taxonomy ID #562</li>\n          <li>The next 4 k-mers mapped to taxonomy ID #561</li>\n          <li>The next 31 k-mers contained an ambiguous nucleotide</li>\n          <li>The next k-mer was not in the database</li>\n          <li>The last 3 k-mers mapped to taxonomy ID #562</li>\n        </ol>\n\n        <p><code class=\"language-plaintext highlighter-rouge\">|:|</code> indicates end of first read, start of second read for paired reads</p>\n      </li>\n    </ol>\n\n    <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code> Column 1\tColumn 2\tColumn 3\tColumn 4\tColumn 5\n C \tDRR187559.1 \t1280 \t164|85 \t0:1 1279:1 0:41 1279:10 0:5 1280:5 1279:1 0:1 1279:1 0:7 1279:5 0:2 1279:6 0:12 1279:5 0:19 1279:2 0:6 |:| 0:39 1279:2 0:6 1279:3 0:1\n C \tDRR187559.2 \t1280 \t70|198 \t0:2 1279:5 0:29 |:| 0:52 1279:5 0:13 1279:3 0:23 1279:2 0:45 1280:1 0:9 1280:3 A:8\n C \tDRR187559.3 \t1279 \t106|73 \t0:4 1279:3 0:36 1279:4 0:10 1279:5 0:3 1279:5 0:2 |:| 0:39\n C \tDRR187559.4 \t1279 \t121|189 \t1279:6 0:17 1279:4 0:28 1279:2 0:30 |:| 0:7 1279:5 0:19 1279:5 0:20 1279:1 0:8 1279:1 0:1 1279:6 0:25 1279:2 0:44 A:11\n C \tDRR187559.5 \t1279 \t68|150 \t1279:2 0:20 1279:3 0:9 |:| 0:10 1279:3 0:24 1279:2 0:9 1279:5 0:21 1279:5 0:20 1279:5 0:9 1279:1 0:2\n C \tDRR187559.6 \t1280 \t137|246 \t0:2 1280:5 0:28 1279:1 0:28 1279:2 0:8 1279:2 0:23 1279:1 0:3 |:| 1279:1 0:2 1279:3 0:61 1279:2 0:14 1279:2 0:97 A:30 \n</code></pre></div>    </div>\n\n    <blockquote class=\"question\">\n      <question-title></question-title>\n\n      <ol>\n        <li>Is the first sequence in the file classified or unclassified?</li>\n        <li>What is the taxonomy ID assigned to the first classified sequence?</li>\n        <li>What is the corresponding taxon?</li>\n      </ol>\n\n      <blockquote class=\"solution\">\n        <solution-title></solution-title>\n        <ol>\n          <li>classified</li>\n          <li>1280</li>\n          <li>1280 corresponds to <a href=\"https://www.ncbi.nlm.nih.gov/datasets/taxonomy/tree/?taxon=1280\">Staphylococcus aureus</a> .</li>\n        </ol>\n      </blockquote>\n    </blockquote>\n  </li>\n  <li>\n    <p><strong>Report</strong>: tabular files with one line per taxon and 6 columns or fields</p>\n\n    <ol>\n      <li>Percentage of fragments covered by the clade rooted at this taxon</li>\n      <li>Number of fragments covered by the clade rooted at this taxon</li>\n      <li>Number of fragments assigned directly to this taxon</li>\n      <li>A rank code, indicating\n        <ul>\n          <li>(U)nclassified</li>\n          <li>(R)oot</li>\n          <li>(D)omain</li>\n          <li>(K)ingdom</li>\n          <li>(P)hylum</li>\n          <li>(C)lass</li>\n          <li>(O)rder</li>\n          <li>(F)amily</li>\n          <li>(G)enus, or</li>\n          <li>(S)pecies</li>\n        </ul>\n\n        <p>Taxa that are not at any of these 10 ranks have a rank code that is formed by using the rank code of the closest ancestor rank with a number indicating the distance from that rank. E.g., <code class=\"language-plaintext highlighter-rouge\">G2</code> is a rank code indicating a taxon is between genus and species and the grandparent taxon is at the genus rank.</p>\n      </li>\n      <li>NCBI taxonomic ID number</li>\n      <li>Indented scientific name</li>\n    </ol>\n\n    <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code> Column 1\tColumn 2\tColumn 3\tColumn 4\tColumn 5\tColumn 6\n 0.24 \t1065 \t1065 \tU \t0 \tunclassified\n 99.76 \t450716 \t14873 \tR \t1 \troot\n 96.44 \t435695 \t2 \tR1 \t131567 \tcellular organisms\n 96.43 \t435675 \t3889 \tD \t2 \tBacteria\n 95.56 \t431709 \t78 \tD1 \t1783272 \tTerrabacteria group\n 95.53 \t431578 \t163 \tP \t1239 \tFirmicutes\n 95.49 \t431390 \t4625 \tC \t91061 \tBacilli\n 94.38 \t426383 \t1436 \tO \t1385 \tBacillales\n 94.04 \t424874 \t2689 \tF \t90964 \tStaphylococcaceae\n 93.44 \t422124 \t234829 \tG \t1279 \tStaphylococcus \n</code></pre></div>    </div>\n\n    <blockquote class=\"question\">\n      <question-title></question-title>\n\n      <ol>\n        <li>How many taxa have been found?</li>\n        <li>What are the percentage on unclassified?</li>\n        <li>What are the domains found?</li>\n      </ol>\n\n      <blockquote class=\"solution\">\n        <solution-title></solution-title>\n\n        <ol>\n          <li>621, as the number of lines</li>\n          <li>0.24%</li>\n          <li>Only Bacteria</li>\n        </ol>\n      </blockquote>\n\n    </blockquote>\n  </li>\n</ul>\n\n<h1 id=\"species-extraction\">Species extraction</h1>\n\n<p>In Kraken output, there are quite a lot of identified taxa with different levels. To extract the species level, we will use <strong>Bracken</strong>.</p>\n\n<p><strong>Bracken</strong> (Bayesian Reestimation of Abundance after Classification with Kraken) is a “simple and worthwile addition to Kraken for better abundance estimates” (<span class=\"citation\"><a href=\"#Ye.2019\">Ye <i>et al.</i> 2019</a></span>). Instead of only using proportions of classified reads, it takes a probabilistic approach to generate final abundance profiles. It works by re-distributing reads in the taxonomic tree: “Reads assigned to nodes above the species level are distributed down to the species nodes, while reads assigned at the strain level are re-distributed upward to their parent species” (<span class=\"citation\"><a href=\"#Lu.2017\">Lu <i>et al.</i> 2017</a></span>).</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Extract species with Bracken</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/bracken/est_abundance/2.9+galaxy0\" title=\"Bracken tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Bracken</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.9+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“Kraken report file”</em>: <strong>Report</strong> output of <strong>Kraken</strong></li>\n        <li>\n          <p><em>“Select a kmer distribution”</em>: <code class=\"language-plaintext highlighter-rouge\">PlusPF</code>, same as for Kraken</p>\n\n          <p>It is important to choose the same database that you also chose for Kraken2</p>\n        </li>\n        <li><em>“Level”</em>: <code class=\"language-plaintext highlighter-rouge\">Species</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p><strong>Bracken</strong> generates one output as a table with 7 columns:</p>\n\n<ul>\n  <li>Taxon name</li>\n  <li>Taxonomy ID</li>\n  <li>Level ID (S=Species, G=Genus, O=Order, F=Family, P=Phylum, K=Kingdom)</li>\n  <li>Kraken assigned reads</li>\n  <li>Added reads with abundance re-estimation</li>\n  <li>Total reads after abundance re-estimation</li>\n  <li>Fraction of total reads</li>\n</ul>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>How many species have been found?</li>\n    <li>Which the species has been the most identified? And in which proportion?</li>\n    <li>What are the other species?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n    <ol>\n      <li>51 (52 lines including 1 line with header)</li>\n      <li><em>Staphylococcus aureus</em> with 95.5% of the reads.</li>\n      <li>Most of the other species are from <em>Staphylococcus</em> genus, so same as <em>Staphylococcus aureus</em>. The other species in really low proportion.</li>\n    </ol>\n  </blockquote>\n</blockquote>\n\n<p>As expected <em>Staphylococcus aureus</em> represents most of the reads in the data.</p>\n\n<h1 id=\"contamination-identification\">Contamination identification</h1>\n\n<p>To explore <strong>Kraken</strong> report and specially to detect more reliably minority organisms or contamination, we will use <strong>Recentrifuge</strong> (<span class=\"citation\"><a href=\"#marti2019recentrifuge\">Martı́ Jose Manuel 2019</a></span>).</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title> Identify contamination </hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/recentrifuge/recentrifuge/1.12.1+galaxy0\" title=\"Recentrifuge tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Recentrifuge</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.12.1+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Select taxonomy file tabular formated”</em>: report of <strong>Kraken2</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n        <li><em>“Type of input file (Centrifuge, CLARK, Generic, Kraken, LMAT)”</em>: <code class=\"language-plaintext highlighter-rouge\">Kraken</code></li>\n        <li>In <em>“Database type”</em>:\n          <ul>\n            <li><em>“Cached database whith taxa ID”</em>: latest</li>\n          </ul>\n        </li>\n        <li>In <em>“Output options”</em>:\n          <ul>\n            <li><em>“Type of extra output to be generated (default on CSV)”</em>: <code class=\"language-plaintext highlighter-rouge\">TSV</code></li>\n            <li><em>“Remove the log file”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n          </ul>\n        </li>\n        <li>In <em>” Fine tuning of algorithm parameters”</em>:\n          <ul>\n            <li><em>“Strain level instead of species as the resolution limit for the robust contamination removal algorithm; use with caution, this is an experimental feature”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p><strong>Recentrifuge</strong> generates 3 outputs:</p>\n\n<ul>\n  <li>\n    <p>A statistic table with general statistics about assignations</p>\n\n    <blockquote class=\"question\">\n      <question-title></question-title>\n\n      <ol>\n        <li>How many sequences have been used?</li>\n        <li>How many sequences have been classified?</li>\n      </ol>\n\n      <blockquote class=\"solution\">\n        <solution-title></solution-title>\n        <ol>\n          <li>451,780</li>\n          <li>450,715</li>\n        </ol>\n      </blockquote>\n    </blockquote>\n  </li>\n  <li>\n    <p>A data table with a report for each taxa</p>\n\n    <blockquote class=\"question\">\n      <question-title></question-title>\n\n      <ol>\n        <li>How many taxa have been kept?</li>\n        <li>What is the lowest level in the data?</li>\n      </ol>\n\n      <blockquote class=\"solution\">\n        <solution-title></solution-title>\n        <ol>\n          <li>185 (189 lines including 3 header lines)</li>\n          <li>The lowest level is strain.</li>\n        </ol>\n      </blockquote>\n    </blockquote>\n  </li>\n  <li>\n    <p>A HTML report with a Krona chart</p>\n\n    <iframe id=\"recentrifuge\" src=\"recentrifuge_report.html\" frameborder=\"0\" width=\"100%\" height=\"900px\"> <a href=\"./images/recentrifuge.png\" rel=\"noopener noreferrer\"><img src=\"./images/recentrifuge.png\" alt=\"Krona chart with multi-layered pie chart representing the community profile with in the center the higher taxonomy levels (i.e. domain) and on the exterior the more detailed ones (i.e. species). \" loading=\"lazy\" /></a> </iframe>\n\n    <blockquote class=\"question\">\n      <question-title></question-title>\n\n      <ol>\n        <li>What is the percentage of classified sequences?</li>\n        <li>When clicking on <em>Staphylococcus aureus</em>, what can we say about the strains?</li>\n        <li>Is there any contamination?</li>\n      </ol>\n\n      <blockquote class=\"solution\">\n        <solution-title></solution-title>\n\n        <ol>\n          <li>99.8%</li>\n          <li>99% of sequences assigned to <em>Staphylococcus aureus</em> are not assigned to any strains, probably because they are too similar to several strains. <em>Staphylococcus aureus</em> subsp. aureus JKD6159 is the strain with the most classified sequences, but only 0.3% of the sequences assigned to <em>Staphylococcus aureus</em>.</li>\n          <li>There is no sign of a possible contamination. Most sequences are classified to taxon on the <em>Staphylococcus aureus</em> taxonomy. Only 3% of the sequences are not classified to <em>Staphylococcus</em>.</li>\n        </ol>\n\n      </blockquote>\n\n    </blockquote>\n  </li>\n</ul>\n\n<h1 id=\"conclusion\">Conclusion</h1>\n\n<p>In this tutorial, we checked bacterial isolate sequencing data for expected species and potential contamination.</p>\n"],"ref_slides":[],"hands_on":true,"slides":false,"mod_date":"2024-04-04 12:40:28 +0000","pub_date":"2024-03-04 11:07:10 +0000","version":5,"workflows":[{"workflow":"Checking-expected-species-and-contamination-in-bacterial-isolate.ga","tests":true,"url":"https://training.galaxyproject.org/training-material/topics/ecology/tutorials/bacterial-isolate-species-contamination-checking/workflows/Checking-expected-species-and-contamination-in-bacterial-isolate.ga","path":"topics/ecology/tutorials/bacterial-isolate-species-contamination-checking/workflows/Checking-expected-species-and-contamination-in-bacterial-isolate.ga","wfid":"ecology-bacterial-isolate-species-contamination-checking","wfname":"checking-expected-species-and-contamination-in-bacterial-isolate","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/ecology-bacterial-isolate-species-contamination-checking/versions/checking-expected-species-and-contamination-in-bacterial-isolate","license":"GPL-3.0-or-later","creators":[{"alternateName":"pimarin","class":"Person","email":"mailto:pierre.marin@france-bioinformatique.fr","familyName":"MARIN","identifier":"0000-0002-8304-138X","name":"Pierre"},{"class":"Person","identifier":"https://orcid.org/0000-0001-9852-1987","name":"Bérénice Batut"}],"name":"Checking expected species and contamination in bacterial isolate","title":"Checking expected species and contamination in bacterial isolate","test_results":null,"modified":"2024-06-17 13:07:03 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\nreverse_reads\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"ℹ️ Input Dataset\\nforward_reads\"];\n  style 1 stroke:#2c3143,stroke-width:4px;\n  2[\"Kraken2\"];\n  1 -->|output| 2;\n  0 -->|output| 2;\n  a408a644-58cd-4f5e-af25-15b5ea63aa76[\"Output\\nkraken_report_reads\"];\n  2 --> a408a644-58cd-4f5e-af25-15b5ea63aa76;\n  style a408a644-58cd-4f5e-af25-15b5ea63aa76 stroke:#2c3143,stroke-width:4px;\n  54b85a53-72ee-4b73-b186-7fd55e8aab9b[\"Output\\nkraken_report_tabular\"];\n  2 --> 54b85a53-72ee-4b73-b186-7fd55e8aab9b;\n  style 54b85a53-72ee-4b73-b186-7fd55e8aab9b stroke:#2c3143,stroke-width:4px;\n  3[\"Bracken\"];\n  2 -->|report_output| 3;\n  ae6c6464-f5f5-4e5b-b616-d38166fc0133[\"Output\\nbracken_report_tsv\"];\n  3 --> ae6c6464-f5f5-4e5b-b616-d38166fc0133;\n  style ae6c6464-f5f5-4e5b-b616-d38166fc0133 stroke:#2c3143,stroke-width:4px;\n  8ca52af9-f839-42b6-aa74-f1a6a1dfbbc8[\"Output\\nbracken_kraken_report\"];\n  3 --> 8ca52af9-f839-42b6-aa74-f1a6a1dfbbc8;\n  style 8ca52af9-f839-42b6-aa74-f1a6a1dfbbc8 stroke:#2c3143,stroke-width:4px;\n  4[\"Recentrifuge\"];\n  2 -->|output| 4;\n  b5694f2d-c8cd-4460-bfff-74fd0792ecb3[\"Output\\nrecentrifuge_stats_tabular\"];\n  4 --> b5694f2d-c8cd-4460-bfff-74fd0792ecb3;\n  style b5694f2d-c8cd-4460-bfff-74fd0792ecb3 stroke:#2c3143,stroke-width:4px;\n  bd947a1d-0443-465f-8658-5d76d9ce69f8[\"Output\\nrecentrifuge_report_html\"];\n  4 --> bd947a1d-0443-465f-8658-5d76d9ce69f8;\n  style bd947a1d-0443-465f-8658-5d76d9ce69f8 stroke:#2c3143,stroke-width:4px;\n  c7457acb-41bc-4191-b3fb-6716e15fbe57[\"Output\\nrecentrifuge_data_tabular\"];\n  4 --> c7457acb-41bc-4191-b3fb-6716e15fbe57;\n  style c7457acb-41bc-4191-b3fb-6716e15fbe57 stroke:#2c3143,stroke-width:4px;\n  94f6ff07-0e06-47ad-88f8-a058d0808537[\"Output\\nrecentrifuge_logfile\"];\n  4 --> 94f6ff07-0e06-47ad-88f8-a058d0808537;\n  style 94f6ff07-0e06-47ad-88f8-a058d0808537 stroke:#2c3143,stroke-width:4px;"}],"api":"https://training.galaxyproject.org/training-material/api/topics/ecology/tutorials/bacterial-isolate-species-contamination-checking/tutorial.json","tools":["toolshed.g2.bx.psu.edu/repos/iuc/bracken/est_abundance/2.9+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/kraken2/kraken2/2.1.1+galaxy1","toolshed.g2.bx.psu.edu/repos/iuc/recentrifuge/recentrifuge/1.12.1+galaxy0","upload1"],"supported_servers":{"exact":[{"url":"https://usegalaxy.eu","name":"UseGalaxy.eu","usegalaxy":true},{"url":"https://usegalaxy.fr/","name":"UseGalaxy.fr","usegalaxy":false}],"inexact":[{"url":"https://galaxy.mesocentre.uca.fr","name":"Galaxy@AuBi","usegalaxy":false},{"url":"https://galaxytrakr.org/","name":"GalaxyTrakr","usegalaxy":false},{"url":"https://usegalaxy.cz/","name":"UseGalaxy.cz","usegalaxy":false},{"url":"https://usegalaxy.org","name":"UseGalaxy.org (Main)","usegalaxy":true}]},"topic_name_human":"Ecology","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"bracken","owner":"iuc","revisions":"1d4bd12f01cf","tool_panel_section_label":"Metagenomic Analysis","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"kraken2","owner":"iuc","revisions":"20e2f64aa1fe","tool_panel_section_label":"Metagenomic Analysis","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"recentrifuge","owner":"iuc","revisions":"b5407cc2bf51","tool_panel_section_label":"Metagenomic Analysis","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: bracken\n  owner: iuc\n  revisions: 1d4bd12f01cf\n  tool_panel_section_label: Metagenomic Analysis\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: kraken2\n  owner: iuc\n  revisions: 20e2f64aa1fe\n  tool_panel_section_label: Metagenomic Analysis\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: recentrifuge\n  owner: iuc\n  revisions: b5407cc2bf51\n  tool_panel_section_label: Metagenomic Analysis\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":false,"slides_recordings":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial","contributors":[{"name":"Bérénice Batut","email":"berenice.batut@gmail.com","twitter":"bebatut","linkedin":"berenicebatut","matrix":"bebatut:matrix.org","orcid":"0000-0001-9852-1987","joined":"2017-09","elixir_node":"fr","contact_for_training":true,"location":{"country":"FR","lat":45.77,"lon":3.08},"fediverse":"https://piaille.fr/@bebatut","fediverse_flavor":"mastodon","affiliations":["gallantries","ifb","elixir-europe"],"id":"bebatut","url":"https://training.galaxyproject.org/training-material/api/contributors/bebatut.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/bebatut/"},{"name":"Clea Siguret","joined":"2024-04","elixir_node":"fr","affiliations":["ifb","elixir-europe"],"id":"clsiguret","url":"https://training.galaxyproject.org/training-material/api/contributors/clsiguret.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/clsiguret/"},{"name":"ABRomics","github":false,"joined":"2024-01","avatar":"/training-material/assets/images/abromics.png","url":"https://training.galaxyproject.org/training-material/api/funders/abromics.json","funder":true,"id":"abromics","page":"https://training.galaxyproject.org/training-material/hall-of-fame/abromics/"}]}