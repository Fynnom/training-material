{"layout":"tutorial_hands_on","title":"Regional GAM","zenodo_link":"https://zenodo.org/record/1324204","edam_ontology":["topic_0610"],"questions":["What are abundance and trends of a butterfly species?"],"objectives":["Obtain and filter/manipulate occurrence data","Compute and visualize phenology of a species through the years","Compute temporal abundance trends"],"time_estimation":"2h30m","key_points":["We sequentially computed phenology, abundance index, trend and model this trend","We learned how to interpret a trend using modeling and data visualization","This tool compute phenology in order to predict missing data, no definitive conclusion can be made on the phenology using this tool"],"tags":["Species populations EBV class","Species traits EBV class","EBV dataset","EBV workflow"],"contributors":[{"name":"Clara Urfer","joined":"2019-03","id":"claraurf","url":"https://training.galaxyproject.org/training-material/api/contributors/claraurf.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/claraurf/"},{"name":"Elisa Michon","joined":"2019-03","id":"emichn","url":"https://training.galaxyproject.org/training-material/api/contributors/emichn.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/emichn/"},{"name":"Yvan Le Bras","email":"yvan.le-bras@mnhn.fr","twitter":"Yvan2935","matrix":"yvanlebras:matrix.org","orcid":"0000-0002-8504-068X","joined":"2017-09","elixir_node":"fr","affiliations":["pndb","gallantries","fairease","fnso2019","elixir-europe"],"id":"yvanlebras","url":"https://training.galaxyproject.org/training-material/api/contributors/yvanlebras.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/yvanlebras/"},{"name":"Bérénice Batut","email":"berenice.batut@gmail.com","twitter":"bebatut","linkedin":"berenicebatut","matrix":"bebatut:matrix.org","orcid":"0000-0001-9852-1987","joined":"2017-09","elixir_node":"fr","contact_for_training":true,"location":{"country":"FR","lat":45.77,"lon":3.08},"fediverse":"https://piaille.fr/@bebatut","fediverse_flavor":"mastodon","affiliations":["gallantries","ifb","elixir-europe"],"id":"bebatut","url":"https://training.galaxyproject.org/training-material/api/contributors/bebatut.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/bebatut/"},{"name":"Simon Benateau","email":"simon.benateau@mnhn.fr","twitter":"sbenateau","joined":"2019-03","elixir_node":"fr","affiliations":["elixir-europe"],"id":"sbenateau","url":"https://training.galaxyproject.org/training-material/api/contributors/sbenateau.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/sbenateau/"}],"js_requirements":{"mathjax":23555,"mermaid":false},"short_id":"T00134","url":"/topics/ecology/tutorials/regionalGAM/tutorial.html","topic_name":"ecology","tutorial_name":"regionalGAM","dir":"topics/ecology/tutorials/regionalGAM","symlink":null,"id":"ecology/regionalGAM","ref_tutorials":["<p>This tutorial will show you how to study species abundance through the computation of a flight curve, abundance index, and trends. It will explain you how to use different <a href=\"https://github.com/RetoSchmucki/regionalGAM\">regionalGAM</a> tools on Galaxy allowing you to deal with datasets containing abundance information for various species per site and per date through a couple of years.</p>\n\n<p>After a certain number of steps, you will be able to extract single species data and study related abundance through the years. The goal of this exercise is to be able to create abundance trend over time and biodiversity indicators. Following these indicators allow to follow trends in terms of population dynamics. You could for example try to predict the occurrences of one specific species in a certain type of environment using the prediction model of climate evolution. Based on charts that you will generate, you could try to explain the evolution of a species with environmental data (temperatures variations, modifications of the environmental conditions).</p>\n\n<p>You will basically learn how to create a file on the basis of which you can create a visual material that can be quite easily understood and therefore be efficient for a large audience.</p>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n  <p>In this tutorial, we will deal with:</p>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#step-1-pre-processing\" id=\"markdown-toc-step-1-pre-processing\">Step 1: Pre-processing</a>    <ol>\n      <li><a href=\"#data-upload\" id=\"markdown-toc-data-upload\">Data upload</a></li>\n      <li><a href=\"#prepare-the-data\" id=\"markdown-toc-prepare-the-data\">Prepare the data</a></li>\n      <li><a href=\"#check-that-the-dataset-contains-only-one-species\" id=\"markdown-toc-check-that-the-dataset-contains-only-one-species\">Check that the dataset contains only one species</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#step-2-analyze-phenology-of-a-species-through-the-years\" id=\"markdown-toc-step-2-analyze-phenology-of-a-species-through-the-years\">Step 2: Analyze phenology of a species through the years</a>    <ol>\n      <li><a href=\"#compute-and-visualize-the-phenology\" id=\"markdown-toc-compute-and-visualize-the-phenology\">Compute and visualize the phenology</a></li>\n      <li><a href=\"#compute-abundance-index-across-sites-and-years\" id=\"markdown-toc-compute-abundance-index-across-sites-and-years\">Compute Abundance Index across sites and years</a></li>\n      <li><a href=\"#compute-a-collated-index-for-each-year-and-estimates-the-temporal-trend\" id=\"markdown-toc-compute-a-collated-index-for-each-year-and-estimates-the-temporal-trend\">Compute a collated index for each year and estimates the temporal trend</a></li>\n      <li><a href=\"#model-temporal-trend\" id=\"markdown-toc-model-temporal-trend\">Model temporal trend</a></li>\n      <li><a href=\"#take-into-account-the-autocorrelation\" id=\"markdown-toc-take-into-account-the-autocorrelation\">Take into account the autocorrelation</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#conclusions\" id=\"markdown-toc-conclusions\">Conclusions</a></li>\n</ol>\n\n</blockquote>\n\n<h1 id=\"step-1-pre-processing\">Step 1: Pre-processing</h1>\n\n<p>The goal of the first step is to upload and prepare the file so that it will be usable for the <em>regional GAM</em> analysis.</p>\n\n<h2 id=\"data-upload\">Data upload</h2>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Data upload</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Create a new history for this tutorial and give it a proper name like <code class=\"language-plaintext highlighter-rouge\">regionalGAM tutorial</code></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-new-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-new-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a new history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>Click the <i class=\"fas fa-plus\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">new-history</span> icon at the top of the history panel:</p>   <p><img src=\"/training-material/shared/images/history_create_new.svg\" alt=\"UI for creating new history\" /></p>   <!-- the original drawing can be found here https://docs.google.com/drawings/d/1cCBrLAo4kDGic5QyB70rRiWJAKTenTU8STsKDaLcVU8/edit?usp=sharing --> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-renaming-a-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-renaming-a-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Renaming a history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ol>   <li>Click on <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> (<strong>Edit</strong>) next to the history name (which by default is “Unnamed history”)</li>   <li>Type the new name</li>   <li>Click on <strong>Save</strong></li> </ol>   <p>If you do not have the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> (<strong>Edit</strong>) next to the history name:</p>   <ol>   <li>Click on <strong>Unnamed history</strong> (or the current name of the history) (<strong>Click to rename history</strong>) at the top of your history panel</li>   <li>Type the new name</li>   <li>Press <kbd>Enter</kbd></li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Import the CSV dataset file with only one species from <a href=\"https://zenodo.org/record/1324204#.W2BmRn7fNE4\">Zenodo</a> or from the data library (ask your instructor)</p>\n\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/1324204/files/regional%20GAM%20data.csv\n</code></pre></div>      </div>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-via-links\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-via-links\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing via links</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-data-from-a-data-library\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-data-from-a-data-library\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing data from a data library</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>As an alternative to uploading the data from a URL or your computer, the files may also have been made available from a <em>shared data library</em>:</p>   <ol>   <li>Go into <strong>Shared data</strong> (top panel) then <strong>Data libraries</strong></li>   <li>Navigate to  the correct folder as indicated by your instructor.     <ul>       <li>On most Galaxies tutorial data will be provided in a folder named <strong>GTN - Material –&gt; Topic Name -&gt; Tutorial Name</strong>.</li>     </ul>   </li>   <li>Select the desired files</li>   <li>Click on <strong>Add to History</strong> <i class=\"fas fa-caret-down\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-dropdown</span> near the top and select <strong>as Datasets</strong> from the dropdown menu</li>   <li>     <p>In the pop-up window, choose</p>     <ul>       <li><em>“Select history”</em>: the history you want to import the data to (or create a new one)</li>     </ul>   </li>   <li>Click on <strong>Import</strong></li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Check that the file contains a header corresponding to: <code class=\"language-plaintext highlighter-rouge\">\"SPECIES\",\"SITE\",\"YEAR\",\"MONTH\",\"DAY\",\"COUNT\"</code>, and that all the non numeric content are between double quotes as “x” and that separators are “,”</p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>This dataset gathers years of records of the presence of butterfly species per site and per day. Columns indicates species names (“SPECIES”), observation site (“SITE”), date of the observation (“YEAR”,”MONTH”,”DAY”) and number of individuals (“COUNT”). It compiles counts for the Gatekeeper (Pironia tithonus) collected between 2003 and 2012 and extracted from five European BMSs (United Kingdom, Netherlands, France, Germany, and Catalonia-Spain). The Gatekeeper has one generation per year and feeds mainly on Poaceae. It is found in the Central and Southern Europe, North Africa Anatolia, and Caucasus.</p>\n\n<figure id=\"figure-1\" style=\"max-width: 90%;\"><img src=\"../../images/regionalGAM/Gatekeeper-Pyronia_tithonus-male.jpg\" alt=\"Gatekeeper (Pironia tithonus). \" width=\"800\" height=\"533\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/regionalGAM/Gatekeeper-Pyronia_tithonus-male.jpg\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 1</strong>:</span> Gatekeeper (Pironia tithonus) Charles J Sharp</figcaption></figure>\n\n<h2 id=\"prepare-the-data\">Prepare the data</h2>\n\n<p>The current dataset contains a lot of data (exact site names for 5 butterfly monitoring scheme). Processing the file in this condition would require time and for the purpose of this tutorial, we will reduce the number of sites. The column with header <code class=\"language-plaintext highlighter-rouge\">SITE</code> of the dataset you are using is really long and the <code class=\"language-plaintext highlighter-rouge\">SITES</code> are classified into sub-sites (like <code class=\"language-plaintext highlighter-rouge\">ESBMS.12</code>, <code class=\"language-plaintext highlighter-rouge\">ESBMS.28</code>, <code class=\"language-plaintext highlighter-rouge\">ESBMS.55</code>, etc).</p>\n\n<p>Here, we will only keep the sites that are in the Netherlands (NLBMS.XX). We want to create a down-sampled file, by selecting the lines where NLBMS is found.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Downsample and hide some information</hands-on-title>\n  <ol>\n    <li><strong>Text reformatting with awk</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Select cells from”</em>: Uploaded CSV dataset file <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n        <li>\n          <p><em>“AWK Program”</em>:</p>\n\n          <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code> NR == 1 { print }\n /NLBMS/ { print }\n</code></pre></div>          </div>\n        </li>\n      </ul>\n    </li>\n  </ol>\n\n  <p>The first line will skip and print the header and the second will print all the lines where NLBMS is found\nWarning: depending on the Galaxy instance your are using, this tool can not appear on the tool panel. Another solution can be to use <strong>Select lines that match an expression</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> to select lines matching ‘NLBMS’ pattern in addition to <strong>Select first lines from a dataset</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> specifying keeping the first line, so the header, then <strong>Concatenate datasets tail-to-head</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> to recreate a CSV file from concatenating the header and NLBMS lines of the original csv file.</p>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>How many sites do you have before and after removing the sites from outside the Netherlands?</p>\n\n  <p>You may need to use a tool like <strong>Count occurrences of each record</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>. If you want to run the same tool with same parameters to several input files, you can directly specify the <i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <strong>Multiple datasets</strong> option on the tool form for the <em>“from dataset”</em> parameter).</p>\n\n  <!--SNIPPET-->\n  <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-select-multiple-datasets\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-select-multiple-datasets\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Select multiple datasets</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ol>   <li>Click on <i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <strong>Multiple datasets</strong></li>   <li>Select several files by keeping the <kbd>Ctrl</kbd> (or <kbd>COMMAND</kbd>) key pressed and clicking on the files of interest</li> </ol> </blockquote>\n  <p><!--END_SNIPPET--></p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n    <p>The dataset contains 280 sites now against 1143 before down-sampling.</p>\n  </blockquote>\n</blockquote>\n\n<blockquote class=\"details\">\n  <details-title>If your original data is in RData format</details-title>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title>Data upload.</hands-on-title>\n    <ol>\n      <li>\n        <p>Import the RData</p>\n\n        <p>For example, you can upload:</p>\n\n        <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/1324204/files/gatekeeper_CM%20.RData\n</code></pre></div>        </div>\n      </li>\n      <li><strong>RData binary file reader</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Rdata binary file to explore”</em>: imported RData</li>\n        </ul>\n      </li>\n      <li><strong>RData parser</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Rdata file to explore”</em>: imported RData</li>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“File with .Rdata content details”</em>: output of <strong>RData binary file reader</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n          <li><em>“Select which attribute(s) you want to extract”</em>: select everything but “trend”</li>\n          <li><em>“Bind variables in a single tabular when its possible”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        </ul>\n      </li>\n    </ol>\n  </blockquote>\n\n  <p>If the tool <strong>RData parser</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> don’t succeed to create a single tabular file, it generates separate files, each of them containing one column. The file with the <code class=\"language-plaintext highlighter-rouge\">TREND</code> header can be let aside as we don’t need it for what will follow.</p>\n\n  <blockquote class=\"question\">\n    <question-title></question-title>\n\n    <p>If Rdata parser fails to generate a single unified tabular file, can you propose a way to regenerate such a dataset ?</p>\n\n    <blockquote class=\"solution\">\n      <solution-title></solution-title>\n      <p>You can do that using:</p>\n      <ol>\n        <li><strong>Paste two files side by side tool</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters:\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“paste”</em>: output from <strong>RData parser</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> headed with “SPECIES”</li>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span><em>“and”</em>: output from <strong>RData parser</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with headed with “SITE”</li>\n          </ul>\n        </li>\n        <li>Repeat <strong>Paste two files side by side</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> executions as many times as there are separated files in order to create a final dataset with all the columns:\n          <ol>\n            <li>Repeat <strong>Paste two files side by side tool</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> to paste the file containing 2 columns with the one headed by <code class=\"language-plaintext highlighter-rouge\">YEAR</code></li>\n            <li>Repeat <strong>Paste two files side by side tool</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> to paste the file containing 3 columns with the one headed by <code class=\"language-plaintext highlighter-rouge\">MONTH</code></li>\n            <li>Repeat <strong>Paste two files side by side tool</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> to paste the file containing 4 columns with the one headed by <code class=\"language-plaintext highlighter-rouge\">DAY</code></li>\n            <li>Repeat <strong>Paste two files side by side tool</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> to paste the file containing 5 columns with the one headed by <code class=\"language-plaintext highlighter-rouge\">COUNT</code></li>\n          </ol>\n        </li>\n      </ol>\n    </blockquote>\n  </blockquote>\n</blockquote>\n\n<h2 id=\"check-that-the-dataset-contains-only-one-species\">Check that the dataset contains only one species</h2>\n\n<p>The second step of any Regional GAM data analysis is making sure to have a dataset of only one specific species that you will then be able to use. If you want to create a graph showing abundance evolution by years of several species, you will have to superimpose the graphs on one another.</p>\n\n<p>As the dataset is quite big and may contain heterogeneous information, we need to know whether the data are about one species or more.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>How many species are taken into account in this dataset?</hands-on-title>\n\n  <ol>\n    <li><strong>Count occurrences of each record</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“from dataset”</em>: output of <strong>Text reformatting with awk</strong></li>\n        <li><em>“Count occurrences of values in column(s)”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 1</code>, the <code class=\"language-plaintext highlighter-rouge\">SPECIES</code> column</li>\n        <li><em>“Delimited by”</em>: <code class=\"language-plaintext highlighter-rouge\">Tab</code></li>\n        <li><em>“How should the results be sorted?”</em>: <code class=\"language-plaintext highlighter-rouge\">With the most common values first</code></li>\n      </ul>\n    </li>\n    <li>Inspect the generated file by clicking on the <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> (eye) icon (<strong>View data</strong>)</li>\n    <li>Check that the dataset is for one species only</li>\n  </ol>\n</blockquote>\n\n<blockquote class=\"details\">\n  <details-title>Datasets containing information about more than one species</details-title>\n\n  <p>If your dataset contains information about more than one species, you can apply the previous steps and then run an extra-step to select one specific species and show all the data corresponding to it.</p>\n\n  <p>As the dataset is quite big and contains heterogeneous information, you want to know whether the data are about one species or more. So the first step consists to count how many species are taken into account in this dataset.</p>\n\n  <p>To test these steps, you can use the following dataset:</p>\n\n  <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/1324204/files/Dataset%20multispecies%20Regional%20GAM.csv\n</code></pre></div>  </div>\n\n  <blockquote class=\"question\">\n    <question-title></question-title>\n\n    <ol>\n      <li>How many species does your initial dataset take into account ?</li>\n      <li>What are their names ?</li>\n    </ol>\n\n    <blockquote class=\"solution\">\n      <solution-title></solution-title>\n\n      <ol>\n        <li>The dataset contains information on 2 different species</li>\n        <li>Their names are “Pyronia tithonus” and “Aglais io”.</li>\n      </ol>\n\n    </blockquote>\n  </blockquote>\n\n  <p>We now need to create a new file containing the data for only one species</p>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title>Creating a new file containing only the data from one species</hands-on-title>\n    <ol>\n      <li>Copy the name of the species you are interested in (for example: “Aglais io”).</li>\n      <li><strong>Filter data on any column using simple expressions</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Filter”</em>: output of <strong>Text reformatting with awk</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n          <li><em>“With following condition”</em>: <code class=\"language-plaintext highlighter-rouge\">c1=='\"Aglais io\"'</code> or (another species name)</li>\n          <li><em>“Number of header lines to skip”</em>: <code class=\"language-plaintext highlighter-rouge\">1</code></li>\n        </ul>\n\n        <p>You can repeat this set of actions as much as necessary, changing only the name of the species taken into account. By doing this, you will obtain separated dataset, each of them containing a different species.</p>\n      </li>\n      <li>Repeat the last step on all the different <code class=\"language-plaintext highlighter-rouge\">outputs</code> from <strong>Filter data on any column using simple expressions</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> that you have, one by species</li>\n      <li>Tag your new dataset with an explicit tags as “Count” and “Aglais io” and/or rename this dataset like “Aglais io count file”.</li>\n    </ol>\n  </blockquote>\n\n  <p>If you want to create a graph showing abundance evolution by years of several species, you will have to superimpose the graphs on one another.</p>\n</blockquote>\n\n<h1 id=\"step-2-analyze-phenology-of-a-species-through-the-years\">Step 2: Analyze phenology of a species through the years</h1>\n\n<h2 id=\"compute-and-visualize-the-phenology\">Compute and visualize the phenology</h2>\n\n<p><a href=\"https://en.wikipedia.org/wiki/Phenology\">Phenology</a>, as described in Wikipedia, is the study of periodic plant and animal life cycle events and how these are influenced by seasonal and inter-annual variations in climate, as well as habitat factors (such as elevation).</p>\n\n<p>Now you have a file containing all the data on the species of interest. The main goal of this step is to model one phenology per year using a general additive model (GAM) with time and sites as explanatory variables. This model will be used to predict values for missing counts at local sites in order to improve the quality of the abundance indices.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Phenology</hands-on-title>\n  <ol>\n    <li><strong>Flight curve</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Count file”</em>: output file you just generated with the <strong>Text reformatting with awk</strong> or <strong>Filter data on any column using simple expressions</strong> if your file was containing more than one species <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n      </ul>\n    </li>\n    <li>Generate the chart using the visualization\n      <ol>\n        <li>Inspect and expand the output data from <strong>Flight curve</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n        <li>Click on the <i class=\"fas fa-chart-column\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-barchart</span> (<strong>Visualize</strong>) icon</li>\n        <li>Select <strong>Line chart (NVD3)</strong> as visualization type</li>\n        <li>Give it a proper name, e.g. <code class=\"language-plaintext highlighter-rouge\">Pyronia tithonus phenology raw simple vizu</code></li>\n        <li>On <strong>Select data</strong> area, specify:\n          <ul>\n            <li><em>“Provide a label”</em>: <code class=\"language-plaintext highlighter-rouge\">Pyronia tithonus phenology from 2003 to 2012</code> for example</li>\n            <li><em>“Pick a series color”</em>: Choose a color for the line</li>\n            <li><em>“Data point labels”</em>: <code class=\"language-plaintext highlighter-rouge\">Column 1</code></li>\n            <li><em>“Values for x-axis”</em>: <code class=\"language-plaintext highlighter-rouge\">Column 2</code></li>\n            <li><em>“Values for y-axis”</em>: <code class=\"language-plaintext highlighter-rouge\">Column 6</code></li>\n          </ul>\n        </li>\n        <li>On <strong>Change settings</strong>, specify:\n          <ul>\n            <li><em>“X-Axis label”</em>: <code class=\"language-plaintext highlighter-rouge\">Year</code></li>\n            <li><em>“Y-Axis label”</em>: <code class=\"language-plaintext highlighter-rouge\">nm values</code></li>\n          </ul>\n        </li>\n        <li>Click on <strong>Save</strong></li>\n      </ol>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p><a href=\"../../images/regionalGAM/phenology_year.png\" rel=\"noopener noreferrer\"><img src=\"../../images/regionalGAM/phenology_year.png\" alt=\"Phenology chart. \" width=\"4705\" height=\"2860\" loading=\"lazy\" /></a></p>\n\n<p>This graph displays the modeled flight curve of <em>Pyronia tithonus</em> over the years. But the first year is “null”, probably a left-over of the 1st line with the header, and the week number is not shown.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Create a new column of the dataset containing the week and the year</hands-on-title>\n  <ol>\n    <li><strong>Count occurrences of each record</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“from dataset”</em>: output from <strong>Flight curve</strong></li>\n        <li><em>“Select”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 2</code> (the column with the year)</li>\n        <li><em>“Delimited by”</em>: <code class=\"language-plaintext highlighter-rouge\">Tab</code></li>\n        <li><em>“How should the results be sorted?”</em>: <code class=\"language-plaintext highlighter-rouge\">By the values being counted</code></li>\n      </ul>\n    </li>\n    <li>\n      <p>Inspect and expand the output data from <strong>Count occurrences of each record</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></p>\n\n      <blockquote class=\"question\">\n        <question-title></question-title>\n\n        <p>What can you see in this file?</p>\n\n        <blockquote class=\"solution\">\n          <solution-title></solution-title>\n          <p>A list of the years and the number of occurrence for each year which should match the number of days for each year.</p>\n        </blockquote>\n      </blockquote>\n    </li>\n    <li><strong>Column Regex Find And Replace</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“File to process”</em>: output file from <strong>flight curve</strong>.</li>\n        <li><em>“in column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column 2</code> (the column with the year)</li>\n        <li>Click on <em>“Insert Check”</em></li>\n        <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">(20[0-9][0-9])</code></li>\n        <li><em>“Replace with”</em>: <code class=\"language-plaintext highlighter-rouge\">-\\1</code></li>\n      </ul>\n    </li>\n    <li>Inspect the file and check if all the years are now written with a <code class=\"language-plaintext highlighter-rouge\">-</code> before the digits.</li>\n    <li><strong>Merge Columns together</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Select data”</em>: output from the last <strong>Column Regex Find And Replace</strong>.</li>\n        <li><em>“Merge column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 3</code> (the column with the week)</li>\n        <li><em>“with column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 2</code> (the column with the year)</li>\n      </ul>\n    </li>\n    <li><strong>Column Regex Find And Replace</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> to recreate the original content for the year column:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“File to process”</em>: output file from <strong>Merge Columns together</strong>.</li>\n        <li><em>“in column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column 2</code> (the column with the year)</li>\n        <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">-(20[0-9][0-9])</code></li>\n        <li><em>“Replace with”</em>: <code class=\"language-plaintext highlighter-rouge\">\\1</code></li>\n      </ul>\n    </li>\n    <li>\n      <p><strong>Remove beginning of a file</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> to remove first line (to avoid header in the visualization)</p>\n\n      <blockquote class=\"comment\">\n        <comment-title>Dataset with information about more than one species</comment-title>\n        <p>If your dataset contains information about more than one species, you can apply the previous steps and then run an extra-step to select one specific species and show all the data corresponding to it.</p>\n      </blockquote>\n    </li>\n    <li>Generate the chart using the visualization with the x-axis corresponding to your column <code class=\"language-plaintext highlighter-rouge\">\"week\"\"year\"</code>.\n      <ol>\n        <li>Inspect and expand the output data from <strong>Remove beginning of a file</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n        <li>Click on the <i class=\"fas fa-chart-column\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-barchart</span> (<strong>Visualize</strong>) icon</li>\n        <li>Select <strong>Line chart (NVD3)</strong> as visualization type</li>\n        <li>Give it a proper name, e.g. <code class=\"language-plaintext highlighter-rouge\">Pyronia tithonus phenology simple vizu</code></li>\n        <li>On <strong>Select data</strong> area, specify:\n          <ul>\n            <li><em>“Provide a label”</em>: <code class=\"language-plaintext highlighter-rouge\">Pyronia tithonus phenology from 2003 to 2012</code> for example</li>\n            <li><em>“Pick a series color”</em>: Choose a color for the line</li>\n            <li><em>“Data point labels”</em>: <code class=\"language-plaintext highlighter-rouge\">Column 6</code> (the nm column) or another one</li>\n            <li><em>“Values for x-axis”</em>: <code class=\"language-plaintext highlighter-rouge\">Column 7</code> (the “week-year” column)</li>\n            <li><em>“Values for y-axis”</em>: <code class=\"language-plaintext highlighter-rouge\">Column 6</code> (the nm column)</li>\n          </ul>\n        </li>\n        <li>On <strong>Customize</strong>, specify:\n          <ul>\n            <li><em>“X-Axis label”</em>: <code class=\"language-plaintext highlighter-rouge\">Week-Year</code></li>\n            <li><em>“Y-Axis label”</em>: <code class=\"language-plaintext highlighter-rouge\">nm values</code></li>\n          </ul>\n        </li>\n        <li>Click on <strong>Save</strong></li>\n      </ol>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p><a href=\"../../images/regionalGAM/Pyronia_tithonus_phenology_explicit_ID.png\" rel=\"noopener noreferrer\"><img src=\"../../images/regionalGAM/Pyronia_tithonus_phenology_explicit_ID.png\" alt=\"Phenology chart. \" width=\"4705\" height=\"3105\" loading=\"lazy\" /></a></p>\n\n<p>This shows the abundance of <em>Pyronia tithonus</em>, over the weeks. We can see there is a peak every year as expected and we can notice some differences in the values between the weeks and years, but not how the weeks overlap between the years. We will plot a stalked version of this visualization to check if there are no unexpected changes and have an idea of the quality of the reconstructed phenology.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Visualize the years on a stacked graph</hands-on-title>\n  <ol>\n    <li><strong>Scatterplot w ggplot2</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“from dataset”</em>: output from <strong>Flight curve</strong></li>\n        <li><em>“Column to plot on x-axis”</em>: <code class=\"language-plaintext highlighter-rouge\">4</code> (the column with the year)</li>\n        <li><em>“Column to plot on y-axis”</em>: <code class=\"language-plaintext highlighter-rouge\">6</code></li>\n        <li><em>“Plot title”</em>: add a meaningful title (e.g. <code class=\"language-plaintext highlighter-rouge\">Pyronia tithonus phenology stacked visualization</code>)</li>\n        <li><em>“Label for x axis”</em>: add a meaningful label (e.g. <code class=\"language-plaintext highlighter-rouge\">Day number</code>)</li>\n        <li><em>“Label for y axis”</em>: add a meaningful label  (e.g. <code class=\"language-plaintext highlighter-rouge\">nm value</code>)</li>\n        <li><em>“Type of plot”</em>: <code class=\"language-plaintext highlighter-rouge\">Line only</code></li>\n        <li><em>“Plotting multiple groups”</em>: <code class=\"language-plaintext highlighter-rouge\">Plot multiple groups of data on one plot</code> to superimpose years</li>\n        <li><em>“column differentiating the different groups”</em>: <code class=\"language-plaintext highlighter-rouge\">2</code> to affect one coulor by year</li>\n        <li><em>“Color schemes to differentiate your groups”</em>: <code class=\"language-plaintext highlighter-rouge\">set 3</code> or any set of color with more than 10 colors as there are 10 years in our dataset.</li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p><a href=\"../../images/regionalGAM/Pyronia_tithonus_phenology_stacked_explicit_ID.png\" rel=\"noopener noreferrer\"><img src=\"../../images/regionalGAM/Pyronia_tithonus_phenology_stacked_explicit_ID.png\" alt=\"Stacked Phenology chart. \" width=\"2700\" height=\"2100\" loading=\"lazy\" /></a></p>\n\n<p>With this graph, we can see that <em>Pyronia tithonus</em> records are always around the same weeks every year. We can also see small differences between years but overall the phenology is quite stable and the results of this step seem good and allow us to continue with the calculation of the abundance index.</p>\n\n<blockquote class=\"details\">\n  <details-title>Working with more than one species</details-title>\n\n  <p>If you are working with more than one species, you should follow the next steps</p>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title></hands-on-title>\n    <ol>\n      <li><strong>Paste two files side by side</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters:\n        <ul>\n          <li><em>“Paste”</em>: <code class=\"language-plaintext highlighter-rouge\">the output</code> from <strong>Merge Columns together</strong> (with the dataset for species 1)</li>\n          <li><em>“and”</em>: <code class=\"language-plaintext highlighter-rouge\">the output</code> from <strong>Merge Columns together</strong> (with the dataset for species 2)</li>\n          <li><em>“Delimited by”</em>: tabulation</li>\n        </ul>\n      </li>\n    </ol>\n\n    <blockquote class=\"comment\">\n\n      <comment-title>You can add other species.</comment-title>\n      <p>In order to do so you will have to do as explained below:</p>\n      <ol>\n        <li><strong>Paste two files side by side</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters:\n          <ul>\n            <li><em>“Paste”</em>: the <code class=\"language-plaintext highlighter-rouge\">output</code> from <strong>Paste two files side by side</strong> (with the dataset containing species 1 and 2)</li>\n            <li><em>“and”</em>: <code class=\"language-plaintext highlighter-rouge\">the output</code> from <strong>Merge Columns together</strong> (with the dataset containing species 3)</li>\n            <li><em>“Delimited by”</em>: tabulation</li>\n          </ul>\n        </li>\n        <li>Repeat <strong>Paste two files side by side</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the output from <strong>Paste two files side by side</strong> (with the data containing species 1, 2 and 3) and with the output from <strong>Merge Columns together</strong> (with the dataset containing species 4) and so on.</li>\n      </ol>\n    </blockquote>\n  </blockquote>\n\n  <p>If your input dataset contains information about more than one species, you can now generate a chart for the multi-species dataset:</p>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title></hands-on-title>\n    <ol>\n      <li>Inspect and expand the output data from <strong>flight curve</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n      <li>Click on the <i class=\"fas fa-chart-column\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-barchart</span> (<strong>Visualize</strong>) icon</li>\n      <li>Select a visualization: <code class=\"language-plaintext highlighter-rouge\">line chart (NVD3)</code></li>\n      <li>Give it a proper name like <code class=\"language-plaintext highlighter-rouge\">Aglais io &amp; Pyronia tithonus phenology</code></li>\n      <li>Select data\n        <ul>\n          <li><em>“Provide a label”</em>: The name of the first species, for example <code class=\"language-plaintext highlighter-rouge\">Aglais io</code></li>\n          <li><em>“Pick a series color”</em>: Choose a color</li>\n          <li><em>“Data point labels”</em>: <code class=\"language-plaintext highlighter-rouge\">Column corresponding to the name of the species 1</code></li>\n          <li><em>“Values for x-axis”</em>: <code class=\"language-plaintext highlighter-rouge\">Column corresponding to the \"week and year\" of the species 1</code></li>\n          <li><em>“Values for y-axis”</em>: <code class=\"language-plaintext highlighter-rouge\">Column corresponding to nm of the species 1</code></li>\n        </ul>\n      </li>\n      <li>Insert data series:\n        <ul>\n          <li>*“Provide a label”: he name of the second species, for example <code class=\"language-plaintext highlighter-rouge\">Pyronia tithonus</code></li>\n          <li><em>“Pick a series color”</em>: Choose a different color</li>\n          <li><em>“Data point labels”</em>: <code class=\"language-plaintext highlighter-rouge\">Column corresponding to the name of the species 2</code></li>\n          <li><em>“Values for x-axis”</em>: <code class=\"language-plaintext highlighter-rouge\">Column corresponding to the \"week and year\" of the species 2</code></li>\n          <li><em>“Values for y-axis”</em>: <code class=\"language-plaintext highlighter-rouge\">Column corresponding to nm of the species 2</code></li>\n        </ul>\n      </li>\n      <li>You may repeat “Insert data series” as many times as needed depending on the number of different species you want to represent on your chart.</li>\n      <li>Click on <strong>Customize</strong>\n        <ul>\n          <li><em>“X-Axis label”</em>: <code class=\"language-plaintext highlighter-rouge\">Week and Year</code></li>\n          <li><em>“Y-Axis label”</em>: <code class=\"language-plaintext highlighter-rouge\">nm values</code></li>\n          <li><em>“Use multi-panels”</em>: click on <code class=\"language-plaintext highlighter-rouge\">No</code>(or you will have separated charts, one for each species)</li>\n        </ul>\n      </li>\n      <li>Click on <strong>Save</strong> if you are willing to keep it</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<h2 id=\"compute-abundance-index-across-sites-and-years\">Compute Abundance Index across sites and years</h2>\n\n<p>We now would like to create a file showing the abundance index per year of a chosen species in a certain site.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Generate an abundance index</hands-on-title>\n  <ol>\n    <li><strong>Abundance index</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters:\n      <ul>\n        <li><em>“Count file”</em>: output from <strong>Text reformatting with awk</strong>, that should be named <code class=\"language-plaintext highlighter-rouge\">Counting file</code> and/or tagged <code class=\"language-plaintext highlighter-rouge\">Count</code></li>\n        <li><em>“Flight curve output”</em>: output from <strong>flight curve</strong></li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<p><strong>Abundance index</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> generates a table with 5 columns:</p>\n<ul>\n  <li>Site</li>\n  <li>Species</li>\n  <li>Year</li>\n  <li>Regional GAM</li>\n  <li>prop_pheno_sampled</li>\n</ul>\n\n<h2 id=\"compute-a-collated-index-for-each-year-and-estimates-the-temporal-trend\">Compute a collated index for each year and estimates the temporal trend</h2>\n\n<p>The expected temporal trend allows you to have an overview of the evolution of a species in a certain type of environment in the future.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Expected temporal trend</hands-on-title>\n  <ol>\n    <li><strong>Expected temporal trend</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters:\n      <ul>\n        <li><em>“Tabular file generated by the ab_index tool”</em>: output of <strong>abundance index</strong></li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<p><strong>Expected temporal trend</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> generates 2 files”</p>\n<ol>\n  <li>\n    <p>The graph like:</p>\n\n    <p><a href=\"../../images/regionalGAM/Expected_temporal_trend.png\" rel=\"noopener noreferrer\"><img src=\"../../images/regionalGAM/Expected_temporal_trend.png\" alt=\"Expected temporal trend. \" width=\"480\" height=\"480\" loading=\"lazy\" /></a></p>\n  </li>\n  <li>\n    <p>A table with values of “x”, the collated index value by year</p>\n  </li>\n</ol>\n\n<p>Sometimes the expected temporal trend can’t be done on dataset. If you want this action to work, the occurrences on your dataset must lie between the month of April and the end of the month of September.</p>\n\n<h2 id=\"model-temporal-trend\">Model temporal trend</h2>\n\n<p>We would like to know if the year has an influence on the abundance of a species. We will use a linear regression to do that.</p>\n\n<blockquote class=\"details\">\n  <details-title>More details about the statistics</details-title>\n  <p>The model fitted to the data is:\n\\(Y\\_i = \\alpha + \\beta x\\_i + \\epsilon\\_i\\)\nwith \\(Y\\_i\\) = value of the dependent variable for the unit \\(i\\)\n\\(\\alpha\\) = intercept\n\\(\\beta\\) = slope\n\\(x\\_i\\) = value of the explanatory variable for the unit \\(i\\)\n\\(e\\_i\\) = residual for the unit \\(i\\)</p>\n\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Model temporal trend with linear regression</hands-on-title>\n  <ol>\n    <li><strong>Model temporal trend with a simple linear regression</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“File generated by the glmmpql/Expected temporal trend tool”</em>: tabular output of <strong>temporal trend</strong></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“File generated by the ab_index tool”</em>: output from <strong>abundance index</strong></li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<p>Have a look at the text file result. This is the output of the linear model.</p>\n\n<p><a href=\"../../images/regionalGAM/output-simple-linear-regression.png\" rel=\"noopener noreferrer\"><img src=\"../../images/regionalGAM/output-simple-linear-regression.png\" alt=\"Output from the &quot;model temporal trend with simple linear regression&quot; tool . \" width=\"1669\" height=\"826\" loading=\"lazy\" /></a></p>\n\n<p>Details about the output from the tool</p>\n\n<ol>\n  <li>The formula of the model following this format: “Model : dependent variable ~ explanatory variable”</li>\n  <li>The estimated values of the coefficients</li>\n  <li>The standard error of the coefficients</li>\n  <li>The value of the “hypothesis test statistic”</li>\n  <li>The probability value.</li>\n</ol>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>What are the estimates of the regression coefficients?</li>\n    <li>Can we use this model to make good predictions?</li>\n    <li>Is the test p-value significant?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>Intercept is 183.33852 and the slope (Year) is -0.08952.</li>\n      <li>No, the residual standard error is high.</li>\n      <li>Yes (0.0282 &lt; 0.05).</li>\n    </ol>\n\n  </blockquote>\n</blockquote>\n\n<p>We can also test for autocorrelation in the data.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Check if there is autocorrelation of residuals</hands-on-title>\n  <ol>\n    <li><strong>Autocorrelation test check for temporal autocorrelation in the residuals</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters.\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“gls model”</em>: tabular output of <strong>Model temporal trend</strong></li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<p><a href=\"../../images/regionalGAM/Autocorrelation_test.png\" rel=\"noopener noreferrer\"><img src=\"../../images/regionalGAM/Autocorrelation_test.png\" alt=\"Autocorrelation test graph. \" width=\"480\" height=\"480\" loading=\"lazy\" /></a></p>\n\n<p>Have a look at this plot. We can see that one of the value is above the threshold (blue dashed line), therefore we observe autocorrelation in the data. We will now take into account the autocorrelation in the next model.</p>\n\n<h2 id=\"take-into-account-the-autocorrelation\">Take into account the autocorrelation</h2>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Model temporal trend taking into account autocorrelation of residuals</hands-on-title>\n  <ol>\n    <li><strong>Linear regression ajusted for autocorrelation in the residuals</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters.\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“File generated by the glmmpql/Expected temporal trend tool”</em>: tabular output of <strong>temporal trend</strong></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“File generated by the ab_index tool”</em>: output from <strong>abundance index</strong></li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<p>For this step you can use the scratchbook function in order to see the results of both models at the same time.</p>\n\n<blockquote class=\"details\">\n  <details-title>How to use the scratchbook</details-title>\n  <p>You can follow this tutorial if you want to learn how to use the scratchbook.\nhttps://usegalaxy.org/tours/core.scratchbook</p>\n\n</blockquote>\n\n<p><a href=\"../../images/regionalGAM/output-both-models.png\" rel=\"noopener noreferrer\"><img src=\"../../images/regionalGAM/output-both-models.png\" alt=\"Plot of temporal trend with trend line. \" width=\"1308\" height=\"527\" loading=\"lazy\" /></a></p>\n\n<p>Here you can compare the models using the AIC for Akaike information criterion. We can see that the AIC is lower in the model taking the autocorrelation into account. A lower AIC value is associated with less information loss.\nWe will therefore, based on the AIC, select the model taking into account the autocorrelation.\nWe can now represent the data with the trend line from the model.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Plot the data and the trend line from the model</hands-on-title>\n  <ol>\n    <li><strong>Plot abundance with trend line</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters.\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“File generated by the ab_index tool”</em>: output from <strong>abundance index</strong></li>\n        <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“gls model”</em>: outputs of <strong>Model temporal trend with a simple linear regression</strong>.</li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<p><a href=\"../../images/regionalGAM/trend_simple.png\" rel=\"noopener noreferrer\"><img src=\"../../images/regionalGAM/trend_simple.png\" alt=\"Plot of temporal trend with trend line. \" width=\"480\" height=\"480\" loading=\"lazy\" /></a></p>\n\n<p>You can see the trends is an apparent decrease. Here results are statistically significant so we can say that there is a significant decrease of the abundance.</p>\n\n<h1 id=\"conclusions\">Conclusions</h1>\n\n<p>In this tutorial, you have analyzed regional GAM data to extract useful information in order to be able to show different tendencies of a chosen species. Therefore, you are now able to treat the dataset so that it shows only the data for one specific species of your choice. From there, you can show the phenology of this species through the years first on a dataset and then on a visual chart. You have also learned how to represent on a single chart the phenology of various species. Afterwards, we have shown you how to create a dataset containing the information on the abundance of a species per year and per site. Based on which you can henceforth visually represent the annual abundance trend on a chart. Thereafter, you have the possibility of showing the expected temporal trend, based on which you will be able to assess the abundance of species. The last part of this tutorial has shown you how to calculate the linear regression allowing you to determinate whether the year has an influence on the abundance of a species or not.</p>\n"],"ref_slides":[],"video_library":{"tutorial":null,"slides":null,"demo":null,"both":null,"session":null},"hands_on":true,"slides":false,"mod_date":"2024-04-10 10:22:37 +0000","pub_date":"2019-07-04 07:32:28 +0000","version":212,"workflows":[{"workflow":"Galaxy-Workflow-Abundance_index__stacked__visualization_creation.ga","tests":false,"url":"https://training.galaxyproject.org/training-material/topics/ecology/tutorials/regionalGAM/workflows/Galaxy-Workflow-Abundance_index__stacked__visualization_creation.ga","path":"topics/ecology/tutorials/regionalGAM/workflows/Galaxy-Workflow-Abundance_index__stacked__visualization_creation.ga","wfid":"ecology-regionalGAM","wfname":"galaxy-workflow-abundance_index__stacked__visualization_creation","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/ecology-regionalGAM/versions/galaxy-workflow-abundance_index__stacked__visualization_creation","license":null,"creators":[],"name":"Abundance Index \"stacked\" Visualization Creation","title":"Abundance Index \"stacked\" Visualization Creation","test_results":null,"modified":"2024-06-14 07:36:55 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\nAbundance index file\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"Filter\"];\n  0 -->|output| 1;\n  2[\"Filter\"];\n  0 -->|output| 2;\n  3[\"Filter\"];\n  0 -->|output| 3;\n  4[\"Filter\"];\n  0 -->|output| 4;\n  5[\"Filter\"];\n  0 -->|output| 5;\n  6[\"Paste\"];\n  1 -->|out_file1| 6;\n  2 -->|out_file1| 6;\n  7[\"Paste\"];\n  3 -->|out_file1| 7;\n  4 -->|out_file1| 7;\n  8[\"Paste\"];\n  6 -->|out_file1| 8;\n  7 -->|out_file1| 8;\n  9[\"Paste\"];\n  8 -->|out_file1| 9;\n  5 -->|out_file1| 9;"},{"workflow":"Galaxy-Workflow-Phenology__stacked__visualization_creation.ga","tests":false,"url":"https://training.galaxyproject.org/training-material/topics/ecology/tutorials/regionalGAM/workflows/Galaxy-Workflow-Phenology__stacked__visualization_creation.ga","path":"topics/ecology/tutorials/regionalGAM/workflows/Galaxy-Workflow-Phenology__stacked__visualization_creation.ga","wfid":"ecology-regionalGAM","wfname":"galaxy-workflow-phenology__stacked__visualization_creation","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/ecology-regionalGAM/versions/galaxy-workflow-phenology__stacked__visualization_creation","license":null,"creators":[],"name":"Phenology \"stacked\" Visualization Creation","title":"Phenology \"stacked\" Visualization Creation","test_results":null,"modified":"2024-06-14 07:36:55 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\nFlight curve dataset\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"Filter\"];\n  0 -->|output| 1;\n  2[\"Filter\"];\n  0 -->|output| 2;\n  3[\"Paste\"];\n  1 -->|out_file1| 3;\n  2 -->|out_file1| 3;"},{"workflow":"Galaxy-Workflow-Tutorial_regionalGAM_complete_Multispecies.ga","tests":false,"url":"https://training.galaxyproject.org/training-material/topics/ecology/tutorials/regionalGAM/workflows/Galaxy-Workflow-Tutorial_regionalGAM_complete_Multispecies.ga","path":"topics/ecology/tutorials/regionalGAM/workflows/Galaxy-Workflow-Tutorial_regionalGAM_complete_Multispecies.ga","wfid":"ecology-regionalGAM","wfname":"galaxy-workflow-tutorial_regionalgam_complete_multispecies","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/ecology-regionalGAM/versions/galaxy-workflow-tutorial_regionalgam_complete_multispecies","license":null,"creators":[],"name":"Tutorial regionalGAM Complete Multispecies","title":"Tutorial regionalGAM Complete Multispecies","test_results":null,"modified":"2024-06-14 07:36:55 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\nInput dataset\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"CSV to Tabular\"];\n  0 -->|output| 1;\n  10[\"Count\"];\n  8 -->|output| 10;\n  11[\"Column Regex Find And Replace\"];\n  8 -->|output| 11;\n  12[\"Count\"];\n  9 -->|output| 12;\n  13[\"Column Regex Find And Replace\"];\n  9 -->|output| 13;\n  14[\"Merge Columns\"];\n  11 -->|out_file1| 14;\n  15[\"Merge Columns\"];\n  13 -->|out_file1| 15;\n  16[\"Remove beginning\"];\n  14 -->|out_file1| 16;\n  17[\"Remove beginning\"];\n  15 -->|out_file1| 17;\n  18[\"Paste\"];\n  16 -->|out_file1| 18;\n  17 -->|out_file1| 18;\n  2[\"Column Regex Find And Replace\"];\n  1 -->|output| 2;\n  3[\"Count\"];\n  2 -->|out_file1| 3;\n  4[\"Filter\"];\n  2 -->|out_file1| 4;\n  5[\"Filter\"];\n  2 -->|out_file1| 5;\n  6[\"Tabular to CSV\"];\n  4 -->|out_file1| 6;\n  7[\"Tabular to CSV\"];\n  5 -->|out_file1| 7;\n  8[\"Flight curve\"];\n  6 -->|output| 8;\n  9[\"Flight curve\"];\n  7 -->|output| 9;"},{"workflow":"Galaxy-Workflow-Tutorial_training_regionalGAM_complete_workflow.ga","tests":false,"url":"https://training.galaxyproject.org/training-material/topics/ecology/tutorials/regionalGAM/workflows/Galaxy-Workflow-Tutorial_training_regionalGAM_complete_workflow.ga","path":"topics/ecology/tutorials/regionalGAM/workflows/Galaxy-Workflow-Tutorial_training_regionalGAM_complete_workflow.ga","wfid":"ecology-regionalGAM","wfname":"galaxy-workflow-tutorial_training_regionalgam_complete_workflow","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/ecology-regionalGAM/versions/galaxy-workflow-tutorial_training_regionalgam_complete_workflow","license":null,"creators":[],"name":"Regional GAM Workflow","title":"Regional GAM Workflow","test_results":null,"modified":"2024-06-14 07:36:55 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\nregionalGAM.csv\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"Text reformatting\"];\n  0 -->|output| 1;\n  2[\"Count\"];\n  1 -->|outfile| 2;\n  3[\"Flight curve\"];\n  2 -->|out_file1| 3;\n  4[\"Abundance index\"];\n  2 -->|out_file1| 4;\n  3 -->|output| 4;\n  5[\"Scatterplot w ggplot2\"];\n  3 -->|output| 5;\n  6[\"Expected temporal trend\"];\n  4 -->|output| 6;\n  7[\"Model temporal trend\"];\n  4 -->|output| 7;\n  6 -->|output2| 7;\n  8[\"Autocorrelation test\"];\n  7 -->|output2| 8;\n  9[\"Plot abundance\"];\n  4 -->|output| 9;\n  7 -->|output2| 9;"}],"api":"https://training.galaxyproject.org/training-material/api/topics/ecology/tutorials/regionalGAM/tutorial.json","tools":["Count1","Filter1","Paste1","Remove beginning1","mergeCols1","toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_awk_tool/1.1.1","toolshed.g2.bx.psu.edu/repos/ecology/regionalgam_ab_index/regionalgam_ab_index/1.5","toolshed.g2.bx.psu.edu/repos/ecology/regionalgam_autocor_acf/regionalgam_autocor_acf/1.5","toolshed.g2.bx.psu.edu/repos/ecology/regionalgam_flight_curve/regionalgam_flight_curve/1.5","toolshed.g2.bx.psu.edu/repos/ecology/regionalgam_glmmpql/regionalgam_glmmpql/1.5","toolshed.g2.bx.psu.edu/repos/ecology/regionalgam_gls/regionalgam_gls/1.5","toolshed.g2.bx.psu.edu/repos/ecology/regionalgam_plot_trend/regionalgam_plot_trend/1.5","toolshed.g2.bx.psu.edu/repos/galaxyp/regex_find_replace/regexColumn1/1.0.0","toolshed.g2.bx.psu.edu/repos/iuc/ggplot2_point/ggplot2_point/2.2.1+galaxy1","toolshed.g2.bx.psu.edu/repos/mnhn65mo/csv_to_tabular/csv2tab_R/0.1","toolshed.g2.bx.psu.edu/repos/mnhn65mo/regionalgam/flight-curve/1.0.0","toolshed.g2.bx.psu.edu/repos/mnhn65mo/tabular_to_csv/tab2csv_R/0.1"],"supported_servers":{"exact":[],"inexact":[]},"topic_name_human":"Ecology","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"text_processing","owner":"bgruening","revisions":"9ff72e942410","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"regionalgam_ab_index","owner":"ecology","revisions":"d0ee713d4758","tool_panel_section_label":"Species abundance","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"regionalgam_autocor_acf","owner":"ecology","revisions":"b416a363a2d5","tool_panel_section_label":"Species abundance","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"regionalgam_flight_curve","owner":"ecology","revisions":"fff507f00b2b","tool_panel_section_label":"Species abundance","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"regionalgam_glmmpql","owner":"ecology","revisions":"f3e1b6d244a6","tool_panel_section_label":"Species abundance","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"regionalgam_gls","owner":"ecology","revisions":"a79f5f0f17ad","tool_panel_section_label":"Species abundance","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"regionalgam_plot_trend","owner":"ecology","revisions":"58ecd15e6836","tool_panel_section_label":"Species abundance","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"regex_find_replace","owner":"galaxyp","revisions":"209b7c5ee9d7","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"ggplot2_point","owner":"iuc","revisions":"9cec81e1b90e","tool_panel_section_label":"Graph/Display Data","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"csv_to_tabular","owner":"mnhn65mo","revisions":"b735ac78702b","tool_panel_section_label":"Ecology","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"regionalgam","owner":"mnhn65mo","revisions":"0e7066603eab","tool_panel_section_label":"Ecology","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"tabular_to_csv","owner":"mnhn65mo","revisions":"f1b7d0032530","tool_panel_section_label":"Ecology","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: text_processing\n  owner: bgruening\n  revisions: 9ff72e942410\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: regionalgam_ab_index\n  owner: ecology\n  revisions: d0ee713d4758\n  tool_panel_section_label: Species abundance\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: regionalgam_autocor_acf\n  owner: ecology\n  revisions: b416a363a2d5\n  tool_panel_section_label: Species abundance\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: regionalgam_flight_curve\n  owner: ecology\n  revisions: fff507f00b2b\n  tool_panel_section_label: Species abundance\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: regionalgam_glmmpql\n  owner: ecology\n  revisions: f3e1b6d244a6\n  tool_panel_section_label: Species abundance\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: regionalgam_gls\n  owner: ecology\n  revisions: a79f5f0f17ad\n  tool_panel_section_label: Species abundance\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: regionalgam_plot_trend\n  owner: ecology\n  revisions: 58ecd15e6836\n  tool_panel_section_label: Species abundance\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: regex_find_replace\n  owner: galaxyp\n  revisions: 209b7c5ee9d7\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: ggplot2_point\n  owner: iuc\n  revisions: 9cec81e1b90e\n  tool_panel_section_label: Graph/Display Data\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: csv_to_tabular\n  owner: mnhn65mo\n  revisions: b735ac78702b\n  tool_panel_section_label: Ecology\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: regionalgam\n  owner: mnhn65mo\n  revisions: 0e7066603eab\n  tool_panel_section_label: Ecology\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: tabular_to_csv\n  owner: mnhn65mo\n  revisions: f1b7d0032530\n  tool_panel_section_label: Ecology\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial"}