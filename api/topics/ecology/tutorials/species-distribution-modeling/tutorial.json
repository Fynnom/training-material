{"layout":"tutorial_hands_on","title":"Species distribution modeling","questions":["How to build & evaluate a niche model, visualize and project it?"],"objectives":["Find and download occurrences data from GBIF","Find and download environmental data","Process both occurrences and environmental data","Partition occurrence data","Model a theoretical ecological niche and predict species distribution in a future climate scenario by using SDM"],"requirements":null,"time_estimation":"1h","tags":["interactive-tools","modeling","gbif","species populations EBV class"],"key_points":["Use 'classical' Galaxy tools in combination with Interactive tools","Identify general steps of a species distribution modeling aproach"],"contributors":[{"name":"Elisa Michon","joined":"2019-03","id":"emichn","url":"https://training.galaxyproject.org/training-material/api/contributors/emichn.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/emichn/"},{"name":"Yvan Le Bras","email":"yvan.le-bras@mnhn.fr","twitter":"Yvan2935","matrix":"yvanlebras:matrix.org","orcid":"0000-0002-8504-068X","joined":"2017-09","elixir_node":"fr","affiliations":["pndb","gallantries","fairease","fnso2019","elixir-europe"],"id":"yvanlebras","url":"https://training.galaxyproject.org/training-material/api/contributors/yvanlebras.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/yvanlebras/"},{"name":"Bérénice Batut","email":"berenice.batut@gmail.com","twitter":"bebatut","linkedin":"berenicebatut","matrix":"bebatut:matrix.org","orcid":"0000-0001-9852-1987","joined":"2017-09","elixir_node":"fr","contact_for_training":true,"location":{"country":"FR","lat":45.77,"lon":3.08},"fediverse":"https://piaille.fr/@bebatut","fediverse_flavor":"mastodon","affiliations":["gallantries","ifb","elixir-europe"],"id":"bebatut","url":"https://training.galaxyproject.org/training-material/api/contributors/bebatut.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/bebatut/"}],"js_requirements":{"mathjax":null,"mermaid":false},"short_id":"T00135","url":"/topics/ecology/tutorials/species-distribution-modeling/tutorial.html","topic_name":"ecology","tutorial_name":"species-distribution-modeling","dir":"topics/ecology/tutorials/species-distribution-modeling","symlink":null,"id":"ecology/species-distribution-modeling","ref_tutorials":["<p>Species Distribution Modeling (SDM) can help understand a species distribution in relation to its environment. It can also attempt to quantify the impact of climate change on the species’ habitat, direct conservation efforts and predict invasive species distributions. This is acheived by associating species occurrence (observations) data with a set of environmental data (such as temperature and precipitation).</p>\n\n<p>The goal of this tutorial is to model a theoretical ecological niche and predict species distribution in a future climate scenario by using an SDM with the Wallace interactive environment on Galaxy. We’ll use the data occurrences of <em>Chrysemys picta</em> (<a href=\"https://en.wikipedia.org/wiki/Painted_turtle\">Painted turtle</a>) in the US, North America region.</p>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n  <p>In this tutorial, we will deal with:</p>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#step-1-import-data-from-public-databank\" id=\"markdown-toc-step-1-import-data-from-public-databank\">Step 1: Import data from public databank</a></li>\n  <li><a href=\"#step-2-development-and-evaluation-of-the-sdm-using-wallace\" id=\"markdown-toc-step-2-development-and-evaluation-of-the-sdm-using-wallace\">Step 2: Development and evaluation of the SDM using Wallace</a>    <ol>\n      <li><a href=\"#transmit-occurrence-data-from-galaxy-to-wallace\" id=\"markdown-toc-transmit-occurrence-data-from-galaxy-to-wallace\">Transmit occurrence data from Galaxy to Wallace</a></li>\n      <li><a href=\"#process-occurrence-data\" id=\"markdown-toc-process-occurrence-data\">Process occurrence data</a></li>\n      <li><a href=\"#obtain-environmental-data\" id=\"markdown-toc-obtain-environmental-data\">Obtain Environmental Data</a></li>\n      <li><a href=\"#process-environmental-data\" id=\"markdown-toc-process-environmental-data\">Process environmental Data</a></li>\n      <li><a href=\"#partition-occurrence-data\" id=\"markdown-toc-partition-occurrence-data\">Partition Occurrence Data</a></li>\n      <li><a href=\"#build-and-evaluate-niche-model\" id=\"markdown-toc-build-and-evaluate-niche-model\">Build and Evaluate Niche Model</a></li>\n      <li><a href=\"#visualize-model-results\" id=\"markdown-toc-visualize-model-results\">Visualize Model Results</a></li>\n      <li><a href=\"#project-model\" id=\"markdown-toc-project-model\">Project Model</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#conclusion\" id=\"markdown-toc-conclusion\">Conclusion</a></li>\n</ol>\n\n</blockquote>\n\n<h1 id=\"step-1-import-data-from-public-databank\">Step 1: Import data from public databank</h1>\n\n<p>In this study the datasets are all imported from the <a href=\"https://www.gbif.org/\">GBIF</a> databanks. It is also possible to import from <a href=\"https://bison.usgs.gov/\">BISON</a>, <a href=\"https://www.inaturalist.org/\">iNaturalist</a> and others.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Import the data</hands-on-title>\n  <ol>\n    <li>\n      <p>Create a new history for this tutorial and give it a proper name</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-new-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-new-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a new history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>Click the <i class=\"fas fa-plus\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">new-history</span> icon at the top of the history panel:</p>   <p><img src=\"/training-material/shared/images/history_create_new.svg\" alt=\"UI for creating new history\" /></p>   <!-- the original drawing can be found here https://docs.google.com/drawings/d/1cCBrLAo4kDGic5QyB70rRiWJAKTenTU8STsKDaLcVU8/edit?usp=sharing --> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-renaming-a-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-renaming-a-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Renaming a history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ol>   <li>Click on <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> (<strong>Edit</strong>) next to the history name (which by default is “Unnamed history”)</li>   <li>Type the new name</li>   <li>Click on <strong>Save</strong></li> </ol>   <p>If you do not have the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> (<strong>Edit</strong>) next to the history name:</p>   <ol>   <li>Click on <strong>Unnamed history</strong> (or the current name of the history) (<strong>Click to rename history</strong>) at the top of your history panel</li>   <li>Type the new name</li>   <li>Press <kbd>Enter</kbd></li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li><strong>Get species occurrences data</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters\n      <ul>\n        <li><em>“Scientific name”</em>: <code class=\"language-plaintext highlighter-rouge\">Chrysemys picta</code></li>\n        <li><em>“Data source”</em>: <code class=\"language-plaintext highlighter-rouge\">gbif</code></li>\n        <li><em>“Number of records to return”</em>: <code class=\"language-plaintext highlighter-rouge\">10000</code></li>\n      </ul>\n    </li>\n    <li>Inspect the generated file with the Scratchbook</li>\n  </ol>\n</blockquote>\n\n<p>We now have a tabular file with 10,001 lines and many columns.</p>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n  <ol>\n    <li>What do the rows in the files represent?</li>\n    <li>What are the columns 1, 2, 3 and 54 of the generated file?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n    <ol>\n      <li>Each row represents a <em>Chrysemys picta</em> observation, its location, and other metadata</li>\n      <li>Column 1 is the name, column 2 the longitude of the observation of <em>Chrysemys picta</em>, column 3 the latitude and column 54 the country code of the location</li>\n    </ol>\n  </blockquote>\n</blockquote>\n\n<p>We will extract the 4 columns mentioned above and keep only the occurrence records from the US.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Import the data</hands-on-title>\n  <ol>\n    <li><strong>Cut columns</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters\n      <ul>\n        <li><em>“Cut columns”</em>: <code class=\"language-plaintext highlighter-rouge\">c1,c2,c3,c54</code></li>\n        <li><em>“Delimited by”</em>: <code class=\"language-plaintext highlighter-rouge\">Tab</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“From”</em>: output of <strong>Get species occurrences data</strong></li>\n      </ul>\n    </li>\n    <li>Inspect the generated file and check the 4 columns</li>\n    <li><strong>Filter data</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Filter”</em>: output of <strong>Cut columns</strong></li>\n        <li><em>“With following condition”</em>: <code class=\"language-plaintext highlighter-rouge\">c4=='US'</code></li>\n        <li><em>“Number of header lines to skip”</em>: <code class=\"language-plaintext highlighter-rouge\">1</code></li>\n      </ul>\n    </li>\n    <li>\n      <p>Inspect the generated files</p>\n\n      <blockquote class=\"question\">\n        <question-title></question-title>\n\n        <p>How many occurrences were kept?</p>\n\n        <blockquote class=\"solution\">\n          <solution-title></solution-title>\n          <p>63.06% of the occurrences (6,306) are conserved</p>\n        </blockquote>\n      </blockquote>\n    </li>\n    <li><strong>Tabular to CSV</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>\n      <ul>\n        <li>Click on the <strong>Edit Attributes</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> option for the output of <strong>Filter</strong>.</li>\n        <li>On the central panel click on the <i class=\"fas fa-cog\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-gear</span> <strong>Convert</strong> tab.</li>\n        <li>Check the  <strong>Target data</strong> is csv.</li>\n        <li>Click on <strong>Create Dataset</strong></li>\n      </ul>\n    </li>\n    <li>Due to an issue related to the GBIF format conversion, each <code class=\"language-plaintext highlighter-rouge\">\"</code> sign is triplicated on the resulting file. You need to replace <code class=\"language-plaintext highlighter-rouge\">\"\"\"</code> for <code class=\"language-plaintext highlighter-rouge\">\"</code>, using for example the <strong>Replace</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> parts of text tool.</li>\n  </ol>\n</blockquote>\n\n<h1 id=\"step-2-development-and-evaluation-of-the-sdm-using-wallace\">Step 2: Development and evaluation of the SDM using Wallace</h1>\n\n<p><a href=\"https://wallaceecomod.github.io/\">Wallace</a> is an R Shiny app integrated into Galaxy. It provides an interactive environment for the rapid and effective development and evaluation of an SDM, it integrates data download, cleaning, partitioning, modeling, visualisation and prediction.</p>\n\n<h2 id=\"transmit-occurrence-data-from-galaxy-to-wallace\">Transmit occurrence data from Galaxy to Wallace</h2>\n\n<p>Here, you can either upload your Galaxy data or you can download data directly in Wallace. Let’s use the data from your Galaxy history:</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Launch Wallace</hands-on-title>\n  <ol>\n    <li>Verify your current history has the filtered occurences data.</li>\n    <li>Open <span class=\"tool\" data-tool=\"interactive_tool_wallace\" title=\"Wallace tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Wallace</strong></span> in Galaxy or click here to <a href=\"https://ecology.usegalaxy.eu/root?tool_id=interactive_tool_wallace\">open the tool</a> and click on execute</li>\n    <li>Go to User &gt; Active InteractiveTools, then click on the active InteractiveTool named <code class=\"language-plaintext highlighter-rouge\">Wallace visualisation</code>.</li>\n    <li>In Wallace\n      <ol>\n        <li>Due to an issue related to the last Wallace Docker update, a manual fix is required. First go to the <strong>5 Partition Occs</strong>, select <em>“Spatial Partition”</em> then for <em>“Options available”</em> select <code class=\"language-plaintext highlighter-rouge\">Checkerboard 2 (k=4)</code> then click on the <strong>Partition</strong> button. This will allow the <em>“Aggregation Factor”</em> option to be displayed. Sorry for the inconvenience.</li>\n        <li>Go to <strong>1 Occ Data</strong></li>\n        <li>In <strong>Obtain Occurrence Data</strong>\n          <ul>\n            <li><em>“Modules Available”</em>: <code class=\"language-plaintext highlighter-rouge\">Galaxy History User</code></li>\n            <li><em>“From Galaxy History User csv file select”</em>: output of <strong>Tabular to CSV</strong> (or the <strong>Replace</strong> output if you used that tool).</li>\n            <li>Click on <strong>Load Occurrences</strong></li>\n          </ul>\n        </li>\n      </ol>\n    </li>\n  </ol>\n</blockquote>\n\n<p>The data will load on the main panel of Wallace. It can now be inspected using the map, the table, etc.</p>\n\n<p>You now have your occurrence records on Wallace!</p>\n\n<!--\n> <question-title></question-title>\n>\n> *TODO: Add a questio<F4>n related to the data there*\n>\n> What happens if you click on a data point on the map?\n>\n> > <solution-title></solution-title>\n> >\n> > The metadata associated to the point is displayed. In our case, because we filtered the information we will get a lot of NAs.\n> {: .solution }\n{: .question}\n-->\n\n<h2 id=\"process-occurrence-data\">Process occurrence data</h2>\n\n<p>For the modeling, we need to choose the occurrences we want to use. There is 4 ways to do this in Wallace in the <strong>2 Process Occ</strong> panel:</p>\n\n<ol>\n  <li>Selecting occurrences on the map by delimiting an interesting geographic area</li>\n  <li>Removing occurrences by ID</li>\n  <li>\n    <p>Delimiting a spatial thin</p>\n\n    <p>This allows selecting occurrences by setting a minimum distance (in km) between the different occurrences. For example, by typing 30km, we will get all the occurrences on the map which are at a minimum of 30km from each other.</p>\n  </li>\n  <li>Considering all the occurrences</li>\n</ol>\n\n<p>We want to work on the data from the US, we will select the occurrences with the 1st option</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Select interesting occurrences</hands-on-title>\n  <ol>\n    <li>Go to <strong>2 Process Occ</strong></li>\n    <li>In <strong>Process Occurrence Data</strong>\n      <ul>\n        <li><em>“Modules Available”</em>: ` Select Occurrences On Map`</li>\n      </ul>\n    </li>\n    <li>In the middle panel,\n      <ol>\n        <li>Click on the polygon icon on the map</li>\n        <li>Draw a polygon to delimit the area</li>\n      </ol>\n    </li>\n    <li>On the left panel, click on <strong>Select Occurrences</strong></li>\n  </ol>\n</blockquote>\n\n<h2 id=\"obtain-environmental-data\">Obtain Environmental Data</h2>\n\n<p>Now, we would like to obtain biologically relevant environmental data for our model. The <a href=\"http://www.worldclim.org/bioclim\">Bioclimatic variables</a> consist of such original and derived variables. We will associate them with the occurrence data, using the WorldClim Bioclims module.</p>\n\n<p>This module provides a raster with environmental variables from online sources. The raster is composed of environmental information. Each layer of the raster contains a climatic variable: starting from BIO1 = Annual mean temperature, to BIO19 = Precipitation of Coldest Quarter.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Obtain Environmental Data</hands-on-title>\n  <ol>\n    <li>Go to <strong>3 Env Data</strong></li>\n    <li>In <strong>Obtain Environmental Data</strong>\n      <ul>\n        <li>\n          <p><em>“Modules Available”</em>: <code class=\"language-plaintext highlighter-rouge\">WorldClim Bioclims</code></p>\n\n          <blockquote class=\"comment\">\n            <comment-title>Using your own raster</comment-title>\n            <p>If you prefer to load your own raster:</p>\n            <ol>\n              <li>Import it into Galaxy in the GeoTIFF format</li>\n              <li>In <strong>Obtain Environmental Data</strong>\n                <ul>\n                  <li><em>“Modules Available”</em>: <code class=\"language-plaintext highlighter-rouge\">Galaxy History User</code></li>\n                  <li><em>“Select from your Galaxy History User csv file”</em>: imported GeoTIFF file\nNote that if you input your own raster, you don’t have the option for time prediction later on.</li>\n                </ul>\n              </li>\n            </ol>\n          </blockquote>\n        </li>\n        <li>\n          <p><em>“Select WorldClim bioclimatic variable resolution”</em>: <code class=\"language-plaintext highlighter-rouge\">10 arcmin</code></p>\n\n          <p>This is the lowest resolution.</p>\n        </li>\n      </ul>\n    </li>\n    <li>Click on the <strong>Load Env Data</strong></li>\n  </ol>\n</blockquote>\n\n<!-- **TODO: comment the output / add a question to explain why the next step** -->\n\n<h2 id=\"process-environmental-data\">Process environmental Data</h2>\n\n<p>Wallace will now associate environmental data and occurrences data to train a model.</p>\n\n<ol>\n  <li>\n    <p>It first creates a buffer zone around the occurrences</p>\n\n    <p>We can choose the size of the buffer zone to control the area we will work with and on which a map of suitability will be made.</p>\n\n    <p>Several background extents can be used:</p>\n    <ul>\n      <li>Bounding box defines an area centered on the occurrences</li>\n      <li>Minimum convex polygon creates a convex area around the occurrences placement</li>\n      <li>Point buffers will use occurrence localities to build a buffer zone around each occurrence</li>\n    </ul>\n  </li>\n  <li>\n    <p>It samples Background Points</p>\n  </li>\n</ol>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Obtain Environmental Data</hands-on-title>\n  <ol>\n    <li>Go to <strong>4 Process Envs</strong></li>\n    <li>In <strong>Process Environmental Data</strong>\n      <ul>\n        <li><em>“Modules Available”</em>: <code class=\"language-plaintext highlighter-rouge\">Select Study Region</code></li>\n      </ul>\n    </li>\n    <li>In <strong>Step 1: Choose Background Extent</strong>\n      <ul>\n        <li><em>“Background Extents”</em>: <code class=\"language-plaintext highlighter-rouge\">Minimum convex polygon</code></li>\n        <li><em>“Study region buffer distance (degree)”</em>: <code class=\"language-plaintext highlighter-rouge\">1</code></li>\n      </ul>\n    </li>\n    <li>Click on <strong>Select</strong></li>\n    <li>In <strong>Step 2: Sample Background Points</strong>\n      <ul>\n        <li><em>“No. of background points”</em>: <code class=\"language-plaintext highlighter-rouge\">100000</code></li>\n      </ul>\n    </li>\n    <li>Click on <strong>Sample</strong></li>\n  </ol>\n</blockquote>\n\n<!-- **TODO: comment the output / add a question to explain why the next step** -->\n\n<h2 id=\"partition-occurrence-data\">Partition Occurrence Data</h2>\n\n<p>By partitioning data, a dataset is divided into subsets (i.e. bins). A model is built on each of the subsets but one, it is used to test the model (assuming that all the groups are independent).</p>\n\n<p>There is 2 possible ways to partition data:</p>\n\n<ol>\n  <li><strong>Non-spatial Partition</strong>: a partition used when there is no bias due to space, time or sampling method\n    <ol>\n      <li>Jacknife (k=n): each occurrence in the dataset is considered as equal to a bin. This is usually used when you have a small dataset with no known bias</li>\n      <li>Random k-fold: partition the data randomly in a number of bins set by the user with the option <code class=\"language-plaintext highlighter-rouge\">Number of Folds</code></li>\n    </ol>\n  </li>\n  <li><strong>Spatial Partition</strong>: a partition used when there could be bias due to time, space or sampling method\n    <ol>\n      <li>Block (k=4): the area is divided in four and the different occurrences are put equally into four bins</li>\n      <li>Checkerboard 1 (k=2): two bins are used according to the position of the occurrences on the grid</li>\n      <li>\n        <p>Checkerboard 2 (k=4): four bins are used according to the position of the occurrences on the grid. This requires an aggregation factor, which is the size of a second grid placed on the first one. For example, with a factor 4, the grid’s size will be 4x4</p>\n\n        <figure id=\"figure-1\" style=\"max-width: 90%;\"><img src=\"../../images/species-distribution-modeling/Checkerboard.png\" alt=\"Checkerboard 2. \" width=\"545\" height=\"201\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/species-distribution-modeling/Checkerboard.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 1</strong>:</span> Example of checkerboard (k=4) with a factor 4. Source: doi:10.0.4.87/2041-210X.12261</figcaption></figure>\n      </li>\n    </ol>\n  </li>\n</ol>\n\n<p>For both of these techniques the number of occurrences in each bin may vary.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Partition Occurrence Data</hands-on-title>\n  <ol>\n    <li>Go to <strong>5 Partition Occs</strong></li>\n    <li>In <strong>Partition Occurrence Data</strong>\n      <ul>\n        <li><em>“Modules Available”</em>: <code class=\"language-plaintext highlighter-rouge\">Spatial Partition</code></li>\n        <li><em>“Options Available:”</em>: <code class=\"language-plaintext highlighter-rouge\">Checkerboard 2 (k=4)</code></li>\n        <li><em>“Aggregation Factor”</em>: <code class=\"language-plaintext highlighter-rouge\">6</code></li>\n      </ul>\n    </li>\n    <li>Click on <strong>Partition</strong></li>\n  </ol>\n</blockquote>\n\n<!-- **TODO: comment the output / add a question to explain why the next step** -->\n\n<h2 id=\"build-and-evaluate-niche-model\">Build and Evaluate Niche Model</h2>\n\n<p>Wallace can build different models using either:</p>\n\n<ol>\n  <li>The presence-only approach BIOCLIM (Module BIOCLIM) (<span class=\"citation\"><a href=\"#booth2018\">Booth 2018</a></span>)</li>\n  <li>The presence-background (presence-pseudo absence) algorithm Maxent (Module Maxent)</li>\n</ol>\n\n<p>To evaluate these models, Wallace computes the performance on a hold-out dataset (data not used for training) and provides evaluation metrics such as the AUC (Area Under the Curve) mean. As a rule of thumb, an AUC of 0.75 and above is considered good, and closer to 1 is better.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Build and evaluate the niche model</hands-on-title>\n  <ol>\n    <li>Go to <strong>6 Model</strong></li>\n    <li>In <strong>Build and Evaluate Niche Model</strong>\n      <ul>\n        <li><em>“Modules Available”</em>: <code class=\"language-plaintext highlighter-rouge\">BIOCLIM</code></li>\n      </ul>\n    </li>\n    <li>Click on <strong>Run</strong></li>\n  </ol>\n</blockquote>\n\n<!-- **TODO: comment the output / add a question to explain why the next step** -->\n\n<h2 id=\"visualize-model-results\">Visualize Model Results</h2>\n\n<p>We would now like to visualize the model of the theoretical niche. First we will make a chart to simulate an ecological niche:</p>\n<ul>\n  <li>X-axis: temperature</li>\n  <li>Y-axis: the annual precipitation</li>\n</ul>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Visualize Model Results</hands-on-title>\n  <ol>\n    <li>Go to <strong>7 Visualize</strong></li>\n    <li>In <strong>Visualize Model Results</strong>\n      <ul>\n        <li><em>“Modules Available”</em>: <code class=\"language-plaintext highlighter-rouge\">BIOCLIM Envelope Plots</code></li>\n        <li><em>“Axis 1”</em>: <code class=\"language-plaintext highlighter-rouge\">1</code></li>\n        <li><em>“Axis 1”</em>: <code class=\"language-plaintext highlighter-rouge\">12</code></li>\n        <li><em>“Set threshold”</em>: <code class=\"language-plaintext highlighter-rouge\">0.75</code></li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<p><a href=\"../../images/species-distribution-modeling/bioclim_enveloppe_plots.png\" rel=\"noopener noreferrer\"><img src=\"../../images/species-distribution-modeling/bioclim_enveloppe_plots.png\" alt=\"temperature vs annual precipitation. \" width=\"810\" height=\"345\" loading=\"lazy\" /></a></p>\n\n<p>The optimum environmental parameters for this species (represented in green) are between 5°C and 15°C (on the graph, values are x10) with an annual precipitation between approximately 700mm and 1250mm.</p>\n\n<p>To visualize the suitability on the map, we can use the map prediction module.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Visualize Model Results</hands-on-title>\n  <ol>\n    <li>In <strong>Visualize Model Results</strong>\n      <ul>\n        <li><em>“Modules Available”</em>: <code class=\"language-plaintext highlighter-rouge\">Map Prediction</code></li>\n        <li>\n          <p><em>“Set threshold”</em>: <code class=\"language-plaintext highlighter-rouge\">No threshold</code></p>\n\n          <p>It will display a gradient of predicted presence or use. If you prefer a map with the predicted presence and predicted absence, select <code class=\"language-plaintext highlighter-rouge\">minimum training presence</code>.</p>\n        </li>\n      </ul>\n    </li>\n    <li>Click on <strong>Plot</strong></li>\n  </ol>\n</blockquote>\n\n<p><a href=\"../../images/species-distribution-modeling/map_prediction.png\" rel=\"noopener noreferrer\"><img src=\"../../images/species-distribution-modeling/map_prediction.png\" alt=\"map prediction. \" width=\"813\" height=\"565\" loading=\"lazy\" /></a></p>\n\n<!-- **TODO: comment the output / add a question to explain why the next step** -->\n\n<h2 id=\"project-model\">Project Model</h2>\n\n<p>Wallace can use the trained model to predict possible species distributions in a different areas, outside of the sampled one. Here, we will try it for Canada.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Visualize Model Results</hands-on-title>\n  <ol>\n    <li>Go to <strong>8 Project</strong></li>\n    <li>In <strong>Project Model</strong>\n      <ul>\n        <li><em>“Modules Available”</em>: <code class=\"language-plaintext highlighter-rouge\">Project to New Extent</code></li>\n      </ul>\n    </li>\n    <li>In the middle panel,\n      <ol>\n        <li>Click on the polygon icon on the map</li>\n        <li>Draw a polygon around a part of Canada</li>\n      </ol>\n    </li>\n    <li>In <strong>Project Model</strong>\n      <ul>\n        <li><em>“Set threshold”</em>: <code class=\"language-plaintext highlighter-rouge\">Minimum Training Presence</code></li>\n      </ul>\n    </li>\n    <li>Click on <strong>Project</strong></li>\n  </ol>\n</blockquote>\n\n<p>We can predict not only for a different area, but also for a different time and climate. We use the <a href=\"https://en.wikipedia.org/wiki/General_circulation_model#Atmospheric_and_oceanic_models\">Global Circulation Models (GCM)</a> to predict atmospheric fluctuation and then evaluate climate change. Each model is different and uses several parameters such as ocean atmosphere. The prediction also uses RCP scenarios, Representative Concentration Pathways take average enegy requirements across the planet (2.6, 4.5, 6.0 and 8.5 watts per meter squared) to model the concentration of greenhouse gases emitted in the near future and their effect on climate. These scenarios may produce varying predicted presence models.</p>\n\n<p>We would like to predict the presence of <em>Chrysemys Picta</em> in Canada in 2050, given the model <a href=\"http://www.cesm.ucar.edu/models/ccsm4.0/\">CCSM4</a>, a US model based on earth circulation, and an RCP value of 2.6 <!--(**TODO: what does that represent?**)--></p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Visualize Model Results with a 2.6 RCP</hands-on-title>\n  <ol>\n    <li>In <strong>Project Model</strong>\n      <ul>\n        <li><em>“Modules Available”</em>: <code class=\"language-plaintext highlighter-rouge\">Project to New Time</code></li>\n        <li><em>“Select time period”</em>: <code class=\"language-plaintext highlighter-rouge\">2050</code></li>\n        <li><em>“Select global circulation model”</em>: <code class=\"language-plaintext highlighter-rouge\">CCSM4</code></li>\n        <li><em>“Select RCP”</em>: <code class=\"language-plaintext highlighter-rouge\">2.6</code></li>\n        <li><em>“Select threshold”</em>: <code class=\"language-plaintext highlighter-rouge\">Minimum Training Presence</code></li>\n      </ul>\n    </li>\n    <li>Click on <strong>Project</strong></li>\n  </ol>\n</blockquote>\n\n<p><a href=\"../../images/species-distribution-modeling/GCM_CCSM4_RCP_2.6.png\" rel=\"noopener noreferrer\"><img src=\"../../images/species-distribution-modeling/GCM_CCSM4_RCP_2.6.png\" alt=\"CCM4 with a 2.6 RCP. \" width=\"1245\" height=\"566\" loading=\"lazy\" /></a></p>\n\n<p>Let’s compare the prediction for the RCP value of 8.5. RCP 8.5 describes a pathway for the current carbon emission without additional constraints, it projects a 4.3˚C temperature increase by 2100.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Visualize Model Results with a 8.5 RCP</hands-on-title>\n  <ol>\n    <li>In <strong>Project Model</strong>\n      <ul>\n        <li><em>“Modules Available”</em>: <code class=\"language-plaintext highlighter-rouge\">Project to New Time</code></li>\n        <li><em>“Select time period”</em>: <code class=\"language-plaintext highlighter-rouge\">2050</code></li>\n        <li><em>“Select global circulation model”</em>: <code class=\"language-plaintext highlighter-rouge\">CCSM4</code></li>\n        <li><em>“Select RCP”</em>: <code class=\"language-plaintext highlighter-rouge\">8.5</code></li>\n        <li><em>“Select threshold”</em>: <code class=\"language-plaintext highlighter-rouge\">Minimum Training Presence</code></li>\n      </ul>\n    </li>\n    <li>Click on <strong>Project</strong></li>\n  </ol>\n</blockquote>\n\n<p><a href=\"../../images/species-distribution-modeling/GCM_CCSM4_RPC_8.5.png\" rel=\"noopener noreferrer\"><img src=\"../../images/species-distribution-modeling/GCM_CCSM4_RPC_8.5.png\" alt=\"CCM4 with a 8.5 RCP. \" width=\"1236\" height=\"568\" loading=\"lazy\" /></a></p>\n\n<!-- **TODO: comment the output / add a question to compare the 2 predictions**\n\n\n**TODO: add a section on how to save / download** -->\n\n<h1 id=\"conclusion\">Conclusion</h1>\n\n<p>Following this tutorial, we have loaded a dataset of occurrences to the shiny app Wallace and modeled the distribution of <em>Chrysemys picta</em> (Painted turtle) with the Species Distribution Modeling (SDM) method. This allowed us to visualize it’s ecological niche and how climate change can influence it’s future distribution in North America. The saved project can be used for similar future studies.</p>\n\n<blockquote class=\"details\">\n  <details-title>Some useful references</details-title>\n\n  <ul>\n    <li>Predicting species distributions for conservation decisions (<span class=\"citation\"><a href=\"#guisan2013\">Guisan <i>et al.</i> 2013</a></span>).</li>\n    <li>BIOCLIM: the first species distribution modelling package, its early applications and relevance to most current MAXENT studies. Diversity and Distributions (<span class=\"citation\"><a href=\"#booth2018\">Booth 2018</a></span>).</li>\n    <li>ENMeval: An R package for conducting spatially independent evaluations and estimating optimal model complexity for MAXENT ecological niche models. (<span class=\"citation\"><a href=\"#muscarella2014\">Muscarella <i>et al.</i> 2014</a></span>).</li>\n  </ul>\n\n  <p><a href=\"http://www.ipcc-data.org/guidelines/pages/gcm_guide.html\">GCM Guidelines</a> for information on Global Circulation Model (GCM), how it’s done, what is taken in consideration, and more.</p>\n</blockquote>\n\n"],"ref_slides":[],"video_library":{"tutorial":null,"slides":null,"demo":null,"both":null,"session":null},"hands_on":true,"slides":false,"mod_date":"2023-11-03 14:30:27 +0000","pub_date":"2019-07-04 07:32:28 +0000","version":98,"workflows":[{"workflow":"Galaxy-Workflow-Species_Distribution_Modeling_with_Wallace_from_GBIF_-_Training_material.ga","tests":false,"url":"https://training.galaxyproject.org/training-material/topics/ecology/tutorials/species-distribution-modeling/workflows/Galaxy-Workflow-Species_Distribution_Modeling_with_Wallace_from_GBIF_-_Training_material.ga","path":"topics/ecology/tutorials/species-distribution-modeling/workflows/Galaxy-Workflow-Species_Distribution_Modeling_with_Wallace_from_GBIF_-_Training_material.ga","wfid":"ecology-species-distribution-modeling","wfname":"galaxy-workflow-species_distribution_modeling_with_wallace_from_gbif_-_training_material","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/ecology-species-distribution-modeling/versions/galaxy-workflow-species_distribution_modeling_with_wallace_from_gbif_-_training_material","license":null,"creators":[],"name":"Species Distribution Modeling With Wallace From GBIF - Training Material","title":"Species Distribution Modeling With Wallace From GBIF - Training Material","test_results":null,"modified":"2024-06-13 09:04:09 +0000","mermaid":"flowchart TD\n  0[\"Get species occurrences data\"];\n  1[\"Wallace\"];\n  2[\"Cut\"];\n  0 -->|output| 2;\n  3[\"Filter\"];\n  2 -->|output| 3;\n  4[\"Convert tabular to CSV\"];\n  3 -->|out_file1| 4;\n  5[\"Replace\"];\n  4 -->|csv| 5;"}],"api":"https://training.galaxyproject.org/training-material/api/topics/ecology/tutorials/species-distribution-modeling/tutorial.json","tools":["Filter1","interactive_tool_wallace","tabular_to_csv","toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_cut_tool/1.1.0","toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_find_and_replace/1.1.2","toolshed.g2.bx.psu.edu/repos/ecology/spocc_occ/spocc_occ/0.9.0"],"supported_servers":{"exact":[{"url":"https://usegalaxy.eu","name":"UseGalaxy.eu","usegalaxy":true},{"url":"https://usegalaxy.fr/","name":"UseGalaxy.fr","usegalaxy":false}],"inexact":[]},"topic_name_human":"Ecology","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"text_processing","owner":"bgruening","revisions":"d698c222f354","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"text_processing","owner":"bgruening","revisions":"0a8c6b61f0f4","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"spocc_occ","owner":"ecology","revisions":"f9d76a46799a","tool_panel_section_label":"Get Data","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: text_processing\n  owner: bgruening\n  revisions: d698c222f354\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: text_processing\n  owner: bgruening\n  revisions: 0a8c6b61f0f4\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: spocc_occ\n  owner: ecology\n  revisions: f9d76a46799a\n  tool_panel_section_label: Get Data\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial"}