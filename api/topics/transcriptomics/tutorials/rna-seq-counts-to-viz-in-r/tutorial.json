{"layout":"tutorial_hands_on","title":"RNA Seq Counts to Viz in R","subtopic":"visualisation","zenodo_link":"https://zenodo.org/record/3477564/","requirements":[{"type":"internal","topic_name":"galaxy-interface","tutorials":["rstudio"]},{"type":"internal","topic_name":"data-science","tutorials":["r-basics","r-advanced"]},{"type":"internal","topic_name":"transcriptomics","tutorials":["ref-based"]}],"questions":["How can I create neat visualizations of the data?"],"objectives":["Describe the role of data, aesthetics, geoms, and layers in `ggplot` functions.","Customize plot scales, titles, subtitles, themes, fonts, layout, and orientation."],"time_estimation":"1H","tags":["interactive-tools"],"key_points":["When creating plots with `ggplot2`, think about the graphics in layers (aesthetics, geometry, statistics, scale transformation, and grouping)."],"contributors":[{"name":"Bérénice Batut","email":"berenice.batut@gmail.com","twitter":"bebatut","linkedin":"berenicebatut","matrix":"bebatut:matrix.org","orcid":"0000-0001-9852-1987","joined":"2017-09","elixir_node":"fr","contact_for_training":true,"location":{"country":"FR","lat":45.77,"lon":3.08},"fediverse":"https://piaille.fr/@bebatut","fediverse_flavor":"mastodon","affiliations":["gallantries","ifb","elixir-europe"],"id":"bebatut","url":"https://training.galaxyproject.org/training-material/api/contributors/bebatut.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/bebatut/"},{"name":"Fotis E. Psomopoulos","email":"fpsom@certh.gr","twitter":"fopsom","matrix":"fpsom:matrix.org","orcid":"0000-0002-0222-4273","linkedin":"fpsom","joined":"2019-03","elixir_node":"gr","affiliations":["gallantries","elixir-europe"],"id":"fpsom","url":"https://training.galaxyproject.org/training-material/api/contributors/fpsom.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/fpsom/"},{"name":"Toby Hodges","email":"tbyhdgs@gmail.com","twitter":"tbyhdgs","orcid":"0000-0003-1766-456X","joined":"2019-07","id":"tobyhodges","url":"https://training.galaxyproject.org/training-material/api/contributors/tobyhodges.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/tobyhodges/"},{"name":"Gallantries: Bridging Training Communities in Life Science, Environment and Health","short_name":"Gallantries","start_date":"2020-09-01","end_date":"2023-09-30","joined":"2020-09","avatar":"https://gallantries.github.io/assets/images/gallantries-logo.png","github":false,"funder":true,"url":"https://training.galaxyproject.org/training-material/api/funders/gallantries.json","funder_name":"Erasmus+ Programme","funding_id":"2020-1-NL01-KA203-064717","funding_system":"erasmusplus","funding_statement":"This project (<a href=\"https://erasmus-plus.ec.europa.eu/projects/search/details/2020-1-NL01-KA203-064717\"><code class=\"language-plaintext highlighter-rouge\">2020-1-NL01-KA203-064717</code></a>) is funded with the support of the Erasmus+ programme of the European Union. Their funding has supported a large number of tutorials within the GTN across a wide array of topics.\n<img src=\"https://gallantries.github.io/assets/images/logosbeneficaireserasmusright_en.jpg\" alt=\"eu flag with the text: with the support of the erasmus programme of the european union\" />\n<img src=\"https://www.erasmusplus.nl/assets/images/logo.png\" alt=\"erasmus plus logo\" />","members":["abretaud","bebatut","colineroyaux","fpsom","hexylena","shiltemann","yvanlebras"],"id":"gallantries","page":"https://training.galaxyproject.org/training-material/hall-of-fame/gallantries/"}],"recordings":[{"captioners":["hexylena","shiltemann","fpsom"],"date":"2021-02-15","galaxy_version":"21.01","length":"30M","youtube_id":"rJWgnLgA2BE","speakers":["fpsom"]}],"js_requirements":{"mathjax":null,"mermaid":false},"short_id":"T00299","url":"/topics/transcriptomics/tutorials/rna-seq-counts-to-viz-in-r/tutorial.html","topic_name":"transcriptomics","tutorial_name":"rna-seq-counts-to-viz-in-r","dir":"topics/transcriptomics/tutorials/rna-seq-counts-to-viz-in-r","symlink":null,"id":"transcriptomics/rna-seq-counts-to-viz-in-r","ref_tutorials":["<p>This tutorial will show you how to visualise RNA Sequencing Counts with R</p>\n\n<blockquote class=\"comment\">\n  <comment-title></comment-title>\n\n  <p>This tutorial is significantly based on <a href=\"https://carpentries.org\">the Carpentries</a> <a href=\"https://datacarpentry.org/genomics-r-intro/\">“Intro to R and RStudio for Genomics”</a> lesson</p>\n\n</blockquote>\n\n<p>With RNA-Seq data analysis, we generated tables containing list of DE genes, their expression, some statistics, etc. We can manipulate these tables using Galaxy, as we saw in some tutorials, e.g. <a href=\"/training-material/topics/transcriptomics/tutorials/ref-based/tutorial.html\">“Reference-based RNA-Seq data analysis”</a>, and create some visualisations.</p>\n\n<p>Sometimes we want to have some customizations on visualization, some complex table manipulations or some statistical analysis. If we can not find a Galaxy tools for that or the right parameters, we may need to use programming languages as R or Python.</p>\n\n<blockquote class=\"tip\">\n  <tip-title>Prerequisites</tip-title>\n  <p>It is expected that you are already somewhat familiar with the R basics (how to create variables, create and access lists, etc.) If you are not yet comfortable with those topics, we recommend that you complete the requirements listed at the start of this tutorial first, before proceeding.</p>\n\n  <p>If you are starting with this tutorial, you will need to import a dataset:</p>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title>Using datasets from Galaxy</hands-on-title>\n\n    <ol>\n      <li>Upload the following URL to Galaxy:\n        <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/3477564/files/annotatedDEgenes.tabular\n</code></pre></div>        </div>\n      </li>\n      <li>\n        <p>Note the history ID of the dataset in your Galaxy history</p>\n      </li>\n      <li>\n        <p><span class=\"tool\" data-tool=\"interactive_tool_rstudio\" title=\"RStudio tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>RStudio</strong></span> in Galaxy provides some special functions to import and export from your history:</p>\n\n        <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">annotatedDEgenes</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">read.csv</span><span class=\"p\">(</span><span class=\"n\">gx_get</span><span class=\"p\">(</span><span class=\"m\">2</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"n\">sep</span><span class=\"o\">=</span><span class=\"s2\">\"\\t\"</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"c1\"># will import dataset number 2 from your history, use the correct ID for your dataset.</span><span class=\"w\">\n</span></code></pre></div>        </div>\n      </li>\n    </ol>\n\n  </blockquote>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title>Using datasets without Galaxy</hands-on-title>\n    <ol>\n      <li>\n        <p>Read the tabular file into an object called <code class=\"language-plaintext highlighter-rouge\">annotatedDEgenes</code>:</p>\n\n        <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\">## read in a CSV file and save it as 'annotatedDEgenes'</span><span class=\"w\">\n</span><span class=\"n\">annotatedDEgenes</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">read.csv</span><span class=\"p\">(</span><span class=\"s2\">\"https://zenodo.org/record/3477564/files/annotatedDEgenes.tabular\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">sep</span><span class=\"o\">=</span><span class=\"s2\">\"\\t\"</span><span class=\"p\">)</span><span class=\"w\">\n</span></code></pre></div>        </div>\n      </li>\n    </ol>\n\n  </blockquote>\n</blockquote>\n\n<p>In this tutorial, we will take the list of DE genes extracted from DESEq2’s output that we generated in the <a href=\"/training-material/topics/transcriptomics/tutorials/ref-based/tutorial.html\">“Reference-based RNA-Seq data analysis” tutorial</a>, manipulate it and create some visualizations.</p>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n  <p>In this tutorial, we will cover:</p>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#visualization\" id=\"markdown-toc-visualization\">Visualization</a>    <ol>\n      <li><a href=\"#volcano-plot\" id=\"markdown-toc-volcano-plot\">Volcano plot</a></li>\n      <li><a href=\"#volcano-plot-by-chromosomes\" id=\"markdown-toc-volcano-plot-by-chromosomes\">Volcano plot by chromosomes</a></li>\n      <li><a href=\"#barplot-of-the-number-of-de-genes\" id=\"markdown-toc-barplot-of-the-number-of-de-genes\">Barplot of the number of DE genes</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#conclusion\" id=\"markdown-toc-conclusion\">Conclusion</a></li>\n</ol>\n\n</blockquote>\n\n<!--SNIPPET-->\n<blockquote class=\"hands_on\">   <div class=\"box-title hands_on-title\" id=\"hands-on-launch-rstudio\"><i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i> Hands-on: Launch RStudio</div>   <p>Depending on which server you are using, you may be able to run RStudio directly in Galaxy. If that is not available, RStudio Cloud can be an alternative.</p>   <blockquote class=\"tip\">   <tip-title>Launch RStudio in Galaxy</tip-title>   <p>Currently RStudio in Galaxy is only available on <a href=\"https://usegalaxy.eu\">UseGalaxy.eu</a> and <a href=\"https://usegalaxy.org\">UseGalaxy.org</a></p>   <ol>     <li>Open the Rstudio tool <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> by clicking <a href=\"https://usegalaxy.eu/?tool_id=interactive_tool_rstudio\">here to launch RStudio</a></li>     <li>Click Run Tool</li>     <li>The tool will start running and will stay running permanently</li>     <li>Click on the “User” menu at the top and go to “Active InteractiveTools” and locate the RStudio instance you started.</li>   </ol> </blockquote>   <blockquote class=\"tip\">   <tip-title>Launch RStudio Cloud if not available on Galaxy</tip-title>   <p>If RStudio is not available on the Galaxy instance:</p>   <ol>     <li>Register for <a href=\"https://client.login.rstudio.cloud/oauth/login?show_auth=0&amp;show_login=1&amp;show_setup=1\">RStudio Cloud</a>, or login if you already have an account</li>     <li>Create a new project</li>   </ol> </blockquote> </blockquote>\n<p><!--END_SNIPPET--></p>\n\n<h1 id=\"visualization\">Visualization</h1>\n\n<p>In RNA-seq data analysis and other omics experiments, visualization are an important step to check the data, their quality and represent the results found for publication.</p>\n\n<p><code class=\"language-plaintext highlighter-rouge\">ggplot2</code> is a plotting package that makes it simple to create complex plots from data in a data frame. It provides a more programmatic interface for specifying what variables to plot, how they are displayed, and general visual properties. Therefore, we only need minimal changes if the underlying data change or if we decide to change from a bar plot to a scatter plot. This helps in creating publication quality plots with minimal amounts of adjustments and tweaking.</p>\n\n<p><code class=\"language-plaintext highlighter-rouge\">ggplot2</code> graphics are built step by step by adding new elements, i.e. layers:</p>\n\n<div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">ggplot</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">DATA</span><span class=\"o\">&gt;</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">mapping</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">aes</span><span class=\"p\">(</span><span class=\"o\">&lt;</span><span class=\"n\">MAPPINGS</span><span class=\"o\">&gt;</span><span class=\"p\">))</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\">\n  </span><span class=\"o\">&lt;</span><span class=\"n\">GEOM_FUNCTION</span><span class=\"o\">&gt;</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\">\n  </span><span class=\"o\">&lt;</span><span class=\"n\">GEOM_FUNCTION</span><span class=\"o\">&gt;</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\">\n  </span><span class=\"o\">&lt;</span><span class=\"n\">GEOM_FUNCTION</span><span class=\"o\">&gt;</span><span class=\"p\">()</span><span class=\"w\">\n</span></code></pre></div></div>\n\n<p>Adding layers in this fashion allows for extensive flexibility and customization of plots.</p>\n\n<h2 id=\"volcano-plot\">Volcano plot</h2>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>First plot, step by step</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Load <code class=\"language-plaintext highlighter-rouge\">ggplot2</code></p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"w\"> </span><span class=\"n\">library</span><span class=\"p\">(</span><span class=\"n\">ggplot2</span><span class=\"p\">)</span><span class=\"w\">\n</span></code></pre></div>      </div>\n\n      <blockquote class=\"tip\">\n        <tip-title>Didn't work?</tip-title>\n        <p>You might need to install ggplot2 first</p>\n\n        <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">install.packages</span><span class=\"p\">(</span><span class=\"s2\">\"ggplot2\"</span><span class=\"p\">)</span><span class=\"w\">\n</span></code></pre></div>        </div>\n      </blockquote>\n    </li>\n    <li>\n      <p>Bind a plot to a specific data frame</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">ggplot</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">annotatedDEgenes</span><span class=\"p\">)</span><span class=\"w\">\n</span></code></pre></div>      </div>\n\n      <p>A new window will open in the bottom-right panel</p>\n    </li>\n    <li>\n      <p>Define a mapping (using the <code class=\"language-plaintext highlighter-rouge\">aes</code> aesthetic function), by selecting the variables to be plotted and specifying how to present them in the graph, e.g. as x/y positions or characteristics such as size, shape, color, etc.</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"w\"> </span><span class=\"n\">ggplot</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">annotatedDEgenes</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">aes</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">log2.FC.</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">P.value</span><span class=\"p\">))</span><span class=\"w\">\n</span></code></pre></div>      </div>\n\n      <p>X-axis is now the log2 FC and and Y-axis the p-value</p>\n\n      <blockquote class=\"comment\">\n        <comment-title>Data format</comment-title>\n\n        <p>Some <code class=\"language-plaintext highlighter-rouge\">ggplot2</code> functions need data in the ‘long’ format:</p>\n        <ul>\n          <li>a column for every dimension</li>\n          <li>a row for every observation</li>\n        </ul>\n\n        <p>Well-structured data will save you lots of time when making figures with <code class=\"language-plaintext highlighter-rouge\">ggplot2</code>.</p>\n      </blockquote>\n    </li>\n    <li>\n      <p>Add information about the graphical representations of the data in the plot (points, lines, bars) using <code class=\"language-plaintext highlighter-rouge\">geoms</code> function added via the <code class=\"language-plaintext highlighter-rouge\">+</code> operator</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">ggplot</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">annotatedDEgenes</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">aes</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">log2.FC.</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">P.value</span><span class=\"p\">))</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\">\n      </span><span class=\"n\">geom_point</span><span class=\"p\">()</span><span class=\"w\">\n</span></code></pre></div>      </div>\n\n      <blockquote class=\"comment\">\n        <comment-title>Graphical representations of the data in the plot</comment-title>\n\n        <p><code class=\"language-plaintext highlighter-rouge\">ggplot2</code> offers many different <code class=\"language-plaintext highlighter-rouge\">geoms</code>; we will use some common ones today, including:</p>\n        <ul>\n          <li><code class=\"language-plaintext highlighter-rouge\">geom_point()</code> for scatter plots, dot plots, etc.</li>\n          <li><code class=\"language-plaintext highlighter-rouge\">geom_boxplot()</code> for, well, boxplots!</li>\n          <li><code class=\"language-plaintext highlighter-rouge\">geom_line()</code> for trend lines, time series, etc.</li>\n        </ul>\n      </blockquote>\n    </li>\n  </ol>\n</blockquote>\n\n<p>We should obtain our first ggplot2 plot:</p>\n\n<p><a href=\"../../images/rna-seq-counts-to-viz-in-r/firstPlot.png\" rel=\"noopener noreferrer\"><img src=\"../../images/rna-seq-counts-to-viz-in-r/firstPlot.png\" alt=\"Our first ggplot2 plot. \" width=\"640\" height=\"425\" loading=\"lazy\" /></a></p>\n\n<p>This plot is called a volcano plot, a type of scatterplot that shows statistical significance (P value) versus magnitude of change (fold change). The most upregulated genes are towards the right, the most downregulated genes are towards the left, and the most statistically significant genes are towards the top. With this plot, we can then quickly identify genes with large fold changes that are also statistically significant, i.e. probably the most biologically significant genes.</p>\n\n<p>The current version of the plot is not really informative, mostly due to the high number of p-values close to zero. In order to resolve this, we will apply <code class=\"language-plaintext highlighter-rouge\">-log10()</code> to the y-axis values.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Volcano plot with log values on y-axis</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Create volcano plot with log values on the y-axis</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">ggplot</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">annotatedDEgenes</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">aes</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">log2.FC.</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">log10</span><span class=\"p\">(</span><span class=\"n\">P.value</span><span class=\"p\">)))</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\">\n     </span><span class=\"n\">geom_point</span><span class=\"p\">()</span><span class=\"w\">\n</span></code></pre></div>      </div>\n    </li>\n  </ol>\n</blockquote>\n\n<p><a href=\"../../images/rna-seq-counts-to-viz-in-r/volcanoPlot_v0.png\" rel=\"noopener noreferrer\"><img src=\"../../images/rna-seq-counts-to-viz-in-r/volcanoPlot_v0.png\" alt=\"Volcano Plot version 0. \" width=\"640\" height=\"425\" loading=\"lazy\" /></a></p>\n\n<blockquote class=\"question\">\n  <question-title>Categorising expression levels</question-title>\n\n  <ol>\n    <li>Why are there no points with log2 FC between -1 and 1?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <p>The input file we used are the 130 genes with a significant adjusted p-values (below &lt; 0.05) and an absolute fold change higher than 2 (log2 FC &lt; -1 or log 2 FC &gt; 1).</p>\n\n  </blockquote>\n</blockquote>\n\n<blockquote class=\"comment\">\n  <comment-title>The `+` sign</comment-title>\n\n  <p>The <code class=\"language-plaintext highlighter-rouge\">+</code> in the <code class=\"language-plaintext highlighter-rouge\">ggplot2</code> package is particularly useful because it allows you to modify existing <code class=\"language-plaintext highlighter-rouge\">ggplot</code> objects. This means you can easily set up plot templates and conveniently explore different types of plots, so the above plot can also be generated with code like this:</p>\n\n  <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\"># Assign plot to a variable</span><span class=\"w\">\n</span><span class=\"n\">de_genes_plot</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">ggplot</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">annotatedDEgenes</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">aes</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">log2.FC.</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">log10</span><span class=\"p\">(</span><span class=\"n\">P.value</span><span class=\"p\">)))</span><span class=\"w\">\n\n</span><span class=\"c1\"># Draw the plot</span><span class=\"w\">\n</span><span class=\"n\">de_genes_plot</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\">\n    </span><span class=\"n\">geom_point</span><span class=\"p\">()</span><span class=\"w\">\n</span></code></pre></div>  </div>\n\n  <p>The <code class=\"language-plaintext highlighter-rouge\">+</code> sign used to add new layers must be placed at the end of the line containing the previous layer. If, instead, the <code class=\"language-plaintext highlighter-rouge\">+</code> sign is added at the beginning of the line containing the new layer, <code class=\"language-plaintext highlighter-rouge\">ggplot2</code> will not add the new layer and will return an error message.</p>\n\n  <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\"># This is the correct syntax for adding layers</span><span class=\"w\">\n</span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">de_genes_plot</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\">\n      </span><span class=\"n\">geom_point</span><span class=\"p\">()</span><span class=\"w\">\n\n</span><span class=\"c1\"># This will not add the new layer and will return an error message</span><span class=\"w\">\n</span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">de_genes_plot</span><span class=\"w\">\n    </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">geom_point</span><span class=\"p\">()</span><span class=\"w\">\n</span></code></pre></div>  </div>\n</blockquote>\n\n<blockquote class=\"comment\">\n  <comment-title>Some extra comments</comment-title>\n\n  <p>Anything you put in the <code class=\"language-plaintext highlighter-rouge\">ggplot()</code> function can be seen by any <code class=\"language-plaintext highlighter-rouge\">geom</code> layers that you add (i.e., these are universal plot settings). This includes the <code class=\"language-plaintext highlighter-rouge\">x-</code> and <code class=\"language-plaintext highlighter-rouge\">y-axis</code> mapping you set up in <code class=\"language-plaintext highlighter-rouge\">aes()</code>.</p>\n\n  <p>You can also specify mappings for a given <code class=\"language-plaintext highlighter-rouge\">geom</code> independently of the mappings defined globally in the <code class=\"language-plaintext highlighter-rouge\">ggplot()</code> function.</p>\n</blockquote>\n\n<p>Building plots with <code class=\"language-plaintext highlighter-rouge\">ggplot2</code> is typically an iterative process. We start by defining the dataset we’ll use, lay out the axes, and choose a <code class=\"language-plaintext highlighter-rouge\">geom</code>. We can now modify this plot to extract more information from it.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Format plot</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Add transparency (<code class=\"language-plaintext highlighter-rouge\">alpha</code>) to avoid overplotting</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">ggplot</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">annotatedDEgenes</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">aes</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">log2.FC.</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">log10</span><span class=\"p\">(</span><span class=\"n\">P.value</span><span class=\"p\">)))</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\">\n     </span><span class=\"n\">geom_point</span><span class=\"p\">(</span><span class=\"n\">alpha</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"m\">0.5</span><span class=\"p\">)</span><span class=\"w\">\n</span></code></pre></div>      </div>\n\n      <p><a href=\"../../images/rna-seq-counts-to-viz-in-r/volcanoPlot_v1.png\" rel=\"noopener noreferrer\"><img src=\"../../images/rna-seq-counts-to-viz-in-r/volcanoPlot_v1.png\" alt=\"Volcano Plot version 1. \" width=\"640\" height=\"425\" loading=\"lazy\" /></a></p>\n    </li>\n    <li>\n      <p>Add colors for all the points</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">ggplot</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">annotatedDEgenes</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">aes</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">log2.FC.</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">log10</span><span class=\"p\">(</span><span class=\"n\">P.value</span><span class=\"p\">)))</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\">\n    </span><span class=\"n\">geom_point</span><span class=\"p\">(</span><span class=\"n\">alpha</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"m\">0.5</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">color</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"blue\"</span><span class=\"p\">)</span><span class=\"w\">\n</span></code></pre></div>      </div>\n\n      <p><a href=\"../../images/rna-seq-counts-to-viz-in-r/volcanoPlot_v2.png\" rel=\"noopener noreferrer\"><img src=\"../../images/rna-seq-counts-to-viz-in-r/volcanoPlot_v2.png\" alt=\"Volcano Plot version 2. \" width=\"640\" height=\"425\" loading=\"lazy\" /></a></p>\n    </li>\n    <li>\n      <p>Color point based on their strand</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"w\"> </span><span class=\"n\">ggplot</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">annotatedDEgenes</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">aes</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">log2.FC.</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">log10</span><span class=\"p\">(</span><span class=\"n\">P.value</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"n\">color</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">Strand</span><span class=\"p\">))</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\">\n     </span><span class=\"n\">geom_point</span><span class=\"p\">(</span><span class=\"n\">alpha</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"m\">0.5</span><span class=\"p\">)</span><span class=\"w\">\n</span></code></pre></div>      </div>\n\n      <p><a href=\"../../images/rna-seq-counts-to-viz-in-r/volcanoPlot_v3.png\" rel=\"noopener noreferrer\"><img src=\"../../images/rna-seq-counts-to-viz-in-r/volcanoPlot_v3.png\" alt=\"Volcano Plot version 3. \" width=\"640\" height=\"425\" loading=\"lazy\" /></a></p>\n\n      <p>We use a vector as an input to the argument color and <code class=\"language-plaintext highlighter-rouge\">ggplot2</code> provides a different color corresponding to different values in the vector.</p>\n    </li>\n    <li>\n      <p>Add axis labels</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">ggplot</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">annotatedDEgenes</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">aes</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">log2.FC.</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">log10</span><span class=\"p\">(</span><span class=\"n\">P.value</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"n\">color</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">Strand</span><span class=\"p\">))</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\">\n    </span><span class=\"n\">geom_point</span><span class=\"p\">(</span><span class=\"n\">alpha</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"m\">0.5</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\">\n      </span><span class=\"n\">labs</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"log2(Fold Change)\"</span><span class=\"p\">,</span><span class=\"w\">\n           </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"-log10(P-Value)\"</span><span class=\"p\">)</span><span class=\"w\">\n</span></code></pre></div>      </div>\n    </li>\n  </ol>\n</blockquote>\n\n<p>We have now a nice Volcano plot:</p>\n\n<p><a href=\"../../images/rna-seq-counts-to-viz-in-r/volcanoPlot_v5.png\" rel=\"noopener noreferrer\"><img src=\"../../images/rna-seq-counts-to-viz-in-r/volcanoPlot_v5.png\" alt=\"Volcano Plot version 5. \" width=\"640\" height=\"425\" loading=\"lazy\" /></a></p>\n\n<blockquote class=\"question\">\n  <question-title>Standard error over the `-log10` of the adjusted `P-value`</question-title>\n\n  <p>Create a scatter plot of the standard error over the <code class=\"language-plaintext highlighter-rouge\">-log10</code> of the adjusted <code class=\"language-plaintext highlighter-rouge\">P-value</code> with the chromosomes showing in different colors. Make sure to give your plot relevant axis labels.</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>ggplot(data = annotatedDEgenes, aes(x = -log10(P.adj), y = StdErr, color = Chromosome)) +\n  geom_point() +\n     labs(x = \"-log10(P.adj)\",\n          y = \"StdErr\")\n</code></pre></div>    </div>\n\n    <p><a href=\"../../images/rna-seq-counts-to-viz-in-r/ggplotExercise01.png\" rel=\"noopener noreferrer\"><img src=\"../../images/rna-seq-counts-to-viz-in-r/ggplotExercise01.png\" alt=\"Exercise Plot 1. \" width=\"640\" height=\"425\" loading=\"lazy\" /></a></p>\n  </blockquote>\n</blockquote>\n\n<h2 id=\"volcano-plot-by-chromosomes\">Volcano plot by chromosomes</h2>\n\n<p><code class=\"language-plaintext highlighter-rouge\">ggplot2</code> has a special technique called faceting that allows us to split one plot into multiple plots based on a factor included in the dataset. We will use it to split our volcano plot into five panels, one for each chromosome.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Volcano plot by chromosomes</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Split volcano plot by chromosome using <code class=\"language-plaintext highlighter-rouge\">facet_grid</code></p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">ggplot</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">annotatedDEgenes</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">aes</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">log2.FC.</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">log10</span><span class=\"p\">(</span><span class=\"n\">P.value</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"n\">color</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">Strand</span><span class=\"p\">))</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\">\n  </span><span class=\"n\">geom_point</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\">\n  </span><span class=\"n\">labs</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"log2(Fold Change)\"</span><span class=\"p\">,</span><span class=\"w\">\n       </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"-log10(P-Value)\"</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\">\n  </span><span class=\"n\">facet_grid</span><span class=\"p\">(</span><span class=\"n\">.</span><span class=\"w\"> </span><span class=\"o\">~</span><span class=\"w\"> </span><span class=\"n\">Chromosome</span><span class=\"p\">)</span><span class=\"w\">\n</span></code></pre></div>      </div>\n\n      <p><a href=\"../../images/rna-seq-counts-to-viz-in-r/volcanoPlot_v6.png\" rel=\"noopener noreferrer\"><img src=\"../../images/rna-seq-counts-to-viz-in-r/volcanoPlot_v6.png\" alt=\"Volcano Plot version 6. \" width=\"640\" height=\"425\" loading=\"lazy\" /></a></p>\n    </li>\n    <li>\n      <p>Split volcano plot by chromosome using <code class=\"language-plaintext highlighter-rouge\">facet_grid</code> with plots stacked vertically</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">ggplot</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">annotatedDEgenes</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">aes</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">log2.FC.</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">log10</span><span class=\"p\">(</span><span class=\"n\">P.value</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"n\">color</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">Strand</span><span class=\"p\">))</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\">\n  </span><span class=\"n\">geom_point</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\">\n  </span><span class=\"n\">labs</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"log2(Fold Change)\"</span><span class=\"p\">,</span><span class=\"w\">\n       </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"-log10(P-Value)\"</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\">\n  </span><span class=\"n\">facet_grid</span><span class=\"p\">(</span><span class=\"n\">Chromosome</span><span class=\"w\"> </span><span class=\"o\">~</span><span class=\"w\"> </span><span class=\"n\">.</span><span class=\"p\">)</span><span class=\"w\">\n</span></code></pre></div>      </div>\n\n      <p><a href=\"../../images/rna-seq-counts-to-viz-in-r/volcanoPlot_v7.png\" rel=\"noopener noreferrer\"><img src=\"../../images/rna-seq-counts-to-viz-in-r/volcanoPlot_v7.png\" alt=\"Volcano Plot version 7. \" width=\"640\" height=\"425\" loading=\"lazy\" /></a></p>\n\n      <p>The <code class=\"language-plaintext highlighter-rouge\">facet_grid</code> geometry allows to explicitly specify how we want your plots to be arranged via formula notation (<code class=\"language-plaintext highlighter-rouge\">rows ~ columns</code>). The <code class=\"language-plaintext highlighter-rouge\">.</code> can be used as a placeholder that indicates only one row or column).</p>\n    </li>\n    <li>\n      <p>Add white background using <code class=\"language-plaintext highlighter-rouge\">theme_bw()</code> to make the plot more readable when printed</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">ggplot</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">annotatedDEgenes</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">aes</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">log2.FC.</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">log10</span><span class=\"p\">(</span><span class=\"n\">P.value</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"n\">color</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">Strand</span><span class=\"p\">))</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\">\n  </span><span class=\"n\">geom_point</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\">\n  </span><span class=\"n\">labs</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"log2(Fold Change)\"</span><span class=\"p\">,</span><span class=\"w\">\n       </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"-log10(P-Value)\"</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\">\n  </span><span class=\"n\">facet_grid</span><span class=\"p\">(</span><span class=\"n\">Chromosome</span><span class=\"w\"> </span><span class=\"o\">~</span><span class=\"w\"> </span><span class=\"n\">.</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\">\n  </span><span class=\"n\">theme_bw</span><span class=\"p\">()</span><span class=\"w\">\n</span></code></pre></div>      </div>\n\n      <blockquote class=\"details\">\n        <details-title>`ggplot2` themes</details-title>\n\n        <p>In addition to <code class=\"language-plaintext highlighter-rouge\">theme_bw()</code>, which changes the plot background to white, <code class=\"language-plaintext highlighter-rouge\">ggplot2</code> comes with several other themes which can be useful to quickly change the look of your visualization.</p>\n\n        <ul>\n          <li><code class=\"language-plaintext highlighter-rouge\">theme_minimal()</code> and <code class=\"language-plaintext highlighter-rouge\">theme_light() </code>are popular</li>\n          <li><code class=\"language-plaintext highlighter-rouge\">theme_void()</code> can be useful as a starting point to create a new hand-crafted theme</li>\n        </ul>\n\n        <p>The complete list of themes is available on the <a href=\"https://ggplot2.tidyverse.org/reference/ggtheme.html\">ggplot2 website</a>. The <code class=\"language-plaintext highlighter-rouge\">ggthemes</code> package provides a wide variety of options (including an Excel 2003 theme). The <a href=\"https://www.ggplot2-exts.org/\"><code class=\"language-plaintext highlighter-rouge\">ggplot2</code> extensions website</a> provides a list of packages that extend the capabilities of <code class=\"language-plaintext highlighter-rouge\">ggplot2</code>, including additional themes.</p>\n      </blockquote>\n    </li>\n    <li>\n      <p>Remove the grid</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">ggplot</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">annotatedDEgenes</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">aes</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">log2.FC.</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">log10</span><span class=\"p\">(</span><span class=\"n\">P.value</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"n\">color</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">Strand</span><span class=\"p\">))</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\">\n  </span><span class=\"n\">geom_point</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\">\n  </span><span class=\"n\">labs</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"log2(Fold Change)\"</span><span class=\"p\">,</span><span class=\"w\">\n       </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"-log10(P-Value)\"</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\">\n  </span><span class=\"n\">facet_grid</span><span class=\"p\">(</span><span class=\"n\">Chromosome</span><span class=\"w\"> </span><span class=\"o\">~</span><span class=\"w\"> </span><span class=\"n\">.</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\">\n  </span><span class=\"n\">theme_bw</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\">\n  </span><span class=\"n\">theme</span><span class=\"p\">(</span><span class=\"n\">panel.grid</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">element_blank</span><span class=\"p\">())</span><span class=\"w\">\n</span></code></pre></div>      </div>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p><a href=\"../../images/rna-seq-counts-to-viz-in-r/volcanoPlot_v8.png\" rel=\"noopener noreferrer\"><img src=\"../../images/rna-seq-counts-to-viz-in-r/volcanoPlot_v8.png\" alt=\"Volcano Plot version 8. \" width=\"640\" height=\"425\" loading=\"lazy\" /></a></p>\n\n<blockquote class=\"question\">\n  <question-title>Standard error over the `-log10` of the adjusted `P-value`</question-title>\n\n  <p>Create a scatter plot of the standard error over the <code class=\"language-plaintext highlighter-rouge\">-log10</code> of the adjusted <code class=\"language-plaintext highlighter-rouge\">P-value</code> with the chromosomes showing in different colors and one facet per strand. Make sure to give your plot relevant axis labels.</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>ggplot(data = annotatedDEgenes, aes(x = -log10(P.adj), y = StdErr, color = Chromosome)) +\n geom_point() +\n labs(x = \"-log10(P.adj)\",\n      y = \"StdErr\") +\n facet_grid(Strand ~ .)\n</code></pre></div>    </div>\n\n    <p><a href=\"../../images/rna-seq-counts-to-viz-in-r/ggplotExercise02.png\" rel=\"noopener noreferrer\"><img src=\"../../images/rna-seq-counts-to-viz-in-r/ggplotExercise02.png\" alt=\"Exercise Plot 2. \" width=\"640\" height=\"425\" loading=\"lazy\" /></a></p>\n\n  </blockquote>\n</blockquote>\n\n<h2 id=\"barplot-of-the-number-of-de-genes\">Barplot of the number of DE genes</h2>\n\n<p>We would like now to make a barplot showing the number of differentially expressed genes.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Barplot of the number of DE genes</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Create a barplot with <code class=\"language-plaintext highlighter-rouge\">geom_bar</code> function of the number of DE genes for each feature with one plot per chromosome</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">ggplot</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">annotatedDEgenes</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">aes</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">Feature</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">fill</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">Chromosome</span><span class=\"p\">))</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\">\n</span><span class=\"n\">geom_bar</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\">\n</span><span class=\"n\">facet_grid</span><span class=\"p\">(</span><span class=\"n\">Chromosome</span><span class=\"w\"> </span><span class=\"o\">~</span><span class=\"w\"> </span><span class=\"n\">.</span><span class=\"p\">)</span><span class=\"w\">\n</span></code></pre></div>      </div>\n    </li>\n  </ol>\n</blockquote>\n\n<p><a href=\"../../images/rna-seq-counts-to-viz-in-r/barPlot_v1.png\" rel=\"noopener noreferrer\"><img src=\"../../images/rna-seq-counts-to-viz-in-r/barPlot_v1.png\" alt=\"Bar plot 1. \" width=\"640\" height=\"425\" loading=\"lazy\" /></a></p>\n\n<blockquote class=\"question\">\n  <question-title>Remove the legend</question-title>\n\n  <p>The chromosome is labeled on the individual plot facets so we don’t need the legend. Use the help file for <code class=\"language-plaintext highlighter-rouge\">geom_bar</code> and any other online resources to remove the legend from the plot.</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>ggplot(data = annotatedDEgenes, aes(x = Feature, fill = Chromosome)) +\n geom_bar(show.legend = F) +\n facet_grid(Chromosome ~ .)\n</code></pre></div>    </div>\n    <p><a href=\"../../images/rna-seq-counts-to-viz-in-r/barPlot_v2.png\" rel=\"noopener noreferrer\"><img src=\"../../images/rna-seq-counts-to-viz-in-r/barPlot_v2.png\" alt=\"Bar plot 2. \" width=\"640\" height=\"425\" loading=\"lazy\" /></a></p>\n\n  </blockquote>\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title>Create a R script with plots</question-title>\n\n  <p>Take another few minutes to either improve one of the plots generated in this exercise or create a beautiful graph of your own (using the <a href=\"https://raw.githubusercontent.com/rstudio/cheatsheets/main/data-visualization-2.1.pdf\">RStudio <code class=\"language-plaintext highlighter-rouge\">ggplot2</code> cheat sheet</a> for inspiration).</p>\n\n  <p>Here are some ideas:</p>\n  <ol>\n    <li>Change the size or shape of the plotting symbol</li>\n    <li>Change the name of the legend</li>\n    <li>Change the label of the legend</li>\n    <li>Use a different color palette (see the <a href=\"http://www.cookbook-r.com/Graphs/Colors_(ggplot2)/\">cookbook here</a>).</li>\n  </ol>\n</blockquote>\n\n<h1 id=\"conclusion\">Conclusion</h1>\n\n<p>Data manipulation and visualization are important parts of any RNA-Seq analysis. Galaxy provides several tools for that as explained in several tutorials:</p>\n\n<ul>\n  <li><a href=\"/training-material/topics/transcriptomics/tutorials/ref-based/tutorial.html\">Reference-based RNA-Seq</a></li>\n  <li><a href=\"/training-material/topics/transcriptomics/tutorials/rna-seq-viz-with-heatmap2/tutorial.html\">Visualization of RNA-seq results with heatmap2</a></li>\n  <li><a href=\"/training-material/topics/transcriptomics/tutorials/rna-seq-viz-with-volcanoplot/tutorial.html\">Visualization of RNA-seq results with Volcano Plot</a></li>\n</ul>\n\n<p>But sometimes we need more customization and then need to use programming languages as R or Python.</p>\n\n<p>Working with a programming language (especially if it’s your first time) often feels intimidating, but the rewards outweigh any frustrations. An important secret of coding is that even experienced programmers find it difficult and frustrating at times – so if even the best feel that way, why let intimidation stop you? Given time and practice you will soon find it easier and easier to accomplish what you want.</p>\n\n<p>Finally, we won’t lie; R is not the easiest-to-learn programming language ever created. So, don’t get discouraged! The truth is that even with the modest amount of R covered today, you can start using some sophisticated R software packages, and have a general sense of how to interpret an R script. Get through these lessons, and you are on your way to being an accomplished R user!</p>\n"],"ref_slides":[],"hands_on":true,"slides":false,"mod_date":"2024-05-29 14:28:52 +0000","pub_date":"2019-10-08 17:25:07 +0000","version":46,"api":"https://training.galaxyproject.org/training-material/api/topics/transcriptomics/tutorials/rna-seq-counts-to-viz-in-r/tutorial.json","tools":["interactive_tool_rstudio"],"supported_servers":{"exact":[{"url":"https://usegalaxy.eu","name":"UseGalaxy.eu","usegalaxy":true},{"url":"https://usegalaxy.fr/","name":"UseGalaxy.fr","usegalaxy":false},{"url":"https://usegalaxy.org","name":"UseGalaxy.org (Main)","usegalaxy":true},{"url":"https://usegalaxy.org.au","name":"UseGalaxy.org.au","usegalaxy":true}],"inexact":[]},"topic_name_human":"Transcriptomics","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools: []\n","tours":false,"video":false,"slides_recordings":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial"}