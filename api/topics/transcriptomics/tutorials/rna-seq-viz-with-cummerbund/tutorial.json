{"layout":"tutorial_hands_on","title":"Visualization of RNA-Seq results with CummeRbund","subtopic":"visualisation","zenodo_link":"https://zenodo.org/record/1001880","questions":["How are RNA-Seq results stored?","Why are visualization techniques needed?","How to select genes for visualizing meaningful results of differential gene expression analysis?"],"objectives":["Manage RNA-Seq results","Extract genes for producing differential gene expression analysis visualizations","Visualize meaningful information"],"time_estimation":"1h","key_points":["Extract information from a SQLite CuffDiff database","Filter and sort results to highlight differential expressed genes of interest","Generate publication-ready visualizations of RNA-Seq analysis results"],"contributors":[{"name":"Andrea Bagnacani","email":"andrea.bagnacani@gmail.com","joined":"2017-10","id":"bagnacan","url":"https://training.galaxyproject.org/training-material/api/contributors/bagnacan.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/bagnacan/"}],"js_requirements":{"mathjax":null,"mermaid":false},"short_id":"T00302","url":"/topics/transcriptomics/tutorials/rna-seq-viz-with-cummerbund/tutorial.html","topic_name":"transcriptomics","tutorial_name":"rna-seq-viz-with-cummerbund","dir":"topics/transcriptomics/tutorials/rna-seq-viz-with-cummerbund","symlink":null,"id":"transcriptomics/rna-seq-viz-with-cummerbund","ref_tutorials":["<p>RNA-Seq analysis helps researchers annotate new genes and splice variants, and provides cell- and context-specific quantification of gene expression. RNA-Seq data, however, are complex and require both computer science and mathematical knowledge to be managed and interpreted.</p>\n\n<p>Visualization techniques are key to overcome the complexity of RNA-Seq data, and represent valuable tools to gather information and insights.</p>\n\n<p>In this tutorial we will visualize RNA-seq data from the <a href=\"http://cole-trapnell-lab.github.io/cufflinks/cuffdiff/\">CuffDiff</a> tool.</p>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n  <p>In this tutorial, we will deal with:</p>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#reasons-for-visualizing-rna-seq-results\" id=\"markdown-toc-reasons-for-visualizing-rna-seq-results\">Reasons for visualizing RNA-Seq results</a></li>\n  <li><a href=\"#importing-rna-seq-result-data\" id=\"markdown-toc-importing-rna-seq-result-data\">Importing RNA-Seq result data</a></li>\n  <li><a href=\"#filtering-and-sorting\" id=\"markdown-toc-filtering-and-sorting\">Filtering and sorting</a></li>\n  <li><a href=\"#cummerbund\" id=\"markdown-toc-cummerbund\">CummeRbund</a></li>\n  <li><a href=\"#conclusion\" id=\"markdown-toc-conclusion\">Conclusion</a></li>\n</ol>\n\n</blockquote>\n\n<h1 id=\"reasons-for-visualizing-rna-seq-results\">Reasons for visualizing RNA-Seq results</h1>\n\n<p>To make sense of the available RNA-Seq data, and overview the condition-specific gene expression levels of the provided samples, we need to visualize our results. Here we will use <a href=\"http://compbio.mit.edu/cummeRbund/\">CummeRbund</a>.</p>\n\n<p>CummeRbund is an open-source tool that simplifies the analysis of a CuffDiff RNA-Seq output. In particular, it helps researchers with:</p>\n<ul>\n  <li>managing, integrating, and visualizing the data produced by CuffDiff</li>\n  <li>simplifying data exploration</li>\n  <li>providing a bird’s-eye view of the expression analysis by describing relationships betweeen genes, transcripts, transcription start sites, and protein-coding regions</li>\n  <li>exploring subfeatures of individual genes or gene-sets</li>\n  <li>creating publication-ready plots</li>\n</ul>\n\n<p>A typical workflow for the visualization of RNA-Seq data involving CummeRbund:</p>\n\n<p><a href=\"../../images/transcriptomics_images/cummerbund-rna-seq-viz-with-cummerbund.png\" rel=\"noopener noreferrer\"><img src=\"../../images/transcriptomics_images/cummerbund-rna-seq-viz-with-cummerbund.png\" alt=\"workflow. \" width=\"3502\" height=\"1126\" loading=\"lazy\" /></a></p>\n\n<p>CummeRbund reads your RNA-Seq results from a <a href=\"https://www.sqlite.org/\">SQLite</a> database. This database has to be created using CuffDiff’s SQLite output option.</p>\n\n<blockquote class=\"details\">\n  <details-title>SQLite output with CuffDiff</details-title>\n\n  <p>Instruct CuffDiff to organize its output in a SQLite database to be read CummeRbund.</p>\n\n  <p><a href=\"../../images/transcriptomics_images/cummerbund-cuffdiff-set-sqlite.png\" rel=\"noopener noreferrer\"><img src=\"../../images/transcriptomics_images/cummerbund-cuffdiff-set-sqlite.png\" alt=\"SQLite output. \" width=\"600\" height=\"122\" loading=\"lazy\" /></a></p>\n</blockquote>\n\n<h1 id=\"importing-rna-seq-result-data\">Importing RNA-Seq result data</h1>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Data upload</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Create a new history</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-new-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-new-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a new history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>Click the <i class=\"fas fa-plus\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">new-history</span> icon at the top of the history panel:</p>   <p><img src=\"/training-material/shared/images/history_create_new.svg\" alt=\"UI for creating new history\" /></p>   <!-- the original drawing can be found here https://docs.google.com/drawings/d/1cCBrLAo4kDGic5QyB70rRiWJAKTenTU8STsKDaLcVU8/edit?usp=sharing --> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Import the <a href=\"https://zenodo.org/record/1001880/files/CuffDiff_SQLite_database.sqlite\"><code class=\"language-plaintext highlighter-rouge\">CuffDiff SQLite</code></a> dataset</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-via-links\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-via-links\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing via links</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <p>Rename the dataset to “RNA-Seq SQLite result data”</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-renaming-a-dataset\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-renaming-a-dataset\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Renaming a dataset</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, change the <strong>Name</strong> field  to <code class=\"language-plaintext highlighter-rouge\">RNA-Seq SQLite result data</code></li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n  <p>By default, when data is imported via its link, Galaxy names it with its URL.</p>\n</blockquote>\n\n<p>CuffDiff’s output data is organized in a SQLite database, so we need to extract it to be able to see what it looks like.</p>\n\n<p>For this tutorial, we are interested in CuffDiff’s tested transcripts for differential expression.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Extract CuffDiff results</hands-on-title>\n\n  <ol>\n    <li><strong>Extract CuffDiff</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters\n      <ul>\n        <li><em>“Select tables to output”</em>: <code class=\"language-plaintext highlighter-rouge\">Transcript differential expression testing</code></li>\n      </ul>\n    </li>\n    <li>\n      <p>Inspect the table</p>\n\n      <blockquote class=\"tip\">\n        <tip-title>Inspecting the content of a file in Galaxy</tip-title>\n\n        <ul>\n          <li>Click on the <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> (eye) icon (“View data”) on the right of the file name in the history</li>\n          <li>Inspect the content of the file</li>\n        </ul>\n      </blockquote>\n    </li>\n  </ol>\n\n  <p>Each entry is a differentially expressed gene, which is described in terms of the following attributes.</p>\n\n  <ul>\n    <li><em>test_id</em>: A unique identifier describing the transcript being tested</li>\n    <li><em>gene_id</em>: The identifier of the gene being tested</li>\n    <li><em>gene</em>: The name of the gene being tested</li>\n    <li><em>locus</em>: The genomic coordinates of the gene transcript being tested</li>\n    <li><em>sample_1</em>: Label of the 1st sample</li>\n    <li><em>sample_2</em>: Label of the 2nd sample</li>\n    <li><em>status</em>: The test’s status:\n      <ul>\n        <li>“OK” if test successful</li>\n        <li>“NOTEST” if not enough alignments for testing</li>\n        <li>“LOWDATA” if too complex or shallowly sequenced</li>\n        <li>“HIDATA” if too many fragments in locus</li>\n        <li>“FAIL” if a numerical exception prevented testing</li>\n      </ul>\n    </li>\n    <li><em>value_1</em>: The gene’s FPKM in sample_1</li>\n    <li><em>value_2</em>: The gene’s FPKM in sample_2</li>\n    <li><em>log2(fold_change)</em>: The log<sub>2</sub> of the fold change (sample_1/sample_2). This reports the expression difference between condition one (sample_1) and condition two (sample_2)</li>\n    <li><em>test_stat</em>: The test statistic’s value, used to determine the significance of the observed change in FPKM</li>\n    <li><em>p_value</em>: The uncorrected p-value of the test statistic</li>\n    <li><em>q_value</em>: The False-discovery-rate-adjusted p-value of the test statistic</li>\n    <li><em>significant</em>: “yes” or “no”, depending on whether the p_value is greater then the FDR after Benjamini-Hochberg correction for multiple-testing. This tells whether the difference between the expression levels in condition one (sample_1) and condition two (sample_2) is significant</li>\n  </ul>\n\n  <p>We want to keep only the <em>significant differentially expressed</em> genes.</p>\n\n  <blockquote class=\"question\">\n    <question-title></question-title>\n\n    <ol>\n      <li>How to retain only the significant differentially expressed genes?</li>\n      <li>Which column stores this information?</li>\n    </ol>\n\n    <blockquote class=\"solution\">\n      <solution-title></solution-title>\n      <ol>\n        <li>We need to filter on the column storing the record’s significance</li>\n        <li>Column 14</li>\n      </ol>\n    </blockquote>\n  </blockquote>\n</blockquote>\n\n<h1 id=\"filtering-and-sorting\">Filtering and sorting</h1>\n\n<p>We now want to highlight the transcripts whose expression difference, the log<sub>2</sub>(fold_change), has been statistically assessed as both high and significant.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Extract CuffDiff's significant differentially expressed genes</hands-on-title>\n\n  <ol>\n    <li><strong>Filter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters\n      <ul>\n        <li><em>“Filter”</em>: the extracted table from the previous step</li>\n        <li><em>“With following condition”</em>: an appropriate filter over the target column (see questions below when in doubt)</li>\n        <li><em>“Number of header lines to skip”</em>: the number of rows used for the table’s header</li>\n      </ul>\n\n      <blockquote class=\"question\">\n        <question-title></question-title>\n        <ol>\n          <li>What column stores the information of significance for each record?</li>\n          <li>Which conditional expression has to be set to filter all records on the selected column?</li>\n          <li>How many rows are allocated for the table’s header?</li>\n          <li>How many entries were originally stored in the table? And how many after the filtering operation?</li>\n        </ol>\n\n        <blockquote class=\"solution\">\n          <solution-title></solution-title>\n          <ol>\n            <li>Column 14</li>\n            <li>c14==’yes’</li>\n            <li>1</li>\n            <li>~140,000 (before filtering) vs. 219 (after filtering)</li>\n          </ol>\n        </blockquote>\n      </blockquote>\n    </li>\n  </ol>\n\n  <p>Review the meaning of each column, and look at your data.</p>\n\n  <ul>\n    <li>The differential expression values are stored in column 10</li>\n    <li>The statistical score, assessing the differential expression significance, is stored in column 13\n We will sort all records on the basis of their Q-score (column 13) and log<sub>2</sub>(fold_change).</li>\n  </ul>\n\n  <ol>\n    <li><strong>Sort</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>: with the following parameters\n      <ul>\n        <li><em>“Sort Dataset”</em>: the filtered table</li>\n        <li><em>“on column”</em>: <code class=\"language-plaintext highlighter-rouge\">13</code></li>\n        <li><em>“with flavor”</em>: <code class=\"language-plaintext highlighter-rouge\">Numerical sort</code></li>\n        <li><em>“everything in”</em>: <code class=\"language-plaintext highlighter-rouge\">Ascending order</code></li>\n        <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <strong>Insert Column selection</strong>, and parameterize the Sort tool to sort on column 10. Be careful of the sorting order!</li>\n        <li>Are there any rows allocated for the table’s header? In that case, set “Number of header lines to skip” accordingly!</li>\n      </ul>\n\n      <blockquote class=\"question\">\n        <question-title></question-title>\n        <ol>\n          <li>Which gene transcript has been statistically assessed as both high and significant?</li>\n        </ol>\n\n        <blockquote class=\"solution\">\n          <solution-title></solution-title>\n          <p>1 LIMCH1</p>\n        </blockquote>\n      </blockquote>\n    </li>\n  </ol>\n</blockquote>\n\n<h1 id=\"cummerbund\">CummeRbund</h1>\n\n<p>CummeRbund generates two outputs:</p>\n<ul>\n  <li>The plot, which visualizes our RNA-Seq results of interest</li>\n  <li>The <a href=\"http://had.co.nz/ggplot2/\">ggplot</a> object responsible for generating the plot</li>\n</ul>\n\n<p>In this section we will parametrize CummeRbund to create different kinds of plots from our input data.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Visualization</hands-on-title>\n\n  <ol>\n    <li><strong>CummeRbund</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters\n      <ul>\n        <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span>  <strong>Insert plots</strong>\n          <ul>\n            <li><em>“Width”</em>: <code class=\"language-plaintext highlighter-rouge\">800</code></li>\n            <li><em>“Height”</em>: <code class=\"language-plaintext highlighter-rouge\">600</code></li>\n            <li><em>“Plot type”</em>: <code class=\"language-plaintext highlighter-rouge\">Expression Plot</code>\n              <ul>\n                <li><em>“Expression levels to plot”</em>:<code class=\"language-plaintext highlighter-rouge\">Isoforms</code></li>\n                <li><em>“Gene ID”</em>: <code class=\"language-plaintext highlighter-rouge\">NDUFV1</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<p>The input data used to create the visualization comprise 3 conditions: <em>hits7</em> (Patient 1), <em>hits8</em> (Patient 2), and <em>hits9</em> (Control).</p>\n\n<p>Our first CummeRbund plot is the “Expression Plot” of the isoforms of gene NDUFV1, which shows the expression differences of isoforms NM_001166102 and NM_007103 among the three conditions. Error bars capture the variability of the distribution of FPKM values: the broader the distribution of FPKM values, the larger the corresponding error bar.</p>\n\n<p><a href=\"../../images/transcriptomics_images/cummerbund-expression-plot.png\" rel=\"noopener noreferrer\"><img src=\"../../images/transcriptomics_images/cummerbund-expression-plot.png\" alt=\"Expression plot. \" width=\"800\" height=\"600\" loading=\"lazy\" /></a></p>\n\n<p>Our plot has a modest number of isoforms, and is therefore easy to read. However, with a high number of isoforms and expression variability among different conditions, the plot can look very busy. We can therefore change the visualization type by selecting another type of plot. Let’s change visualization.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Visualization</hands-on-title>\n\n  <ol>\n    <li><strong>CummeRbund</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters\n      <ul>\n        <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> Click on <em>“Insert plots”</em>\n          <ul>\n            <li><em>“Width”</em>: <code class=\"language-plaintext highlighter-rouge\">800</code></li>\n            <li><em>“Height”</em>: <code class=\"language-plaintext highlighter-rouge\">600</code></li>\n            <li><em>“Plot type”</em>: <code class=\"language-plaintext highlighter-rouge\">Expression Bar Plot</code>\n              <ul>\n                <li><em>“Expression levels to plot”</em>:<code class=\"language-plaintext highlighter-rouge\">Isoforms</code></li>\n                <li><em>“Gene ID”</em>: <code class=\"language-plaintext highlighter-rouge\">NDUFV1</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<p><a href=\"../../images/transcriptomics_images/cummerbund-expression-bar-plot.png\" rel=\"noopener noreferrer\"><img src=\"../../images/transcriptomics_images/cummerbund-expression-bar-plot.png\" alt=\"Expression bar plot. \" width=\"800\" height=\"600\" loading=\"lazy\" /></a></p>\n\n<p>The Expression Bar Plot of gene NDUFV1’s replicates NM_001166102 and NM_007103, shows the expression changes across the three aforementioned conditions.</p>\n\n<blockquote class=\"comment\">\n  <comment-title></comment-title>\n\n  <p>These plots are shown also in <a href=\"https://vimeo.com/channels/884356/128265982\">this</a> Galaxy video tutorial.</p>\n</blockquote>\n\n<p>Let’s now create a heatmap to plot the expression levels of the significant differentially expressed gene isoforms obtained from our filter and sort operations.\nAs a showcase example, let’s consider only the top 5 differentially expressed genes.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Visualization</hands-on-title>\n\n  <ol>\n    <li><strong>CummeRbund</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters\n      <ul>\n        <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span>  <strong>Insert plots</strong>\n          <ul>\n            <li><em>“Width”</em>: <code class=\"language-plaintext highlighter-rouge\">800</code></li>\n            <li><em>“Height”</em>: <code class=\"language-plaintext highlighter-rouge\">600</code></li>\n            <li><em>“Plot type”</em>: <code class=\"language-plaintext highlighter-rouge\">Heatmap</code>\n              <ul>\n                <li><em>“Expression levels to plot”</em>: <code class=\"language-plaintext highlighter-rouge\">Isoforms</code></li>\n                <li><em>“Gene ID”</em>: <code class=\"language-plaintext highlighter-rouge\">LIMCH1</code></li>\n                <li><em>“Gene ID”</em>: <code class=\"language-plaintext highlighter-rouge\">IFNL2</code></li>\n                <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <strong>Insert Genes</strong>\n                  <ul>\n                    <li><em>“Gene ID”</em>: <code class=\"language-plaintext highlighter-rouge\">CXCL11</code></li>\n                  </ul>\n                </li>\n                <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <strong>Insert Genes</strong>\n                  <ul>\n                    <li><em>“Gene ID”</em>: <code class=\"language-plaintext highlighter-rouge\">NUB1</code></li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n            <li><em>“Cluster by”</em>: <code class=\"language-plaintext highlighter-rouge\">Both</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p><a href=\"../../images/transcriptomics_images/cummerbund-heatmap.png\" rel=\"noopener noreferrer\"><img src=\"../../images/transcriptomics_images/cummerbund-heatmap.png\" alt=\"Expression bar plot. \" width=\"800\" height=\"600\" loading=\"lazy\" /></a></p>\n\n<p>Heatmap of significant differentially expressed isoforms of genes LIMCH1, IFNL2, CXCL11, NUB1. Differences in up- and down-regulation of certain gene isoforms across Patient 1 (hits7), Patient 2 (hits8), and Control (hits9), are visible in the lower and upper part of the heatmap.</p>\n\n<blockquote class=\"comment\">\n  <comment-title></comment-title>\n\n  <p>For more sophisticated visualizations of your RNA-Seq analysis results, try selecting different CummeRbund plot options and parametrizations. Have a look also at CummeRbund’s <a href=\"http://compbio.mit.edu/cummeRbund/manual_2_0.html\">manual</a>. Alternatively, you can modify a plot’s style by changing CummeRbund’s R output! CummeRbund’s R outputs are <em>ggplot</em> objects. Look at the <a href=\"https://github.com/tidyverse/ggplot2\">ggplot2 documentation</a> to learn how to change fonts, colors, error bars, and more.</p>\n</blockquote>\n\n<h1 id=\"conclusion\">Conclusion</h1>\n\n<p>Visualization tools help researchers making sense of data, providing a bird’s-eye view of the underlying analysis results.\nIn this tutorial we overviewed the advantages of visualizing RNA-Seq results with CummeRbund, and gained insights on CuffDiff’s big-data output by plotting information relative to the most significant differentially expressed genes in our RNA-Seq analysis.</p>\n"],"ref_slides":["# Why visualization?\n\n???\nData alone does not bring any information: to carry information, data needs to be contextualized. Transcriptomic data is no exception, therefore to organize the growing body of knowledge pertaining RNA-Seq experiments and infer valuable insights, data needs to be organized, annotated, and ultimately visualized.\n\n---\n\n### Where is my data coming from?\n\n![Wang et al, Nat Rev Genet, 2009](../../images/transcriptomics_images/cummerbund-rna-seq-experiment.jpg)\n\n<small>[*Wang et al, Nat Rev Genet, 2009*](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2949280/)</small>\n\n???\n- RNAs are converted into cDNA fragments through RNA fragmentation\n- sequencing adaptors (in blue) are then added to each cDNA fragment\n- cDNA sequences are obtained via NGS sequencing\n- the obtained reads are subsequently aligned against a reference genome or transcriptome, and classified in-silico as exonic reads, junction reads, and poly-A reads\n- these three types are then used to outline an expression profile for each gene\n\nThis is the process that will:\n\n- reveal new genes and splice variants\n- help quantifying cell-specific gene expression within the genome under study\n\nBut once this pipeline is implemented, how are sequence data going to be analysed and managed?\n\n---\n\n### Bioinformatic tools for RNA-Seq analysis\n\nOnce the RNA-Seq pipeline is implemented, we still need to handle and analyse all data that is generated. This requires:\n\n- computer science skills to be handled\n\n- mathematical knowledge to be interpreted\n\n---\n\n### Bioinformatic tools for RNA-Seq analysis\n\n![Trapnell et al, Nat Protoc, 2012](../../images/transcriptomics_images/cummerbund-rna-seq-experiment-tuxedo.jpg)\n\n<small>[*Trapnell et al, Nat Protoc, 2012*](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3334321/)</small>\n???\n- first, reads from each condition are mapped to the reference genome using TopHat\n- the resulting alignment files are given to Cufflinks, which generates a transcriptome assembly for each condition\n- the two assemblies are then merged together to provides a uniform basis for calculating of gene and transcript expression in each condition\n- both reads and merged assemblies are fed to CuffDiff, to calculate expression levels via statistical significance test for the observed changes\n\n---\n\n### Bioinformatic tools for RNA-Seq analysis\n\nThe last step in our RNA-Seq analysis is CuffDiff. Its output comprises multiple files containing the results of the differential expression analysis.\n\n- Gene expression levels are reported as <i>tab-separated</i> values: a simple tabular output that can be viewed with any spreadsheet application. Such files contain statistics, gene-related, and transcript-related attributes\n.image-75[![CuffDiff output](../../images/transcriptomics_images/cummerbund-cuffdiff-output.png)]\n\n- Another way to collect all these data is to organize it within a dedicated database for later consultation. CuffDiff can be instructed to do so\n.image-50[![CuffDiff output SQLite](../../images/transcriptomics_images/cummerbund-cuffdiff-set-sqlite.png)]\n\n???\n- CuffDiff provides analyses of differential expression and regulation at the gene and transcript level\n- its results are reported in a tab separated format\n- the overall collection of data is difficult to read to obtain a bird's-eye view of the change of expression\n- the data can be organized in a SQLite database\n\n---\n\n### Bioinformatic tools for RNA-Seq analysis\n\nWhatever storage strategy you opted for, i.e. multiple tab-separated-value files or a SQLite database, all data is still retained within text format.\n\nWe need to have a bird's-eye view of that data, and <i>make sense</i> of it\n\n---\n\n# Visualization\n\n---\n\n### CummeRbund\n\n[CummeRbund](http://compbio.mit.edu/cummeRbund/) is an R package for visualizing the results of a CuffDiff output.\n\n- Manages, integrates, and visualizes all data produced by CuffDiff\n\n- Simplifies data exploration\n\n- Provides a bird's-eye view of the expression analysis\n\n- Helps creating publication-ready plots\n\n---\n\n### CummeRbund\n\nCummeRbund needs to be instructed on which data to be visualized:\n\n- <i>Extract CuffDiff</i>'s \"Transcript differential expression testing\" table\n\n- <i>Filter</i> the table on the column storing the significance of a differentially expressed gene\n\n- <i>Sort</i> all entries on the basis of most significant differentially expressed gene\n\n- Identify the most significant differentially expressed gene\n\n---\n\n### CummeRbund\n\nOnce the most significant differentially expressed gene has been identified, CummeRbund can generate publication-ready plots to highlight...\n\n.image-50[![CummeRbund Expression plot](../../images/transcriptomics_images/cummerbund-expression-plot.png)]\n\nThe expression of all isoforms of the single gene with replicate FPKMs\n\n---\n\n### CummeRbund\n\nOnce the most significant differentially expressed gene has been identified, CummeRbund can generate publication-ready plots to highlight...\n\n.image-50[![CummeRbund Expression plot](../../images/transcriptomics_images/cummerbund-expression-bar-plot.png)]\n\nThe expression bar-plot of all isoforms of a gene with replicate FPKMs\n\n---\n\n### CummeRbund\n\n...and many more\n\n.image-50[![Other CummeRbund plots](../../images/transcriptomics_images/cummerbund-other-plots.png)]\n\nHave a look at [CummerBund's tutorial](https://bioconductor.org/packages/2.11/bioc/vignettes/cummeRbund/inst/doc/cummeRbund-manual.pdf) to overview all possibilities!\n"],"hands_on":true,"slides":true,"mod_date":"2023-11-03 14:30:27 +0000","pub_date":"2017-10-16 12:59:20 +0000","version":39,"api":"https://training.galaxyproject.org/training-material/api/topics/transcriptomics/tutorials/rna-seq-viz-with-cummerbund/tutorial.json","tools":[],"supported_servers":{"exact":[],"inexact":[{"name":"UseGalaxy.eu","url":"https://usegalaxy.eu","id":"eu","human":"Galaxy Europe","usegalaxy":true},{"name":"UseGalaxy.org","url":"https://usegalaxy.org","id":"us","human":"Galaxy Main","usegalaxy":true},{"name":"UseGalaxy.org.au","url":"https://usegalaxy.org.au","id":"au","human":"Galaxy Australia","usegalaxy":true},{"name":"UseGalaxy.fr","url":"https://usegalaxy.fr","id":"fr","human":"Galaxy France","usegalaxy":true}]},"topic_name_human":"Transcriptomics","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools: []\n","tours":false,"video":false,"slides_recordings":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial"}