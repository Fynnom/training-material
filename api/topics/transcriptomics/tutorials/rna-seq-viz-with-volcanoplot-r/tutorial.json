{"layout":"tutorial_hands_on","title":"Visualization of RNA-Seq results with Volcano Plot in R","level":"Intermediate","subtopic":"visualisation","zenodo_link":"https://zenodo.org/record/2529117","questions":["How to customise Volcano plot output in R?"],"objectives":["Learn how to use R to edit Volcano plot colours, points, labels and categories"],"time_estimation":"1H","key_points":["R can be used to customise Volcano Plot output","The RStudio interactive tool can be used to run R inside Galaxy"],"tags":["interactive-tools"],"contributors":[{"name":"Maria Doyle","joined":"2018-09","orcid":"0000-0003-4847-8436","id":"mblue9","url":"https://training.galaxyproject.org/training-material/api/contributors/mblue9.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/mblue9/"}],"requirements":[{"type":"internal","topic_name":"galaxy-interface","tutorials":["rstudio"]},{"type":"internal","topic_name":"data-science","tutorials":["r-basics","r-advanced"]},{"type":"internal","topic_name":"transcriptomics","tutorials":["rna-seq-viz-with-volcanoplot","rna-seq-counts-to-viz-in-r"]}],"js_requirements":{"mathjax":null,"mermaid":false},"short_id":"T00305","url":"/topics/transcriptomics/tutorials/rna-seq-viz-with-volcanoplot-r/tutorial.html","topic_name":"transcriptomics","tutorial_name":"rna-seq-viz-with-volcanoplot-r","dir":"topics/transcriptomics/tutorials/rna-seq-viz-with-volcanoplot-r","symlink":null,"id":"transcriptomics/rna-seq-viz-with-volcanoplot-r","ref_tutorials":["<p>The <a href=\"/training-material/topics/transcriptomics/tutorials/rna-seq-viz-with-volcanoplot/tutorial.html\">Volcano plot</a> tutorial, introduced volcano plots and showed how they can be generated with the Galaxy Volcano plot tool. In this tutorial we show how you can customise a plot using the R script output from the tool.</p>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n  <p>In this tutorial, we will deal with:</p>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#preparing-the-inputs\" id=\"markdown-toc-preparing-the-inputs\">Preparing the inputs</a>    <ol>\n      <li><a href=\"#import-data\" id=\"markdown-toc-import-data\">Import data</a></li>\n      <li><a href=\"#create-volcano-plot\" id=\"markdown-toc-create-volcano-plot\">Create volcano plot</a></li>\n      <li><a href=\"#import-files-into-r\" id=\"markdown-toc-import-files-into-r\">Import files into R</a></li>\n      <li><a href=\"#set-up-script\" id=\"markdown-toc-set-up-script\">Set up script</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#customising-the-plot\" id=\"markdown-toc-customising-the-plot\">Customising the plot</a>    <ol>\n      <li><a href=\"#change-points-colours\" id=\"markdown-toc-change-points-colours\">Change points colours</a></li>\n      <li><a href=\"#change-points-size\" id=\"markdown-toc-change-points-size\">Change points size</a></li>\n      <li><a href=\"#change-labels-size\" id=\"markdown-toc-change-labels-size\">Change labels size</a></li>\n      <li><a href=\"#change-categories\" id=\"markdown-toc-change-categories\">Change categories</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#conclusion\" id=\"markdown-toc-conclusion\">Conclusion</a></li>\n</ol>\n\n</blockquote>\n\n<h1 id=\"preparing-the-inputs\">Preparing the inputs</h1>\n\n<p>We will use one file for this analysis:</p>\n\n<ul>\n  <li><strong>Differentially expressed results file</strong> (genes in rows, and 4 required columns: raw P values, adjusted P values (FDR), log fold change and gene labels).</li>\n</ul>\n\n<p>If you are following on from the <a href=\"/training-material/topics/transcriptomics/tutorials/rna-seq-viz-with-volcanoplot/tutorial.html\">Volcano plot</a> tutorial, you already have this file in your History so you can skip to the <strong>Create volcano plot</strong> step below.</p>\n\n<h2 id=\"import-data\">Import data</h2>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Data upload</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Create a new history for this exercise e.g. <code class=\"language-plaintext highlighter-rouge\">Volcano plot R</code></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-new-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-new-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a new history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>Click the <i class=\"fas fa-plus\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">new-history</span> icon at the top of the history panel:</p>   <p><img src=\"/training-material/shared/images/history_create_new.svg\" alt=\"UI for creating new history\" /></p>   <!-- the original drawing can be found here https://docs.google.com/drawings/d/1cCBrLAo4kDGic5QyB70rRiWJAKTenTU8STsKDaLcVU8/edit?usp=sharing --> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-renaming-a-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-renaming-a-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Renaming a history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ol>   <li>Click on <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> (<strong>Edit</strong>) next to the history name (which by default is “Unnamed history”)</li>   <li>Type the new name</li>   <li>Click on <strong>Save</strong></li> </ol>   <p>If you do not have the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> (<strong>Edit</strong>) next to the history name:</p>   <ol>   <li>Click on <strong>Unnamed history</strong> (or the current name of the history) (<strong>Click to rename history</strong>) at the top of your history panel</li>   <li>Type the new name</li>   <li>Press <kbd>Enter</kbd></li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Import the differentially results table.</p>\n\n      <p>To import the file, there are two options:</p>\n      <ul>\n        <li>Option 1: From a shared data library if available (ask your instructor)</li>\n        <li>Option 2: From <a href=\"https://zenodo.org/record/2529117\">Zenodo</a></li>\n      </ul>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-via-links\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-via-links\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing via links</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-data-from-a-data-library\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-data-from-a-data-library\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing data from a data library</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>As an alternative to uploading the data from a URL or your computer, the files may also have been made available from a <em>shared data library</em>:</p>   <ol>   <li>Go into <strong>Shared data</strong> (top panel) then <strong>Data libraries</strong></li>   <li>Navigate to  the correct folder as indicated by your instructor.     <ul>       <li>On most Galaxies tutorial data will be provided in a folder named <strong>GTN - Material –&gt; Topic Name -&gt; Tutorial Name</strong>.</li>     </ul>   </li>   <li>Select the desired files</li>   <li>Click on <strong>Add to History</strong> <i class=\"fas fa-caret-down\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-dropdown</span> near the top and select <strong>as Datasets</strong> from the dropdown menu</li>   <li>     <p>In the pop-up window, choose</p>     <ul>       <li><em>“Select history”</em>: the history you want to import the data to (or create a new one)</li>     </ul>   </li>   <li>Click on <strong>Import</strong></li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <ul>\n        <li>\n          <p>You can paste the link below into the <strong>Paste/Fetch</strong> box:</p>\n\n          <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/2529117/files/limma-voom_luminalpregnant-luminallactate\n</code></pre></div>          </div>\n\n          <p>Check that the datatype is <code class=\"language-plaintext highlighter-rouge\">tabular</code>.\nIf the datatype is not <code class=\"language-plaintext highlighter-rouge\">tabular</code>, please change the file type to <code class=\"language-plaintext highlighter-rouge\">tabular</code>.</p>\n\n          <!--SNIPPET-->\n          <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-changing-the-datatype\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-changing-the-datatype\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Changing the datatype</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, click <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Datatypes</strong> tab on the top</li>   <li>In the <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Assign Datatype</strong>, select <code class=\"language-plaintext highlighter-rouge\">tabular</code> from “<em>New type</em>” dropdown     <ul>       <li>Tip: you can start typing the datatype into the field to filter the dropdown menu</li>     </ul>   </li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n          <p><!--END_SNIPPET--></p>\n        </li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<p>Click on the <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> (eye) icon and take a look at the <code class=\"language-plaintext highlighter-rouge\">DE results</code> file. It should look like below, with 8 columns.</p>\n\n<p><a href=\"../../images/rna-seq-viz-with-volcanoplot/DE_results.png\" rel=\"noopener noreferrer\"><img src=\"../../images/rna-seq-viz-with-volcanoplot/DE_results.png\" alt=\"DE results file. \" width=\"1332\" height=\"244\" loading=\"lazy\" /></a></p>\n\n<h2 id=\"create-volcano-plot\">Create volcano plot</h2>\n\n<p>We will create a volcano plot colouring all significant genes. We will call genes significant here if they have FDR &lt; 0.01 and a log2 fold change of 0.58 (equivalent to a fold-change of 1.5). These were the values used in the original paper for this dataset. We will also label the top 10 most significant genes with their gene names. We will select to output the Rscript file which we will then use to edit the plot in R.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Create a Volcano plot</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/volcanoplot/volcanoplot/0.0.5\" title=\"Volcano Plot tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Volcano Plot</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.0.5)</span> to create a volcano plot\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Specify an input file”</em>: the de results file</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“File has header?”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        <li><i class=\"fas fa-filter\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-select</span> <em>“FDR (adjusted P value)”</em>: <code class=\"language-plaintext highlighter-rouge\">Column 8</code></li>\n        <li><i class=\"fas fa-filter\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-select</span> <em>“P value (raw)”</em>: <code class=\"language-plaintext highlighter-rouge\">Column 7</code></li>\n        <li><i class=\"fas fa-filter\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-select</span> <em>“Log Fold Change”</em>: <code class=\"language-plaintext highlighter-rouge\">Column 4</code></li>\n        <li><i class=\"fas fa-filter\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-select</span> <em>“Labels”</em>: <code class=\"language-plaintext highlighter-rouge\">Column 2</code></li>\n        <li><i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-text</span> <em>“Significance threshold”</em>: <code class=\"language-plaintext highlighter-rouge\">0.01</code></li>\n        <li><i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-text</span> <em>“LogFC threshold to colour”</em>: <code class=\"language-plaintext highlighter-rouge\">0.58</code></li>\n        <li><i class=\"fas fa-filter\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-select</span> <em>“Points to label”</em>: <code class=\"language-plaintext highlighter-rouge\">Significant</code>\n          <ul>\n            <li><i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-text</span> <em>“Only label top most significant”</em>: <code class=\"language-plaintext highlighter-rouge\">10</code></li>\n          </ul>\n        </li>\n        <li>In <em>“Output Options”</em>:\n          <ul>\n            <li><i class=\"fas fa-filter\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-select</span> <em>“Output Rscript?”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<p>Click on the PDF file name to check that you see a plot like below.</p>\n\n<p><a href=\"../../images/rna-seq-viz-with-volcanoplot/volcanoplot_top10.png\" rel=\"noopener noreferrer\"><img src=\"../../images/rna-seq-viz-with-volcanoplot/volcanoplot_top10.png\" alt=\"Volcano plot labelling top significant genes. \" width=\"1330\" height=\"1338\" loading=\"lazy\" /></a></p>\n\n<p>Now we will customise the plot by editing the R code in RStudio. You can use Galaxy RStudio if available or another R such as RStudio Cloud or RStudio installed on your computer.</p>\n\n<h2 id=\"import-files-into-r\">Import files into R</h2>\n\n<p>We’ll import the differentially expressed results input file and the RScript into R.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Using datasets from Galaxy</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Note the history IDs of 1) the differentially expressed results and 2) the RScript in your Galaxy history</p>\n    </li>\n    <li>\n      <p><span class=\"tool\" data-tool=\"interactive_tool_rstudio\" title=\"RStudio tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>RStudio</strong></span> in Galaxy provides some special functions such as <code class=\"language-plaintext highlighter-rouge\">gx_get</code> to import and export files from your history.</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"hands_on\">   <div class=\"box-title hands_on-title\" id=\"hands-on-launch-rstudio\"><i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i> Hands-on: Launch RStudio</div>   <p>Depending on which server you are using, you may be able to run RStudio directly in Galaxy. If that is not available, RStudio Cloud can be an alternative.</p>   <blockquote class=\"tip\">   <tip-title>Launch RStudio in Galaxy</tip-title>   <p>Currently RStudio in Galaxy is only available on <a href=\"https://usegalaxy.eu\">UseGalaxy.eu</a> and <a href=\"https://usegalaxy.org\">UseGalaxy.org</a></p>   <ol>     <li>Open the Rstudio tool <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> by clicking <a href=\"https://usegalaxy.eu/?tool_id=interactive_tool_rstudio\">here to launch RStudio</a></li>     <li>Click Run Tool</li>     <li>The tool will start running and will stay running permanently</li>     <li>Click on the “User” menu at the top and go to “Active InteractiveTools” and locate the RStudio instance you started.</li>   </ol> </blockquote>   <blockquote class=\"tip\">   <tip-title>Launch RStudio Cloud if not available on Galaxy</tip-title>   <p>If RStudio is not available on the Galaxy instance:</p>   <ol>     <li>Register for <a href=\"https://client.login.rstudio.cloud/oauth/login?show_auth=0&amp;show_login=1&amp;show_setup=1\">RStudio Cloud</a>, or login if you already have an account</li>     <li>Create a new project</li>   </ol> </blockquote> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Copy the files we need into our workspace so we can see them in the Files pane.</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">file.copy</span><span class=\"p\">(</span><span class=\"n\">gx_get</span><span class=\"p\">(</span><span class=\"m\">1</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"s2\">\"de-results.tsv\"</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"c1\"># will copy dataset number 1 from your history, use the correct ID for your differentially expressed results dataset.</span><span class=\"w\">\n</span><span class=\"n\">file.copy</span><span class=\"p\">(</span><span class=\"n\">gx_get</span><span class=\"p\">(</span><span class=\"m\">3</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"s2\">\"volcano.R\"</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"c1\"># will copy dataset number 3 from your history, use the correct ID for your Rscript dataset.</span><span class=\"w\">\n</span></code></pre></div>      </div>\n    </li>\n    <li>\n      <p>Click on <code class=\"language-plaintext highlighter-rouge\">volcano.R</code> in the Files pane to open it in the Editor pane.</p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>We’ll have a look at the script.</p>\n\n<h2 id=\"set-up-script\">Set up script</h2>\n\n<p>The first few lines from <code class=\"language-plaintext highlighter-rouge\"># Galaxy settings start</code> to <code class=\"language-plaintext highlighter-rouge\"># Galaxy settings end</code> are settings needed to run the Volcano plot tool in Galaxy. We don’t need them to run the script in R so we will delete them. If we don’t delete the error handling line, the R session will crash if we encounter any error in the code. It’s ok as it will resume again where we were but better to not have this happen.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Delete unneeded lines</hands-on-title>\n\n  <p>Delete these lines from the top of the script.</p>\n\n  <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"w\">   </span><span class=\"c1\"># Galaxy settings start ---------------------------------------------------</span><span class=\"w\">\n\n   </span><span class=\"c1\"># setup R error handling to go to stderr</span><span class=\"w\">\n   </span><span class=\"n\">options</span><span class=\"p\">(</span><span class=\"n\">show.error.messages</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nb\">F</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">error</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"k\">function</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"n\">cat</span><span class=\"p\">(</span><span class=\"n\">geterrmessage</span><span class=\"p\">(),</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">stderr</span><span class=\"p\">());</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"p\">(</span><span class=\"s2\">\"no\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"m\">1</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nb\">F</span><span class=\"p\">)})</span><span class=\"w\">\n\n   </span><span class=\"c1\"># we need that to not crash galaxy with an UTF8 error on German LC settings.</span><span class=\"w\">\n   </span><span class=\"n\">loc</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">Sys.setlocale</span><span class=\"p\">(</span><span class=\"s2\">\"LC_MESSAGES\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"en_US.UTF-8\"</span><span class=\"p\">)</span><span class=\"w\">\n\n   </span><span class=\"c1\"># Galaxy settings end -----------------------------------------------------</span><span class=\"w\">\n</span></code></pre></div>  </div>\n\n</blockquote>\n\n<p>We’ll check if we have the packages the script needs. We can see the packages used in the lines that have <code class=\"language-plaintext highlighter-rouge\">library(package)</code></p>\n\n<div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">library</span><span class=\"p\">(</span><span class=\"n\">dplyr</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"n\">library</span><span class=\"p\">(</span><span class=\"n\">ggplot2</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"n\">library</span><span class=\"p\">(</span><span class=\"n\">ggrepel</span><span class=\"p\">)</span><span class=\"w\">\n</span></code></pre></div></div>\n\n<p>When we launched Galaxy RStudio there was information in the Console letting us know that some packages are pre-installed. These packages include <code class=\"language-plaintext highlighter-rouge\">ggplot2</code> and <code class=\"language-plaintext highlighter-rouge\">dplyr</code>. In this Galaxy there is a yellow warning banner across the top of the script saying <code class=\"language-plaintext highlighter-rouge\">Package ggrepel required is not installed. Install. Don't Show Again</code>.\nSo we just need to install the <code class=\"language-plaintext highlighter-rouge\">ggrepel</code> package.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Install package</hands-on-title>\n\n  <p>Either click on “Install” in the yellow warning banner if present, or in the Console type</p>\n\n  <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">install.packages</span><span class=\"p\">(</span><span class=\"s1\">'ggrepel'</span><span class=\"p\">)</span><span class=\"w\">\n</span></code></pre></div>  </div>\n\n</blockquote>\n\n<p>We need to change the path of the differentially expressed file in the script. The path in the script is <code class=\"language-plaintext highlighter-rouge\">/data/dnb03/galaxy_db/files/4/6/c/dataset_46c498bc-060e-492f-9b42-51908a55e354.dat</code>. This is a temporary location where the Galaxy Volcano plot tool copied the input file in order to use it, the file no longer exists there. Your path will be different. In the script change this path to <code class=\"language-plaintext highlighter-rouge\">de-results.tsv</code> like below.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Run script</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Change the input file path in script</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\"># change the line</span><span class=\"w\">\n</span><span class=\"n\">results</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">read.delim</span><span class=\"p\">(</span><span class=\"s1\">'/data/dnb03/galaxy_db/files/4/6/c/dataset_46c498bc-060e-492f-9b42-51908a55e354.dat'</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">header</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">TRUE</span><span class=\"p\">)</span><span class=\"w\">\n\n</span><span class=\"c1\"># to</span><span class=\"w\">\n</span><span class=\"n\">results</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">read.delim</span><span class=\"p\">(</span><span class=\"s1\">'de-results.tsv'</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">header</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">TRUE</span><span class=\"p\">)</span><span class=\"w\">\n</span></code></pre></div>      </div>\n    </li>\n    <li>\n      <p>Highlight the code in the script and run</p>\n\n      <blockquote class=\"tip\">\n        <tip-title>Highlight all code and run shortcuts</tip-title>\n        <ul>\n          <li>To highlight all code type <kbd>CTRL</kbd>+<kbd>a</kbd> (or <kbd>CMD</kbd>+<kbd>a</kbd>)</li>\n          <li>To run type <kbd>CTRL</kbd>+<kbd>Enter</kbd> (or <kbd>CMD</kbd>+<kbd>Enter</kbd>)</li>\n        </ul>\n      </blockquote>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>You should see a file called <code class=\"language-plaintext highlighter-rouge\">volcano_plot.pdf</code> appear in the Files pane. Click on it to open it and you should see a plot that looks the same as the one we generated with the Volcano Plot tool in Galaxy.</p>\n\n<p>We’ll delete the lines below that save the plot to a PDF file. The plots will then be produced in the Plots pane so we can more easily see the different plots we’re going to make, without having to keep opening the PDF file.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Produce plots in Plots pane</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Delete the lines below that save the plot to a PDF file</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\"># Open PDF graphics device</span><span class=\"w\">\n</span><span class=\"n\">pdf</span><span class=\"p\">(</span><span class=\"s2\">\"volcano_plot.pdf\"</span><span class=\"p\">)</span><span class=\"w\">\n\n</span><span class=\"c1\"># keep the lines in between as they produce the plot</span><span class=\"w\">\n\n</span><span class=\"c1\"># Close PDF graphics device</span><span class=\"w\">\n</span><span class=\"n\">dev.off</span><span class=\"p\">()</span><span class=\"w\">\n</span></code></pre></div>      </div>\n    </li>\n    <li>\n      <p>Highlight the code in the script and run</p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>You should now see the plot produced in the Plots pane.</p>\n\n<h1 id=\"customising-the-plot\">Customising the plot</h1>\n\n<h2 id=\"change-points-colours\">Change points colours</h2>\n\n<p>We’ll demonstate how you can change the colours. We’ll change the colour of the downregulated genes from cornflowerblue to purple. We’ll change the upregulated genes from firebrick to orange.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Change colours</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Edit the line below in the script</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\"># change the line</span><span class=\"w\">\n</span><span class=\"n\">colours</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">setNames</span><span class=\"p\">(</span><span class=\"nf\">c</span><span class=\"p\">(</span><span class=\"s2\">\"cornflowerblue\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"grey\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"firebrick\"</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"nf\">c</span><span class=\"p\">(</span><span class=\"n\">down</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">notsig</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">up</span><span class=\"p\">))</span><span class=\"w\">\n\n</span><span class=\"c1\"># to</span><span class=\"w\">\n</span><span class=\"n\">colours</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">setNames</span><span class=\"p\">(</span><span class=\"nf\">c</span><span class=\"p\">(</span><span class=\"s2\">\"purple\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"grey\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"orange\"</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"nf\">c</span><span class=\"p\">(</span><span class=\"n\">down</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">notsig</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">up</span><span class=\"p\">))</span><span class=\"w\">\n</span></code></pre></div>      </div>\n    </li>\n    <li>\n      <p>Highlight the code in the script and run</p>\n    </li>\n  </ol>\n\n  <p><a href=\"../../images/rna-seq-viz-with-volcanoplot-r/volcano_points_colours.png\" rel=\"noopener noreferrer\"><img src=\"../../images/rna-seq-viz-with-volcanoplot-r/volcano_points_colours.png\" alt=\"Smaller points. \" width=\"1324\" height=\"854\" loading=\"lazy\" /></a></p>\n\n</blockquote>\n\n<blockquote class=\"tip\">\n  <tip-title>R colours</tip-title>\n\n  <p>If you want to use other colours you can see the built-in R colours with their names in <a href=\"https://www.nceas.ucsb.edu/sites/default/files/2020-04/colorPaletteCheatsheet.pdf\">this cheatsheet</a>.</p>\n\n</blockquote>\n\n<h2 id=\"change-points-size\">Change points size</h2>\n\n<p>We’ll make the points a bit smaller. We’ll change to 0.5.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Change points size</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Edit the line below in the script</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\"># change the line</span><span class=\"w\">\n</span><span class=\"n\">geom_point</span><span class=\"p\">(</span><span class=\"n\">aes</span><span class=\"p\">(</span><span class=\"n\">colour</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">sig</span><span class=\"p\">))</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\">\n\n</span><span class=\"c1\"># to</span><span class=\"w\">\n</span><span class=\"n\">geom_point</span><span class=\"p\">(</span><span class=\"n\">aes</span><span class=\"p\">(</span><span class=\"n\">colour</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">sig</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"n\">size</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"m\">0.5</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\">\n</span></code></pre></div>      </div>\n    </li>\n    <li>\n      <p>Highlight the code in the script and run</p>\n    </li>\n  </ol>\n\n  <p><a href=\"../../images/rna-seq-viz-with-volcanoplot-r/volcano_points_size.png\" rel=\"noopener noreferrer\"><img src=\"../../images/rna-seq-viz-with-volcanoplot-r/volcano_points_size.png\" alt=\"Smaller points. \" width=\"1312\" height=\"854\" loading=\"lazy\" /></a></p>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>How could we change the transparency of the points?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <p>We could use <code class=\"language-plaintext highlighter-rouge\">alpha =</code>. For example</p>\n    <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">geom_point</span><span class=\"p\">(</span><span class=\"n\">aes</span><span class=\"p\">(</span><span class=\"n\">colour</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">sig</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"n\">alpha</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"m\">0.5</span><span class=\"p\">)</span><span class=\"w\">\n</span></code></pre></div>    </div>\n\n  </blockquote>\n</blockquote>\n\n<h2 id=\"change-labels-size\">Change labels size</h2>\n\n<p>We’ll make the font size of the labels a bit smaller.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Change labels text size</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Edit the line below in the script</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\"># change the line</span><span class=\"w\">\n</span><span class=\"n\">geom_text_repel</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">filter</span><span class=\"p\">(</span><span class=\"n\">results</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">labels</span><span class=\"w\"> </span><span class=\"o\">!=</span><span class=\"w\"> </span><span class=\"s2\">\"\"</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"n\">aes</span><span class=\"p\">(</span><span class=\"n\">label</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">labels</span><span class=\"p\">),</span><span class=\"w\">\n\n</span><span class=\"c1\"># to</span><span class=\"w\">\n</span><span class=\"n\">geom_text_repel</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">filter</span><span class=\"p\">(</span><span class=\"n\">results</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">labels</span><span class=\"w\"> </span><span class=\"o\">!=</span><span class=\"w\"> </span><span class=\"s2\">\"\"</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"n\">aes</span><span class=\"p\">(</span><span class=\"n\">label</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">labels</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"n\">size</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"m\">3</span><span class=\"p\">,</span><span class=\"w\">\n</span></code></pre></div>      </div>\n    </li>\n    <li>\n      <p>Highlight the code in the script and run</p>\n    </li>\n  </ol>\n\n  <p><a href=\"../../images/rna-seq-viz-with-volcanoplot-r/volcano_labels_size.png\" rel=\"noopener noreferrer\"><img src=\"../../images/rna-seq-viz-with-volcanoplot-r/volcano_labels_size.png\" alt=\"Smaller labels. \" width=\"1318\" height=\"852\" loading=\"lazy\" /></a></p>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>How could we change the number of genes labelled from 10 to 20?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <p>We could change the 10 to 20 here</p>\n    <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">top</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">slice_min</span><span class=\"p\">(</span><span class=\"n\">results</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">order_by</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">pvalue</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"m\">20</span><span class=\"p\">)</span><span class=\"w\">\n</span></code></pre></div>    </div>\n\n  </blockquote>\n</blockquote>\n\n<h2 id=\"change-categories\">Change categories</h2>\n\n<p>We can change the categories of points we’re colouring in the plot. For example, instead of using separate categories for upregulated, downregulated we could just use a single category for significant.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Change categories</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Change the category names to signif and notsignif</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\"># change</span><span class=\"w\">\n</span><span class=\"n\">down</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">unlist</span><span class=\"p\">(</span><span class=\"n\">strsplit</span><span class=\"p\">(</span><span class=\"s1\">'Down,Not Sig,Up'</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">split</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\",\"</span><span class=\"p\">))[</span><span class=\"m\">1</span><span class=\"p\">]</span><span class=\"w\">\n</span><span class=\"n\">notsig</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">unlist</span><span class=\"p\">(</span><span class=\"n\">strsplit</span><span class=\"p\">(</span><span class=\"s1\">'Down,Not Sig,Up'</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">split</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\",\"</span><span class=\"p\">))[</span><span class=\"m\">2</span><span class=\"p\">]</span><span class=\"w\">\n</span><span class=\"n\">up</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">unlist</span><span class=\"p\">(</span><span class=\"n\">strsplit</span><span class=\"p\">(</span><span class=\"s1\">'Down,Not Sig,Up'</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">split</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\",\"</span><span class=\"p\">))[</span><span class=\"m\">3</span><span class=\"p\">]</span><span class=\"w\">\n\n</span><span class=\"c1\"># to</span><span class=\"w\">\n</span><span class=\"n\">signif</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"s2\">\"Significant\"</span><span class=\"w\">\n</span><span class=\"n\">notsignif</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"s2\">\"Not significant\"</span><span class=\"w\">\n</span></code></pre></div>      </div>\n    </li>\n    <li>\n      <p>Specify which genes are signif and notsignif</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\"># change</span><span class=\"w\">\n</span><span class=\"n\">results</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">mutate</span><span class=\"p\">(</span><span class=\"n\">results</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">sig</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">case_when</span><span class=\"p\">(</span><span class=\"w\">\n                            </span><span class=\"n\">fdr</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"w\"> </span><span class=\"m\">0.01</span><span class=\"w\"> </span><span class=\"o\">&amp;</span><span class=\"w\"> </span><span class=\"n\">logfc</span><span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"m\">0.58</span><span class=\"w\"> </span><span class=\"o\">~</span><span class=\"w\"> </span><span class=\"n\">up</span><span class=\"p\">,</span><span class=\"w\">\n                            </span><span class=\"n\">fdr</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"w\"> </span><span class=\"m\">0.01</span><span class=\"w\"> </span><span class=\"o\">&amp;</span><span class=\"w\"> </span><span class=\"n\">logfc</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"w\"> </span><span class=\"m\">-0.58</span><span class=\"w\"> </span><span class=\"o\">~</span><span class=\"w\"> </span><span class=\"n\">down</span><span class=\"p\">,</span><span class=\"w\">\n                            </span><span class=\"kc\">TRUE</span><span class=\"w\"> </span><span class=\"o\">~</span><span class=\"w\"> </span><span class=\"n\">notsig</span><span class=\"p\">))</span><span class=\"w\">\n\n</span><span class=\"c1\"># to</span><span class=\"w\">\n</span><span class=\"n\">results</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">mutate</span><span class=\"p\">(</span><span class=\"n\">results</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">sig</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">case_when</span><span class=\"p\">(</span><span class=\"w\">\n                            </span><span class=\"n\">fdr</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"w\"> </span><span class=\"m\">0.01</span><span class=\"w\"> </span><span class=\"o\">&amp;</span><span class=\"w\"> </span><span class=\"nf\">abs</span><span class=\"p\">(</span><span class=\"n\">logfc</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"m\">0.58</span><span class=\"w\"> </span><span class=\"o\">~</span><span class=\"w\"> </span><span class=\"n\">signif</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"c1\"># abs() will give us absolute values i.e. all &gt; 0.58 and &lt; -0.58</span><span class=\"w\">\n                            </span><span class=\"kc\">TRUE</span><span class=\"w\"> </span><span class=\"o\">~</span><span class=\"w\"> </span><span class=\"n\">notsignif</span><span class=\"p\">))</span><span class=\"w\">\n</span></code></pre></div>      </div>\n    </li>\n    <li>\n      <p>Specify the colours for signif and notsignif</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\"># change</span><span class=\"w\">\n</span><span class=\"n\">colours</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">setNames</span><span class=\"p\">(</span><span class=\"nf\">c</span><span class=\"p\">(</span><span class=\"s2\">\"purple\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"grey\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"orange\"</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"nf\">c</span><span class=\"p\">(</span><span class=\"n\">down</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">notsig</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">up</span><span class=\"p\">))</span><span class=\"w\">\n\n</span><span class=\"c1\"># to</span><span class=\"w\">\n</span><span class=\"n\">colours</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">setNames</span><span class=\"p\">(</span><span class=\"nf\">c</span><span class=\"p\">(</span><span class=\"s2\">\"grey\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"red\"</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"nf\">c</span><span class=\"p\">(</span><span class=\"n\">notsignif</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">signif</span><span class=\"p\">))</span><span class=\"w\">\n</span></code></pre></div>      </div>\n    </li>\n    <li>\n      <p>runHighlight the code in the script and</p>\n    </li>\n  </ol>\n\n  <p><a href=\"../../images/rna-seq-viz-with-volcanoplot-r/volcano_categories.png\" rel=\"noopener noreferrer\"><img src=\"../../images/rna-seq-viz-with-volcanoplot-r/volcano_categories.png\" alt=\"Categories changed. \" width=\"1420\" height=\"850\" loading=\"lazy\" /></a></p>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>How would you remove the legend from the plot? You can use Google.</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <p>If you Google <code class=\"language-plaintext highlighter-rouge\">remove legend ggplot2</code> you may find a few ways it can be done. One way is</p>\n\n    <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">theme</span><span class=\"p\">(</span><span class=\"n\">legend.position</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"none\"</span><span class=\"p\">)</span><span class=\"w\">\n</span></code></pre></div>    </div>\n\n  </blockquote>\n</blockquote>\n\n<p>You can save the edited script by clicking the <i class=\"far fa-save\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-save</span> icon at the top of the script in RStudio or through File &gt; Save. You can download from Galaxy RStudio from the Files pane by ticking the box beside the script name, then More &gt; Export &gt; Download.</p>\n\n<blockquote class=\"tip\">\n  <tip-title>More plot options</tip-title>\n\n  <p>If you enter values in the Volcano Plot Galaxy tool form for Plot options, such as plot title, x and y axis labels or limits, they’ll be output in the script. This is one way you could see how to customise these options in the plot.</p>\n\n</blockquote>\n\n<h1 id=\"conclusion\">Conclusion</h1>\n\n<p>In this tutorial we have seen how a volcano plot can be generated and customised using Galaxy and R. You can see some more possible customisations in the <a href=\"/training-material/topics/transcriptomics/tutorials/rna-seq-viz-with-volcanoplot/tutorial.html\">RNA Seq Counts to Viz in R</a> tutorial and at the <a href=\"https://ggrepel.slowkow.com/index.html\">ggrepel website</a>.</p>\n"],"ref_slides":[],"video_library":{"tutorial":{"description":"The previous tutorial introduced volcano plots and showed how they can be generated with the Galaxy Volcano plot tool. In this tutorial we show how you can customise a plot using the R script output from the tool.","materials":[{"link":"topics/transcriptomics/tutorials/rna-seq-viz-with-volcanoplot-r/tutorial.html","title":"Customizing your Volcano plots using R in Galaxy","type":"Tutorial"}],"support_channel":"transcriptomics_rna-seq-viz-with-volcanoplot","tags":["transcriptomics","visualisation"],"type":"Tutorial","versions":[{"captions":["mblue9"],"date":"2021-02-15","galaxy_version":"21.01","length":"15M","link":"4dspgiwkuxk","speakers":["mblue9"]}],"gtn_id":"transcriptomics/rna-seq-viz-with-volcanoplot-r","title":"Visualization of RNA-Seq results with Volcano Plot in R","captioned":true},"slides":null,"demo":null,"both":null,"session":null},"hands_on":true,"slides":false,"mod_date":"2023-11-03 14:30:27 +0000","pub_date":"2021-06-14 16:11:02 +0000","version":13,"api":"https://training.galaxyproject.org/training-material/api/topics/transcriptomics/tutorials/rna-seq-viz-with-volcanoplot-r/tutorial.json","tools":["interactive_tool_rstudio","toolshed.g2.bx.psu.edu/repos/iuc/volcanoplot/volcanoplot/0.0.5"],"supported_servers":{"exact":[{"url":"https://usegalaxy.eu","name":"UseGalaxy.eu","usegalaxy":true},{"url":"https://usegalaxy.fr/","name":"UseGalaxy.fr","usegalaxy":false},{"url":"https://usegalaxy.org","name":"UseGalaxy.org (Main)","usegalaxy":true},{"url":"https://usegalaxy.org.au","name":"UseGalaxy.org.au","usegalaxy":true}],"inexact":[]},"topic_name_human":"Transcriptomics","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"volcanoplot","owner":"iuc","revisions":"83c573f2e73c","tool_panel_section_label":"Graph/Display Data","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: volcanoplot\n  owner: iuc\n  revisions: 83c573f2e73c\n  tool_panel_section_label: Graph/Display Data\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial"}