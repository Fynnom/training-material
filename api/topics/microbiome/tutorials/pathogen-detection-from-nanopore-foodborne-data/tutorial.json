{"layout":"tutorial_hands_on","title":"Pathogen detection from (direct Nanopore) sequencing data using Galaxy - Foodborne Edition","subtopic":"metagenomics","tags":["microgalaxy","Nanopore data analysis","Pathogens detection","Phylogenetic tree","Heatmap","cyoa"],"level":"Introductory","zenodo_link":"https://zenodo.org/record/11222469","questions":["What are the preprocessing steps to prepare ONT sequencing data for further analysis?","How to identify pathogens using sequencing data?","How to track the found pathogens through all your samples datasets?"],"objectives":["Check quality reports generated by FastQC and NanoPlot for metagenomics Nanopore data","Preprocess the sequencing data to remove adapters, poor quality base content and host/contaminating reads","Perform taxonomy profiling indicating and visualizing up to species level in the samples","Identify pathogens based on the found virulence factor gene products via assembly, identify strains and indicate all antimicrobial resistance genes in samples","Identify pathogens via SNP calling and build the consensus gemone of the samples","Relate all samples' pathogenic genes for tracking pathogens via phylogenetic trees and heatmaps"],"time_estimation":"4h","contributions":{"authorship":["bebatut","EngyNasr","paulzierep"],"editing":["hrhotz","wm75"],"funding":["gallantries","eosc-life"]},"redirect_from":["/topics/metagenomics/tutorials/pathogen-detection-from-nanopore-foodborne-data/tutorial","/short/microbiome/pathogen-detection-from-nanopore-foodborne-data","/short/T00208","/short/T00393"],"edam_ontology":["topic_3174","topic_3305","topic_0637","topic_0196","topic_0634","topic_0080"],"recordings":[{"youtube_id":"gQHb_jkj-Z0","date":"2023-05-01","galaxy_version":"23.01","length":"1H45M","speakers":["EngyNasr"],"captioners":["EngyNasr"]}],"js_requirements":{"mathjax":null,"mermaid":false},"short_id":"T00393","url":"/topics/microbiome/tutorials/pathogen-detection-from-nanopore-foodborne-data/tutorial.html","topic_name":"microbiome","tutorial_name":"pathogen-detection-from-nanopore-foodborne-data","dir":"topics/microbiome/tutorials/pathogen-detection-from-nanopore-foodborne-data","symlink":null,"id":"microbiome/pathogen-detection-from-nanopore-foodborne-data","ref_tutorials":["<p>Food contamination with pathogens is a major burden on our society. In the year 2019, foodborne pathogens caused 137 hospitalisations in Germany <a href=\"https://www.bvl.bund.de/SharedDocs/Berichte/10_BELA_lebensmittelbed_Krankheitsausbruechen_Dtl/Jahresbericht2019.pdf?__blob=publicationFile&amp;v=4\">(BVL 2019)</a>. Globally, they affect an estimated 600 million people a year and impact socioeconomic development at different levels. These outbreaks are mainly due to <em>Salmonella spp.</em> followed by <em>Campylobacter spp.</em> and Noroviruses, as studied by the <a href=\"https://www.who.int/publications/i/item/9789241565165\"><strong>Food safety - World Health Organization (WHO)</strong></a>.</p>\n\n<p>During the investigation of a foodborne outbreak, a microbiological analysis of the potentially responsible food vehicle is performed in order to detect the responsible pathogens and identify the contamination source. By default, the <a href=\"https://eur-lex.europa.eu/LexUriServ/LexUriServ.do?uri=OJ:L:2005:338:0001:0026:EN:PDF\"><strong>European Regulation (EC)</strong></a> follows ISO standards to detect bacterial pathogens in food: pathogens are detected and identified by <strong>stepwise cultures</strong> on selective media and/or <strong>targeting specific genes with real-time PCRs</strong>. The current gold standard is Pulsed-field Gel Electrophoresis (PFGE) or Multiple-Locus Variable Number Tandem Repeat Analysis (MLVA) to characterize the detected strains. These techniques have some disadvantages.</p>\n\n<p><strong>Whole Genome Sequencing</strong> (WGS) has been proposed as an alternative. With just one sequencing run, we can:</p>\n<ul>\n  <li>detect all genes</li>\n  <li>run phylogenetic analysis to link cases</li>\n  <li>get information on antimicrobial resistance genes, virulence, serotype, resistance to sanitizers, root cause, and other critical factors in one assay, including historical reference to pathogen emergence.</li>\n</ul>\n\n<p>WGS is more than a surveillance tool and was recommended by the European Centre for Disease Prevention and Control (ECDC) and the European Food Safety Authority (EFSA) for surveillance and outbreak investigation. WGS still requires isolation of the targeted pathogen, which is a time-consuming process, the execution is not always straightforward, nor the success is guaranteed. <strong>Sequencing methods without prior isolation could solve this issue</strong>.</p>\n\n<p>The evolution of sequencing techniques in the last decades has made the development of shotgun metagenomic sequencing possible, <em>i.e.</em> the <strong>direct sequencing of all DNA present in a sample</strong>. This approach gives an overview of the genomic composition of all cells in the sample, including the food source itself, the microbial community, and any possible pathogens and their complete genetic information without the need for prior isolation. Several studies have demonstrated the potential of shotgun metagenomics to identify and characterize pathogens and their functional characteristics (<em>e.g.</em> virulence genes) in naturally contaminated or purposefully spiked food samples.</p>\n\n<p>The currently available studies used Illumina sequencing, generating short reads. Longer read lengths, generated by third-generation sequencing platforms such as Pacific Biosciences (PacBio) and Oxford Nanopore Technologies (ONT), make it <strong>easier and more practical to identify strains with fewer reads</strong>. MinION (from Oxford Nanopore) is a portable, real-time device for ONT sequencing. Several proof-of-principle studies have shown the <strong>utility of ONT long-read sequencing from metagenomic samples for pathogen identification</strong> (<span class=\"citation\"><a href=\"#CIUFFREDA20211497\">Ciuffreda <i>et al.</i> 2021</a></span>).</p>\n\n<!--SNIPPET-->\n<blockquote class=\"comment\">   <div class=\"box-title comment-title\" id=\"comment-nanopore-sequencing\"><i class=\"far fa-comment-dots\" aria-hidden=\"true\"></i> Comment: Nanopore sequencing</div>   <p>Nanopore sequencing has several properties that make it well-suited for our purposes</p>   <ol>   <li>Long-read sequencing technology offers <strong>simplified</strong> and less ambiguous genome <strong>assembly</strong></li>   <li>Long-read sequencing gives the ability to <strong>span repetitive genomic regions</strong></li>   <li>Long-read sequencing makes it possible to <strong>identify large structural variations</strong></li> </ol>   <p><img src=\"/training-material/topics/microbiome/images/plasmid-metagenomics-nanopore/nanopore_sequencing.png\" alt=\"How nanopore sequencing works\" title=\"Using nanopore sequencing, a single molecule of DNA or RNA can be sequenced without the need for PCR amplification or chemical labeling of the sample. (Image from: &lt;a href=&quot;https://doi.org/10.7875/togopic.2020.01&quot;&gt;Nanopore sequencing: The advantages of long reads for genome assembly&lt;/a&gt;)\" /> <br /><br /></p>   <p>When using Oxford Nanopore Technologies (ONT) sequencing, the change in electrical current is measured over the membrane of a flow cell. When nucleotides pass the pores in the flow cell the current change is translated (basecalled) to nucleotides by a basecaller. A schematic overview is given in the picture above.</p>   <p>When sequencing using a MinIT or MinION Mk1C, the basecalling software is present on the devices. With basecalling the electrical signals are translated to bases (A,T,G,C) with a quality score per base. The sequenced DNA strand will be basecalled and this will form one read. Multiple reads will be stored in a fastq file.</p> </blockquote>\n<p><!--END_SNIPPET--></p>\n\n<p>To identify and track foodborne pathogens using long-read metagenomic sequencing, different samples of potentially contaminated food (at different time points or different locations) are prepared, DNA is extracted and sequenced using MinION (ONT). The generated sequencing data then need to be processed using bioinformatics tools.</p>\n\n<p>In this tutorial, we will be presenting a series of Galaxy workflows whose main goals are to:</p>\n<ol>\n  <li><strong>agnostically detect pathogens</strong> (What exactly is this pathogen and what virulence factors does it carry?) from data extracted directly (without prior cultivation) from a potentially contaminated sample (e.g. food like chicken, beef, etc.) and sequenced using Nanopore</li>\n  <li><strong>compare different samples to trace</strong> the possible source of contamination</li>\n</ol>\n\n<p>To illustrate how to process such data, we will use datasets generated by <a href=\"https://www.biolytix.ch/\">Biolytix</a> with the following approach:</p>\n\n<p><a href=\"./images/Biolytix_Workflow_Sequencing.png\" rel=\"noopener noreferrer\"><img src=\"./images/Biolytix_Workflow_Sequencing.png\" alt=\"From left to right: Biolytix logo. Chicken + milk. An arrow going to the right toward Chicken + milk and a syringe with &quot;Contamination with known pathogens&quot; written below. An arrow going to the right toward an Eppendorf tube with &quot;DNA extraction&quot; written below,  An arrow going to the right toward a qPCR machine, and another arrow over the qPCR toward a Nanopore sequencing. . \" width=\"1589\" height=\"387\" loading=\"lazy\" /></a></p>\n\n<p>Food samples, here chicken, are spiked with known pathogens, here:</p>\n<ul>\n  <li><em>Salmonella enterica subsp. enterica</em>  in the sample named <code class=\"language-plaintext highlighter-rouge\">Barcode 10 Spike 2</code></li>\n  <li><em>Salmonella enterica subsp. houtenae</em> in the sample named <code class=\"language-plaintext highlighter-rouge\">Barcode 11 Spike 2b</code></li>\n</ul>\n\n<p>DNA in the samples is extracted, analyzed with qPCR, and sequenced via Nanopore. We start the tutorial from raw data generated by Nanopore.</p>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n  <p>In this tutorial, we will deal with:</p>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#prepare-galaxy-and-data\" id=\"markdown-toc-prepare-galaxy-and-data\">Prepare Galaxy and data</a></li>\n  <li><a href=\"#preprocessing\" id=\"markdown-toc-preprocessing\">Preprocessing</a>    <ol>\n      <li><a href=\"#quality-control-and-preprocessing\" id=\"markdown-toc-quality-control-and-preprocessing\">Quality Control and Preprocessing</a></li>\n      <li><a href=\"#host-read-filtering\" id=\"markdown-toc-host-read-filtering\">Host read filtering</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#taxonomy-profiling\" id=\"markdown-toc-taxonomy-profiling\">Taxonomy Profiling</a></li>\n  <li><a href=\"#gene-based-pathogen-identification\" id=\"markdown-toc-gene-based-pathogen-identification\">Gene-based pathogen identification</a>    <ol>\n      <li><a href=\"#assembly\" id=\"markdown-toc-assembly\">Assembly</a></li>\n      <li><a href=\"#antimicrobial-resistance-genes\" id=\"markdown-toc-antimicrobial-resistance-genes\">Antimicrobial Resistance Genes</a></li>\n      <li><a href=\"#virulence-factor-identification\" id=\"markdown-toc-virulence-factor-identification\">Virulence Factor identification</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#allele-based-pathogen-identification\" id=\"markdown-toc-allele-based-pathogen-identification\">Allele-based pathogen identification</a>    <ol>\n      <li><a href=\"#variant-calling-or-snp-calling\" id=\"markdown-toc-variant-calling-or-snp-calling\">Variant Calling or SNP Calling</a></li>\n      <li><a href=\"#mapping-depth-and-coverage\" id=\"markdown-toc-mapping-depth-and-coverage\">Mapping Depth and Coverage</a></li>\n      <li><a href=\"#consensus-genome-building\" id=\"markdown-toc-consensus-genome-building\">Consensus Genome Building</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#pathogen-detection-samples-aggregation-and-visualisation\" id=\"markdown-toc-pathogen-detection-samples-aggregation-and-visualisation\">Pathogen Detection Samples Aggregation and Visualisation</a>    <ol>\n      <li><a href=\"#heatmap\" id=\"markdown-toc-heatmap\">Heatmap</a></li>\n      <li><a href=\"#phylogenetic-tree-building\" id=\"markdown-toc-phylogenetic-tree-building\">Phylogenetic Tree building</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#conclusion\" id=\"markdown-toc-conclusion\">Conclusion</a></li>\n</ol>\n\n</blockquote>\n\n<h1 id=\"prepare-galaxy-and-data\">Prepare Galaxy and data</h1>\n<p>Any analysis should get its own Galaxy history. So let’s start by creating a new one:</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Data upload</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Create a new history for this analysis</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-new-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-new-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a new history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>Click the <i class=\"fas fa-plus\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">new-history</span> icon at the top of the history panel:</p>   <p><img src=\"/training-material/shared/images/history_create_new.svg\" alt=\"UI for creating new history\" /></p>   <!-- the original drawing can be found here https://docs.google.com/drawings/d/1cCBrLAo4kDGic5QyB70rRiWJAKTenTU8STsKDaLcVU8/edit?usp=sharing --> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Rename the history</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-renaming-a-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-renaming-a-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Renaming a history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ol>   <li>Click on <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> (<strong>Edit</strong>) next to the history name (which by default is “Unnamed history”)</li>   <li>Type the new name</li>   <li>Click on <strong>Save</strong></li> </ol>   <p>If you do not have the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> (<strong>Edit</strong>) next to the history name:</p>   <ol>   <li>Click on <strong>Unnamed history</strong> (or the current name of the history) (<strong>Click to rename history</strong>) at the top of your history panel</li>   <li>Type the new name</li>   <li>Press <kbd>Enter</kbd></li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>Before we can begin any Galaxy analysis, we need to upload the input data: FASTQ files with the sequenced samples.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Import datasets</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Import the following samples via link from <a href=\"https://zenodo.org/record/11222469\">Zenodo</a> or Galaxy shared data libraries:</p>\n\n      <div class=\"language-text highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/11222469/files/Barcode10_Spike2.fastq.gz\nhttps://zenodo.org/record/11222469/files/Barcode11_Spike2b.fastq.gz\n</code></pre></div>      </div>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-via-links\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-via-links\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing via links</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-data-from-a-data-library\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-data-from-a-data-library\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing data from a data library</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>As an alternative to uploading the data from a URL or your computer, the files may also have been made available from a <em>shared data library</em>:</p>   <ol>   <li>Go into <strong>Shared data</strong> (top panel) then <strong>Data libraries</strong></li>   <li>Navigate to  the correct folder as indicated by your instructor.     <ul>       <li>On most Galaxies tutorial data will be provided in a folder named <strong>GTN - Material –&gt; Topic Name -&gt; Tutorial Name</strong>.</li>     </ul>   </li>   <li>Select the desired files</li>   <li>Click on <strong>Add to History</strong> <i class=\"fas fa-caret-down\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-dropdown</span> near the top and select <strong>as Datasets</strong> from the dropdown menu</li>   <li>     <p>In the pop-up window, choose</p>     <ul>       <li><em>“Select history”</em>: the history you want to import the data to (or create a new one)</li>     </ul>   </li>   <li>Click on <strong>Import</strong></li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Rename the files to <code class=\"language-plaintext highlighter-rouge\">Barcode10</code> and <code class=\"language-plaintext highlighter-rouge\">Barcode11</code> respectively</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-renaming-a-dataset\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-renaming-a-dataset\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Renaming a dataset</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, change the <strong>Name</strong> field</li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Create a collection named <code class=\"language-plaintext highlighter-rouge\">Samples</code> that includes both datasets (<code class=\"language-plaintext highlighter-rouge\">Barcode10</code> and <code class=\"language-plaintext highlighter-rouge\">Barcode11</code>)</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-dataset-collection\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-dataset-collection\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a dataset collection</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on <i class=\"far fa-check-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-selector</span> <strong>Select Items</strong> at the top of the history panel <img src=\"/training-material/topics/galaxy-interface/images/historyItemControls.png\" alt=\"Select Items button\" /></li>   <li>Check all the datasets in your history you would like to include</li>   <li>     <p>Click <strong>n of N selected</strong> and choose <strong>Build Dataset List</strong></p>     <p><img src=\"/training-material/topics/galaxy-interface/images/buildList.png\" alt=\"build list collection menu item\" width=\"15%\" /></p>   </li>   <li>Enter a name for your collection</li>   <li>Click <strong>Create collection</strong> to build your collection</li>   <li>Click on the checkmark icon at the top of your history again</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>In this tutorial, we can offer 2 versions:</p>\n<ul>\n  <li>A short version, running prebuilt workflows</li>\n  <li>A long version, going step-by-step</li>\n</ul>\n\n<blockquote class=\"notranslate hands_on gtn-cyoa\" id=\"gtn-cyoa\">\n\t<div class=\"box-title\" aria-label=\"hands-on box: choose your own tutorial\"><i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\"></span> Hands-on: Choose Your Own Tutorial</div>\n\t<p>This is a \"Choose Your Own Tutorial\" section, where you can select between multiple paths. Click one of the buttons below to select how you want to follow the tutorial</p>\n\t\n\t\n\t\t<input id=\"cyoa-opt1\" type=\"radio\" name=\"cyoa\" value=\"Short-Version\" onclick=\"cyoaChoice('Short-Version', 'gtn-cyoa')\" />\n\t\t<label for=\"cyoa-opt1\" class=\"select btn btn-secondary\">Short Version</label>\n\t\n\t\n\t\t<input id=\"cyoa-opt2\" type=\"radio\" name=\"cyoa\" value=\"Long-Version\" onclick=\"cyoaChoice('Long-Version', 'gtn-cyoa')\" />\n\t\t<label for=\"cyoa-opt2\" class=\"select btn btn-secondary\">Long Version</label>\n\t\n\t\n\t\n\n\t\n\t<script>\n\t\tfunction ready(fn) {\n\t\t\tif (document.readyState != 'loading'){\n\t\t\t\tfn();\n\t\t\t} else {\n\t\t\t\tdocument.addEventListener('DOMContentLoaded', fn);\n\t\t\t}\n\t\t}\n\t\tready(function() {\n\t\t\tcyoaDefault(\"Short-Version\", \"gtn-cyoa\");\n\t\t})\n\t</script>\n\t\n</blockquote>\n\n<h1 id=\"preprocessing\">Preprocessing</h1>\n\n<p>Before starting any analysis, it is always a good idea to assess the quality of your input data and to discard poor quality base content by trimming and filtering reads.</p>\n\n<div class=\"Short-Version\">\n\n  <p>In this section we will run a Galaxy workflow that performs the following tasks with the following tools:</p>\n  <ol>\n    <li>Assess the reads quality before and after preprocessing it using <a href=\"https://www.bioinformatics.babraham.ac.uk/projects/fastqc/\"><strong>FastQC</strong></a>, <a href=\"https://github.com/wdecoster/NanoPlot\"><strong>NanoPlot</strong></a> and  <a href=\"https://multiqc.info/\"><strong>MultiQC</strong></a> (<span class=\"citation\"><a href=\"#Ewels2016\">Ewels <i>et al.</i> 2016</a></span>)</li>\n    <li>Trimming and filtering reads by length and quality using <a href=\"https://github.com/rrwick/Porechop\"><strong>Porechop</strong></a> and <strong>Fastp</strong> (<span class=\"citation\"><a href=\"#Chen2018\">Chen <i>et al.</i> 2018</a></span>)</li>\n    <li>Remove main host sequences, in this training all <strong>chicken</strong> (Gallus gallus) sequences, using <a href=\"https://github.com/lh3/minimap2\"><strong>Minimap2</strong></a></li>\n    <li>Remove other possible hosts sequences e.g. human, cow, etc. using <a href=\"https://ccb.jhu.edu/software/kraken2/\"><strong>Kraken2</strong></a> (<span class=\"citation\"><a href=\"#Wood2014\">Wood and Salzberg 2014</a></span>) with the <a href=\"https://github.com/lskatz/Kalamari\"><strong>Kalamari</strong></a> database, and <a href=\"https://github.com/jenniferlu717/KrakenTools/blob/master/extract_kraken_reads.py\"><strong>Krakentools: Extract Kraken Reads By ID</strong></a> to remove all the hosts sequences before moving on to the next section with only the non-host sequences.</li>\n  </ol>\n\n  <p>We will run all these steps using a single workflow, then discuss each step and the results in more detail.</p>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title>Pre-Processing</hands-on-title>\n\n    <ol>\n      <li><strong>Import the workflow</strong> into Galaxy\n        <ul>\n          <li>Copy the URL (e.g. via right-click) of <a href=\"/training-material/topics/microbiome/tutorials/pathogen-detection-from-nanopore-foodborne-data/workflows/nanopore_preprocessing.ga\">this workflow</a> or download it to your computer.</li>\n          <li>Import the workflow into Galaxy</li>\n        </ul>\n\n        <!--SNIPPET-->\n        <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-a-workflow\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-a-workflow\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing a workflow</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on <em>Workflow</em> on the top menu bar of Galaxy. You will see a list of all your workflows.</li>   <li>Click on <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Import</strong> at the top-right of the screen</li>   <li>Provide your workflow     <ul>       <li>Option 1: Paste the URL of the workflow into the box labelled <em>“Archived Workflow URL”</em></li>       <li>Option 2: Upload the workflow file in the box labelled <em>“Archived Workflow File”</em></li>     </ul>   </li>   <li>Click the <strong>Import workflow</strong> button</li> </ul>   <p>Below is a short video demonstrating how to import a workflow from GitHub using this procedure:</p>   <figure> <iframe credentialless=\"\" allowfullscreen=\"\" referrerpolicy=\"no-referrer\" sandbox=\"allow-scripts allow-same-origin\" allow=\"accelerometer 'none'; ambient-light-sensor 'none'; autoplay 'none'; battery 'none'; bluetooth 'none'; browsing-topics 'none'; camera 'none'; ch-ua 'none'; display-capture 'none'; domain-agent 'none'; document-domain 'none'; encrypted-media 'none'; execution-while-not-rendered 'none'; execution-while-out-of-viewport 'none'; gamepad 'none'; geolocation 'none'; gyroscope 'none'; hid 'none'; identity-credentials-get 'none'; idle-detection 'none'; keyboard-map 'none'; local-fonts 'none'; magnetometer 'none'; microphone 'none'; midi 'none'; navigation-override 'none'; otp-credentials 'none'; payment 'none'; picture-in-picture 'none'; publickey-credentials-create 'none'; publickey-credentials-get 'none'; screen-wake-lock 'none'; serial 'none'; speaker-selection 'none'; sync-xhr 'none'; usb 'none'; web-share 'none'; window-management 'none'; xr-spatial-tracking 'none'\" csp=\"sandbox allow-scripts allow-same-origin;\" width=\"560\" height=\"315\" src=\"https://www.youtube-nocookie.com/embed/hoP36Te5wko\" title=\"Importing a workflow from URL\" frameborder=\"0\" loading=\"lazy\"></iframe> <figcaption>   <span class=\"figcaption-prefix\"><strong>Video</strong>:</span> Importing a workflow from URL</figcaption> </figure> </blockquote>\n        <p><!--END_SNIPPET--></p>\n      </li>\n      <li>Run <strong>Workflow 1: Nanopore Preprocessing</strong> <i class=\"fas fa-share-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">workflow</span> using the following parameters\n        <ul>\n          <li>\n            <p><em>“Samples Profile”</em>: <code class=\"language-plaintext highlighter-rouge\">PacBio/Oxford Nanopore read to reference mapping</code>, which is the technique used for sequencing the samples.</p>\n          </li>\n          <li>\n            <p><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“Collection of all samples”</em>: <code class=\"language-plaintext highlighter-rouge\">Samples</code> collection created from the imported Fastq.qz files</p>\n          </li>\n        </ul>\n\n        <!--SNIPPET-->\n        <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-running-a-workflow\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-running-a-workflow\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Running a workflow</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on <em>Workflow</em> on the top menu bar of Galaxy. You will see a list of all your workflows.</li>   <li>Click on the <i class=\"fas fa-play\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">workflow-run</span> (<em>Run workflow</em>) button next to your workflow</li>   <li>Configure the workflow as needed</li>   <li>Click the <strong>Run Workflow</strong> button at the top-right of the screen</li>   <li>You may have to refresh your history to see the queued jobs</li> </ul> </blockquote>\n        <p><!--END_SNIPPET--></p>\n      </li>\n    </ol>\n\n  </blockquote>\n\n  <p>The workflow will take a little while to complete. Once tools have completed, the results will be available in your history for viewing. Note that only the most important outputs will be visible; intermediate files are hidden by default.</p>\n\n  <p>While you are waiting for the workflow to complete, please continue reading in the next section(s) where we will go into a bit more detail about what happens at each step of the workflow we launched and examine the results.</p>\n</div>\n\n<h2 id=\"quality-control-and-preprocessing\">Quality Control and Preprocessing</h2>\n\n<p>During sequencing, errors are introduced, such as incorrect nucleotides being called. These are due to the technical limitations of each sequencing platform. Sequencing errors might bias the analysis and can lead to a misinterpretation of the data. <strong>Sequence quality control is therefore an essential first step in your analysis.</strong></p>\n\n<p>In this tutorial we use similar tools as described in the tutorial <a href=\"/training-material/topics/sequence-analysis/tutorials/quality-control/tutorial.html\">“Quality control”</a>, but more specific to Nanopore data:</p>\n\n<ul>\n  <li>Quality control with\n    <ul>\n      <li><a href=\"https://www.bioinformatics.babraham.ac.uk/projects/fastqc/\"><strong>FastQC</strong></a> generates a web report that will aid you in assessing the quality of your data</li>\n      <li><a href=\"https://github.com/wdecoster/NanoPlot\"><strong>NanoPlot</strong></a> plotting tool for long read sequencing data and alignments</li>\n    </ul>\n\n    <div class=\"Long-Version\">\n\n      <blockquote class=\"hands_on\">\n        <hands-on-title> Initial quality assessment </hands-on-title>\n        <ol>\n          <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/devteam/fastqc/fastqc/0.73+galaxy0\" title=\"FastQC tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>FastQC</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.73+galaxy0)</span> with the following parameters:\n            <ul>\n              <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“Raw read data from your current history”</em>: <code class=\"language-plaintext highlighter-rouge\">Samples</code> collection created from the imported Fastq.qz files</li>\n            </ul>\n          </li>\n          <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/nanoplot/nanoplot/1.28.2+galaxy1\" title=\"NanoPlot tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>NanoPlot</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.28.2+galaxy1)</span> with the following parameters:\n            <ul>\n              <li><em>“Select multifile mode”</em>: <code class=\"language-plaintext highlighter-rouge\">batch</code>\n                <ul>\n                  <li><em>“Type of the file(s) to work on”</em>: <code class=\"language-plaintext highlighter-rouge\">fastq</code>\n                    <ul>\n                      <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“Data input files”</em>: <code class=\"language-plaintext highlighter-rouge\">Samples</code> collection created from the imported Fastq.qz files</li>\n                    </ul>\n                  </li>\n                </ul>\n              </li>\n            </ul>\n\n            <blockquote class=\"comment\">\n              <comment-title></comment-title>\n              <p>The <code class=\"language-plaintext highlighter-rouge\">NanoPlot</code> step, as it does not require the results of FastQC to run, can be launched even if FastQC is not ready</p>\n            </blockquote>\n          </li>\n          <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/multiqc/multiqc/1.11+galaxy0\" title=\"MultiQC tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>MultiQC</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.11+galaxy0)</span> with the following parameters:\n            <ul>\n              <li>In <em>“Results”</em>:\n                <ul>\n                  <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Results”</em>\n                    <ul>\n                      <li><em>“Which tool was used generate logs?”</em>: <code class=\"language-plaintext highlighter-rouge\">FastQC</code>\n                        <ul>\n                          <li>In <em>“FastQC output”</em>:\n                            <ul>\n                              <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert FastQC output”</em>\n                                <ul>\n                                  <li><em>“Type of FastQC output?”</em>: <code class=\"language-plaintext highlighter-rouge\">Raw data</code></li>\n                                  <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“FastQC output”</em>: collection of <code class=\"language-plaintext highlighter-rouge\">Raw data</code> outputs of <strong>FastQC</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n                                </ul>\n                              </li>\n                            </ul>\n                          </li>\n                        </ul>\n                      </li>\n                    </ul>\n                  </li>\n                </ul>\n              </li>\n            </ul>\n          </li>\n        </ol>\n      </blockquote>\n\n    </div>\n  </li>\n  <li>\n    <p>Read trimming and filtering with <a href=\"https://github.com/rrwick/Porechop\"><strong>Porechop</strong></a> and <strong>Fastp</strong> (<span class=\"citation\"><a href=\"#Chen2018\">Chen <i>et al.</i> 2018</a></span>)</p>\n\n    <div class=\"Long-Version\">\n\n      <blockquote class=\"hands_on\">\n        <hands-on-title> Read trimming and filtering </hands-on-title>\n\n        <ol>\n          <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/porechop/porechop/0.2.4\" title=\"Porechop tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Porechop</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.2.4)</span> with the following parameters:\n            <ul>\n              <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“Input FASTA/FASTQ”</em>: <code class=\"language-plaintext highlighter-rouge\">Samples</code> collection created from the imported Fastq.qz files</li>\n              <li><em>“Output format for the reads”</em>: <code class=\"language-plaintext highlighter-rouge\">fastq.gz</code></li>\n            </ul>\n          </li>\n          <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/fastp/fastp/0.20.1+galaxy0\" title=\"fastp tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>fastp</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.20.1+galaxy0)</span> with the following parameters:\n            <ul>\n              <li><em>“Single-end or paired reads”</em>: <code class=\"language-plaintext highlighter-rouge\">Single-end</code>\n                <ul>\n                  <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“Input 1”</em>: output collection of <strong>Porechop</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n                </ul>\n              </li>\n              <li>In <em>Output Options</em>\n                <ul>\n                  <li><em>“Output JSON report”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n                </ul>\n              </li>\n            </ul>\n\n            <blockquote class=\"comment\">\n              <comment-title></comment-title>\n              <p>This step can be launched even if <strong>Porechop</strong> is not done. It will be scheduled and wait until <strong>Porechop</strong> is done to start.</p>\n            </blockquote>\n          </li>\n        </ol>\n      </blockquote>\n\n    </div>\n  </li>\n  <li>\n    <p>Quality recheck after read trimming and filtering with <strong>FastQC</strong> and <strong>Nanoplot</strong> and report aggregation with <a href=\"https://multiqc.info/\"><strong>MultiQC</strong></a></p>\n\n    <div class=\"Long-Version\">\n\n      <blockquote class=\"hands_on\">\n        <hands-on-title> Final quality checks </hands-on-title>\n        <ol>\n          <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/devteam/fastqc/fastqc/0.73+galaxy0\" title=\"FastQC tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>FastQC</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.73+galaxy0)</span> with the following parameters:\n            <ul>\n              <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“Raw read data from your current history”</em>: output collection of <strong>fastp</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n            </ul>\n          </li>\n          <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/nanoplot/nanoplot/1.28.2+galaxy1\" title=\"NanoPlot tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>NanoPlot</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.28.2+galaxy1)</span> with the following parameters:\n            <ul>\n              <li><em>“Select multifile mode”</em>: <code class=\"language-plaintext highlighter-rouge\">batch</code>\n                <ul>\n                  <li><em>“Type of the file(s) to work on”</em>: <code class=\"language-plaintext highlighter-rouge\">fastq</code>\n                    <ul>\n                      <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“files”</em>: output collection of <strong>fastp</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n                    </ul>\n                  </li>\n                </ul>\n              </li>\n            </ul>\n          </li>\n          <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/multiqc/multiqc/1.11+galaxy0\" title=\"MultiQC tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>MultiQC</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.11+galaxy0)</span> with the following parameters:\n            <ul>\n              <li>In <em>“Results”</em>:\n                <ul>\n                  <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Results”</em>\n                    <ul>\n                      <li><em>“Which tool was used generate logs?”</em>: <code class=\"language-plaintext highlighter-rouge\">FastQC</code>\n                        <ul>\n                          <li>In <em>“FastQC output”</em>:\n                            <ul>\n                              <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert FastQC output”</em>\n                                <ul>\n                                  <li><em>“Type of FastQC output?”</em>: <code class=\"language-plaintext highlighter-rouge\">Raw data</code></li>\n                                  <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“FastQC output”</em>: collection of <code class=\"language-plaintext highlighter-rouge\">Raw data</code> output of <strong>FastQC</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> done after <strong>fastp</strong></li>\n                                </ul>\n                              </li>\n                            </ul>\n                          </li>\n                        </ul>\n                      </li>\n                    </ul>\n                  </li>\n                  <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Results”</em>\n                    <ul>\n                      <li><em>“Which tool was used generate logs?”</em>: <code class=\"language-plaintext highlighter-rouge\">fastp</code>\n                        <ul>\n                          <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“Output of fastp”</em>: <code class=\"language-plaintext highlighter-rouge\">JSON report</code> output of <strong>fastp</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n                        </ul>\n                      </li>\n                    </ul>\n                  </li>\n                </ul>\n              </li>\n            </ul>\n          </li>\n        </ol>\n      </blockquote>\n\n    </div>\n  </li>\n</ul>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>Inspect the HTML two outputs of <strong>MultiQC</strong> for <code class=\"language-plaintext highlighter-rouge\">Barcode10</code> before and after preprocessing tagged <code class=\"language-plaintext highlighter-rouge\">MultiQC_Before_Preprocessing</code> and <code class=\"language-plaintext highlighter-rouge\">MultiQC_After_Preprocessing</code></p>\n\n  <ol>\n    <li>How many sequences does <code class=\"language-plaintext highlighter-rouge\">Barcode10</code> contain before and after trimming?</li>\n    <li>What is the quality score over the reads before and after trimming? And the mean score?</li>\n    <li>What is the importance of <strong>FastQC</strong>?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>Before trimming the file has 114,986 sequences and After trimming the file has 91,434 sequences</li>\n      <li>The “Per base sequence quality” is globally medium: the quality score stays above 20 over the entire length of reads after trimming, while quality below 20 could be seen before trimming specially at the beginning and the end of the reads.</li>\n    </ol>\n\n    <p>Sequence quality of Barcode 10 and Barcode 11 before preprocessing:</p>\n\n    <p><a href=\"./images/multiqc_per_base_sequence_quality_plot_barcode10_barcode11_before_trimming.png\" rel=\"noopener noreferrer\"><img src=\"./images/multiqc_per_base_sequence_quality_plot_barcode10_barcode11_before_trimming.png\" alt=\"Sequence Quality of Barcode 10 and Barcode 11 Before Trimming. \" width=\"1200\" height=\"800\" loading=\"lazy\" /></a></p>\n\n    <p>Sequence quality of Barcode 10 and Barcode 11 after preprocessing:</p>\n\n    <p><a href=\"./images/multiqc_per_base_sequence_quality_plot_barcode10_barcode11_after_trimming.png\" rel=\"noopener noreferrer\"><img src=\"./images/multiqc_per_base_sequence_quality_plot_barcode10_barcode11_after_trimming.png\" alt=\"Sequence Quality of Barcode 10 and Barcode 11 After Trimming. \" width=\"1200\" height=\"800\" loading=\"lazy\" /></a></p>\n\n    <ol>\n      <li>After checking what is wrong, e.g. before trimming, we should think about the errors reported by <strong>FastQC</strong>: they may come from the type of sequencing or what we sequenced (check the <a href=\"/training-material/topics/sequence-analysis/tutorials/quality-control/tutorial.html\">“Quality control” training</a>: <a href=\"https://www.bioinformatics.babraham.ac.uk/projects/fastqc/\">FastQC</a> for more details). However, despite these challenges, we can already see sequences getting slightly better after the trimming and filtering, so now we can proceed with our analyses.</li>\n    </ol>\n  </blockquote>\n</blockquote>\n\n<blockquote class=\"comment\">\n  <comment-title></comment-title>\n  <p>For more information about how to interpret the plots generated by <strong>FastQC</strong> and <strong>MultiQC</strong>, please see our dedicated <a href=\"/training-material/topics/sequence-analysis/tutorials/quality-control/tutorial.html\">“Quality control”</a> Tutorial.</p>\n</blockquote>\n\n<h2 id=\"host-read-filtering\">Host read filtering</h2>\n\n<p>Generally, we are not interested in the food (host) sequences, rather only those originating from the pathogen itself. It is an important to get rid of all host sequences and to only retain sequences that might include a pathogen, both in order to speed up further steps and to avoid host sequences compromising the analysis.</p>\n\n<p>In this tutorial, we know the samples come from <strong>chicken</strong> meat spiked with <strong><em>Salmonella</em></strong> so we already know what will we get as the host and the main pathogen. If the host is not known, <strong>Kraken2</strong> with <strong>Kalamari</strong> database can be used to detect it.</p>\n\n<p>In this tutorial we use:</p>\n<ol>\n  <li>\n    <p>Map reads to <strong>chicken</strong> reference genome using <strong>Map with minimap2</strong> and <strong>Chicken (Gallus gallus): galGal6</strong> built in reference genome of <strong>chicken</strong>, and we move forward with the unmapped ones.</p>\n\n    <div class=\"Long-Version\">\n\n      <blockquote class=\"hands_on\">\n        <hands-on-title>Read taxonomic classification for host filtering </hands-on-title>\n\n        <ol>\n          <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/minimap2/minimap2/2.24+galaxy0\" title=\"Map with minimap2 tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Map with minimap2</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.24+galaxy0)</span> with the following parameters:\n            <ul>\n              <li><em>“Will you select a reference genome from your history or use a built-in index?”</em>: <code class=\"language-plaintext highlighter-rouge\">Use a built-in genome index</code>\n                <ul>\n                  <li><em>“Using reference genome”</em>: <code class=\"language-plaintext highlighter-rouge\">Chicken (Gallus gallus): galGal6</code></li>\n                </ul>\n              </li>\n              <li><em>“Single or Paired-end reads”</em>: <code class=\"language-plaintext highlighter-rouge\">Single</code>\n                <ul>\n                  <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Select fastq dataset”</em>: <code class=\"language-plaintext highlighter-rouge\">out1</code> (output of <strong>fastp</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n                  <li><em>“Select a profile of preset options”</em>: <code class=\"language-plaintext highlighter-rouge\">PacBio/Oxford Nanopore read to reference mapping (-Hk19) (map-pb)</code>, which is the technique used for sequencing the samples.</li>\n                </ul>\n              </li>\n              <li>In <em>“Alignment options”</em>:\n                <ul>\n                  <li><em>“Customize spliced alignment mode?”</em>: <code class=\"language-plaintext highlighter-rouge\">No, use profile setting or leave turned off</code></li>\n                </ul>\n              </li>\n            </ul>\n          </li>\n          <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/bamtools_split_mapped/bamtools_split_mapped/2.5.2+galaxy2\" title=\"Split BAM by reads mapping status tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Split BAM by reads mapping status</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.5.2+galaxy2)</span> with the following parameters:\n            <ul>\n              <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“BAM dataset to split by mapped/unmapped”</em>: <code class=\"language-plaintext highlighter-rouge\">alignment_output</code> (output of <strong>Map with minimap2</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n            </ul>\n          </li>\n          <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/samtools_fastx/samtools_fastx/1.15.1+galaxy2\" title=\"Samtools fastx tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Samtools fastx</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.15.1+galaxy2)</span> with the following parameters:\n            <ul>\n              <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“BAM or SAM file to convert”</em>: <code class=\"language-plaintext highlighter-rouge\">unmapped</code> (output of <strong>Split BAM by reads mapping status</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n              <li><em>“Output format”</em>: <code class=\"language-plaintext highlighter-rouge\">compressed FASTQ</code></li>\n              <li><em>“Write index read files”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n            </ul>\n          </li>\n        </ol>\n\n      </blockquote>\n\n    </div>\n  </li>\n  <li>\n    <p>Assign filted reads, after mapping (non <strong>chicken</strong> reads), to taxa using <strong>Kraken2</strong> (<span class=\"citation\"><a href=\"#Wood2014\">Wood and Salzberg 2014</a></span>) as a further contamination detection using the <strong>Kalamari</strong> database. The <strong>Kalamari</strong> database includes mitochondrial sequences of various known hosts including food hosts.</p>\n\n    <div class=\"Long-Version\">\n\n      <blockquote class=\"hands_on\">\n        <hands-on-title>Read taxonomic classification for host filtering </hands-on-title>\n\n        <ol>\n          <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/kraken2/kraken2/2.1.1+galaxy1\" title=\"Kraken2 tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Kraken2</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.1.1+galaxy1)</span> with the following parameters:\n            <ul>\n              <li><em>“Single or paired reads”</em>: <code class=\"language-plaintext highlighter-rouge\">Single</code>\n                <ul>\n                  <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input sequences”</em>: <code class=\"language-plaintext highlighter-rouge\">output</code> (output of <strong>Samtools fastx</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n                </ul>\n              </li>\n              <li><em>“Print scientific names instead of just taxids”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n              <li>In <em>“Create Report”</em>:\n                <ul>\n                  <li><em>“Print a report with aggregrate counts/clade to file”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n                  <li><em>“Report counts for ALL taxa, even if counts are zero”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n                  <li><em>“Report minimizer data”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n                </ul>\n              </li>\n              <li><em>“Select a Kraken2 database”</em>: <code class=\"language-plaintext highlighter-rouge\">kalamari</code></li>\n            </ul>\n          </li>\n        </ol>\n\n      </blockquote>\n\n    </div>\n\n    <blockquote class=\"question\">\n      <question-title></question-title>\n\n      <p>For the tutorial long version takers, run <strong>Samtools fastx</strong> on the <code class=\"language-plaintext highlighter-rouge\">mapped</code> (output of <strong>Split BAM by reads mapping status</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>), then inspect the output for <code class=\"language-plaintext highlighter-rouge\">Barcode10</code>. If you are a short version taker then inspect the output named <code class=\"language-plaintext highlighter-rouge\">host_sequences_fastq</code>.</p>\n\n      <ol>\n        <li>How many <strong>chicken</strong> sequences were found?</li>\n      </ol>\n\n      <blockquote class=\"solution\">\n        <solution-title></solution-title>\n\n        <ol>\n          <li>53722</li>\n        </ol>\n\n      </blockquote>\n    </blockquote>\n  </li>\n  <li>\n    <p>Filter host assigned reads based on <strong>Kraken2</strong> assignments</p>\n    <ol>\n      <li>Manipulate <strong>Kraken2</strong> classification to extract the sequence ids of all hosts sequences identified with <strong>Kraken2</strong></li>\n      <li>Filter the FASTQ files to get 1 ouput with the host-assigned sequences and 1 output without the host-assigned reads</li>\n    </ol>\n\n    <div class=\"Long-Version\">\n\n      <blockquote class=\"hands_on\">\n        <hands-on-title> Host read filtering </hands-on-title>\n\n        <ol>\n          <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/krakentools_extract_kraken_reads/krakentools_extract_kraken_reads/1.2+galaxy1\" title=\"Krakentools: Extract Kraken Reads By ID tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Krakentools: Extract Kraken Reads By ID</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.2+galaxy1)</span> with the following parameters:\n            <ul>\n              <li><em>“Single or paired reads?”</em>: <code class=\"language-plaintext highlighter-rouge\">Single</code>\n                <ul>\n                  <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“FASTQ/A file”</em>: <code class=\"language-plaintext highlighter-rouge\">out1</code> (output of <strong>fastp</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n                </ul>\n              </li>\n              <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“Results”</em>: <code class=\"language-plaintext highlighter-rouge\">Kraken2 with Kalamri database Results</code> outputs of <strong>Kraken2</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n              <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“Report”</em>: <code class=\"language-plaintext highlighter-rouge\">Kraken2 with Kalamri database Report</code> outputs of <strong>Kraken2</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n              <li>\n                <p><em>“Taxonomix ID(s) to match”</em>:<code class=\"language-plaintext highlighter-rouge\">9031 9606 9913</code></p>\n\n                <p>We specify here the taxonomic ID of the hosts so we can filter reads assigned to these hosts. Kraken2 uses taxonomic IDs from NCBI, the IDs for a specific taxa can be found at <a href=\"https://www.ncbi.nlm.nih.gov/taxonomy\">ncbi</a>. To be generic, we remove here:</p>\n                <ul>\n                  <li>Human (<code class=\"language-plaintext highlighter-rouge\">9606</code>)</li>\n                  <li>Chicken (<code class=\"language-plaintext highlighter-rouge\">9031</code>)</li>\n                  <li>Beef (<code class=\"language-plaintext highlighter-rouge\">9913</code>)</li>\n                </ul>\n\n                <p>If the contaminated food comes from and may include other animals, you can change the value here.</p>\n              </li>\n              <li><em>“Invert output”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n              <li><em>“Output as FASTQ”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n              <li><em>“Include parents”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n              <li><em>“Include children”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n            </ul>\n          </li>\n        </ol>\n      </blockquote>\n\n    </div>\n  </li>\n</ol>\n\n<blockquote class=\"comment\">\n  <comment-title></comment-title>\n\n  <p>We will need the outputs from this section in the next one.  If yours is still running or you get an error you can go on and upload it so you can start the next workflow, the next hands-on is optional.</p>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title>Optional Data upload</hands-on-title>\n\n    <ol>\n      <li>\n        <p>Import the quality processed samples fastqsanger files via link from <a href=\"https://zenodo.org/record/11222469\">Zenodo</a> or the Shared Data library:</p>\n\n        <div class=\"language-text highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/11222469/files/preprocessed_sample_barcode10_spike2.fastq.gz\nhttps://zenodo.org/record/11222469/files/preprocessed_sample_barcode11_spike2b.fastq.gz\n</code></pre></div>        </div>\n      </li>\n      <li>\n        <p>Rename datasets to <code class=\"language-plaintext highlighter-rouge\">Barcode10</code> and <code class=\"language-plaintext highlighter-rouge\">Barcode11</code> respectively</p>\n      </li>\n      <li>\n        <p>Create a collection named <code class=\"language-plaintext highlighter-rouge\">collection of preprocessed samples</code> from the two imported datasets</p>\n      </li>\n    </ol>\n\n  </blockquote>\n</blockquote>\n\n<h1 id=\"taxonomy-profiling\">Taxonomy Profiling</h1>\n\n<p>In this section we would like to identify the different organisms found in our samples by assigning taxonomy levels to the reads starting from the kingdom level down to the species level and visualize the result. It’s important to check what might be the species of a possible pathogen to be found, it gets us closer to the investigation as well as discovering possible multiple food infections if any existed.</p>\n\n<!--SNIPPET-->\n<blockquote class=\"details\">   <div class=\"box-title details-title\" id=\"details-what-is-taxonomy\"><button class=\"gtn-boxify-button details\" type=\"button\" aria-controls=\"details-what-is-taxonomy\" aria-expanded=\"true\"><i class=\"fas fa-info-circle\" aria-hidden=\"true\"></i> <span>Details: What is Taxonomy?</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>Taxonomy is the method used to naming, defining (circumscribing) and classifying groups of biological organisms based on shared characteristics such as morphological characteristics, phylogenetic characteristics, DNA data, etc. It is founded on the concept that the similarities descend from a common evolutionary ancestor.</p>   <p>Defined groups of organisms are known as <strong>taxa</strong>. Taxa are given a taxonomic rank and are aggregated into super groups of higher rank to create a taxonomic hierarchy. The taxonomic hierarchy includes eight levels: <strong>Domain, Kingdom, Phylum, Class, Order, Family, Genus and Species.</strong></p>   <p><img src=\"/training-material/topics/microbiome/faqs/images/taxonomy.png\" alt=\"Example of taxonomy. It starts, top to bottom, with Kingdom &quot;Animalia&quot;, Phylum &quot;Chordata&quot;, Class &quot;Mammalia&quot;, and Order &quot;Carnivora&quot;. Then it splits in 3. On the left, Family &quot;Felidae&quot;, with 2 genus &quot;Felis&quot; and &quot;Panthera&quot; and below 3 species &quot;F. catus&quot; and &quot;F. pardalis&quot; below &quot;Felis&quot;, &quot;P. pardus&quot; below &quot;Panthera&quot;. In the middle, Family &quot;Canidae&quot;, genus &quot;Canis&quot; and 2 species &quot;C. familiaris&quot; and &quot;C. lupus&quot;. On the right, Family &quot;Ursidae&quot;, Genus &quot;Ursus&quot; and 2 species &quot;U. arctos&quot; and &quot;U. horribilus&quot;. Below each species is a illustration of the species\" /></p>   <p>The classification system begins with <strong>3 domains</strong> that encompass all living and extinct forms of life</p>   <ul>   <li>The <strong>Bacteria</strong> and <strong>Archae</strong> are mostly microscopic, but quite widespread.</li>   <li>Domain <strong>Eukarya</strong> contains more complex organisms</li> </ul>   <p>When new species are found, they are assigned into taxa in the taxonomic hierarchy. For example for the cat:</p>   <table>   <thead>     <tr>       <th>Level</th>       <th>Classification</th>     </tr>   </thead>   <tbody>     <tr>       <td>Domain</td>       <td>Eukaryota</td>     </tr>     <tr>       <td>Kingdom</td>       <td>Animalia</td>     </tr>     <tr>       <td>Phylum</td>       <td>Chordata</td>     </tr>     <tr>       <td>Class</td>       <td>Mammalia</td>     </tr>     <tr>       <td>Order</td>       <td>Carnivora</td>     </tr>     <tr>       <td>Family</td>       <td>Felidae</td>     </tr>     <tr>       <td>Genus</td>       <td><em>Felis</em></td>     </tr>     <tr>       <td>Species</td>       <td><em>F. catus</em></td>     </tr>   </tbody> </table>   <p>From this classification, one can generate a tree of life, also known as a phylogenetic tree. It is a rooted tree that describes the relationship of all life on earth. At the root sits the “last universal common ancestor” and the three main branches (in taxonomy also called domains) are bacteria, archaea and eukaryotes. Most important for this is the idea that all life on earth is derived from a common ancestor and therefore when comparing two species, you will -sooner or later- find a common ancestor for all of them.</p>   <p>Let’s explore taxonomy in the Tree of Life, using <a href=\"https://lifemap.univ-lyon1.fr/\">Lifemap</a></p>   <iframe id=\"Lifemap\" src=\"https://lifemap.univ-lyon1.fr/explore.html\" frameborder=\"0\" width=\"100%\" height=\"600px\"></iframe> </blockquote>\n<p><!--END_SNIPPET--></p>\n\n<p>In the previous section we ran <strong>Kraken2</strong> along with the <strong>Kalamari</strong> database, which is also a kind of taxonomy profiling but the database used is designed to include all possible host sequences. In the following part, we run <strong>Kraken2</strong> again; but this time with one of its built-in databases, <strong>Standard PlusPF</strong>, which can give us more insight into pathogen candidate species than <strong>Kalamari</strong>. You can test this yourself by comparing reports of both <strong>Kraken2</strong> runs.</p>\n\n<!--SNIPPET-->\n<blockquote class=\"details\">   <div class=\"box-title details-title\" id=\"details-kraken2-and-the-k-mer-approach-for-taxonomy-classification\"><button class=\"gtn-boxify-button details\" type=\"button\" aria-controls=\"details-kraken2-and-the-k-mer-approach-for-taxonomy-classification\" aria-expanded=\"true\"><i class=\"fas fa-info-circle\" aria-hidden=\"true\"></i> <span>Details: Kraken2 and the k-mer approach for taxonomy classification</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>In the \\(k\\)-mer approach for taxonomy classification, we use a database containing DNA sequences of genomes whose taxonomy we already know. On a computer, the genome sequences are broken into short pieces of length \\(k\\) (called \\(k\\)-mers), usually 30bp.</p>   <p><strong>Kraken</strong> examines the \\(k\\)-mers within the query sequence, searches for them in the database, looks for where these are placed within the taxonomy tree inside the database, makes the classification with the most probable position, then maps \\(k\\)-mers to the lowest common ancestor (LCA) of all genomes known to contain the given \\(k\\)-mer.</p>   <p><img src=\"/training-material/topics/microbiome/faqs/images/kmers-kraken.jpg\" alt=\"Kraken2\" title=\"Kraken sequence classification algorithm. To classify a sequence, each k-mer in the sequence is mapped to the lowest common ancestor (LCA, i.e. the lowest node) of the genomes that contain that k-mer in the database. The taxa associated with the sequence's k-mers, as well as the taxa's ancestors, form a pruned subtree of the general taxonomy tree, which is used for classification. In the classification tree, each node has a weight equal to the number of k-mers in the sequence associated with the node's taxon. Each root-to-leaf (RTL) path in the classification tree is scored by adding all weights in the path, and the maximal RTL path in the classification tree is the classification path (nodes highlighted in yellow). The leaf of this classification path (the orange, leftmost leaf in the classification tree) is the classification used for the query sequence. Source: &lt;span class=&quot;citation&quot;&gt;&lt;a href=&quot;#Wood2014&quot;&gt;Wood and Salzberg 2014&lt;/a&gt;&lt;/span&gt;\" /></p>   <p><strong>Kraken2</strong> uses a compact hash table, a probabilistic data structure that allows for faster queries and lower memory requirements. It applies a spaced seed mask of <em>s</em> spaces to the minimizer and calculates a compact hash code, which is then used as a search query in its compact hash table; the lowest common ancestor (LCA) taxon associated with the compact hash code is then assigned to the k-mer.</p>   <p>You can find more information about the <strong>Kraken2</strong> algorithm in the paper <a href=\"https://genomebiology.biomedcentral.com/articles/10.1186/s13059-019-1891-0\"><em>Improved metagenomic analysis with Kraken 2</em></a>.</p> </blockquote>\n<p><!--END_SNIPPET--></p>\n\n<div class=\"Short-Version\">\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title>Taxonomy Profiling and visualisation</hands-on-title>\n\n    <ol>\n      <li><strong>Import the workflow</strong> into Galaxy\n        <ul>\n          <li>Copy the URL (e.g. via right-click) of <a href=\"/training-material/topics/microbiome/tutorials/pathogen-detection-from-nanopore-foodborne-data/workflows/taxonomy_profiling_and_visualisation_with_krona.ga\">this workflow</a> or download it to your computer.</li>\n          <li>Import the workflow into Galaxy</li>\n        </ul>\n      </li>\n      <li>Run <strong>Workflow 2: Taxonomy Profiling and Visualization with Krona</strong> <i class=\"fas fa-share-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">workflow</span> using the following parameters:\n        <ul>\n          <li><em>“Send results to a new history”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n          <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“Collection of preprocessed samples”</em>: <code class=\"language-plaintext highlighter-rouge\">collection of preprocessed samples</code> collection, output from <strong>Krakentools: Extract Kraken Reads By ID</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> from the preproceesing workflow</li>\n          <li><em>“Kraken database”</em>: <code class=\"language-plaintext highlighter-rouge\">Prebuilt Refseq indexes:  PlusPF (Standard plus protozoa and fungi) (Version:  2022-06-07 - Downloaded: 2022-09-04T165121Z)</code></li>\n        </ul>\n\n        <!--SNIPPET-->\n        <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-running-a-workflow-1\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-running-a-workflow-1\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Running a workflow</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on <em>Workflow</em> on the top menu bar of Galaxy. You will see a list of all your workflows.</li>   <li>Click on the <i class=\"fas fa-play\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">workflow-run</span> (<em>Run workflow</em>) button next to your workflow</li>   <li>Configure the workflow as needed</li>   <li>Click the <strong>Run Workflow</strong> button at the top-right of the screen</li>   <li>You may have to refresh your history to see the queued jobs</li> </ul> </blockquote>\n        <p><!--END_SNIPPET--></p>\n      </li>\n    </ol>\n\n  </blockquote>\n\n</div>\n\n<p>To assign reads to taxons, we use <strong>Kraken2</strong> with <strong>Standard PlusPF</strong> database.</p>\n\n<div class=\"Long-Version\">\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title> Taxonomy Profiling </hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/kraken2/kraken2/2.1.1+galaxy1\" title=\"Kraken2 tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Kraken2</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.1.1+galaxy1)</span> with the following parameters:\n        <ul>\n          <li><em>“Single or paired reads”</em>: <code class=\"language-plaintext highlighter-rouge\">Single</code>\n            <ul>\n              <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“Input sequences”</em>: collection output from <strong>Krakentools: Extract Kraken Reads By ID</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> from the preprocessing section</li>\n            </ul>\n          </li>\n          <li>In <em>“Create Report”</em>:\n            <ul>\n              <li><em>“Print a report with aggregrate counts/clade to file”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n            </ul>\n          </li>\n          <li><em>“Select a Kraken2 database”</em>: <code class=\"language-plaintext highlighter-rouge\">Prebuilt Refseq indexes:  PlusPF (Standard plus protozoa and fungi) (Version:  2022-06-07 - Downloaded: 2022-09-04T165121Z)</code></li>\n        </ul>\n      </li>\n    </ol>\n  </blockquote>\n\n</div>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>Inspect the <strong>Kraken2</strong> report for <code class=\"language-plaintext highlighter-rouge\">Barcode10</code></p>\n\n  <ol>\n    <li>What is the most commonly found species?</li>\n    <li>What is the second most commonly found species?</li>\n    <li>How many sequences are classified and how many are unclassified?</li>\n    <li>What are the differences between <strong>Kraken2</strong> tool’s report with <strong>Kalamari</strong> database and <strong>Kraken2</strong> tool’s report with <strong>Standard PlusPF</strong> database regarding the previous 3 questions?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>Genus level <em>Salmonella</em> with 9,950 sequences</li>\n      <li>Genus level <em>Escherichia</em> with 1,949 sequences</li>\n      <li>33,941 sequences are classified and 3,738 are unclassified</li>\n      <li>With <strong>Kalamari</strong> database the most found Genus is <em>Escherichia</em> with 13,943 sequences and the second most found Genus is <em>Salmonella</em> with 10,585 sequences. The number of classified sequences are 30,838 sequences and the unclassified sequences are 6,874. In conclusion, both databases are able to show the similar results of the most common identified species, but with different counts of identified sequences. As well as, the number of the classified sequences with <strong>Standard PlusPF</strong> database is higher than <strong>Kalamari</strong> database.</li>\n    </ol>\n  </blockquote>\n</blockquote>\n\n<p>In order to view the taxonomy profiling produced by <strong>Kraken2</strong> tool, there are a lot of tools to be used afterwards such as <strong>Krona pie chart</strong>, which we will be using in this tutorial. For later, you can also check out <a href=\"https://academic.oup.com/bioinformatics/article/36/4/1303/5573755\"><strong>Pavian</strong></a> tool, as well as <strong>Phinch visualization</strong>, which is an interactive tool that contains multiple visualization plots, it is interactive alowing you to choose between different parameters, you can visualize each taxonomic level on its own, you can have the metadata of the samples represented along with the taxonomic visualization, download all plots for publications and a lot of other benefits.</p>\n\n<div class=\"Long-Version\">\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title> Visualisation </hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/krakentools_kreport2krona/krakentools_kreport2krona/1.2+galaxy1\" title=\"Krakentools: Convert kraken report file tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Krakentools: Convert kraken report file</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.2+galaxy1)</span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Kraken report file”</em>: <code class=\"language-plaintext highlighter-rouge\">report_output</code> (output of <strong>Kraken2</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        </ul>\n      </li>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/crs4/taxonomy_krona_chart/taxonomy_krona_chart/2.7.1+galaxy0\" title=\"Krona pie chart tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Krona pie chart</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.7.1+galaxy0)</span> with the following parameters:\n        <ul>\n          <li><em>“What is the type of your input data”</em>: <code class=\"language-plaintext highlighter-rouge\">Tabular</code>\n            <ul>\n              <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input file”</em>: <code class=\"language-plaintext highlighter-rouge\">output</code> (output of <strong>Krakentools: Convert kraken report file</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n            </ul>\n          </li>\n        </ul>\n      </li>\n    </ol>\n\n  </blockquote>\n\n</div>\n\n<p>Now let’s explore the <strong>Krona pie chart</strong> output for <code class=\"language-plaintext highlighter-rouge\">Barcode11</code></p>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>What is the most commonly found species?</li>\n    <li>What is the second most commonly found species?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>At Genus level: <em>Salmonella</em> with 16,111 sequences</li>\n      <li>\n        <p>At Genus level: <em>Pseudomonas</em> with 14,251 sequences</p>\n\n        <p><a href=\"./images/krona_taxonomy_pie_chart_barcode11.png\" rel=\"noopener noreferrer\"><img src=\"./images/krona_taxonomy_pie_chart_barcode11.png\" alt=\"Taxonomy Krona Pie Chart Barcode 11. \" width=\"1437\" height=\"961\" loading=\"lazy\" /></a></p>\n      </li>\n    </ol>\n\n  </blockquote>\n</blockquote>\n\n<blockquote class=\"comment\">\n  <comment-title></comment-title>\n  <p>While these steps are running, you can move on to the next section <strong>Gene based pathogenic identification</strong> and run the steps there, as well. Both analyses can execute in parallel.</p>\n</blockquote>\n\n<p>You may have noticed some sequences have been assigned to the Human Genome (Homosapians) species, when we run <strong>Kraken2</strong> using the <strong>Standard PlusPF</strong> in this section. However, in the <strong>pre-processing</strong> section when we ran <strong>Kraken2</strong> with <strong>Kalamari</strong> no Human Genomes were found. The lab (data producers) has confirmed that these sequences assigned to human by <strong>Standard PlusPF</strong> database are not human and there should be no human sequences in the samples as <strong>Kalamari</strong> database result’s confirmed. So these sequences were wrongly assigned to human by <strong>Standard PlusPF</strong>. That is due to resemblance between organisms and the limited species coverage of <strong>Kraken2</strong> databases sometimes do happen that reads corresponding to higher organisms get mapped to humans. It was a very severe problem for the <strong>Standard PlusPF</strong>, because yeast genes were mis-assigned to human.</p>\n\n<p>We decide to keep these sequences since we do not know what are they via the <strong>taxonomy profiling</strong> step, which could mean that they might be identified as pathogens in the coming steps, and if we delete them we are possibly losing important information and losing the main goal of the workflow to detect pathogens and track them.</p>\n\n<h1 id=\"gene-based-pathogen-identification\">Gene-based pathogen identification</h1>\n\n<p>With taxonomy profiling, we identified some bacterial species. But we want to be sure they are pathogenic, by <strong>looking for genes known to be linked to pathogenicity or to the pathogenecity character</strong> of the organim:</p>\n\n<ul>\n  <li><a href=\"https://www.sciencedirect.com/topics/immunology-and-microbiology/virulence-factor\"><strong>Virulence Factor (VF)</strong></a>: gene products, usually proteins, involved in pathogenicity. By identifiying them we can call a pathogen and its severity level</li>\n  <li>\n    <p><a href=\"https://www.sciencedirect.com/topics/engineering/antibiotic-resistance-genes\"><strong>Antimicrobial Resistance genes (AMR)</strong></a>.</p>\n\n    <p>These type of genes have three fundamental mechanisms of antimicrobial resistance that are enzymatic degradation of antibacterial drugs, alteration of bacterial proteins that are antimicrobial targets, and changes in membrane permeability to antibiotics, which will lead to not altering the target site and spread throughput the pathogenic bacteria decreasing the overall fitness of the host.</p>\n  </li>\n</ul>\n\n<p>To look for these genes and determine the strain of the bacteria we are testing for pathogenicity we do:</p>\n\n<ol>\n  <li>Genome assembly to get contigs, i.e. longer sequences, using <strong>metaflye</strong> (<span class=\"citation\"><a href=\"#flye\">Kolmogorov <i>et al.</i> 2020</a></span>)  then assembly polishing using <a href=\"https://github.com/nanoporetech/medaka\"><strong>medaka consensus pipeline</strong></a> and visualizing the assembly graph using <strong>Bandage Image</strong> (<span class=\"citation\"><a href=\"#Wick2015\">Wick <i>et al.</i> 2015</a></span>)</li>\n  <li>Generate reports with <strong>AMR</strong> genes and <strong>VF</strong> using <a href=\"https://github.com/tseemann/abricate\"><strong>ABRicate</strong></a></li>\n</ol>\n\n<p>As outputs, we will get our <strong>FASTA</strong> and <strong>Tabular</strong> files to track genes and visualize our pathogenic identification.</p>\n\n<div class=\"Short-Version\">\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title>Gene based Pathogenic Identification</hands-on-title>\n\n    <ol>\n      <li><strong>Import the workflow</strong> into Galaxy\n        <ul>\n          <li>Copy the URL (e.g. via right-click) of <a href=\"/training-material/topics/microbiome/tutorials/pathogen-detection-from-nanopore-foodborne-data/workflows/gene_based_pathogen_identification.ga\">this workflow</a> or download it to your computer.</li>\n          <li>Import the workflow into Galaxy</li>\n        </ul>\n\n        <!--SNIPPET-->\n        <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-a-workflow-1\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-a-workflow-1\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing a workflow</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on <em>Workflow</em> on the top menu bar of Galaxy. You will see a list of all your workflows.</li>   <li>Click on <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Import</strong> at the top-right of the screen</li>   <li>Provide your workflow     <ul>       <li>Option 1: Paste the URL of the workflow into the box labelled <em>“Archived Workflow URL”</em></li>       <li>Option 2: Upload the workflow file in the box labelled <em>“Archived Workflow File”</em></li>     </ul>   </li>   <li>Click the <strong>Import workflow</strong> button</li> </ul>   <p>Below is a short video demonstrating how to import a workflow from GitHub using this procedure:</p>   <figure> <iframe credentialless=\"\" allowfullscreen=\"\" referrerpolicy=\"no-referrer\" sandbox=\"allow-scripts allow-same-origin\" allow=\"accelerometer 'none'; ambient-light-sensor 'none'; autoplay 'none'; battery 'none'; bluetooth 'none'; browsing-topics 'none'; camera 'none'; ch-ua 'none'; display-capture 'none'; domain-agent 'none'; document-domain 'none'; encrypted-media 'none'; execution-while-not-rendered 'none'; execution-while-out-of-viewport 'none'; gamepad 'none'; geolocation 'none'; gyroscope 'none'; hid 'none'; identity-credentials-get 'none'; idle-detection 'none'; keyboard-map 'none'; local-fonts 'none'; magnetometer 'none'; microphone 'none'; midi 'none'; navigation-override 'none'; otp-credentials 'none'; payment 'none'; picture-in-picture 'none'; publickey-credentials-create 'none'; publickey-credentials-get 'none'; screen-wake-lock 'none'; serial 'none'; speaker-selection 'none'; sync-xhr 'none'; usb 'none'; web-share 'none'; window-management 'none'; xr-spatial-tracking 'none'\" csp=\"sandbox allow-scripts allow-same-origin;\" width=\"560\" height=\"315\" src=\"https://www.youtube-nocookie.com/embed/hoP36Te5wko\" title=\"Importing a workflow from URL\" frameborder=\"0\" loading=\"lazy\"></iframe> <figcaption>   <span class=\"figcaption-prefix\"><strong>Video</strong>:</span> Importing a workflow from URL</figcaption> </figure> </blockquote>\n        <p><!--END_SNIPPET--></p>\n      </li>\n      <li>Run <strong>Workflow 3: Gene-based Pathogen Identification</strong> <i class=\"fas fa-share-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">workflow</span> using the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Collection of preprocessed samples”</em>: <code class=\"language-plaintext highlighter-rouge\">collection of preprocessed samples</code> collection output from <strong>Krakentools: Extract Kraken Reads By ID</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> from the preprocessing workflow</li>\n        </ul>\n\n        <!--SNIPPET-->\n        <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-running-a-workflow-2\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-running-a-workflow-2\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Running a workflow</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on <em>Workflow</em> on the top menu bar of Galaxy. You will see a list of all your workflows.</li>   <li>Click on the <i class=\"fas fa-play\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">workflow-run</span> (<em>Run workflow</em>) button next to your workflow</li>   <li>Configure the workflow as needed</li>   <li>Click the <strong>Run Workflow</strong> button at the top-right of the screen</li>   <li>You may have to refresh your history to see the queued jobs</li> </ul> </blockquote>\n        <p><!--END_SNIPPET--></p>\n      </li>\n    </ol>\n\n  </blockquote>\n\n</div>\n\n<h2 id=\"assembly\">Assembly</h2>\n\n<p>To identify VF or AMR genes, it is better to assemble reads into longer seuqences or contigs, that can be then used to search databases for the presence of any pathogenic gene:</p>\n\n<ul>\n  <li>\n    <p>Assembly of long-read metagenomic data using <strong>metaflye</strong> or <strong>Flye</strong>.</p>\n\n    <div class=\"Long-Version\">\n\n      <blockquote class=\"hands-on\">\n        <hands-on-title> Assembly with Flye </hands-on-title>\n\n        <ol>\n          <li><span class=\"tool\" data-tool=\"__BUILD_LIST__\" title=\"Build list tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Build list</strong></span> with the following parameters:\n            <ul>\n              <li>In <em>“Dataset”</em>:\n                <ul>\n                  <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Dataset”</em>\n                    <ul>\n                      <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“Input Dataset”</em>: collection output from <strong>Krakentools: Extract Kraken Reads By ID</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> from the preprocessing section</li>\n                      <li><em>“Label to use”</em>: <code class=\"language-plaintext highlighter-rouge\">Index</code></li>\n                    </ul>\n                  </li>\n                </ul>\n              </li>\n            </ul>\n          </li>\n          <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/flye/flye/2.9+galaxy0\" title=\"Flye tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Flye</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.9+galaxy0)</span> with the following parameters:\n            <ul>\n              <li>\n                <p><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input reads”</em>: collection output from <strong>Build list</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></p>\n\n                <blockquote class=\"comment\">\n                  <comment-title></comment-title>\n                  <p>We need to run <strong>Flye</strong> individually on each sample otherwise <strong>Flye</strong> runs by default a co-assembly mode, <em>i.e.</em> it combines reads of both samples together before running the assembly.</p>\n                </blockquote>\n              </li>\n              <li><em>“Mode”</em>: <code class=\"language-plaintext highlighter-rouge\">Nanopore HQ (--nano-hq)</code></li>\n              <li><em>“Perform metagenomic assembly”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n              <li><em>“Reduced contig assembly coverage”</em>: <code class=\"language-plaintext highlighter-rouge\">Disable reduced coverage for initial disjointing assembly</code></li>\n            </ul>\n          </li>\n        </ol>\n\n      </blockquote>\n\n    </div>\n  </li>\n  <li>\n    <p>For the visualization of the assembly graph output from <strong>Flye</strong> we have chosen <strong>Bandage Image</strong>.</p>\n\n    <div class=\"Long-Version\">\n\n      <blockquote class=\"hands-on\">\n        <hands-on-title> Visualization of the assembly grap </hands-on-title>\n        <ol>\n          <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/bandage/bandage_image/0.8.1+galaxy2\" title=\"Bandage Image tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Bandage Image</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.8.1+galaxy2)</span> with the following parameters:\n            <ul>\n              <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“Graphical Fragment Assembly”</em>: <code class=\"language-plaintext highlighter-rouge\">assembly_graph</code> Assembly graph outputs of <strong>Flye</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n            </ul>\n          </li>\n        </ol>\n      </blockquote>\n\n    </div>\n  </li>\n  <li>\n    <p>Contig polishing using <strong>medaka</strong> to correct the long, error-prone Nanopore reads</p>\n\n    <div class=\"Long-Version\">\n\n      <blockquote class=\"hands-on\">\n        <hands-on-title> Contig polishing </hands-on-title>\n\n        <ol>\n          <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/medaka_consensus_pipeline/medaka_consensus_pipeline/1.7.2+galaxy0\" title=\"medaka consensus pipeline tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>medaka consensus pipeline</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.7.2+galaxy0)</span> with the following parameters:\n            <ul>\n              <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“Select basecalls”</em>: collection output from <strong>Krakentools: Extract Kraken Reads By ID</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> from the preprocessing section</li>\n              <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“Select assembly”</em>: <code class=\"language-plaintext highlighter-rouge\">consensus</code> collection output of <strong>Flye</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n              <li><em>“Select model”</em>: <code class=\"language-plaintext highlighter-rouge\">r941_min_hac_g507</code></li>\n              <li><em>“Select output file(s)”</em>: <code class=\"language-plaintext highlighter-rouge\">select all</code></li>\n            </ul>\n          </li>\n        </ol>\n      </blockquote>\n\n      <p>To keep information about the provenance of the contigs, we extract the sample names from the <strong>collection of preprocessed samples</strong> collection and add it to the contigs files.</p>\n\n      <blockquote class=\"hands-on\">\n        <hands-on-title> Contig renaming to add sample names </hands-on-title>\n        <ol>\n          <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/devteam/fasta_to_tabular/fasta2tab/1.1.1\" title=\"FASTA-to-Tabular tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>FASTA-to-Tabular</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.1.1)</span> with the following parameters:\n            <ul>\n              <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“Convert these sequences”</em>: collection output of <strong>medaka consensus pipeline</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n            </ul>\n          </li>\n          <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/collection_element_identifiers/collection_element_identifiers/0.0.2\" title=\"Extract element identifiers tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Extract element identifiers</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.0.2)</span> with the following parameters:\n            <ul>\n              <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“Dataset collection”</em>: collection output from <strong>Krakentools: Extract Kraken Reads By ID</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> from the preprocessing section</li>\n            </ul>\n          </li>\n          <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/split_file_to_collection/split_file_to_collection/0.5.0\" title=\"Split file tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Split file</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.5.0)</span> with the following parameters:\n            <ul>\n              <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“Text file to split”</em>: output from <strong>Extract element identifiers</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n            </ul>\n          </li>\n          <li><span class=\"tool\" data-tool=\"param_value_from_file\" title=\"Parse parameter value tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Parse parameter value</strong></span> with the following parameters:\n            <ul>\n              <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“Input file containing parameter to parse out of”</em>: output from <strong>Split file</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n            </ul>\n          </li>\n          <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/compose_text_param/compose_text_param/0.1.1\" title=\"Compose text parameter value tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Compose text parameter value</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.1.1)</span> with the following parameters:\n            <ul>\n              <li>In <em>“components”</em>:\n                <ul>\n                  <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert components”</em>\n                    <ul>\n                      <li><em>“Choose the type of parameter for this field”</em>: <code class=\"language-plaintext highlighter-rouge\">Text Parameter</code>\n                        <ul>\n                          <li><em>“Enter text that should be part of the computed value”</em>: output from <strong>Parse parameter value</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n                        </ul>\n                      </li>\n                    </ul>\n                  </li>\n                  <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert components”</em>\n                    <ul>\n                      <li><em>“Choose the type of parameter for this field”</em>: <code class=\"language-plaintext highlighter-rouge\">Text Parameter</code>\n                        <ul>\n                          <li><em>“Enter text that should be part of the computed value”</em>: <code class=\"language-plaintext highlighter-rouge\">_$1</code></li>\n                        </ul>\n                      </li>\n                    </ul>\n                  </li>\n                </ul>\n              </li>\n            </ul>\n          </li>\n          <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_find_and_replace/1.1.4\" title=\"Replace tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Replace</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.1.4)</span> with the following parameters:\n            <ul>\n              <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“File to process”</em>: collection output of <strong>FASTA-to-Tabular</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n              <li>In <em>“Find and Replace”</em>:\n                <ul>\n                  <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Find and Replace”</em>\n                    <ul>\n                      <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">^(.+)$</code></li>\n                      <li><em>“Replace with”</em>: output from <strong>Compose text parameter value</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n                      <li><em>“Find-Pattern is a regular expression”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n                      <li><em>“Replace all occurences of the pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n                      <li><em>“Find and Replace text in”</em>: <code class=\"language-plaintext highlighter-rouge\">specific column</code>\n                        <ul>\n                          <li><em>“in column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 1</code></li>\n                        </ul>\n                      </li>\n                    </ul>\n                  </li>\n                </ul>\n              </li>\n            </ul>\n          </li>\n          <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/devteam/tabular_to_fasta/tab2fasta/1.1.1\" title=\"Tabular-to-FASTA tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Tabular-to-FASTA</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.1.1)</span> with the following parameters:\n            <ul>\n              <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Tab-delimited file”</em>: <code class=\"language-plaintext highlighter-rouge\">outfile</code> (output of <strong>Replace</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n              <li><em>“Title column(s)”</em>: <code class=\"language-plaintext highlighter-rouge\">c1</code></li>\n              <li><em>“Sequence column”</em>: <code class=\"language-plaintext highlighter-rouge\">c2</code></li>\n            </ul>\n          </li>\n          <li>Rename the output collection <code class=\"language-plaintext highlighter-rouge\">Contigs</code></li>\n        </ol>\n      </blockquote>\n\n    </div>\n  </li>\n</ul>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>Inspect <strong>Flye</strong> and <strong>Medaka consensus pipeline</strong> output results for <code class=\"language-plaintext highlighter-rouge\">Barcode10</code></p>\n\n  <ol>\n    <li>How many different contigs did you get after <strong>Flye</strong>, collection name: Flye Consensus Fasta?</li>\n    <li>How many were left after <strong>Medaka consensus pipeline</strong>, collection name: Sample all contigs, and what does that mean?</li>\n    <li>What is the result of your <strong>Bandage Image</strong>?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>After <strong>Flye</strong> we have got 130 contigs</li>\n      <li>After <strong>Medaka consensus pipeline</strong> all 130 contigs were kept, which means that the quality of the <strong>Flye</strong> run was high, and as a result the polishing did not remove any of the contigs.</li>\n      <li>\n        <p>The graph looks like:</p>\n\n        <p><a href=\"./images/bandage_image_flye_graph.png\" rel=\"noopener noreferrer\"><img src=\"./images/bandage_image_flye_graph.png\" alt=\"Bandage Image Barcode 10 Assembly Graph. \" width=\"1091\" height=\"819\" loading=\"lazy\" /></a></p>\n      </li>\n    </ol>\n\n  </blockquote>\n</blockquote>\n\n<!--## Multilocus Sequence Typing\n\n**MLST** tool is used to scan the [pubMLST](https://pubmlst.org/) database against PubMLST typing schemes. It's one of the analyses that you can perform on your dataset to determine the allele IDs, you can also detect novel alleles. This step is not essential to identify pathogens and track them in the remainder of this tutorial, however we wanted to show some of the analysis that one can use Galaxy in to understand more about the dataset, as well as identifying the strain that might be a pathogen or not.\n\n<div class=\"Long-Version\" markdown=\"1\">\n\n> <hands-on-title> Multilocus Sequence Typing </hands-on-title>\n>\n> 1. <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/mlst/mlst/2.22.0\" title=\"MLST tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>MLST</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.22.0)</span> with the following parameters:\n>    - <i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> *\"input_files\"*:  collection output of **medaka consensus pipeline** <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> FASTA files with contigs\n>    - *\"Specify advanced parameters\"*: `Yes, see full parameter list`\n>        - *\"Output novel alleles\"*: `Yes`\n>        - *\"Automatically set MLST scheme\"*: `Automatic MLST scheme detection`\n>\n{: .hands-on}\n\n</div>\n\nThe output file of the **MLST** tool is a tab-separated output file which contains:\n- the filename\n- the closest PubMLST scheme name\n- the ST (sequence type)\n- the allele IDs\n\n> <question-title></question-title>\n>\n> Inspect **MLST** <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> results\n>\n> 1. What is the the closest PubMLST typing scheme name detected by the tool for  `Barcode11`?\n>\n> > <solution-title></solution-title>\n> >\n> > 1. senterica_achtman_2 (<span class=\"citation\"><a href=\"#sentericaachtman2\">“<b>Multilocus Sequence Typing as a Replacement for Serotyping in Salmonella enterica</b>” 2012</a></span>)\n> >\n> {: .solution}\n{: .question}\n-->\n\n<h2 id=\"antimicrobial-resistance-genes\">Antimicrobial Resistance Genes</h2>\n\n<p>Now, to search <strong>AMR</strong> genes among our samples’ contigs, we run <strong>ABRicate</strong> and choose the <a href=\"https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6811410/\"><strong>NCBI Bacterial Antimicrobial Resistance Gene Database (AMRFinderPlus)</strong></a> from the advanced options of the tool. The tool checks if there is an AMR found or not, if found then in which contig it is, its location on the contig, what the name of the exact product is, what substance it provides resistance against and a lot of other information regarding the found <strong>AMR</strong>.</p>\n\n<div class=\"Long-Version\">\n\n  <blockquote class=\"hands-on\">\n    <hands-on-title> Antimicrobial Resistance Genes Identification </hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/abricate/abricate/1.0.1\" title=\"ABRicate tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>ABRicate</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.0.1)</span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“Input file (Fasta, Genbank or EMBL file)”</em>: collection output of <strong>medaka consensus pipeline</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> FASTA files with contigs</li>\n          <li>In <em>“Advanced options”</em>:\n            <ul>\n              <li><em>“Database to use - default is ‘resfinder’“</em>: <code class=\"language-plaintext highlighter-rouge\">NCBI Bacterial Antimicrobial Resistance Reference Gene Database</code></li>\n            </ul>\n          </li>\n        </ul>\n      </li>\n      <li>Rename <strong>ABRicate</strong> the output collection <code class=\"language-plaintext highlighter-rouge\">amr_identified_by_ncbi</code></li>\n    </ol>\n  </blockquote>\n\n</div>\n\n<p>The outputs of <strong>ABRicate</strong> is a tabular file with different columns:</p>\n<ol>\n  <li><code class=\"language-plaintext highlighter-rouge\">FILE</code>: The filename this hit came from</li>\n  <li><code class=\"language-plaintext highlighter-rouge\">SEQUENCE</code>: The sequence in the filename</li>\n  <li><code class=\"language-plaintext highlighter-rouge\">START</code>: Start coordinate in the sequence</li>\n  <li><code class=\"language-plaintext highlighter-rouge\">END</code>: End coordinate</li>\n  <li><code class=\"language-plaintext highlighter-rouge\">STRAND</code>: AMR gene</li>\n  <li><code class=\"language-plaintext highlighter-rouge\">GENE</code>: AMR gene</li>\n  <li><code class=\"language-plaintext highlighter-rouge\">COVERAGE</code>: What proportion of the gene is in our sequence</li>\n  <li><code class=\"language-plaintext highlighter-rouge\">COVERAGE_MA</code>: A visual represenation</li>\n  <li><code class=\"language-plaintext highlighter-rouge\">GAPS</code>: Was there any gaps in the alignment - possible pseudogene?</li>\n  <li><code class=\"language-plaintext highlighter-rouge\">%COVERAGE</code>: Proportion of gene covered</li>\n  <li><code class=\"language-plaintext highlighter-rouge\">%IDENTITY</code>: Proportion of exact nucleotide matches</li>\n  <li><code class=\"language-plaintext highlighter-rouge\">DATABASE</code>: The database this sequence comes from</li>\n  <li><code class=\"language-plaintext highlighter-rouge\">ACCESSION</code>: The genomic source of the sequence</li>\n  <li><code class=\"language-plaintext highlighter-rouge\">PRODUCT</code></li>\n  <li><code class=\"language-plaintext highlighter-rouge\">RESISTANCE</code></li>\n</ol>\n\n<!--<div class=\"Long-Version\" markdown=\"1\">\n\n> <hands-on-title> Antimicrobial Resistance Genes Identification </hands-on-title>\n> 2. <span class=\"tool\" data-tool=\"Cut1\" title=\"Cut tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Cut</strong></span> with the following parameters:\n>    - *\"Cut columns\"*: `c13`\n>    - <i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> *\"From\"*: `report` (output of the **ABRicate** <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> run)\n>\n> 3. <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/add_line_to_file/add_line_to_file/0.1.0\" title=\"Add line to file tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Add line to file</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.1.0)</span> with the following parameters:\n>    - *\"text to add\"*: `Spike2Barcode10` or `Spike2bBarcode11` respectively to the tag chosen for the first parameter (the sample ID)\n>    - <i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> *\"input file\"*: `out_file1` (output of the **Cut** <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)\n{: .hands-on}\n\n</div>-->\n<p>To prepare the <strong>ABRicate</strong><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> output tabulars of both samples for further analysis in the <strong>Pathogen Detection Samples Aggregation and Visualisation</strong> section, tabular manipulation tools such as <strong>Replace</strong><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> is used. We mainly use it to add the sample ID along with which contig at which exact location.</p>\n\n<div class=\"Long-Version\">\n\n  <blockquote class=\"hands-on\">\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_find_and_replace/1.1.4\" title=\"Replace tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Replace</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.1.4)</span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“File to process”</em>: <code class=\"language-plaintext highlighter-rouge\">report</code> (output of <strong>ABRicate</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n          <li>In <em>“Find and Replace”</em>:\n            <ul>\n              <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Find and Replace”</em>\n                <ul>\n                  <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">#FILE</code></li>\n                  <li><em>“Replace with”</em>: <code class=\"language-plaintext highlighter-rouge\">SampleID</code></li>\n                  <li><em>“Replace all occurences of the pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n                  <li><em>“Find and Replace text in”</em>: <code class=\"language-plaintext highlighter-rouge\">specific column</code>\n                    <ul>\n                      <li><em>“in column”</em>: <code class=\"language-plaintext highlighter-rouge\">c1</code></li>\n                    </ul>\n                  </li>\n                </ul>\n              </li>\n              <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Find and Replace”</em>\n                <ul>\n                  <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">^(.+)$</code></li>\n                  <li><em>“Replace with”</em>: output from <strong>Compose text parameter value</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n                  <li><em>“Find-Pattern is a regular expression”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n                  <li><em>“Replace all occurences of the pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n                  <li><em>“Ignore first line”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n                  <li><em>“Find and Replace text in”</em>: <code class=\"language-plaintext highlighter-rouge\">specific column</code>\n                    <ul>\n                      <li><em>“in column”</em>: <code class=\"language-plaintext highlighter-rouge\">c2</code></li>\n                    </ul>\n                  </li>\n                </ul>\n              </li>\n            </ul>\n          </li>\n        </ul>\n      </li>\n      <li>Rename the output collection <code class=\"language-plaintext highlighter-rouge\">AMRs</code></li>\n    </ol>\n  </blockquote>\n</div>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>Inspect <strong>ABRicate</strong> output files from <code class=\"language-plaintext highlighter-rouge\">Barcode10</code>and <code class=\"language-plaintext highlighter-rouge\">Barcode11</code> tags</p>\n\n  <ol>\n    <li>How many <strong>AMR</strong> genes found in <code class=\"language-plaintext highlighter-rouge\">Barcode10</code> sample, what are they? Give more details about them.</li>\n    <li>How many <strong>AMR</strong> genes found in <code class=\"language-plaintext highlighter-rouge\">Barcode11</code> sample, what are they? Give more details about them.</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>7 <strong>AMR</strong> genes were found:\n        <ol>\n          <li>Tet(C), which resists <a href=\"https://medlineplus.gov/druginfo/meds/a682098.html\">TETRACYCLINE</a>. It was found in contig 119 from the position 1635 till 2810, with 100% coverage, so 100% of gene is covered in this contig.</li>\n          <li>Tet(34), which resists <a href=\"https://medlineplus.gov/druginfo/meds/a682098.html\">TETRACYCLINE</a>. It was found in contig 135 from the position 69874 till 70223, with 74.41% coverage.</li>\n          <li>aac(6’)_Yersi, which resists <a href=\"https://en.wikipedia.org/wiki/Aminoglycoside\">AMINOGLYCOSIDE</a>. It was found in contig 156 from the position 37698 till 38000, with  69.68 % coverage.</li>\n          <li>2 genes with sulfonamide-resistant dihydropteroate synthase Sul1 products</li>\n          <li>2 genes with oxacillin-hydrolyzing class D beta-lactamase OXA-2 products</li>\n        </ol>\n      </li>\n      <li>2 <strong>AMR</strong> genes were found by the database in <code class=\"language-plaintext highlighter-rouge\">Barcode11</code> sample, Tet(34) and aac(6’)_Yersi.</li>\n    </ol>\n\n  </blockquote>\n</blockquote>\n\n<h2 id=\"virulence-factor-identification\">Virulence Factor identification</h2>\n\n<p>In this step we return back to the main goal of the tutorial where we want to identify the pathogens: <strong>identify if the bacteria found in our samples are pathogenic bacteria or not</strong>. One of the ways to do that is to identify if the sequences include genes with a <a href=\"https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2646308/\">Virulence Facor</a> or not, such that if the samples include gene(s) with a Virulence Factor then it for sure is a pathogen.</p>\n\n<blockquote class=\"comment\">\n  <comment-title>Definitions</comment-title>\n\n  <p><strong>Bacterial Pathogen</strong>: A bacterial pathogen is usually defined as any bacterium that has the capacity to cause disease. Its ability to cause disease is called pathogenicity.</p>\n\n  <p><strong>Virulence</strong>: Virulence provides a quantitative measure of the pathogenicity or the likelihood of causing a disease.</p>\n\n  <p><strong>Virulence Factors</strong>: Virulence factors refer to the properties (i.e., gene products) that enable a microorganism to establish itself on or within a host of a particular species and enhance its potential to cause disease. Virulence factors include bacterial toxins, cell surface proteins that mediate bacterial attachment, cell surface carbohydrates and proteins that protect a bacterium, and hydrolytic enzymes that may contribute to the pathogenicity of the bacterium.</p>\n\n</blockquote>\n\n<p>To identifly VFs, we use again <strong>ABRicate</strong> but this time with the <a href=\"https://pubmed.ncbi.nlm.nih.gov/26578559/\"><strong>VFDB</strong></a> from the advanced options of the tool.</p>\n\n<div class=\"Long-Version\">\n\n  <blockquote class=\"hands-on\">\n    <hands-on-title> Virulence Factor identification </hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/abricate/abricate/1.0.1\" title=\"ABRicate tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>ABRicate</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.0.1)</span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“Input file (Fasta, Genbank or EMBL file)”</em>: collection output of <strong>medaka consensus pipeline</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> FASTA files with contigs</li>\n          <li>In <em>“Advanced options”</em>:\n            <ul>\n              <li><em>“Database to use - default is ‘resfinder’“</em>: <code class=\"language-plaintext highlighter-rouge\">VFDB</code></li>\n            </ul>\n          </li>\n        </ul>\n      </li>\n      <li>Rename <strong>ABRicate</strong> the output collection <code class=\"language-plaintext highlighter-rouge\">vfs_of_genes_identified_by_vfdb</code></li>\n    </ol>\n  </blockquote>\n\n</div>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>Inspect <strong>VFs of genes Identified by VFDB</strong> output file from<code class=\"language-plaintext highlighter-rouge\">Barcode10</code>and <code class=\"language-plaintext highlighter-rouge\">Barcode11</code></p>\n\n  <ol>\n    <li>How many different <strong>VFs</strong> gene products were found in <code class=\"language-plaintext highlighter-rouge\">Barcode10</code> sample?</li>\n    <li>How many different <strong>VFs</strong> gene products were found in <code class=\"language-plaintext highlighter-rouge\">Barcode11</code> sample?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>188</li>\n      <li>287</li>\n    </ol>\n\n  </blockquote>\n</blockquote>\n\n<p>To prepare the <strong>ABRicate</strong><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> output tabulars of both samples for further analysis in the <strong>Pathogen Detection Samples Aggregation and Visualisation</strong> section, tabular manipulation tools such as <strong>Replace</strong><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> is used. We mainly use it to add the sample ID along with which contig at which exact location.</p>\n\n<div class=\"Long-Version\">\n\n  <blockquote class=\"hands-on\">\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_find_and_replace/1.1.4\" title=\"Replace tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Replace</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.1.4)</span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“File to process”</em>: <code class=\"language-plaintext highlighter-rouge\">report</code> (output of <strong>ABRicate</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n          <li>In <em>“Find and Replace”</em>:\n            <ul>\n              <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Find and Replace”</em>\n                <ul>\n                  <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">#FILE</code></li>\n                  <li><em>“Replace with”</em>: <code class=\"language-plaintext highlighter-rouge\">SampleID</code></li>\n                  <li><em>“Replace all occurences of the pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n                  <li><em>“Find and Replace text in”</em>: <code class=\"language-plaintext highlighter-rouge\">specific column</code>\n                    <ul>\n                      <li><em>“in column”</em>: <code class=\"language-plaintext highlighter-rouge\">c1</code></li>\n                    </ul>\n                  </li>\n                </ul>\n              </li>\n              <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Find and Replace”</em>\n                <ul>\n                  <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">^(.+)$</code></li>\n                  <li><em>“Replace with”</em>: output from <strong>Compose text parameter value</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n                  <li><em>“Find-Pattern is a regular expression”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n                  <li><em>“Replace all occurences of the pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n                  <li><em>“Ignore first line”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n                  <li><em>“Find and Replace text in”</em>: <code class=\"language-plaintext highlighter-rouge\">specific column</code>\n                    <ul>\n                      <li><em>“in column”</em>: <code class=\"language-plaintext highlighter-rouge\">c2</code></li>\n                    </ul>\n                  </li>\n                </ul>\n              </li>\n            </ul>\n          </li>\n        </ul>\n      </li>\n      <li>Rename the output collection <code class=\"language-plaintext highlighter-rouge\">VFs</code></li>\n    </ol>\n  </blockquote>\n\n</div>\n\n<h1 id=\"allele-based-pathogen-identification\">Allele-based pathogen identification</h1>\n\n<p>Now we would like to identify pathogens with a third approach based on variant and <a href=\"https://genome.sph.umich.edu/w/images/e/e6/Seqshop_may_2015_day2_snp_lecture_v2.pdf\">single nucleotide polymorphisms (SNPs) calling</a>: comparison of reads to a targeted reference genome, and call the differences between sample reads and reference genomes to identify variants.</p>\n\n<p>For example, if we want to check whether our samples include <a href=\"https://www.cdc.gov/campylobacter/index.html\"><em>Campylobacter</em> pathogenic strains</a> or not, we will map our samples against the reference genome of the <em>Campylobacter</em> species. Variants in specific positions on the genome are queried to judge if these variations would indicate a pathogen or not.</p>\n\n<p>This approach also allows identification of novel alleles and possible <strong>new variants of the pathogen</strong>.</p>\n\n<p>Using this approach, we also build the consensus genome of each sample, so we can later build a phylogenetic tree of all samples’ full genomes and have an insight into events that occurred during the evolution of same or different species in the samples.</p>\n\n<p>In this training, we are testing <em>Salmonella enterica</em>, with different strains of which our samples were spiked. So we will now upload to our history the reference genome of <a href=\"https://www.ncbi.nlm.nih.gov/genome/?term=txid99287[Organism:exp]\"><em>S. enterica</em></a> we originally obtained from the <a href=\"https://www.ncbi.nlm.nih.gov/\">National Center for Biotechnology Information (NCBI) database</a>.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Data upload</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Import a reference genome FASTA file via link from <a href=\"https://zenodo.org/record/11222469\">Zenodo</a> or Galaxy shared data libraries</p>\n\n      <div class=\"language-text highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/11222469/files/Salmonella_Ref_genome.fna.gz\n</code></pre></div>      </div>\n    </li>\n  </ol>\n\n</blockquote>\n\n<div class=\"Short-Version\">\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title>Allele based Pathogenic Identification</hands-on-title>\n\n    <ol>\n      <li><strong>Import the workflow</strong> into Galaxy\n        <ul>\n          <li>Copy the URL (e.g. via right-click) of <a href=\"/training-material/topics/microbiome/tutorials/pathogen-detection-from-nanopore-foodborne-data/workflows/allele_based_pathogen_identification.ga\">this workflow</a> or download it to your computer.</li>\n          <li>Import the workflow into Galaxy</li>\n        </ul>\n\n        <!--SNIPPET-->\n        <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-a-workflow-2\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-a-workflow-2\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing a workflow</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on <em>Workflow</em> on the top menu bar of Galaxy. You will see a list of all your workflows.</li>   <li>Click on <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Import</strong> at the top-right of the screen</li>   <li>Provide your workflow     <ul>       <li>Option 1: Paste the URL of the workflow into the box labelled <em>“Archived Workflow URL”</em></li>       <li>Option 2: Upload the workflow file in the box labelled <em>“Archived Workflow File”</em></li>     </ul>   </li>   <li>Click the <strong>Import workflow</strong> button</li> </ul>   <p>Below is a short video demonstrating how to import a workflow from GitHub using this procedure:</p>   <figure> <iframe credentialless=\"\" allowfullscreen=\"\" referrerpolicy=\"no-referrer\" sandbox=\"allow-scripts allow-same-origin\" allow=\"accelerometer 'none'; ambient-light-sensor 'none'; autoplay 'none'; battery 'none'; bluetooth 'none'; browsing-topics 'none'; camera 'none'; ch-ua 'none'; display-capture 'none'; domain-agent 'none'; document-domain 'none'; encrypted-media 'none'; execution-while-not-rendered 'none'; execution-while-out-of-viewport 'none'; gamepad 'none'; geolocation 'none'; gyroscope 'none'; hid 'none'; identity-credentials-get 'none'; idle-detection 'none'; keyboard-map 'none'; local-fonts 'none'; magnetometer 'none'; microphone 'none'; midi 'none'; navigation-override 'none'; otp-credentials 'none'; payment 'none'; picture-in-picture 'none'; publickey-credentials-create 'none'; publickey-credentials-get 'none'; screen-wake-lock 'none'; serial 'none'; speaker-selection 'none'; sync-xhr 'none'; usb 'none'; web-share 'none'; window-management 'none'; xr-spatial-tracking 'none'\" csp=\"sandbox allow-scripts allow-same-origin;\" width=\"560\" height=\"315\" src=\"https://www.youtube-nocookie.com/embed/hoP36Te5wko\" title=\"Importing a workflow from URL\" frameborder=\"0\" loading=\"lazy\"></iframe> <figcaption>   <span class=\"figcaption-prefix\"><strong>Video</strong>:</span> Importing a workflow from URL</figcaption> </figure> </blockquote>\n        <p><!--END_SNIPPET--></p>\n      </li>\n      <li>Run <strong>Workflow 4: Nanopore Allele-based Pathogen Identification</strong> <i class=\"fas fa-share-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">workflow</span> using the following parameters:\n        <ul>\n          <li><em>“Send results to a new history”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n          <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“Collection of preprocessed samples”</em>: <code class=\"language-plaintext highlighter-rouge\">collection of preprocessed samples</code> collection output from <strong>Krakentools: Extract Kraken Reads By ID</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> from the preprocessing workflow</li>\n          <li><em>“Samples Profile”</em>: <code class=\"language-plaintext highlighter-rouge\">Nothing selected</code></li>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Reference Genome of Tested Strain”</em>: <code class=\"language-plaintext highlighter-rouge\">Salmonella_Ref_genome.fna.gz</code></li>\n        </ul>\n      </li>\n    </ol>\n\n  </blockquote>\n\n</div>\n\n<h2 id=\"variant-calling-or-snp-calling\">Variant Calling or SNP Calling</h2>\n\n<p>To identify variants, we</p>\n\n<ol>\n  <li>\n    <p><strong>Map reads to the reference genome</strong> of the species of the pathogen we want to test our samples against using <strong>Minimap2</strong> (<span class=\"citation\"><a href=\"#Li2017Minimap2\">Li 2017</a></span>) as our datasets are from a Nanopore:</p>\n\n    <div class=\"Long-Version\">\n\n      <blockquote class=\"hands-on\">\n        <hands-on-title> Mapping to reference genome </hands-on-title>\n        <ol>\n          <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/minimap2/minimap2/2.24+galaxy0\" title=\"Map with minimap2 tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Map with minimap2</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.24+galaxy0)</span> with the following parameters:\n            <ul>\n              <li><em>“Will you select a reference genome from your history or use a built-in index?”</em>: <code class=\"language-plaintext highlighter-rouge\">Use a genome from history and build index</code>\n                <ul>\n                  <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Use the following dataset as the reference sequence”</em>: <code class=\"language-plaintext highlighter-rouge\">Salmonella_Ref_genome.fna.gz</code></li>\n                </ul>\n              </li>\n              <li><em>“Single or Paired-end reads”</em>: <code class=\"language-plaintext highlighter-rouge\">Single</code>\n                <ul>\n                  <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“Select fastq dataset”</em>: collection output from <strong>Krakentools: Extract Kraken Reads By ID</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> from the preprocessing section</li>\n                </ul>\n              </li>\n            </ul>\n          </li>\n        </ol>\n      </blockquote>\n\n    </div>\n  </li>\n  <li>\n    <p><strong>Identify variants and single nucleotide variants</strong> using <strong>Clair3</strong> (<span class=\"citation\"><a href=\"#Zheng2021\">Zheng <i>et al.</i> 2021</a></span>), which is designed specifically for Nanopore datasets and giving better results than other variant calling tools, as well as being new and up-to-date.</p>\n\n    <blockquote class=\"comment\">\n      <comment-title></comment-title>\n      <p><a href=\"https://github.com/nanoporetech/medaka\"><strong>Medaka consensus tool</strong> and <strong>medaka variant tool</strong></a> can be also used instead of <strong>Clair3</strong>, they give similar results but they are much slower then <strong>Clair3</strong> and offer fewer options.</p>\n    </blockquote>\n\n    <div class=\"Long-Version\">\n\n      <blockquote class=\"hands-on\">\n        <hands-on-title> Variant or SNP Calling </hands-on-title>\n        <ol>\n          <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/clair3/clair3/0.1.12+galaxy0\" title=\"Clair3 tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Clair3</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.1.12+galaxy0)</span> with the following parameters:\n            <ul>\n              <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“BAM/CRAM file input”</em>: collection output of <strong>Map with minimap2</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n              <li><em>“Reference genome source”</em>: <code class=\"language-plaintext highlighter-rouge\">History</code>\n                <ul>\n                  <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Reference genome”</em>: <code class=\"language-plaintext highlighter-rouge\">Salmonella_Ref_genome.fna.gz</code></li>\n                </ul>\n              </li>\n              <li><em>“Clair3 model”</em>: <code class=\"language-plaintext highlighter-rouge\">Built-in</code>\n                <ul>\n                  <li><em>“Built-in model”</em>: <code class=\"language-plaintext highlighter-rouge\">r941_prom_hac_g360+g422</code></li>\n                </ul>\n              </li>\n              <li>In <em>“Advanced parameters”</em>:\n                <ul>\n                  <li><em>“Call with the following ploidy model”</em>: <code class=\"language-plaintext highlighter-rouge\">haploid precise (--haploid_precise)</code></li>\n                </ul>\n              </li>\n            </ul>\n          </li>\n        </ol>\n      </blockquote>\n\n    </div>\n  </li>\n  <li>\n    <p><strong>Left-align and normalize indels</strong> using <strong>bcftools norm</strong> (<span class=\"citation\"><a href=\"#Li20092\">Li <i>et al.</i> 2009</a></span>)</p>\n\n    <p>This step:</p>\n    <ul>\n      <li>checks REF alleles in the output match the reference;</li>\n      <li>splits multiallelic sites into multiple rows;</li>\n      <li>recovers multiallelics from multiple rows</li>\n    </ul>\n\n    <div class=\"Long-Version\">\n\n      <blockquote class=\"hands-on\">\n        <hands-on-title>Left-align and normalize indels</hands-on-title>\n        <ol>\n          <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/bcftools_norm/bcftools_norm/1.9+galaxy1\" title=\"bcftools norm tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>bcftools norm</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.9+galaxy1)</span> with the following parameters:\n            <ul>\n              <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“VCF/BCF Data”</em>: collection output of <strong>Clair3</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n              <li><em>“Choose the source for the reference genome”</em>: <code class=\"language-plaintext highlighter-rouge\">Use a genome from the history</code>\n                <ul>\n                  <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Reference genome”</em>: <code class=\"language-plaintext highlighter-rouge\">Salmonella_Ref_genome.fna.gz</code></li>\n                </ul>\n              </li>\n              <li><em>“output_type”</em>: <code class=\"language-plaintext highlighter-rouge\">uncompressed VCF</code></li>\n            </ul>\n          </li>\n        </ol>\n      </blockquote>\n\n    </div>\n  </li>\n  <li>\n    <p><strong>Filter variants</strong> to keep only the pass and good quality variants using <strong>SnpSift Filter</strong> (<span class=\"citation\"><a href=\"#Cingolani2012\">Cingolani <i>et al.</i> 2012</a></span>)</p>\n\n    <blockquote class=\"comment\">\n      <comment-title></comment-title>\n      <p><a href=\"https://csb5.github.io/lofreq/\"><strong>LoFreq filter</strong></a> can be also used instead, both tools performs equal and fast results.</p>\n    </blockquote>\n\n    <div class=\"Long-Version\">\n\n      <blockquote class=\"hands-on\">\n        <hands-on-title>Filter variants</hands-on-title>\n        <ol>\n          <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/snpsift/snpSift_filter/4.3+t.galaxy1\" title=\"SnpSift Filter tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>SnpSift Filter</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 4.3+t.galaxy1)</span> with the following parameters:\n            <ul>\n              <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“Input variant list in VCF format”</em>: collection output of <strong>bcftools norm</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n              <li><em>“Type of filter expression”</em>: <code class=\"language-plaintext highlighter-rouge\">Simple expression</code>\n                <ul>\n                  <li><em>“Filter criteria”</em>: <code class=\"language-plaintext highlighter-rouge\">(QUAL &gt; 2)</code></li>\n                </ul>\n              </li>\n              <li><em>“Filter mode”</em>: <code class=\"language-plaintext highlighter-rouge\">Retain selected variants, remove others</code></li>\n            </ul>\n          </li>\n        </ol>\n      </blockquote>\n\n    </div>\n\n    <p>The output is a VCF file. VCF is the standard file format for storing variation data, with different columns:</p>\n    <ul>\n      <li><code class=\"language-plaintext highlighter-rouge\">#CHROM</code>: Chromosome</li>\n      <li><code class=\"language-plaintext highlighter-rouge\">POS</code>: Co-ordinate - The start coordinate of the variant.</li>\n      <li><code class=\"language-plaintext highlighter-rouge\">ID</code>: Identifier</li>\n      <li><code class=\"language-plaintext highlighter-rouge\">REF</code>: Reference allele - The reference allele is whatever is found in the reference genome. It is not necessarily the major allele.</li>\n      <li><code class=\"language-plaintext highlighter-rouge\">ALT</code>: Alternative allele - The alternative allele is the allele found in the sample you are studying.</li>\n      <li><code class=\"language-plaintext highlighter-rouge\">QUAL</code>: Score - Quality score out of 100.</li>\n      <li><code class=\"language-plaintext highlighter-rouge\">FILTER</code>: Pass/fail - If it passed quality filters.</li>\n      <li><code class=\"language-plaintext highlighter-rouge\">INFO</code>: Further information - Allows you to provide further information on the variants. Keys in the INFO field can be defined in header lines above thetable.</li>\n      <li><code class=\"language-plaintext highlighter-rouge\">FORMAT</code>: Information about the following columns - The GT in the FORMAT column tells us to expect genotypes in the following columns.</li>\n      <li><code class=\"language-plaintext highlighter-rouge\">Individual identifier (optional)</code> - The previous column told us to expect to see genotypes here. The genotype is in the form “0|1”, where 0 indicates the reference allele and 1 indicates the alternative allele, i.e it is heterozygous. The vertical pipe “|” indicates that the genotype is phased, and is used to indicate which chromosome the alleles are on. If this is a slash (/) rather than a vertical pipe, it means we don’t know which chromosome they are on.</li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Extract a tabular report</strong> with Chromosome, Position, Identifier, Reference allele, Alternative allele and Filter from the VCF files using <a href=\"http://pcingola.github.io/SnpEff/\"><strong>SnpSift Extract Fields</strong></a></p>\n\n    <div class=\"Long-Version\">\n\n      <blockquote class=\"hands-on\">\n        <hands-on-title>Extract a tabular report</hands-on-title>\n        <ol>\n          <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/snpsift/snpSift_extractFields/4.3+t.galaxy0\" title=\"SnpSift Extract Fields tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>SnpSift Extract Fields</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 4.3+t.galaxy0)</span> with the following parameters:\n            <ul>\n              <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“Variant input file in VCF format”</em>: collection output of <strong>SnpSift Filter</strong></li>\n              <li><em>“Fields to extract”</em>: <code class=\"language-plaintext highlighter-rouge\">CHROM POS ID REF ALT FILTER</code></li>\n            </ul>\n          </li>\n        </ol>\n      </blockquote>\n\n    </div>\n  </li>\n</ol>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>Now let’s inspect the outputs for <code class=\"language-plaintext highlighter-rouge\">Barcode10</code>:</p>\n\n  <ol>\n    <li>How many variants were found by <strong>Clair3</strong>?</li>\n    <li>How many variants were found after quality filtering?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>Before filtering: 2,812</li>\n      <li>After filtering 2,642</li>\n    </ol>\n  </blockquote>\n</blockquote>\n\n<h2 id=\"mapping-depth-and-coverage\">Mapping Depth and Coverage</h2>\n\n<p>Mapping depth and coverage are essential metrics in variant calling because they ensure comprehensive analysis and accuracy in genomic studies. Mapping coverage indicates the percentage of the reference genome covered by sequencing reads, ensuring that the majority of the genome is analyzed to detect variants accurately. Mapping depth, on the other hand, refers to the number of times each base is sequenced, providing confidence in variant calls by distinguishing true variants from sequencing errors and enabling the detection of low-frequency variants. Both metrics are crucial for quality control, resource allocation, and reliable interpretation of genomic data, ensuring that important variants are not missed and reducing the risk of false positives or negatives.</p>\n\n<p>For this step we run <a href=\"http://www.htslib.org/doc/samtools-depth.html\"><strong>Samtools depth</strong></a> and <a href=\"http://www.htslib.org/doc/samtools-coverage.html\"><strong>Samtools coverage</strong></a></p>\n\n<div class=\"Long-Version\">\n\n  <blockquote class=\"hands-on\">\n    <hands-on-title> Mapping Depth and Mapping Coverage </hands-on-title>\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/samtools_depth/samtools_depth/1.15.1+galaxy2\" title=\"Samtools depth tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Samtools depth</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.15.1+galaxy2)</span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“BAM file(s)”</em>: <code class=\"language-plaintext highlighter-rouge\">alignment_output</code> (output of <strong>Map with minimap2</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n          <li><em>“Filter by regions”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n        </ul>\n      </li>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/samtools_coverage/samtools_coverage/1.15.1+galaxy2\" title=\"Samtools coverage tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Samtools coverage</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.15.1+galaxy2)</span> with the following parameters:\n        <ul>\n          <li><em>“Are you pooling bam files?”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code>\n            <ul>\n              <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“BAM file”</em>: <code class=\"language-plaintext highlighter-rouge\">alignment_output</code> (output of <strong>Map with minimap2</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n            </ul>\n          </li>\n          <li><em>“Histogram”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n        </ul>\n      </li>\n    </ol>\n\n  </blockquote>\n\n</div>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>Inspect the <strong>Samtools coverage</strong> output for <code class=\"language-plaintext highlighter-rouge\">Barcode10</code></p>\n\n  <ol>\n    <li>How well the sample reads covering the reference genome of <em>Salmonella</em>?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>99.65%.</li>\n    </ol>\n  </blockquote>\n</blockquote>\n\n<h2 id=\"consensus-genome-building\">Consensus Genome Building</h2>\n\n<p>For further anaylsis we have included one more step in this section, where we build the full genome of our samples.</p>\n\n<p>This consensus genome can be used later to compare and relate samples together based on their full genome. In cases such as SARS-CoV2, it is important to do so in order to discover new outbreaks. In this example of the training, it is not really important to draw a tree of the full genomes of the samples as <em>Salmonella</em> does not have such a speedy outbreak as SARS-CoV2 does. However, we decided to include it in the workflow for any further analysis of the users, if needed.</p>\n\n<p>For this step we run <a href=\"https://samtools.github.io/bcftools/bcftools.html\"><strong>bcftools consensus</strong></a> (<span class=\"citation\"><a href=\"#Li20092\">Li <i>et al.</i> 2009</a></span>).</p>\n\n<div class=\"Long-Version\">\n\n  <blockquote class=\"hands-on\">\n    <hands-on-title> Consensus Genome Building </hands-on-title>\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/bcftools_consensus/bcftools_consensus/1.15.1+galaxy3\" title=\"bcftools consensus tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>bcftools consensus</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.15.1+galaxy3)</span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“VCF/BCF Data”</em>: collection output of <strong>SnpSift Filter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n          <li><em>“Choose the source for the reference genome”</em>: <code class=\"language-plaintext highlighter-rouge\">Use a genome from the history</code>\n            <ul>\n              <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Reference genome”</em>: <code class=\"language-plaintext highlighter-rouge\">Salmonella_Ref_genome.fna.gz</code></li>\n            </ul>\n          </li>\n        </ul>\n      </li>\n    </ol>\n  </blockquote>\n\n</div>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>Inspect the <strong>bcftools consensus</strong> output for <code class=\"language-plaintext highlighter-rouge\">Barcode11</code></p>\n\n  <ol>\n    <li>How many sequences did we get for the sample? What are they?</li>\n    <li>Why?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>We got 2 sequences: the complete genome and the complete <a href=\"https://www.genome.gov/genetics-glossary/Plasmid\">plasmid</a> genome.</li>\n      <li>The tool uses the reference genome and the variants found to build the consensus genome of the sample, and the reference genome FASTA file we use includes two sequences a complete one and a plasmid complete one. So the tool constructed both sequences for us to choose from, based on our further analysis.</li>\n    </ol>\n  </blockquote>\n</blockquote>\n\n<h1 id=\"pathogen-detection-samples-aggregation-and-visualisation\">Pathogen Detection Samples Aggregation and Visualisation</h1>\n\n<div class=\"Long-Version\">\n\n  <blockquote class=\"comment\">\n    <comment-title></comment-title>\n\n    <p>If you did not get your <strong>Gene-based pathogen identification</strong> section output files needed yet or you got an error for some reason, you can go on and download them all or the ones missing from Zenodo so you can start this workflow, please don’t forget to create the collections for them as explained in the pervious hands-on.</p>\n\n    <blockquote class=\"hands_on\">\n      <hands-on-title>Optional Data upload</hands-on-title>\n\n      <ol>\n        <li>\n          <p>Import all tabular and FASTA files needed for this section via link from <a href=\"https://zenodo.org/record/11222469\">Zenodo</a> to the new created history:</p>\n\n          <div class=\"language-text highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/11222469/files/vfs_of_genes_identified_by_vfdb_barcode10.tabular\nhttps://zenodo.org/record/11222469/files/vfs_of_genes_identified_by_vfdb_barcode11.tabular\nhttps://zenodo.org/record/11222469/files/VFs_Barcode10.tabular\nhttps://zenodo.org/record/11222469/files/VFs_Barcode11.tabular\nhttps://zenodo.org/record/11222469/files/Contigs_Barcode10.fasta\nhttps://zenodo.org/record/11222469/files/Contigs_Barcode11.fasta\n</code></pre></div>          </div>\n\n          <!--SNIPPET-->\n          <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-via-links-1\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-via-links-1\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing via links</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>\n          <p><!--END_SNIPPET--></p>\n        </li>\n      </ol>\n\n    </blockquote>\n  </blockquote>\n\n  <p>In this last section, we would like to show how to aggregate results and use the results to help tracking pathogenes among samples by:</p>\n\n  <ol>\n    <li>Drawing a presence-absence heatmap of the identified <strong>VF</strong> genes within all samples to visualize in which samples these genes can be found.</li>\n    <li>Drawing a <a href=\"https://www.sciencedirect.com/topics/medicine-and-dentistry/phylogenetic-tree\">phylogenetic tree</a> for each pathogenic gene detected, where we will relate the contigs of the samples together where this gene is found.</li>\n  </ol>\n\n  <p>With these two types of visualizations we can have an overview of all samples and the genes, but also how samples are related to each other i.e. which common pathogenic genes they share. Given the time of the sampling and the location one can easily identify using these graphs, where and when the contamination has occurred among the different samples.</p>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title>Organize imported data</hands-on-title>\n\n    <p>Follow these steps only if you imported the datasets, but if your <strong>Gene-based Pathogen Identification</strong> part is already finished correctly then skip the following 3 steps.</p>\n\n    <ol>\n      <li>\n        <p>Create a collection named <code class=\"language-plaintext highlighter-rouge\">VFs</code> with <code class=\"language-plaintext highlighter-rouge\">VFs</code> files</p>\n\n        <!--SNIPPET-->\n        <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-dataset-collection-1\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-dataset-collection-1\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a dataset collection</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on <i class=\"far fa-check-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-selector</span> <strong>Select Items</strong> at the top of the history panel <img src=\"/training-material/topics/galaxy-interface/images/historyItemControls.png\" alt=\"Select Items button\" /></li>   <li>Check all the datasets in your history you would like to include</li>   <li>     <p>Click <strong>n of N selected</strong> and choose <strong>Build Dataset List</strong></p>     <p><img src=\"/training-material/topics/galaxy-interface/images/buildList.png\" alt=\"build list collection menu item\" width=\"15%\" /></p>   </li>   <li>Enter a name for your collection</li>   <li>Click <strong>Create collection</strong> to build your collection</li>   <li>Click on the checkmark icon at the top of your history again</li> </ul> </blockquote>\n        <p><!--END_SNIPPET--></p>\n      </li>\n      <li>\n        <p>Create a collection named <code class=\"language-plaintext highlighter-rouge\">vfs_of_genes_identified_by_vfdb</code> with <code class=\"language-plaintext highlighter-rouge\">vfs_of_genes_identified_by_vfdb</code> files</p>\n      </li>\n      <li>\n        <p>Create a collection named <code class=\"language-plaintext highlighter-rouge\">Contigs</code> with <code class=\"language-plaintext highlighter-rouge\">Contigs</code> files</p>\n      </li>\n    </ol>\n\n  </blockquote>\n</div>\n\n<div class=\"Short-Version\">\n\n  <blockquote class=\"comment\">\n    <comment-title></comment-title>\n\n    <p>If you did not get your <strong>Gene-based pathogen identification</strong> section output files needed yet or you got an error for some reason, you can go on and download them all or the ones missing from Zenodo so you can start this workflow, please don’t forget to create the collections for them as explained in the pervious hands-on. You also need to download and import more tabular files that are generated from the output of <strong>Preprocessing</strong> and <strong>Allele-based pathogen identification</strong>.</p>\n\n    <blockquote class=\"hands_on\">\n      <hands-on-title>Optional Data upload</hands-on-title>\n\n      <ol>\n        <li>\n          <p>Import all tabular and FASTA files needed for this section via link from <a href=\"https://zenodo.org/record/11222469\">Zenodo</a> to the new created history:</p>\n\n          <div class=\"language-text highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/11222469/files/removed_hosts_percentage_tabular.tabular\nhttps://zenodo.org/record/11222469/files/mapping_coverage_percentage_per_sample.tabular\nhttps://zenodo.org/record/11222469/files/mapping_mean_depth_per_sample.tabular\nhttps://zenodo.org/record/11222469/files/number_of_variants_per_sample.tabular\nhttps://zenodo.org/record/11222469/files/amr_identified_by_ncbi_barcode10.tabular\nhttps://zenodo.org/record/11222469/files/amr_identified_by_ncbi_barcode11.tabular\nhttps://zenodo.org/record/11222469/files/vfs_of_genes_identified_by_vfdb_barcode10.tabular\nhttps://zenodo.org/record/11222469/files/vfs_of_genes_identified_by_vfdb_barcode11.tabular\nhttps://zenodo.org/record/11222469/files/VFs_Barcode10.tabular\nhttps://zenodo.org/record/11222469/files/VFs_Barcode11.tabular\nhttps://zenodo.org/record/11222469/files/AMRs_Barcode10.tabular\nhttps://zenodo.org/record/11222469/files/AMRs_Barcode11.tabular\nhttps://zenodo.org/record/11222469/files/Contigs_Barcode10.fasta\nhttps://zenodo.org/record/11222469/files/Contigs_Barcode11.fasta\n</code></pre></div>          </div>\n\n          <!--SNIPPET-->\n          <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-via-links-2\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-via-links-2\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing via links</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>\n          <p><!--END_SNIPPET--></p>\n        </li>\n      </ol>\n\n    </blockquote>\n  </blockquote>\n\n  <p>In this last section, we would like to show how to aggregate results and use the results to help tracking pathogenes among samples by:</p>\n\n  <ol>\n    <li>Drawing a presence-absence heatmap of the identified <strong>VF</strong> genes within all samples to visualize in which samples these genes can be found.</li>\n    <li>Drawing a <a href=\"https://www.sciencedirect.com/topics/medicine-and-dentistry/phylogenetic-tree\">phylogenetic tree</a> for each pathogenic gene detected, where we will relate the contigs of the samples together where this gene is found.</li>\n  </ol>\n\n  <p>With the visualizations types in this workflow, e.g. Heatmaps, Phylogenetic trees and Barplots, we can have an overview of all samples and the genes, but also how samples are related to each other i.e. which common pathogenic genes they share. Given the time of the sampling and the location one can easily identify using these graphs, where and when the contamination has occurred among the different samples.</p>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title>Organize imported data</hands-on-title>\n\n    <p>Follow these steps only if you imported the datasets, but if your <strong>Gene-based Pathogen Identification</strong> part is already finished correctly then skip the following 5 steps.</p>\n\n    <ol>\n      <li>\n        <p>Create a collection named <code class=\"language-plaintext highlighter-rouge\">VFs</code> with <code class=\"language-plaintext highlighter-rouge\">VFs</code> files</p>\n\n        <!--SNIPPET-->\n        <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-dataset-collection-2\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-dataset-collection-2\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a dataset collection</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on <i class=\"far fa-check-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-selector</span> <strong>Select Items</strong> at the top of the history panel <img src=\"/training-material/topics/galaxy-interface/images/historyItemControls.png\" alt=\"Select Items button\" /></li>   <li>Check all the datasets in your history you would like to include</li>   <li>     <p>Click <strong>n of N selected</strong> and choose <strong>Build Dataset List</strong></p>     <p><img src=\"/training-material/topics/galaxy-interface/images/buildList.png\" alt=\"build list collection menu item\" width=\"15%\" /></p>   </li>   <li>Enter a name for your collection</li>   <li>Click <strong>Create collection</strong> to build your collection</li>   <li>Click on the checkmark icon at the top of your history again</li> </ul> </blockquote>\n        <p><!--END_SNIPPET--></p>\n      </li>\n      <li>\n        <p>Create a collection named <code class=\"language-plaintext highlighter-rouge\">vfs_of_genes_identified_by_vfdb</code> with <code class=\"language-plaintext highlighter-rouge\">vfs_of_genes_identified_by_vfdb</code> files</p>\n      </li>\n      <li>\n        <p>Create a collection named <code class=\"language-plaintext highlighter-rouge\">AMRs</code> with <code class=\"language-plaintext highlighter-rouge\">AMRs</code> files</p>\n      </li>\n      <li>\n        <p>Create a collection named <code class=\"language-plaintext highlighter-rouge\">amr_identified_by_ncbi</code> with <code class=\"language-plaintext highlighter-rouge\">amr_identified_by_ncbi</code> files</p>\n      </li>\n      <li>\n        <p>Create a collection named <code class=\"language-plaintext highlighter-rouge\">Contigs</code> with <code class=\"language-plaintext highlighter-rouge\">Contigs</code> files</p>\n      </li>\n    </ol>\n\n  </blockquote>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title>All Samples Analysis</hands-on-title>\n\n    <ol>\n      <li><strong>Import the workflow</strong> into Galaxy\n        <ul>\n          <li>Copy the URL (e.g. via right-click) of <a href=\"/training-material/topics/microbiome/tutorials/pathogen-detection-from-nanopore-foodborne-data/workflows/pathogen_detection_pathoGFAIR_samples_aggregation_and_visualisation.ga\">this workflow</a> or download it to your computer.</li>\n          <li>Import the workflow into Galaxy</li>\n        </ul>\n\n        <!--SNIPPET-->\n        <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-a-workflow-3\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-a-workflow-3\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing a workflow</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on <em>Workflow</em> on the top menu bar of Galaxy. You will see a list of all your workflows.</li>   <li>Click on <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Import</strong> at the top-right of the screen</li>   <li>Provide your workflow     <ul>       <li>Option 1: Paste the URL of the workflow into the box labelled <em>“Archived Workflow URL”</em></li>       <li>Option 2: Upload the workflow file in the box labelled <em>“Archived Workflow File”</em></li>     </ul>   </li>   <li>Click the <strong>Import workflow</strong> button</li> </ul>   <p>Below is a short video demonstrating how to import a workflow from GitHub using this procedure:</p>   <figure> <iframe credentialless=\"\" allowfullscreen=\"\" referrerpolicy=\"no-referrer\" sandbox=\"allow-scripts allow-same-origin\" allow=\"accelerometer 'none'; ambient-light-sensor 'none'; autoplay 'none'; battery 'none'; bluetooth 'none'; browsing-topics 'none'; camera 'none'; ch-ua 'none'; display-capture 'none'; domain-agent 'none'; document-domain 'none'; encrypted-media 'none'; execution-while-not-rendered 'none'; execution-while-out-of-viewport 'none'; gamepad 'none'; geolocation 'none'; gyroscope 'none'; hid 'none'; identity-credentials-get 'none'; idle-detection 'none'; keyboard-map 'none'; local-fonts 'none'; magnetometer 'none'; microphone 'none'; midi 'none'; navigation-override 'none'; otp-credentials 'none'; payment 'none'; picture-in-picture 'none'; publickey-credentials-create 'none'; publickey-credentials-get 'none'; screen-wake-lock 'none'; serial 'none'; speaker-selection 'none'; sync-xhr 'none'; usb 'none'; web-share 'none'; window-management 'none'; xr-spatial-tracking 'none'\" csp=\"sandbox allow-scripts allow-same-origin;\" width=\"560\" height=\"315\" src=\"https://www.youtube-nocookie.com/embed/hoP36Te5wko\" title=\"Importing a workflow from URL\" frameborder=\"0\" loading=\"lazy\"></iframe> <figcaption>   <span class=\"figcaption-prefix\"><strong>Video</strong>:</span> Importing a workflow from URL</figcaption> </figure> </blockquote>\n        <p><!--END_SNIPPET--></p>\n      </li>\n      <li>Run <strong>Workflow 5: Pathogen Detection Samples Aggregation and Visualisation</strong> <i class=\"fas fa-share-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">workflow</span> using the following parameters:\n        <ul>\n          <li><em>“Send results to a new history”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n          <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“Contigs”</em>: collection <code class=\"language-plaintext highlighter-rouge\">Contigs</code> output from the <strong>Gene-based Pathogen Identification</strong> workflow</li>\n          <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“VFs”</em>: collection <code class=\"language-plaintext highlighter-rouge\">VFs</code> output from the <strong>Gene-based Pathogen Identification</strong> workflow</li>\n          <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“AMRs”</em>: collection <code class=\"language-plaintext highlighter-rouge\">AMRs</code> output from the <strong>Gene-based Pathogen Identification</strong> workflow</li>\n          <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“vfs_of_genes_identified_by_vfdb”</em>: collection <code class=\"language-plaintext highlighter-rouge\">vfs_of_genes_identified_by_vfdb</code> output from the <strong>Gene-based Pathogen Identification</strong> workflow</li>\n          <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“amr_identified_by_ncbi”</em>: collection <code class=\"language-plaintext highlighter-rouge\">amr_identified_by_ncbi</code> output from the <strong>Gene-based Pathogen Identification</strong> workflow</li>\n          <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“removed_hosts_percentage_tabular”</em>: tabular <code class=\"language-plaintext highlighter-rouge\">removed_hosts_percentage_tabular</code> output from the <strong>Preprocessing</strong> workflow</li>\n          <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“mapping_coverage_percentage_per_sample”</em>: tabular <code class=\"language-plaintext highlighter-rouge\">mapping_coverage_percentage_per_sample</code> output from the <strong>Allele-based Pathogen Identification</strong> workflow</li>\n          <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“mapping_mean_depth_per_sample”</em>: tabular <code class=\"language-plaintext highlighter-rouge\">mapping_mean_depth_per_sample</code> output from the <strong>Allele-based Pathogen Identification</strong> workflow</li>\n          <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“number_of_variants_per_sample”</em>: tabular <code class=\"language-plaintext highlighter-rouge\">number_of_variants_per_sample</code> output from the <strong>Allele-based Pathogen Identification</strong> workflow</li>\n        </ul>\n\n        <!--SNIPPET-->\n        <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-running-a-workflow-3\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-running-a-workflow-3\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Running a workflow</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on <em>Workflow</em> on the top menu bar of Galaxy. You will see a list of all your workflows.</li>   <li>Click on the <i class=\"fas fa-play\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">workflow-run</span> (<em>Run workflow</em>) button next to your workflow</li>   <li>Configure the workflow as needed</li>   <li>Click the <strong>Run Workflow</strong> button at the top-right of the screen</li>   <li>You may have to refresh your history to see the queued jobs</li> </ul> </blockquote>\n        <p><!--END_SNIPPET--></p>\n      </li>\n    </ol>\n\n  </blockquote>\n\n</div>\n\n<h2 id=\"heatmap\">Heatmap</h2>\n\n<p>A heatmap is one of the visualization techniques that can give you a complete overview of all the samples together and whether or not a certain value exists. In this tutorial, we use the heatmap to visualize all samples aside and check which common bacteria pathogen genes are found in samples and which is only found in one of them.</p>\n\n<p>We use <strong>Heatmap w ggplot</strong> tool along with other tabular manipulating tools to prepare the tabular files.</p>\n\n<div class=\"Long-Version\">\n\n  <ol>\n    <li>\n      <p>Combine VFs accessions for samples into a table and get 0 or 1 for absence / presence</p>\n\n      <blockquote class=\"hands_on\">\n        <hands-on-title> Heatmap </hands-on-title>\n\n        <ol>\n          <li><span class=\"tool\" data-tool=\"Remove beginning1\" title=\"Remove beginning tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Remove beginning</strong></span> with the following parameters:\n            <ul>\n              <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“from”</em>: <code class=\"language-plaintext highlighter-rouge\">vfs_of_genes_identified_by_vfdb</code> collection output of <strong>ABRicate</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> from the <strong>Gene-based Pathogen Identification</strong> section</li>\n            </ul>\n          </li>\n          <li><span class=\"tool\" data-tool=\"Grouping1\" title=\"Group tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Group</strong></span> with the following parameters:\n            <ul>\n              <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Select data”</em>: <code class=\"language-plaintext highlighter-rouge\">out_file1</code> (output of <strong>Remove beginning</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n              <li><em>“Group by column”</em>: <code class=\"language-plaintext highlighter-rouge\">c6</code></li>\n              <li>In <em>“Operation”</em>:\n                <ul>\n                  <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Operation”</em>\n                    <ul>\n                      <li><em>“Type”</em>: <code class=\"language-plaintext highlighter-rouge\">Count</code></li>\n                      <li><em>“On column”</em>: <code class=\"language-plaintext highlighter-rouge\">c6</code></li>\n                    </ul>\n                  </li>\n                </ul>\n              </li>\n            </ul>\n          </li>\n          <li><span class=\"tool\" data-tool=\"__FILTER_EMPTY_DATASETS__\" title=\"Filter empty datasets tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Filter empty datasets</strong></span> with the following parameters:\n            <ul>\n              <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input Collection”</em>: <code class=\"language-plaintext highlighter-rouge\">out_file1</code> (output of <strong>Group</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n            </ul>\n          </li>\n          <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/collection_column_join/collection_column_join/0.0.3\" title=\"Column join tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Column join</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.0.3)</span> with the following parameters:\n            <ul>\n              <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Tabular files”</em>: <code class=\"language-plaintext highlighter-rouge\">output</code> (output of <strong>Filter empty datasets</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n              <li><em>“Fill character”</em>: <code class=\"language-plaintext highlighter-rouge\">0</code></li>\n            </ul>\n          </li>\n          <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/galaxyp/regex_find_replace/regexColumn1/1.0.3\" title=\"Column Regex Find And Replace tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Column Regex Find And Replace</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.0.3)</span> with the following parameters:\n            <ul>\n              <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Select cells from”</em>: <code class=\"language-plaintext highlighter-rouge\">tabular_output</code> (output of <strong>Column join</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n              <li><em>“using column”</em>: <code class=\"language-plaintext highlighter-rouge\">c1</code></li>\n              <li>In <em>“Check”</em>:\n                <ul>\n                  <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Check”</em>\n                    <ul>\n                      <li><em>“Find Regex”</em>: <code class=\"language-plaintext highlighter-rouge\">#KEY</code></li>\n                      <li><em>“Replacement”</em>: <code class=\"language-plaintext highlighter-rouge\">key</code></li>\n                    </ul>\n                  </li>\n                </ul>\n              </li>\n            </ul>\n          </li>\n        </ol>\n      </blockquote>\n    </li>\n    <li>\n      <p>Draw heatmap</p>\n\n      <blockquote class=\"hands-on\">\n        <hands-on-title> Heatmap </hands-on-title>\n        <ol>\n          <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/ggplot2_heatmap/ggplot2_heatmap/3.4.0+galaxy0\" title=\"Heatmap w ggplot tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Heatmap w ggplot</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 3.4.0+galaxy0)</span> with the following parameters:\n            <ul>\n              <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Select table”</em>: <code class=\"language-plaintext highlighter-rouge\">out_file1</code> (output of <strong>Column Regex Find And Replace</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n              <li><em>“Select input dataset options”</em>: <code class=\"language-plaintext highlighter-rouge\">Dataset with header and row names</code>\n                <ul>\n                  <li><em>“Select column, for row names”</em>: <code class=\"language-plaintext highlighter-rouge\">c1</code></li>\n                  <li><em>“Sample names orientation”</em>: <code class=\"language-plaintext highlighter-rouge\">vertial</code></li>\n                </ul>\n              </li>\n              <li><em>“Plot title”</em>: <code class=\"language-plaintext highlighter-rouge\">Pathogeneic Genes Per Samples</code></li>\n              <li>In <em>“Advanced Options”</em>:\n                <ul>\n                  <li><em>“Enable data clustering”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n                </ul>\n              </li>\n              <li>In <em>“Output Options”</em>:\n                <ul>\n                  <li><em>“Unit of output dimensions”</em>: <code class=\"language-plaintext highlighter-rouge\">Centimeters (cm)</code></li>\n                  <li><em>“width of output”</em>: <code class=\"language-plaintext highlighter-rouge\">70.0</code></li>\n                  <li><em>“height of output”</em>: <code class=\"language-plaintext highlighter-rouge\">70.0</code></li>\n                  <li><em>“dpi of output”</em>: <code class=\"language-plaintext highlighter-rouge\">1000.0</code></li>\n                  <li><em>“Additional output format”</em>: <code class=\"language-plaintext highlighter-rouge\">PDF</code></li>\n                </ul>\n              </li>\n            </ul>\n          </li>\n        </ol>\n      </blockquote>\n    </li>\n  </ol>\n\n</div>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>Now let’s see how your heatmap PDF looks like, you can zoom-in and out in your Galaxy history.</p>\n\n  <p><a href=\"./images/heatmap2.png\" rel=\"noopener noreferrer\"><img src=\"./images/heatmap2.png\" alt=\"Heatmap. \" width=\"27559\" height=\"27559\" loading=\"lazy\" /></a></p>\n\n  <ol>\n    <li>Mention three of the common bacterial pathogen genes found in both samples.</li>\n    <li>How can the differences in the found <strong>VF</strong> bacteria pathogen genes between the two samples be interpreted?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>A lot of bacteria pathogen <strong>VF</strong> gene products identified by the <strong>VFDB</strong> are common in both samples, such as: <strong>rfaD</strong>, <strong>ssaN</strong> and <strong>fliQ</strong></li>\n      <li>\n        <p>Both samples were spiked with the same pathogen species, <em>S. enterica</em>, but not the same strain:</p>\n\n        <ul>\n          <li><code class=\"language-plaintext highlighter-rouge\">Barcode10</code> sample is spiked with <em>S. enterica subsp. enterica</em> strain</li>\n          <li><code class=\"language-plaintext highlighter-rouge\">Barcode11</code> sample is spiked with <em>S. enterica subsp. houtenae</em> strain.</li>\n        </ul>\n\n        <p>This can be the main cause of the big similarities and the few differences of the bacteria pathogen <strong>VF</strong> gene products found between both of the two samples.\nOther factors such as the <strong>time</strong> and <strong>location</strong> of the sampling may cause other differences. By knowing the metadata of the samples inputted for the workflows in real life we can understand what actually happened. We can have samples with no pathogen found then we start detecting genes from the 7th or 8th sample, then we can identify where and when the pathogen entered the host, and stop the cause of that</p>\n      </li>\n    </ol>\n\n  </blockquote>\n</blockquote>\n\n<h2 id=\"phylogenetic-tree-building\">Phylogenetic Tree building</h2>\n\n<p>Phylogenetic trees can be used to track the evolution of the pathogen between the samples. Therefore, the VFs are used as a marker gene for the pathogen, similar to 16S marker genes for species profiling. We use the VFs since we know they are associated to the pathogenicity of the sample. By observing the created trees one can identify groups of related pathogens. If additional meta data of the samples would be available one could further identify groups that are associated to specific traits such as increase pathogenicity or faster transmission. Consequently, the tree could be used for phylogenetic placement of unknwon samples.</p>\n\n<p>For the phylogenetic trees, for each bacteria pathogen gene found in the samples we use <strong>ClustalW</strong> (<span class=\"citation\"><a href=\"#Larkin2007\">Larkin <i>et al.</i> 2007</a></span>) for <a href=\"https://www.sciencedirect.com/topics/medicine-and-dentistry/multiple-sequence-alignment\">Multiple Sequence Alignment (MSA)</a> needed before constructing a phylogenetic tree, for the tree itself we use <strong>FASTTREE</strong> and <strong>Newick Display</strong> (<span class=\"citation\"><a href=\"#Dress2008\">Dress <i>et al.</i> 2008</a></span>) to visualize it.</p>\n\n<div class=\"Long-Version\">\n\n  <p>To get the sequence to align, we need to extract the sequences of the VFs in the contigs:</p>\n\n  <blockquote class=\"hands-on\">\n    <hands-on-title> Extract the sequences of the VFs </hands-on-title>\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/nml/collapse_collections/collapse_dataset/5.1.0\" title=\"Collapse Collection tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Collapse Collection</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 5.1.0)</span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“Collection of files to collapse into single dataset”</em>: <code class=\"language-plaintext highlighter-rouge\">Contigs</code></li>\n          <li><em>“Prepend File name”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        </ul>\n      </li>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/nml/collapse_collections/collapse_dataset/5.1.0\" title=\"Collapse Collection tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Collapse Collection</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 5.1.0)</span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“Collection of files to collapse into single dataset”</em>: <code class=\"language-plaintext highlighter-rouge\">VFs</code></li>\n          <li><em>“Keep one header line”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n          <li><em>“Prepend File name”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        </ul>\n      </li>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/split_file_on_column/tp_split_on_column/0.6\" title=\"Split by group tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Split by group</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.6)</span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“File to split”</em>: output of 2nd <strong>Collapse Collection</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n          <li><em>“on column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 13</code></li>\n          <li><em>“Include header in splits?”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        </ul>\n      </li>\n      <li><span class=\"tool\" data-tool=\"Cut1\" title=\"Cut tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Cut</strong></span> with the following parameters:\n        <ul>\n          <li><em>“Cut columns”</em>: <code class=\"language-plaintext highlighter-rouge\">c2,c3,c4</code></li>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“From”</em>: <code class=\"language-plaintext highlighter-rouge\">split_output</code> (output of <strong>Split by group</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        </ul>\n      </li>\n      <li><span class=\"tool\" data-tool=\"Remove beginning1\" title=\"Remove beginning tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Remove beginning</strong></span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“from”</em>: output of <strong>Cut</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n        </ul>\n      </li>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_getfastabed/2.30.0+galaxy1\" title=\"bedtools getfasta tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>bedtools getfasta</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.30.0+galaxy1)</span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“BED/bedGraph/GFF/VCF/EncodePeak file”</em>: <code class=\"language-plaintext highlighter-rouge\">out_file1</code> (output of <strong>Remove beginning</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n          <li><em>“Choose the source for the FASTA file”</em>: <code class=\"language-plaintext highlighter-rouge\">History</code>\n            <ul>\n              <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“FASTA file”</em>: <code class=\"language-plaintext highlighter-rouge\">output</code> (output of 1st <strong>Collapse Collection</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n            </ul>\n          </li>\n        </ul>\n      </li>\n    </ol>\n\n  </blockquote>\n\n  <p>We can now run multiple sequence alignment, build the trees for each VF and display them.</p>\n\n  <blockquote class=\"hands-on\">\n    <hands-on-title> Phylogenetic Tree building </hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/devteam/clustalw/clustalw/2.1+galaxy1\" title=\"ClustalW tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>ClustalW</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.1+galaxy1)</span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“FASTA file”</em>: output of <strong>bedtools getfasta</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n          <li><em>“Data type”</em>: <code class=\"language-plaintext highlighter-rouge\">DNA nucleotide sequences</code></li>\n          <li><em>“Output alignment format”</em>: <code class=\"language-plaintext highlighter-rouge\">FASTA format</code></li>\n          <li><em>“Output complete alignment (or specify part to output)”</em>: <code class=\"language-plaintext highlighter-rouge\">Complete alignment</code></li>\n        </ul>\n      </li>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/fasttree/fasttree/2.1.10+galaxy1\" title=\"FASTTREE tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>FASTTREE</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.1.10+galaxy1)</span> with the following parameters:\n        <ul>\n          <li><em>“Aligned sequences file (FASTA or Phylip format)”</em>: <code class=\"language-plaintext highlighter-rouge\">fasta</code>\n            <ul>\n              <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“FASTA file”</em>: output of <strong>ClustalW</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n              <li><em>“Set starting tree(s)”</em>: <code class=\"language-plaintext highlighter-rouge\">No starting trees</code></li>\n            </ul>\n          </li>\n          <li><em>“Protein or nucleotide alignment”</em>: <code class=\"language-plaintext highlighter-rouge\">Nucleotide</code></li>\n        </ul>\n      </li>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/newick_utils/newick_display/1.6+galaxy1\" title=\"Newick Display tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Newick Display</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.6+galaxy1)</span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Newick file”</em>: output of <strong>FASTTREE</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n          <li><em>“Branch support”</em>: <code class=\"language-plaintext highlighter-rouge\">Hide branch support</code></li>\n          <li><em>“Branch length”</em>: <code class=\"language-plaintext highlighter-rouge\">Hide branch length</code></li>\n          <li><em>“Image width”</em>: <code class=\"language-plaintext highlighter-rouge\">2000</code></li>\n        </ul>\n      </li>\n    </ol>\n  </blockquote>\n\n</div>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>Now let’s see how your trees for the bacteria pathogen gene with accession IDs: <strong>AAF37887</strong> and <strong>NP_459543</strong> look like. To access that go to the output of Newick</p>\n\n  <ol>\n    <li>In which samples and contigs is gene <strong>AAF37887</strong> found?</li>\n    <li>In which samples and contigs is gene <strong>NP_459543</strong> found?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>\n        <p>In the <code class=\"language-plaintext highlighter-rouge\">Barcode10</code>: Contig 149 and <code class=\"language-plaintext highlighter-rouge\">Barcode11</code>: Contig 4</p>\n\n        <p><a href=\"./images/AAF37887_tree.png\" rel=\"noopener noreferrer\"><img src=\"./images/AAF37887_tree.png\" alt=\"AAF37887_tree. \" width=\"1184\" height=\"136\" loading=\"lazy\" /></a></p>\n      </li>\n      <li>\n        <p>In the <code class=\"language-plaintext highlighter-rouge\">Barcode10</code>: Contig 91 and <code class=\"language-plaintext highlighter-rouge\">Barcode11</code>: Contig 4</p>\n\n        <p><a href=\"./images/NP_459543_tree.png\" rel=\"noopener noreferrer\"><img src=\"./images/NP_459543_tree.png\" alt=\"NP_459543_tree. \" width=\"1184\" height=\"136\" loading=\"lazy\" /></a></p>\n      </li>\n    </ol>\n\n  </blockquote>\n</blockquote>\n\n<h1 id=\"conclusion\">Conclusion</h1>\n\n<p>In this tutorial, we have tried the workflow designed to detect and track pathogens in our food and drinks. Through out the full workflow we used our Nanopore sequenced datasets from Biolytix and analyzed it, found the pathogens and tracked it. This approach can be summarized with the following scheme:</p>\n\n<figure id=\"figure-1\" style=\"max-width: 90%;\"><img src=\"./images/FoodBorne-Workflow-updated.png\" alt=\"Foodborne full workflow big picture. \" width=\"1360\" height=\"1808\" loading=\"lazy\" /><a target=\"_blank\" href=\"./images/FoodBorne-Workflow-updated.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 1</strong>:</span> The complete picture of the workflow used in this training highlighting, not all, but the most important steps done in 5 sub-workflows explained in the training</figcaption></figure>\n\n"],"ref_slides":[],"hands_on":true,"slides":false,"mod_date":"2024-06-19 21:47:55 +0000","pub_date":"2023-01-26 15:01:44 +0000","version":18,"workflows":[{"workflow":"allele_based_pathogen_identification.ga","tests":true,"url":"https://training.galaxyproject.org/training-material/topics/microbiome/tutorials/pathogen-detection-from-nanopore-foodborne-data/workflows/allele_based_pathogen_identification.ga","path":"topics/microbiome/tutorials/pathogen-detection-from-nanopore-foodborne-data/workflows/allele_based_pathogen_identification.ga","wfid":"microbiome-pathogen-detection-from-nanopore-foodborne-data","wfname":"allele_based_pathogen_identification","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/microbiome-pathogen-detection-from-nanopore-foodborne-data/versions/allele_based_pathogen_identification","license":"MIT","creators":[{"class":"Person","identifier":"0000-0001-9047-4215","name":"Engy Nasr","url":"https://orcid.org/0000-0001-9047-4215"},{"class":"Person","identifier":"0000-0001-9852-1987","name":"Bérénice Batut","url":"https://orcid.org/0000-0001-9852-1987"},{"class":"Person","identifier":"0000-0003-2982-388X","name":"Paul Zierep"}],"name":"Allele-based Pathogen Identification","title":"Allele-based Pathogen Identification","test_results":null,"modified":"2024-06-23 00:06:09 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Collection\\ncollection_of_preprocessed_samples\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"ℹ️ Input Parameter\\nsamples_profile\"];\n  style 1 fill:#ded,stroke:#393,stroke-width:4px;\n  2[\"ℹ️ Input Dataset\\nreference_genome_of_tested_strain\"];\n  style 2 stroke:#2c3143,stroke-width:4px;\n  3[\"Convert compressed file to uncompressed.\"];\n  2 -->|output| 3;\n  9d6bde4a-7180-4097-9ffd-6992111a617c[\"Output\\ndecompressed_rg_file\"];\n  3 --> 9d6bde4a-7180-4097-9ffd-6992111a617c;\n  style 9d6bde4a-7180-4097-9ffd-6992111a617c stroke:#2c3143,stroke-width:4px;\n  4[\"Map with minimap2\"];\n  1 -->|output| 4;\n  0 -->|output| 4;\n  3 -->|output1| 4;\n  31779c23-4f26-418e-9418-2551e883dbe7[\"Output\\nmap_with_minimap2\"];\n  4 --> 31779c23-4f26-418e-9418-2551e883dbe7;\n  style 31779c23-4f26-418e-9418-2551e883dbe7 stroke:#2c3143,stroke-width:4px;\n  5[\"Clair3\"];\n  4 -->|alignment_output| 5;\n  3 -->|output1| 5;\n  1cf1ee6c-4cb7-45e3-9c7b-88a1b678dd53[\"Output\\nclair3_pileup_vcf\"];\n  5 --> 1cf1ee6c-4cb7-45e3-9c7b-88a1b678dd53;\n  style 1cf1ee6c-4cb7-45e3-9c7b-88a1b678dd53 stroke:#2c3143,stroke-width:4px;\n  987f9145-83ab-44f1-801a-b0d527ecbce8[\"Output\\nclair3_full_alignment_vcf\"];\n  5 --> 987f9145-83ab-44f1-801a-b0d527ecbce8;\n  style 987f9145-83ab-44f1-801a-b0d527ecbce8 stroke:#2c3143,stroke-width:4px;\n  fab82215-f59a-43b1-92d7-37629a1fdb65[\"Output\\nclair3_merged_output\"];\n  5 --> fab82215-f59a-43b1-92d7-37629a1fdb65;\n  style fab82215-f59a-43b1-92d7-37629a1fdb65 stroke:#2c3143,stroke-width:4px;\n  6[\"Samtools depth\"];\n  4 -->|alignment_output| 6;\n  7[\"Samtools coverage\"];\n  4 -->|alignment_output| 7;\n  8[\"bcftools norm\"];\n  5 -->|merge_output| 8;\n  3 -->|output1| 8;\n  22553aa1-f5db-4d37-87c4-1164dbb3d2d5[\"Output\\nnormalized_vcf_output\"];\n  8 --> 22553aa1-f5db-4d37-87c4-1164dbb3d2d5;\n  style 22553aa1-f5db-4d37-87c4-1164dbb3d2d5 stroke:#2c3143,stroke-width:4px;\n  9[\"Advanced Cut\"];\n  6 -->|output| 9;\n  10[\"Remove beginning\"];\n  7 -->|output| 10;\n  11[\"SnpSift Filter\"];\n  8 -->|output_file| 11;\n  3e7981ec-2205-4571-93eb-10c0dd14b288[\"Output\\nquality_filtered_vcf_output\"];\n  11 --> 3e7981ec-2205-4571-93eb-10c0dd14b288;\n  style 3e7981ec-2205-4571-93eb-10c0dd14b288 stroke:#2c3143,stroke-width:4px;\n  12[\"Table Compute\"];\n  9 -->|output| 12;\n  13[\"Cut\"];\n  10 -->|out_file1| 13;\n  14[\"SnpSift Extract Fields\"];\n  11 -->|output| 14;\n  1b0f4f2c-4717-45be-b580-fe10cba78c35[\"Output\\nextracted_fields_from_the_vcf_output\"];\n  14 --> 1b0f4f2c-4717-45be-b580-fe10cba78c35;\n  style 1b0f4f2c-4717-45be-b580-fe10cba78c35 stroke:#2c3143,stroke-width:4px;\n  15[\"bcftools consensus\"];\n  11 -->|output| 15;\n  3 -->|output1| 15;\n  49497f3c-9332-4924-bcfd-cb71788ad2c2[\"Output\\nbcftools_consensus\"];\n  15 --> 49497f3c-9332-4924-bcfd-cb71788ad2c2;\n  style 49497f3c-9332-4924-bcfd-cb71788ad2c2 stroke:#2c3143,stroke-width:4px;\n  16[\"Select first\"];\n  13 -->|out_file1| 16;\n  17[\"Remove beginning\"];\n  14 -->|output| 17;\n  18[\"Collapse Collection\"];\n  16 -->|outfile| 18;\n  5ee1c158-1a85-45ca-9abd-b30632b3092c[\"Output\\nmapping_coverage_percentage_per_sample\"];\n  18 --> 5ee1c158-1a85-45ca-9abd-b30632b3092c;\n  style 5ee1c158-1a85-45ca-9abd-b30632b3092c stroke:#2c3143,stroke-width:4px;\n  19[\"Count\"];\n  17 -->|out_file1| 19;\n  20[\"Advanced Cut\"];\n  18 -->|output| 20;\n  21[\"Cut\"];\n  19 -->|out_file1| 21;\n  22[\"Paste\"];\n  20 -->|output| 22;\n  12 -->|table| 22;\n  25b7b87b-5ef1-487f-90cc-81351a2f81ce[\"Output\\nmapping_mean_depth_per_sample\"];\n  22 --> 25b7b87b-5ef1-487f-90cc-81351a2f81ce;\n  style 25b7b87b-5ef1-487f-90cc-81351a2f81ce stroke:#2c3143,stroke-width:4px;\n  23[\"Select first\"];\n  21 -->|out_file1| 23;\n  24[\"Collapse Collection\"];\n  23 -->|outfile| 24;\n  25[\"Column Regex Find And Replace\"];\n  24 -->|output| 25;\n  2852c4ee-24ea-4df7-b59e-54eb6e2f470b[\"Output\\nnumber_of_variants_per_sample\"];\n  25 --> 2852c4ee-24ea-4df7-b59e-54eb6e2f470b;\n  style 2852c4ee-24ea-4df7-b59e-54eb6e2f470b stroke:#2c3143,stroke-width:4px;"},{"workflow":"gene_based_pathogen_identification.ga","tests":true,"url":"https://training.galaxyproject.org/training-material/topics/microbiome/tutorials/pathogen-detection-from-nanopore-foodborne-data/workflows/gene_based_pathogen_identification.ga","path":"topics/microbiome/tutorials/pathogen-detection-from-nanopore-foodborne-data/workflows/gene_based_pathogen_identification.ga","wfid":"microbiome-pathogen-detection-from-nanopore-foodborne-data","wfname":"gene_based_pathogen_identification","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/microbiome-pathogen-detection-from-nanopore-foodborne-data/versions/gene_based_pathogen_identification","license":"MIT","creators":[{"class":"Person","identifier":"0000-0001-9047-4215","name":"Engy Nasr","url":"https://orcid.org/0000-0001-9047-4215"},{"class":"Person","identifier":"0000-0001-9852-1987","name":"Bérénice Batut","url":"https://orcid.org/0000-0001-9852-1987"},{"class":"Person","identifier":"0000-0003-2982-388X","name":"Paul Zierep"}],"name":"Gene-based Pathogen Identification","title":"Gene-based Pathogen Identification","test_results":null,"modified":"2024-06-23 00:06:09 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Collection\\ncollection_of_preprocessed_samples\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"Extract element identifiers\"];\n  0 -->|output| 1;\n  d82a93c6-23a9-4f85-879c-ecd759a31087[\"Output\\nextracted_samples_IDs\"];\n  1 --> d82a93c6-23a9-4f85-879c-ecd759a31087;\n  style d82a93c6-23a9-4f85-879c-ecd759a31087 stroke:#2c3143,stroke-width:4px;\n  2[\"Build list\"];\n  0 -->|output| 2;\n  f5b5b256-8ddf-4da8-8111-b1f6d3025a0d[\"Output\\nlist_of_lists_of_preprocessed_samples\"];\n  2 --> f5b5b256-8ddf-4da8-8111-b1f6d3025a0d;\n  style f5b5b256-8ddf-4da8-8111-b1f6d3025a0d stroke:#2c3143,stroke-width:4px;\n  3[\"Split file\"];\n  1 -->|output| 3;\n  eb5317bd-4bad-4cad-9219-3ac379221d6e[\"Output\\nsplitted_extracted_samples_IDs\"];\n  3 --> eb5317bd-4bad-4cad-9219-3ac379221d6e;\n  style eb5317bd-4bad-4cad-9219-3ac379221d6e stroke:#2c3143,stroke-width:4px;\n  4[\"Flye\"];\n  2 -->|output| 4;\n  ff0d8c7b-2ac7-4c6d-a110-f71418dad938[\"Output\\nflye_consensus_fasta\"];\n  4 --> ff0d8c7b-2ac7-4c6d-a110-f71418dad938;\n  style ff0d8c7b-2ac7-4c6d-a110-f71418dad938 stroke:#2c3143,stroke-width:4px;\n  2385436f-fbe8-4d77-a40b-27a097d02941[\"Output\\nflye_assembly_graph\"];\n  4 --> 2385436f-fbe8-4d77-a40b-27a097d02941;\n  style 2385436f-fbe8-4d77-a40b-27a097d02941 stroke:#2c3143,stroke-width:4px;\n  0e42ce51-c46b-45d8-baa4-45c0e98ac712[\"Output\\nflye_assembly_gfa\"];\n  4 --> 0e42ce51-c46b-45d8-baa4-45c0e98ac712;\n  style 0e42ce51-c46b-45d8-baa4-45c0e98ac712 stroke:#2c3143,stroke-width:4px;\n  3f297aed-7cee-4999-bbf4-69d84de6b64f[\"Output\\nflye_assembly_info_tabular\"];\n  4 --> 3f297aed-7cee-4999-bbf4-69d84de6b64f;\n  style 3f297aed-7cee-4999-bbf4-69d84de6b64f stroke:#2c3143,stroke-width:4px;\n  5[\"Parse parameter value\"];\n  3 -->|list_output_txt| 5;\n  3608e170-c462-42a2-8003-f3f65baa3834[\"Output\\nparsed_extracted_samples_IDs_to_text\"];\n  5 --> 3608e170-c462-42a2-8003-f3f65baa3834;\n  style 3608e170-c462-42a2-8003-f3f65baa3834 stroke:#2c3143,stroke-width:4px;\n  6[\"medaka consensus pipeline\"];\n  4 -->|consensus| 6;\n  0 -->|output| 6;\n  9e5ad6ec-b408-4132-ba07-dec9fa626923[\"Output\\nmedaka_gaps_in_draft_bed_file\"];\n  6 --> 9e5ad6ec-b408-4132-ba07-dec9fa626923;\n  style 9e5ad6ec-b408-4132-ba07-dec9fa626923 stroke:#2c3143,stroke-width:4px;\n  fcbd3e3f-2e93-4798-b696-dad7db9f2efd[\"Output\\nmedaka_log_file\"];\n  6 --> fcbd3e3f-2e93-4798-b696-dad7db9f2efd;\n  style fcbd3e3f-2e93-4798-b696-dad7db9f2efd stroke:#2c3143,stroke-width:4px;\n  60656aac-ad2a-4c9b-9a68-b9fb18ae5595[\"Output\\nmedaka_propability_h5_file\"];\n  6 --> 60656aac-ad2a-4c9b-9a68-b9fb18ae5595;\n  style 60656aac-ad2a-4c9b-9a68-b9fb18ae5595 stroke:#2c3143,stroke-width:4px;\n  c790d434-8e78-4df0-a0d4-8f9da0692158[\"Output\\nmedaka_calls_of_draft_bam_file\"];\n  6 --> c790d434-8e78-4df0-a0d4-8f9da0692158;\n  style c790d434-8e78-4df0-a0d4-8f9da0692158 stroke:#2c3143,stroke-width:4px;\n  df361e19-b6d1-405b-96cc-b48c1ab7c604[\"Output\\nsample_all_contigs\"];\n  6 --> df361e19-b6d1-405b-96cc-b48c1ab7c604;\n  style df361e19-b6d1-405b-96cc-b48c1ab7c604 stroke:#2c3143,stroke-width:4px;\n  7[\"Bandage Image\"];\n  4 -->|assembly_gfa| 7;\n  9612a851-1f94-4d54-b001-5d082bcc9055[\"Output\\nbandage_assembly_graph_image\"];\n  7 --> 9612a851-1f94-4d54-b001-5d082bcc9055;\n  style 9612a851-1f94-4d54-b001-5d082bcc9055 stroke:#2c3143,stroke-width:4px;\n  8[\"Compose text parameter value\"];\n  5 -->|text_param| 8;\n  9[\"FASTA-to-Tabular\"];\n  6 -->|out_consensus| 9;\n  de06c362-5b0a-4c29-956e-fbf02539789a[\"Output\\nsample_specific_contigs_tabular_file_preparation\"];\n  9 --> de06c362-5b0a-4c29-956e-fbf02539789a;\n  style de06c362-5b0a-4c29-956e-fbf02539789a stroke:#2c3143,stroke-width:4px;\n  10[\"ABRicate\"];\n  6 -->|out_consensus| 10;\n  8f227fc7-2d92-4c6f-af64-e841c1315b4f[\"Output\\nabricate_with_vfdb_to_identify_genes_with_VFs\"];\n  10 --> 8f227fc7-2d92-4c6f-af64-e841c1315b4f;\n  style 8f227fc7-2d92-4c6f-af64-e841c1315b4f stroke:#2c3143,stroke-width:4px;\n  11[\"ABRicate\"];\n  6 -->|out_consensus| 11;\n  fa021d98-d885-4834-ac62-f30d5792260e[\"Output\\nabricate_report_using_ncbi_database_to_indentify_amr\"];\n  11 --> fa021d98-d885-4834-ac62-f30d5792260e;\n  style fa021d98-d885-4834-ac62-f30d5792260e stroke:#2c3143,stroke-width:4px;\n  12[\"Replace\"];\n  8 -->|out1| 12;\n  9 -->|output| 12;\n  174cb2c3-ed28-453c-8afb-85150e0b51ad[\"Output\\nsample_specific_contigs_tabular_file\"];\n  12 --> 174cb2c3-ed28-453c-8afb-85150e0b51ad;\n  style 174cb2c3-ed28-453c-8afb-85150e0b51ad stroke:#2c3143,stroke-width:4px;\n  13[\"Replace\"];\n  8 -->|out1| 13;\n  10 -->|report| 13;\n  19e56e00-6eef-4a4e-9cc6-d93dbf9420ad[\"Output\\nvfs\"];\n  13 --> 19e56e00-6eef-4a4e-9cc6-d93dbf9420ad;\n  style 19e56e00-6eef-4a4e-9cc6-d93dbf9420ad stroke:#2c3143,stroke-width:4px;\n  14[\"Replace\"];\n  8 -->|out1| 14;\n  11 -->|report| 14;\n  a8eb74a5-362b-4f0f-a944-672e27981a41[\"Output\\namrs\"];\n  14 --> a8eb74a5-362b-4f0f-a944-672e27981a41;\n  style a8eb74a5-362b-4f0f-a944-672e27981a41 stroke:#2c3143,stroke-width:4px;\n  15[\"Tabular-to-FASTA\"];\n  12 -->|outfile| 15;\n  a5bb1cbe-1bde-49a1-ad86-6d57b1319fbe[\"Output\\ncontigs\"];\n  15 --> a5bb1cbe-1bde-49a1-ad86-6d57b1319fbe;\n  style a5bb1cbe-1bde-49a1-ad86-6d57b1319fbe stroke:#2c3143,stroke-width:4px;"},{"workflow":"nanopore_preprocessing.ga","tests":true,"url":"https://training.galaxyproject.org/training-material/topics/microbiome/tutorials/pathogen-detection-from-nanopore-foodborne-data/workflows/nanopore_preprocessing.ga","path":"topics/microbiome/tutorials/pathogen-detection-from-nanopore-foodborne-data/workflows/nanopore_preprocessing.ga","wfid":"microbiome-pathogen-detection-from-nanopore-foodborne-data","wfname":"nanopore_preprocessing","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/microbiome-pathogen-detection-from-nanopore-foodborne-data/versions/nanopore_preprocessing","license":"MIT","creators":[{"class":"Person","identifier":"0000-0001-9852-1987","name":"Bérénice Batut","url":"https://orcid.org/0000-0001-9852-1987"},{"class":"Person","identifier":"0000-0001-9047-4215","name":"Engy Nasr","url":"https://orcid.org/0000-0001-9047-4215"},{"class":"Person","identifier":"0000-0003-2982-388X","name":"Paul Zierep"}],"name":"Nanopore Preprocessing","title":"Nanopore Preprocessing","test_results":null,"modified":"2024-06-23 00:06:09 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Parameter\\nsamples_profile\"];\n  style 0 fill:#ded,stroke:#393,stroke-width:4px;\n  1[\"ℹ️ Input Collection\\ncollection_of_all_samples\"];\n  style 1 stroke:#2c3143,stroke-width:4px;\n  2[\"Porechop\"];\n  1 -->|output| 2;\n  34ea26db-11cb-41ee-85c3-75af8a53a2c0[\"Output\\nporechop_output_trimmed_reads\"];\n  2 --> 34ea26db-11cb-41ee-85c3-75af8a53a2c0;\n  style 34ea26db-11cb-41ee-85c3-75af8a53a2c0 stroke:#2c3143,stroke-width:4px;\n  3[\"NanoPlot\"];\n  1 -->|output| 3;\n  15ecf5b1-e0eb-405a-ac3a-359feb66d4cd[\"Output\\nnanoplot_qc_on_reads_before_preprocessing_nanostats\"];\n  3 --> 15ecf5b1-e0eb-405a-ac3a-359feb66d4cd;\n  style 15ecf5b1-e0eb-405a-ac3a-359feb66d4cd stroke:#2c3143,stroke-width:4px;\n  304110f9-60d0-4ba2-8b3b-fae0e2a49554[\"Output\\nnanoplot_on_reads_before_preprocessing_nanostats_post_filtering\"];\n  3 --> 304110f9-60d0-4ba2-8b3b-fae0e2a49554;\n  style 304110f9-60d0-4ba2-8b3b-fae0e2a49554 stroke:#2c3143,stroke-width:4px;\n  f2bd0a1f-cd60-4a36-a7d0-8025cc19ea2e[\"Output\\nnanoplot_qc_on_reads_before_preprocessing_html_report\"];\n  3 --> f2bd0a1f-cd60-4a36-a7d0-8025cc19ea2e;\n  style f2bd0a1f-cd60-4a36-a7d0-8025cc19ea2e stroke:#2c3143,stroke-width:4px;\n  4[\"FastQC\"];\n  1 -->|output| 4;\n  d0a64624-05d0-4068-835b-a025fc011760[\"Output\\nfastqc_quality_check_before_preprocessing_html_file\"];\n  4 --> d0a64624-05d0-4068-835b-a025fc011760;\n  style d0a64624-05d0-4068-835b-a025fc011760 stroke:#2c3143,stroke-width:4px;\n  e61fef5d-1bc8-4c8e-be6a-f74e210e9920[\"Output\\nfastqc_quality_check_before_preprocessing_text_file\"];\n  4 --> e61fef5d-1bc8-4c8e-be6a-f74e210e9920;\n  style e61fef5d-1bc8-4c8e-be6a-f74e210e9920 stroke:#2c3143,stroke-width:4px;\n  5[\"fastp\"];\n  2 -->|outfile| 5;\n  a2219483-50b7-4aed-98dd-333ad2e12eb8[\"Output\\nnanopore_sequenced_reads_processed_with_fastp_after_host_removal\"];\n  5 --> a2219483-50b7-4aed-98dd-333ad2e12eb8;\n  style a2219483-50b7-4aed-98dd-333ad2e12eb8 stroke:#2c3143,stroke-width:4px;\n  2a9a8b4d-458b-40e7-9a21-fb7108d5bbe4[\"Output\\nnanopore_sequenced_reads_processed_with_fastp_after_host_removal_html_report\"];\n  5 --> 2a9a8b4d-458b-40e7-9a21-fb7108d5bbe4;\n  style 2a9a8b4d-458b-40e7-9a21-fb7108d5bbe4 stroke:#2c3143,stroke-width:4px;\n  6[\"MultiQC\"];\n  4 -->|text_file| 6;\n  ebffe782-a56c-431f-8af4-c0cb8d7a02fc[\"Output\\nmultiQC_stats_before_preprocessing\"];\n  6 --> ebffe782-a56c-431f-8af4-c0cb8d7a02fc;\n  style ebffe782-a56c-431f-8af4-c0cb8d7a02fc stroke:#2c3143,stroke-width:4px;\n  0f92196d-047d-4918-819d-c0ff7cd3ae85[\"Output\\nmultiQC_html_report_before_preprocessing\"];\n  6 --> 0f92196d-047d-4918-819d-c0ff7cd3ae85;\n  style 0f92196d-047d-4918-819d-c0ff7cd3ae85 stroke:#2c3143,stroke-width:4px;\n  7[\"Map with minimap2\"];\n  0 -->|output| 7;\n  5 -->|out1| 7;\n  9d7bb3b7-09a1-401f-a132-bb35a53375ea[\"Output\\nbam_map_to_host\"];\n  7 --> 9d7bb3b7-09a1-401f-a132-bb35a53375ea;\n  style 9d7bb3b7-09a1-401f-a132-bb35a53375ea stroke:#2c3143,stroke-width:4px;\n  8[\"NanoPlot\"];\n  5 -->|out1| 8;\n  b5899290-4c57-4662-ad22-860654652ade[\"Output\\nnanoplot_qc_on_reads_after_preprocessing_html_report\"];\n  8 --> b5899290-4c57-4662-ad22-860654652ade;\n  style b5899290-4c57-4662-ad22-860654652ade stroke:#2c3143,stroke-width:4px;\n  949bfdf5-3d79-4dad-bdd8-c3a25e6af4cf[\"Output\\nnanoplot_on_reads_after_preprocessing_nanostats_post_filtering\"];\n  8 --> 949bfdf5-3d79-4dad-bdd8-c3a25e6af4cf;\n  style 949bfdf5-3d79-4dad-bdd8-c3a25e6af4cf stroke:#2c3143,stroke-width:4px;\n  42db7f93-919e-4bbb-81a1-06411a9da410[\"Output\\nnanoplot_qc_on_reads_after_preprocessing_nanostats\"];\n  8 --> 42db7f93-919e-4bbb-81a1-06411a9da410;\n  style 42db7f93-919e-4bbb-81a1-06411a9da410 stroke:#2c3143,stroke-width:4px;\n  9[\"FastQC\"];\n  5 -->|out1| 9;\n  09306471-afa0-4106-9cc7-259b93dfc862[\"Output\\nfastqc_quality_check_after_preprocessing_text_file\"];\n  9 --> 09306471-afa0-4106-9cc7-259b93dfc862;\n  style 09306471-afa0-4106-9cc7-259b93dfc862 stroke:#2c3143,stroke-width:4px;\n  084f982f-20f1-457e-8012-91ebbb85633d[\"Output\\nfastqc_quality_check_after_preprocessing_html_file\"];\n  9 --> 084f982f-20f1-457e-8012-91ebbb85633d;\n  style 084f982f-20f1-457e-8012-91ebbb85633d stroke:#2c3143,stroke-width:4px;\n  10[\"Split BAM by reads mapping status\"];\n  7 -->|alignment_output| 10;\n  14a53fe2-f296-43aa-86b7-243278c1050c[\"Output\\nnon_host_sequences_bam\"];\n  10 --> 14a53fe2-f296-43aa-86b7-243278c1050c;\n  style 14a53fe2-f296-43aa-86b7-243278c1050c stroke:#2c3143,stroke-width:4px;\n  3b1e626f-6bc1-484c-be01-366534361b73[\"Output\\nhost_sequences_bam\"];\n  10 --> 3b1e626f-6bc1-484c-be01-366534361b73;\n  style 3b1e626f-6bc1-484c-be01-366534361b73 stroke:#2c3143,stroke-width:4px;\n  11[\"Select\"];\n  9 -->|text_file| 11;\n  a809853b-119f-44d2-986b-8d2006439fbe[\"Output\\ntotal_sequences_before_hosts_sequences_removal\"];\n  11 --> a809853b-119f-44d2-986b-8d2006439fbe;\n  style a809853b-119f-44d2-986b-8d2006439fbe stroke:#2c3143,stroke-width:4px;\n  12[\"Samtools fastx\"];\n  10 -->|mapped| 12;\n  10d4eaec-81d8-444e-8075-7b77a1fb6870[\"Output\\nhost_sequences_fastq\"];\n  12 --> 10d4eaec-81d8-444e-8075-7b77a1fb6870;\n  style 10d4eaec-81d8-444e-8075-7b77a1fb6870 stroke:#2c3143,stroke-width:4px;\n  13[\"Samtools fastx\"];\n  10 -->|unmapped| 13;\n  0c2dd74d-ac4f-45cf-839c-50386a7ece28[\"Output\\nnon_host_sequences_fastq\"];\n  13 --> 0c2dd74d-ac4f-45cf-839c-50386a7ece28;\n  style 0c2dd74d-ac4f-45cf-839c-50386a7ece28 stroke:#2c3143,stroke-width:4px;\n  14[\"Collapse Collection\"];\n  11 -->|out_file1| 14;\n  15[\"Filter failed datasets\"];\n  12 -->|output| 15;\n  16[\"Kraken2\"];\n  13 -->|output| 16;\n  203d303e-8f3a-4242-971f-b345842ebdb8[\"Output\\nkraken2_with_kalamri_database_output\"];\n  16 --> 203d303e-8f3a-4242-971f-b345842ebdb8;\n  style 203d303e-8f3a-4242-971f-b345842ebdb8 stroke:#2c3143,stroke-width:4px;\n  843afd4d-23a8-46e7-b945-8b67dd7ae341[\"Output\\nkraken2_with_kalamri_database_report\"];\n  16 --> 843afd4d-23a8-46e7-b945-8b67dd7ae341;\n  style 843afd4d-23a8-46e7-b945-8b67dd7ae341 stroke:#2c3143,stroke-width:4px;\n  17[\"Cut\"];\n  14 -->|output| 17;\n  d07be9f1-d250-4008-91ee-59a68521eb56[\"Output\\nquality_retained_all_reads\"];\n  17 --> d07be9f1-d250-4008-91ee-59a68521eb56;\n  style d07be9f1-d250-4008-91ee-59a68521eb56 stroke:#2c3143,stroke-width:4px;\n  18[\"FastQC\"];\n  15 -->|output| 18;\n  b0ee6e31-0eb1-437d-8c04-fc3640b9a0b7[\"Output\\nhosts_qc_text_file\"];\n  18 --> b0ee6e31-0eb1-437d-8c04-fc3640b9a0b7;\n  style b0ee6e31-0eb1-437d-8c04-fc3640b9a0b7 stroke:#2c3143,stroke-width:4px;\n  b72ff57b-0921-43bf-a817-6cd444c8f3cb[\"Output\\nhosts_qc_html\"];\n  18 --> b72ff57b-0921-43bf-a817-6cd444c8f3cb;\n  style b72ff57b-0921-43bf-a817-6cd444c8f3cb stroke:#2c3143,stroke-width:4px;\n  19[\"Krakentools: Extract Kraken Reads By ID\"];\n  5 -->|out1| 19;\n  16 -->|report_output| 19;\n  16 -->|output| 19;\n  57e3b725-8e13-40b2-9acc-31fd56ebc80a[\"Output\\ncollection_of_preprocessed_samples\"];\n  19 --> 57e3b725-8e13-40b2-9acc-31fd56ebc80a;\n  style 57e3b725-8e13-40b2-9acc-31fd56ebc80a stroke:#2c3143,stroke-width:4px;\n  20[\"Select\"];\n  18 -->|text_file| 20;\n  3ba35c71-32f0-4741-98d4-ea8522e27500[\"Output\\ntotal_sequences_after_hosts_sequences_removal\"];\n  20 --> 3ba35c71-32f0-4741-98d4-ea8522e27500;\n  style 3ba35c71-32f0-4741-98d4-ea8522e27500 stroke:#2c3143,stroke-width:4px;\n  21[\"Collapse Collection\"];\n  20 -->|out_file1| 21;\n  22[\"Cut\"];\n  21 -->|output| 22;\n  cef36c68-4549-4fd6-b7c8-71fb21df012f[\"Output\\nquality_retained_hosts_reads\"];\n  22 --> cef36c68-4549-4fd6-b7c8-71fb21df012f;\n  style cef36c68-4549-4fd6-b7c8-71fb21df012f stroke:#2c3143,stroke-width:4px;\n  23[\"Column join\"];\n  17 -->|out_file1| 23;\n  22 -->|out_file1| 23;\n  24[\"Compute\"];\n  23 -->|tabular_output| 24;\n  25[\"Column Regex Find And Replace\"];\n  24 -->|out_file1| 25;\n  470892ee-dab9-48d7-ad97-45dbd52afaa7[\"Output\\nremoved_hosts_percentage_tabular\"];\n  25 --> 470892ee-dab9-48d7-ad97-45dbd52afaa7;\n  style 470892ee-dab9-48d7-ad97-45dbd52afaa7 stroke:#2c3143,stroke-width:4px;\n  26[\"MultiQC\"];\n  9 -->|text_file| 26;\n  25 -->|out_file1| 26;\n  0b1b5a73-36ee-42a2-a220-1ced6ec7378b[\"Output\\nmultiQC_html_report_after_preprocessing\"];\n  26 --> 0b1b5a73-36ee-42a2-a220-1ced6ec7378b;\n  style 0b1b5a73-36ee-42a2-a220-1ced6ec7378b stroke:#2c3143,stroke-width:4px;\n  13cbf6c7-6954-4458-aa66-a5b020c63822[\"Output\\nmultiQC_stats_after_preprocessing\"];\n  26 --> 13cbf6c7-6954-4458-aa66-a5b020c63822;\n  style 13cbf6c7-6954-4458-aa66-a5b020c63822 stroke:#2c3143,stroke-width:4px;"},{"workflow":"pathogen_detection_pathoGFAIR_samples_aggregation_and_visualisation.ga","tests":false,"url":"https://training.galaxyproject.org/training-material/topics/microbiome/tutorials/pathogen-detection-from-nanopore-foodborne-data/workflows/pathogen_detection_pathoGFAIR_samples_aggregation_and_visualisation.ga","path":"topics/microbiome/tutorials/pathogen-detection-from-nanopore-foodborne-data/workflows/pathogen_detection_pathoGFAIR_samples_aggregation_and_visualisation.ga","wfid":"microbiome-pathogen-detection-from-nanopore-foodborne-data","wfname":"pathogen_detection_pathogfair_samples_aggrtion_and_visualisation","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/microbiome-pathogen-detection-from-nanopore-foodborne-data/versions/pathogen_detection_pathogfair_samples_aggrtion_and_visualisation","license":"MIT","creators":[{"class":"Person","identifier":"0000-0001-9047-4215","name":"Engy Nasr","url":"https://orcid.org/0000-0001-9047-4215"},{"class":"Person","identifier":"0000-0001-9852-1987","name":"Bérénice Batut","url":"https://orcid.org/0000-0001-9852-1987"},{"class":"Person","identifier":"0000-0003-2982-388X","name":"Paul Zierep"}],"name":"Pathogen Detection PathoGFAIR Samples Aggregation and Visualisation","title":"Pathogen Detection PathoGFAIR Samples Aggregation and Visualisation","test_results":null,"modified":"2024-06-23 00:06:09 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Collection\\namr_identified_by_ncbi\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"ℹ️ Input Collection\\nvfs_of_genes_identified_by_vfdb\"];\n  style 1 stroke:#2c3143,stroke-width:4px;\n  2[\"ℹ️ Input Dataset\\nmetadata\"];\n  style 2 stroke:#2c3143,stroke-width:4px;\n  3[\"ℹ️ Input Dataset\\nremoved_hosts_percentage_tabular\"];\n  style 3 stroke:#2c3143,stroke-width:4px;\n  4[\"ℹ️ Input Dataset\\nmapping_mean_depth_per_sample\"];\n  style 4 stroke:#2c3143,stroke-width:4px;\n  5[\"ℹ️ Input Collection\\namrs\"];\n  style 5 stroke:#2c3143,stroke-width:4px;\n  6[\"ℹ️ Input Dataset\\nmapping_coverage_percentage_per_sample\"];\n  style 6 stroke:#2c3143,stroke-width:4px;\n  7[\"ℹ️ Input Dataset\\nnumber_of_variants_per_sample\"];\n  style 7 stroke:#2c3143,stroke-width:4px;\n  8[\"ℹ️ Input Collection\\ncontigs\"];\n  style 8 stroke:#2c3143,stroke-width:4px;\n  9[\"ℹ️ Input Collection\\nvfs\"];\n  style 9 stroke:#2c3143,stroke-width:4px;\n  10[\"Filter failed datasets\"];\n  0 -->|output| 10;\n  11[\"Filter failed datasets\"];\n  1 -->|output| 11;\n  12[\"Bar chart\"];\n  3 -->|output| 12;\n  0961166e-38b6-44e3-93db-100d821b0070[\"Output\\nnumber_of_reads_before_host_removal_and_number_of_host_reads_found_per_sample_fig\"];\n  12 --> 0961166e-38b6-44e3-93db-100d821b0070;\n  style 0961166e-38b6-44e3-93db-100d821b0070 stroke:#2c3143,stroke-width:4px;\n  13[\"Bar chart\"];\n  3 -->|output| 13;\n  548975e5-4619-49fc-9e95-4d7f4d761dfd[\"Output\\nremoved_host_percentage_fig\"];\n  13 --> 548975e5-4619-49fc-9e95-4d7f4d761dfd;\n  style 548975e5-4619-49fc-9e95-4d7f4d761dfd stroke:#2c3143,stroke-width:4px;\n  14[\"Bar chart\"];\n  4 -->|output| 14;\n  a71ebb67-1154-4f25-a62d-e8fa2b839e2e[\"Output\\nmapping_mean_depth_per_sample_fig\"];\n  14 --> a71ebb67-1154-4f25-a62d-e8fa2b839e2e;\n  style a71ebb67-1154-4f25-a62d-e8fa2b839e2e stroke:#2c3143,stroke-width:4px;\n  15[\"Filter failed datasets\"];\n  5 -->|output| 15;\n  16[\"Bar chart\"];\n  6 -->|output| 16;\n  2567360e-d39f-4316-84f5-77aaf8e8198c[\"Output\\nmapping_coverage_percentage_per_sample_fig\"];\n  16 --> 2567360e-d39f-4316-84f5-77aaf8e8198c;\n  style 2567360e-d39f-4316-84f5-77aaf8e8198c stroke:#2c3143,stroke-width:4px;\n  17[\"Bar chart\"];\n  7 -->|output| 17;\n  68c76f06-d2ea-4280-9e6f-a7b4f1568389[\"Output\\nnumber_of_Variants_and_SNPs_indentified_fig\"];\n  17 --> 68c76f06-d2ea-4280-9e6f-a7b4f1568389;\n  style 68c76f06-d2ea-4280-9e6f-a7b4f1568389 stroke:#2c3143,stroke-width:4px;\n  18[\"Filter failed datasets\"];\n  8 -->|output| 18;\n  19[\"Filter failed datasets\"];\n  9 -->|output| 19;\n  20[\"Remove beginning\"];\n  10 -->|output| 20;\n  21[\"Remove beginning\"];\n  11 -->|output| 21;\n  22[\"Remove beginning\"];\n  15 -->|output| 22;\n  23[\"Collapse Collection\"];\n  18 -->|output| 23;\n  86910e39-57bf-4a76-ac4c-739340fd2387[\"Output\\nall_samples_contigs_in_one_fasta_file\"];\n  23 --> 86910e39-57bf-4a76-ac4c-739340fd2387;\n  style 86910e39-57bf-4a76-ac4c-739340fd2387 stroke:#2c3143,stroke-width:4px;\n  24[\"Collapse Collection\"];\n  19 -->|output| 24;\n  02b996c6-a912-4e4e-b3ec-49601faaa452[\"Output\\nall_vfs_in_one_tabular\"];\n  24 --> 02b996c6-a912-4e4e-b3ec-49601faaa452;\n  style 02b996c6-a912-4e4e-b3ec-49601faaa452 stroke:#2c3143,stroke-width:4px;\n  25[\"Remove beginning\"];\n  19 -->|output| 25;\n  26[\"Count\"];\n  20 -->|out_file1| 26;\n  27[\"Count\"];\n  21 -->|out_file1| 27;\n  28[\"Group\"];\n  21 -->|out_file1| 28;\n  29[\"Unique\"];\n  22 -->|out_file1| 29;\n  30[\"Split by group\"];\n  24 -->|output| 30;\n  59f8cb09-424b-47b1-b94b-a612c2610cab[\"Output\\nsplit_by_group_collection\"];\n  30 --> 59f8cb09-424b-47b1-b94b-a612c2610cab;\n  style 59f8cb09-424b-47b1-b94b-a612c2610cab stroke:#2c3143,stroke-width:4px;\n  31[\"Unique\"];\n  25 -->|out_file1| 31;\n  32[\"Cut\"];\n  26 -->|out_file1| 32;\n  33[\"Cut\"];\n  27 -->|out_file1| 33;\n  34[\"Filter empty datasets\"];\n  28 -->|out_file1| 34;\n  35[\"Cut\"];\n  29 -->|outfile| 35;\n  36[\"Cut\"];\n  30 -->|split_output| 36;\n  eeb25a51-ea21-4a19-a196-55d5bd919b10[\"Output\\nadjusted_abricate_vfs_tabular_part1\"];\n  36 --> eeb25a51-ea21-4a19-a196-55d5bd919b10;\n  style eeb25a51-ea21-4a19-a196-55d5bd919b10 stroke:#2c3143,stroke-width:4px;\n  37[\"Cut\"];\n  31 -->|outfile| 37;\n  38[\"Collapse Collection\"];\n  32 -->|out_file1| 38;\n  39[\"Collapse Collection\"];\n  33 -->|out_file1| 39;\n  40[\"Column join\"];\n  34 -->|output| 40;\n  41[\"bedtools getfasta\"];\n  23 -->|output| 41;\n  35 -->|out_file1| 41;\n  42[\"Remove beginning\"];\n  36 -->|out_file1| 42;\n  aaaa4446-0817-4e5c-aa1b-9ec384f2a363[\"Output\\nadjusted_abricate_vfs_tabular_part2\"];\n  42 --> aaaa4446-0817-4e5c-aa1b-9ec384f2a363;\n  style aaaa4446-0817-4e5c-aa1b-9ec384f2a363 stroke:#2c3143,stroke-width:4px;\n  43[\"bedtools getfasta\"];\n  23 -->|output| 43;\n  37 -->|out_file1| 43;\n  44[\"Column Regex Find And Replace\"];\n  38 -->|output| 44;\n  4809c36b-31ef-4664-8e4e-47f0f72152de[\"Output\\namrs_count\"];\n  44 --> 4809c36b-31ef-4664-8e4e-47f0f72152de;\n  style 4809c36b-31ef-4664-8e4e-47f0f72152de stroke:#2c3143,stroke-width:4px;\n  45[\"Column Regex Find And Replace\"];\n  39 -->|output| 45;\n  87efc81d-4d84-4af3-831f-dfe033c59f78[\"Output\\nvfs_count\"];\n  45 --> 87efc81d-4d84-4af3-831f-dfe033c59f78;\n  style 87efc81d-4d84-4af3-831f-dfe033c59f78 stroke:#2c3143,stroke-width:4px;\n  46[\"Column Regex Find And Replace\"];\n  40 -->|tabular_output| 46;\n  f5c221e3-00ef-4834-9a5f-a94c97fd6764[\"Output\\nheatmap_table\"];\n  46 --> f5c221e3-00ef-4834-9a5f-a94c97fd6764;\n  style f5c221e3-00ef-4834-9a5f-a94c97fd6764 stroke:#2c3143,stroke-width:4px;\n  47[\"Regex Find And Replace\"];\n  41 -->|output| 47;\n  48[\"bedtools getfasta\"];\n  23 -->|output| 48;\n  42 -->|out_file1| 48;\n  82ce2107-89a3-438c-95bb-dc871b5258b7[\"Output\\nfiltered_sequences_with_vfs_fasta\"];\n  48 --> 82ce2107-89a3-438c-95bb-dc871b5258b7;\n  style 82ce2107-89a3-438c-95bb-dc871b5258b7 stroke:#2c3143,stroke-width:4px;\n  49[\"Regex Find And Replace\"];\n  43 -->|output| 49;\n  50[\"Multi-Join\"];\n  45 -->|out_file1| 50;\n  44 -->|out_file1| 50;\n  51[\"Heatmap w ggplot\"];\n  46 -->|out_file1| 51;\n  c0417c91-a513-4c6a-9a62-3aac2f1f8e85[\"Output\\nheatmap_pdf\"];\n  51 --> c0417c91-a513-4c6a-9a62-3aac2f1f8e85;\n  style c0417c91-a513-4c6a-9a62-3aac2f1f8e85 stroke:#2c3143,stroke-width:4px;\n  97816bc2-fd0c-4077-a721-8dd1470879d1[\"Output\\nheatmap_png\"];\n  51 --> 97816bc2-fd0c-4077-a721-8dd1470879d1;\n  style 97816bc2-fd0c-4077-a721-8dd1470879d1 stroke:#2c3143,stroke-width:4px;\n  52[\"Filter empty datasets\"];\n  47 -->|out_file1| 52;\n  53[\"ClustalW\"];\n  48 -->|output| 53;\n  9b7bd78c-f112-480b-a7df-c10711af254c[\"Output\\nclustalw_on_input_dnd\"];\n  53 --> 9b7bd78c-f112-480b-a7df-c10711af254c;\n  style 9b7bd78c-f112-480b-a7df-c10711af254c stroke:#2c3143,stroke-width:4px;\n  6af20322-24da-4036-80de-37bed2d25848[\"Output\\nclustalw_on_input_clustal\"];\n  53 --> 6af20322-24da-4036-80de-37bed2d25848;\n  style 6af20322-24da-4036-80de-37bed2d25848 stroke:#2c3143,stroke-width:4px;\n  54[\"Filter empty datasets\"];\n  49 -->|out_file1| 54;\n  55[\"Replace Text\"];\n  50 -->|outfile| 55;\n  91745da0-0b8d-4a7a-b927-b36107f17ec5[\"Output\\nvfs_amrs_count_table\"];\n  55 --> 91745da0-0b8d-4a7a-b927-b36107f17ec5;\n  style 91745da0-0b8d-4a7a-b927-b36107f17ec5 stroke:#2c3143,stroke-width:4px;\n  56[\"FASTA-to-Tabular\"];\n  52 -->|output| 56;\n  57[\"Filter empty datasets\"];\n  53 -->|output| 57;\n  32d00c1d-68c4-4069-8d5d-023aabdfadbe[\"Output\\nfiltered_empty_datasets\"];\n  57 --> 32d00c1d-68c4-4069-8d5d-023aabdfadbe;\n  style 32d00c1d-68c4-4069-8d5d-023aabdfadbe stroke:#2c3143,stroke-width:4px;\n  58[\"FASTA-to-Tabular\"];\n  54 -->|output| 58;\n  59[\"Cut\"];\n  56 -->|output| 59;\n  60[\"FASTTREE\"];\n  57 -->|output| 60;\n  aacdfe45-eb0c-4f6e-a479-eeb170774757[\"Output\\nfasttree_nhx\"];\n  60 --> aacdfe45-eb0c-4f6e-a479-eeb170774757;\n  style aacdfe45-eb0c-4f6e-a479-eeb170774757 stroke:#2c3143,stroke-width:4px;\n  61[\"Cut\"];\n  58 -->|output| 61;\n  62[\"Group\"];\n  59 -->|out_file1| 62;\n  63[\"Newick Display\"];\n  60 -->|output| 63;\n  0c22178c-dc85-4137-80e2-f3040b92bd20[\"Output\\nnewick_genes_tree_graphs_collection\"];\n  63 --> 0c22178c-dc85-4137-80e2-f3040b92bd20;\n  style 0c22178c-dc85-4137-80e2-f3040b92bd20 stroke:#2c3143,stroke-width:4px;\n  64[\"Group\"];\n  61 -->|out_file1| 64;\n  65[\"Tabular-to-FASTA\"];\n  62 -->|out_file1| 65;\n  66[\"Tabular-to-FASTA\"];\n  64 -->|out_file1| 66;\n  67[\"FASTA Merge Files and Filter Unique Sequences\"];\n  65 -->|output| 67;\n  68[\"FASTA Merge Files and Filter Unique Sequences\"];\n  66 -->|output| 68;\n  69[\"ClustalW\"];\n  67 -->|output| 69;\n  70[\"ClustalW\"];\n  68 -->|output| 70;\n  71[\"FASTTREE\"];\n  69 -->|output| 71;\n  72[\"FASTTREE\"];\n  70 -->|output| 72;\n  73[\"Newick Display\"];\n  71 -->|output| 73;\n  1f9cb2cf-219f-48de-8058-d6d45f3b3158[\"Output\\nall_samples_phylogenetic_tree_based_amrs\"];\n  73 --> 1f9cb2cf-219f-48de-8058-d6d45f3b3158;\n  style 1f9cb2cf-219f-48de-8058-d6d45f3b3158 stroke:#2c3143,stroke-width:4px;\n  74[\"Newick Display\"];\n  72 -->|output| 74;\n  6bb4b32b-7cca-4e04-8120-be9f64ccba39[\"Output\\nall_samples_phylogenetic_tree_based_vfs\"];\n  74 --> 6bb4b32b-7cca-4e04-8120-be9f64ccba39;\n  style 6bb4b32b-7cca-4e04-8120-be9f64ccba39 stroke:#2c3143,stroke-width:4px;"},{"workflow":"taxonomy_profiling_and_visualisation_with_krona.ga","tests":true,"url":"https://training.galaxyproject.org/training-material/topics/microbiome/tutorials/pathogen-detection-from-nanopore-foodborne-data/workflows/taxonomy_profiling_and_visualisation_with_krona.ga","path":"topics/microbiome/tutorials/pathogen-detection-from-nanopore-foodborne-data/workflows/taxonomy_profiling_and_visualisation_with_krona.ga","wfid":"microbiome-pathogen-detection-from-nanopore-foodborne-data","wfname":"taxonomy_profiling_and_visualisation_with_krona","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/microbiome-pathogen-detection-from-nanopore-foodborne-data/versions/taxonomy_profiling_and_visualisation_with_krona","license":"MIT","creators":[{"class":"Person","identifier":"0000-0001-9047-4215","name":"Engy Nasr","url":"https://orcid.org/0000-0001-9047-4215"},{"class":"Person","identifier":"0000-0001-9852-1987","name":"Bérénice Batut","url":"https://orcid.org/0000-0001-9852-1987"},{"class":"Person","identifier":"0000-0003-2982-388X","name":"Paul Zierep"}],"name":"Taxonomy Profiling and Visualization with Krona","title":"Taxonomy Profiling and Visualization with Krona","test_results":null,"modified":"2024-06-23 00:06:09 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Collection\\ncollection_of_preprocessed_samples\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"ℹ️ Input Parameter\\nkraken_database\"];\n  style 1 fill:#ded,stroke:#393,stroke-width:4px;\n  2[\"Kraken2\"];\n  1 -->|output| 2;\n  0 -->|output| 2;\n  26f9041f-d8a4-4f64-8a53-404d5c7e2f61[\"Output\\nkraken2_with_pluspf_database_output\"];\n  2 --> 26f9041f-d8a4-4f64-8a53-404d5c7e2f61;\n  style 26f9041f-d8a4-4f64-8a53-404d5c7e2f61 stroke:#2c3143,stroke-width:4px;\n  f2ddd05b-66a0-4cea-9da6-ed107eecbe1b[\"Output\\nkraken2_with_pluspf_database_output_report\"];\n  2 --> f2ddd05b-66a0-4cea-9da6-ed107eecbe1b;\n  style f2ddd05b-66a0-4cea-9da6-ed107eecbe1b stroke:#2c3143,stroke-width:4px;\n  3[\"Krakentools: Convert kraken report file\"];\n  2 -->|report_output| 3;\n  c490ab8d-1b1d-4914-aa51-a62a967a4018[\"Output\\nconverted_kraken_report\"];\n  3 --> c490ab8d-1b1d-4914-aa51-a62a967a4018;\n  style c490ab8d-1b1d-4914-aa51-a62a967a4018 stroke:#2c3143,stroke-width:4px;\n  4[\"Krona pie chart\"];\n  3 -->|output| 4;\n  dcc857c6-f579-4c74-84ec-bb6ce3794a56[\"Output\\nkrona_pie_chart\"];\n  4 --> dcc857c6-f579-4c74-84ec-bb6ce3794a56;\n  style dcc857c6-f579-4c74-84ec-bb6ce3794a56 stroke:#2c3143,stroke-width:4px;"}],"api":"https://training.galaxyproject.org/training-material/api/topics/microbiome/tutorials/pathogen-detection-from-nanopore-foodborne-data/tutorial.json","tools":["CONVERTER_gz_to_uncompressed","Count1","Cut1","Grep1","Grouping1","Paste1","Remove beginning1","__BUILD_LIST__","__FILTER_EMPTY_DATASETS__","__FILTER_FAILED_DATASETS__","barchart_gnuplot","param_value_from_file","toolshed.g2.bx.psu.edu/repos/bgruening/add_line_to_file/add_line_to_file/0.1.0","toolshed.g2.bx.psu.edu/repos/bgruening/flye/flye/2.9+galaxy0","toolshed.g2.bx.psu.edu/repos/bgruening/flye/flye/2.9.1+galaxy0","toolshed.g2.bx.psu.edu/repos/bgruening/split_file_on_column/tp_split_on_column/0.6","toolshed.g2.bx.psu.edu/repos/bgruening/split_file_to_collection/split_file_to_collection/0.5.0","toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_cut_tool/9.3+galaxy1","toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_find_and_replace/1.1.4","toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_head_tool/9.3+galaxy1","toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_multijoin_tool/9.3+galaxy1","toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_replace_in_column/9.3+galaxy1","toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_sorted_uniq/9.3+galaxy1","toolshed.g2.bx.psu.edu/repos/crs4/taxonomy_krona_chart/taxonomy_krona_chart/2.7.1+galaxy0","toolshed.g2.bx.psu.edu/repos/devteam/clustalw/clustalw/2.1+galaxy1","toolshed.g2.bx.psu.edu/repos/devteam/column_maker/Add_a_column1/2.0","toolshed.g2.bx.psu.edu/repos/devteam/fasta_to_tabular/fasta2tab/1.1.1","toolshed.g2.bx.psu.edu/repos/devteam/fastqc/fastqc/0.73+galaxy0","toolshed.g2.bx.psu.edu/repos/devteam/fastqc/fastqc/0.74+galaxy0","toolshed.g2.bx.psu.edu/repos/devteam/tabular_to_fasta/tab2fasta/1.1.1","toolshed.g2.bx.psu.edu/repos/galaxyp/fasta_merge_files_and_filter_unique_sequences/fasta_merge_files_and_filter_unique_sequences/1.2.0","toolshed.g2.bx.psu.edu/repos/galaxyp/regex_find_replace/regex1/1.0.3","toolshed.g2.bx.psu.edu/repos/galaxyp/regex_find_replace/regexColumn1/1.0.3","toolshed.g2.bx.psu.edu/repos/iuc/abricate/abricate/1.0.1","toolshed.g2.bx.psu.edu/repos/iuc/bamtools_split_mapped/bamtools_split_mapped/2.5.2+galaxy2","toolshed.g2.bx.psu.edu/repos/iuc/bandage/bandage_image/0.8.1+galaxy2","toolshed.g2.bx.psu.edu/repos/iuc/bandage/bandage_image/2022.09+galaxy4","toolshed.g2.bx.psu.edu/repos/iuc/bcftools_consensus/bcftools_consensus/1.15.1+galaxy3","toolshed.g2.bx.psu.edu/repos/iuc/bcftools_consensus/bcftools_consensus/1.9+galaxy1","toolshed.g2.bx.psu.edu/repos/iuc/bcftools_norm/bcftools_norm/1.9+galaxy1","toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_getfastabed/2.30.0+galaxy1","toolshed.g2.bx.psu.edu/repos/iuc/clair3/clair3/0.1.12+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/collection_column_join/collection_column_join/0.0.3","toolshed.g2.bx.psu.edu/repos/iuc/collection_element_identifiers/collection_element_identifiers/0.0.2","toolshed.g2.bx.psu.edu/repos/iuc/compose_text_param/compose_text_param/0.1.1","toolshed.g2.bx.psu.edu/repos/iuc/fastp/fastp/0.20.1+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/fastp/fastp/0.23.4+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/fasttree/fasttree/2.1.10+galaxy1","toolshed.g2.bx.psu.edu/repos/iuc/ggplot2_heatmap/ggplot2_heatmap/3.4.0+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/kraken2/kraken2/2.1.1+galaxy1","toolshed.g2.bx.psu.edu/repos/iuc/krakentools_extract_kraken_reads/krakentools_extract_kraken_reads/1.2+galaxy1","toolshed.g2.bx.psu.edu/repos/iuc/krakentools_kreport2krona/krakentools_kreport2krona/1.2+galaxy1","toolshed.g2.bx.psu.edu/repos/iuc/medaka_consensus_pipeline/medaka_consensus_pipeline/1.7.2+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/minimap2/minimap2/2.24+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/minimap2/minimap2/2.28+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/mlst/mlst/2.22.0","toolshed.g2.bx.psu.edu/repos/iuc/multiqc/multiqc/1.11+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/multiqc/multiqc/1.11+galaxy1","toolshed.g2.bx.psu.edu/repos/iuc/nanoplot/nanoplot/1.28.2+galaxy1","toolshed.g2.bx.psu.edu/repos/iuc/nanoplot/nanoplot/1.42.0+galaxy1","toolshed.g2.bx.psu.edu/repos/iuc/newick_utils/newick_display/1.6+galaxy1","toolshed.g2.bx.psu.edu/repos/iuc/porechop/porechop/0.2.4","toolshed.g2.bx.psu.edu/repos/iuc/porechop/porechop/0.2.4+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/samtools_coverage/samtools_coverage/1.15.1+galaxy2","toolshed.g2.bx.psu.edu/repos/iuc/samtools_depth/samtools_depth/1.15.1+galaxy2","toolshed.g2.bx.psu.edu/repos/iuc/samtools_fastx/samtools_fastx/1.15.1+galaxy2","toolshed.g2.bx.psu.edu/repos/iuc/snpsift/snpSift_extractFields/4.3+t.galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/snpsift/snpSift_filter/4.3+t.galaxy1","toolshed.g2.bx.psu.edu/repos/iuc/table_compute/table_compute/1.2.4+galaxy0","toolshed.g2.bx.psu.edu/repos/nml/collapse_collections/collapse_dataset/5.1.0"],"supported_servers":{"exact":[{"url":"https://usegalaxy.eu","name":"UseGalaxy.eu","usegalaxy":true}],"inexact":[]},"topic_name_human":"Microbiome","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"add_line_to_file","owner":"bgruening","revisions":"8e251055b1a9","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"flye","owner":"bgruening","revisions":"276f5d8712d5","tool_panel_section_label":"Assembly","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"flye","owner":"bgruening","revisions":"cb8dfd28c16f","tool_panel_section_label":"Assembly","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"split_file_on_column","owner":"bgruening","revisions":"ff2a81aa3f08","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"split_file_to_collection","owner":"bgruening","revisions":"6cbe2f30c2d7","tool_panel_section_label":"Collection Operations","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"text_processing","owner":"bgruening","revisions":"fbf99087e067","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"text_processing","owner":"bgruening","revisions":"d698c222f354","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"text_processing","owner":"bgruening","revisions":"fbf99087e067","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"text_processing","owner":"bgruening","revisions":"fbf99087e067","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"text_processing","owner":"bgruening","revisions":"fbf99087e067","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"text_processing","owner":"bgruening","revisions":"fbf99087e067","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"taxonomy_krona_chart","owner":"crs4","revisions":"e9005d1f3cfd","tool_panel_section_label":"Metagenomic Analysis","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"clustalw","owner":"devteam","revisions":"5b097fde95dd","tool_panel_section_label":"Multiple Alignments","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"column_maker","owner":"devteam","revisions":"6595517c2dd8","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"fasta_to_tabular","owner":"devteam","revisions":"e7ed3c310b74","tool_panel_section_label":"FASTA/FASTQ","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"fastqc","owner":"devteam","revisions":"3d0c7bdf12f5","tool_panel_section_label":"FASTA/FASTQ","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"fastqc","owner":"devteam","revisions":"5ec9f6bceaee","tool_panel_section_label":"FASTA/FASTQ","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"tabular_to_fasta","owner":"devteam","revisions":"0a7799698fe5","tool_panel_section_label":"FASTA/FASTQ","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"fasta_merge_files_and_filter_unique_sequences","owner":"galaxyp","revisions":"f546e7278f04","tool_panel_section_label":"FASTA/FASTQ","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"regex_find_replace","owner":"galaxyp","revisions":"503bcd6ebe4b","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"regex_find_replace","owner":"galaxyp","revisions":"503bcd6ebe4b","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"abricate","owner":"iuc","revisions":"c2ef298da409","tool_panel_section_label":"Annotation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"bamtools_split_mapped","owner":"iuc","revisions":"fa7b5520ae53","tool_panel_section_label":"SAM/BAM","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"bandage","owner":"iuc","revisions":"b2860df42e16","tool_panel_section_label":"Graph/Display Data","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"bandage","owner":"iuc","revisions":"ddddce450736","tool_panel_section_label":"Graph/Display Data","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"bcftools_consensus","owner":"iuc","revisions":"147de996e34f","tool_panel_section_label":"Variant Calling","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"bcftools_consensus","owner":"iuc","revisions":"f867422772d6","tool_panel_section_label":"Variant Calling","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"bcftools_norm","owner":"iuc","revisions":"da6fc9f4a367","tool_panel_section_label":"Variant Calling","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"bedtools","owner":"iuc","revisions":"a1a923cd89e8","tool_panel_section_label":"BED","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"clair3","owner":"iuc","revisions":"63e02ef6e153","tool_panel_section_label":"Nanopore","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"collection_column_join","owner":"iuc","revisions":"3ddd99c7efee","tool_panel_section_label":"Join, Subtract and Group","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"collection_element_identifiers","owner":"iuc","revisions":"d3c07d270a50","tool_panel_section_label":"Collection Operations","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"compose_text_param","owner":"iuc","revisions":"e188c9826e0f","tool_panel_section_label":"Expression Tools","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"fastp","owner":"iuc","revisions":"dbf9c561ef29","tool_panel_section_label":"FASTA/FASTQ","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"fastp","owner":"iuc","revisions":"c59d48774d03","tool_panel_section_label":"FASTA/FASTQ","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"fasttree","owner":"iuc","revisions":"e005e659ae21","tool_panel_section_label":"Genome Diversity","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"ggplot2_heatmap","owner":"iuc","revisions":"10515715c940","tool_panel_section_label":"Graph/Display Data","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"kraken2","owner":"iuc","revisions":"20e2f64aa1fe","tool_panel_section_label":"Metagenomic Analysis","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"krakentools_extract_kraken_reads","owner":"iuc","revisions":"f329328da134","tool_panel_section_label":"Metagenomic Analysis","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"krakentools_kreport2krona","owner":"iuc","revisions":"2deaada69b14","tool_panel_section_label":"Metagenomic Analysis","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"medaka_consensus_pipeline","owner":"iuc","revisions":"79e9a869f40e","tool_panel_section_label":"Nanopore","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"minimap2","owner":"iuc","revisions":"11a0d50a54e6","tool_panel_section_label":"Mapping","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"minimap2","owner":"iuc","revisions":"5cc34c3f440d","tool_panel_section_label":"Mapping","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"mlst","owner":"iuc","revisions":"31812e7a1315","tool_panel_section_label":"Annotation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"multiqc","owner":"iuc","revisions":"9a913cdee30e","tool_panel_section_label":"Quality Control","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"multiqc","owner":"iuc","revisions":"abfd8a6544d7","tool_panel_section_label":"Quality Control","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"nanoplot","owner":"iuc","revisions":"edbb6c5028f5","tool_panel_section_label":"Nanopore","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"nanoplot","owner":"iuc","revisions":"a02b8b3f5a0c","tool_panel_section_label":"Nanopore","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"newick_utils","owner":"iuc","revisions":"b4163d2f64ab","tool_panel_section_label":"Graph/Display Data","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"porechop","owner":"iuc","revisions":"5f76b20953e5","tool_panel_section_label":"Nanopore","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"porechop","owner":"iuc","revisions":"543cbeef3949","tool_panel_section_label":"Nanopore","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"samtools_coverage","owner":"iuc","revisions":"c4ff13d2aab3","tool_panel_section_label":"SAM/BAM","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"samtools_depth","owner":"iuc","revisions":"971dc85e9441","tool_panel_section_label":"SAM/BAM","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"samtools_fastx","owner":"iuc","revisions":"66e23b11feae","tool_panel_section_label":"SAM/BAM","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"snpsift","owner":"iuc","revisions":"5fab4f81391d","tool_panel_section_label":"Variant Calling","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"snpsift","owner":"iuc","revisions":"5fab4f81391d","tool_panel_section_label":"Variant Calling","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"table_compute","owner":"iuc","revisions":"3bf5661c0280","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"collapse_collections","owner":"nml","revisions":"90981f86000f","tool_panel_section_label":"Collection Operations","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: add_line_to_file\n  owner: bgruening\n  revisions: 8e251055b1a9\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: flye\n  owner: bgruening\n  revisions: 276f5d8712d5\n  tool_panel_section_label: Assembly\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: flye\n  owner: bgruening\n  revisions: cb8dfd28c16f\n  tool_panel_section_label: Assembly\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: split_file_on_column\n  owner: bgruening\n  revisions: ff2a81aa3f08\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: split_file_to_collection\n  owner: bgruening\n  revisions: 6cbe2f30c2d7\n  tool_panel_section_label: Collection Operations\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: text_processing\n  owner: bgruening\n  revisions: fbf99087e067\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: text_processing\n  owner: bgruening\n  revisions: d698c222f354\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: text_processing\n  owner: bgruening\n  revisions: fbf99087e067\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: text_processing\n  owner: bgruening\n  revisions: fbf99087e067\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: text_processing\n  owner: bgruening\n  revisions: fbf99087e067\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: text_processing\n  owner: bgruening\n  revisions: fbf99087e067\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: taxonomy_krona_chart\n  owner: crs4\n  revisions: e9005d1f3cfd\n  tool_panel_section_label: Metagenomic Analysis\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: clustalw\n  owner: devteam\n  revisions: 5b097fde95dd\n  tool_panel_section_label: Multiple Alignments\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: column_maker\n  owner: devteam\n  revisions: 6595517c2dd8\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: fasta_to_tabular\n  owner: devteam\n  revisions: e7ed3c310b74\n  tool_panel_section_label: FASTA/FASTQ\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: fastqc\n  owner: devteam\n  revisions: 3d0c7bdf12f5\n  tool_panel_section_label: FASTA/FASTQ\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: fastqc\n  owner: devteam\n  revisions: 5ec9f6bceaee\n  tool_panel_section_label: FASTA/FASTQ\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: tabular_to_fasta\n  owner: devteam\n  revisions: 0a7799698fe5\n  tool_panel_section_label: FASTA/FASTQ\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: fasta_merge_files_and_filter_unique_sequences\n  owner: galaxyp\n  revisions: f546e7278f04\n  tool_panel_section_label: FASTA/FASTQ\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: regex_find_replace\n  owner: galaxyp\n  revisions: 503bcd6ebe4b\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: regex_find_replace\n  owner: galaxyp\n  revisions: 503bcd6ebe4b\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: abricate\n  owner: iuc\n  revisions: c2ef298da409\n  tool_panel_section_label: Annotation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bamtools_split_mapped\n  owner: iuc\n  revisions: fa7b5520ae53\n  tool_panel_section_label: SAM/BAM\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bandage\n  owner: iuc\n  revisions: b2860df42e16\n  tool_panel_section_label: Graph/Display Data\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bandage\n  owner: iuc\n  revisions: ddddce450736\n  tool_panel_section_label: Graph/Display Data\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bcftools_consensus\n  owner: iuc\n  revisions: 147de996e34f\n  tool_panel_section_label: Variant Calling\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bcftools_consensus\n  owner: iuc\n  revisions: f867422772d6\n  tool_panel_section_label: Variant Calling\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bcftools_norm\n  owner: iuc\n  revisions: da6fc9f4a367\n  tool_panel_section_label: Variant Calling\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bedtools\n  owner: iuc\n  revisions: a1a923cd89e8\n  tool_panel_section_label: BED\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: clair3\n  owner: iuc\n  revisions: 63e02ef6e153\n  tool_panel_section_label: Nanopore\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: collection_column_join\n  owner: iuc\n  revisions: 3ddd99c7efee\n  tool_panel_section_label: Join, Subtract and Group\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: collection_element_identifiers\n  owner: iuc\n  revisions: d3c07d270a50\n  tool_panel_section_label: Collection Operations\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: compose_text_param\n  owner: iuc\n  revisions: e188c9826e0f\n  tool_panel_section_label: Expression Tools\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: fastp\n  owner: iuc\n  revisions: dbf9c561ef29\n  tool_panel_section_label: FASTA/FASTQ\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: fastp\n  owner: iuc\n  revisions: c59d48774d03\n  tool_panel_section_label: FASTA/FASTQ\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: fasttree\n  owner: iuc\n  revisions: e005e659ae21\n  tool_panel_section_label: Genome Diversity\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: ggplot2_heatmap\n  owner: iuc\n  revisions: 10515715c940\n  tool_panel_section_label: Graph/Display Data\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: kraken2\n  owner: iuc\n  revisions: 20e2f64aa1fe\n  tool_panel_section_label: Metagenomic Analysis\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: krakentools_extract_kraken_reads\n  owner: iuc\n  revisions: f329328da134\n  tool_panel_section_label: Metagenomic Analysis\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: krakentools_kreport2krona\n  owner: iuc\n  revisions: 2deaada69b14\n  tool_panel_section_label: Metagenomic Analysis\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: medaka_consensus_pipeline\n  owner: iuc\n  revisions: 79e9a869f40e\n  tool_panel_section_label: Nanopore\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: minimap2\n  owner: iuc\n  revisions: 11a0d50a54e6\n  tool_panel_section_label: Mapping\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: minimap2\n  owner: iuc\n  revisions: 5cc34c3f440d\n  tool_panel_section_label: Mapping\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: mlst\n  owner: iuc\n  revisions: 31812e7a1315\n  tool_panel_section_label: Annotation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: multiqc\n  owner: iuc\n  revisions: 9a913cdee30e\n  tool_panel_section_label: Quality Control\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: multiqc\n  owner: iuc\n  revisions: abfd8a6544d7\n  tool_panel_section_label: Quality Control\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: nanoplot\n  owner: iuc\n  revisions: edbb6c5028f5\n  tool_panel_section_label: Nanopore\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: nanoplot\n  owner: iuc\n  revisions: a02b8b3f5a0c\n  tool_panel_section_label: Nanopore\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: newick_utils\n  owner: iuc\n  revisions: b4163d2f64ab\n  tool_panel_section_label: Graph/Display Data\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: porechop\n  owner: iuc\n  revisions: 5f76b20953e5\n  tool_panel_section_label: Nanopore\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: porechop\n  owner: iuc\n  revisions: 543cbeef3949\n  tool_panel_section_label: Nanopore\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: samtools_coverage\n  owner: iuc\n  revisions: c4ff13d2aab3\n  tool_panel_section_label: SAM/BAM\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: samtools_depth\n  owner: iuc\n  revisions: 971dc85e9441\n  tool_panel_section_label: SAM/BAM\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: samtools_fastx\n  owner: iuc\n  revisions: 66e23b11feae\n  tool_panel_section_label: SAM/BAM\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: snpsift\n  owner: iuc\n  revisions: 5fab4f81391d\n  tool_panel_section_label: Variant Calling\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: snpsift\n  owner: iuc\n  revisions: 5fab4f81391d\n  tool_panel_section_label: Variant Calling\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: table_compute\n  owner: iuc\n  revisions: 3bf5661c0280\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: collapse_collections\n  owner: nml\n  revisions: 90981f86000f\n  tool_panel_section_label: Collection Operations\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":false,"slides_recordings":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial","contributors":[{"name":"Bérénice Batut","email":"berenice.batut@gmail.com","twitter":"bebatut","linkedin":"berenicebatut","matrix":"bebatut:matrix.org","orcid":"0000-0001-9852-1987","joined":"2017-09","elixir_node":"fr","contact_for_training":true,"location":{"country":"FR","lat":45.77,"lon":3.08},"fediverse":"https://piaille.fr/@bebatut","fediverse_flavor":"mastodon","affiliations":["gallantries","ifb","elixir-europe"],"id":"bebatut","url":"https://training.galaxyproject.org/training-material/api/contributors/bebatut.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/bebatut/"},{"name":"Engy Nasr","email":"engynasr94@gmail.com","orcid":"0000-0001-9047-4215","matrix":"EngyNasr:matrix.org","joined":"2021-05","elixir_node":"de","affiliations":["uni-freiburg","elixir-europe"],"id":"EngyNasr","url":"https://training.galaxyproject.org/training-material/api/contributors/EngyNasr.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/EngyNasr/"},{"name":"Paul Zierep","email":"zierep@informatik.uni-freiburg.de","orcid":"0000-0003-2982-388X","joined":"2023-02","affiliations":["uni-freiburg","elixir-europe"],"id":"paulzierep","url":"https://training.galaxyproject.org/training-material/api/contributors/paulzierep.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/paulzierep/"},{"name":"Hans-Rudolf Hotz","email":"hrhotz@googlemail.com","twitter":"hrhotz","fediverse":"https://genomic.social/@hrhotz","fediverse_flavor":"mastodon","matrix":"hrhotz:matrix.org","orcid":"0000-0002-2799-424X","linkedin":"hans-rudolf-hotz-542b31","joined":"2017-09","elixir_node":"ch","contact_for_training":true,"location":{"country":"CH","lat":47.57,"lon":7.6},"affiliations":["elixir-europe"],"id":"hrhotz","url":"https://training.galaxyproject.org/training-material/api/contributors/hrhotz.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/hrhotz/"},{"name":"Wolfgang Maier","orcid":"0000-0002-9464-6640","matrix":"wm75:matrix.org","joined":"2017-09","elixir_node":"de","fediverse":"https://scholar.social/@zerodivision","fediverse_flavor":"mastodon","affiliations":["by-covid","uni-freiburg","elixir-europe"],"id":"wm75","url":"https://training.galaxyproject.org/training-material/api/contributors/wm75.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/wm75/"},{"name":"Gallantries: Bridging Training Communities in Life Science, Environment and Health","short_name":"Gallantries","start_date":"2020-09-01","end_date":"2023-09-30","joined":"2020-09","avatar":"https://gallantries.github.io/assets/images/gallantries-logo.png","github":false,"funder":true,"url":"https://training.galaxyproject.org/training-material/api/funders/gallantries.json","funder_name":"Erasmus+ Programme","funding_id":"2020-1-NL01-KA203-064717","funding_system":"erasmusplus","funding_statement":"This project (<a href=\"https://erasmus-plus.ec.europa.eu/projects/search/details/2020-1-NL01-KA203-064717\"><code class=\"language-plaintext highlighter-rouge\">2020-1-NL01-KA203-064717</code></a>) is funded with the support of the Erasmus+ programme of the European Union. Their funding has supported a large number of tutorials within the GTN across a wide array of topics.\n<img src=\"https://gallantries.github.io/assets/images/logosbeneficaireserasmusright_en.jpg\" alt=\"eu flag with the text: with the support of the erasmus programme of the european union\" />\n<img src=\"https://www.erasmusplus.nl/assets/images/logo.png\" alt=\"erasmus plus logo\" />","members":["abretaud","bebatut","colineroyaux","fpsom","hexylena","shiltemann","yvanlebras"],"id":"gallantries","page":"https://training.galaxyproject.org/training-material/hall-of-fame/gallantries/"},{"name":"EOSC-Life","github":false,"joined":"2023-04","avatar":"https://www.eosc-life.eu/wp-content/themes/eosc-life-v2/assets/images/eosclogo.png","funder":true,"funding_id":"824087","funding_system":"cordis","funding_statement":"EOSC-Life has received funding from the European Union’s Horizon 2020 programme under grant agreement number 824087","url":"https://training.galaxyproject.org/training-material/api/funders/eosc-life.json","members":["bgruening"],"id":"eosc-life","page":"https://training.galaxyproject.org/training-material/hall-of-fame/eosc-life/"}]}