{"layout":"tutorial_hands_on","title":"Identification of the micro-organisms in a beer using Nanopore sequencing","zenodo_link":"https://doi.org/10.5281/zenodo.7093173","level":"Introductory","questions":["How can yeast strains in a beer sample be identified?","How can we process metagenomic data sequenced using Nanopore?"],"objectives":["Inspect metagenomics data","Run metagenomics tools","Identify yeast species contained in a sequenced beer sample using DNA","Visualize the microbiome community of a beer sample"],"time_estimation":"1H","key_points":["Data obtained by sequencing needs to be checked for quality and cleaned before further processing","Yeast species but also contamination can be identified and visualized directly from the sequences using several bioinformatics tools","With its graphical interface, Galaxy makes it easy to use the needed bioinformatics tools","Beer microbiome is not just made of yeast and can be quite complex"],"subtopic":"metagenomics","tags":["nanopore","beer","citizen science","metagenomics","microgalaxy"],"contributions":{"authorship":["plushz","chensy96","bebatut","teresa-m"],"funding":["gallantries"]},"redirect_from":["/topics/metagenomics/tutorials/beer-data-analysis/tutorial","/short/microbiome/beer-data-analysis","/short/T00200","/short/T00384"],"edam_ontology":["topic_3174","topic_3697","topic_0637","topic_0080"],"recordings":[{"youtube_id":"PJeS06yiJUM","speakers":["bebatut"],"captioners":["sophia120199"],"date":"2023-05-10","galaxy_version":"23.01","length":"1H5M"}],"js_requirements":{"mathjax":12074,"mermaid":false},"short_id":"T00384","url":"/topics/microbiome/tutorials/beer-data-analysis/tutorial.html","topic_name":"microbiome","tutorial_name":"beer-data-analysis","dir":"topics/microbiome/tutorials/beer-data-analysis","symlink":null,"id":"microbiome/beer-data-analysis","ref_tutorials":["<p>What is a microbiome? It is a collection of small living creatures.\nThese small creatures are called <strong>micro-organisms</strong> and they are <strong>everywhere</strong>. In our gut,\nin the soil, on vending machines, and even inside the beer. Most of these micro-organisms are\nactually very good for us, but some can make us very ill.</p>\n\n<p>Micro-organisms come in different shapes and sizes, but they have the same components.\nOne crucial component is the <strong>DNA</strong>, the blueprint of life. The DNA encodes the\nshape and size and many other characteristics unique to a species. Because DNA is so species-specific,\nreading the DNA can be used to identify what kind of micro-organism\nthe it is from. Therefore, within a metagenomic specimen, <em>e.g.</em> a sample form soil, gut,\nor beer, one can identify what kind of species are inside the sample.</p>\n\n<p>In this tutorial, we will use data of beer microbiome generated via the\n<a href=\"https://streetscience.community/projects/beerdecoded/\">BeerDEcoded project</a>.</p>\n\n<blockquote class=\"details\">\n  <details-title>The BeerDEcoded project</details-title>\n\n  <p>The BeerDEcoded Project is a series of workshops organized with and for schools as well as the general\naudience, aiming to introduce biology and genomic science. People learn in an interactive way\nabout DNA, sequencing technologies, bioinformatics, open science, how these technologies\nand concepts are applied and how they are impacting their daily life.</p>\n\n  <p>Beer is alive and contains many microorganisms. It can be found in many places\nand there are many of them. It is a fun media to bring the people to the\ncontact of molecular biology, data-analysis, and open science.</p>\n\n  <p>A BeerDEcoded workshop includes the following steps:</p>\n  <ol>\n    <li>Extract yeasts and their DNA from beer bottle,</li>\n    <li>Sequence the extracted DNA using a MinION sequencer to obtain the sequence of bases/nucleotides (A, T, C and G) for each DNA fragment in the sample,</li>\n    <li>Analyze the sequenced data in order to know which organisms this DNA is from</li>\n  </ol>\n\n  <p><a href=\"./images/beerprocess.png\" rel=\"noopener noreferrer\"><img src=\"./images/beerprocess.png\" alt=\"The image represents a BeerDEcoded workshop. On the left, there is a beer glass. An arrow goes from the bottle to DNA with &quot;Extraction&quot; written on the below. An arrow goes from DNA to DNA sequences with &quot;Sequencing&quot; written on the below. An arrow goes from the DNA sequences to Yeasts with &quot;Data analysis&quot; written on the below. \" width=\"1000\" height=\"253\" loading=\"lazy\" /></a></p>\n\n</blockquote>\n\n<blockquote class=\"comment\">\n  <comment-title>Beer microbiome</comment-title>\n\n  <p>Beer is alive! It contains microorganisms, in particular <strong>yeasts</strong>.</p>\n\n  <p>Indeed, grain and water create a sugary liquid (called wort). The beer brewer\nadds yeasts to it. By eating the sugar, yeast creates alcohol,\nand other compounds (esters, phenols, etc.) that give beer its particular\nflavor.</p>\n\n  <p>Yeasts are microorganisms, more precisely <strong>unicellular fungi</strong>. The majority\nof beers use a yeast genus called <strong><em>Saccharomyces</em></strong>, which in Greek means\n“sugar fungus”. Within that genus, two specific species of <em>Saccharomyces</em>\nare the most commonly used:</p>\n\n  <ul>\n    <li><strong><em>Saccharomyces cerevisiae</em></strong>: a top-fermenting (<em>i.e.</em> yeast which rise\nup to the top of the beer as it metabolizes sugars, delivering alcohol as a by-product),\nale yeast responsible for a huge range of beer styles like witbiers, stouts, ambers,\ntripels, saisons, IPAs, and many more. It is most likely the yeast that the early brewers were\ninadvertently brewing with over 3,000 years ago.</li>\n    <li><strong><em>Saccharomyces pastorianus</em></strong>: a bottom-fermenting (<em>i.e.</em> it sits on the\nbottom of the tank as it ferments) lager yeast, responsible for beer styles\nlike Pilsners, lagers, märzens, bocks, and more. This yeast was originally\nfound, and cultivated, by Bavarian brewers a little over 200 years ago. It is\nthe most commonly used yeast in terms of the raw amount of beer produced around the world.</li>\n  </ul>\n\n  <p>Since yeast is all around us, we can actually brew spontaneously\nfermented beer by using wild yeasts and souring microbiota floating through the air.</p>\n\n</blockquote>\n\n<p>During one BeerDEcoded workshop, we extracted yeasts out of a bottle of\n<a href=\"https://en.wikipedia.org/wiki/Chimay_Brewery\">Chimay</a>. We then\nextracted the DNA of these yeasts and sequenced it using a MinION to obtain the DNA\nsequences. Now, we would like to <strong>identify the yeast species</strong> sequenced there, and\nthereby <strong>outline the diversity of microorganisms</strong> (the microbiome community) in the beer\nsample.</p>\n\n<p>To get this information, we need to process the sequenced data in a few steps:</p>\n<ol>\n  <li>Check the quality of the data</li>\n  <li>Assign a taxonomic label, <em>i.e.</em> assign ‘species’ to each sequence</li>\n  <li>Visualize the distribution of the different species</li>\n</ol>\n\n<p>This type of data analysis requires running several bioinformatics tools and\nusually requires a computer science background. <a href=\"https://galaxyproject.org/\">Galaxy</a> is\nan open-source platform for data analysis that enables anyone to use bioinformatics\ntools through its graphical web interface, accessible via any Web browser.</p>\n\n<p>So, in this tutorial, we will use Galaxy to extract and visualize the community\nof yeasts from a bottle of beer.</p>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n  <p>In this tutorial, we will cover:</p>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#prepare-galaxy-and-data\" id=\"markdown-toc-prepare-galaxy-and-data\">Prepare Galaxy and data</a>    <ol>\n      <li><a href=\"#get-familiar-with-galaxy\" id=\"markdown-toc-get-familiar-with-galaxy\">Get familiar with Galaxy</a></li>\n      <li><a href=\"#get-data\" id=\"markdown-toc-get-data\">Get data</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#data-quality\" id=\"markdown-toc-data-quality\">Data quality</a>    <ol>\n      <li><a href=\"#assess-data-quality\" id=\"markdown-toc-assess-data-quality\">Assess data quality</a></li>\n      <li><a href=\"#improve-the-dataset-quality\" id=\"markdown-toc-improve-the-dataset-quality\">Improve the dataset quality</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#assign-taxonomic-classification\" id=\"markdown-toc-assign-taxonomic-classification\">Assign taxonomic classification</a></li>\n  <li><a href=\"#visualize-the-community\" id=\"markdown-toc-visualize-the-community\">Visualize the community</a></li>\n  <li><a href=\"#investigate-the-beer-microbiome\" id=\"markdown-toc-investigate-the-beer-microbiome\">Investigate the beer microbiome</a></li>\n  <li><a href=\"#optional-sharing-your-history\" id=\"markdown-toc-optional-sharing-your-history\">(Optional) Sharing your history</a></li>\n  <li><a href=\"#conclusion\" id=\"markdown-toc-conclusion\">Conclusion</a></li>\n</ol>\n\n</blockquote>\n\n<h1 id=\"prepare-galaxy-and-data\">Prepare Galaxy and data</h1>\n\n<p>First of all, this tutorial will get you hands on with some basic Galaxy tasks, including creating a history and importing data.</p>\n\n<h2 id=\"get-familiar-with-galaxy\">Get familiar with Galaxy</h2>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Open Galaxy</hands-on-title>\n\n  <ol>\n    <li>Open your favorite browser (Works on Chrome, Firefox, Safari but not Internet Explorer!)</li>\n    <li>\n      <p>Create a Galaxy account if you do not have one</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-how-do-i-create-an-account-on-a-public-galaxy-instance\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-how-do-i-create-an-account-on-a-public-galaxy-instance\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: How do I create an account on a public Galaxy instance?</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ol>   <li>     <p>To create an account at any public Galaxy instance, choose your server from the available <a href=\"https://galaxyproject.org/use/\">list of Galaxy Platforms</a>.</p>     <p>There are several UseGalaxy servers:</p>     <ul>       <li>         <p><a href=\"https://usegalaxy.org\">UseGalaxy.org</a> (<strong>US</strong>)</p>       </li>       <li>         <p><a href=\"https://usegalaxy.org.au\">UseGalaxy.org.au</a> (<strong>AU</strong>)</p>       </li>       <li>         <p><a href=\"https://usegalaxy.eu\">UseGalaxy.eu</a> (<strong>EU</strong>)</p>       </li>       <li>         <p><a href=\"https://usegalaxy.fr\">UseGalaxy.fr</a> (<strong>FR</strong>)</p>       </li>     </ul>   </li>   <li>     <p>Click on <strong>“Login or Register”</strong> in the masthead on the server.</p>     <p><img src=\"/training-material/faqs/galaxy/images/login_register.png\" alt=\"Login or Register on the top panel\" /></p>   </li>   <li>     <p>On the login page, find the <strong>Register here</strong> link and click on it.</p>   </li>   <li>     <p>Fill in the the registration form, then click on <strong>Create</strong>.</p>     <p>Your account should now get created, but will remain inactive until you verify the email address you provided in the registration form.</p>     <p><img src=\"/training-material/faqs/galaxy/images/unverified_account.png\" alt=\"Banner warning about account with unverified email address\" /></p>   </li>   <li>     <p>Check for a <strong>Confirmation Email</strong> in the email you used for account creation.</p>     <p>Missing? Check your <strong>Trash</strong> and <strong>Spam</strong> folders.</p>   </li>   <li>     <p>Click on the <strong>Email confirmation link</strong> to fully activate your account.</p>     <p><i class=\"fas fa-info-circle\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-info</span> Delivery of the confimation email is blocked by your email provider or you mistyped the email address in the registration form?</p>     <p>Please do <strong>not</strong> register again, but follow the <a href=\"/training-material/faqs/galaxy/user_preferences_manage_information.html\">instructions to change the email address</a> registered with your account! The confirmation email will be resent to your new address once you have changed it.</p>     <p>Trouble logging in later? Account email addresses and public names are caSe-sensiTive. Check your activation email for formats.</p>   </li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>The Galaxy homepage is divided into three panels:</p>\n<ul>\n  <li>Tools on the left</li>\n  <li>Viewing panel in the middle</li>\n  <li>History of analysis and files on the right</li>\n</ul>\n\n<figure id=\"figure-1\" style=\"max-width: 90%;\"><img src=\"/training-material/topics/introduction/images/galaxy_interface.png\" alt=\"Galaxy interface screenshot showing history panel on the right, tools panel on the left, and main panel at the center. \" width=\"1777\" height=\"1290\" loading=\"lazy\" /><a target=\"_blank\" href=\"/training-material/topics/introduction/images/galaxy_interface.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 1</strong>:</span> The Galaxy interface</figcaption></figure>\n\n<p>The first time you use Galaxy, there will be no files in your history panel.</p>\n\n<p>Any analysis should get its own Galaxy history. So let’s start by creating a new one:</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Prepare the Galaxy history</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Create a new history for this analysis</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-new-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-new-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a new history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>Click the <i class=\"fas fa-plus\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">new-history</span> icon at the top of the history panel:</p>   <p><img src=\"/training-material/shared/images/history_create_new.svg\" alt=\"UI for creating new history\" /></p>   <!-- the original drawing can be found here https://docs.google.com/drawings/d/1cCBrLAo4kDGic5QyB70rRiWJAKTenTU8STsKDaLcVU8/edit?usp=sharing --> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Rename the history</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-renaming-a-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-renaming-a-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Renaming a history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ol>   <li>Click on <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> (<strong>Edit</strong>) next to the history name (which by default is “Unnamed history”)</li>   <li>Type the new name</li>   <li>Click on <strong>Save</strong></li> </ol>   <p>If you do not have the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> (<strong>Edit</strong>) next to the history name:</p>   <ol>   <li>Click on <strong>Unnamed history</strong> (or the current name of the history) (<strong>Click to rename history</strong>) at the top of your history panel</li>   <li>Type the new name</li>   <li>Press <kbd>Enter</kbd></li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h2 id=\"get-data\">Get data</h2>\n\n<p>Before we can begin any Galaxy analysis, we need to upload the input data: FASTQ files</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Upload your dataset</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Import the sequenced data including fastq in the name</p>\n\n      <ul>\n        <li>\n          <p>Option 1 <a href=\"https://youtu.be/FFCDx1rMGAQ\"><i class=\"fas fa-video\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">video</span></a>: Your own local data using <strong>Upload Data</strong> (recommended for 1-10 datasets).</p>\n\n          <!--SNIPPET-->\n          <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-upload-few-files-1-10\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-upload-few-files-1-10\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Upload few files (1-10)</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ol>   <li>Click on <strong>Upload Data</strong> on the top of the left panel</li>   <li>Click on <strong>Choose local file</strong> and select the files or drop the files in the <strong>Drop files here</strong> part</li>   <li>Click on <strong>Start</strong></li>   <li>Click on <strong>Close</strong></li> </ol> </blockquote>\n          <p><!--END_SNIPPET--></p>\n        </li>\n        <li>\n          <p>Option 2: From Zenodo, an external server, via URL</p>\n\n          <div class=\"language-text highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/7093173/files/ABJ044_c38189e89895cdde6770a18635db438c8a00641b.fastq\n</code></pre></div>          </div>\n\n          <!--SNIPPET-->\n          <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-via-links\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-via-links\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing via links</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>\n          <p><!--END_SNIPPET--></p>\n        </li>\n      </ul>\n\n      <p>Your uploaded file is now in your current history. When the file is fully uploaded to Galaxy, it will turn green. But, what is this file?</p>\n    </li>\n    <li>\n      <p>Click on the <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> (eye) icon next to the dataset name to look at the file contents.</p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>The contents of the file will be displayed in the central Galaxy panel.</p>\n\n<p>This file contains the sequences, also called <strong>reads</strong>, of DNA, <em>i.e.</em> succession of nucleotides, for all fragments from the yeasts in the beer, in FASTQ format.</p>\n\n<!--SNIPPET-->\n<blockquote class=\"details\">   <div class=\"box-title details-title\" id=\"details-fastq-format\"><button class=\"gtn-boxify-button details\" type=\"button\" aria-controls=\"details-fastq-format\" aria-expanded=\"true\"><i class=\"fas fa-info-circle\" aria-hidden=\"true\"></i> <span>Details: FASTQ format</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>Although it looks complicated (and maybe it is), the FASTQ format is easy to understand with a little decoding. Each read, representing a fragment of DNA, is encoded by 4 lines:</p>   <table>   <thead>     <tr>       <th>Line</th>       <th>Description</th>     </tr>   </thead>   <tbody>     <tr>       <td>1</td>       <td>Always begins with <code class=\"language-plaintext highlighter-rouge\">@</code> followed by the information about the read</td>     </tr>     <tr>       <td>2</td>       <td>The actual nucleic sequence</td>     </tr>     <tr>       <td>3</td>       <td>Always begins with a <code class=\"language-plaintext highlighter-rouge\">+</code> and contains sometimes the same info in line 1</td>     </tr>     <tr>       <td>4</td>       <td>Has a string of characters which represent the quality scores associated with each base of the nucleic sequence; must have the same number of characters as line 2</td>     </tr>   </tbody> </table>   <p>So for example, the first sequence in our file is:</p>   <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>@03dd2268-71ef-4635-8bce-a42a0439ba9a runid=8711537cc800b6622b9d76d9483ecb373c6544e5 read=252 ch=179 start_time=2019-12-08T11:54:28Z flow_cell_id=FAL10820 protocol_group_id=la_trappe sample_id=08_12_2019<br />AGTAAGTAGCGAACCGGTTTCGTTTGGGTGTTTAACCGTTTTCGCATTTATCGTGAAACGCTTTCGCGTTTTCGTGCGGAAGGCGCTTCACCCAGGGCCTCTCATGCTTTGTCTTCCTGTTTATTCAGGATCGCCCAAAGCGAGAATCATACCACTAGACCACACGCCCGAATTATTGTTGCGTTAATAAGAAAAGCAAATATTTAAGATAGGAAGTGATTAAAGGGAATCTTCTACCAACAATATCCATTCAAATTCAGGCA<br />+<br />$'())#$$%#$%%'-$&amp;$%'%#$%('+;&lt;&gt;&gt;&gt;18.?ACLJM7E:CFIMK&lt;=@0/.4&lt;9&lt;&amp;$007:,3&lt;IIN&lt;3%+&amp;$(+#$%'$#$.2@401/5=49IEE=CH.20355&gt;-@AC@:B?7;=C4419)*$$46211075.$%..#,529,''=CFF@:&lt;?9B522.(&amp;%%(9:3E99&lt;BIL?:&gt;RB--**5,3(/.-8B&gt;F@@=?,9'36;:87+/19BAD@=8*''&amp;''7752'$%&amp;,5)AM&lt;99$%;EE;BD:=9&lt;@=9+%$<br /></code></pre></div></div>   <p>It means that the fragment named <code class=\"language-plaintext highlighter-rouge\">@03dd2268-71ef-4635-8bce-a42a0439ba9a</code> (ID given in line1) corresponds to:</p>   <ul>   <li>the DNA sequence <code class=\"language-plaintext highlighter-rouge\">AGTAAGTAGCGAACCGGTTTCGTTTGGGTGTTTAACCGTTTTCGCATTTATCGTGAAACGCTTTCGCGTTTTCGTGCGGAAGGCGCTTCACCCAGGGCCTCTCATGCTTTGTCTTCCTGTTTATTCAGGATCGCCCAAAGCGAGAATCATACCACTAGACCACACGCCCGAATTATTGTTGCGTTAATAAGAAAAGCAAATATTTAAGATAGGAAGTGATTAAAGGGAATCTTCTACCAACAATATCCATTCAAATTCAGGCA</code> (line2)</li>   <li>this sequence has been sequenced with a quality <code class=\"language-plaintext highlighter-rouge\">$'())#$$%#$%%'-$&amp;$%'%#$%('+;&lt;&gt;&gt;&gt;18.?ACLJM7E:CFIMK&lt;=@0/.4&lt;9&lt;&amp;$007:,3&lt;IIN&lt;3%+&amp;$(+#$%'$#$.2@401/5=49IEE=CH.20355&gt;-@AC@:B?7;=C4419)*$$46211075.$%..#,529,''=CFF@:&lt;?9B522.(&amp;%%(9:3E99&lt;BIL?:&gt;RB--**5,3(/.-8B&gt;F@@=?,9'36;:87+/19BAD@=8*''&amp;''7752'$%&amp;,5)AM&lt;99$%;EE;BD:=9&lt;@=9+%$</code> (line 4).</li> </ul>   <p>But what does this quality score mean?</p>   <p>The quality score for each sequence is a string of characters, one for each base of the nucleotide sequence, used to characterize the probability of misidentification of each base. The score is encoded using the ASCII character table (with <a href=\"https://en.wikipedia.org/wiki/FASTQ_format#Encoding\">some historical differences</a>):</p>   <p><img src=\"/training-material/topics/sequence-analysis/faqs/images/fastq-quality-encoding.png\" alt=\"Encoding of the quality score with ASCII characters for different Phred encoding. The ascii code sequence is shown at the top with symbols for 33 to 64, upper case letters, more symbols, and then lowercase letters. Sanger maps from 33 to 73 while solexa is shifted, starting at 59 and going to 104. Illumina 1.3 starts at 54 and goes to 104, Illumina 1.5 is shifted three scores to the right but still ends at 104. Illumina 1.8+ goes back to the Sanger except one single score wider. Illumina\" /></p>   <p>So there is an ASCII character associated with each nucleotide, representing its <a href=\"https://en.wikipedia.org/wiki/Phred_quality_score\">Phred quality score</a>, the probability of an incorrect base call:</p>   <table>   <thead>     <tr>       <th>Phred Quality Score</th>       <th>Probability of incorrect base call</th>       <th>Base call accuracy</th>     </tr>   </thead>   <tbody>     <tr>       <td>10</td>       <td>1 in 10</td>       <td>90%</td>     </tr>     <tr>       <td>20</td>       <td>1 in 100</td>       <td>99%</td>     </tr>     <tr>       <td>30</td>       <td>1 in 1000</td>       <td>99.9%</td>     </tr>     <tr>       <td>40</td>       <td>1 in 10,000</td>       <td>99.99%</td>     </tr>     <tr>       <td>50</td>       <td>1 in 100,000</td>       <td>99.999%</td>     </tr>     <tr>       <td>60</td>       <td>1 in 1,000,000</td>       <td>99.9999%</td>     </tr>   </tbody> </table> </blockquote>\n<p><!--END_SNIPPET--></p>\n\n<h1 id=\"data-quality\">Data quality</h1>\n\n<h2 id=\"assess-data-quality\">Assess data quality</h2>\n\n<p>Before starting to work on our data, it is necessary to assess its quality. This is an essential step if we aim to obtain a <strong>meaningful downstream analysis</strong>.</p>\n\n<p><strong>FastQC</strong> is one of the most widely used tools to <strong>check the quality</strong> of data generated by High Throughput Sequencing (HTS) technologies.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Quality check</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/devteam/fastqc/fastqc/0.73+galaxy0\" title=\"FASTQC tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>FASTQC</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.73+galaxy0)</span> with the following parameters\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Raw read data from your current history”</em>: <code class=\"language-plaintext highlighter-rouge\">Reads</code></li>\n      </ul>\n    </li>\n    <li>Inspect the generated HTML file</li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>Given the Basic Statistics table on the top of the page:</p>\n\n  <p><a href=\"./images/fastqc_top_table.png\" rel=\"noopener noreferrer\"><img src=\"./images/fastqc_top_table.png\" alt=\"Screenshot of the FastQC Basic Statistics with filename, file type (Conventional base calls), encoding (Sanger / Illumina 1.9), total Sequences (1876), sequences flagged as poor quality (0), sequence length (130-2327) and %GC (29). \" width=\"628\" height=\"284\" loading=\"lazy\" /></a></p>\n\n  <ol>\n    <li>How many sequences are in the FASTQ file?</li>\n    <li>How long are the sequences?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>There are 1876 sequences.</li>\n      <li>The sequences range from 130 nucleotides to 2327 nucleotides. Not all sequences have then the same length.</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<p><strong>FastQC</strong> provides information on various parameters, such as the range of quality values across all bases at each position:</p>\n\n<figure id=\"figure-2\" style=\"max-width: 90%;\"><img src=\"./images/fastqc_1.png\" alt=\"FastQC Per base sequence quality with scores below 20. \" width=\"840\" height=\"600\" loading=\"lazy\" /><a target=\"_blank\" href=\"./images/fastqc_1.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 2</strong>:</span> Per base sequence quality. X-axis: position in the reads (in base pair). Y-axis: quality score, between 0 and 40 - the higher the score, the better the base call. For each position, a boxplot is drawn with: the median value, represented by the central red line;the inter-quartile range (25-75%), represented by the yellow box; the 10% and 90% values in the upper and lower whiskers; and the mean quality, represented by the blue line. The background of the graph divides the y-axis into very good quality scores (green), scores of reasonable quality (orange), and reads of poor quality (red).</figcaption></figure>\n\n<p>We can see that the quality of our sequencing data grows after the first few bases, stays around a score of 18 and then decreases again at the end of the sequences. MinION and Oxford Nanopore Technologies (ONT) are known to have a higher error rate compared to other sequencing techniques and platforms (<span class=\"citation\"><a href=\"#delahaye2021sequencing\">Delahaye and Nicolas 2021</a></span>).</p>\n\n<p>For more detailed information about the other plots in the FASTQC report, check out our <a href=\"/training-material/topics/sequence-analysis/tutorials/quality-control/tutorial.html\">dedicated tutorial</a>.</p>\n\n<h2 id=\"improve-the-dataset-quality\">Improve the dataset quality</h2>\n\n<p>In order to improve the quality of our data, we will use two tools:</p>\n<ul>\n  <li><strong>porechop</strong> (<span class=\"citation\"><a href=\"#rrwick2017\">Wick 2017</a></span>) to remove adapters that were added for sequencing and chimera (contaminant)</li>\n  <li><strong>fastp</strong> (<span class=\"citation\"><a href=\"#Chen_2018\">Chen <i>et al.</i> 2018</a></span>) to filter sequences with low quality scores (below 10)</li>\n</ul>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Improve the dataset quality</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/porechop/porechop/0.2.4+galaxy0\" title=\"Porechop tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Porechop</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.2.4+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input FASTA/FASTQ”</em>:  <code class=\"language-plaintext highlighter-rouge\">Reads</code></li>\n        <li><em>“Output format for the reads”</em>: <code class=\"language-plaintext highlighter-rouge\">fastq</code></li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/fastp/fastp/0.23.2+galaxy0\" title=\"fastp tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>fastp</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.23.2+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><em>“Single-end or paired reads”</em>: <code class=\"language-plaintext highlighter-rouge\">Single-end</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input 1”</em>: output of <strong>Porechop</strong></li>\n            <li>In <em>“Adapter Trimming Options”</em>:\n              <ul>\n                <li><em>“Disable adapter trimming”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n        <li>In <em>“Filter Options”</em>:\n          <ul>\n            <li>In <em>“Quality filtering options”</em>:\n              <ul>\n                <li><em>“Qualified quality phred”</em>: <code class=\"language-plaintext highlighter-rouge\">10</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n        <li>In <em>“Read Modification Options”</em>:\n          <ul>\n            <li><em>“PolyG tail trimming”</em>: <code class=\"language-plaintext highlighter-rouge\">Disable polyG tail trimming</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>Inspect the HTML report of <strong>fastp</strong> to see how the quality has been improved</li>\n  </ol>\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>How many sequences are there before filtering? Is it the same number as in FASTQC report?</li>\n    <li>How many sequences are there after filtering? How many sequences have then been removed by filtering?</li>\n    <li>What is the mean length before filtering? And after filtering?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>There are 1,869 reads before filtering. The number is lower than in the FASTQC report. Some reads may have been discarded via Porechop</li>\n      <li>There are 1,350 reads after filtering. So the filtering step has removed \\(1869-1350 = 519\\) sequences.</li>\n      <li>The mean length is 314 nucleotide before filtering and 316bp after filtering.</li>\n    </ol>\n  </blockquote>\n\n</blockquote>\n\n<h1 id=\"assign-taxonomic-classification\">Assign taxonomic classification</h1>\n\n<p>One of the main aims in microbiome data analysis is to identify the organisms sequenced. For that we try to <strong>identify the taxon</strong> to which each individual read belong.</p>\n\n<!--SNIPPET-->\n<blockquote class=\"details\">   <div class=\"box-title details-title\" id=\"details-what-is-taxonomy\"><button class=\"gtn-boxify-button details\" type=\"button\" aria-controls=\"details-what-is-taxonomy\" aria-expanded=\"true\"><i class=\"fas fa-info-circle\" aria-hidden=\"true\"></i> <span>Details: What is Taxonomy?</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>Taxonomy is the method used to naming, defining (circumscribing) and classifying groups of biological organisms based on shared characteristics such as morphological characteristics, phylogenetic characteristics, DNA data, etc. It is founded on the concept that the similarities descend from a common evolutionary ancestor.</p>   <p>Defined groups of organisms are known as <strong>taxa</strong>. Taxa are given a taxonomic rank and are aggregated into super groups of higher rank to create a taxonomic hierarchy. The taxonomic hierarchy includes eight levels: <strong>Domain, Kingdom, Phylum, Class, Order, Family, Genus and Species.</strong></p>   <p><img src=\"/training-material/topics/microbiome/faqs/images/taxonomy.png\" alt=\"Example of taxonomy. It starts, top to bottom, with Kingdom &quot;Animalia&quot;, Phylum &quot;Chordata&quot;, Class &quot;Mammalia&quot;, and Order &quot;Carnivora&quot;. Then it splits in 3. On the left, Family &quot;Felidae&quot;, with 2 genus &quot;Felis&quot; and &quot;Panthera&quot; and below 3 species &quot;F. catus&quot; and &quot;F. pardalis&quot; below &quot;Felis&quot;, &quot;P. pardus&quot; below &quot;Panthera&quot;. In the middle, Family &quot;Canidae&quot;, genus &quot;Canis&quot; and 2 species &quot;C. familiaris&quot; and &quot;C. lupus&quot;. On the right, Family &quot;Ursidae&quot;, Genus &quot;Ursus&quot; and 2 species &quot;U. arctos&quot; and &quot;U. horribilus&quot;. Below each species is a illustration of the species\" /></p>   <p>The classification system begins with <strong>3 domains</strong> that encompass all living and extinct forms of life</p>   <ul>   <li>The <strong>Bacteria</strong> and <strong>Archae</strong> are mostly microscopic, but quite widespread.</li>   <li>Domain <strong>Eukarya</strong> contains more complex organisms</li> </ul>   <p>When new species are found, they are assigned into taxa in the taxonomic hierarchy. For example for the cat:</p>   <table>   <thead>     <tr>       <th>Level</th>       <th>Classification</th>     </tr>   </thead>   <tbody>     <tr>       <td>Domain</td>       <td>Eukaryota</td>     </tr>     <tr>       <td>Kingdom</td>       <td>Animalia</td>     </tr>     <tr>       <td>Phylum</td>       <td>Chordata</td>     </tr>     <tr>       <td>Class</td>       <td>Mammalia</td>     </tr>     <tr>       <td>Order</td>       <td>Carnivora</td>     </tr>     <tr>       <td>Family</td>       <td>Felidae</td>     </tr>     <tr>       <td>Genus</td>       <td><em>Felis</em></td>     </tr>     <tr>       <td>Species</td>       <td><em>F. catus</em></td>     </tr>   </tbody> </table>   <p>From this classification, one can generate a tree of life, also known as a phylogenetic tree. It is a rooted tree that describes the relationship of all life on earth. At the root sits the “last universal common ancestor” and the three main branches (in taxonomy also called domains) are bacteria, archaea and eukaryotes. Most important for this is the idea that all life on earth is derived from a common ancestor and therefore when comparing two species, you will -sooner or later- find a common ancestor for all of them.</p>   <p>Let’s explore taxonomy in the Tree of Life, using <a href=\"https://lifemap.univ-lyon1.fr/\">Lifemap</a></p>   <iframe id=\"Lifemap\" src=\"https://lifemap.univ-lyon1.fr/explore.html\" frameborder=\"0\" width=\"100%\" height=\"600px\"></iframe> </blockquote>\n<p><!--END_SNIPPET--></p>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>Which microorganisms do we expect to identify in our data?</li>\n    <li>What is the taxonomy of the main expected microorganism?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>\n        <p>The sequences are supposed to be yeasts extracted from a bottle of beer. The majority of beers contain a yeast genus called <strong><em>Saccharomyces</em></strong> and 2 species in that genus: <em>Saccharomyces cerevisiae</em> (ale yeast) and <em>Saccharomyces pastorianus</em> (lager yeast). The used beer is an ale beer, so we expect to find <strong><em>Saccharomyces cerevisiae</em></strong>. But other yeasts can also have been used and then found. We could also have some DNA left from other beer components, but also contaminations by other microorganisms and even human DNA from people who manipulated the beer or did the extraction.</p>\n      </li>\n      <li>\n        <p>The main expected microorganism is <strong><em>Saccharomyces cerevisiae</em></strong> with its taxonomy:</p>\n\n        <table>\n          <thead>\n            <tr>\n              <th>Level</th>\n              <th>Classification</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr>\n              <td>Domain</td>\n              <td>Eukaryota</td>\n            </tr>\n            <tr>\n              <td>Kingdom</td>\n              <td>Fungi</td>\n            </tr>\n            <tr>\n              <td>Phylum</td>\n              <td>Ascomycota</td>\n            </tr>\n            <tr>\n              <td>Class</td>\n              <td>Saccharomycetes</td>\n            </tr>\n            <tr>\n              <td>Order</td>\n              <td>Saccharomycetales</td>\n            </tr>\n            <tr>\n              <td>Family</td>\n              <td>Saccharomycetaceae</td>\n            </tr>\n            <tr>\n              <td>Genus</td>\n              <td><em>Saccharomyces</em></td>\n            </tr>\n            <tr>\n              <td>Species</td>\n              <td><em>S. cerevisiae</em></td>\n            </tr>\n          </tbody>\n        </table>\n      </li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<p>Taxonomic assignment or classification is the process of assigning an <strong>Operational Taxonomic Unit</strong> (OTUs, that is, groups of related individuals / taxon) to sequences. To assign an OTU to a sequence it is compared against a database, but this comparison can be done in different ways, with different bioinformatics tools. Here we will use <strong>Kraken2</strong> (<span class=\"citation\"><a href=\"#wood2019improved\">Wood <i>et al.</i> 2019</a></span>).</p>\n\n<!--SNIPPET-->\n<blockquote class=\"details\">   <div class=\"box-title details-title\" id=\"details-kraken2-and-the-k-mer-approach-for-taxonomy-classification\"><button class=\"gtn-boxify-button details\" type=\"button\" aria-controls=\"details-kraken2-and-the-k-mer-approach-for-taxonomy-classification\" aria-expanded=\"true\"><i class=\"fas fa-info-circle\" aria-hidden=\"true\"></i> <span>Details: Kraken2 and the k-mer approach for taxonomy classification</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>In the \\(k\\)-mer approach for taxonomy classification, we use a database containing DNA sequences of genomes whose taxonomy we already know. On a computer, the genome sequences are broken into short pieces of length \\(k\\) (called \\(k\\)-mers), usually 30bp.</p>   <p><strong>Kraken</strong> examines the \\(k\\)-mers within the query sequence, searches for them in the database, looks for where these are placed within the taxonomy tree inside the database, makes the classification with the most probable position, then maps \\(k\\)-mers to the lowest common ancestor (LCA) of all genomes known to contain the given \\(k\\)-mer.</p>   <p><img src=\"/training-material/topics/microbiome/faqs/images/kmers-kraken.jpg\" alt=\"Kraken2\" title=\"Kraken sequence classification algorithm. To classify a sequence, each k-mer in the sequence is mapped to the lowest common ancestor (LCA, i.e. the lowest node) of the genomes that contain that k-mer in the database. The taxa associated with the sequence's k-mers, as well as the taxa's ancestors, form a pruned subtree of the general taxonomy tree, which is used for classification. In the classification tree, each node has a weight equal to the number of k-mers in the sequence associated with the node's taxon. Each root-to-leaf (RTL) path in the classification tree is scored by adding all weights in the path, and the maximal RTL path in the classification tree is the classification path (nodes highlighted in yellow). The leaf of this classification path (the orange, leftmost leaf in the classification tree) is the classification used for the query sequence. Source: &lt;span class=&quot;citation&quot;&gt;&lt;a href=&quot;#Wood2014&quot;&gt;Wood and Salzberg 2014&lt;/a&gt;&lt;/span&gt;\" /></p>   <p><strong>Kraken2</strong> uses a compact hash table, a probabilistic data structure that allows for faster queries and lower memory requirements. It applies a spaced seed mask of <em>s</em> spaces to the minimizer and calculates a compact hash code, which is then used as a search query in its compact hash table; the lowest common ancestor (LCA) taxon associated with the compact hash code is then assigned to the k-mer.</p>   <p>You can find more information about the <strong>Kraken2</strong> algorithm in the paper <a href=\"https://genomebiology.biomedcentral.com/articles/10.1186/s13059-019-1891-0\"><em>Improved metagenomic analysis with Kraken 2</em></a>.</p> </blockquote>\n<p><!--END_SNIPPET--></p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Kraken2</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/kraken2/kraken2/2.1.1+galaxy1\" title=\"Kraken2 tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Kraken2</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.1.1+galaxy1)</span> with the following parameters:\n      <ul>\n        <li><em>“Single or paired reads”</em>: <code class=\"language-plaintext highlighter-rouge\">Single</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input sequences”</em>: Output of <strong>fastp</strong></li>\n          </ul>\n        </li>\n        <li><em>“Print scientific names instead of just taxids”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        <li>In <em>“Create Report”</em>:\n          <ul>\n            <li><em>“Print a report with aggregrate counts/clade to file”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n          </ul>\n        </li>\n        <li>\n          <p><em>“Select a Kraken2 database”</em>: <code class=\"language-plaintext highlighter-rouge\">Prebuilt Refseq indexes: PlusPF</code></p>\n\n          <p>The database here contains reference sequences and taxonomies. We need to\nbe sure it contains yeasts, i.e. fungi.</p>\n        </li>\n      </ul>\n    </li>\n    <li>Inspect the report file</li>\n  </ol>\n</blockquote>\n\n<p>The Kraken report is a tabular files with one line per taxon and 6 columns or fields:</p>\n\n<ol>\n  <li>Percentage of fragments covered by the clade rooted at this taxon</li>\n  <li>Number of fragments covered by the clade rooted at this taxon</li>\n  <li>Number of fragments assigned directly to this taxon</li>\n  <li>A rank code, indicating\n    <ul>\n      <li>(U)nclassified</li>\n      <li>(R)oot</li>\n      <li>(D)omain</li>\n      <li>(K)ingdom</li>\n      <li>(P)hylum</li>\n      <li>(C)lass</li>\n      <li>(O)rder</li>\n      <li>(F)amily</li>\n      <li>(G)enus, or</li>\n      <li>(S)pecies</li>\n    </ul>\n\n    <p>Taxa that are not at any of these 10 ranks have a rank code that is formed by using the rank code of the closest ancestor rank with a number indicating the distance from that rank. E.g., <code class=\"language-plaintext highlighter-rouge\">G2</code> is a rank code indicating a taxon is between genus and species and the grandparent taxon is at the genus rank.</p>\n  </li>\n  <li>NCBI taxonomic ID number</li>\n  <li>Indented scientific name</li>\n</ol>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>Column 1\tColumn 2\tColumn 3\tColumn 4\tColumn 5\tColumn 6\n38.00 \t513 \t513 \tU \t0 \tunclassified\n62.00 \t837 \t1 \tR \t1 \troot\n61.93 \t836 \t27 \tR1 \t131567 \tcellular organisms\n56.00 \t756 \t3 \tD \t2759 \tEukaryota\n55.33 \t747 \t3 \tD1 \t33154 \tOpisthokonta\n29.78 \t402 \t0 \tK \t33208 \tMetazoa\n29.78 \t402 \t0 \tK1 \t6072 \tEumetazoa\n29.78 \t402 \t0 \tK2 \t33213 \tBilateria\n29.78 \t402 \t0 \tK3 \t33511 \tDeuterostomia\n29.78 \t402 \t0 \tP \t7711 \tChordata\n29.78 \t402 \t0 \tP1 \t89593 \tCraniata\n29.78 \t402 \t0 \tP2 \t7742 \tVertebrata\n29.78 \t402 \t0 \tP3 \t7776 \tGnathostomata\n29.78 \t402 \t0 \tP4 \t117570 \tTeleostomi\n29.78 \t402 \t0 \tP5 \t117571 \tEuteleostomi\n29.78 \t402 \t0 \tP6 \t8287 \tSarcopterygii\n29.78 \t402 \t0 \tP7 \t1338369 \tDipnotetrapodomorpha\n29.78 \t402 \t0 \tP8 \t32523 \tTetrapoda\n29.78 \t402 \t0 \tP9 \t32524 \tAmniota\n29.78 \t402 \t0 \tC \t40674 \tMammalia \n</code></pre></div></div>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>How many taxons have been identified?</li>\n    <li>How much reads have been classified?</li>\n    <li>Which domains were found and with how many reads?</li>\n    <li>How much reads have been assigned by fungi Kingdom?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>\n        <p>The file contains 300 lines (<em>information visible when expanding the report dataset in the history panel</em>). So 300-2 = 298 taxons have been identified.</p>\n      </li>\n      <li>\n        <p>On the 1350 sequences in the input, 837 (62%) were classified (or identified as a taxon) and 513 unclassified (38%). <em>Information visible when expanding the report dataset in the history panel, and scrolling in the small box starting with “Loading database information” below the format information, but also on the top of the report.</em></p>\n      </li>\n      <li>\n        <p>The domains are identified by a <code class=\"language-plaintext highlighter-rouge\">D</code> in colum 4.</p>\n\n        <p>To get the domains (or other taxonomic level), we can use <span class=\"tool\" data-tool=\"Filter1\" title=\"Filter tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Filter</strong></span> with the following parameters:</p>\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Filter”</em>: report outpout of <strong>Kraken2</strong></li>\n          <li><em>“With following condition”</em>: <code class=\"language-plaintext highlighter-rouge\">c4=='D'</code></li>\n        </ul>\n\n        <p>The 3 domains were found:</p>\n        <ul>\n          <li>Eukaryota with 756 (56%) reads assigned to it</li>\n          <li>Bacteria with 51 (3.78%) reads</li>\n          <li>Archaea with 2 (0.15%) reads</li>\n        </ul>\n      </li>\n      <li>\n        <p>342 (25.33%) reads are assigned to fungi.</p>\n      </li>\n    </ol>\n  </blockquote>\n\n</blockquote>\n\n<p>Other taxons than yeast have been identified. They could be contamination or misidentification of reads. Indeed, many taxons have less than 5 reads assigned. We will filter these reads out to get a better view of the possible contaminations.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Filter taxons with low assignements</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"Filter1\" title=\"Filter tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Filter</strong></span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Filter”</em>: report outpout of <strong>Kraken2</strong></li>\n        <li>\n          <p><em>“With following condition”</em>: <code class=\"language-plaintext highlighter-rouge\">c2&gt;5</code></p>\n\n          <p>We want to keep only taxons with more than 5 reads assigned, <em>i.e.</em> the value in the 2nd column, is higher than 5.</p>\n        </li>\n      </ul>\n    </li>\n    <li>Inspect the output</li>\n  </ol>\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>How many taxons have been removed? How many were kept?</li>\n    <li>What are the possible contaminations?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n    <ol>\n      <li>\n        <p>59 lines are now in the file so \\(300 - 59 = 241\\) taxons have been removed because low assignment rates.</p>\n      </li>\n      <li>\n        <p>Most of the reads (402) were assigned to humans (<em>Homo sapiens</em>). This is likely a contamination either during the beer production or more likely during DNA extraction.</p>\n\n        <p>Bacteria were also found: Firmicutes, Proteobacteria and Bacteroidetes. But the identified taxons are not really precise (not below order level). So difficult to identify the possible source of contamination.</p>\n      </li>\n    </ol>\n  </blockquote>\n</blockquote>\n\n<h1 id=\"visualize-the-community\">Visualize the community</h1>\n\n<p>Once we have assigned the corresponding taxa to the sequences, the next step is to properly visualize the data: visualize the diversity of taxons at different levels.</p>\n\n<p>To do that, we will use the tool <strong>Krona</strong> (<span class=\"citation\"><a href=\"#Ondov_2011\">Ondov <i>et al.</i> 2011</a></span>). But before that, we need to adjust the output from Kraken2 to the requirements of <strong>Krona</strong>. Indeed, <strong>Krona</strong> expects as input a table with the first column containing a count and the remaining columns describing the hierarchy. Currently, we have a report tabular file with the first column containing the taxonomy and the second column the number of reads. We will now use another tool, which also provides taxonomic classification, but it produces the exact formatting Krona needs.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Prepare dataset for Krona</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/krakentools_kreport2krona/krakentools_kreport2krona/1.2+galaxy0\" title=\"Krakentools: Convert kraken report file tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Krakentools: Convert kraken report file</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.2+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“Kraken report file”</em>: <strong>Report</strong> output of <strong>Kraken</strong></li>\n      </ul>\n    </li>\n    <li>\n      <p>Inspect the output file</p>\n\n      <blockquote class=\"question\">\n        <question-title></question-title>\n\n        <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>Column 1\tColumn 2\tColumn 3\tColumn 4\tColumn 5\tColumn 6\tColumn 7\tColumn 8\n513 \tUnclassified \t\t\t\t\t\t\n7 \tk__Eukaryota \t\t\t\t\t\t\n0 \tk__Eukaryota \tp__Chordata \t\t\t\t\t\n0 \tk__Eukaryota \tp__Chordata \tc__Mammalia \t\t\t\t\n0 \tk__Eukaryota \tp__Chordata \tc__Mammalia \to__Primates \t\t\t\n0 \tk__Eukaryota \tp__Chordata \tc__Mammalia \to__Primates \tf__Hominidae \t\t\n0 \tk__Eukaryota \tp__Chordata \tc__Mammalia \to__Primates \tf__Hominidae \tg__Homo \t\n402 \tk__Eukaryota \tp__Chordata \tc__Mammalia \to__Primates \tf__Hominidae \tg__Homo \ts__Homo_sapiens\t\t\t\t\t\n</code></pre></div>        </div>\n\n        <ol>\n          <li>What are the columns in the file?</li>\n        </ol>\n\n        <blockquote class=\"solution\">\n          <solution-title></solution-title>\n          <ol>\n            <li>8 columns: one with the number of reads and one for each of the 7 levels of taxonomy.</li>\n          </ol>\n        </blockquote>\n      </blockquote>\n    </li>\n  </ol>\n</blockquote>\n\n<p>We can now run <strong>Krona</strong>. This tool creates an interactive report that allows hierarchical data (like taxonomy) to be explored with zooming, as multi-layered pie charts. With this tool, we can easily visualize the composition of a microbiome community.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Krona pie chart</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/crs4/taxonomy_krona_chart/taxonomy_krona_chart/2.7.1+galaxy0\" title=\"Krona pie chart tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Krona pie chart</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.7.1+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><em>“What is the type of your input data”</em>: <code class=\"language-plaintext highlighter-rouge\">Tabular</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input file”</em>:  output of <strong>Krakentools</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>Inspect the generated file</li>\n  </ol>\n</blockquote>\n\n<p>Let’s take a look at the result.</p>\n\n<iframe id=\"krona\" src=\"krona.html\" frameborder=\"0\" width=\"100%\" height=\"900px\"> <a href=\"./images/krona.png\" rel=\"noopener noreferrer\"><img src=\"./images/krona.png\" alt=\"Krona chart with multi-layered pie chart representing the community profile with in the center the higher taxonomy levels (i.e. domain) and on the exterior the more detailed ones (i.e. species). \" width=\"2342\" height=\"2248\" loading=\"lazy\" /></a> </iframe>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>What is the percentage of reads assigned to <em>Homo sapiens</em>?</li>\n    <li>To Archaea?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>30% of reads are assigned to <em>Homo sapiens</em></li>\n      <li>0.08% of Archaea</li>\n    </ol>\n  </blockquote>\n\n</blockquote>\n\n<h1 id=\"investigate-the-beer-microbiome\">Investigate the beer microbiome</h1>\n\n<p>Let’s come back to our original question: characterization of the beer microbiome, specially looking at the yeasts.</p>\n\n<p>Yeasts do not form a single taxonomic group (<span class=\"citation\"><a href=\"#kurtzman1994molecular\">Kurtzman 1994</a></span>). They are parts of the fungi kingdom but belong two separate phyla: the Ascomycota and the Basidiomycota. <a href=\"https://web.archive.org/web/20090226151906/http://www.yeastgenome.org/VL-what_are_yeast.html\">But the “true yeasts” are classified in the order Saccharomycetales</a>.</p>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n  <ol>\n    <li>Click on <code class=\"language-plaintext highlighter-rouge\">o__Saccharomycetales</code> in the graph (Krona pie chart). Which yeast species have been identified? Are they the expected in beer?</li>\n    <li>Click on <em>Saccharomyces</em> in the graph. What are the percentages of identified reads assigned to <em>Saccharomyces</em> for different levels?</li>\n    <li>Click a second time on <em>Saccharomyces</em> in the graph. What is the repartition between the different <em>Saccharomyces</em> species?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>6 species from the Saccharomycetales order have been identified:\n        <ul>\n          <li>Saccharomycetaceae family\n            <ul>\n              <li><em>Saccharomyces</em> genus\n                <ul>\n                  <li><em>Saccharomyces cerevisiae</em> species, the most abundant identified yeast species with 293 reads and the one expected given the type of beers</li>\n                  <li>\n                    <p><em>Saccharomyces paradoxus</em> species, a wild yeast and the closest known species to <em>Saccharomyces cerevisiae</em></p>\n\n                    <p>These reads might have been misidentified to <em>Saccharomyces paradoxus</em> instead of <em>Saccharomyces cerevisiae</em> because of some errors in the sequences, as <em>Saccharomyces cerevisiae</em> and <em>Saccharomyces paradoxus</em> are close species and should share then a lot of similarity in their sequences.</p>\n                  </li>\n                  <li>\n                    <p><em>Saccharomyces eubayanus</em> species, most likely the parent of the lager brewing yeast, <em>Saccharomyces pastorianus</em> (<span class=\"citation\"><a href=\"#sampaio2018microbe\">Sampaio 2018</a></span>)</p>\n\n                    <p>Similar to <em>Saccharomyces paradoxus</em>, these reads might have been misassigned.</p>\n                  </li>\n                </ul>\n              </li>\n              <li><em>Kluyveromyces</em> genus - <em>Kluyveromyces marxianus</em> species: only 1 read</li>\n            </ul>\n          </li>\n          <li>Trichomonascaceae family - <em>Sugiyamaella</em> genus - <em>Sugiyamaella lignohabitans</em> species: only 1 read</li>\n          <li>Debaryomycetaceae family - <em>Candida</em> genus - <em>Candida dubliniensis</em> species: only 1 read</li>\n        </ul>\n\n        <p>Everything except <em>Saccharomyces cerevisiae</em> are probably misindentified reads.</p>\n      </li>\n      <li>Reads are assigned to <em>Saccharomyces</em>\n        <ul>\n          <li>25% out of total reads (root)</li>\n          <li>44% out of identified reads for Eukaryota domain</li>\n          <li>96% out of identified reads for Ascomycota phylum</li>\n          <li>98% out of identified reads for Saccharomycetales order</li>\n          <li>99% out of identified reads for Saccharomycetaceae family</li>\n        </ul>\n\n        <p><a href=\"./images/krona_saccharomyces_1.png\" rel=\"noopener noreferrer\"><img src=\"./images/krona_saccharomyces_1.png\" alt=\"Krona chart with multi-layered pie chart representing the community profile with in the center the higher taxonomy levels (i.e. domain) and on the exterior the more detailed ones (i.e. species). *Saccharomyces* is highligthed with on the right the percentages of identified reads assigned to *Saccharomyces* for the different taxonomic levels. \" width=\"2342\" height=\"2248\" loading=\"lazy\" /></a></p>\n      </li>\n      <li>\n        <p>92% of <em>Saccharomyces</em> reads are assigned to <em>Saccharomyces cerevisiae</em>, 5% to <em>Saccharomyces paradoxus</em> and 3% to <em>Saccharomyces eubayanus</em>,.</p>\n\n        <p><a href=\"./images/krona_saccharomyces_2.png\" rel=\"noopener noreferrer\"><img src=\"./images/krona_saccharomyces_2.png\" alt=\"Krona chart with the community profile for *Saccharomyces* with the different species. \" width=\"2342\" height=\"2248\" loading=\"lazy\" /></a></p>\n      </li>\n    </ol>\n  </blockquote>\n\n</blockquote>\n\n<p>Microbiome of several beers, including Chimay beers, have been previously investigated by targeting specifically the fungi, in which we can find yeasts (<span class=\"citation\"><a href=\"#sobel2017beerdecoded\">Sobel <i>et al.</i> 2017</a></span>):</p>\n\n<figure id=\"figure-3\" style=\"max-width: 90%;\"><img src=\"./images/beerdecoded.gif\" alt=\"Heatmap with rows being type of beers and columns fungi species. For the rows, the name of beers are on the right and clustering tree on the left side of the heatmap. For the columns, the name of the species are on the bottom and the clustering tree on the top. The fungi species are sorted from the least abundant on the left to the most abundant on the right.\" width=\"1000\" height=\"940\" loading=\"lazy\" /><a target=\"_blank\" href=\"./images/beerdecoded.gif\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 3</strong>:</span> Heatmap of the number of reads per internal transcribed spacer (ITS) sequencing of fungal species per beer. Source <span class=\"citation\"><a href=\"#sobel2017beerdecoded\">Sobel <i>et al.</i> 2017</a></span></figcaption></figure>\n\n<p>The species identified for Chimay beers are (from the most abundant to the least one):</p>\n<ul>\n  <li><em>Saccharomyces cerevisiae</em></li>\n  <li><em>Saccharomyces mikatea</em>: a species generally used in winemaking (<span class=\"citation\"><a href=\"#bellon2013introducing\">Bellon <i>et al.</i> 2013</a></span>)</li>\n  <li>\n    <p><em>Kazachstania martiniae</em>: <em>Kazachstania</em> is a genus from the family Saccharomycetaceaethe.</p>\n  </li>\n  <li><em>Saccharomyces kudriavzevii</em></li>\n  <li>\n    <p><em>Brettanomyces bruxellensis</em></p>\n\n    <p><em>Brettanomyces</em> is a non-spore forming genus of yeast in the family Saccharomycetaceae, and is important to both the brewing and wine industries due to the sensory compounds it produces.</p>\n\n    <p><em>Brettanomyces bruxellensis</em> is typically used for the production of the Belgian beers.</p>\n  </li>\n  <li><em>Saccharomyces paradoxus</em>: a wild yeast species closely related to <em>Saccharomyces cerevisiae</em></li>\n  <li><em>Kazachstania kunashirensis</em></li>\n  <li><em>Saccharomyces cariocanus</em>: a wild yeast species closely related to <em>Saccharomyces cerevisiae</em></li>\n  <li><em>Filobasidium magnum</em></li>\n  <li><em>Malasseria restricta</em></li>\n  <li><em>Pichia kudriavzevii</em></li>\n  <li><em>Aureobasidium pullulans</em></li>\n  <li><em>Sporidiobolus metaroseus</em></li>\n</ul>\n\n<p>In a structured way:</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>Phylum</th>\n      <th>Class</th>\n      <th>Order</th>\n      <th>Family</th>\n      <th>Genus</th>\n      <th>Species</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>Ascomycota</td>\n      <td>Saccharomycetes</td>\n      <td>Saccharomycetales</td>\n      <td>Saccharomycetaceae</td>\n      <td>Saccharomyces</td>\n      <td><em>Saccharomyces cerevisiae</em></td>\n    </tr>\n    <tr>\n      <td>Ascomycota</td>\n      <td>Saccharomycetes</td>\n      <td>Saccharomycetales</td>\n      <td>Saccharomycetaceae</td>\n      <td>Saccharomyces</td>\n      <td><em>Saccharomyces mikatea</em></td>\n    </tr>\n    <tr>\n      <td>Ascomycota</td>\n      <td>Saccharomycetes</td>\n      <td>Saccharomycetales</td>\n      <td>Saccharomycetaceae</td>\n      <td>Saccharomyces</td>\n      <td><em>Saccharomyces kudriavzevii</em></td>\n    </tr>\n    <tr>\n      <td>Ascomycota</td>\n      <td>Saccharomycetes</td>\n      <td>Saccharomycetales</td>\n      <td>Saccharomycetaceae</td>\n      <td>Saccharomyces</td>\n      <td><em>Saccharomyces paradoxus</em></td>\n    </tr>\n    <tr>\n      <td>Ascomycota</td>\n      <td>Saccharomycetes</td>\n      <td>Saccharomycetales</td>\n      <td>Saccharomycetaceae</td>\n      <td>Saccharomyces</td>\n      <td><em>Saccharomyces cariocanus</em></td>\n    </tr>\n    <tr>\n      <td>Ascomycota</td>\n      <td>Saccharomycetes</td>\n      <td>Saccharomycetales</td>\n      <td>Saccharomycetaceae</td>\n      <td>Kazachstania</td>\n      <td><em>Kazachstania martiniae</em></td>\n    </tr>\n    <tr>\n      <td>Ascomycota</td>\n      <td>Saccharomycetes</td>\n      <td>Saccharomycetales</td>\n      <td>Saccharomycetaceae</td>\n      <td>Kazachstania</td>\n      <td><em>Kazachstania kunashirensis</em></td>\n    </tr>\n    <tr>\n      <td>Ascomycota</td>\n      <td>Saccharomycetes</td>\n      <td>Saccharomycetales</td>\n      <td>Saccharomycetaceae</td>\n      <td>Brettanomyces</td>\n      <td><em>Brettanomyces bruxellensis</em></td>\n    </tr>\n    <tr>\n      <td>Ascomycota</td>\n      <td>Saccharomycetes</td>\n      <td>Saccharomycetales</td>\n      <td>Saccharomycetaceae</td>\n      <td> </td>\n      <td><em>Pichia kudriavzevii</em></td>\n    </tr>\n    <tr>\n      <td>Ascomycota</td>\n      <td>Dothideomycetes</td>\n      <td>Dothideales</td>\n      <td>Dothioraceae</td>\n      <td>Aureobasidium</td>\n      <td><em>Aureobasidium pullulans</em></td>\n    </tr>\n    <tr>\n      <td>Basidiomycota</td>\n      <td>Tremellomycetes</td>\n      <td>Filobasidiales</td>\n      <td>Filobasidiaceae</td>\n      <td>Filobasidium</td>\n      <td><em>Filobasidium magnum</em></td>\n    </tr>\n    <tr>\n      <td>Basidiomycota</td>\n      <td>Malasseziomycetes</td>\n      <td>Malasseziales</td>\n      <td>Malasseziaceae</td>\n      <td>Malassezia</td>\n      <td><em>Malasseria restricta</em></td>\n    </tr>\n    <tr>\n      <td>Basidiomycota</td>\n      <td>Sporidiobolales</td>\n      <td>Sporidiobolales</td>\n      <td>Sporidiobolaceae</td>\n      <td>Sporidiobolus</td>\n      <td><em>Sporidiobolus metaroseus</em></td>\n    </tr>\n  </tbody>\n</table>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>By looking at the output of <strong>Krakentools</strong>, which fungi species identified for the Chimay beers in <span class=\"citation\"><a href=\"#sobel2017beerdecoded\">Sobel <i>et al.</i> 2017</a></span> are also identified in our data? And vice versa?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <table>\n      <thead>\n        <tr>\n          <th>Phylum</th>\n          <th>Class</th>\n          <th>Order</th>\n          <th>Family</th>\n          <th>Genus</th>\n          <th>Species</th>\n          <th><span class=\"citation\"><a href=\"#sobel2017beerdecoded\">Sobel <i>et al.</i> 2017</a></span></th>\n          <th>Our data</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr>\n          <td>Ascomycota</td>\n          <td>Saccharomycetes</td>\n          <td>Saccharomycetales</td>\n          <td>Saccharomycetaceae</td>\n          <td>Saccharomyces</td>\n          <td><em>Saccharomyces cerevisiae</em></td>\n          <td>X</td>\n          <td>X</td>\n        </tr>\n        <tr>\n          <td>Ascomycota</td>\n          <td>Saccharomycetes</td>\n          <td>Saccharomycetales</td>\n          <td>Saccharomycetaceae</td>\n          <td>Saccharomyces</td>\n          <td><em>Saccharomyces mikatea</em></td>\n          <td>X</td>\n          <td> </td>\n        </tr>\n        <tr>\n          <td>Ascomycota</td>\n          <td>Saccharomycetes</td>\n          <td>Saccharomycetales</td>\n          <td>Saccharomycetaceae</td>\n          <td>Saccharomyces</td>\n          <td><em>Saccharomyces kudriavzevii</em></td>\n          <td>X</td>\n          <td> </td>\n        </tr>\n        <tr>\n          <td>Ascomycota</td>\n          <td>Saccharomycetes</td>\n          <td>Saccharomycetales</td>\n          <td>Saccharomycetaceae</td>\n          <td>Saccharomyces</td>\n          <td><em>Saccharomyces paradoxus</em></td>\n          <td>X</td>\n          <td>X</td>\n        </tr>\n        <tr>\n          <td>Ascomycota</td>\n          <td>Saccharomycetes</td>\n          <td>Saccharomycetales</td>\n          <td>Saccharomycetaceae</td>\n          <td>Saccharomyces</td>\n          <td><em>Saccharomyces cariocanus</em></td>\n          <td>X</td>\n          <td> </td>\n        </tr>\n        <tr>\n          <td>Ascomycota</td>\n          <td>Saccharomycetes</td>\n          <td>Saccharomycetales</td>\n          <td>Saccharomycetaceae</td>\n          <td>Saccharomyces</td>\n          <td><em>Saccharomyces eubayanus</em></td>\n          <td> </td>\n          <td>X</td>\n        </tr>\n        <tr>\n          <td>Ascomycota</td>\n          <td>Saccharomycetes</td>\n          <td>Saccharomycetales</td>\n          <td>Saccharomycetaceae</td>\n          <td>Kazachstania</td>\n          <td><em>Kazachstania martiniae</em></td>\n          <td>X</td>\n          <td> </td>\n        </tr>\n        <tr>\n          <td>Ascomycota</td>\n          <td>Saccharomycetes</td>\n          <td>Saccharomycetales</td>\n          <td>Saccharomycetaceae</td>\n          <td>Kazachstania</td>\n          <td><em>Kazachstania kunashirensis</em></td>\n          <td>X</td>\n          <td> </td>\n        </tr>\n        <tr>\n          <td>Ascomycota</td>\n          <td>Saccharomycetes</td>\n          <td>Saccharomycetales</td>\n          <td>Saccharomycetaceae</td>\n          <td>Kluyveromyces</td>\n          <td><em>Kluyveromyces marxianus</em></td>\n          <td> </td>\n          <td>X</td>\n        </tr>\n        <tr>\n          <td>Ascomycota</td>\n          <td>Saccharomycetes</td>\n          <td>Saccharomycetales</td>\n          <td>Saccharomycetaceae</td>\n          <td>Brettanomyces</td>\n          <td><em>Brettanomyces bruxellensis</em></td>\n          <td>X</td>\n          <td> </td>\n        </tr>\n        <tr>\n          <td>Ascomycota</td>\n          <td>Saccharomycetes</td>\n          <td>Saccharomycetales</td>\n          <td>Saccharomycetaceae</td>\n          <td> </td>\n          <td><em>Pichia kudriavzevii</em></td>\n          <td>X</td>\n          <td> </td>\n        </tr>\n        <tr>\n          <td>Ascomycota</td>\n          <td>Saccharomycetes</td>\n          <td>Saccharomycetales</td>\n          <td>Debaryomycetaceae</td>\n          <td>Candida</td>\n          <td><em>Candida dubliniensis</em></td>\n          <td> </td>\n          <td>X</td>\n        </tr>\n        <tr>\n          <td>Ascomycota</td>\n          <td>Dothideomycetes</td>\n          <td>Dothideales</td>\n          <td>Dothioraceae</td>\n          <td>Aureobasidium</td>\n          <td><em>Aureobasidium pullulans</em></td>\n          <td>X</td>\n          <td> </td>\n        </tr>\n        <tr>\n          <td>Ascomycota</td>\n          <td>Sordariomycetes</td>\n          <td>Sordariales</td>\n          <td>Sordariaceae</td>\n          <td>Neurospora</td>\n          <td><em>Neurospora crassa</em></td>\n          <td> </td>\n          <td>X</td>\n        </tr>\n        <tr>\n          <td>Basidiomycota</td>\n          <td>Tremellomycetes</td>\n          <td>Filobasidiales</td>\n          <td>Filobasidiaceae</td>\n          <td>Filobasidium</td>\n          <td><em>Filobasidium magnum</em></td>\n          <td>X</td>\n          <td> </td>\n        </tr>\n        <tr>\n          <td>Basidiomycota</td>\n          <td>Malasseziomycetes</td>\n          <td>Malasseziales</td>\n          <td>Malasseziaceae</td>\n          <td>Malassezia</td>\n          <td><em>Malasseria restricta</em></td>\n          <td>X</td>\n          <td> </td>\n        </tr>\n        <tr>\n          <td>Basidiomycota</td>\n          <td>Sporidiobolales</td>\n          <td>Sporidiobolales</td>\n          <td>Sporidiobolaceae</td>\n          <td>Sporidiobolus</td>\n          <td><em>Sporidiobolus metaroseus</em></td>\n          <td>X</td>\n          <td> </td>\n        </tr>\n      </tbody>\n    </table>\n  </blockquote>\n</blockquote>\n\n<p>Some interesting yeast have been found in  <span class=\"citation\"><a href=\"#sobel2017beerdecoded\">Sobel <i>et al.</i> 2017</a></span> and not in our data (e.g. <em>Brettanomyces bruxellensis</em>), and vice versa.</p>\n\n<h1 id=\"optional-sharing-your-history\">(Optional) Sharing your history</h1>\n\n<p>One of the most important features of Galaxy comes at the end of an analysis: sharing your histories with others so they can review them.</p>\n\n<!--SNIPPET-->\n<blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-sharing-your-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-sharing-your-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Sharing your History</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>Sharing your history allows others to import and access the datasets, parameters, and steps of your history.</p>   <p>Access the history sharing menu via the History Options dropdown (<i class=\"fas fa-bars\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-history-options</span>), and clicking “<i class=\"fas fa-share-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">history-share</span> Share or Publish”</p>   <ol>   <li><strong>Share via link</strong>     <ul>       <li>Open the <strong>History Options</strong> <i class=\"fas fa-bars\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-history-options</span> menu at the top of your history panel and select “<i class=\"fas fa-share-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">history-share</span> Share or Publish”         <ul>           <li><i class=\"fas fa-toggle-on\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-toggle</span> <strong>Make History accessible</strong></li>           <li>A <strong>Share Link</strong> will appear that you give to others</li>         </ul>       </li>       <li>Anybody who has this link can view and copy your history</li>     </ul>   </li>   <li><strong>Publish your history</strong>     <ul>       <li><i class=\"fas fa-toggle-on\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-toggle</span> <strong>Make History publicly available in Published Histories</strong></li>       <li>Anybody on this Galaxy server will see your history listed under the <em>Shared Data</em> menu</li>     </ul>   </li>   <li><strong>Share only with another user</strong>.     <ul>       <li>Click the <strong>Share with a user</strong> button at the bottom</li>       <li>Enter an email address for the user you want to share with</li>       <li>Your history will be shared only with this user.</li>     </ul>   </li>   <li><strong>Finding histories others have shared with me</strong>     <ul>       <li>Click on <strong>User</strong> menu on the top bar</li>       <li>Select <strong>Histories shared with me</strong></li>       <li>Here you will see all the histories others have shared with you directly</li>     </ul>   </li> </ol>   <p><strong>Note:</strong> If you want to make changes to your history without affecting the shared version, make a copy by going to <strong>History Options</strong> <i class=\"fas fa-bars\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-history-options</span> icon in your history and clicking <em>Copy this History</em></p> </blockquote>\n<p><!--END_SNIPPET--></p>\n\n<h1 id=\"conclusion\">Conclusion</h1>\n"],"ref_slides":[],"hands_on":true,"slides":false,"mod_date":"2024-05-29 14:28:52 +0000","pub_date":"2022-09-29 12:40:13 +0000","version":4,"workflows":[{"workflow":"main_workflow.ga","tests":true,"url":"https://training.galaxyproject.org/training-material/topics/microbiome/tutorials/beer-data-analysis/workflows/main_workflow.ga","path":"topics/microbiome/tutorials/beer-data-analysis/workflows/main_workflow.ga","wfid":"microbiome-beer-data-analysis","wfname":"main_workflow","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/microbiome-beer-data-analysis/versions/main_workflow","license":"MIT","creators":[{"class":"Person","identifier":"0000-0001-9852-1987","name":"Bérénice Batut"},{"class":"Person","identifier":"0000-0003-1252-9684","name":"Teresa Müller"},{"class":"Person","identifier":"0000-0002-0507-4602","name":"Polina Polunina"}],"name":"Identification of the micro-organisms in a beer using Nanopore sequencing","title":"Identification of the micro-organisms in a beer using Nanopore sequencing","test_results":null,"modified":"2024-06-14 12:15:31 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\ninput\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"FastQC\"];\n  0 -->|output| 1;\n  2[\"Porechop\"];\n  0 -->|output| 2;\n  3[\"fastp\"];\n  2 -->|outfile| 3;\n  4[\"Kraken2\"];\n  3 -->|out1| 4;\n  b9dbaf8b-3dd5-4e67-9f06-a8afad201138[\"Output\\nkraken_report\"];\n  4 --> b9dbaf8b-3dd5-4e67-9f06-a8afad201138;\n  style b9dbaf8b-3dd5-4e67-9f06-a8afad201138 stroke:#2c3143,stroke-width:4px;\n  5[\"Filter\"];\n  4 -->|report_output| 5;\n  6[\"Filter\"];\n  4 -->|report_output| 6;\n  7[\"Krakentools: Convert kraken report file\"];\n  4 -->|report_output| 7;\n  48a110cf-79db-4318-9b43-3a7f868c1159[\"Output\\nkrakentool_report\"];\n  7 --> 48a110cf-79db-4318-9b43-3a7f868c1159;\n  style 48a110cf-79db-4318-9b43-3a7f868c1159 stroke:#2c3143,stroke-width:4px;\n  8[\"Krona pie chart\"];\n  7 -->|output| 8;"}],"api":"https://training.galaxyproject.org/training-material/api/topics/microbiome/tutorials/beer-data-analysis/tutorial.json","tools":["Filter1","toolshed.g2.bx.psu.edu/repos/crs4/taxonomy_krona_chart/taxonomy_krona_chart/2.7.1+galaxy0","toolshed.g2.bx.psu.edu/repos/devteam/fastqc/fastqc/0.73+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/fastp/fastp/0.23.2+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/kraken2/kraken2/2.1.1+galaxy1","toolshed.g2.bx.psu.edu/repos/iuc/krakentools_kreport2krona/krakentools_kreport2krona/1.2+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/porechop/porechop/0.2.4+galaxy0"],"supported_servers":{"exact":[{"url":"https://galaxytrakr.org/","name":"GalaxyTrakr","usegalaxy":false},{"url":"https://usegalaxy.eu","name":"UseGalaxy.eu","usegalaxy":true},{"url":"https://usegalaxy.org","name":"UseGalaxy.org (Main)","usegalaxy":true},{"url":"https://usegalaxy.org.au","name":"UseGalaxy.org.au","usegalaxy":true}],"inexact":[{"url":"https://usegalaxy.cz/","name":"UseGalaxy.cz","usegalaxy":false}]},"topic_name_human":"Microbiome","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"taxonomy_krona_chart","owner":"crs4","revisions":"e9005d1f3cfd","tool_panel_section_label":"Metagenomic Analysis","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"fastqc","owner":"devteam","revisions":"3d0c7bdf12f5","tool_panel_section_label":"FASTA/FASTQ","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"fastp","owner":"iuc","revisions":"65b93b623c77","tool_panel_section_label":"FASTA/FASTQ","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"kraken2","owner":"iuc","revisions":"20e2f64aa1fe","tool_panel_section_label":"Metagenomic Analysis","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"krakentools_kreport2krona","owner":"iuc","revisions":"88d274322340","tool_panel_section_label":"Metagenomic Analysis","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"porechop","owner":"iuc","revisions":"543cbeef3949","tool_panel_section_label":"Nanopore","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: taxonomy_krona_chart\n  owner: crs4\n  revisions: e9005d1f3cfd\n  tool_panel_section_label: Metagenomic Analysis\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: fastqc\n  owner: devteam\n  revisions: 3d0c7bdf12f5\n  tool_panel_section_label: FASTA/FASTQ\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: fastp\n  owner: iuc\n  revisions: 65b93b623c77\n  tool_panel_section_label: FASTA/FASTQ\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: kraken2\n  owner: iuc\n  revisions: 20e2f64aa1fe\n  tool_panel_section_label: Metagenomic Analysis\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: krakentools_kreport2krona\n  owner: iuc\n  revisions: 88d274322340\n  tool_panel_section_label: Metagenomic Analysis\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: porechop\n  owner: iuc\n  revisions: 543cbeef3949\n  tool_panel_section_label: Nanopore\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":false,"slides_recordings":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial","contributors":[{"name":"Polina Polunina","orcid":"0000-0002-0507-4602","joined":"2022-03","affiliations":["uni-freiburg"],"id":"plushz","url":"https://training.galaxyproject.org/training-material/api/contributors/plushz.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/plushz/"},{"name":"Siyu Chen","joined":"2022-05","id":"chensy96","url":"https://training.galaxyproject.org/training-material/api/contributors/chensy96.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/chensy96/"},{"name":"Bérénice Batut","email":"berenice.batut@gmail.com","twitter":"bebatut","linkedin":"berenicebatut","matrix":"bebatut:matrix.org","orcid":"0000-0001-9852-1987","joined":"2017-09","elixir_node":"fr","contact_for_training":true,"location":{"country":"FR","lat":45.77,"lon":3.08},"fediverse":"https://piaille.fr/@bebatut","fediverse_flavor":"mastodon","affiliations":["gallantries","ifb","elixir-europe"],"id":"bebatut","url":"https://training.galaxyproject.org/training-material/api/contributors/bebatut.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/bebatut/"},{"name":"Teresa Müller","joined":"2022-09","affiliations":["uni-freiburg","elixir-europe"],"id":"teresa-m","url":"https://training.galaxyproject.org/training-material/api/contributors/teresa-m.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/teresa-m/"},{"name":"Gallantries: Bridging Training Communities in Life Science, Environment and Health","short_name":"Gallantries","start_date":"2020-09-01","end_date":"2023-09-30","joined":"2020-09","avatar":"https://gallantries.github.io/assets/images/gallantries-logo.png","github":false,"funder":true,"url":"https://training.galaxyproject.org/training-material/api/funders/gallantries.json","funder_name":"Erasmus+ Programme","funding_id":"2020-1-NL01-KA203-064717","funding_system":"erasmusplus","funding_statement":"This project (<a href=\"https://erasmus-plus.ec.europa.eu/projects/search/details/2020-1-NL01-KA203-064717\"><code class=\"language-plaintext highlighter-rouge\">2020-1-NL01-KA203-064717</code></a>) is funded with the support of the Erasmus+ programme of the European Union. Their funding has supported a large number of tutorials within the GTN across a wide array of topics.\n<img src=\"https://gallantries.github.io/assets/images/logosbeneficaireserasmusright_en.jpg\" alt=\"eu flag with the text: with the support of the erasmus programme of the european union\" />\n<img src=\"https://www.erasmusplus.nl/assets/images/logo.png\" alt=\"erasmus plus logo\" />","members":["abretaud","bebatut","colineroyaux","fpsom","hexylena","shiltemann","yvanlebras"],"id":"gallantries","page":"https://training.galaxyproject.org/training-material/hall-of-fame/gallantries/"}]}