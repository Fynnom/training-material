{"layout":"tutorial_hands_on","title":"Building an amplicon sequence variant (ASV) table from 16S data using DADA2","zenodo_link":"https://doi.org/10.5281/zenodo.800651","questions":["What are the primary steps involved in generating an ASV table using DADA2 from 16S rRNA gene sequencing data?","How does DADA2 improve the accuracy of microbial community analysis compared to traditional OTU-based methods?","What is the importance of quality filtering in the DADA2 workflow, and how does it impact downstream analyses?","How does the error rate learning process contribute to the identification of true biological sequences in DADA2?","What role does chimera removal play in the DADA2 pipeline, and why is it crucial for obtaining reliable ASV data?","How can phyloseq be used to explore and visualize the ASV table generated by DADA2, and what types of ecological insights can it provide?"],"objectives":["Identify the key steps in the DADA2 workflow for generating an ASV table from 16S rRNA gene sequencing data","Explain the importance of quality filtering, error rate learning, and chimera removal in ensuring accurate microbial community analysis","Execute the DADA2 pipeline to process raw 16S sequencing data and produce a high-resolution ASV table","Compare the advantages of ASV-based methods over traditional OTU-based approaches in terms of accuracy and resolution","Assess the effectiveness of using phyloseq for exploring and visualizing ASV data to gain ecological and evolutionary insights"],"time_estimation":"3H","key_points":["DADA2 allows for the generation of precise ASV tables, providing higher resolution and more accurate representation of microbial communities compared to traditional OTU-based methods.","Key steps such as quality filtering, error rate learning, and chimera removal are essential in the DADA2 pipeline to ensure the reliability and accuracy of the resulting ASV data.","Tools like phyloseq can be effectively used to explore and visualize ASV tables, facilitating deeper ecological and evolutionary insights into microbial diversity and community structure."],"subtopic":"metabarcoding","tags":["metabarcoding","16S","microgalaxy"],"contributions":{"authorship":["bebatut"],"editing":["bernt-matthias"]},"edam_ontology":["topic_3697","topic_0637","topic_0080","topic_4038"],"js_requirements":{"mathjax":14583,"mermaid":false},"short_id":"T00441","url":"/topics/microbiome/tutorials/dada-16S/tutorial.html","topic_name":"microbiome","tutorial_name":"dada-16S","dir":"topics/microbiome/tutorials/dada-16S","symlink":null,"id":"microbiome/dada-16S","ref_tutorials":["<blockquote class=\"comment\">\n  <comment-title>Sources</comment-title>\n\n  <p>This tutorial is significantly based on <a href=\"https://benjjneb.github.io/dada2/tutorial.html\">DADA2 Pipeline Tutorial</a> and <a href=\"https://bioconductor.org/packages/devel/bioc/vignettes/dada2/inst/doc/dada2-intro.html\">“Introduction to dada2”</a></p>\n\n</blockquote>\n\n<p>The investigation of environmental microbial communities and microbiomes has been revolutionized by the \ndevelopment of high-throughput amplicon sequencing. In amplicon sequencing a particular genetic locus, \nfor example the 16S rRNA gene (or a part of it) in bacteria, is amplified from DNA extracted from the community of interest, \nand then sequenced on a next-generation sequencing platform. This technique removes the need to culture \nmicrobes in order to detect their presence, and cost-effectively provides a deep census of a microbial community.</p>\n\n<blockquote class=\"comment\">\n  <comment-title>Background: The 16S ribosomal RNA gene</comment-title>\n  <p><img src=\"../../images/16S_gene.png\" alt=\"The 16S ribosomal RNA gene\" /> <br /><br /></p>\n\n  <p>The 16S rRNA gene has several properties that make it ideally suited for our purposes</p>\n\n  <ol>\n    <li>Present in all prokaryotes</li>\n    <li>Highly conserved + highly variable regions</li>\n    <li>Huge reference databases</li>\n  </ol>\n\n  <p><img src=\"../../images/16S_variableregions.jpg\" alt=\"16S Variable regions\" /></p>\n\n  <p>The highly conserved regions make it easy to target the gene across different organisms,\nwhile the highly variable regions allow us to distinguish between different species.</p>\n\n  <p>(slide credit <a href=\"https://www.slideshare.net/beiko/ccbc-tutorial-beiko\">https://www.slideshare.net/beiko/ccbc-tutorial-beiko</a>)</p>\n</blockquote>\n\n<p>To process 16S amplicon sequencing data, several tools exist: <strong>QIIME2</strong> (<span class=\"citation\"><a href=\"#Bolyen_2019\">Bolyen <i>et al.</i> 2019</a></span>), <strong>Mothur</strong> (<span class=\"citation\"><a href=\"#Schloss_2009\">Schloss <i>et al.</i> 2009</a></span>), <strong>Lotus2</strong> (<span class=\"citation\"><a href=\"#_zkurt_2022\">Özkurt <i>et al.</i> 2022</a></span>), and <strong>DADA2</strong> (<span class=\"citation\"><a href=\"#Callahan_2016\">Callahan <i>et al.</i> 2016</a></span>). All these tools can be used in Galaxy. In this tutorial we will use <strong>DADA2</strong>.</p>\n\n<blockquote class=\"comment\">\n  <comment-title>Processing 16S amplicon data in Galaxy using other tools than DADA2</comment-title>\n\n  <p>Tutorials are available for the other tools in Galaxy:</p>\n  <ul>\n    <li><a href=\"https://docs.qiime2.org/jupyterbooks/cancer-microbiome-intervention-tutorial/index.html#\">QIIME 2 Cancer Microbiome Intervention</a></li>\n    <li><a href=\"https://docs.qiime2.org/2024.2/tutorials/moving-pictures-usage\">QIIME 2 Moving Pictures</a></li>\n    <li><a href=\"/training-material/topics/microbiome/tutorials/mothur-miseq-sop/tutorial.html\">16S Microbial Analysis with mothur</a></li>\n  </ul>\n\n</blockquote>\n\n<p>The output of the dada2 pipeline is a feature table of amplicon sequence variants (an ASV table): A matrix with columms corresponding to samples and rows to ASVs, in which the value of each entry is the number of times that ASV was observed in that sample. This table is analogous to the traditional OTU table, except that one gets the actual sequences of the “true” sequence variants instead of rather anonymous and abstract entities called OTU1, OTU2, etc.</p>\n\n<p>The process of amplicon sequencing introduces errors into the sequencing data, and these errors \nseverely complicate the interpretation of the results. <strong>DADA2</strong> implements a novel algorithm that models the errors introduced during amplicon sequencing, and uses that error model to infer the true sample composition.</p>\n\n<p><strong>DADA2</strong> replaces the traditional “OTU-picking” step in amplicon sequencing workflows, producing instead higher-resolution tables of amplicon sequence variants (ASVs).</p>\n\n<blockquote class=\"comment\">\n  <comment-title>Background: What are Operational Taxonomic Units (OTUs)?</comment-title>\n\n  <p>In 16S metagenomics approaches, OTUs are clusters of similar sequence variants of the 16S rDNA marker gene\nsequence. Each of these clusters is intended to represent a taxonomic unit of a bacteria species or genus\ndepending on the sequence similarity threshold. Typically, OTU cluster are defined by a 97% identity\nthreshold of the 16S gene sequence variants at species level. 98% or 99% identity is suggested for strain\nseparation.</p>\n\n  <p><img src=\"../../images/OTU_graph.png\" alt=\"OTU graph\" /></p>\n\n  <p>(Image credit: Danzeisen et al. 2013, 10.7717/peerj.237)</p>\n</blockquote>\n\n<p>As seen in the paper introducing DADA2 (<span class=\"citation\"><a href=\"#Callahan_2016\">Callahan <i>et al.</i> 2016</a></span>) and in <a href=\"http://benjjneb.github.io/dada2/SotA.html\">further benchmarking</a>, the <strong>DADA2</strong> method is more sensitive and specific than traditional OTU methods: DADA2 detects real biological variation missed by OTU methods while outputting fewer spurious sequences.</p>\n\n<p>To illustrate the 16S amplicon data processing using <strong>DADA2</strong>, we will use dataset generated by the Schloss lab in their\n<a href=\"https://www.mothur.org/wiki/MiSeq_SOP\">their mothur MiSeq SOP</a>: FASTQ files generated by 2x250 Illumina Miseq amplicon sequencing of the V4 region of the 16S rRNA gene from gut samples collected longitudinally from a mouse post-weaning. They <a href=\"https://www.mothur.org/wiki/MiSeq_SOP#Logistics\">describe the experiment</a> as follows:</p>\n\n<blockquote class=\"quote\">\n  <p><em>The Schloss lab is interested in understanding the effect of normal variation in the gut microbiome on host health. To that end,\nwe collected fresh feces from mice on a daily basis for 365 days post weaning. During the first 150 days post weaning (dpw),\nnothing was done to our mice except allow them to eat, get fat, and be merry. We were curious whether the rapid change in\nweight observed during the first 10 dpw affected the stability microbiome compared to the microbiome observed between days\n140 and 150.</em></p>\n\n</blockquote>\n\n<p>To speed up analysis for this tutorial, we will use only a subset of this data. We will look at a single mouse at 20 different time points (10 early, 10 late).</p>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n  <p>In this tutorial, we will cover:</p>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#prepare-galaxy-and-data\" id=\"markdown-toc-prepare-galaxy-and-data\">Prepare Galaxy and data</a></li>\n  <li><a href=\"#processing-data-using-dada2\" id=\"markdown-toc-processing-data-using-dada2\">Processing data using DADA2</a></li>\n  <li><a href=\"#prepare-reads\" id=\"markdown-toc-prepare-reads\">Prepare reads</a>    <ol>\n      <li><a href=\"#inspect-read-quality-profiles\" id=\"markdown-toc-inspect-read-quality-profiles\">Inspect read quality profiles</a></li>\n      <li><a href=\"#filter-and-trim\" id=\"markdown-toc-filter-and-trim\">Filter and trim</a></li>\n      <li><a href=\"#learn-the-error-rates\" id=\"markdown-toc-learn-the-error-rates\">Learn the Error Rates</a></li>\n      <li><a href=\"#infer-sample-composition\" id=\"markdown-toc-infer-sample-composition\">Infer Sample Composition</a></li>\n      <li><a href=\"#merge-paired-reads\" id=\"markdown-toc-merge-paired-reads\">Merge paired reads</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#make-sequence-table\" id=\"markdown-toc-make-sequence-table\">Make sequence table</a>    <ol>\n      <li><a href=\"#remove-chimeras\" id=\"markdown-toc-remove-chimeras\">Remove chimeras</a></li>\n      <li><a href=\"#track-reads-through-the-pipeline\" id=\"markdown-toc-track-reads-through-the-pipeline\">Track reads through the pipeline</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#assign-taxonomy\" id=\"markdown-toc-assign-taxonomy\">Assign taxonomy</a></li>\n  <li><a href=\"#exploration-of-asvs-with-phyloseq\" id=\"markdown-toc-exploration-of-asvs-with-phyloseq\">Exploration of ASVs with phyloseq</a>    <ol>\n      <li><a href=\"#prepare-metadata-table-and-launch-phyloseq\" id=\"markdown-toc-prepare-metadata-table-and-launch-phyloseq\">Prepare metadata table and launch phyloseq</a></li>\n      <li><a href=\"#visualize-alpha-diversity\" id=\"markdown-toc-visualize-alpha-diversity\">Visualize alpha-diversity</a></li>\n      <li><a href=\"#plot-ordination\" id=\"markdown-toc-plot-ordination\">Plot Ordination</a></li>\n      <li><a href=\"#plot-abundance-stacked-barplot\" id=\"markdown-toc-plot-abundance-stacked-barplot\">Plot abundance stacked barplot</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#conclusion\" id=\"markdown-toc-conclusion\">Conclusion</a></li>\n</ol>\n\n</blockquote>\n\n<h1 id=\"prepare-galaxy-and-data\">Prepare Galaxy and data</h1>\n\n<p>Any analysis should get its own Galaxy history. So let’s start by creating a new one:</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Data upload</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Create a new history for this analysis</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-new-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-new-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a new history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>Click the <i class=\"fas fa-plus\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">new-history</span> icon at the top of the history panel:</p>   <p><img src=\"/training-material/shared/images/history_create_new.svg\" alt=\"UI for creating new history\" /></p>   <!-- the original drawing can be found here https://docs.google.com/drawings/d/1cCBrLAo4kDGic5QyB70rRiWJAKTenTU8STsKDaLcVU8/edit?usp=sharing --> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Rename the history</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-renaming-a-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-renaming-a-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Renaming a history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ol>   <li>Click on <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> (<strong>Edit</strong>) next to the history name (which by default is “Unnamed history”)</li>   <li>Type the new name</li>   <li>Click on <strong>Save</strong></li> </ol>   <p>If you do not have the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> (<strong>Edit</strong>) next to the history name:</p>   <ol>   <li>Click on <strong>Unnamed history</strong> (or the current name of the history) (<strong>Click to rename history</strong>) at the top of your history panel</li>   <li>Type the new name</li>   <li>Press <kbd>Enter</kbd></li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>The starting point for the <strong>DADA2</strong> pipeline is a set of demultiplexed FASTQ files corresponding to the samples in your amplicon sequencing study. That is, <strong>DADA2</strong> expects there to be an individual FASTQ file for each sample (or two FASTQ files, one forward and one reverse, for each sample). Demultiplexing is often performed at the sequencing center, but if that has not been done there are a variety of tools do accomplish this.</p>\n\n<p>In addition, <strong>DADA2</strong> expects that there are no non-biological bases in the sequencing data. This may require pre-processing with outside software if, as is relatively common, your PCR primers were included in the sequenced amplicon region.</p>\n\n<p>For this tutorial, we have 20 pairs of files. For example, the following pair of files:</p>\n\n<ul>\n  <li><code class=\"language-plaintext highlighter-rouge\">F3D0_S188_L001_R1_001.fastq</code></li>\n  <li><code class=\"language-plaintext highlighter-rouge\">F3D0_S188_L001_R2_001.fastq</code></li>\n</ul>\n\n<p>The first part of the file name indicates the sample: <code class=\"language-plaintext highlighter-rouge\">F3D0</code> here signifies that this sample was obtained from Female 3 on Day 0.</p>\n\n<p>The rest of the file name is identical, except for <code class=\"language-plaintext highlighter-rouge\">_R1</code> and <code class=\"language-plaintext highlighter-rouge\">_R2</code>, this is used to indicate the forward and reverse reads respectively.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Import datasets</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Import the following samples via link from <a href=\"https://doi.org/10.5281/zenodo.800651\">Zenodo</a> or Galaxy shared data libraries:</p>\n\n      <blockquote class=\"solution\">\n        <solution-title>List of Zenodo URLs</solution-title>\n        <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/800651/files/F3D0_R1.fastq\nhttps://zenodo.org/record/800651/files/F3D0_R2.fastq\nhttps://zenodo.org/record/800651/files/F3D141_R1.fastq\nhttps://zenodo.org/record/800651/files/F3D141_R2.fastq\nhttps://zenodo.org/record/800651/files/F3D142_R1.fastq\nhttps://zenodo.org/record/800651/files/F3D142_R2.fastq\nhttps://zenodo.org/record/800651/files/F3D143_R1.fastq\nhttps://zenodo.org/record/800651/files/F3D143_R2.fastq\nhttps://zenodo.org/record/800651/files/F3D144_R1.fastq\nhttps://zenodo.org/record/800651/files/F3D144_R2.fastq\nhttps://zenodo.org/record/800651/files/F3D145_R1.fastq\nhttps://zenodo.org/record/800651/files/F3D145_R2.fastq\nhttps://zenodo.org/record/800651/files/F3D146_R1.fastq\nhttps://zenodo.org/record/800651/files/F3D146_R2.fastq\nhttps://zenodo.org/record/800651/files/F3D147_R1.fastq\nhttps://zenodo.org/record/800651/files/F3D147_R2.fastq\nhttps://zenodo.org/record/800651/files/F3D148_R1.fastq\nhttps://zenodo.org/record/800651/files/F3D148_R2.fastq\nhttps://zenodo.org/record/800651/files/F3D149_R1.fastq\nhttps://zenodo.org/record/800651/files/F3D149_R2.fastq\nhttps://zenodo.org/record/800651/files/F3D150_R1.fastq\nhttps://zenodo.org/record/800651/files/F3D150_R2.fastq\nhttps://zenodo.org/record/800651/files/F3D1_R1.fastq\nhttps://zenodo.org/record/800651/files/F3D1_R2.fastq\nhttps://zenodo.org/record/800651/files/F3D2_R1.fastq\nhttps://zenodo.org/record/800651/files/F3D2_R2.fastq\nhttps://zenodo.org/record/800651/files/F3D3_R1.fastq\nhttps://zenodo.org/record/800651/files/F3D3_R2.fastq\nhttps://zenodo.org/record/800651/files/F3D5_R1.fastq\nhttps://zenodo.org/record/800651/files/F3D5_R2.fastq\nhttps://zenodo.org/record/800651/files/F3D6_R1.fastq\nhttps://zenodo.org/record/800651/files/F3D6_R2.fastq\nhttps://zenodo.org/record/800651/files/F3D7_R1.fastq\nhttps://zenodo.org/record/800651/files/F3D7_R2.fastq\nhttps://zenodo.org/record/800651/files/F3D8_R1.fastq\nhttps://zenodo.org/record/800651/files/F3D8_R2.fastq\nhttps://zenodo.org/record/800651/files/F3D9_R1.fastq\nhttps://zenodo.org/record/800651/files/F3D9_R2.fastq\nhttps://zenodo.org/record/800651/files/Mock_R1.fastq\nhttps://zenodo.org/record/800651/files/Mock_R2.fastq\n</code></pre></div>        </div>\n      </blockquote>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-via-links\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-via-links\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing via links</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-data-from-a-data-library\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-data-from-a-data-library\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing data from a data library</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>As an alternative to uploading the data from a URL or your computer, the files may also have been made available from a <em>shared data library</em>:</p>   <ol>   <li>Go into <strong>Shared data</strong> (top panel) then <strong>Data libraries</strong></li>   <li>Navigate to  the correct folder as indicated by your instructor.     <ul>       <li>On most Galaxies tutorial data will be provided in a folder named <strong>GTN - Material –&gt; Topic Name -&gt; Tutorial Name</strong>.</li>     </ul>   </li>   <li>Select the desired files</li>   <li>Click on <strong>Add to History</strong> <i class=\"fas fa-caret-down\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-dropdown</span> near the top and select <strong>as Datasets</strong> from the dropdown menu</li>   <li>     <p>In the pop-up window, choose</p>     <ul>       <li><em>“Select history”</em>: the history you want to import the data to (or create a new one)</li>     </ul>   </li>   <li>Click on <strong>Import</strong></li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>40 files are a lot of files to manage. Luckily Galaxy can make life a bit easier by allowing us to create <strong>dataset collections</strong>. This enables us to easily run tools on multiple datasets at once.</p>\n\n<p>Since we have <strong>paired-end</strong> data, each sample consist of two separate FASTQ files:</p>\n<ul>\n  <li>one containing the forward reads, and</li>\n  <li>one containing the reverse reads.</li>\n</ul>\n\n<p>We can recognize the pairing from the file names, which will differ only by <code class=\"language-plaintext highlighter-rouge\">_R1</code> or <code class=\"language-plaintext highlighter-rouge\">_R2</code> in the filename. We can tell Galaxy about this paired naming convention, so that our tools will know which files belong together. We do this by building a <strong>List of Dataset Pairs</strong></p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Organizing our data into a sorted paired collection</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Create a paired collection named <code class=\"language-plaintext highlighter-rouge\">Raw Reads</code>, rename your pairs with the sample name</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-paired-collection\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-paired-collection\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a paired collection</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on <i class=\"far fa-check-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-selector</span> <strong>Select Items</strong> at the top of the history panel <img src=\"/training-material/topics/galaxy-interface/images/historyItemControls.png\" alt=\"Select Items button\" /></li>   <li>Check all the datasets in your history you would like to include</li>   <li>     <p>Click <strong>n of N selected</strong> and choose <strong>Build List of Dataset Pairs</strong></p>   </li>   <li>Change the text of <em>unpaired forward</em> to a common selector for the forward reads</li>   <li>Change the text of <em>unpaired reverse</em> to a common selector for the reverse reads</li>   <li>Click <strong>Pair these datasets</strong> for each valid <em>forward</em> and <em>reverse</em> pair.</li>   <li>Enter a name for your collection</li>   <li>Click <strong>Create List</strong> to build your collection</li>   <li>Click on the checkmark icon at the top of your history again</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li><span class=\"tool\" data-tool=\"__SORTLIST__\" title=\"Sort collection tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Sort collection</strong></span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“Input Collection”</em>: <code class=\"language-plaintext highlighter-rouge\">Raw Reads</code></li>\n      </ul>\n    </li>\n    <li>\n      <p>Rename output collection to <code class=\"language-plaintext highlighter-rouge\">Sorted Raw Reads</code></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-renaming-a-collection\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-renaming-a-collection\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Renaming a collection</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ol>   <li>Click on the collection</li>   <li>Click on the name of the collection at the top</li>   <li>Change the name</li>   <li>Press <kbd>Enter</kbd></li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>We can now start processing the reads using <strong>DADA2</strong>.</p>\n\n<blockquote class=\"notranslate hands_on gtn-cyoa\" id=\"gtn-cyoaworkflow\">\n\t<div class=\"box-title\" aria-label=\"hands-on box: choose your own tutorial\"><i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\"></span> Hands-on: Choose Your Own Tutorial</div>\n\t<p>This is a \"Choose Your Own Tutorial\" section, where you can select between multiple paths. Click one of the buttons below to select how you want to follow the tutorial</p>\n\t\n\t<p>\n\t\tDo you want to go step-by-step or using a workflow?\n\t</p>\n\t\n\t\n\t\t<input id=\"cyoa-opt1workflow\" type=\"radio\" name=\"cyoaworkflow\" value=\"Step-by-step\" onclick=\"cyoaChoice('Step-by-step', 'gtn-cyoaworkflow')\" />\n\t\t<label for=\"cyoa-opt1workflow\" class=\"select btn btn-secondary\">Step-by-step</label>\n\t\n\t\n\t\t<input id=\"cyoa-opt2workflow\" type=\"radio\" name=\"cyoaworkflow\" value=\"Workflow\" onclick=\"cyoaChoice('Workflow', 'gtn-cyoaworkflow')\" />\n\t\t<label for=\"cyoa-opt2workflow\" class=\"select btn btn-secondary\">Workflow</label>\n\t\n\t\n\t\n\n\t\n\t<script>\n\t\tfunction ready(fn) {\n\t\t\tif (document.readyState != 'loading'){\n\t\t\t\tfn();\n\t\t\t} else {\n\t\t\t\tdocument.addEventListener('DOMContentLoaded', fn);\n\t\t\t}\n\t\t}\n\t\tready(function() {\n\t\t\tcyoaDefault(\"Step-by-step\", \"gtn-cyoaworkflow\");\n\t\t})\n\t</script>\n\t\n</blockquote>\n\n<h1 id=\"processing-data-using-dada2\">Processing data using DADA2</h1>\n\n<p>Once demultiplexed FASTQ files without non-biological nucleotides are in hand, the <strong>DADA2</strong> pipeline proceeds as follows:</p>\n\n<ol>\n  <li>Prepare reads\n    <ol>\n      <li>Inspect read quality profiles</li>\n      <li>Filter and trim</li>\n      <li>Learn the Error Rates</li>\n      <li>Infer sample composition</li>\n      <li>Merge forward/reverse reads</li>\n    </ol>\n  </li>\n  <li>Construct sequence table\n    <ol>\n      <li>Make sequence table</li>\n      <li>Remove chimeras</li>\n    </ol>\n  </li>\n  <li>Assign taxonomy</li>\n  <li>Evaluate accuracy</li>\n</ol>\n\n<div class=\"Workflow\">\n\n  <!--SNIPPET-->\n  <blockquote class=\"hands_on\">   <div class=\"box-title hands_on-title\" id=\"hands-on-importing-and-launching-a-workflowhub-eu-workflow\"><i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i> Hands-on: Importing and Launching a WorkflowHub.eu Workflow</div>   <div class=\"show-when-galaxy-proxy-active\"> <span class=\"workflow\" data-workflow=\"https://workflowhub.eu/ga4gh/trs/v2/tools/790/versions/1\">Launch <strong>dada2/main</strong> <i class=\"fas fa-share-alt\" aria-hidden=\"true\"></i></span> (<a href=\"https://workflowhub.eu/workflows/790?version=1\">View on WorkflowHub</a>) </div>   <div class=\"hide-when-galaxy-proxy-active\"> <a href=\"https://my.galaxy.training/?path=/workflows/trs_import%3ftrs_server=workflowhub.eu%26run_form=true%26trs_id=790%26trs_version=1\">Launch <strong>dada2/main</strong> <i class=\"fas fa-share-alt\" aria-hidden=\"true\"></i></a> (<a href=\"https://workflowhub.eu/workflows/790?version=1\">View on WorkflowHub</a>) </div>   <!--SNIPPET-->   <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-if-this-does-not-work\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-if-this-does-not-work\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: If this does not work</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p><a href=\"https://workflowhub.eu/\">WorkflowHub</a> is a workflow management system which allows workflows to be FAIR (Findable, Accessible, Interoperable, and Reusable), citable, have managed metadata profiles, and be openly available for review and analytics.</p>   <ol>   <li>Ensure that you are logged in to your Galaxy account.</li>   <li>Click on the <strong>Workflow</strong> menu, located in the top bar.</li>   <li>Click on the <strong>Import</strong> button, located in the right corner.</li>   <li>In the section “Import a Workflow from Configured GA4GH Tool Registry Servers (e.g. Dockstore)”, click on <strong>Search form</strong>.</li>   <li>In the <strong>TRS Server: <em>workflowhub.eu</em></strong> menu you should type <code class=\"language-plaintext highlighter-rouge\">name:\"dada2/main\"</code> <img src=\"/training-material/topics/assembly/images/vgp_assembly/workflow_list.png\" alt=\"galaxy TRS workflow search field, name:vgp is entered in the search bar, and five different workflows all labelled VGP are listed\" /></li>   <li>Click on the desired workflow, and finally select the latest available version.</li> </ol>   <p>After that, the imported workflows will appear in the main workflow menu. In order to run the workflow, just need to click in the <i class=\"fas fa-play\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">workflow-run</span> <strong>Run workflow</strong> icon.</p>   <p>Below is a short video showing this uncomplicated procedure:</p>   <figure> <iframe credentialless=\"\" allowfullscreen=\"\" referrerpolicy=\"no-referrer\" sandbox=\"allow-scripts allow-same-origin\" allow=\"accelerometer 'none'; ambient-light-sensor 'none'; autoplay 'none'; battery 'none'; bluetooth 'none'; browsing-topics 'none'; camera 'none'; ch-ua 'none'; display-capture 'none'; domain-agent 'none'; document-domain 'none'; encrypted-media 'none'; execution-while-not-rendered 'none'; execution-while-out-of-viewport 'none'; gamepad 'none'; geolocation 'none'; gyroscope 'none'; hid 'none'; identity-credentials-get 'none'; idle-detection 'none'; keyboard-map 'none'; local-fonts 'none'; magnetometer 'none'; microphone 'none'; midi 'none'; navigation-override 'none'; otp-credentials 'none'; payment 'none'; picture-in-picture 'none'; publickey-credentials-create 'none'; publickey-credentials-get 'none'; screen-wake-lock 'none'; serial 'none'; speaker-selection 'none'; sync-xhr 'none'; usb 'none'; web-share 'none'; window-management 'none'; xr-spatial-tracking 'none'\" csp=\"sandbox allow-scripts allow-same-origin;\" width=\"560\" height=\"315\" src=\"https://www.youtube-nocookie.com/embed/hoP36Te5wko\" title=\"Importing from WorkflowHub\" frameborder=\"0\" loading=\"lazy\"></iframe> <figcaption>   <span class=\"figcaption-prefix\"><strong>Video</strong>:</span> Importing from WorkflowHub</figcaption> </figure> </blockquote>   <p><!--END_SNIPPET--></p> </blockquote>\n  <p><!--END_SNIPPET--></p>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title>Define DADA2 workflow parameters</hands-on-title>\n\n    <ol>\n      <li>Select following parameters:\n        <ul>\n          <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“Paired short read data”</em>: <code class=\"language-plaintext highlighter-rouge\">Raw Reads</code></li>\n          <li><em>“Read length forward read”</em>: <code class=\"language-plaintext highlighter-rouge\">240</code></li>\n          <li><em>“Read length reverse read”</em>: <code class=\"language-plaintext highlighter-rouge\">160</code></li>\n          <li><em>“Pool samples”</em>: <code class=\"language-plaintext highlighter-rouge\">process samples individually</code></li>\n          <li><em>“Cached reference database”</em>: <code class=\"language-plaintext highlighter-rouge\">Silva version 132</code></li>\n        </ul>\n      </li>\n      <li>Run the workflow</li>\n    </ol>\n  </blockquote>\n\n  <p>The workflow generates several outputs that we will inspect them given the step they correspond to.</p>\n\n</div>\n\n<h1 id=\"prepare-reads\">Prepare reads</h1>\n\n<p>The first step is to check and improve the quality of data.</p>\n\n<h2 id=\"inspect-read-quality-profiles\">Inspect read quality profiles</h2>\n\n<p>We start by visualizing the quality profiles of the forward reads:</p>\n\n<div class=\"Step-by-step\">\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title>Inspect read quality profiles</hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/dada2_plotqualityprofile/dada2_plotQualityProfile/1.28+galaxy0\" title=\"dada2: plotQualityProfile tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>dada2: plotQualityProfile</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.28+galaxy0)</span> with the following parameters:\n        <ul>\n          <li><em>“Processing mode”</em>: <code class=\"language-plaintext highlighter-rouge\">Joint</code>\n            <ul>\n              <li><em>“Paired reads”</em>: <code class=\"language-plaintext highlighter-rouge\">paired - in a data set pair</code>\n                <ul>\n                  <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“Paired short read data”</em>: <code class=\"language-plaintext highlighter-rouge\">Sorted Raw Reads</code></li>\n                </ul>\n              </li>\n              <li><em>“Aggregate data”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n            </ul>\n          </li>\n          <li><em>“sample number”</em>: <code class=\"language-plaintext highlighter-rouge\">10000000</code></li>\n        </ul>\n      </li>\n    </ol>\n  </blockquote>\n</div>\n\n<p><strong>dada2: plotQualityProfile</strong> generates 2 files with quality profiles per sample: 1 PDF for forward reads and 1 PDF for reverse reads.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Inspect read quality profiles</hands-on-title>\n\n  <ol>\n    <li>Inspect <strong>plotQualityProfile</strong> forward read output</li>\n  </ol>\n</blockquote>\n\n<p><a href=\"./images/plotQualityProfile_forward.png\" rel=\"noopener noreferrer\"><img src=\"./images/plotQualityProfile_forward.png\" alt=\"Quality Profiles for the forward reads of all samples with read length on the X-axis and Quality score on the Y-axis. \" width=\"2694\" height=\"2008\" loading=\"lazy\" /></a></p>\n\n<p>In gray-scale is a heatmap of the frequency of each quality score at each base position. The mean quality score at each position is shown by the green line, and the quartiles of the quality score distribution by the orange lines. The red line shows the scaled proportion of reads that extend to at least that position (this is more useful for other sequencing technologies, as Illumina reads are typically all the same length, hence the flat red line).</p>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>Are the forward reads good quality?</li>\n    <li>We generally advise trimming the last few nucleotides to avoid less well-controlled errors that can arise there. What would you recommend as threshold?</li>\n    <li>Are the reverse reads good quality?</li>\n    <li>What would you recommend as threshold for trimming?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>The forward reads are good quality</li>\n      <li>These quality profiles do not suggest that any additional trimming is needed. We will truncate the forward reads at position 240 (trimming the last 10 nucleotides).</li>\n      <li>\n        <p>The reverse reads are of significantly worse quality, especially at the end, which is common in Illumina sequencing. This isn’t too worrisome, as DADA2 incorporates quality information into its error model which makes the algorithm robust to lower quality sequence, but trimming as the average qualities crash will improve the algorithm’s sensitivity to rare sequence variants.</p>\n\n        <p><a href=\"./images/plotQualityProfile_reverse.png\" rel=\"noopener noreferrer\"><img src=\"./images/plotQualityProfile_reverse.png\" alt=\"Quality Profiles for the reverse reads of all samples with read length on the X-axis and Quality score on the Y-axis. \" width=\"2696\" height=\"2024\" loading=\"lazy\" /></a></p>\n      </li>\n      <li>Based on the profiles, we will truncate the reverse reads at position 160 where the quality distribution crashes.</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<blockquote class=\"comment\">\n  <comment-title>Considerations for your own data</comment-title>\n\n  <p>Your reads must still overlap after truncation in order to merge them later! The tutorial is using 2x250 V4 (expected size, 270 bp–387 bp) sequence data, so the forward and reverse reads almost completely overlap and our trimming can be completely guided by the quality scores. If you are using a less-overlapping primer set, like V1-V2 or V3-V4, your truncated length must be large enough to maintain \\(20 + biological.length.variation\\) nucleotides of overlap between them.</p>\n\n</blockquote>\n\n<h2 id=\"filter-and-trim\">Filter and trim</h2>\n\n<div class=\"Step-by-step\">\n\n  <p>Let’s now trim and filter the reads:</p>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title>Filter and trim</hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/dada2_filterandtrim/dada2_filterAndTrim/1.28+galaxy0\" title=\"dada2: filterAndTrim tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>dada2: filterAndTrim</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.28+galaxy0)</span> with the following parameters:\n        <ul>\n          <li><em>“Paired reads”</em>: <code class=\"language-plaintext highlighter-rouge\">paired - in a data set pair</code>\n            <ul>\n              <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“Paired short read data”</em>: <code class=\"language-plaintext highlighter-rouge\">Sorted Raw Reads</code></li>\n            </ul>\n          </li>\n          <li>In <em>“Trimming parameters”</em>:\n            <ul>\n              <li><em>“Truncate read length”</em>: <code class=\"language-plaintext highlighter-rouge\">240</code></li>\n            </ul>\n          </li>\n          <li>In <em>“Filtering parameters”</em>:\n            <ul>\n              <li>\n                <p><em>“Remove reads by number expected errors”</em>: <code class=\"language-plaintext highlighter-rouge\">2</code></p>\n\n                <p>This parameter sets the maximum number of “expected errors” allowed in a read, which is <a href=\"https://academic.oup.com/bioinformatics/article/31/21/3476/194979\">a better filter than simply averaging quality scores</a>.</p>\n              </li>\n            </ul>\n          </li>\n          <li><em>“Separate filters and trimmers for reverse reads”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code>\n            <ul>\n              <li>In <em>“Trimming parameters”</em>:\n                <ul>\n                  <li><em>“Truncate read length”</em>: <code class=\"language-plaintext highlighter-rouge\">160</code></li>\n                </ul>\n              </li>\n              <li>In <em>“Filtering parameters”</em>:\n                <ul>\n                  <li><em>“Remove reads by number expected errors”</em>: <code class=\"language-plaintext highlighter-rouge\">2</code></li>\n                </ul>\n              </li>\n            </ul>\n          </li>\n        </ul>\n      </li>\n    </ol>\n\n  </blockquote>\n\n  <blockquote class=\"comment\">\n    <comment-title>Speeding up downstream computation</comment-title>\n\n    <p>The standard filtering parameters are starting points, not set in stone. If you want to speed up downstream computation, consider tightening the <em>“Remove reads by number expected errors”</em> value. If too few reads are passing the filter, consider relaxing the value, perhaps especially on the reverse reads (e.g. <em>“Remove reads by number expected errors”</em> to <code class=\"language-plaintext highlighter-rouge\">2</code> for forward and <code class=\"language-plaintext highlighter-rouge\">5</code> for reverse), and reducing the <em>“Truncate read length”</em> to remove low quality tails. Remember though, when choosing <em>“Truncate read length”</em> for paired-end reads you must maintain overlap after truncation in order to merge them later.</p>\n\n  </blockquote>\n\n  <blockquote class=\"comment\">\n    <comment-title>ITS data</comment-title>\n\n    <p>For ITS sequencing, it is usually undesirable to truncate reads to a fixed length due to the large length variation at that locus. That is OK, just leave out  <em>“Truncate read length”</em>. See the <a href=\"https://benjjneb.github.io/dada2/ITS_workflow.html\">DADA2 ITS workflow</a> for more information</p>\n\n  </blockquote>\n\n</div>\n\n<p><strong>dada2: filterAndTrim</strong> generates 2 outputs:</p>\n<ul>\n  <li>1 paired-collection named <code class=\"language-plaintext highlighter-rouge\">Paired reads</code> with the trimmed and filtered reads</li>\n  <li>\n    <p>1 collection with statistics for each sample</p>\n\n    <blockquote class=\"question\">\n      <question-title></question-title>\n\n      <ol>\n        <li>How many reads were in F3D0 sample before Filter and Trim?</li>\n        <li>How many readsa are in F3D0 sample before Filter and Trim?</li>\n      </ol>\n\n      <blockquote class=\"solution\">\n        <solution-title></solution-title>\n\n        <p>In F3D0 element in the collection, we see:</p>\n        <ol>\n          <li><code class=\"language-plaintext highlighter-rouge\">reads.in</code>: 7793</li>\n          <li><code class=\"language-plaintext highlighter-rouge\">reads.out</code>: 7113</li>\n        </ol>\n\n      </blockquote>\n\n    </blockquote>\n  </li>\n</ul>\n\n<p>To better see the impact of filtering and trimming, we can inspect the read quality profiles and compare to the profiles before.</p>\n\n<div class=\"Step-by-step\">\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title>Inspect read quality profiles after Filter And Trim</hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/dada2_plotqualityprofile/dada2_plotQualityProfile/1.28+galaxy0\" title=\"dada2: plotQualityProfile tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>dada2: plotQualityProfile</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.28+galaxy0)</span> with the following parameters:\n        <ul>\n          <li><em>“Processing mode”</em>: <code class=\"language-plaintext highlighter-rouge\">Joint</code>\n            <ul>\n              <li><em>“Paired reads”</em>: <code class=\"language-plaintext highlighter-rouge\">paired - in a data set pair</code>\n                <ul>\n                  <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“Paired short read data”</em>: <code class=\"language-plaintext highlighter-rouge\">Paired reads</code> output of <strong>dada2: filterAndTrim</strong></li>\n                </ul>\n              </li>\n              <li><em>“Aggregate data”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n            </ul>\n          </li>\n          <li><em>“sample number”</em>: <code class=\"language-plaintext highlighter-rouge\">10000000</code></li>\n        </ul>\n      </li>\n    </ol>\n\n  </blockquote>\n\n</div>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>Looking at outputs of <strong>plotQualityProfile</strong> for reverse reads before and after <strong>dada2: filterAndTrim</strong></p>\n\n  <!--SNIPPET-->\n  <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-using-the-window-manager-to-view-multiple-datasets\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-using-the-window-manager-to-view-multiple-datasets\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Using the Window Manager to view multiple datasets</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>If you would like to view two or more datasets at once, you can use the <strong>Window Manager</strong> feature in Galaxy:</p>   <ol>   <li><strong>Click</strong> on the <em>Window Manager</em> icon <i class=\"fas fa-th\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-scratchbook</span> on the top menu bar.     <ul>       <li>You should see a little checkmark on the icon now</li>     </ul>   </li>   <li><strong>View</strong> <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> a dataset by clicking on the eye icon <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> to view the output     <ul>       <li>You should see the output in a window overlayed over Galaxy</li>       <li>You can resize this window by dragging the bottom-right corner</li>     </ul>   </li>   <li><strong>Click</strong> outside the file to exit the Window Manager</li>   <li><strong>View</strong> <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> a second dataset from your history     <ul>       <li>You should now see a second window with the new dataset</li>       <li>This makes it easier to compare the two outputs</li>     </ul>   </li>   <li>Repeat this for as many files as you would like to compare</li>   <li>You can turn off the <strong>Window Manager</strong> <i class=\"fas fa-th\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-scratchbook</span> by clicking on the icon again</li> </ol> </blockquote>\n  <p><!--END_SNIPPET--></p>\n\n  <figure id=\"figure-1\" style=\"max-width: 90%;\"><img src=\"./images/plotQualityProfile_reverse.png\" alt=\"Quality Profiles for forward reads of all samples with read length on the X-axis and Quality score on the Y-axis. \" width=\"2696\" height=\"2024\" loading=\"lazy\" /><a target=\"_blank\" href=\"./images/plotQualityProfile_reverse.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 1</strong>:</span> Quality profiles for reverse reads before trimming and filtering</figcaption></figure>\n\n  <figure id=\"figure-2\" style=\"max-width: 90%;\"><img src=\"./images/plotQualityProfile_reverse_after_filter_trim.png\" alt=\"Quality Profiles for reverse reads of all samples with read length on the X-axis and Quality score on the Y-axis. \" width=\"2696\" height=\"2034\" loading=\"lazy\" /><a target=\"_blank\" href=\"./images/plotQualityProfile_reverse_after_filter_trim.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 2</strong>:</span> Quality profiles for reverse reads after trimming and filtering</figcaption></figure>\n\n  <p>How did trimming and filtering change the quality profiles for reverse reads?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <p>The reads have been trimmed making the profiles looking better.</p>\n\n  </blockquote>\n\n</blockquote>\n\n<h2 id=\"learn-the-error-rates\">Learn the Error Rates</h2>\n\n<p>The DADA2 algorithm makes use of a parametric error model (<code class=\"language-plaintext highlighter-rouge\">err</code>) and every amplicon dataset has a different set of error rates. The <strong>dada2: learnErrors</strong> method learns this error model from the data, by alternating estimation of the error rates and inference of sample composition until they converge on a jointly consistent solution. As in many machine-learning problems, the algorithm must begin with an initial guess, for which the maximum possible error rates in this data are used (the error rates if only the most abundant sequence is correct and all the rest are errors).</p>\n\n<div class=\"Step-by-step\">\n\n  <p><strong>dada2: learnErrors</strong> tool expects as input one collection and not a paired collection. We then need to split to paired collection into 2 collections: one with forward reads and one with reverse reads.</p>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title> Unzip paired collection </hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"__UNZIP_COLLECTION__\" title=\"Unzip collection tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Unzip collection</strong></span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Paired input to unzip”</em>: <code class=\"language-plaintext highlighter-rouge\">Paired reads</code> output of <strong>dada2: filterAndTrim</strong></li>\n        </ul>\n      </li>\n      <li>\n        <p>Tag the <code class=\"language-plaintext highlighter-rouge\">(forward)</code> collection with <code class=\"language-plaintext highlighter-rouge\">#forward</code></p>\n\n        <!--SNIPPET-->\n        <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-adding-a-tag-to-a-collection\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-adding-a-tag-to-a-collection\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Adding a tag to a collection</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ol>   <li>Click on the collection in your history to view it</li>   <li>Click on <strong>Edit</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> next to the collection name at the top of the history panel</li>   <li>Click on <strong>Add Tags</strong> <i class=\"fas fa-tags\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-tags</span></li>   <li>Add a tag  named <code class=\"language-plaintext highlighter-rouge\">#forward</code>     <ul>       <li>Tags starting with <code class=\"language-plaintext highlighter-rouge\">#</code> will be automatically propagated to the outputs any tools using this dataset.</li>     </ul>   </li>   <li>Click <strong>Save</strong> <i class=\"far fa-save\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-save</span></li>   <li>Check that the tag appears below the collection name</li> </ol> </blockquote>\n        <p><!--END_SNIPPET--></p>\n      </li>\n      <li>Tag the <code class=\"language-plaintext highlighter-rouge\">(reverse)</code> collection with <code class=\"language-plaintext highlighter-rouge\">#reverse</code></li>\n    </ol>\n  </blockquote>\n\n  <p>Let’s now run <strong>dada2: learnErrors</strong> on both collections.</p>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title> Learn the Error Rate </hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/dada2_learnerrors/dada2_learnErrors/1.28+galaxy0\" title=\"dada2: learnErrors tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>dada2: learnErrors</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.28+galaxy0)</span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Short read data”</em>: <code class=\"language-plaintext highlighter-rouge\">forward</code> output of <strong>Unzip collection</strong></li>\n        </ul>\n      </li>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/dada2_learnerrors/dada2_learnErrors/1.28+galaxy0\" title=\"dada2: learnErrors tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>dada2: learnErrors</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.28+galaxy0)</span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Short read data”</em>: <code class=\"language-plaintext highlighter-rouge\">reverse</code> output of <strong>Unzip collection</strong></li>\n        </ul>\n      </li>\n    </ol>\n\n  </blockquote>\n\n</div>\n\n<figure id=\"figure-3\" style=\"max-width: 90%;\"><img src=\"./images/learnErrors_forward.png\" alt=\"Error rates for each possible transition as a function of the associated quality score, the final estimated error rates, the initial input rates, and the expected error rates under the nominal definition of quality scores. \" width=\"2694\" height=\"2024\" loading=\"lazy\" /><a target=\"_blank\" href=\"./images/learnErrors_forward.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 3</strong>:</span> Error rates for each possible transition for the forward reads</figcaption></figure>\n\n<p>The error rates for each possible transition (A-&gt;C, A-&gt;G, …) are shown as a function of the associated quality score, the final estimated error rates (if they exist), the initial input rates, and the expected error rates under the nominal definition of quality scores. Points are the observed error rates for each consensus quality score. The black line shows the estimated error rates after convergence of the machine-learning algorithm. The red line shows the error rates expected under the nominal definition of the Q-score.</p>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>Are the estimated error rates (black line) in a good fit to the observed rates (points) for the forward reads?</li>\n    <li>\n      <p>What about the reverse reads?</p>\n\n      <figure id=\"figure-4\" style=\"max-width: 90%;\"><img src=\"./images/learnErrors_reverse.png\" alt=\"Error rates for each possible transition as a function of the associated quality score, the final estimated error rates, the initial input rates, and the expected error rates under the nominal definition of quality scores. \" width=\"2690\" height=\"2020\" loading=\"lazy\" /><a target=\"_blank\" href=\"./images/learnErrors_reverse.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 4</strong>:</span> Error rates for each possible transition for the reverse reads</figcaption></figure>\n    </li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>The estimated error rates (black line) are a good fit to the observed rates (points), and the error rates drop with increased quality as expected. Everything looks reasonable and we proceed with confidence.</li>\n      <li>Same</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<h2 id=\"infer-sample-composition\">Infer Sample Composition</h2>\n\n<p>In this step, the core sample inference algorithm (<span class=\"citation\"><a href=\"#Callahan_2016\">Callahan <i>et al.</i> 2016</a></span>) is applied to the filtered and trimmed sequence data.</p>\n\n<div class=\"Step-by-step\">\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title> Sample Inference </hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/dada2_dada/dada2_dada/1.28+galaxy0\" title=\"dada2: dada tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>dada2: dada</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.28+galaxy0)</span> with the following parameters:\n        <ul>\n          <li>\n            <p><em>“Process samples in batches”</em>: <code class=\"language-plaintext highlighter-rouge\">no</code></p>\n\n            <blockquote class=\"comment\">\n              <comment-title>Process samples in batches or not</comment-title>\n\n              <p>Choosing <code class=\"language-plaintext highlighter-rouge\">yes</code> for <em>“Process samples in batches”</em> gives identical results as <code class=\"language-plaintext highlighter-rouge\">no</code> if samples are not pooled.</p>\n\n              <ul>\n                <li><code class=\"language-plaintext highlighter-rouge\">no</code>: a single Galaxy job is started where the samples are processed sequentially</li>\n                <li><code class=\"language-plaintext highlighter-rouge\">yes</code>: a separate Galaxy job is started for each sample (given compute resources, this can be much faster)</li>\n              </ul>\n\n              <p>If <code class=\"language-plaintext highlighter-rouge\">yes</code>, the sorting of the collection is not needed.</p>\n\n            </blockquote>\n\n            <ul>\n              <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Reads”</em>: output of <strong>Unzip collection</strong> with <code class=\"language-plaintext highlighter-rouge\">#forward</code> tag</li>\n              <li>\n                <p><em>“Pool samples”</em>: <code class=\"language-plaintext highlighter-rouge\">process samples individually</code></p>\n\n                <blockquote class=\"comment\">\n                  <comment-title>Sample pooling</comment-title>\n\n                  <p>By default, the <strong>dada2: dada</strong> function processes each sample independently. However, pooling information across samples can increase sensitivity to sequence variants that may be present at very low frequencies in multiple samples. Two types of pooling are possible:</p>\n\n                  <ul>\n                    <li><code class=\"language-plaintext highlighter-rouge\">pool sample</code>: standard pooled processing, in which all samples are pooled together for sample inference</li>\n                    <li><code class=\"language-plaintext highlighter-rouge\">pseudo pooling between individually processed samples</code>: pseudo-pooling, in which samples are processed independently after sharing information between samples, approximating pooled sample inference in linear time.</li>\n                  </ul>\n\n                </blockquote>\n              </li>\n            </ul>\n          </li>\n          <li>\n            <p><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Error rates”</em>: output of <strong>dada2: learnErrors</strong> with <code class=\"language-plaintext highlighter-rouge\">#forward</code> tag</p>\n          </li>\n        </ul>\n      </li>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/dada2_dada/dada2_dada/1.28+galaxy0\" title=\"dada2: dada tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>dada2: dada</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.28+galaxy0)</span> with the following parameters:\n        <ul>\n          <li><em>“Process samples in batches”</em>: <code class=\"language-plaintext highlighter-rouge\">no</code>\n            <ul>\n              <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Reads”</em>: output of <strong>Unzip collection</strong> with <code class=\"language-plaintext highlighter-rouge\">#reverse</code> tag</li>\n              <li><em>“Pool samples”</em>: <code class=\"language-plaintext highlighter-rouge\">process samples individually</code></li>\n            </ul>\n          </li>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Error rates”</em>: output of <strong>dada2: learnErrors</strong> with <code class=\"language-plaintext highlighter-rouge\">#reverse</code> tag</li>\n        </ul>\n      </li>\n    </ol>\n  </blockquote>\n\n</div>\n\n<p>We can look at the number of true sequence variants from unique sequences have been inferred by <strong>DADA2</strong>.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title> Inspect number of true sequence variants from unique sequences </hands-on-title>\n\n  <ol>\n    <li>Click one output collection of <strong>dada2: dada</strong></li>\n    <li>Click on <i class=\"fas fa-info-circle\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">details</span> <em>Show Details</em></li>\n    <li>Expant <em>Tool Standard Output</em></li>\n  </ol>\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>How many unique sequences are in forward reads for sample F3D0?</li>\n    <li>How many true sequence variants from unique sequences have been inferred by DADA2 for this dataset?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>7113 reads in 1979 unique sequences</li>\n      <li>128 sequence variants were inferred from 1979 input unique sequences.</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<h2 id=\"merge-paired-reads\">Merge paired reads</h2>\n\n<p>We now merge the forward and reverse reads together to obtain the full denoised sequences. Merging is performed by aligning the denoised forward reads with the reverse-complement of the corresponding denoised reverse reads, and then constructing the merged “contig” sequences. By default, merged sequences are only output if the forward and reverse reads overlap by at least 12 bases, and are identical to each other in the overlap region (but these conditions can be changed via tool parameters).</p>\n\n<div class=\"Step-by-step\">\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title> Merge paired reads </hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/dada2_mergepairs/dada2_mergePairs/1.28+galaxy0\" title=\"dada2: mergePairs tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>dada2: mergePairs</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.28+galaxy0)</span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Dada results for forward reads”</em>: output of <strong>dada2: dada</strong> with <code class=\"language-plaintext highlighter-rouge\">#forward</code> tag</li>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Forward reads”</em>: output of <strong>Unzip collection</strong> with <code class=\"language-plaintext highlighter-rouge\">#forward</code> tag</li>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Dada results for reverse reads”</em>:  output of <strong>dada2: dada</strong> with <code class=\"language-plaintext highlighter-rouge\">#reverse</code> tag</li>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Reverse reads”</em>: output of <strong>Unzip collection</strong> with <code class=\"language-plaintext highlighter-rouge\">#forward</code> tag</li>\n          <li>\n            <p><em>“Concatenated rather than merge”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></p>\n\n            <blockquote class=\"comment\">\n              <comment-title>Non-overlapping reads</comment-title>\n\n              <p>Non-overlapping reads are supported, but not recommended. In this case, <em>“Concatenated rather than merge”</em> should be <code class=\"language-plaintext highlighter-rouge\">Yes</code>.</p>\n\n            </blockquote>\n          </li>\n          <li><em>“Output detailed table”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        </ul>\n      </li>\n    </ol>\n  </blockquote>\n\n</div>\n\n<p>Let’s inspect the merged data, more specifically the table in <code class=\"language-plaintext highlighter-rouge\">details</code> collection</p>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>How many reads have been merged?</li>\n    <li>What are the different columns in the detail table for F3D0?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>The detail table for F3D0 has 108 lines including a header. So 107 reads (over 128) have been merged</li>\n      <li>The table contains:\n        <ol>\n          <li>merged sequence,</li>\n          <li>its abundance,</li>\n          <li>the indices of the forward sequence variants that were merged</li>\n          <li>the indices of the reverse sequence variants that were merged</li>\n          <li>number of match in the alignment between forward and reverse</li>\n          <li>number of mismatch in the alignment between forward and reverse</li>\n          <li>number of indels in the alignment between forward and reverse</li>\n          <li>prefer</li>\n          <li>status to accept</li>\n        </ol>\n\n        <p>Paired reads that did not exactly overlap were removed by mergePairs, further reducing spurious output.</p>\n      </li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<blockquote class=\"comment\">\n  <comment-title>Not enough reads merged</comment-title>\n\n  <p>Most of the reads should successfully merge. If that is not the case upstream parameters may need to be revisited: Did you trim away the overlap between your reads?</p>\n\n</blockquote>\n\n<h1 id=\"make-sequence-table\">Make sequence table</h1>\n\n<p>In this step, we construct an amplicon sequence variant table (ASV) table, a higher-resolution version of the OTU table produced by traditional methods.</p>\n\n<div class=\"Step-by-step\">\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title> Make sequence table </hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/dada2_makesequencetable/dada2_makeSequenceTable/1.28+galaxy0\" title=\"dada2: makeSequenceTable tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>dada2: makeSequenceTable</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.28+galaxy0)</span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“samples”</em>: output of <strong>dada2: mergePairs</strong></li>\n          <li><em>“Length filter method”</em>: <code class=\"language-plaintext highlighter-rouge\">No filter</code></li>\n        </ul>\n      </li>\n    </ol>\n\n  </blockquote>\n\n</div>\n\n<p><strong>dada2: makeSequenceTable</strong> generates 2 outputs:</p>\n<ol>\n  <li>\n    <p>A sequence table: a matrix with rows corresponding to (and named by) the samples, and columns corresponding to (and named by) the sequence variants.</p>\n\n    <blockquote class=\"question\">\n      <question-title></question-title>\n\n      <p>How many ASVs have been identified?</p>\n\n      <blockquote class=\"solution\">\n        <solution-title></solution-title>\n\n        <p>The file contains 294 lines, including an header. So 293 ASVs have been identified.</p>\n\n      </blockquote>\n\n    </blockquote>\n  </li>\n  <li>\n    <p>An image with sequence length distribution</p>\n\n    <p><a href=\"./images/sequence_length_distribution.png\" rel=\"noopener noreferrer\"><img src=\"./images/sequence_length_distribution.png\" alt=\"Histogram representing sequence length distribution. \" width=\"2128\" height=\"2138\" loading=\"lazy\" /></a></p>\n\n    <blockquote class=\"question\">\n      <question-title></question-title>\n\n      <ol>\n        <li>What is the range of merged sequences?</li>\n        <li>Does the range make sense given the type of amplicon?</li>\n      </ol>\n\n      <blockquote class=\"solution\">\n        <solution-title></solution-title>\n\n        <ol>\n          <li>The lengths of merged sequences are between 251 and 255bp</li>\n          <li>The range falls within the expected range for this V4 amplicon.</li>\n        </ol>\n\n      </blockquote>\n\n    </blockquote>\n\n    <blockquote class=\"comment\">\n      <comment-title>Sequences too long or too shrot</comment-title>\n\n      <p>Sequences that are much longer or shorter than expected may be the result of non-specific priming. Non-target-length sequences can be removed directly from the sequence table. This is analogous to “cutting a band” in-silico to get amplicons of the targeted length.</p>\n\n    </blockquote>\n  </li>\n</ol>\n\n<h2 id=\"remove-chimeras\">Remove chimeras</h2>\n\n<p>The core DADA method corrects substitution and indel errors, but chimeras remain. Fortunately, the accuracy of sequence variants after denoising makes identifying chimeric ASVs simpler than when dealing with fuzzy OTUs. Chimeric sequences are identified if they can be exactly reconstructed by combining a left-segment and a right-segment from two more abundant “parent” sequences.</p>\n\n<div class=\"Step-by-step\">\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title> Remove chimeras </hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/dada2_removebimeradenovo/dada2_removeBimeraDenovo/1.28+galaxy0\" title=\"dada2: removeBimeraDenovo tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>dada2: removeBimeraDenovo</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.28+galaxy0)</span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“sequence table”</em>: output of <strong>dada2: makeSequenceTable</strong></li>\n        </ul>\n      </li>\n    </ol>\n\n  </blockquote>\n\n</div>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>How many non chimeric reads have been found?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <p>remaining nonchimeric:  96.40374 % (visible when expanding the dataset in history)</p>\n\n  </blockquote>\n\n</blockquote>\n\n<p>The frequency of chimeric sequences varies substantially from dataset to dataset, and depends on on factors including experimental procedures and sample complexity. Here chimeras make up about 21% of the merged sequence variants, but when we account for the abundances of those variants we see they account for only about 4% of the merged sequence reads.</p>\n\n<blockquote class=\"comment\">\n  <comment-title>Sequences too long or too short</comment-title>\n\n  <p>Most of the <strong>reads</strong> should remain after chimera removal (it is not uncommon for a majority of <strong>sequence variants</strong> to be removed though). If most of the reads were removed as chimeric, upstream processing may need to be revisited. In almost all cases this is caused by primer sequences with ambiguous nucleotides that were not removed prior to beginning the DADA2 pipeline.</p>\n\n</blockquote>\n\n<h2 id=\"track-reads-through-the-pipeline\">Track reads through the pipeline</h2>\n\n<p>As a final check of our progress, we’ll look at the number of reads that made it through each step in the pipeline.</p>\n\n<div class=\"Step-by-step\">\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title> Track reads through the pipeline </hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/dada2_seqcounts/dada2_seqCounts/1.28+galaxy0\" title=\"dada2: sequence counts tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>dada2: sequence counts</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.28+galaxy0)</span> with the following parameters:\n        <ul>\n          <li>In <em>“data sets”</em>:\n            <ul>\n              <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert data sets”</em>\n                <ul>\n                  <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“Dataset(s)”</em>: output of <strong>dada2: filterAndTrim</strong></li>\n                  <li><em>“name”</em>: <code class=\"language-plaintext highlighter-rouge\">FiltTrim</code></li>\n                </ul>\n              </li>\n              <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert data sets”</em>\n                <ul>\n                  <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“Dataset(s)”</em>: output of <strong>dada2: dada</strong> with <code class=\"language-plaintext highlighter-rouge\">#forward</code> tag</li>\n                  <li><em>“name”</em>: <code class=\"language-plaintext highlighter-rouge\">Dada Forward</code></li>\n                </ul>\n              </li>\n              <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert data sets”</em>\n                <ul>\n                  <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“Dataset(s)”</em>: output of <strong>dada2: dada</strong> with <code class=\"language-plaintext highlighter-rouge\">#reverse</code> tag</li>\n                  <li><em>“name”</em>: <code class=\"language-plaintext highlighter-rouge\">Dada Reverse</code></li>\n                </ul>\n              </li>\n              <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert data sets”</em>\n                <ul>\n                  <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“Dataset(s)”</em>: output of <strong>dada2: mergePairs</strong></li>\n                  <li><em>“name”</em>: <code class=\"language-plaintext highlighter-rouge\">MakePairs</code></li>\n                </ul>\n              </li>\n              <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert data sets”</em>\n                <ul>\n                  <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Dataset(s)”</em>: output of <strong>dada2: makeSequenceTable</strong></li>\n                  <li><em>“name”</em>: <code class=\"language-plaintext highlighter-rouge\">SeqTab</code></li>\n                </ul>\n              </li>\n              <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert data sets”</em>\n                <ul>\n                  <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Dataset(s)”</em>: output of <strong>dada2: removeBimeraDenovo</strong></li>\n                  <li><em>“name”</em>: <code class=\"language-plaintext highlighter-rouge\">Bimera</code></li>\n                </ul>\n              </li>\n            </ul>\n          </li>\n        </ul>\n      </li>\n    </ol>\n\n  </blockquote>\n\n</div>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>Have we kept the majority of the raw reads for F3D143?</li>\n    <li>Is there any over-large drop associated with any single step for any sample?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>Answer for question1</li>\n      <li>No</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<blockquote class=\"comment\">\n  <comment-title>Sequences too long or too short</comment-title>\n\n  <p>This is a great place to do a last sanity check. Outside of filtering, there should no step in which a majority of reads are lost. If a majority of reads failed to merge, you may need to revisit the truncLen parameter used in the filtering step and make sure that the truncated reads span your amplicon. If a majority of reads were removed as chimeric, you may need to revisit the removal of primers, as the ambiguous nucleotides in unremoved primers interfere with chimera identification.</p>\n\n</blockquote>\n\n<h1 id=\"assign-taxonomy\">Assign taxonomy</h1>\n\n<p>It is common at this point, especially in 16S/18S/ITS amplicon sequencing, to assign taxonomy to the sequence variants. The DADA2 package provides a native implementation of the naive Bayesian classifier method (<span class=\"citation\"><a href=\"#Wang_2007\">Wang <i>et al.</i> 2007</a></span>) for this purpose. The <strong>dada2: assignTaxonomy</strong> function takes as input a set of sequences to be classified and a training set of reference sequences with known taxonomy, and outputs taxonomic assignments with at least <code class=\"language-plaintext highlighter-rouge\">minBoot</code> bootstrap confidence.</p>\n\n<p>DADA2 maintains <a href=\"https://benjjneb.github.io/dada2/training.html\">formatted training fastas for the RDP training set, GreenGenes clustered at 97% identity, and the Silva reference database</a>, and additional trainings fastas suitable for protists and certain specific environments have been contributed. For fungal taxonomy, the General Fasta release files from the <a href=\"https://unite.ut.ee/repository.php\">UNITE ITS database</a> can be used as is.</p>\n<div class=\"Step-by-step\">\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title> Assign taxonomy </hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/dada2_assigntaxonomyaddspecies/dada2_assignTaxonomyAddspecies/1.28+galaxy0\" title=\"dada2: assignTaxonomy and addSpecies tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>dada2: assignTaxonomy and addSpecies</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.28+galaxy0)</span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“sequences to be assigned”</em>: output of <strong>dada2: removeBimeraDenovo</strong></li>\n          <li><em>“Select a reference dataset your history or use a built-in?”</em>: <code class=\"language-plaintext highlighter-rouge\">Use a built-in reference</code>\n            <ul>\n              <li><em>“Select reference data set”</em>: <code class=\"language-plaintext highlighter-rouge\">Silva version 132</code></li>\n            </ul>\n          </li>\n          <li><em>“Add genus-species binomials to the taxonomic table”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code>\n            <ul>\n              <li><em>“Select a reference dataset your history or use a built-in?”</em>: <code class=\"language-plaintext highlighter-rouge\">Use a built-in reference</code>\n                <ul>\n                  <li><em>“Select reference data set”</em>: <code class=\"language-plaintext highlighter-rouge\">Silva version 132</code></li>\n                </ul>\n              </li>\n              <li><em>“reporting options”</em>: <code class=\"language-plaintext highlighter-rouge\">only unambiguous identifications</code></li>\n            </ul>\n\n            <blockquote class=\"comment\">\n              <comment-title>Species level assignments based on **exact matching**</comment-title>\n\n              <p>The method of DADA2 make <a href=\"https://benjjneb.github.io/dada2/assign.html#species-assignment\">species level assignments is based on <strong>exact matching</strong></a> between ASVs and sequenced reference strains. Recent analysis suggests that exact matching (or 100% identity) is the only appropriate way to assign species to 16S gene fragments (<span class=\"citation\"><a href=\"#edgar2018updating\">Edgar 2018</a></span>). Currently, <a href=\"https://benjjneb.github.io/dada2/training.html\">species-assignment training fastas are available for the Silva and RDP 16S databases</a>.</p>\n\n            </blockquote>\n          </li>\n        </ul>\n      </li>\n    </ol>\n\n  </blockquote>\n\n</div>\n\n<p><strong>dada2: assignTaxonomy and addSpecies</strong> generates a table with rows being the ASVs and columns the taxonomic levels. Let’s inspect the taxonomic assignments.</p>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>Which kingdom have been identified?</li>\n    <li>Which phyla have been identified? And how many ASVs per phylum?</li>\n    <li>How many ASVs have species assignements?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>\n        <p>Only bacteria</p>\n\n        <blockquote class=\"comment\">\n          <comment-title>Wrong kingdom</comment-title>\n\n          <p>If your reads do not seem to be appropriately assigned, for example lots of your bacterial 16S sequences are being assigned as <code class=\"language-plaintext highlighter-rouge\">Eukaryota</code>, your reads may be in the opposite orientation as the reference database. Tell DADA2 to try the reverse-complement orientation (<em>“Try reverse complement”</em>) with <strong>dada2: assignTaxonomy and addSpecies</strong> and see if this fixes the assignments.</p>\n\n        </blockquote>\n      </li>\n      <li>To get the identified phyla and the number of associated ASVs, we run <span class=\"tool\" data-tool=\"Grouping1\" title=\" Group data by a column tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong> Group data by a column</strong></span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Select data”</em>: output of <strong>dada2: assignTaxonomy and addSpecies</strong></li>\n          <li><em>“Group by column”</em>:<code class=\"language-plaintext highlighter-rouge\">Column 3</code></li>\n          <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>Insert Operation</em>\n            <ul>\n              <li><em>“Type”</em>: <code class=\"language-plaintext highlighter-rouge\">Count</code></li>\n              <li><em>“On column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column 3</code></li>\n            </ul>\n          </li>\n        </ul>\n\n        <table>\n          <thead>\n            <tr>\n              <th>Phyla</th>\n              <th>Number of ASVs</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr>\n              <td>Actinobacteria</td>\n              <td>6</td>\n            </tr>\n            <tr>\n              <td>Bacteroidetes</td>\n              <td>20</td>\n            </tr>\n            <tr>\n              <td>Cyanobacteria</td>\n              <td>3</td>\n            </tr>\n            <tr>\n              <td>Deinococcus-Thermus</td>\n              <td>1</td>\n            </tr>\n            <tr>\n              <td>Epsilonbacteraeota</td>\n              <td>1</td>\n            </tr>\n            <tr>\n              <td>Firmicutes</td>\n              <td>185</td>\n            </tr>\n            <tr>\n              <td>Patescibacteria</td>\n              <td>2</td>\n            </tr>\n            <tr>\n              <td>Phylum</td>\n              <td>1</td>\n            </tr>\n            <tr>\n              <td>Proteobacteria</td>\n              <td>7</td>\n            </tr>\n            <tr>\n              <td>Tenericutes</td>\n              <td>6</td>\n            </tr>\n            <tr>\n              <td>Verrucomicrobia</td>\n              <td>1</td>\n            </tr>\n          </tbody>\n        </table>\n\n        <p>Unsurprisingly, the Bacteroidetes and Firmicutes are well represented among the most abundant taxa in these fecal samples.</p>\n      </li>\n      <li>16/232 species assignments were made, both because it is often not possible to make unambiguous species assignments from subsegments of the 16S gene, and because there is surprisingly little coverage of the indigenous mouse gut microbiota in reference databases.</li>\n    </ol>\n\n  </blockquote>\n</blockquote>\n\n<h1 id=\"exploration-of-asvs-with-phyloseq\">Exploration of ASVs with phyloseq</h1>\n\n<p><strong>phyloseq</strong> (<span class=\"citation\"><a href=\"#McMurdie_2013\">McMurdie and Holmes 2013</a></span>) is a powerful framework for further analysis of microbiome data. It imports, stores, analyzes, and graphically displays complex phylogenetic sequencing data that has already been clustered into Operational Taxonomic Units (OTUs) or ASV, especially when there is associated sample data, phylogenetic tree, and/or taxonomic assignment of the OTUs/ASVs.</p>\n\n<h2 id=\"prepare-metadata-table-and-launch-phyloseq\">Prepare metadata table and launch phyloseq</h2>\n\n<p>To use phyloseq properly, the best is to provide it a metadata table. Here, we will also uses the small amount of metadata we have: the samples are named by the gender (G), mouse subject number (X) and the day post-weaning (Y) it was sampled (eg. GXDY).</p>\n\n<p>We will construct a simple sample table from the information encoded in the filenames. Usually this step would instead involve reading the sample data in from a file. Here we will:</p>\n\n<ol>\n  <li>Extract element identifiers of a collection</li>\n  <li>Add information about gender, mouse subject number and the day post-weaning using the extracted element identifiers</li>\n  <li>Remove last line</li>\n  <li>Add extra column <code class=\"language-plaintext highlighter-rouge\">When</code> to indicate if <code class=\"language-plaintext highlighter-rouge\">Early</code> (days &lt; 100) or <code class=\"language-plaintext highlighter-rouge\">Late</code> (day &gt; 100)</li>\n  <li>Add a header</li>\n</ol>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Prepare metadata table</hands-on-title>\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/collection_element_identifiers/collection_element_identifiers/0.0.2\" title=\"Extract element identifiers tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Extract element identifiers</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.0.2)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“Dataset collection”</em>: output of <strong>dada2: mergePairs</strong></li>\n      </ul>\n\n      <p>We will now extract from the names the factors:</p>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_replace_in_line/1.1.2\" title=\"Replace Text in entire line tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Replace Text in entire line</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.1.2)</span>\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“File to process”</em>: output of <strong>Extract element identifiers</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n        <li>In <em>“Replacement”</em>:\n          <ul>\n            <li>In <em>“1: Replacement”</em>\n              <ul>\n                <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">(.)(.)D(.*)</code></li>\n                <li><em>“Replace with”</em>: <code class=\"language-plaintext highlighter-rouge\">\\1\\2D\\3\\t\\1\\t\\2\\t\\3</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n\n      <p>The given pattern <code class=\"language-plaintext highlighter-rouge\">..D.</code> will be applied to the identifiers, where <code class=\"language-plaintext highlighter-rouge\">.</code> will match any single character and <code class=\"language-plaintext highlighter-rouge\">.*</code> any number of any character. The additional parentheses will record the matched character such that it can be used in the replacement (e.g. <code class=\"language-plaintext highlighter-rouge\">\\1</code> will refer to the content that matched the pattern in the 1st pair of parentheses)\n This step creates 3 additional columns with the gender, the mouse subject number and the day post-weaning</p>\n    </li>\n    <li>\n      <p>Change the datatype to <code class=\"language-plaintext highlighter-rouge\">tabular</code></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-changing-the-datatype\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-changing-the-datatype\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Changing the datatype</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, click <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Datatypes</strong> tab on the top</li>   <li>In the <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Assign Datatype</strong>, select <code class=\"language-plaintext highlighter-rouge\">tabular</code> from “<em>New type</em>” dropdown     <ul>       <li>Tip: you can start typing the datatype into the field to filter the dropdown menu</li>     </ul>   </li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li><span class=\"tool\" data-tool=\"cat1\" title=\"Select first lines tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Select first lines</strong></span> to remove the last line\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“File to select”</em>: output of <strong>Replace Text</strong></li>\n        <li><em>“Operation”</em>: <code class=\"language-plaintext highlighter-rouge\">Remove last lines</code></li>\n        <li><em>“Number of lines”</em>: <code class=\"language-plaintext highlighter-rouge\">1</code></li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/devteam/column_maker/Add_a_column1/2.0\" title=\"Compute tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Compute</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.0)</span> on rows with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input file”</em>: output of <strong>Select first lines</strong></li>\n        <li><em>“Input has a header line with column names?”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n        <li>In <em>“Expressions”</em>:\n          <ul>\n            <li><em>“Add expression”</em>: <code class=\"language-plaintext highlighter-rouge\">bool(c4&gt;100)</code></li>\n            <li><em>“Mode of the operation?”</em>: <code class=\"language-plaintext highlighter-rouge\">Append</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_replace_in_column/9.3+galaxy1\" title=\"Replace Text in a specific column tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Replace Text in a specific column</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 9.3+galaxy1)</span> on rows with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“File to process”</em>: output of <strong>Compute</strong></li>\n        <li>In <em>“Replacement”</em>:\n          <ul>\n            <li>In <em>“1: Replacement”</em>\n              <ul>\n                <li><em>“in column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 5</code></li>\n                <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">True</code></li>\n                <li><em>“Replace with”</em>: <code class=\"language-plaintext highlighter-rouge\">Late</code></li>\n              </ul>\n            </li>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Replacement”</em></li>\n            <li>In <em>“2: Replacement”</em>\n              <ul>\n                <li><em>“in column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 5</code></li>\n                <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">False</code></li>\n                <li><em>“Replace with”</em>: <code class=\"language-plaintext highlighter-rouge\">Early</code></li>\n              </ul>\n            </li>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Replacement”</em></li>\n            <li>In <em>“3: Replacement”</em>\n              <ul>\n                <li><em>“in column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 2</code></li>\n                <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">F</code></li>\n                <li><em>“Replace with”</em>: <code class=\"language-plaintext highlighter-rouge\">Female</code></li>\n              </ul>\n            </li>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Replacement”</em></li>\n            <li>In <em>“4: Replacement”</em>\n              <ul>\n                <li><em>“in column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 2</code></li>\n                <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">M</code></li>\n                <li><em>“Replace with”</em>: <code class=\"language-plaintext highlighter-rouge\">Male</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>\n      <p>Create a new file (<code class=\"language-plaintext highlighter-rouge\">header</code>) from the following (header line of the metadata table)</p>\n\n      <div class=\"language-text highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>Sample\tGender\tMouse\tDay\tWhen\n</code></pre></div>      </div>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-new-file\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-new-file\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a new file</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong> at the bottom</li>   <li>     <p>Paste the file contents into the text field</p>   </li>   <li>Change the dataset name from “New File” to <code class=\"language-plaintext highlighter-rouge\">header</code></li>   <li>Change <strong>Type</strong> from “Auto-detect” to <code class=\"language-plaintext highlighter-rouge\">tabular</code>* Press <strong>Start</strong> and <strong>Close</strong> the window</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li><span class=\"tool\" data-tool=\"cat1\" title=\"Concatenate datasets tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Concatenate datasets</strong></span> to add this header line to the <strong>Replace Text</strong> output:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Concatenate Dataset”</em>: the <code class=\"language-plaintext highlighter-rouge\">header</code> dataset</li>\n        <li><em>“Dataset”</em>\n          <ul>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Dataset”</em>\n              <ul>\n                <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“select”</em>: output of <strong>Replace Text</strong></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>Rename the output to <code class=\"language-plaintext highlighter-rouge\">Metadata table</code></li>\n  </ol>\n</blockquote>\n\n<p>We have now a metadata table with five columns:</p>\n<ol>\n  <li>Sample</li>\n  <li>Gender</li>\n  <li>Mouse subject</li>\n  <li>Day post-weaning</li>\n  <li>When</li>\n</ol>\n\n<p>We now construct a phyloseq object directly with it and the DADA2 outputs and launch Shiny-phyloseq (<span class=\"citation\"><a href=\"#mcmurdie2015shiny\">McMurdie and Holmes 2015</a></span>) to explore the phyloseq object.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title> Create phyloseq object and launch phyloseq exploration </hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/phyloseq_from_dada2/phyloseq_from_dada2/1.46.0+galaxy0\" title=\"Create phyloseq object from dada2 tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Create phyloseq object from dada2</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.46.0+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Sequence table”</em>: output of <strong>dada2: removeBimeraDenovo</strong></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Taxonomy table”</em>: output of <strong>dada2: assignTaxonomy and addSpecies</strong></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Sample table”</em>: <code class=\"language-plaintext highlighter-rouge\">Metadata table</code></li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"interactive_tool_phyloseq\" title=\"Phyloseq tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Phyloseq</strong></span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Phyloseq R object”</em>: output of <strong>Create phyloseq object from dada2</strong></li>\n      </ul>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-open-interactive-tool\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-open-interactive-tool\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Open interactive tool</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ol>   <li>Go to User &gt; Active InteractiveTools</li>   <li>Wait for the  to be running (Job Info)</li>   <li>Click on</li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>A new page will be launched with Shiny-phyloseq ready to explore the phyloseq object.</p>\n\n<h2 id=\"visualize-alpha-diversity\">Visualize alpha-diversity</h2>\n\n<p>A <strong>diversity index</strong> is a quantitative measure that is used to assess the level of diversity or variety within a particular system, such as a biological community, a population, or a workplace. It provides a way to capture and quantify the distribution of different types or categories within a system.</p>\n\n<p>Related to ecology, the term <strong>diversity</strong> describes the number of different species present in one particular area and their relative abundance. More specifically, several different metrics of diversity can be calculated. The most common ones are α, β and γ diversity.</p>\n\n<p>The <strong>α diversity</strong> describes the diversity within a community. It considers the number of different species in an environment (also referred to as species <strong>richness</strong>). Additionally, it can take the abundance of each species into account to measure how evenly individuals are distributed across the sample (also referred to as species <strong>evenness</strong>).</p>\n\n<p>There are several different indices used to calculate α diversity because different indexes capture different aspects of diversity and have varying sensitivities to different factors. These indexes have been developed to address specific research questions, account for different ecological or population characteristics, or highlight certain aspects of diversity.</p>\n\n<figure id=\"figure-5\" style=\"max-width: 90%;\"><img src=\"./images/alphadiversity_metrics.png\" alt=\"Explanation of the α diversity. \" width=\"1400\" height=\"1090\" loading=\"lazy\" /><a target=\"_blank\" href=\"./images/alphadiversity_metrics.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 5</strong>:</span> <a href=\"https://medium.com/pjtorres-high-gut-alpha-diversity-and-health/high-alpha-diversity-and-health-65e5eca7fa36\">Source</a></figcaption></figure>\n\n<p>Here we will plot the <strong>α diversity</strong> for the samples given the Days using 2 measures:</p>\n\n<ul>\n  <li>\n    <p>The <strong>Shannons</strong> index, which calculates the uncertainty in predicting the species identity of an individual that is selected from a community (<span class=\"citation\"><a href=\"#Shannon.1948\">Shannon 1948</a></span>).</p>\n  </li>\n  <li>\n    <p>The <strong>Simpsons</strong> index, which calculates the probability that two individuals selected from a community will be of the same species. Obtains small values in datasets of high diversity and large values in datasets of low diversity (<span class=\"citation\"><a href=\"#SIMPSON.1949\">SIMPSON 1949</a></span>).</p>\n  </li>\n</ul>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title> Plot α diversity </hands-on-title>\n\n  <ol>\n    <li>Click on <strong>Alpha Diversity</strong> tab</li>\n    <li>Select the following parameters:\n      <ul>\n        <li><em>“X”</em>: <code class=\"language-plaintext highlighter-rouge\">Day</code></li>\n        <li><em>“Color”</em>: <code class=\"language-plaintext highlighter-rouge\">When</code></li>\n        <li><em>“alpha Measures”</em>: <code class=\"language-plaintext highlighter-rouge\">Shannon</code>, <code class=\"language-plaintext highlighter-rouge\">Simpson</code></li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<p><a href=\"./images/alpha_diversity.png\" rel=\"noopener noreferrer\"><img src=\"./images/alpha_diversity.png\" alt=\"2 panels for 2 α diversity metrics (Shannon, Simpson) with α diversity value on Y axis and days on X axis. The points are colored given When. \" width=\"1536\" height=\"1536\" loading=\"lazy\" /></a></p>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>Is there any obvious systematic difference in alpha-diversity between early and late samples?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <p>No</p>\n\n  </blockquote>\n\n</blockquote>\n\n<h2 id=\"plot-ordination\">Plot Ordination</h2>\n\n<p>Ordination refers to a set of multivariate techniques used to analyze complex ecological data. It involves summarizing large datasets, such as species abundance across different samples, by projecting them onto a low-dimensional space. This visualization makes it easier to identify patterns and relationships within the data, such as how species distributions correspond to environmental gradients. Ordination helps understand the underlying factors that structure ecological communities and the relative importance of different environmental variables.</p>\n\n<p>Phyloseq offers several ordination methods:</p>\n\n<ol>\n  <li>\n    <p><strong>MDS (Multidimensional Scaling)</strong>: MDS is a technique that visualizes the level of similarity or dissimilarity of individual cases of a dataset by positioning them in a low-dimensional space.</p>\n  </li>\n  <li>\n    <p><strong>PCoA (Principal Coordinates Analysis)</strong>: PCoA is a distance-based ordination method that transforms a distance matrix into a set of coordinates, allowing the visualization of the relationships between samples in a reduced dimensional space.</p>\n  </li>\n  <li>\n    <p><strong>DCA (Detrended Correspondence Analysis)</strong>: DCA is an ordination method that removes the arch effect in Correspondence Analysis, providing a more accurate representation of ecological gradients.</p>\n  </li>\n  <li>\n    <p><strong>CCA (Canonical Correspondence Analysis)</strong>: CCA is a direct gradient analysis technique that relates species composition data to measured environmental variables, highlighting the influence of these variables on community structure.</p>\n  </li>\n  <li>\n    <p><strong>RDA (Redundancy Analysis)</strong>: RDA is a linear ordination method that combines features of regression and PCA, allowing the analysis of relationships between multiple response variables (e.g., species data) and explanatory variables (e.g., environmental data).</p>\n  </li>\n  <li>\n    <p><strong>DPCoA (Double Principle Coordinate Analysis)</strong>: DPCoA is a multivariate technique that combines distance-based methods with correspondence analysis to account for phylogenetic or functional diversity among species.</p>\n  </li>\n  <li>\n    <p><strong>NMDS (Non-metric Multidimensional Scaling)</strong>: NMDS is an ordination technique that aims to represent the pairwise dissimilarities between samples in a low-dimensional space, emphasizing the rank order of dissimilarities rather than their exact values.</p>\n  </li>\n</ol>\n\n<p>Here we will plot <strong>NMDS</strong>.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title> Plot NMDS Ordination plot </hands-on-title>\n\n  <ol>\n    <li>Click on <strong>Ordination</strong> tab</li>\n    <li>Select the following parameters:\n      <ul>\n        <li><em>“Display”</em>: <code class=\"language-plaintext highlighter-rouge\">Samples</code></li>\n        <li><em>“Method”</em>: <code class=\"language-plaintext highlighter-rouge\">NMDS</code></li>\n        <li><em>“Transform”</em>: <code class=\"language-plaintext highlighter-rouge\">Prop</code></li>\n        <li><em>“Color”</em>: <code class=\"language-plaintext highlighter-rouge\">When</code></li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<p><a href=\"./images/ordination.png\" rel=\"noopener noreferrer\"><img src=\"./images/ordination.png\" alt=\"Graph with NMDS1 on X axis and NMDS2 on Y axis. The points are colored in red for early and blue for late. \" width=\"2400\" height=\"2400\" loading=\"lazy\" /></a></p>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>Is there a clear separation between the early and late samples?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <p>Yes</p>\n\n  </blockquote>\n\n</blockquote>\n\n<h2 id=\"plot-abundance-stacked-barplot\">Plot abundance stacked barplot</h2>\n\n<p>Abundance barplots are graphical tools that display the relative abundance of different species or groups in a dataset, allowing for easy comparison and visualization of community composition and distribution patterns across samples.</p>\n\n<p>Let’s plot an abundance stacked barplot at the family level.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title> Plot abundance stacked barplot </hands-on-title>\n\n  <ol>\n    <li>Click on <strong>Bar</strong> tab</li>\n    <li>Select the following parameters:\n      <ul>\n        <li><em>“X-axis”</em>: <code class=\"language-plaintext highlighter-rouge\">Samples</code></li>\n        <li><em>“Color”</em>: <code class=\"language-plaintext highlighter-rouge\">Family</code></li>\n        <li><em>“Facet Col”</em>: <code class=\"language-plaintext highlighter-rouge\">When</code></li>\n      </ul>\n    </li>\n    <li>Click on <strong>(Re)Build Graphic</strong></li>\n  </ol>\n</blockquote>\n\n<p><a href=\"./images/barplot1.png\" rel=\"noopener noreferrer\"><img src=\"./images/barplot1.png\" alt=\"Stacked barplot with sample on X-axis and abundance on Y-axis. Each bar represent the different families (in different colors) for the sample. \" width=\"2400\" height=\"2400\" loading=\"lazy\" /></a></p>\n\n<p>The barplot is hard to read here: many families are in white because the color palette is reduced and we can not distinguish them. We need to filter to data to display only the most abundant families. We will select only taxa with more than 500 counts.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title> Filter and Plot abundance stacked barplot </hands-on-title>\n\n  <ol>\n    <li>Click on <strong>Filter</strong> tab</li>\n    <li>Select the following parameters:\n      <ul>\n        <li><em>” Taxa Min.”</em>: <code class=\"language-plaintext highlighter-rouge\">500</code></li>\n      </ul>\n    </li>\n    <li>Click on <strong>Execute Filter</strong></li>\n    <li>Click on <strong>Bar</strong> tab</li>\n    <li>Select the following parameters:\n      <ul>\n        <li><em>“X-axis”</em>: <code class=\"language-plaintext highlighter-rouge\">Samples</code></li>\n        <li><em>“Color”</em>: <code class=\"language-plaintext highlighter-rouge\">Family</code></li>\n        <li><em>“Facet Col”</em>: <code class=\"language-plaintext highlighter-rouge\">When</code></li>\n      </ul>\n    </li>\n    <li>Click on <strong>(Re)Build Graphic</strong></li>\n  </ol>\n</blockquote>\n\n<p><a href=\"./images/barplot2.png\" rel=\"noopener noreferrer\"><img src=\"./images/barplot2.png\" alt=\"Stacked barplot with sample on X-axis and abundance on Y-axis. Each bar represent the different families (in different colors) for the sample. \" width=\"2400\" height=\"2400\" loading=\"lazy\" /></a></p>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>Is there an obvious change in taxonomy between the early and late samples?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <p>Not really</p>\n\n  </blockquote>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <comment-title>Using ampvis2 for heatmap instead of a barplot</comment-title>\n\n  <p>ampvis2 (<span class=\"citation\"><a href=\"#Andersen_2018\">Andersen <i>et al.</i> 2018</a></span>) team suggests <a href=\"http://albertsenlab.org/ampvis2-heatmap/\">not using stacked bar charts but heatmaps to represent community diversity</a>. You can do that in Galaxy as ampvis2 is available as a tool.</p>\n\n</blockquote>\n\n<h1 id=\"conclusion\">Conclusion</h1>\n\n<p>Constructing an Amplicon Sequence Variant (ASV) table from 16S data using DADA2 provides a robust and accurate method for analyzing microbial communities. This tutorial has guided you through the key steps, including quality filtering, dereplication, error rate learning, sample inference, and chimera removal, culminating in the generation of a high-resolution ASV table and visualization using Phyloseq. By following these steps, you can ensure that your microbial diversity analyses are based on precise and reproducible sequence variants, allowing for more reliable ecological and evolutionary insights.</p>\n"],"ref_slides":[],"hands_on":true,"slides":false,"mod_date":"2024-06-06 09:45:01 +0000","pub_date":"2024-06-05 14:29:10 +0000","version":6,"workflows":[{"workflow":"workflow.ga","tests":true,"url":"https://training.galaxyproject.org/training-material/topics/microbiome/tutorials/dada-16S/workflows/workflow.ga","path":"topics/microbiome/tutorials/dada-16S/workflows/workflow.ga","wfid":"microbiome-dada-16S","wfname":"workflow","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/microbiome-dada-16S/versions/workflow","license":"MIT","creators":[{"class":"Organization","isNew":true,"name":""},{"class":"Person","identifier":"0000-0001-9852-1987","name":"Bérénice Batut"}],"name":"Building an amplicon sequence variant (ASV) table from 16S data using DADA2","title":"Building an amplicon sequence variant (ASV) table from 16S data using DADA2","test_results":null,"modified":"2024-06-14 10:01:51 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Collection\\nRaw reads\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"ℹ️ Input Dataset\\nheader\"];\n  style 1 stroke:#2c3143,stroke-width:4px;\n  2[\"Sort collection\"];\n  0 -->|output| 2;\n  3[\"dada2: filterAndTrim\"];\n  2 -->|output| 3;\n  4[\"dada2: plotQualityProfile\"];\n  2 -->|output| 4;\n  5[\"Unzip collection\"];\n  3 -->|paired_output| 5;\n  6[\"dada2: plotQualityProfile\"];\n  3 -->|paired_output| 6;\n  7[\"dada2: learnErrors\"];\n  5 -->|forward| 7;\n  8[\"dada2: learnErrors\"];\n  5 -->|reverse| 8;\n  9[\"dada2: dada\"];\n  5 -->|forward| 9;\n  7 -->|errors| 9;\n  10[\"dada2: dada\"];\n  5 -->|reverse| 10;\n  8 -->|errors| 10;\n  11[\"dada2: mergePairs\"];\n  9 -->|data_collection| 11;\n  10 -->|data_collection| 11;\n  5 -->|forward| 11;\n  5 -->|reverse| 11;\n  12[\"Extract element identifiers\"];\n  11 -->|merged| 12;\n  13[\"dada2: makeSequenceTable\"];\n  11 -->|merged| 13;\n  3fd25979-39df-4698-bad1-aabfccbb7bd2[\"Output\\nsequence_table\"];\n  13 --> 3fd25979-39df-4698-bad1-aabfccbb7bd2;\n  style 3fd25979-39df-4698-bad1-aabfccbb7bd2 stroke:#2c3143,stroke-width:4px;\n  14[\"Replace Text\"];\n  12 -->|output| 14;\n  15[\"dada2: removeBimeraDenovo\"];\n  13 -->|stable| 15;\n  16[\"Select first\"];\n  14 -->|outfile| 16;\n  17[\"dada2: sequence counts\"];\n  3 -->|outtab| 17;\n  9 -->|data_collection| 17;\n  10 -->|data_collection| 17;\n  11 -->|merged| 17;\n  15 -->|stable_sequencetable| 17;\n  c758f861-44bc-4208-b1f7-1f5106cb678e[\"Output\\nsequence_counts\"];\n  17 --> c758f861-44bc-4208-b1f7-1f5106cb678e;\n  style c758f861-44bc-4208-b1f7-1f5106cb678e stroke:#2c3143,stroke-width:4px;\n  18[\"dada2: assignTaxonomy and addSpecies\"];\n  15 -->|stable_sequencetable| 18;\n  904fe0a2-8329-45ca-8493-fc688fb216c3[\"Output\\ntaxons\"];\n  18 --> 904fe0a2-8329-45ca-8493-fc688fb216c3;\n  style 904fe0a2-8329-45ca-8493-fc688fb216c3 stroke:#2c3143,stroke-width:4px;\n  19[\"Compute\"];\n  16 -->|outfile| 19;\n  20[\"Replace Text\"];\n  19 -->|out_file1| 20;\n  21[\"Concatenate datasets\"];\n  1 -->|output| 21;\n  20 -->|outfile| 21;\n  5479d320-3e82-47a9-a92b-6ed5959459cf[\"Output\\nmetada_table\"];\n  21 --> 5479d320-3e82-47a9-a92b-6ed5959459cf;\n  style 5479d320-3e82-47a9-a92b-6ed5959459cf stroke:#2c3143,stroke-width:4px;\n  22[\"Create phyloseq object\"];\n  21 -->|out_file1| 22;\n  15 -->|stable_sequencetable| 22;\n  18 -->|output| 22;"}],"api":"https://training.galaxyproject.org/training-material/api/topics/microbiome/tutorials/dada-16S/tutorial.json","tools":["Grouping1","__SORTLIST__","__UNZIP_COLLECTION__","cat1","interactive_tool_phyloseq","toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_head_tool/9.3+galaxy1","toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_replace_in_column/9.3+galaxy1","toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_replace_in_line/1.1.2","toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_replace_in_line/9.3+galaxy1","toolshed.g2.bx.psu.edu/repos/devteam/column_maker/Add_a_column1/2.0","toolshed.g2.bx.psu.edu/repos/iuc/collection_element_identifiers/collection_element_identifiers/0.0.2","toolshed.g2.bx.psu.edu/repos/iuc/dada2_assigntaxonomyaddspecies/dada2_assignTaxonomyAddspecies/1.28+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/dada2_assigntaxonomyaddspecies/dada2_assignTaxonomyAddspecies/1.30.0+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/dada2_dada/dada2_dada/1.28+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/dada2_dada/dada2_dada/1.30.0+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/dada2_filterandtrim/dada2_filterAndTrim/1.28+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/dada2_filterandtrim/dada2_filterAndTrim/1.30.0+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/dada2_learnerrors/dada2_learnErrors/1.28+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/dada2_learnerrors/dada2_learnErrors/1.30.0+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/dada2_makesequencetable/dada2_makeSequenceTable/1.28+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/dada2_makesequencetable/dada2_makeSequenceTable/1.30.0+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/dada2_mergepairs/dada2_mergePairs/1.28+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/dada2_mergepairs/dada2_mergePairs/1.30.0+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/dada2_plotqualityprofile/dada2_plotQualityProfile/1.28+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/dada2_plotqualityprofile/dada2_plotQualityProfile/1.30.0+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/dada2_removebimeradenovo/dada2_removeBimeraDenovo/1.28+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/dada2_removebimeradenovo/dada2_removeBimeraDenovo/1.30.0+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/dada2_seqcounts/dada2_seqCounts/1.28+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/dada2_seqcounts/dada2_seqCounts/1.30.0+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/phyloseq_from_dada2/phyloseq_from_dada2/1.46.0+galaxy0"],"supported_servers":{"exact":[{"url":"https://usegalaxy.eu","name":"UseGalaxy.eu","usegalaxy":true},{"url":"https://usegalaxy.fr/","name":"UseGalaxy.fr","usegalaxy":false}],"inexact":[]},"topic_name_human":"Microbiome","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"text_processing","owner":"bgruening","revisions":"fbf99087e067","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"text_processing","owner":"bgruening","revisions":"fbf99087e067","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"text_processing","owner":"bgruening","revisions":"d698c222f354","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"text_processing","owner":"bgruening","revisions":"fbf99087e067","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"column_maker","owner":"devteam","revisions":"6595517c2dd8","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"collection_element_identifiers","owner":"iuc","revisions":"d3c07d270a50","tool_panel_section_label":"Collection Operations","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"dada2_assigntaxonomyaddspecies","owner":"iuc","revisions":"7c2100246a2f","tool_panel_section_label":"Metagenomic Analysis","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"dada2_assigntaxonomyaddspecies","owner":"iuc","revisions":"65db807336bc","tool_panel_section_label":"Metagenomic Analysis","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"dada2_dada","owner":"iuc","revisions":"96336c6a2bb7","tool_panel_section_label":"Metagenomic Analysis","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"dada2_dada","owner":"iuc","revisions":"00f5005840fa","tool_panel_section_label":"Metagenomic Analysis","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"dada2_filterandtrim","owner":"iuc","revisions":"addaf9d22850","tool_panel_section_label":"Metagenomic Analysis","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"dada2_filterandtrim","owner":"iuc","revisions":"e8fba04706d3","tool_panel_section_label":"Metagenomic Analysis","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"dada2_learnerrors","owner":"iuc","revisions":"75403243703a","tool_panel_section_label":"Metagenomic Analysis","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"dada2_learnerrors","owner":"iuc","revisions":"5fe3edf19b9c","tool_panel_section_label":"Metagenomic Analysis","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"dada2_makesequencetable","owner":"iuc","revisions":"43c99742158b","tool_panel_section_label":"Metagenomic Analysis","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"dada2_makesequencetable","owner":"iuc","revisions":"75c8945b0da2","tool_panel_section_label":"Metagenomic Analysis","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"dada2_mergepairs","owner":"iuc","revisions":"5c865a382933","tool_panel_section_label":"Metagenomic Analysis","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"dada2_mergepairs","owner":"iuc","revisions":"35176674168c","tool_panel_section_label":"Metagenomic Analysis","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"dada2_plotqualityprofile","owner":"iuc","revisions":"7b8cb2b02978","tool_panel_section_label":"Metagenomic Analysis","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"dada2_plotqualityprofile","owner":"iuc","revisions":"cae017b76acb","tool_panel_section_label":"Metagenomic Analysis","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"dada2_removebimeradenovo","owner":"iuc","revisions":"7136e9ab70db","tool_panel_section_label":"Metagenomic Analysis","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"dada2_removebimeradenovo","owner":"iuc","revisions":"073608a50ac3","tool_panel_section_label":"Metagenomic Analysis","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"dada2_seqcounts","owner":"iuc","revisions":"19299bb1c6af","tool_panel_section_label":"Metagenomic Analysis","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"dada2_seqcounts","owner":"iuc","revisions":"a7817705348e","tool_panel_section_label":"Metagenomic Analysis","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"phyloseq_from_dada2","owner":"iuc","revisions":"87064cb77a52","tool_panel_section_label":"Metagenomic Analysis","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: text_processing\n  owner: bgruening\n  revisions: fbf99087e067\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: text_processing\n  owner: bgruening\n  revisions: fbf99087e067\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: text_processing\n  owner: bgruening\n  revisions: d698c222f354\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: text_processing\n  owner: bgruening\n  revisions: fbf99087e067\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: column_maker\n  owner: devteam\n  revisions: 6595517c2dd8\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: collection_element_identifiers\n  owner: iuc\n  revisions: d3c07d270a50\n  tool_panel_section_label: Collection Operations\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: dada2_assigntaxonomyaddspecies\n  owner: iuc\n  revisions: 7c2100246a2f\n  tool_panel_section_label: Metagenomic Analysis\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: dada2_assigntaxonomyaddspecies\n  owner: iuc\n  revisions: 65db807336bc\n  tool_panel_section_label: Metagenomic Analysis\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: dada2_dada\n  owner: iuc\n  revisions: 96336c6a2bb7\n  tool_panel_section_label: Metagenomic Analysis\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: dada2_dada\n  owner: iuc\n  revisions: 00f5005840fa\n  tool_panel_section_label: Metagenomic Analysis\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: dada2_filterandtrim\n  owner: iuc\n  revisions: addaf9d22850\n  tool_panel_section_label: Metagenomic Analysis\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: dada2_filterandtrim\n  owner: iuc\n  revisions: e8fba04706d3\n  tool_panel_section_label: Metagenomic Analysis\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: dada2_learnerrors\n  owner: iuc\n  revisions: 75403243703a\n  tool_panel_section_label: Metagenomic Analysis\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: dada2_learnerrors\n  owner: iuc\n  revisions: 5fe3edf19b9c\n  tool_panel_section_label: Metagenomic Analysis\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: dada2_makesequencetable\n  owner: iuc\n  revisions: 43c99742158b\n  tool_panel_section_label: Metagenomic Analysis\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: dada2_makesequencetable\n  owner: iuc\n  revisions: 75c8945b0da2\n  tool_panel_section_label: Metagenomic Analysis\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: dada2_mergepairs\n  owner: iuc\n  revisions: 5c865a382933\n  tool_panel_section_label: Metagenomic Analysis\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: dada2_mergepairs\n  owner: iuc\n  revisions: 35176674168c\n  tool_panel_section_label: Metagenomic Analysis\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: dada2_plotqualityprofile\n  owner: iuc\n  revisions: 7b8cb2b02978\n  tool_panel_section_label: Metagenomic Analysis\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: dada2_plotqualityprofile\n  owner: iuc\n  revisions: cae017b76acb\n  tool_panel_section_label: Metagenomic Analysis\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: dada2_removebimeradenovo\n  owner: iuc\n  revisions: 7136e9ab70db\n  tool_panel_section_label: Metagenomic Analysis\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: dada2_removebimeradenovo\n  owner: iuc\n  revisions: '073608a50ac3'\n  tool_panel_section_label: Metagenomic Analysis\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: dada2_seqcounts\n  owner: iuc\n  revisions: 19299bb1c6af\n  tool_panel_section_label: Metagenomic Analysis\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: dada2_seqcounts\n  owner: iuc\n  revisions: a7817705348e\n  tool_panel_section_label: Metagenomic Analysis\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: phyloseq_from_dada2\n  owner: iuc\n  revisions: 87064cb77a52\n  tool_panel_section_label: Metagenomic Analysis\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":false,"slides_recordings":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial","contributors":[{"name":"Bérénice Batut","email":"berenice.batut@gmail.com","twitter":"bebatut","linkedin":"berenicebatut","matrix":"bebatut:matrix.org","orcid":"0000-0001-9852-1987","joined":"2017-09","elixir_node":"fr","contact_for_training":true,"location":{"country":"FR","lat":45.77,"lon":3.08},"fediverse":"https://piaille.fr/@bebatut","fediverse_flavor":"mastodon","affiliations":["gallantries","ifb","elixir-europe"],"id":"bebatut","url":"https://training.galaxyproject.org/training-material/api/contributors/bebatut.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/bebatut/"},{"name":"Matthias Bernt","joined":"2017-09","elixir_node":"de","id":"bernt-matthias","url":"https://training.galaxyproject.org/training-material/api/contributors/bernt-matthias.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/bernt-matthias/"}]}