{"layout":"tutorial_hands_on","title":"Antibiotic resistance detection","zenodo_link":"https://doi.org/10.5281/zenodo.3247504","questions":["How do I assemble a genome with Nanopore data?","How do I get more information about the structure of the genomes?","How do I get more information about the antimicrobial resistance genes?"],"objectives":["Perform Quality control on your reads","Assemble a genome with Minimap2/Miniasm/Racon","Determine the structure of the genome(s)","Scan for antimicrobial resistance genes with Staramr"],"time_estimation":"3h","key_points":["Minimap2, Miniasm, and Racon can be used for quickly assembling Nanopore data","Unicycler can be used to optimize settings of assembly tools","Nanopore sequencing is useful for reconstruction of genomes","Antimicrobial resistance genes are detectable after fast assembly","The CARD database is a useful resource describing antibiotic resistance genes"],"contributors":[{"name":"Willem de Koning","joined":"2018-09","elixir_node":"nl","affiliations":["elixir-europe"],"id":"willemdek11","url":"https://training.galaxyproject.org/training-material/api/contributors/willemdek11.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/willemdek11/"},{"name":"Saskia Hiltemann","maintainer_contact":"gitter","email":"saskia.hiltemann@gmail.com","fediverse":"https://mstdn.science/@shiltemann","fediverse_flavor":"mastodon","bluesky":"shiltemann.bsky.social","linkedin":"shiltemann","matrix":"shiltemann:matrix.org","orcid":"0000-0003-3803-468X","joined":"2017-09","bio":"Researcher at Erasmus Medical Center","elixir_node":"nl","contact_for_training":true,"affiliations":["CINECA-Project","gallantries","erasmusmc","elixir-europe","uni-freiburg"],"location":{"country":"NL","lat":51.912,"lon":4.462},"id":"shiltemann","url":"https://training.galaxyproject.org/training-material/api/contributors/shiltemann.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/shiltemann/"}],"subtopic":"metabarcoding","tags":["nanopore","plasmids","assembly","amr","microgalaxy"],"redirect_from":["/topics/metagenomics/tutorials/plasmid-metagenomics-nanopore/tutorial","/short/microbiome/plasmid-metagenomics-nanopore","/short/T00209","/short/T00394"],"edam_ontology":["topic_3837","topic_3305","topic_3174","topic_3301","topic_3324","topic_0080","topic_4013"],"recordings":[{"captioners":["bebatut"],"date":"2021-02-15","galaxy_version":"21.01","length":"45M","youtube_id":"ECIl8ZU1Wko","speakers":["willemdek11"]}],"js_requirements":{"mathjax":null,"mermaid":false},"short_id":"T00394","url":"/topics/microbiome/tutorials/plasmid-metagenomics-nanopore/tutorial.html","topic_name":"microbiome","tutorial_name":"plasmid-metagenomics-nanopore","dir":"topics/microbiome/tutorials/plasmid-metagenomics-nanopore","symlink":null,"id":"microbiome/plasmid-metagenomics-nanopore","ref_tutorials":["<h1 id=\"overview\">Overview</h1>\n\n<p>Pervasive use (and misuse) of antibiotics for human disease treatment, as well as for various agricultural purposes, has resulted in the evolution of multi-drug resistant (MDR) pathogenic bacteria. The <a href=\"https://www.cdc.gov/drugresistance/\">Center for Disease Control estimates</a> that in the U.S. alone, every year at least 2 million people get an antibiotic-resistant infection, and at least 23,000 people die. Antibiotic resistance poses a major public health challenge, and its causes and mitigations are widely studied.</p>\n\n<p>Plasmids are small DNA molecules within a cell which are physically separated from chromosomal DNA and can replicate independently. They are most commonly found as small circular, double-stranded DNA molecules in bacteria.</p>\n\n<p><a href=\"../../images/plasmid-metagenomics-nanopore/plasmids.png\" rel=\"noopener noreferrer\"><img src=\"../../images/plasmid-metagenomics-nanopore/plasmids.png\" alt=\"Depiction of plasmids. \" width=\"300\" height=\"141\" loading=\"lazy\" /></a></p>\n\n<p>Plasmids are considered a major vector facilitating the transmission of drug resistant genes among bacteria via <a href=\"https://en.wikipedia.org/wiki/Horizontal_gene_transfer\">horizontal transfer</a> (<span class=\"citation\"><a href=\"#Beatson2014\">Beatson and Walker 2014</a></span>, <span class=\"citation\"><a href=\"#Smillie2010\">Smillie <i>et al.</i> 2010</a></span>). Careful characterization of plasmids and other MDR mobile genetic elements is vital for understanding their evolution and transmission and adaptation to new hosts.</p>\n\n<p><a href=\"../../images/plasmid-metagenomics-nanopore/bacterial_transformation.png\" rel=\"noopener noreferrer\"><img src=\"../../images/plasmid-metagenomics-nanopore/bacterial_transformation.png\" alt=\"Illustration of transformation of a bacteria to drug resistance. \" width=\"1920\" height=\"536\" loading=\"lazy\" /></a></p>\n\n<p>Due to the high prevalence of repeat sequences and inserts in plasmids, using traditional NGS short-read sequencing to assemble plasmid sequences is difficult and time-consuming. With the advent of third-generation single-molecule long-read sequencing technologies, full assembly of plasmid sequences is now possible.</p>\n\n<p>In this tutorial we will recreate the analysis described in the paper by <span class=\"citation\"><a href=\"#LiXie2018\">Li <i>et al.</i> 2018</a></span> entitled <em>Efficient generation of complete sequences of MDR-encoding plasmids by rapid assembly of MinION barcoding sequencing data</em>. We will use data sequenced by the <a href=\"https://nanoporetech.com/\">Nanopore</a> MinION sequencer.</p>\n\n<p>The assembly will be performed with <strong>Minimap2</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> (<span class=\"citation\"><a href=\"#Li2018\">Li 2018</a></span>),\n<strong>Miniasm</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> (<span class=\"citation\"><a href=\"#Li2016\">Li <i>et al.</i> 2015</a></span>), <strong>Racon</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> (<span class=\"citation\"><a href=\"#Vaser2017\">Vaser <i>et al.</i> 2017</a></span>) and <strong>Unicycler</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> (<span class=\"citation\"><a href=\"#Wick2017\">Wick <i>et al.</i> 2017</a></span>).\nThe downstream analysis will use <strong>Nanoplot</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> (<span class=\"citation\"><a href=\"#DeCoster2018\">Coster <i>et al.</i> 2018</a></span>),\n<strong>Bandage</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> (<span class=\"citation\"><a href=\"#Wick2015\">Wick <i>et al.</i> 2015</a></span>), <strong>PlasFlow</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> (<span class=\"citation\"><a href=\"#Krawczyk2018\">Krawczyk <i>et al.</i> 2018</a></span>) and <strong>starmr</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> (<a href=\"https://github.com/phac-nml/staramr\">GitHub</a>).</p>\n\n<p>A schematic view of the workflow we will perform in this tutorial is given below:</p>\n\n<p><a href=\"../../images/plasmid-metagenomics-nanopore/Workflow.png\" rel=\"noopener noreferrer\"><img src=\"../../images/plasmid-metagenomics-nanopore/Workflow.png\" alt=\"Workflow representation of this tutorial. \" width=\"923\" height=\"558\" loading=\"lazy\" /></a></p>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n  <p>In this tutorial, we will cover:</p>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#overview\" id=\"markdown-toc-overview\">Overview</a></li>\n  <li><a href=\"#obtaining-and-preparing-data\" id=\"markdown-toc-obtaining-and-preparing-data\">Obtaining and preparing data</a>    <ol>\n      <li><a href=\"#importing-the-data-into-galaxy\" id=\"markdown-toc-importing-the-data-into-galaxy\">Importing the data into Galaxy</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#quality-control\" id=\"markdown-toc-quality-control\">Quality Control</a>    <ol>\n      <li><a href=\"#nanoplot-to-explore-data\" id=\"markdown-toc-nanoplot-to-explore-data\">NanoPlot to explore data</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#de-novo-assembly\" id=\"markdown-toc-de-novo-assembly\">De-novo Assembly</a>    <ol>\n      <li><a href=\"#pairwise-alignment-using-minimap2\" id=\"markdown-toc-pairwise-alignment-using-minimap2\">Pairwise alignment using Minimap2</a></li>\n      <li><a href=\"#ultrafast-de-novo-assembly-using-miniasm\" id=\"markdown-toc-ultrafast-de-novo-assembly-using-miniasm\">Ultrafast de novo assembly using Miniasm</a></li>\n      <li><a href=\"#remapping-using-minimap2\" id=\"markdown-toc-remapping-using-minimap2\">Remapping using Minimap2</a></li>\n      <li><a href=\"#ultrafast-consensus-module-using-racon\" id=\"markdown-toc-ultrafast-consensus-module-using-racon\">Ultrafast consensus module using Racon</a></li>\n      <li><a href=\"#visualize-assemblies-using-bandage\" id=\"markdown-toc-visualize-assemblies-using-bandage\">Visualize assemblies using Bandage</a></li>\n      <li><a href=\"#optimizing-assemblies-using-unicycler\" id=\"markdown-toc-optimizing-assemblies-using-unicycler\">Optimizing assemblies using Unicycler</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#species-and-plasmids\" id=\"markdown-toc-species-and-plasmids\">Species and plasmids</a>    <ol>\n      <li><a href=\"#prediction-of-plasmid-sequences-and-classes-using-plasflow\" id=\"markdown-toc-prediction-of-plasmid-sequences-and-classes-using-plasflow\">Prediction of plasmid sequences and classes using PlasFlow</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#antibiotic-resistance\" id=\"markdown-toc-antibiotic-resistance\">Antibiotic Resistance</a>    <ol>\n      <li><a href=\"#scan-genome-contigs-for-antimicrobial-resistance-genes\" id=\"markdown-toc-scan-genome-contigs-for-antimicrobial-resistance-genes\">Scan genome contigs for antimicrobial resistance genes</a></li>\n      <li><a href=\"#card-database\" id=\"markdown-toc-card-database\">CARD database</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#conclusion\" id=\"markdown-toc-conclusion\">Conclusion</a></li>\n</ol>\n\n</blockquote>\n\n<!--SNIPPET-->\n<blockquote class=\"comment\">   <div class=\"box-title comment-title\" id=\"comment-results-may-vary\"><i class=\"far fa-comment-dots\" aria-hidden=\"true\"></i> Comment: Results may vary</div>   <p>Your results may be slightly different from the ones presented in this tutorial due to differing versions of tools, reference data, external databases, or because of stochastic processes in the algorithms.</p> </blockquote>\n<p><!--END_SNIPPET--></p>\n\n<p>In this tutorial we use metagenomic Nanopore data, but similar pipelines can be used for other types of datasets or other long-read sequencing platforms.</p>\n\n<h1 id=\"obtaining-and-preparing-data\">Obtaining and preparing data</h1>\n\n<p>We are interested in the reconstruction of full plasmid sequences and determining the presence of any antimicrobial resistance genes.\nWe will use the plasmid dataset created by <span class=\"citation\"><a href=\"#LiXie2018\">Li <i>et al.</i> 2018</a></span> for their evaluation of the efficiency of MDR plasmid sequencing by MinION platform. In the experiment, 12 MDR plasmid-bearing bacterial strains were selected for plasmid extraction, including <em>E. coli</em>, <em>S. typhimurium</em>, <em>V. parahaemolyticus</em>, and <em>K. pneumoniae</em>.</p>\n\n<!--SNIPPET-->\n<blockquote class=\"comment\">   <div class=\"box-title comment-title\" id=\"comment-nanopore-sequencing\"><i class=\"far fa-comment-dots\" aria-hidden=\"true\"></i> Comment: Nanopore sequencing</div>   <p>Nanopore sequencing has several properties that make it well-suited for our purposes</p>   <ol>   <li>Long-read sequencing technology offers <strong>simplified</strong> and less ambiguous genome <strong>assembly</strong></li>   <li>Long-read sequencing gives the ability to <strong>span repetitive genomic regions</strong></li>   <li>Long-read sequencing makes it possible to <strong>identify large structural variations</strong></li> </ol>   <p><img src=\"/training-material/topics/microbiome/images/plasmid-metagenomics-nanopore/nanopore_sequencing.png\" alt=\"How nanopore sequencing works\" title=\"Using nanopore sequencing, a single molecule of DNA or RNA can be sequenced without the need for PCR amplification or chemical labeling of the sample. (Image from: &lt;a href=&quot;https://doi.org/10.7875/togopic.2020.01&quot;&gt;Nanopore sequencing: The advantages of long reads for genome assembly&lt;/a&gt;)\" /> <br /><br /></p>   <p>When using Oxford Nanopore Technologies (ONT) sequencing, the change in electrical current is measured over the membrane of a flow cell. When nucleotides pass the pores in the flow cell the current change is translated (basecalled) to nucleotides by a basecaller. A schematic overview is given in the picture above.</p>   <p>When sequencing using a MinIT or MinION Mk1C, the basecalling software is present on the devices. With basecalling the electrical signals are translated to bases (A,T,G,C) with a quality score per base. The sequenced DNA strand will be basecalled and this will form one read. Multiple reads will be stored in a fastq file.</p> </blockquote>\n<p><!--END_SNIPPET--></p>\n\n<h2 id=\"importing-the-data-into-galaxy\">Importing the data into Galaxy</h2>\n\n<p>For this tutorial, in order to speed up the analysis time, we will use 6 of the 12 samples from the original study.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Obtaining our data</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Make sure you have an empty analysis history. Give it a name.</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-new-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-new-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a new history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>Click the <i class=\"fas fa-plus\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">new-history</span> icon at the top of the history panel:</p>   <p><img src=\"/training-material/shared/images/history_create_new.svg\" alt=\"UI for creating new history\" /></p>   <!-- the original drawing can be found here https://docs.google.com/drawings/d/1cCBrLAo4kDGic5QyB70rRiWJAKTenTU8STsKDaLcVU8/edit?usp=sharing --> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li><strong>Import Sample Data</strong> <a href=\"https://doi.org/10.5281/zenodo.3247504\"><a href=\"https://zenodo.org/badge/DOI/10.5281/zenodo.3247504.svg\" rel=\"noopener noreferrer\"><img src=\"https://zenodo.org/badge/DOI/10.5281/zenodo.3247504.svg\" alt=\"DOI. \" loading=\"lazy\" /></a></a>\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/3247504/files/RB01.fasta\nhttps://zenodo.org/record/3247504/files/RB02.fasta\nhttps://zenodo.org/record/3247504/files/RB04.fasta\nhttps://zenodo.org/record/3247504/files/RB05.fasta\nhttps://zenodo.org/record/3247504/files/RB10.fasta\nhttps://zenodo.org/record/3247504/files/RB12.fasta\n</code></pre></div>      </div>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-via-links\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-via-links\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing via links</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p><strong>Build a list collection</strong> containing all fasta files. Name it <code class=\"language-plaintext highlighter-rouge\">Plasmids</code></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-dataset-collection\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-dataset-collection\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a dataset collection</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on <i class=\"far fa-check-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-selector</span> <strong>Select Items</strong> at the top of the history panel <img src=\"/training-material/topics/galaxy-interface/images/historyItemControls.png\" alt=\"Select Items button\" /></li>   <li>Check all the datasets in your history you would like to include</li>   <li>     <p>Click <strong>n of N selected</strong> and choose <strong>Build Dataset List</strong></p>     <p><img src=\"/training-material/topics/galaxy-interface/images/buildList.png\" alt=\"build list collection menu item\" width=\"15%\" /></p>   </li>   <li>Enter a name for your collection</li>   <li>Click <strong>Create collection</strong> to build your collection</li>   <li>Click on the checkmark icon at the top of your history again</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h1 id=\"quality-control\">Quality Control</h1>\n\n<h2 id=\"nanoplot-to-explore-data\">NanoPlot to explore data</h2>\n\n<p>The first thing we want to do is to get a feeling for our input data and its quality. This is done\nusing the NanoPlot tool. This will create several plots, a statisical report and an HTML\nreport page.</p>\n\n<p><a href=\"../../images/plasmid-metagenomics-nanopore/NanoPlot.png\" rel=\"noopener noreferrer\"><img src=\"../../images/plasmid-metagenomics-nanopore/NanoPlot.png\" alt=\"NanoPlot example. \" width=\"367\" height=\"366\" loading=\"lazy\" /></a></p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Plotting scripts for long read sequencing data</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/nanoplot/nanoplot/1.28.2+galaxy1\" title=\"Nanoplot tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Nanoplot</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.28.2+galaxy1)</span> with the following parameters\n      <ul>\n        <li><i class=\"fas fa-filter\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-select</span> <em>“Select multifile mode”</em>: <code class=\"language-plaintext highlighter-rouge\">batch</code></li>\n        <li><i class=\"fas fa-filter\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-select</span> <em>“Type of the file(s) to work on”</em>: <code class=\"language-plaintext highlighter-rouge\">fasta</code></li>\n        <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“files”</em>: The <code class=\"language-plaintext highlighter-rouge\">Plasmids</code> dataset collection you just created</li>\n      </ul>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-selecting-a-dataset-collection-as-input\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-selecting-a-dataset-collection-as-input\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Selecting a dataset collection as input</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ol>   <li>Click on <i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <strong>Dataset collection</strong> in  front of the input parameter you want to supply the collection to.</li>   <li>Select the collection you want to use from the list</li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>The <code class=\"language-plaintext highlighter-rouge\">HTML report</code> gives an overview of various QC metrics for each sample. For example, it will\nplot the read length distribution of each sample:\n<a href=\"../../images/plasmid-metagenomics-nanopore/NanoPlot_output.png\" rel=\"noopener noreferrer\"><img src=\"../../images/plasmid-metagenomics-nanopore/NanoPlot_output.png\" alt=\"NanoPlot Output. \" width=\"608\" height=\"458\" loading=\"lazy\" /></a></p>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>What was the mean read length for this (RB01) sample?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n    <p>4906.3</p>\n\n    <p>This can be determined by looking at the NanoStats or HTML output of NanoPlot RB01.</p>\n  </blockquote>\n</blockquote>\n\n<p>For more information on the topic of quality control, please see our \n<a href=\"/training-material/topics/sequence-analysis/\">sequence analysis training materials</a></p>\n\n<h1 id=\"de-novo-assembly\">De-novo Assembly</h1>\n\n<h2 id=\"pairwise-alignment-using-minimap2\">Pairwise alignment using Minimap2</h2>\n\n<p>In this experiment we used Nanopore sequencing; this means sequencing results with long reads, and significant overlaps between those reads.\nTo find this overlap, Minimap2 is used. Minimap2 is a sequence alignment program that can be used for different\npurposes, but in this case we’ll use it to find overlaps between long reads with an error rate up to ~15%.\nTypical other use cases for Minimap2 include:</p>\n\n<ol>\n  <li>mapping PacBio or Oxford Nanopore genomic reads to the human genome</li>\n  <li>splice-aware alignment of PacBio Iso-Seq or Nanopore cDNA or Direct RNA reads against a reference genome</li>\n  <li>aligning Illumina single- or paired-end reads</li>\n  <li>assembly-to-assembly alignment</li>\n  <li>full-genome alignment between two closely related species with divergence below ~15%.</li>\n</ol>\n\n<p>Minimap2 is faster and more accurate than mainstream long-read mappers such as BLASR, BWA-MEM, NGMLR and GMAP and\ntherefore widely used for Nanopore alignment. Detailed evaluations of Minimap2 are available in\nthe Minimap2 publication (<span class=\"citation\"><a href=\"#Li2018\">Li 2018</a></span>).</p>\n\n<p><a href=\"../../images/plasmid-metagenomics-nanopore/Minimap2.png\" rel=\"noopener noreferrer\"><img src=\"../../images/plasmid-metagenomics-nanopore/Minimap2.png\" alt=\"Pairwise alignment. \" width=\"361\" height=\"121\" loading=\"lazy\" /></a></p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Pairwise sequence alignment</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/minimap2/minimap2/2.17+galaxy2\" title=\"Map with minimap2 tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Map with minimap2</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.17+galaxy2)</span> with the following parameters\n      <ul>\n        <li><i class=\"fas fa-filter\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-select</span> <em>“Will you select a reference genome from your history or use a built-in index?”</em>: <code class=\"language-plaintext highlighter-rouge\">Use a genome from history and build index</code>\n          <ul>\n            <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“Use the following data collection as the reference sequence”</em>: <code class=\"language-plaintext highlighter-rouge\">Plasmids</code> dataset collection we just created</li>\n          </ul>\n        </li>\n        <li><i class=\"fas fa-filter\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-select</span> <em>“Single or Paired-end reads”</em>: <code class=\"language-plaintext highlighter-rouge\">Single</code>\n          <ul>\n            <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“Select fastq dataset”</em>: The <code class=\"language-plaintext highlighter-rouge\">Plasmids</code> dataset collection</li>\n            <li><i class=\"fas fa-filter\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-select</span> <em>“Select a profile of preset options”</em>: <code class=\"language-plaintext highlighter-rouge\">Oxford Nanopore all-vs-all overlap mapping</code></li>\n          </ul>\n        </li>\n        <li>In the section <strong>Set advanced output options</strong>:\n          <ul>\n            <li><i class=\"fas fa-filter\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-select</span> <em>“Select an output format”</em>: <code class=\"language-plaintext highlighter-rouge\">paf</code></li>\n          </ul>\n        </li>\n      </ul>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-selecting-a-dataset-collection-as-input-1\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-selecting-a-dataset-collection-as-input-1\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Selecting a dataset collection as input</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ol>   <li>Click on <i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <strong>Dataset collection</strong> in  front of the input parameter you want to supply the collection to.</li>   <li>Select the collection you want to use from the list</li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>This step maps the Nanopore sequence reads against itself to find overlaps. The result is a PAF file.\nPAF is a text format describing the approximate mapping positions between two\nset of sequences. PAF is TAB-delimited with each line consisting of the\nfollowing predefined fields:</p>\n\n<table>\n  <thead>\n    <tr>\n      <th style=\"text-align: right\">Col</th>\n      <th style=\"text-align: center\">Type</th>\n      <th style=\"text-align: left\">Description</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td style=\"text-align: right\">1</td>\n      <td style=\"text-align: center\">string</td>\n      <td style=\"text-align: left\">Query sequence name</td>\n    </tr>\n    <tr>\n      <td style=\"text-align: right\">2</td>\n      <td style=\"text-align: center\">int</td>\n      <td style=\"text-align: left\">Query sequence length</td>\n    </tr>\n    <tr>\n      <td style=\"text-align: right\">3</td>\n      <td style=\"text-align: center\">int</td>\n      <td style=\"text-align: left\">Query start (0-based)</td>\n    </tr>\n    <tr>\n      <td style=\"text-align: right\">4</td>\n      <td style=\"text-align: center\">int</td>\n      <td style=\"text-align: left\">Query end (0-based)</td>\n    </tr>\n    <tr>\n      <td style=\"text-align: right\">5</td>\n      <td style=\"text-align: center\">char</td>\n      <td style=\"text-align: left\">Relative strand: “+” or “-“</td>\n    </tr>\n    <tr>\n      <td style=\"text-align: right\">6</td>\n      <td style=\"text-align: center\">string</td>\n      <td style=\"text-align: left\">Target sequence name</td>\n    </tr>\n    <tr>\n      <td style=\"text-align: right\">7</td>\n      <td style=\"text-align: center\">int</td>\n      <td style=\"text-align: left\">Target sequence length</td>\n    </tr>\n    <tr>\n      <td style=\"text-align: right\">8</td>\n      <td style=\"text-align: center\">int</td>\n      <td style=\"text-align: left\">Target start on original strand (0-based)</td>\n    </tr>\n    <tr>\n      <td style=\"text-align: right\">9</td>\n      <td style=\"text-align: center\">int</td>\n      <td style=\"text-align: left\">Target end on original strand (0-based)</td>\n    </tr>\n    <tr>\n      <td style=\"text-align: right\">10</td>\n      <td style=\"text-align: center\">int</td>\n      <td style=\"text-align: left\">Number of residue matches</td>\n    </tr>\n    <tr>\n      <td style=\"text-align: right\">11</td>\n      <td style=\"text-align: center\">int</td>\n      <td style=\"text-align: left\">Alignment block length</td>\n    </tr>\n    <tr>\n      <td style=\"text-align: right\">12</td>\n      <td style=\"text-align: center\">int</td>\n      <td style=\"text-align: left\">Mapping quality (0-255; 255 for missing)</td>\n    </tr>\n  </tbody>\n</table>\n\n<p>View the output of <strong>Minimap2</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> of the collection against RB12, it should look something like this:</p>\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>channel_100_69f2ea89-01c5-45f4-8e1b-55a09acdb3f5_template\t4518\t114\t2613\t+\tchannel_139_250c7e7b-f063-4313-8564-d3efbfa7e38d_template\t3657\t206\t2732\t273\t2605\t0\ttp:A:S\tcm:i:29\ts1:i:240\tdv:f:0.2016\trl:i:1516\nchannel_100_69f2ea89-01c5-45f4-8e1b-55a09acdb3f5_template\t4518\t148\t1212\t+\tchannel_313_35f447cb-7e4b-4c3d-977e-dc0de2717a4d_template\t3776\t2433\t3450\t218\t1064\t0\ttp:A:S\tcm:i:31\ts1:i:210\tdv:f:0.1291\trl:i:1516\nchannel_100_69f2ea89-01c5-45f4-8e1b-55a09acdb3f5_template\t4518\t251\t1328\t+\tchannel_313_a83f7257-52db-46e4-8e2a-1776500c7363_template\t3699\t2327\t3382\t208\t1082\t0\ttp:A:S\tcm:i:29\ts1:i:203\tdv:f:0.1363\trl:i:1516\n</code></pre></div></div>\n\n<h2 id=\"ultrafast-de-novo-assembly-using-miniasm\">Ultrafast de novo assembly using Miniasm</h2>\n\n<p>The mapped reads are ready to be assembled with <strong>Miniasm</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> (<span class=\"citation\"><a href=\"#Li2016\">Li <i>et al.</i> 2015</a></span>). Miniasm is a very fast Overlap Layout Consensus based de-novo assembler for noisy long reads.\nIt takes all-vs-all read self-mappings (typically by <strong>Minimap2</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>) as input and outputs an assembly graph in the GFA format.</p>\n\n<p>Different from mainstream assemblers, miniasm does not have a consensus step.\nIt simply concatenates pieces of read sequences to generate the final sequences.\nThe optimal case would be to recreate a complete chromosome or plasmid.\nThus the per-base error rate is similar to the raw input reads.</p>\n\n<figure id=\"figure-1\" style=\"max-width: 90%;\"><img src=\"../../images/plasmid-metagenomics-nanopore/Miniasm.png\" alt=\"Pairwise alignment. \" width=\"496\" height=\"496\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/plasmid-metagenomics-nanopore/Miniasm.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 1</strong>:</span> Sequencing and Assembly Schematic. A longer sequence is constructed from many smaller, overlapping fragments. These are aligned and reconstructed during assembly to produce the best guess assembly.</figcaption></figure>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>De novo assembly</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/miniasm/miniasm/0.3+galaxy0\" title=\"miniasm tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>miniasm</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.3+galaxy0)</span> with the following parameters\n      <ul>\n        <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“Sequence Reads”</em>: The <code class=\"language-plaintext highlighter-rouge\">Plasmids</code> dataset collection</li>\n        <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“PAF file”</em>: <code class=\"language-plaintext highlighter-rouge\">Output Minimap dataset collection</code> created by <strong>Minimap2</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n      </ul>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-selecting-a-dataset-collection-as-input-2\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-selecting-a-dataset-collection-as-input-2\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Selecting a dataset collection as input</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ol>   <li>Click on <i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <strong>Dataset collection</strong> in  front of the input parameter you want to supply the collection to.</li>   <li>Select the collection you want to use from the list</li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>The <code class=\"language-plaintext highlighter-rouge\">Assembly Graph</code> output file gives information about the steps taken in the assembly.</p>\n\n<p>The output should look like:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>S\tutg000001l\tGAAATCATCAGGCGTTTTTCACGATATGGACGGGAAGATGCGGAAATAGGCAGGAGGACATAGAA [..]\na\tutg000001l\t0\tchannel_364_204a2254-2b6f-4f10-9ec5-6d40f0b870e4_template:101-4457\t+\t4357\n</code></pre></div></div>\n\n<h2 id=\"remapping-using-minimap2\">Remapping using Minimap2</h2>\n\n<p>Remapping is done with the original reads, using the Miniasm assembly as a reference, in order to improve the consensus base call per position. This is used by <strong>Racon</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> for consensus construction. This is done as some reads which might not have mapped well during the consensus calling, will now map to your scaffold.</p>\n\n<p>The Assembly graph created can be used for mapping again with Minimap2, but first the graph should be transformed to FASTA format.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Pairwise sequence alignment</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/gfa_to_fa/gfa_to_fa/0.1.1\" title=\"GFA to Fasta tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>GFA to Fasta</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.1.1)</span> with the following parameters\n      <ul>\n        <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“Input GFA file”</em>: the <code class=\"language-plaintext highlighter-rouge\">Assembly Graph</code> (collection) created by <strong>Miniasm</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n      </ul>\n\n      <blockquote class=\"question\">\n        <question-title></question-title>\n\n        <p>How many contigs do we have for the RB05 sample after de novo assembly?\n<br /><br />\nHint: run <strong>Nanoplot</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> on the output of <strong>GFA to Fasta</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></p>\n\n        <blockquote class=\"solution\">\n          <solution-title></solution-title>\n          <p>25</p>\n\n          <p>This can be determined by looking at the NanoStats output of NanoPlot.</p>\n        </blockquote>\n      </blockquote>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/minimap2/minimap2/2.17+galaxy2\" title=\"Map with minimap2 tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Map with minimap2</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.17+galaxy2)</span> with the following parameters\n      <ul>\n        <li><i class=\"fas fa-filter\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-select</span> <em>“Will you select a reference genome from your history or use a built-in index?”</em>: <code class=\"language-plaintext highlighter-rouge\">Use a genome from history and build index</code>\n          <ul>\n            <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“Use the following dataset as the reference sequence”</em>: <code class=\"language-plaintext highlighter-rouge\">FASTA file</code> output from <strong>GFA to Fasta</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> (collection)</li>\n          </ul>\n        </li>\n        <li><i class=\"fas fa-filter\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-select</span> <em>“Single or Paired-end reads”</em>: <code class=\"language-plaintext highlighter-rouge\">single</code>\n          <ul>\n            <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“Select fastq dataset”</em>: The <code class=\"language-plaintext highlighter-rouge\">Plasmids</code> collection</li>\n            <li><i class=\"fas fa-filter\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-select</span> <em>“Select a profile of preset options”</em>:: <code class=\"language-plaintext highlighter-rouge\">PacBio/Oxford Nanopore read to reference mapping (-Hk19)</code></li>\n          </ul>\n        </li>\n        <li>In the section <strong>Set advanced output options</strong>:\n          <ul>\n            <li><i class=\"fas fa-filter\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-select</span> <em>“Select an output format”</em>: <code class=\"language-plaintext highlighter-rouge\">paf</code></li>\n          </ul>\n        </li>\n      </ul>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-selecting-a-dataset-collection-as-input-3\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-selecting-a-dataset-collection-as-input-3\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Selecting a dataset collection as input</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ol>   <li>Click on <i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <strong>Dataset collection</strong> in  front of the input parameter you want to supply the collection to.</li>   <li>Select the collection you want to use from the list</li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h2 id=\"ultrafast-consensus-module-using-racon\">Ultrafast consensus module using Racon</h2>\n\n<p>The mapped reads can be improved even more using <strong>Racon</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> (<span class=\"citation\"><a href=\"#Vaser2017\">Vaser <i>et al.</i> 2017</a></span>) to find a consensus sequence.\nRacon is a standalone consensus module to correct raw contigs generated by rapid assembly methods which do not include a consensus step.\nIt supports data produced by both Pacific Biosciences and Oxford Nanopore Technologies.</p>\n\n<p><a href=\"../../images/plasmid-metagenomics-nanopore/Racon.png\" rel=\"noopener noreferrer\"><img src=\"../../images/plasmid-metagenomics-nanopore/Racon.png\" alt=\"Consensus Module. \" width=\"342\" height=\"93\" loading=\"lazy\" /></a></p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Consensus module</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/racon/racon/1.4.13\" title=\"Racon tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Racon</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.4.13)</span> with the following parameters\n      <ul>\n        <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“Sequences”</em>: The <code class=\"language-plaintext highlighter-rouge\">Plasmids</code> dataset collection</li>\n        <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“Overlaps”</em>: the latest <code class=\"language-plaintext highlighter-rouge\">PAF file</code> collection created by <strong>Minimap2</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n        <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“Target sequences”</em>: the <code class=\"language-plaintext highlighter-rouge\">FASTA file</code> collection created by <strong>GFA to Fasta</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>The <strong>Racon</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> output file gives the final contigs.</p>\n\n<p>The output of RB04 should look something like:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>&gt;utg000001c LN:i:4653 RC:i:11 XC:f:0.888889\nAATGCAGCTATGGCGCGTGCGGTGCCAAGAAAGCCCGCAGATATTCCGCTTCCTCGCTCATT [..]\n</code></pre></div></div>\n\n<h2 id=\"visualize-assemblies-using-bandage\">Visualize assemblies using Bandage</h2>\n\n<p>To get a sense of how well our data was assembled, and to determine whether the contigs are chomosomal or plasmid DNA (the former being linear sequences while plasmids are circular molecules), <strong>Bandage</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> can give a clear view of the assembly.</p>\n\n<p><strong>Bandage</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> (<span class=\"citation\"><a href=\"#Wick2015\">Wick <i>et al.</i> 2015</a></span>) (a <strong>B</strong>ioinformatics <strong>A</strong>pplication for <strong>N</strong>avigating <strong>D</strong>e novo <strong>A</strong>ssembly <strong>G</strong>raphs <strong>E</strong>asily), is a program that creates visualisations of assembly graphs.\nSequence assembler programs (such as <strong>Miniasm</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> (<span class=\"citation\"><a href=\"#Li2016\">Li <i>et al.</i> 2015</a></span>), <strong>Velvet</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> (<span class=\"citation\"><a href=\"#Zerbino2008\">Zerbino and Birney 2008</a></span>), <strong>SPAdes</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> (<span class=\"citation\"><a href=\"#Bankevich2012\">Bankevich <i>et al.</i> 2012</a></span>), <strong>Trinity</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> (<span class=\"citation\"><a href=\"#Grabherr2011\">Grabherr <i>et al.</i> 2011</a></span>) and <strong>MEGAHIT</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> <span class=\"citation\"><a href=\"#Li2015\">Li <i>et al.</i> 2015</a></span>) carry out assembly by building a graph, from which contigs are generated.</p>\n\n<p>By visualizing these assembly graphs, Bandage allows users to better understand, troubleshoot, and improve the assemblies.</p>\n\n<p><a href=\"../../images/plasmid-metagenomics-nanopore/Bandage.png\" rel=\"noopener noreferrer\"><img src=\"../../images/plasmid-metagenomics-nanopore/Bandage.png\" alt=\"Bandage GUI. \" width=\"1392\" height=\"836\" loading=\"lazy\" /></a></p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Visualising de novo assembly graphs</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/bandage/bandage_image/0.8.1+galaxy2\" title=\"Bandage image tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Bandage image</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.8.1+galaxy2)</span> with the following parameters\n      <ul>\n        <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“Graphical Fragment Assembly”</em>: the <code class=\"language-plaintext highlighter-rouge\">Assembly graph</code> collection created by <strong>Miniasm</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n      </ul>\n    </li>\n    <li>Explore <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> the output images</li>\n  </ol>\n\n  <blockquote class=\"question\">\n    <question-title></question-title>\n\n    <p>In how many samples were the full plasmid sequences assembled?</p>\n\n    <p>Hint: what shape do you expect plasmid molecules to be?</p>\n\n    <blockquote class=\"solution\">\n      <solution-title></solution-title>\n      <p>Ideally, we want to see circular assemblies, indicating the full plasmid sequence was resolved.\nThis is not the case for most of the samples, but we will improve our assemblies in the next section!</p>\n    </blockquote>\n  </blockquote>\n\n</blockquote>\n\n<p>For example, the assembly for sample RB01 looks something like this (your assembly will look a bit different due to randomness in several of the tools):</p>\n\n<figure id=\"figure-2\" style=\"max-width: 90%;\"><img src=\"../../images/plasmid-metagenomics-nanopore/bandage_pre_unicycler.png\" alt=\"Bandage output for sample RB01. \" width=\"548\" height=\"413\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/plasmid-metagenomics-nanopore/bandage_pre_unicycler.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 2</strong>:</span> Bandage output for sample RB01. Large fragments were assembled, but not the full circular plasmid molecules.</figcaption></figure>\n\n<p>As you can see from these Bandage outputs, we were able to assemble our data into fairly large fragments, but were not quite successful in assembling the full (circular) plasmid sequences.</p>\n\n<p>However, all the tools we used to do the assembly have many different parameters that we did not explore, and multiple rounds of mapping and cleaning could improve our data as well. Choosing these parameters carefully could potentially improve our assembly, but this is also a lot of work and not an easy task. This is where <strong>Unicycler</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> (<span class=\"citation\"><a href=\"#Wick2017\">Wick <i>et al.</i> 2017</a></span>) can help us out.</p>\n\n<h2 id=\"optimizing-assemblies-using-unicycler\">Optimizing assemblies using Unicycler</h2>\n\n<p>The assembly tools we used in this tutorial are all implemented in <strong>Unicycler</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>, which will repeatedly run these tools on your data using different parameter settings, in order to find the optimal assembly.</p>\n\n<p><strong>Unicycler</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> has a couple of advantages over running the tools separately:</p>\n\n<ol>\n  <li>The first modification is to <strong>help circular replicons assemble</strong> into circular string graphs.</li>\n  <li><strong>Racon</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> polishing is carried out in <strong>multiple rounds to improve the sequence accuracy</strong>. It will polish until the assembly stops improving, as measured by the agreement between the reads and the assembly.</li>\n  <li>Circular replicons are ‘rotated’ (have their starting position shifted) between rounds of polishing to ensure that <strong>no part of the sequence is left unpolished</strong>.</li>\n</ol>\n\n<p>Let’s try it on our data!</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Unicycler assembly</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/unicycler/unicycler/0.4.8.0\" title=\"Create assemblies with Unicycler tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Create assemblies with Unicycler</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.4.8.0)</span> with the following parameters\n      <ul>\n        <li><i class=\"fas fa-filter\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-select</span> <em>“Paired or Single end data”</em>: <code class=\"language-plaintext highlighter-rouge\">None</code></li>\n        <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“Select long reads. If there are no long reads, leave this empty”</em>: The <code class=\"language-plaintext highlighter-rouge\">Plasmids</code> dataset collection</li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/bandage/bandage_image/0.8.1+galaxy2\" title=\"Bandage image tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Bandage image</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.8.1+galaxy2)</span> with the following parameters\n      <ul>\n        <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“Graphical Fragment Assembly”</em>: the <code class=\"language-plaintext highlighter-rouge\">Final Assembly Graph</code> collection created by <strong>Unicycler</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n      </ul>\n    </li>\n    <li>\n      <p>Examine <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> the output images again</p>\n    </li>\n    <li>Use the <strong>Scratchbook</strong> <i class=\"fas fa-th\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-scratchbook</span> to compare the two assemblies for sample <code class=\"language-plaintext highlighter-rouge\">RB01</code>\n      <ul>\n        <li>Compare the <strong>Bandage</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> images for our two assemblies:\n          <ol>\n            <li>The assembly we got from running <strong>minimap2, miniasm, racon</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> (first time we ran bandage)</li>\n            <li>The assembly obtained with <strong>Unicycler</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n          </ol>\n        </li>\n        <li>Tip: Search your history for the term <code class=\"language-plaintext highlighter-rouge\">bandage</code> to easily find the outputs from our two bandage runs</li>\n      </ul>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-using-the-window-manager-to-view-multiple-datasets\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-using-the-window-manager-to-view-multiple-datasets\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Using the Window Manager to view multiple datasets</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>If you would like to view two or more datasets at once, you can use the <strong>Window Manager</strong> feature in Galaxy:</p>   <ol>   <li><strong>Click</strong> on the <em>Window Manager</em> icon <i class=\"fas fa-th\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-scratchbook</span> on the top menu bar.     <ul>       <li>You should see a little checkmark on the icon now</li>     </ul>   </li>   <li><strong>View</strong> <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> a dataset by clicking on the eye icon <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> to view the output     <ul>       <li>You should see the output in a window overlayed over Galaxy</li>       <li>You can resize this window by dragging the bottom-right corner</li>     </ul>   </li>   <li><strong>Click</strong> outside the file to exit the Window Manager</li>   <li><strong>View</strong> <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> a second dataset from your history     <ul>       <li>You should now see a second window with the new dataset</li>       <li>This makes it easier to compare the two outputs</li>     </ul>   </li>   <li>Repeat this for as many files as you would like to compare</li>   <li>You can turn off the <strong>Window Manager</strong> <i class=\"fas fa-th\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-scratchbook</span> by clicking on the icon again</li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-searching-your-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-searching-your-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Searching your history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>To make it easier to find datasets in large histories, you can filter your history by keywords as follows:</p>   <ol>   <li>     <p><strong>Click</strong> on the <em>search datasets</em> box at the top of the history panel.</p>     <p><img src=\"/training-material/shared/images/history_search_datasets.png\" alt=\"history search box\" /></p>   </li>   <li><strong>Type</strong> a search term in this box     <ul>       <li>For example a tool name, or sample name</li>     </ul>   </li>   <li>To undo the filtering and show your full history again, press on the <em>clear search</em> button <i class=\"fas fa-times-circle\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-clear</span> next to the search box</li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Repeat this comparison for the other samples.</p>\n\n      <blockquote class=\"question\">\n        <question-title></question-title>\n\n        <p>For which samples has the plasmid assembly improved?</p>\n\n        <blockquote class=\"solution\">\n          <solution-title></solution-title>\n          <p>Exploring the outputs for all the samples reveals that many now display circular assemblies, indicating the full plasmids sequence was resolved.</p>\n        </blockquote>\n      </blockquote>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>The Assembly graph image of the RB01 assembly with <strong>miniasm</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> shows one unclear hypothetical plasmid, where the output of <strong>Unicycler</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> shows two clear plasmids, as also shown by <span class=\"citation\"><a href=\"#LiXie2018\">Li <i>et al.</i> 2018</a></span>.</p>\n\n<p><a href=\"../../images/plasmid-metagenomics-nanopore/Bandage_output.png\" rel=\"noopener noreferrer\"><img src=\"../../images/plasmid-metagenomics-nanopore/Bandage_output.png\" alt=\"Bandage output. \" width=\"1135\" height=\"601\" loading=\"lazy\" /></a></p>\n\n<h1 id=\"species-and-plasmids\">Species and plasmids</h1>\n\n<h2 id=\"prediction-of-plasmid-sequences-and-classes-using-plasflow\">Prediction of plasmid sequences and classes using PlasFlow</h2>\n\n<p>To automatically determine whether the contigs represent chromosomal or plasmid DNA, <strong>PlasFlow</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> (<span class=\"citation\"><a href=\"#Krawczyk2018\">Krawczyk <i>et al.</i> 2018</a></span>) can be used, also in the case where a full circular plasmid sequence was not assembled. Furthermore, it assigns the contigs to a bacterial class.</p>\n\n<p><strong>PlasFlow</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> is a set of scripts used for prediction of plasmid sequences in metagenomic contigs.\nIt relies on the neural network models trained on full genome and plasmid sequences and is able to differentiate between plasmids and chromosomes with accuracy reaching 96%.</p>\n\n<p><a href=\"../../images/plasmid-metagenomics-nanopore/PlasFlow.png\" rel=\"noopener noreferrer\"><img src=\"../../images/plasmid-metagenomics-nanopore/PlasFlow.png\" alt=\"Pairwise alignment. \" width=\"594\" height=\"418\" loading=\"lazy\" /></a></p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Prediction of plasmid sequences</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/plasflow/PlasFlow/1.0\" title=\"PlasFlow tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>PlasFlow</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.0)</span> with the following parameters\n      <ul>\n        <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“Sequence Reads”</em>: the <code class=\"language-plaintext highlighter-rouge\">Final Assembly</code> collection created by <strong>Unicycler</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n      </ul>\n    </li>\n  </ol>\n\n  <blockquote class=\"question\">\n    <question-title></question-title>\n\n    <p>What is the classification of contig_id 0 in RB10? (Hint: Check the probability table created by PlasFlow)</p>\n\n    <blockquote class=\"solution\">\n      <solution-title></solution-title>\n      <p>plasmid.Proteobacteria</p>\n\n      <p>This can be determined by looking at the 5th column of the probability table.</p>\n    </blockquote>\n  </blockquote>\n</blockquote>\n\n<p>The most important output of <strong>PlasFlow</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> is a tabular file containing all predictions, consisting of several columns including:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>contig_id \tcontig_name \tcontig_length \tid \tlabel \t...\n</code></pre></div></div>\n\n<p>where:</p>\n\n<ul>\n  <li><code class=\"language-plaintext highlighter-rouge\">contig_id</code>is an internal id of sequence used for the classification</li>\n  <li><code class=\"language-plaintext highlighter-rouge\">contig_name</code> is a name of contig used in the classification</li>\n  <li><code class=\"language-plaintext highlighter-rouge\">contig_length</code> shows the length of a classified sequence</li>\n  <li><code class=\"language-plaintext highlighter-rouge\">id</code> is an internal id of a produced label (classification)</li>\n  <li><code class=\"language-plaintext highlighter-rouge\">label</code> is the actual classification</li>\n  <li><code class=\"language-plaintext highlighter-rouge\">...</code> represents additional columns showing probabilities of assignment to each possible class</li>\n</ul>\n\n<p>Additionally, PlasFlow produces FASTA files containing input sequences binned to plasmids, chromosomes and unclassified.</p>\n\n<h1 id=\"antibiotic-resistance\">Antibiotic Resistance</h1>\n\n<h2 id=\"scan-genome-contigs-for-antimicrobial-resistance-genes\">Scan genome contigs for antimicrobial resistance genes</h2>\n\n<p>To determine whether the contigs contain antimircobial resistance genes (AMR) <a href=\"https://github.com/phac-nml/staramr\">staramr</a> can be used.\n<strong>Staramr</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> scans bacterial genome contigs against both the <strong>ResFinder</strong> (<span class=\"citation\"><a href=\"#Zankari2012\">Zankari <i>et al.</i> 2012</a></span>), <strong>PointFinder</strong> (<span class=\"citation\"><a href=\"#Zankari2017\">Zankari <i>et al.</i> 2017</a></span>), and <strong>PlasmidFinder</strong> (<span class=\"citation\"><a href=\"#Carattoli2014\">Carattoli <i>et al.</i> 2014</a></span>) databases (used by the ResFinder webservice)\nand compiles a summary report of detected antimicrobial resistance genes.</p>\n\n<p><a href=\"../../images/plasmid-metagenomics-nanopore/StarAmr.png\" rel=\"noopener noreferrer\"><img src=\"../../images/plasmid-metagenomics-nanopore/StarAmr.png\" alt=\"Pairwise alignment. \" width=\"234\" height=\"312\" loading=\"lazy\" /></a></p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Prediction of AMR genes</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/nml/staramr/staramr_search/0.7.1+galaxy2\" title=\"staramr tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>staramr</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.7.1+galaxy2)</span> with the following parameters\n      <ul>\n        <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“genomes”</em>: the <code class=\"language-plaintext highlighter-rouge\">Final Assembly</code> collection created by <strong>Unicycler</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n      </ul>\n    </li>\n  </ol>\n\n  <blockquote class=\"question\">\n    <question-title></question-title>\n\n    <p>Which samples contained the resistance gene: dfrA17?</p>\n\n    <p>Hint: Check the resfinder.tsv created by staramr</p>\n\n    <blockquote class=\"solution\">\n      <solution-title></solution-title>\n      <p>RB01, RB02, and RB10</p>\n\n      <p>This can be determined by looking at the 2nd column of the resfinder.tsv output (and the first column for the sample names).</p>\n    </blockquote>\n  </blockquote>\n</blockquote>\n\n<p>There are 5 different output files produced by <strong>staramr</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>:</p>\n\n<ol>\n  <li><code class=\"language-plaintext highlighter-rouge\">summary.tsv</code>:  A summary of all detected AMR genes/mutations in each genome, one genome per line.</li>\n  <li><code class=\"language-plaintext highlighter-rouge\">resfinder.tsv</code>: A tabular file of each AMR gene and additional BLAST information from the <strong>ResFinder</strong> database, one gene per line.</li>\n  <li><code class=\"language-plaintext highlighter-rouge\">pointfinder.tsv</code>: A tabular file of each AMR point mutation and additional BLAST information from the <strong>PointFinder</strong> database, one gene per line.</li>\n  <li><code class=\"language-plaintext highlighter-rouge\">settings.txt</code>: The command-line, database versions, and other settings used to run <code class=\"language-plaintext highlighter-rouge\">staramr</code>.</li>\n  <li><code class=\"language-plaintext highlighter-rouge\">results.xlsx</code>: An Excel spreadsheet containing the previous 4 files as separate worksheets.</li>\n</ol>\n\n<p>The summary file is most important and provides all the resistance genes found.</p>\n\n<h2 id=\"card-database\">CARD database</h2>\n<p>To get more information about these antibiotic resistant genes, you can check the <a href=\"https://card.mcmaster.ca\">CARD database</a> (<strong>C</strong>omprehensive <strong>A</strong>ntibiotic <strong>R</strong>esistance <strong>D</strong>atabase) (<span class=\"citation\"><a href=\"#Jia2016\">Jia <i>et al.</i> 2016</a></span>)</p>\n\n<figure id=\"figure-3\" style=\"max-width: 90%;\"><img src=\"../../images/plasmid-metagenomics-nanopore/card_database.png\" alt=\"Screenshot of the CARD database. \" width=\"817\" height=\"658\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/plasmid-metagenomics-nanopore/card_database.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 3</strong>:</span> Screenshot of the CARD database interface. CARD gives information about the antibiotic resistance genes, as well as links to relevant publications.</figcaption></figure>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>What is the resistance mechanism of the <em>dfrA17</em> gene?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n    <p>antibiotic target replacement</p>\n\n    <p>This can be determined by searching for <a href=\"https://card.mcmaster.ca/ontology/39294\">the gene on the CARD database</a>\n<br /><br />\nFor more information about antibiotic resistance mechanisms, see <span class=\"citation\"><a href=\"#Munita\">Munita and Arias</a></span></p>\n  </blockquote>\n</blockquote>\n\n<h1 id=\"conclusion\">Conclusion</h1>\n<p>You have now seen how to perform an assembly on Nanopore sequencing data, and classify the type and species of the sequences, as well as determined the presence of potential antibiotic resistance genes.</p>\n\n<p>As for any analysis, there are many different tools that can do the job, and the tools presented here are just\none possible pipeline. Which tools are best for your specific data and research question depends on a number of\nfactors. For more information and comparisons between various tools, review papers such as <span class=\"citation\"><a href=\"#DeMaio2019\">Maio <i>et al.</i> 2019</a></span> and <span class=\"citation\"><a href=\"#Jayakumar2017\">Jayakumar and Sakakibara 2017</a></span>\nmay provide further insight.</p>\n\n<p>You have worked your way through the following pipeline:</p>\n\n<p><a href=\"../../images/plasmid-metagenomics-nanopore/Workflow.png\" rel=\"noopener noreferrer\"><img src=\"../../images/plasmid-metagenomics-nanopore/Workflow.png\" alt=\"Workflow representation of this tutorial. \" width=\"923\" height=\"558\" loading=\"lazy\" /></a></p>\n"],"ref_slides":[],"hands_on":true,"slides":false,"mod_date":"2024-05-29 14:28:52 +0000","pub_date":"2019-06-25 20:28:00 +0000","version":4,"workflows":[{"workflow":"Workflow-plasmid-metagenomics-nanopore.ga","tests":false,"url":"https://training.galaxyproject.org/training-material/topics/microbiome/tutorials/plasmid-metagenomics-nanopore/workflows/Workflow-plasmid-metagenomics-nanopore.ga","path":"topics/microbiome/tutorials/plasmid-metagenomics-nanopore/workflows/Workflow-plasmid-metagenomics-nanopore.ga","wfid":"microbiome-plasmid-metagenomics-nanopore","wfname":"workflow-plasmid-metagenomics-nanopore","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/microbiome-plasmid-metagenomics-nanopore/versions/workflow-plasmid-metagenomics-nanopore","license":null,"creators":[],"name":"Copy Of GTN Training - Antibiotic Resistance Detection","title":"Copy Of GTN Training - Antibiotic Resistance Detection","test_results":null,"modified":"2024-06-14 10:38:31 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Collection\\nPlasmids\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"NanoPlot\"];\n  0 -->|output| 1;\n  10[\"NanoPlot\"];\n  9 -->|out_fa| 10;\n  11[\"Map with minimap2\"];\n  0 -->|output| 11;\n  9 -->|out_fa| 11;\n  12[\"Racon\"];\n  9 -->|out_fa| 12;\n  11 -->|alignment_output| 12;\n  0 -->|output| 12;\n  2[\"Map with minimap2\"];\n  0 -->|output| 2;\n  0 -->|output| 2;\n  3[\"Create assemblies with Unicycler\"];\n  0 -->|output| 3;\n  4[\"miniasm\"];\n  2 -->|alignment_output| 4;\n  0 -->|output| 4;\n  5[\"Bandage Image\"];\n  3 -->|assembly_graph| 5;\n  6[\"PlasFlow\"];\n  3 -->|assembly| 6;\n  7[\"staramr\"];\n  3 -->|assembly| 7;\n  8[\"Bandage Image\"];\n  4 -->|gfa| 8;\n  9[\"GFA to FASTA\"];\n  4 -->|gfa| 9;"}],"api":"https://training.galaxyproject.org/training-material/api/topics/microbiome/tutorials/plasmid-metagenomics-nanopore/tutorial.json","tools":["toolshed.g2.bx.psu.edu/repos/bgruening/racon/racon/1.3.1.1","toolshed.g2.bx.psu.edu/repos/bgruening/racon/racon/1.4.13","toolshed.g2.bx.psu.edu/repos/iuc/bandage/bandage_image/0.8.1+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/bandage/bandage_image/0.8.1+galaxy2","toolshed.g2.bx.psu.edu/repos/iuc/gfa_to_fa/gfa_to_fa/0.1.0","toolshed.g2.bx.psu.edu/repos/iuc/gfa_to_fa/gfa_to_fa/0.1.1","toolshed.g2.bx.psu.edu/repos/iuc/miniasm/miniasm/0.2+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/miniasm/miniasm/0.3+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/minimap2/minimap2/2.17","toolshed.g2.bx.psu.edu/repos/iuc/minimap2/minimap2/2.17+galaxy2","toolshed.g2.bx.psu.edu/repos/iuc/nanoplot/nanoplot/1.25.0+galaxy1","toolshed.g2.bx.psu.edu/repos/iuc/nanoplot/nanoplot/1.28.2+galaxy1","toolshed.g2.bx.psu.edu/repos/iuc/plasflow/PlasFlow/1.0","toolshed.g2.bx.psu.edu/repos/iuc/unicycler/unicycler/0.4.7.0","toolshed.g2.bx.psu.edu/repos/iuc/unicycler/unicycler/0.4.8.0","toolshed.g2.bx.psu.edu/repos/nml/staramr/staramr_search/0.5.1","toolshed.g2.bx.psu.edu/repos/nml/staramr/staramr_search/0.7.1+galaxy2"],"supported_servers":{"exact":[{"url":"https://usegalaxy.eu","name":"UseGalaxy.eu","usegalaxy":true}],"inexact":[{"url":"https://usegalaxy.be/","name":"UseGalaxy.be","usegalaxy":false},{"url":"https://usegalaxy.cz/","name":"UseGalaxy.cz","usegalaxy":false},{"url":"https://usegalaxy.no/","name":"UseGalaxy.no","usegalaxy":false},{"url":"https://usegalaxy.org","name":"UseGalaxy.org (Main)","usegalaxy":true},{"url":"https://usegalaxy.org.au","name":"UseGalaxy.org.au","usegalaxy":true}]},"topic_name_human":"Microbiome","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"racon","owner":"bgruening","revisions":"aa39b19ca11e","tool_panel_section_label":"Assembly","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"racon","owner":"bgruening","revisions":"a199cd7ac344","tool_panel_section_label":"Assembly","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"bandage","owner":"iuc","revisions":"067592b6b312","tool_panel_section_label":"Graph/Display Data","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"bandage","owner":"iuc","revisions":"b2860df42e16","tool_panel_section_label":"Graph/Display Data","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"gfa_to_fa","owner":"iuc","revisions":"49d6f8ef63b3","tool_panel_section_label":"Convert Formats","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"gfa_to_fa","owner":"iuc","revisions":"8e9d604e92f4","tool_panel_section_label":"Convert Formats","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"miniasm","owner":"iuc","revisions":"8b6d0d85252b","tool_panel_section_label":"Assembly","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"miniasm","owner":"iuc","revisions":"8dee0218ac7d","tool_panel_section_label":"Assembly","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"minimap2","owner":"iuc","revisions":"3f4d6399997b","tool_panel_section_label":"Mapping","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"minimap2","owner":"iuc","revisions":"8c6cd2650d1f","tool_panel_section_label":"Mapping","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"nanoplot","owner":"iuc","revisions":"645159bcee2d","tool_panel_section_label":"Nanopore","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"nanoplot","owner":"iuc","revisions":"edbb6c5028f5","tool_panel_section_label":"Nanopore","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"plasflow","owner":"iuc","revisions":"bda6012394f7","tool_panel_section_label":"Metagenomic Analysis","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"unicycler","owner":"iuc","revisions":"0a3a602cd1e3","tool_panel_section_label":"Assembly","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"unicycler","owner":"iuc","revisions":"9e3e80cc4ad4","tool_panel_section_label":"Assembly","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"staramr","owner":"nml","revisions":"da787fc8b740","tool_panel_section_label":"Metagenomic Analysis","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"staramr","owner":"nml","revisions":"2fd4d4c9c5c2","tool_panel_section_label":"Metagenomic Analysis","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: racon\n  owner: bgruening\n  revisions: aa39b19ca11e\n  tool_panel_section_label: Assembly\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: racon\n  owner: bgruening\n  revisions: a199cd7ac344\n  tool_panel_section_label: Assembly\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bandage\n  owner: iuc\n  revisions: '067592b6b312'\n  tool_panel_section_label: Graph/Display Data\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bandage\n  owner: iuc\n  revisions: b2860df42e16\n  tool_panel_section_label: Graph/Display Data\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: gfa_to_fa\n  owner: iuc\n  revisions: 49d6f8ef63b3\n  tool_panel_section_label: Convert Formats\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: gfa_to_fa\n  owner: iuc\n  revisions: 8e9d604e92f4\n  tool_panel_section_label: Convert Formats\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: miniasm\n  owner: iuc\n  revisions: 8b6d0d85252b\n  tool_panel_section_label: Assembly\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: miniasm\n  owner: iuc\n  revisions: 8dee0218ac7d\n  tool_panel_section_label: Assembly\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: minimap2\n  owner: iuc\n  revisions: 3f4d6399997b\n  tool_panel_section_label: Mapping\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: minimap2\n  owner: iuc\n  revisions: 8c6cd2650d1f\n  tool_panel_section_label: Mapping\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: nanoplot\n  owner: iuc\n  revisions: 645159bcee2d\n  tool_panel_section_label: Nanopore\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: nanoplot\n  owner: iuc\n  revisions: edbb6c5028f5\n  tool_panel_section_label: Nanopore\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: plasflow\n  owner: iuc\n  revisions: bda6012394f7\n  tool_panel_section_label: Metagenomic Analysis\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: unicycler\n  owner: iuc\n  revisions: 0a3a602cd1e3\n  tool_panel_section_label: Assembly\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: unicycler\n  owner: iuc\n  revisions: 9e3e80cc4ad4\n  tool_panel_section_label: Assembly\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: staramr\n  owner: nml\n  revisions: da787fc8b740\n  tool_panel_section_label: Metagenomic Analysis\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: staramr\n  owner: nml\n  revisions: 2fd4d4c9c5c2\n  tool_panel_section_label: Metagenomic Analysis\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":false,"slides_recordings":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial"}