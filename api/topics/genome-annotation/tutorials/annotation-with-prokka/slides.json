{"layout":"tutorial_slides","title":"Genome annotation with Prokka","zenodo_link":"https://doi.org/10.5281/zenodo.1156405","tags":["prokaryote"],"questions":["How to annotate a bacterial genome?","How to visualize annoted genomic features?"],"objectives":["Load genome into Galaxy","Annotate genome with Prokka","View annotations in JBrowse"],"time_estimation":"1h","level":"Introductory","key_points":["Prokka is a useful tool to annotate a bacterial genome.","JBrowse can be used to inspect the annotation of a genome."],"contributors":["annasyme","tseemann","slugger70"],"subtopic":"prokaryote","edam_ontology":["topic_0622","topic_3301","topic_0623","topic_0080"],"follow_up_training":[{"type":"internal","topic_name":"genome-annotation","tutorials":["apollo"]}],"recordings":[{"captioners":["abretaud"],"date":"2021-02-15","galaxy_version":"21.01","length":"3M","youtube_id":"eqHy-Cc7k4Q","speakers":["awspolly"]}],"js_requirements":{"mathjax":null,"mermaid":false},"short_id":"S00065","url":"/topics/genome-annotation/tutorials/annotation-with-prokka/slides.html","topic_name":"genome-annotation","tutorial_name":"annotation-with-prokka","dir":"topics/genome-annotation/tutorials/annotation-with-prokka","symlink":null,"id":"genome-annotation/annotation-with-prokka","ref_tutorials":["<p>In this section we will use a software tool called Prokka to annotate a draft genome sequence. Prokka is a “wrapper”; it collects together several pieces of software (from various authors), and so avoids “re-inventing the wheel”.</p>\n\n<p>Prokka finds and annotates features (both protein coding regions and RNA genes, i.e. tRNA, rRNA) present on on a sequence. Note, Prokka uses a two-step process for the annotation of protein coding regions: first, protein coding regions on the genome are identified using <a href=\"https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2848648/\">Prodigal</a>; second, the <em>function</em> of the encoded protein is predicted by similarity to proteins in one of many protein or protein domain databases. Prokka is a software tool that can be used to annotate bacterial, archaeal and viral genomes quickly, generating standard output files in GenBank, EMBL and gff formats. More information about Prokka can be found in <a href=\"https://github.com/tseemann/prokka\">Pokka’s github link</a>.</p>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n  <p>In this tutorial, we will deal with:</p>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#import-the-data\" id=\"markdown-toc-import-the-data\">Import the data</a></li>\n  <li><a href=\"#annotate-the-genome\" id=\"markdown-toc-annotate-the-genome\">Annotate the genome</a></li>\n  <li><a href=\"#examine-the-output\" id=\"markdown-toc-examine-the-output\">Examine the output</a></li>\n  <li><a href=\"#view-annotated-features-in-jbrowse\" id=\"markdown-toc-view-annotated-features-in-jbrowse\">View annotated features in JBrowse</a></li>\n  <li><a href=\"#whats-next\" id=\"markdown-toc-whats-next\">What’s Next</a></li>\n</ol>\n\n</blockquote>\n\n<h2 id=\"import-the-data\">Import the data</h2>\n\n<p>Prokka requires assembled contigs.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Obtaining our data</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Make sure you have an empty analysis history. Give it a name.</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-new-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-new-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a new history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>Click the <i class=\"fas fa-plus\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">new-history</span> icon at the top of the history panel:</p>   <p><img src=\"/training-material/shared/images/history_create_new.svg\" alt=\"UI for creating new history\" /></p>   <!-- the original drawing can be found here https://docs.google.com/drawings/d/1cCBrLAo4kDGic5QyB70rRiWJAKTenTU8STsKDaLcVU8/edit?usp=sharing --> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Import the following files from <a href=\"https://doi.org/10.5281/zenodo.1156405\">Zenodo</a> or from the shared data library</p>\n\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/1156405/files/contigs.fasta\n</code></pre></div>      </div>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-via-links\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-via-links\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing via links</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-data-from-a-data-library\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-data-from-a-data-library\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing data from a data library</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>As an alternative to uploading the data from a URL or your computer, the files may also have been made available from a <em>shared data library</em>:</p>   <ol>   <li>Go into <strong>Shared data</strong> (top panel) then <strong>Data libraries</strong></li>   <li>Navigate to  the correct folder as indicated by your instructor.     <ul>       <li>On most Galaxies tutorial data will be provided in a folder named <strong>GTN - Material –&gt; Topic Name -&gt; Tutorial Name</strong>.</li>     </ul>   </li>   <li>Select the desired files</li>   <li>Click on <strong>Add to History</strong> <i class=\"fas fa-caret-down\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-dropdown</span> near the top and select <strong>as Datasets</strong> from the dropdown menu</li>   <li>     <p>In the pop-up window, choose</p>     <ul>       <li><em>“Select history”</em>: the history you want to import the data to (or create a new one)</li>     </ul>   </li>   <li>Click on <strong>Import</strong></li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h2 id=\"annotate-the-genome\">Annotate the genome</h2>\n\n<p>Now we will run the tool called Prokka.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Annotate genome</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/crs4/prokka/prokka/1.14.5+galaxy0\" title=\"Prokka tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Prokka</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.14.5+galaxy0)</span> with the following parameters (leave everything else unchanged)\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“contigs to annotate”</em>: <code class=\"language-plaintext highlighter-rouge\">contigs.fasta</code></li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<h2 id=\"examine-the-output\">Examine the output</h2>\n\n<p>Once Prokka has finished, examine each of its output files.</p>\n\n<ul>\n  <li>The GFF and GBK files contain all of the information about the features annotated (in different formats.)</li>\n  <li>The .txt file contains a summary of the number of features annotated.</li>\n  <li>The .faa file contains the protein sequences of the genes annotated.</li>\n  <li>The .ffn file contains the nucleotide sequences of the genes annotated.</li>\n</ul>\n\n<h2 id=\"view-annotated-features-in-jbrowse\">View annotated features in JBrowse</h2>\n\n<p>Now that we have annotated the draft genome sequence, we would like to view the sequence in the JBrowse genome viewer. First, we have to make a JBrowse file. Then, we can view it within Galaxy.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Visualize the annotation</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/jbrowse/jbrowse/1.16.11+galaxy1\" title=\"JBrowse tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>JBrowse</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.16.11+galaxy1)</span> with the following parameters\n      <ul>\n        <li><em>“Reference genome to display”</em>: <code class=\"language-plaintext highlighter-rouge\">Use a genome from history</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Select the reference genome”</em>: <code class=\"language-plaintext highlighter-rouge\">fna</code> output of <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/crs4/prokka/prokka/1.14.5+galaxy0\" title=\"Prokka tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Prokka</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.14.5+galaxy0)</span></li>\n          </ul>\n\n          <p>This sequence will be the reference against which annotations are displayed</p>\n        </li>\n        <li><em>“Produce Standalone Instance”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        <li><em>“Genetic Code”</em>: <code class=\"language-plaintext highlighter-rouge\">11: The Bacterial, Archaeal and Plant Plastid Code</code></li>\n        <li>\n          <p>Click on <code class=\"language-plaintext highlighter-rouge\">Insert Track Group</code></p>\n\n          <p>We will now set up one track - each track is a dataset displayed underneath the reference sequence (which is displayed as nucleotides in FASTA format).\nWe will choose to display the annotations (the Prokka.gff file).</p>\n\n          <ul>\n            <li>In <strong>1: Track Group</strong>\n              <ul>\n                <li><em>“Track Category”</em>: <code class=\"language-plaintext highlighter-rouge\">gene annotations</code></li>\n                <li>Click on <code class=\"language-plaintext highlighter-rouge\">Insert Annotation Track</code> and fill it with:\n                  <ul>\n                    <li><em>“Track Type”</em>: <code class=\"language-plaintext highlighter-rouge\">GFF/GFF3/BED Features</code></li>\n                    <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“GFF/GFF3/BED Track Data”</em>: <code class=\"language-plaintext highlighter-rouge\">gff</code> output of <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/crs4/prokka/prokka/1.14.5+galaxy0\" title=\"Prokka tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Prokka</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.14.5+galaxy0)</span></li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n\n      <p>A new file will be created in your history, this contains the JBrowse interactive visualisation. We will now view its contents and play with it</p>\n    </li>\n    <li>\n      <p>Inspect the <code class=\"language-plaintext highlighter-rouge\">JBrowse on data XX and data XX - Complete</code> file by clicking on the <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> (eye) icon</p>\n\n      <p>The JBrowse window will appear in the centre Galaxy panel.</p>\n    </li>\n    <li>Display all the tracks and practice maneuvering around\n      <ol>\n        <li>Click on the tick boxes on the left to display the tracks</li>\n        <li>Select contig 1 in the drop down box. You can only see one contig displayed at a time.</li>\n        <li>Zoom by clicking on the <code class=\"language-plaintext highlighter-rouge\">plus</code> and <code class=\"language-plaintext highlighter-rouge\">minus</code> buttons.</li>\n        <li>JBrowse displays the sequence and a 6-frame amino acid translation.</li>\n        <li>Right click on a gene/feature annotation (the bars on the annotation track), then select View Details to see more information.\n          <ul>\n            <li>gene name</li>\n            <li>product name</li>\n            <li>you can download the FASTA sequence by clicking on the disk icon\n<a href=\"../../images/jbrowse6.png\" rel=\"noopener noreferrer\"><img src=\"../../images/jbrowse6.png\" alt=\"JBrowse. \" width=\"889\" height=\"403\" loading=\"lazy\" /></a></li>\n          </ul>\n        </li>\n      </ol>\n    </li>\n  </ol>\n</blockquote>\n\n<h2 id=\"whats-next\">What’s Next</h2>\n\n<p>After automatic annotation of prokaryotic genome, if inspection of predicted genes with JBrowse introduced mistakes, e.g. wrong exon/intron limits, splitted genes, or merged genes – or simply if you wish to rename genes or provide additional functional (e.g., Gene Ontology) data, setting up a manual curation project using <a href=\"http://genomearchitect.org/\">Apollo</a> helps a lot to manually fix these errors.</p>\n\n<p>The <a href=\"/training-material/topics/genome-annotation/tutorials/apollo/tutorial.html\">Apollo training</a> should provide additional guidance.</p>\n"],"ref_slides":["<!--\nTo show speaker notes during a presentation:\npress c to clone the slides (opens a new window)\non one window, press p to show speaker notes\ndisplay the other window\n-->\n\n### Overview\n\n- What is genome annotation?\n\n- Tools for genome annotation\n\n- The tool \"Prokka\"\n\n???\n\n- In these slides, we will learn what is genome annotation, and which tools can be used for genome annotation.\n- We will describe in detail a tool called Prokka.\n\n---\n\n### What is Annotation?\n\n- Classifying and describing parts of the genome sequence\n\n- Annotations are biological or other features on a genome, *e.g.*\n\n    - a ribosome binding site: a biological feature\n\n    - a sequence of TTTTTT: may/may not be biological but could be interesting\n\n- We can name features by type and location, *e.g.* gene, pseudogene, repeat\n\n- We can hypothesise functions, *e.g.* antioxidant activity\n\n???\n\n- Annotating a genome means positioning features along the sequence of a genome.\n- Those features can be anything one can find in a genome sequence: genes, but also binding sites for example.\n- When a feature, like a gene for example, is positioned, you can add information about its function.\n- This operation is named \"functional annotation\".\n\n---\n\n### First: assemble the genome\n![annotation pic](../../images/contigs.png)\n\n???\n\n- Before annotating a genome, you need to assemble it.\n- If you get a high quality assembly, it will be easier to perform a good quality annotation.\n\n---\n\n### Then: annotate\n![annotation pic](../../images/seq_annotation.jpg)\n\n???\n\n- Once you have a good genome sequence, you can annotate it.\n- In this example, there a gene coding for a delta toxin.\n- There is a ribosome binding site in red, and the coding sequence of this gene is in green.\n\n---\n\n### Annotation\n![annotation pic](../../images/annotation_details.png)\n\n???\n\n- For each feature annotated on a genome, you can get its position, its type, and some information about its function or how it is expressed.\n\n---\n\n### How do we annotate? many different ways:\n\n- sequence: does it match known sequences in databases?\n\n- sequence structure: *e.g.* does it look like an exon (start and stop codons)?\n\n- use other data: *e.g.* do lab experiments to investigate biological function\n\n???\n\n- You can annotate features by looking at similarities with known sequences from international databases.\n- Some tools annotate features on a genome by seeking motifs corresponding to known structure (for example gene or exon start or stop).\n- Some lab experiments can help annotate specific regions of a genome, even though it is often much more expensive than an automatic annotation.\n- The lab experiments can provide certainty about function, where automatic annotation is more of a guess.\n\n---\n\n### Prokka\n![annotation pic](../../images/prokka_pipeline.png)\n\n???\n\n- Prokka is a pipeline that runs several other tools to annotate prokaryotic genomes.\n- The input is the assembly of the genome in Fasta format.\n- Prokka runs Aragorn to annotate transfer RNAs.\n- Ribosomal RNAs are annotated with RNAmmer.\n- Infernal uses the Rfam database to annotate non coding RNAs.\n- Finally Prodigal annotated coding genes.\n- Each coding sequence is then compared to the SwissProt sequence database using Blast, and to TIGR and Pfam motif datases using Hmmer3.\n- SignalP is also run to detect signal peptides in each predicted coding sequence.\n- The final result of the whole Prokka pipeline is a set of GFF3, GBK ans ASN1 files.\n\n---\n### More information\nGalaxy Training Network Slides: [Introduction to Genome Annotation](../introduction/slides.html)\n\n???\n\n- More information is available in the \"Introduction to Genome Annotation\" slides.\n"],"hands_on":true,"slides":true,"mod_date":"2024-05-29 14:28:52 +0000","pub_date":"2018-03-06 18:15:31 +0000","version":43,"workflows":[{"workflow":"Galaxy-Workflow-Workflow_constructed_from_history__prokka-workflow_.ga","tests":true,"url":"https://training.galaxyproject.org/training-material/topics/genome-annotation/tutorials/annotation-with-prokka/workflows/Galaxy-Workflow-Workflow_constructed_from_history__prokka-workflow_.ga","path":"topics/genome-annotation/tutorials/annotation-with-prokka/workflows/Galaxy-Workflow-Workflow_constructed_from_history__prokka-workflow_.ga","wfid":"genome-annotation-annotation-with-prokka","wfname":"galaxy-workflow-workflow_constructed_from_history__prokka-workflow_","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/genome-annotation-annotation-with-prokka/versions/galaxy-workflow-workflow_constructed_from_history__prokka-workflow_","license":"GPL-3.0-or-later","creators":[{"class":"Person","identifier":"0000-0002-9906-0673","name":"Anna Syme"},{"class":"Person","identifier":"0000-0001-6046-610X","name":"Torsten Seemann"},{"class":"Person","identifier":"0000-0002-6100-4385","name":"Simon Gladman"}],"name":"Genome Annotation with Prokka ","title":"Genome Annotation with Prokka ","test_results":null,"modified":"2024-06-22 05:30:03 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\ncontigs.fasta\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"Prokka\"];\n  0 -->|output| 1;\n  a336c364-e69e-47eb-ace6-a7fe46d285fe[\"Output\\ngff_output\"];\n  1 --> a336c364-e69e-47eb-ace6-a7fe46d285fe;\n  style a336c364-e69e-47eb-ace6-a7fe46d285fe stroke:#2c3143,stroke-width:4px;\n  2[\"JBrowse\"];\n  1 -->|out_fna| 2;\n  1 -->|out_gff| 2;"}],"api":"https://training.galaxyproject.org/training-material/api/topics/genome-annotation/tutorials/annotation-with-prokka/tutorial.json","tools":["toolshed.g2.bx.psu.edu/repos/crs4/prokka/prokka/1.14.5","toolshed.g2.bx.psu.edu/repos/crs4/prokka/prokka/1.14.5+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/jbrowse/jbrowse/1.16.11+galaxy1"],"supported_servers":{"exact":[{"url":"https://usegalaxy.eu","name":"UseGalaxy.eu","usegalaxy":true},{"url":"https://usegalaxy.org","name":"UseGalaxy.org (Main)","usegalaxy":true}],"inexact":[{"url":"https://galaxy.mesocentre.uca.fr","name":"Galaxy@AuBi","usegalaxy":false},{"url":"https://galaxytrakr.org/","name":"GalaxyTrakr","usegalaxy":false},{"url":"https://mississippi.sorbonne-universite.fr","name":"MISSISSIPPI","usegalaxy":false},{"url":"https://usegalaxy.cz/","name":"UseGalaxy.cz","usegalaxy":false},{"url":"https://usegalaxy.fr/","name":"UseGalaxy.fr","usegalaxy":false},{"url":"https://usegalaxy.no/","name":"UseGalaxy.no","usegalaxy":false},{"url":"https://usegalaxy.org.au","name":"UseGalaxy.org.au","usegalaxy":true}]},"topic_name_human":"Genome Annotation","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"prokka","owner":"crs4","revisions":"bf68eb663bc3","tool_panel_section_label":"Annotation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"prokka","owner":"crs4","revisions":"111884f0d912","tool_panel_section_label":"Annotation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"jbrowse","owner":"iuc","revisions":"a6e57ff585c0","tool_panel_section_label":"Graph/Display Data","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: prokka\n  owner: crs4\n  revisions: bf68eb663bc3\n  tool_panel_section_label: Annotation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: prokka\n  owner: crs4\n  revisions: 111884f0d912\n  tool_panel_section_label: Annotation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: jbrowse\n  owner: iuc\n  revisions: a6e57ff585c0\n  tool_panel_section_label: Graph/Display Data\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":true,"slides_recordings":[{"captioners":["abretaud"],"date":"2021-02-15","galaxy_version":"21.01","length":"3M","youtube_id":"eqHy-Cc7k4Q","speakers":["awspolly"]}],"translations":{"tutorial":[],"slides":[],"video":true},"license":"CC-BY-4.0","type":"tutorial","logo":"GTN","redirect_from":["/short/genome-annotation/annotation-with-prokka/slides","/short/S00065"]}