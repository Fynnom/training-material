{"layout":"tutorial_hands_on","title":"Identification of AMR genes in an assembled bacterial genome","zenodo_link":"https://zenodo.org/record/10572227","questions":["Which resistance genes are on a bacterial genome?","Where are the genes located on the genome?"],"objectives":["Run a series of tool to assess the presence of antimicrobial resistance genes (ARG)","Get information about ARGs","Visualize the ARGs and plasmid genes in their genomic context"],"time_estimation":"2h","key_points":["staramr is a powerful tool to predict ARGs and plasmid genes","Visualization of the ARGs and plasmid genes in their genomic context helps to make sense of the data"],"tags":["gmod","illumina","amr","one-health","jbrowse1","microgalaxy"],"subtopic":"prokaryote","edam_ontology":["topic_3673","topic_3305","topic_0622","topic_3301","topic_0080","topic_3324","topic_4013"],"level":"Introductory","contributions":{"authorship":["bazante1","bebatut"],"editing":["hexylena","bazante1","shiltemann","miaomiaozhou88"],"funding":["avans-atgm","abromics"]},"follow_up_training":[{"type":"internal","topic_name":"visualisation","tutorials":["jbrowse"]},{"type":"internal","topic_name":"galaxy-interface","tutorials":["history-to-workflow"]}],"js_requirements":{"mathjax":null,"mermaid":false},"short_id":"T00401","url":"/topics/genome-annotation/tutorials/amr-gene-detection/tutorial.html","topic_name":"genome-annotation","tutorial_name":"amr-gene-detection","dir":"topics/genome-annotation/tutorials/amr-gene-detection","symlink":null,"id":"genome-annotation/amr-gene-detection","ref_tutorials":["<p>Antimicrobial resistance (AMR) is a global phenomenon with no geographical or species boundaries, which poses an important threat to human, animal and environmental health. It is a complex and growing problem that compromises our ability to treat bacterial infections.</p>\n\n<p>AMR gene content can be assessed from whole genome sequencing to detect known resistance mechanisms and potentially identify novel mechanisms.</p>\n\n<p>To illustrate the process to identify AMR gene in a bacterial genome, we take an assembly of a bacterial genome (KUN1163 sample) generated by following a <a href=\"/training-material/topics/assembly/tutorials/mrsa-illumina/tutorial.html\">bacterial genome assembly tutorial</a> from data produced in “Complete Genome Sequences of Eight Methicillin-Resistant <em>Staphylococcus aureus</em> Strains Isolated from Patients in Japan” (<span class=\"citation\"><a href=\"#Hikichi_2019\">Hikichi <i>et al.</i> 2019</a></span>).</p>\n\n<blockquote class=\"quote\" cite=\"https://doi.org/10.1128%2Fmra.01212-19\">\n  <p>Methicillin-resistant <em>Staphylococcus aureus</em> (MRSA) is a major pathogen\ncausing nosocomial infections, and the clinical manifestations of MRSA\nrange from asymptomatic colonization of the nasal mucosa to soft tissue\ninfection to fulminant invasive disease. Here, we report the complete\ngenome sequences of eight MRSA strains isolated from patients in Japan.</p>\n</blockquote>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n  <p>In this tutorial, we will cover:</p>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#galaxy-and-data-preparation\" id=\"markdown-toc-galaxy-and-data-preparation\">Galaxy and data preparation</a></li>\n  <li><a href=\"#identification-of-amr-genes\" id=\"markdown-toc-identification-of-amr-genes\">Identification of AMR genes</a></li>\n  <li><a href=\"#getting-more-information-about-arg-via-the-card-database\" id=\"markdown-toc-getting-more-information-about-arg-via-the-card-database\">Getting more information about ARG via the CARD database</a></li>\n  <li><a href=\"#visualization-of-the-args-and-plasmid-genes-in-their-genomic-context\" id=\"markdown-toc-visualization-of-the-args-and-plasmid-genes-in-their-genomic-context\">Visualization of the ARGs and plasmid genes in their genomic context</a>    <ol>\n      <li><a href=\"#extraction-of-the-arg-and-plasmid-genes-location\" id=\"markdown-toc-extraction-of-the-arg-and-plasmid-genes-location\">Extraction of the ARG and plasmid genes location</a></li>\n      <li><a href=\"#annotation-of-the-contigs\" id=\"markdown-toc-annotation-of-the-contigs\">Annotation of the contigs</a></li>\n      <li><a href=\"#mapping-the-raw-reads-on-the-contigs\" id=\"markdown-toc-mapping-the-raw-reads-on-the-contigs\">Mapping the raw reads on the contigs</a></li>\n      <li><a href=\"#visualisation-of-the-args\" id=\"markdown-toc-visualisation-of-the-args\">Visualisation of the ARGs</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#conclusion\" id=\"markdown-toc-conclusion\">Conclusion</a></li>\n</ol>\n\n</blockquote>\n\n<h1 id=\"galaxy-and-data-preparation\">Galaxy and data preparation</h1>\n\n<p>Any analysis should get its own Galaxy history. So let’s start by creating a new one and get the data (contig file from the assembly) into it.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Prepare Galaxy and data</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Create a new history for this analysis</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-new-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-new-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a new history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>Click the <i class=\"fas fa-plus\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">new-history</span> icon at the top of the history panel:</p>   <p><img src=\"/training-material/shared/images/history_create_new.svg\" alt=\"UI for creating new history\" /></p>   <!-- the original drawing can be found here https://docs.google.com/drawings/d/1cCBrLAo4kDGic5QyB70rRiWJAKTenTU8STsKDaLcVU8/edit?usp=sharing --> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Rename the history</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-renaming-a-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-renaming-a-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Renaming a history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ol>   <li>Click on <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> (<strong>Edit</strong>) next to the history name (which by default is “Unnamed history”)</li>   <li>Type the new name</li>   <li>Click on <strong>Save</strong></li> </ol>   <p>If you do not have the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> (<strong>Edit</strong>) next to the history name:</p>   <ol>   <li>Click on <strong>Unnamed history</strong> (or the current name of the history) (<strong>Click to rename history</strong>) at the top of your history panel</li>   <li>Type the new name</li>   <li>Press <kbd>Enter</kbd></li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p><span class=\"tool\" data-tool=\"upload1\" title=\"Import tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Import</strong></span> the contig file from <a href=\"https://zenodo.org/record/10572227\">Zenodo</a> or from Galaxy shared data libraries:</p>\n\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/10572227/files/DRR187559_contigs.fasta\n</code></pre></div>      </div>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-via-links\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-via-links\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing via links</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-data-from-a-data-library\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-data-from-a-data-library\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing data from a data library</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>As an alternative to uploading the data from a URL or your computer, the files may also have been made available from a <em>shared data library</em>:</p>   <ol>   <li>Go into <strong>Shared data</strong> (top panel) then <strong>Data libraries</strong></li>   <li>Navigate to  the correct folder as indicated by your instructor.     <ul>       <li>On most Galaxies tutorial data will be provided in a folder named <strong>GTN - Material –&gt; Topic Name -&gt; Tutorial Name</strong>.</li>     </ul>   </li>   <li>Select the desired files</li>   <li>Click on <strong>Add to History</strong> <i class=\"fas fa-caret-down\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-dropdown</span> near the top and select <strong>as Datasets</strong> from the dropdown menu</li>   <li>     <p>In the pop-up window, choose</p>     <ul>       <li><em>“Select history”</em>: the history you want to import the data to (or create a new one)</li>     </ul>   </li>   <li>Click on <strong>Import</strong></li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h1 id=\"identification-of-amr-genes\">Identification of AMR genes</h1>\n\n<p>To identify AMR genes in contigs, tools like ABRicate or staramr (<span class=\"citation\"><a href=\"#bharat2022correlation\">Bharat <i>et al.</i> 2022</a></span>) can be used. In this tutorial, we use <a href=\"https://github.com/phac-nml/staramr\"><strong>staramr</strong></a>. <strong>Staramr</strong> scans bacterial genome contigs against the <strong>ResFinder</strong> (<span class=\"citation\"><a href=\"#zankari2012identification\">Zankari <i>et al.</i> 2012</a></span>), <strong>PointFinder</strong> (<span class=\"citation\"><a href=\"#zankari2017pointfinder\">Zankari <i>et al.</i> 2017</a></span>), and <strong>PlasmidFinder</strong> (<span class=\"citation\"><a href=\"#carattoli2014plasmidfinder\">Carattoli <i>et al.</i> 2014</a></span>) databases (used by the ResFinder webservice) and compiles a summary report of detected antimicrobial resistance genes.</p>\n\n<blockquote class=\"comment\">\n  <comment-title></comment-title>\n\n  <p>If you are interested in learning more about using ABRicate for AMR gene detection, you can check the sub-section on AMR in “Gene based pathogenic identification” of <a href=\"/training-material/topics/microbiome/tutorials/pathogen-detection-from-nanopore-foodborne-data/tutorial.html\">“Pathogen detection from (direct Nanopore) sequencing data using Galaxy - Foodborne Edition” tutorial</a></p>\n\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Run staramr</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/nml/staramr/staramr_search/0.10.0+galaxy1\" title=\"staramr tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>staramr</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.10.0+galaxy1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“genomes”</em>: Contig file</li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p><strong>staramr</strong> generates 8 outputs:</p>\n\n<ol>\n  <li>\n    <p><code class=\"language-plaintext highlighter-rouge\">summary.tsv</code>:  A summary of all detected AMR genes/mutations/plasmids/sequence type in each genome, one genome per line and the following columns:</p>\n\n    <ul>\n      <li><strong>Isolate ID</strong>: The id of the isolate/genome file(s) passed to <code class=\"language-plaintext highlighter-rouge\">staramr</code>.</li>\n      <li><strong>Quality Module</strong>: The isolate/genome file(s) pass/fail result(s) for the quality metrics</li>\n      <li><strong>Genotype</strong>: The AMR genotype of the isolate.</li>\n      <li><strong>Predicted Phenotype</strong>: The predicted AMR phenotype (drug resistances) for the isolate.</li>\n      <li>\n        <p><strong>CGE Predicted Phenotype</strong>: The CGE-predicted AMR phenotype (drug resistances) for the isolate (CGE = <a href=\"http://www.genomicepidemiology.org/\">Center for Genomic Epidemiology</a>)</p>\n      </li>\n      <li><strong>Plasmid</strong>: Plasmid types that were found for the isolate.</li>\n      <li>\n        <p><strong>Scheme</strong>: The MLST scheme used</p>\n\n        <p>MLST stands for MultiLocus Sequence Typing. It is a technique for the typing of multiple loci, using DNA sequences of internal fragments of multiple housekeeping genes to characterize isolates of microbial species.</p>\n\n        <p>Here, <strong>starmr</strong> uses <a href=\"https://github.com/tseemann/mlst\">mlst</a> to scan the contig files against traditional <a href=\"https://pubmlst.org/\">PubMLST</a> typing schemes. The correspondance between the scheme and the bacteria genus and species is accessible in the <a href=\"https://github.com/tseemann/mlst/blob/master/db/scheme_species_map.tab\">map</a></p>\n      </li>\n      <li><strong>Sequence Type</strong>: The sequence type that’s assigned when combining all allele types</li>\n      <li><strong>Genome Length</strong>: The isolate/genome file(s) genome length(s)</li>\n      <li><strong>N50 value</strong>: The isolate/genome file(s) N50 value(s)</li>\n      <li><strong>Number of Contigs Greater Than Or Equal To 300 bp</strong>: The number of contigs greater or equal to 300 base pair in the isolate/genome file(s)</li>\n      <li><strong>Quality Module Feedback</strong>: The isolate/genome file(s) detailed feedback for the quality metrics</li>\n    </ul>\n\n    <blockquote class=\"hands_on\">\n      <hands-on-title>Inspect the staramr output</hands-on-title>\n\n      <ol>\n        <li>View <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> the <code class=\"language-plaintext highlighter-rouge\">summary.tsv</code> file</li>\n      </ol>\n\n    </blockquote>\n\n    <blockquote class=\"question\">\n      <question-title>Inspect the staramr output</question-title>\n\n      <ol>\n        <li>How many genomes are there?</li>\n        <li>Has the genome failed or passed the quality? Why?</li>\n        <li>What are the predicted AMR drug resistances? Are they similar to the one found for KUN1163 in <a href=\"https://journals.asm.org/doi/10.1128/mra.01212-19#tab1\">Table 1</a> in <span class=\"citation\"><a href=\"#Hikichi_2019\">Hikichi <i>et al.</i> 2019</a></span>?</li>\n        <li>What is the MLST scheme? Does that correspond to the expected species and genus?</li>\n      </ol>\n\n      <blockquote class=\"solution\">\n        <solution-title>Inspect the staramr output</solution-title>\n\n        <ol>\n          <li>There is one genome (1 line)</li>\n          <li>The genome has failed the quality (column 2), because the genome length is not within the acceptable length range (last column).</li>\n          <li>\n            <p>We can summarize starmr output and Table 1 in <span class=\"citation\"><a href=\"#Hikichi_2019\">Hikichi <i>et al.</i> 2019</a></span>:</p>\n\n            <table>\n              <thead>\n                <tr>\n                  <th>Antibiotic name</th>\n                  <th>Abbreviation</th>\n                  <th>staramr</th>\n                  <th><span class=\"citation\"><a href=\"#Hikichi_2019\">Hikichi <i>et al.</i> 2019</a></span></th>\n                </tr>\n              </thead>\n              <tbody>\n                <tr>\n                  <td>Amikacin</td>\n                  <td> </td>\n                  <td>Yes</td>\n                  <td> </td>\n                </tr>\n                <tr>\n                  <td>Azithromycin</td>\n                  <td> </td>\n                  <td>Yes</td>\n                  <td> </td>\n                </tr>\n                <tr>\n                  <td>Cefazolin</td>\n                  <td>CEZ</td>\n                  <td> </td>\n                  <td>Yes</td>\n                </tr>\n                <tr>\n                  <td>clindamycin</td>\n                  <td>CLDM</td>\n                  <td> </td>\n                  <td>Yes</td>\n                </tr>\n                <tr>\n                  <td>Erythromycin</td>\n                  <td>EM</td>\n                  <td>Yes</td>\n                  <td>Yes</td>\n                </tr>\n                <tr>\n                  <td>Gentamicin</td>\n                  <td>GM</td>\n                  <td>Yes</td>\n                  <td>Yes</td>\n                </tr>\n                <tr>\n                  <td>Imipenem</td>\n                  <td>IPM</td>\n                  <td> </td>\n                  <td>Yes</td>\n                </tr>\n                <tr>\n                  <td>Levofloxacin</td>\n                  <td>LVFX</td>\n                  <td> </td>\n                  <td>Yes</td>\n                </tr>\n                <tr>\n                  <td>Oxacillin</td>\n                  <td>MPIPC</td>\n                  <td> </td>\n                  <td>Yes</td>\n                </tr>\n                <tr>\n                  <td>Penicillin</td>\n                  <td> </td>\n                  <td>Yes</td>\n                  <td> </td>\n                </tr>\n                <tr>\n                  <td>Spectinomycin</td>\n                  <td> </td>\n                  <td>Yes</td>\n                  <td> </td>\n                </tr>\n                <tr>\n                  <td>Tetracycline</td>\n                  <td> </td>\n                  <td>Yes</td>\n                  <td> </td>\n                </tr>\n                <tr>\n                  <td>Tobramycin</td>\n                  <td> </td>\n                  <td>Yes</td>\n                  <td> </td>\n                </tr>\n              </tbody>\n            </table>\n          </li>\n          <li>The scheme is saureus, so <em>Staphylococcus aureus</em> (given the <a href=\"https://github.com/tseemann/mlst/blob/master/db/scheme_species_map.tab\">scheme genus map</a>), which is coherent with MRSA</li>\n        </ol>\n      </blockquote>\n\n    </blockquote>\n  </li>\n  <li>\n    <p><code class=\"language-plaintext highlighter-rouge\">detailed_summary.tsv</code>: A detailed summary of all detected AMR genes/mutations/plasmids/sequence type in each genome, one gene per line and the following columns:</p>\n\n    <ul>\n      <li><strong>Isolate ID</strong>: The id of the isolate/genome file(s) passed to <code class=\"language-plaintext highlighter-rouge\">staramr</code>.</li>\n      <li><strong>Data</strong>: The particular gene detected from ResFinder, PlasmidFinder, PointFinder, or the sequence type.</li>\n      <li><strong>Data Type</strong>: The type of gene (Resistance or Plasmid), or MLST.</li>\n      <li><strong>Predicted Phenotype</strong>: The predicted AMR phenotype (drug resistances) found in ResFinder/PointFinder. Plasmids will be left blank by default.</li>\n      <li><strong>CGE Predicted Phenotype</strong>: The CGE-predicted AMR phenotype (drug resistances) found in ResFinder/PointFinder. Plasmids will be left blank by default.</li>\n      <li><strong>%Identity</strong>: The % identity of the top BLAST HSP to the gene.</li>\n      <li><strong>%Overlap</strong>: THe % overlap of the top BLAST HSP to the gene (calculated as <strong>hsp length/total length * 100</strong>).</li>\n      <li><strong>HSP Length/Total Length</strong> The top BLAST HSP length over the gene total length (nucleotides).</li>\n      <li><strong>Contig</strong>: The contig id containing this gene.</li>\n      <li><strong>Start</strong>: The start of the gene (will be greater than <strong>End</strong> if on minus strand).</li>\n      <li><strong>End</strong>: The end of the gene.</li>\n      <li><strong>Accession</strong>: The accession of the gene from either ResFinder or PlasmidFinder  database.</li>\n    </ul>\n\n    <blockquote class=\"hands_on\">\n      <hands-on-title>Inspect the staramr output</hands-on-title>\n\n      <ol>\n        <li>View <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> the <code class=\"language-plaintext highlighter-rouge\">detailed_summary.tsv</code> file</li>\n      </ol>\n\n    </blockquote>\n\n    <blockquote class=\"question\">\n      <question-title>Inspect the staramr output</question-title>\n\n      <ol>\n        <li>What are the different sequence types that have been identified?</li>\n        <li>Where are located the plasmid genes?</li>\n        <li>Where are located the resistances genes?</li>\n        <li>By looking for the accession number (M13771) on NCBI (<a href=\"https://www.ncbi.nlm.nih.gov/nuccore/\">https://www.ncbi.nlm.nih.gov/nuccore/</a>), where does the first resistance come from?</li>\n      </ol>\n\n      <blockquote class=\"solution\">\n        <solution-title>Inspect the staramr output</solution-title>\n\n        <ol>\n          <li>There are:\n            <ul>\n              <li>1 MSLT</li>\n              <li>5 plasmid <em>rep</em> genes</li>\n              <li>7 resistance genes</li>\n            </ul>\n          </li>\n          <li>The plasmid genes are on contig00019 (3 genes - coherent with <span class=\"citation\"><a href=\"#Lozano_2012\">Lozano <i>et al.</i> 2012</a></span>), contig00024, and contig00002.</li>\n          <li>The resistance genes are:\n            <ul>\n              <li>4/7 on contigs with plasmid genes (contig00002, contig00019, contig00024)</li>\n              <li>3/7 on contigs without plasmid genes (contig00022, contig00021)</li>\n            </ul>\n          </li>\n          <li>M13771 is a 6’-aminoglycoside acetyltransferase phosphotransferase (AAC(6’)-APH(2’)) bifunctional resistance protein from <em>Streptococcus faecalis</em>. It might come from horizontal transfer from <em>Streptococcus faecalis</em> on a plasmid of <em>Staphylococcus aureus</em>.</li>\n        </ol>\n      </blockquote>\n\n    </blockquote>\n  </li>\n  <li>\n    <p><code class=\"language-plaintext highlighter-rouge\">resfinder.tsv</code>: A tabular file of each AMR gene and additional BLAST information from the <strong>ResFinder</strong> database, one gene per line and the following columns:</p>\n\n    <ul>\n      <li><strong>Isolate ID</strong>: The id of the isolate/genome file(s) passed to <code class=\"language-plaintext highlighter-rouge\">staramr</code>.</li>\n      <li><strong>Gene</strong>: The particular AMR gene detected.</li>\n      <li><strong>Predicted Phenotype</strong>: The predicted AMR phenotype (drug resistances) for this gene.</li>\n      <li><strong>CGE Predicted Phenotype</strong>: The CGE-predicted AMR phenotype (drug resistances) for this gene.</li>\n      <li><strong>%Identity</strong>: The % identity of the top BLAST HSP to the AMR gene.</li>\n      <li><strong>%Overlap</strong>: THe % overlap of the top BLAST HSP to the AMR gene (calculated as <strong>hsp length/total length * 100</strong>).</li>\n      <li><strong>HSP Length/Total Length</strong> The top BLAST HSP length over the AMR gene total length (nucleotides).</li>\n      <li><strong>Contig</strong>: The contig id containing this AMR gene.</li>\n      <li><strong>Start</strong>: The start of the AMR gene (will be greater than <strong>End</strong> if on minus strand).</li>\n      <li><strong>End</strong>: The end of the AMR gene.</li>\n      <li><strong>Accession</strong>: The accession of the AMR gene in the ResFinder database.</li>\n      <li><strong>Sequence</strong>: The AMR Gene sequence</li>\n      <li><strong>CGE Notes</strong>: Any CGE notes associated with the prediction.</li>\n    </ul>\n  </li>\n  <li>\n    <p><code class=\"language-plaintext highlighter-rouge\">plasmidfinder.tsv</code>: A tabular file of each AMR plasmid type and additional BLAST information from the <strong>PlasmidFinder</strong> database, one plasmid type per line with the following columns:</p>\n\n    <ul>\n      <li><strong>Isolate ID</strong>: The id of the isolate/genome file(s) passed to <code class=\"language-plaintext highlighter-rouge\">staramr</code>.</li>\n      <li><strong>Plasmid</strong>: The particular plasmid type detected.</li>\n      <li><strong>%Identity</strong>: The % identity of the top BLAST HSP to the plasmid type.</li>\n      <li><strong>%Overlap</strong>: The % overlap of the top BLAST HSP to the plasmid type (calculated as    <strong>hsp length/total length * 100</strong>).</li>\n      <li><strong>HSP Length/Total Length</strong> The top BLAST HSP length over the plasmid type total length (nucleotides).</li>\n      <li><strong>Contig</strong>: The contig id containing this plasmid type.</li>\n      <li><strong>Start</strong>: The start of the plasmid type (will be greater than <strong>End</strong> if on minus strand).</li>\n      <li><strong>End</strong>: The end of the plasmid type.</li>\n      <li><strong>Accession</strong>: The accession of the plasmid type in the PlasmidFinder database.</li>\n    </ul>\n  </li>\n  <li>\n    <p><code class=\"language-plaintext highlighter-rouge\">mlst.tsv</code>: A tabular file of each multi-locus sequence type (MLST) and it’s corresponding locus/alleles, one genome per line with the following columns:</p>\n\n    <ul>\n      <li><strong>Isolate ID</strong>: The id of the isolate/genome file(s) passed to <code class=\"language-plaintext highlighter-rouge\">staramr</code>.</li>\n      <li><strong>Scheme</strong>: The scheme that <code class=\"language-plaintext highlighter-rouge\">MLST</code> has identified.</li>\n      <li><strong>Sequence Type</strong>: The sequence type that’s assigned when combining all allele types</li>\n      <li><strong>Locus #</strong>: A particular locus in the specified MLST scheme.</li>\n    </ul>\n  </li>\n  <li><code class=\"language-plaintext highlighter-rouge\">settings.txt</code>: The command-line, database versions, and other settings used to run <code class=\"language-plaintext highlighter-rouge\">staramr</code>.</li>\n  <li><code class=\"language-plaintext highlighter-rouge\">results.xlsx</code>: An Excel spreadsheet containing the previous files as separate worksheets.</li>\n  <li><code class=\"language-plaintext highlighter-rouge\">hits</code>: A collection with fasta files of the BLAST HSP nucleotides for the entries listed in the <strong>resfinder.tsv</strong> and <strong>pointfinder.tsv</strong> files. There are up to two files per input genome, one for ResFinder and one for PointFinder.</li>\n</ol>\n\n<h1 id=\"getting-more-information-about-arg-via-the-card-database\">Getting more information about ARG via the CARD database</h1>\n\n<p>To get more information about the antibiotic resistant genes (ARG), we can check the <a href=\"https://card.mcmaster.ca\">CARD database</a> (<strong>C</strong>omprehensive <strong>A</strong>ntibiotic <strong>R</strong>esistance <strong>D</strong>atabase) (<span class=\"citation\"><a href=\"#Jia2016\">Jia <i>et al.</i> 2016</a></span>)</p>\n\n<p>CARD can be very helpful to check all the resistance genes and check if it is logical to find the resistance gene in a specific bacteria.</p>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>To what family does <a href=\"https://card.mcmaster.ca/ontology/36911\">mecA</a> belong?</li>\n    <li>Do you expect to find this gene in this MRSA strain and why?</li>\n    <li>Is the accession number of the entry related to the accession reported by staramr?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li><a href=\"https://card.mcmaster.ca/ontology/37589\">Methicillin resistant PBP2</a></li>\n      <li>The strain we use is a Methicillin(multi) resistant Staphylococcus aureus. As <code class=\"language-plaintext highlighter-rouge\">mecA</code> has a perfect resistome mach with <em>S. aureus</em>, and the AMR Gene Family is methicillin resistant PBP2, we expect to see mecA in MRSA.</li>\n      <li>No, these are completely unrelated. Unfortunately this is a <strong>very</strong> common issue in bioinformatics. Everyone builds their own numbering system for entries in their database (usually calling them ‘accessions’), and then someone else needs to build a service to link these databases.</li>\n    </ol>\n\n  </blockquote>\n</blockquote>\n\n<h1 id=\"visualization-of-the-args-and-plasmid-genes-in-their-genomic-context\">Visualization of the ARGs and plasmid genes in their genomic context</h1>\n\n<p>We would like to look at the ARGs and plasmid genes in their genomic context. To do that, we will usie <a href=\"https://jbrowse.org/jb2/\">JBrowse</a> (<span class=\"citation\"><a href=\"#diesh2023jbrowse\">Diesh <i>et al.</i> 2023</a></span>) with several information:</p>\n\n<ol>\n  <li>Assembly as the reference</li>\n  <li>ARGs location</li>\n  <li>Contigs annotation (genes, etc)</li>\n  <li>Coverage of the contigs from the raw reads</li>\n</ol>\n\n<h2 id=\"extraction-of-the-arg-and-plasmid-genes-location\">Extraction of the ARG and plasmid genes location</h2>\n\n<p>The first step is to extract the location of the ARGs and plasmid genes on the contigs. This information is available on the <code class=\"language-plaintext highlighter-rouge\">detailed_summary.tsv</code> output of <strong>starmar</strong>. The genes and their location are on the lines with a decimal value on column 6 or 7. So to only get this information, we need to select lines with a decimal value (<code class=\"language-plaintext highlighter-rouge\">###.##</code>) followed by a tab character, the column separator in Galaxy. As a result, any lines without an identity or overlap value will be filtered out.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Extract ARGs and plasmid genes</hands-on-title>\n  <ol>\n    <li><span class=\"tool\" data-tool=\"Grep1\" title=\"Select lines that match an expression tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Select lines that match an expression</strong></span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Select lines from”</em>: <code class=\"language-plaintext highlighter-rouge\">detailed_summary.tsv</code> <strong>staramr</strong> output</li>\n        <li><em>“that”</em>: Matching</li>\n        <li><em>“the pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">[0-9]+\\.[0-9]+\\t</code></li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>How many genes have been kept?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <p>12</p>\n\n  </blockquote>\n</blockquote>\n\n<p>This table can not be used directly in JBrowse. It first needs to be transformed in a standard format: GFF3, a file format used for describing genes and other features of DNA, RNA and protein sequences.</p>\n\n<blockquote class=\"comment\">\n  <comment-title>GFF3 file format</comment-title>\n\n  <p>A GFF is a tab delimited file with 9 fields per line:</p>\n  <ol>\n    <li><strong>seqid</strong>: The name of the sequence where the feature is located.</li>\n    <li><strong>source</strong>: The algorithm or procedure that generated the feature. This is typically the name of a software or database.</li>\n    <li><strong>type</strong>: The feature type name, like “gene” or “exon”. In a well structured GFF file, all the children features always follow their parents in a single block (so all exons of a transcript are put after their parent “transcript” feature line and before any other parent transcript line). In GFF3, all features and their relationships should be compatible with the standards released by the Sequence Ontology Project.</li>\n    <li><strong>start</strong>: Genomic start of the feature, with a 1-base offset. This is in contrast with other 0-offset half-open sequence formats, like BED.</li>\n    <li><strong>end</strong>: Genomic end of the feature, with a 1-base offset. This is the same end coordinate as it is in 0-offset half-open sequence formats, like BED.</li>\n    <li><strong>score</strong>: Numeric value that generally indicates the confidence of the source in the annotated feature. A value of “.” (a dot) is used to define a null value.</li>\n    <li><strong>strand</strong>: Single character that indicates the strand of the feature. This can be “+” (positive, or 5’-&gt;3’), “-“, (negative, or 3’-&gt;5’), “.” (undetermined), or “?” for features with relevant but unknown strands.</li>\n    <li><strong>phase</strong>: phase of CDS features; it can be either one of 0, 1, 2 (for CDS features) or “.” (for everything else). See the section below for a detailed explanation.</li>\n    <li><strong>attributes</strong>: A list of tag-value pairs separated by a semicolon with additional information about the feature.</li>\n  </ol>\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Create a GFF file</hands-on-title>\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/tbl2gff3/tbl2gff3/1.2\" title=\"Table to GFF3 tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Table to GFF3</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.2)</span>\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Table”</em>: output of the above <strong>Select lines</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> step</li>\n        <li><em>“Record ID column or value”</em>: <code class=\"language-plaintext highlighter-rouge\">9</code></li>\n        <li><em>“Start column or value”</em>: <code class=\"language-plaintext highlighter-rouge\">10</code></li>\n        <li><em>“End column or value”</em>: <code class=\"language-plaintext highlighter-rouge\">11</code></li>\n        <li><em>“Type column or value”</em>: <code class=\"language-plaintext highlighter-rouge\">3</code></li>\n        <li><em>“Score column or value”</em>: <code class=\"language-plaintext highlighter-rouge\">6</code></li>\n        <li><em>“Source column or value”</em>: <code class=\"language-plaintext highlighter-rouge\">3</code></li>\n        <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Qualifiers”</em>\n          <ul>\n            <li><em>“Name”</em>: <code class=\"language-plaintext highlighter-rouge\">name</code></li>\n            <li><em>“Qualifier value column or raw text”</em>: <code class=\"language-plaintext highlighter-rouge\">2</code></li>\n          </ul>\n        </li>\n        <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Qualifiers”</em>\n          <ul>\n            <li><em>“Name”</em>: <code class=\"language-plaintext highlighter-rouge\">phenotype</code></li>\n            <li><em>“Qualifier value column or raw text”</em>: <code class=\"language-plaintext highlighter-rouge\">4</code></li>\n          </ul>\n        </li>\n        <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Qualifiers”</em>\n          <ul>\n            <li><em>“Name”</em>: <code class=\"language-plaintext highlighter-rouge\">accession</code></li>\n            <li><em>“Qualifier value column or raw text”</em>: <code class=\"language-plaintext highlighter-rouge\">12</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>How many genes have been found per contigs?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ul>\n      <li>Contig 19: 3 plasmid genes, 1 ARG</li>\n      <li>Contig 24: 1 plasmid gene, 2 ARGs</li>\n      <li>Contig 2: 1 plasmid gene, 1 ARG</li>\n      <li>Contig 22: 2 ARGs</li>\n      <li>Contig 21: 1 ARG</li>\n    </ul>\n\n  </blockquote>\n</blockquote>\n\n<h2 id=\"annotation-of-the-contigs\">Annotation of the contigs</h2>\n\n<p>In addition to the ARGs and plasmid genes, it would be good to have extra information about other genes on the contigs. Several tools exists to do that: Prokka (<span class=\"citation\"><a href=\"#seemann2014prokka\">Seemann 2014</a></span>), Bakta (<span class=\"citation\"><a href=\"#schwengers2021bakta\">Schwengers <i>et al.</i> 2021</a></span>), etc. Here, we use <strong>Bakta</strong> as recommended by Torsten Seeman as the successor of Prokka.</p>\n\n<blockquote class=\"notranslate hands_on gtn-cyoa\" id=\"gtn-cyoa\">\n\t<div class=\"box-title\" aria-label=\"hands-on box: choose your own tutorial\"><i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\"></span> Hands-on: Choose Your Own Tutorial</div>\n\t<p>This is a \"Choose Your Own Tutorial\" section, where you can select between multiple paths. Click one of the buttons below to select how you want to follow the tutorial</p>\n\t\n\t<p>\n\t\tHave you already run Bakta on this dataset before?\n\t</p>\n\t\n\t\n\t\t<input id=\"cyoa-opt1\" type=\"radio\" name=\"cyoa\" value=\"No\" onclick=\"cyoaChoice('No', 'gtn-cyoa')\" />\n\t\t<label for=\"cyoa-opt1\" class=\"select btn btn-secondary\">No</label>\n\t\n\t\n\t\t<input id=\"cyoa-opt2\" type=\"radio\" name=\"cyoa\" value=\"Yes\" onclick=\"cyoaChoice('Yes', 'gtn-cyoa')\" />\n\t\t<label for=\"cyoa-opt2\" class=\"select btn btn-secondary\">Yes</label>\n\t\n\t\n\t\n\n\t\n\t<script>\n\t\tfunction ready(fn) {\n\t\t\tif (document.readyState != 'loading'){\n\t\t\t\tfn();\n\t\t\t} else {\n\t\t\t\tdocument.addEventListener('DOMContentLoaded', fn);\n\t\t\t}\n\t\t}\n\t\tready(function() {\n\t\t\tcyoaDefault(\"No\", \"gtn-cyoa\");\n\t\t})\n\t</script>\n\t\n</blockquote>\n\n<div class=\"No\">\n\n  <p><strong>Bakta</strong>  is a tool for the rapid &amp; standardized annotation of bacterial genomes and plasmids from both isolates and MAGs.</p>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title>Annotate the contigs</hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/bakta/bakta/1.8.2+galaxy0\" title=\"Bakta tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Bakta</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.8.2+galaxy0)</span> with the following parameters:\n        <ul>\n          <li>In <em>“Input/Output options”</em>:\n            <ul>\n              <li><em>“The bakta database”</em>: latest one</li>\n              <li><em>“The amrfinderplus database”</em>: latest one</li>\n              <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Select genome in fasta format”</em>: Contig file</li>\n            </ul>\n          </li>\n          <li>In <em>“Optional annotation”</em>:\n            <ul>\n              <li><em>“Keep original contig header (–keep-contig-headers)”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n            </ul>\n          </li>\n        </ul>\n      </li>\n    </ol>\n  </blockquote>\n\n  <blockquote class=\"question\">\n    <question-title></question-title>\n\n    <p>How many features have been identified?</p>\n\n    <blockquote class=\"solution\">\n      <solution-title></solution-title>\n\n      <p>51k+ (number of lines in the GFF)</p>\n\n    </blockquote>\n  </blockquote>\n\n</div>\n\n<div class=\"Yes\">\n\n  <p>If you already ran <strong>Bakta</strong> on your contigs, you can just upload here the GFF generated by <strong>Bakta</strong>.</p>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title>Import annotation GFF</hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"upload1\" title=\"Import tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Import</strong></span> the GFF file generated by <strong>Bakta</strong></li>\n    </ol>\n\n  </blockquote>\n\n  <p><a href=\"./images/bakta.svg\" rel=\"noopener noreferrer\"><img src=\"./images/bakta.svg\" alt=\"Bakta - circular plot of the annotation, with the contigs on the outside ordered clockwise by length size.\" width=\"3000\" height=\"3000\" loading=\"lazy\" /></a></p>\n\n</div>\n\n<h2 id=\"mapping-the-raw-reads-on-the-contigs\">Mapping the raw reads on the contigs</h2>\n\n<p>To get information about the coverage of the contigs and genes, we map the reads used to build the contigs to the contigs using <strong>Bowtie2</strong> (<span class=\"citation\"><a href=\"#langmead2009ultrafast\">Langmead <i>et al.</i> 2009</a></span>).</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Annotating the Genome</hands-on-title>\n  <ol>\n    <li>\n      <p><span class=\"tool\" data-tool=\"upload1\" title=\"Import tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Import</strong></span> the reads (after quality control) from another history, from <a href=\"https://zenodo.org/record/10572227\">Zenodo</a> or from Galaxy shared data libraries:</p>\n\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/10572227/files/DRR187559_after_fastp_1.fastq.gz\nhttps://zenodo.org/record/10572227/files/DRR187559_after_fastp_2.fastq.gz\n</code></pre></div>      </div>\n    </li>\n    <li>\n      <p><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/devteam/bowtie2/bowtie2/2.5.0+galaxy0\" title=\"Bowtie2 tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Bowtie2</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.5.0+galaxy0)</span> with the following parameters:</p>\n      <ul>\n        <li><em>“Is this single or paired library”</em>: <code class=\"language-plaintext highlighter-rouge\">Paired-end</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“FASTA/Q file #1”</em>: <code class=\"language-plaintext highlighter-rouge\">DRR187559_after_fastp_1.fastq.gz</code></li>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“FASTA/Q file #2”</em>: <code class=\"language-plaintext highlighter-rouge\">DRR187559_after_fastp_2.fastq.gz</code></li>\n          </ul>\n        </li>\n        <li><em>“Will you select a reference genome from your history or use a built-in index?”</em>: <code class=\"language-plaintext highlighter-rouge\">Use a genome from the history and build index</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Select reference genome”</em>: Contig file</li>\n          </ul>\n        </li>\n        <li><em>“Save the bowtie2 mapping statistics to the history”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>What is the alignment rate? What does that mean for the assembly?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <p>The alignment rate is 99.77%. Most of the reads have been mapped on the contigs. They have been then used to build the contigs.</p>\n\n  </blockquote>\n</blockquote>\n\n<h2 id=\"visualisation-of-the-args\">Visualisation of the ARGs</h2>\n\n<p>We can now visualize the contigs, the mapping coverage, and the genes, using JBrowse and different information track.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Visualize the Genome</hands-on-title>\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/jbrowse/jbrowse/1.16.11+galaxy1\" title=\"JBrowse tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>JBrowse</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.16.11+galaxy1)</span> with the following parameters:\n      <ul>\n        <li><em>“Reference genome to display”</em>: <code class=\"language-plaintext highlighter-rouge\">Use a genome from history</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Select the reference genome”</em>: Contig file</li>\n          </ul>\n        </li>\n        <li><em>“Genetic Code”</em>: <code class=\"language-plaintext highlighter-rouge\">11. The Bacterial, Archaeal and Plant Plastid Code</code></li>\n        <li>In <em>“Track Group”</em>:\n          <ul>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Track Group”</em>\n              <ul>\n                <li><em>“Track Category”</em>: <code class=\"language-plaintext highlighter-rouge\">Bakta</code></li>\n                <li>In <em>“Annotation Track”</em>:\n                  <ul>\n                    <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Annotation Track”</em>\n                      <ul>\n                        <li><em>“Track Type”</em>: <code class=\"language-plaintext highlighter-rouge\">GFF/GFF3/BED Features</code>\n                          <ul>\n                            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“GFF/GFF3/BED Track Data”</em>: <code class=\"language-plaintext highlighter-rouge\">Annotation_and_sequences</code> (output of <strong>Bakta</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n                            <li><em>“JBrowse Track Type [Advanced]”</em>: <code class=\"language-plaintext highlighter-rouge\">Neat Canvas Features</code></li>\n                            <li><em>“Track Visibility”</em>: <code class=\"language-plaintext highlighter-rouge\">On for new users</code></li>\n                          </ul>\n                        </li>\n                      </ul>\n                    </li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Track Group”</em>\n              <ul>\n                <li><em>“Track Category”</em>: <code class=\"language-plaintext highlighter-rouge\">ARGs and plasmid genes</code></li>\n                <li>In <em>“Annotation Track”</em>:\n                  <ul>\n                    <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Annotation Track”</em>\n                      <ul>\n                        <li><em>“Track Type”</em>: <code class=\"language-plaintext highlighter-rouge\">GFF/GFF3/BED Features</code>\n                          <ul>\n                            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“GFF/GFF3/BED Track Data”</em>: Output of <strong>Table to GFF3</strong></li>\n                            <li><em>“JBrowse Track Type [Advanced]”</em>: <code class=\"language-plaintext highlighter-rouge\">Neat Canvas Features</code></li>\n                            <li><em>“Track Visibility”</em>: <code class=\"language-plaintext highlighter-rouge\">On for new users</code></li>\n                          </ul>\n                        </li>\n                      </ul>\n                    </li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Track Group”</em>\n              <ul>\n                <li><em>“Track Category”</em>: <code class=\"language-plaintext highlighter-rouge\">Coverage</code></li>\n                <li>In <em>“Annotation Track”</em>:\n                  <ul>\n                    <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Annotation Track”</em>\n                      <ul>\n                        <li><em>“Track Type”</em>: <code class=\"language-plaintext highlighter-rouge\">BAM Pileups</code>\n                          <ul>\n                            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“BAM Track Data”</em>: Bowtie2’s output</li>\n                            <li><em>“Autogenerate SNP Track”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n                          </ul>\n                        </li>\n                      </ul>\n                    </li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>View the output of JBrowse</li>\n  </ol>\n\n</blockquote>\n\n<p>In the output of the JBrowse you can view the mapped reads and the found genes against the reference genome. With the search tools you can easily find genes of interest. JBrowse can handle many inputs and can be very useful. Using the Bowtie2 mapping output, low coverage regions can be detected. This SNP detection can also give a clear view of where the data was less reliable or where variations were located.</p>\n\n<p>If it takes too long to build the JBrowse instance, you can view an embedded one here. (<strong>Warning</strong>: feature name search will not work.)</p>\n\n<!--SNIPPET-->\n<iframe id=\"embedded_jbrowse\" src=\"/training-material/assets/jbrowse/index.html?loc=contig00019:81..23760&amp;data=/training-material/topics/genome-annotation/tutorials/amr-gene-detection/data&amp;trackList=0\" border=\"0\" width=\"100%\" height=\"500px\"></iframe>\n<p><a href=\"/training-material/assets/jbrowse/index.html?loc=contig00019:81..23760&amp;data=/training-material/topics/genome-annotation/tutorials/amr-gene-detection/data\" target=\"_blank\" style=\"padding: 0.5rem 1rem; background-color: #dfe5f9;border-bottom-left-radius: 8px; border-bottom-right-radius: 8px;\">Open JBrowse in a new tab</a></p>\n<p><!--END_SNIPPET--></p>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>What is the name for the gene found by Bakta corresponding to the rep16 gene found by staramr?</li>\n    <li>What are the NCBI Protein id and UniRef id for aac(6’)-aph(2’’)?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>By zooming at the beginning of the contig, the name for rep16 is DUF536 domain-containing protein</li>\n      <li>aac(6’)-aph(2’’) is on contig00019:20311..21749. The corresponding gene found by Bakta is bifunctional aminoglycoside N-acetyltransferase AAC(6’)-Ie/aminoglycoside O-phosphotransferase APH(2’’)-Ia. When clicking on it, we can find the dbxref attributes:\n        <ul>\n          <li>NCBI Protein: WP_001028144.1</li>\n          <li>UniRef: UniRef50_P0A0C2</li>\n        </ul>\n      </li>\n    </ol>\n  </blockquote>\n</blockquote>\n\n<h1 id=\"conclusion\">Conclusion</h1>\n\n<p>In this tutorial, contigs were scaned for AMR and plasmid genes. The genes were then visualized in their genomic context after contig annotation.</p>\n"],"ref_slides":[],"hands_on":true,"slides":false,"mod_date":"2024-03-13 15:45:16 +0000","pub_date":"2024-01-23 16:20:06 +0000","version":9,"workflows":[{"workflow":"main-workflow.ga","tests":true,"url":"https://training.galaxyproject.org/training-material/topics/genome-annotation/tutorials/amr-gene-detection/workflows/main-workflow.ga","path":"topics/genome-annotation/tutorials/amr-gene-detection/workflows/main-workflow.ga","wfid":"genome-annotation-amr-gene-detection","wfname":"main-workflow","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/genome-annotation-amr-gene-detection/versions/main-workflow","license":"MIT","creators":[{"class":"Person","identifier":"https://orcid.org/0000-0003-2255-1631","name":"Bazante Sanders"},{"class":"Person","identifier":"https://orcid.org/0000-0001-9852-1987","name":"Bérénice Batut"}],"name":"mrsa AMR gene detection","title":"mrsa AMR gene detection","test_results":null,"modified":"2024-06-14 10:38:31 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\ncontigs\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"ℹ️ Input Dataset\\nforward_reads\"];\n  style 1 stroke:#2c3143,stroke-width:4px;\n  2[\"ℹ️ Input Dataset\\nreverse_reads\"];\n  style 2 stroke:#2c3143,stroke-width:4px;\n  3[\"staramr\"];\n  0 -->|output| 3;\n  8fd19964-6543-4b12-9f23-8f572dd6ff96[\"Output\\nstararm_detailed_summary\"];\n  3 --> 8fd19964-6543-4b12-9f23-8f572dd6ff96;\n  style 8fd19964-6543-4b12-9f23-8f572dd6ff96 stroke:#2c3143,stroke-width:4px;\n  4[\"Bakta\"];\n  0 -->|output| 4;\n  6bdbdd00-5e0c-4140-a65d-f560a3dee2c6[\"Output\\nbakta_annotation_summary\"];\n  4 --> 6bdbdd00-5e0c-4140-a65d-f560a3dee2c6;\n  style 6bdbdd00-5e0c-4140-a65d-f560a3dee2c6 stroke:#2c3143,stroke-width:4px;\n  5[\"Bowtie2\"];\n  1 -->|output| 5;\n  2 -->|output| 5;\n  0 -->|output| 5;\n  b30cf5b2-bdf2-493a-8e09-2fe02d0d1203[\"Output\\nbowtie_mapping_stats\"];\n  5 --> b30cf5b2-bdf2-493a-8e09-2fe02d0d1203;\n  style b30cf5b2-bdf2-493a-8e09-2fe02d0d1203 stroke:#2c3143,stroke-width:4px;\n  6[\"Select\"];\n  3 -->|detailed_summary| 6;\n  7[\"Table to GFF3\"];\n  6 -->|out_file1| 7;\n  8[\"JBrowse\"];\n  4 -->|annotation_gff3| 8;\n  7 -->|output| 8;\n  5 -->|output| 8;\n  7944d1a3-7fe5-46d9-a33d-1816bbb8e3dd[\"Output\\njbrowse_output\"];\n  8 --> 7944d1a3-7fe5-46d9-a33d-1816bbb8e3dd;\n  style 7944d1a3-7fe5-46d9-a33d-1816bbb8e3dd stroke:#2c3143,stroke-width:4px;"}],"api":"https://training.galaxyproject.org/training-material/api/topics/genome-annotation/tutorials/amr-gene-detection/tutorial.json","tools":["Grep1","toolshed.g2.bx.psu.edu/repos/devteam/bowtie2/bowtie2/2.5.0+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/bakta/bakta/1.8.2+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/jbrowse/jbrowse/1.16.11+galaxy1","toolshed.g2.bx.psu.edu/repos/iuc/tbl2gff3/tbl2gff3/1.2","toolshed.g2.bx.psu.edu/repos/nml/staramr/staramr_search/0.10.0+galaxy1","upload1"],"supported_servers":{"exact":[{"url":"https://usegalaxy.cz/","name":"UseGalaxy.cz","usegalaxy":false},{"url":"https://usegalaxy.eu","name":"UseGalaxy.eu","usegalaxy":true},{"url":"https://usegalaxy.fr/","name":"UseGalaxy.fr","usegalaxy":false}],"inexact":[{"url":"https://galaxy.mesocentre.uca.fr","name":"Galaxy@AuBi","usegalaxy":false}]},"topic_name_human":"Genome Annotation","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"bowtie2","owner":"devteam","revisions":"03e9b2fbc005","tool_panel_section_label":"Mapping","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"bakta","owner":"iuc","revisions":"728dacaf08a9","tool_panel_section_label":"Annotation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"jbrowse","owner":"iuc","revisions":"a6e57ff585c0","tool_panel_section_label":"Graph/Display Data","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"tbl2gff3","owner":"iuc","revisions":"4a7f4b0cc0a3","tool_panel_section_label":"Annotation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"staramr","owner":"nml","revisions":"3b22de20bd4b","tool_panel_section_label":"Metagenomic Analysis","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: bowtie2\n  owner: devteam\n  revisions: 03e9b2fbc005\n  tool_panel_section_label: Mapping\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bakta\n  owner: iuc\n  revisions: 728dacaf08a9\n  tool_panel_section_label: Annotation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: jbrowse\n  owner: iuc\n  revisions: a6e57ff585c0\n  tool_panel_section_label: Graph/Display Data\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: tbl2gff3\n  owner: iuc\n  revisions: 4a7f4b0cc0a3\n  tool_panel_section_label: Annotation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: staramr\n  owner: nml\n  revisions: 3b22de20bd4b\n  tool_panel_section_label: Metagenomic Analysis\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":false,"slides_recordings":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial","contributors":[{"name":"Bazante Sanders","joined":"2020-12","affiliations":["avans-atgm"],"id":"bazante1","url":"https://training.galaxyproject.org/training-material/api/contributors/bazante1.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/bazante1/"},{"name":"Bérénice Batut","email":"berenice.batut@gmail.com","twitter":"bebatut","linkedin":"berenicebatut","matrix":"bebatut:matrix.org","orcid":"0000-0001-9852-1987","joined":"2017-09","elixir_node":"fr","contact_for_training":true,"location":{"country":"FR","lat":45.77,"lon":3.08},"fediverse":"https://piaille.fr/@bebatut","fediverse_flavor":"mastodon","affiliations":["gallantries","ifb","elixir-europe"],"id":"bebatut","url":"https://training.galaxyproject.org/training-material/api/contributors/bebatut.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/bebatut/"},{"name":"Helena Rasche","orcid":"0000-0001-9760-8992","maintainer_contact":"gitter","matrix":"hexylena:matrix.org","joined":"2017-09","elixir_node":"nl","affiliations":["gallantries","by-covid","erasmusmc","elixir-europe","elixir-converge"],"former_affiliations":["deNBI","avans-atgm","uni-freiburg"],"contact_for_training":false,"location":{"country":"NL","lat":51.91,"lon":4.46},"id":"hexylena","url":"https://training.galaxyproject.org/training-material/api/contributors/hexylena.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/hexylena/"},{"name":"Bazante Sanders","joined":"2020-12","affiliations":["avans-atgm"],"id":"bazante1","url":"https://training.galaxyproject.org/training-material/api/contributors/bazante1.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/bazante1/"},{"name":"Saskia Hiltemann","maintainer_contact":"gitter","email":"saskia.hiltemann@gmail.com","fediverse":"https://mstdn.science/@shiltemann","fediverse_flavor":"mastodon","bluesky":"shiltemann.bsky.social","linkedin":"shiltemann","matrix":"shiltemann:matrix.org","orcid":"0000-0003-3803-468X","joined":"2017-09","bio":"Researcher at Erasmus Medical Center","elixir_node":"nl","contact_for_training":true,"affiliations":["CINECA-Project","gallantries","erasmusmc","elixir-europe","uni-freiburg"],"location":{"country":"NL","lat":51.912,"lon":4.462},"id":"shiltemann","url":"https://training.galaxyproject.org/training-material/api/contributors/shiltemann.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/shiltemann/"},{"name":"Miaomiao Zhou","email":"m.zhou1@avans.nl","joined":"2020-12","orcid":"0000-0003-4426-1758","id":"miaomiaozhou88","url":"https://training.galaxyproject.org/training-material/api/contributors/miaomiaozhou88.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/miaomiaozhou88/"},{"name":"Avans Hogeschool","joined":"2020-11","url":"https://training.galaxyproject.org/training-material/api/organisations/avans-atgm.json","avatar":"/training-material/shared/images/logo-avans.png","members":["bazante1"],"former_members":["dirowa","hexylena"],"id":"avans-atgm","page":"https://training.galaxyproject.org/training-material/hall-of-fame/avans-atgm/"},{"name":"ABRomics","github":false,"joined":"2024-01","avatar":"/training-material/assets/images/abromics.png","url":"https://training.galaxyproject.org/training-material/api/funders/abromics.json","funder":true,"id":"abromics","page":"https://training.galaxyproject.org/training-material/hall-of-fame/abromics/"}]}