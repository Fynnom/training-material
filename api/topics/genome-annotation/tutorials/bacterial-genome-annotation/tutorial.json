{"layout":"tutorial_hands_on","title":"Bacterial Genome Annotation","zenodo_link":"https://zenodo.org/record/10572227","questions":["Which genes are on a draft bacterial genome?","Which other genomic components can be found on a draft bacterial genome?"],"objectives":["Run a series of tool to annotate a draft bacterial genome for different types of genomic components","Evaluate the annotation","Process the outputs to formate them for visualization needs","Visualize a draft bacterial genome and its annotations"],"time_estimation":"3H","key_points":["Bakta is a powerful tool to annotate a bacterial genome","Annotation can be easily visualized to understand the genomic context and help making sense of the annotations"],"tags":["gmod","illumina","bacteria","microgalaxy","jbrowse1"],"subtopic":"prokaryote","edam_ontology":["topic_0622","topic_3301","topic_0623","topic_0080","topic_3673","topic_0085","topic_0798"],"level":"Introductory","contributions":{"authorship":["bebatut"],"funding":["abromics"]},"follow_up_training":[{"type":"internal","topic_name":"genome-annotation","tutorials":["apollo"]},{"type":"internal","topic_name":"visualisation","tutorials":["circos","jbrowse"]},{"type":"internal","topic_name":"galaxy-interface","tutorials":["history-to-workflow"]}],"js_requirements":{"mathjax":null,"mermaid":false},"short_id":"T00403","url":"/topics/genome-annotation/tutorials/bacterial-genome-annotation/tutorial.html","topic_name":"genome-annotation","tutorial_name":"bacterial-genome-annotation","dir":"topics/genome-annotation/tutorials/bacterial-genome-annotation","symlink":null,"id":"genome-annotation/bacterial-genome-annotation","ref_tutorials":["<p>After sequencing and assembly, a genome can be annotated. It is an essential step to describe the genome.</p>\n\n<p>Genome annotation consists in describing the structure and function of the components of the genome, by predicting, analyzing, and interpreting them in order to extract their biological significance and understand the biological processes in which they participate. Among other things, it identifies the locations of genes and all the coding regions in a genome (<em>structural annotation</em>) and determines what those genes do (<em>functional annotation</em>).</p>\n\n<p>To illustrate the process to annotate a bacterial genome, we take an assembly of a bacterial genome (KUN1163 sample) generated by following a <a href=\"/training-material/topics/assembly/tutorials/mrsa-illumina/tutorial.html\">bacterial genome assembly tutorial</a> from data produced in “Complete Genome Sequences of Eight Methicillin-Resistant <em>Staphylococcus aureus</em> Strains Isolated from Patients in Japan” (<span class=\"citation\"><a href=\"#Hikichi_2019\">Hikichi <i>et al.</i> 2019</a></span>).</p>\n\n<blockquote class=\"quote\" cite=\"https://doi.org/10.1128%2Fmra.01212-19\">\n  <p>Methicillin-resistant <em>Staphylococcus aureus</em> (MRSA) is a major pathogen\ncausing nosocomial infections, and the clinical manifestations of MRSA\nrange from asymptomatic colonization of the nasal mucosa to soft tissue\ninfection to fulminant invasive disease. Here, we report the complete\ngenome sequences of eight MRSA strains isolated from patients in Japan.</p>\n</blockquote>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n  <p>In this tutorial, we will cover:</p>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#galaxy-and-data-preparation\" id=\"markdown-toc-galaxy-and-data-preparation\">Galaxy and data preparation</a></li>\n  <li><a href=\"#contig-annotation\" id=\"markdown-toc-contig-annotation\">Contig annotation</a></li>\n  <li><a href=\"#further-structural-annotation\" id=\"markdown-toc-further-structural-annotation\">Further structural annotation</a>    <ol>\n      <li><a href=\"#plasmids\" id=\"markdown-toc-plasmids\">Plasmids</a></li>\n      <li><a href=\"#integrons\" id=\"markdown-toc-integrons\">Integrons</a></li>\n      <li><a href=\"#is-insertion-sequence-elements\" id=\"markdown-toc-is-insertion-sequence-elements\">IS (Insertion Sequence) elements</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#visualisation-of-the-annotation\" id=\"markdown-toc-visualisation-of-the-annotation\">Visualisation of the annotation</a></li>\n  <li><a href=\"#conclusion\" id=\"markdown-toc-conclusion\">Conclusion</a></li>\n</ol>\n\n</blockquote>\n\n<h1 id=\"galaxy-and-data-preparation\">Galaxy and data preparation</h1>\n\n<p>Any analysis should get its own Galaxy history. So let’s start by creating a new one and get the data (contig file from the assembly) into it.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Prepare Galaxy and data</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Create a new history for this analysis</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-new-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-new-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a new history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>Click the <i class=\"fas fa-plus\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">new-history</span> icon at the top of the history panel:</p>   <p><img src=\"/training-material/shared/images/history_create_new.svg\" alt=\"UI for creating new history\" /></p>   <!-- the original drawing can be found here https://docs.google.com/drawings/d/1cCBrLAo4kDGic5QyB70rRiWJAKTenTU8STsKDaLcVU8/edit?usp=sharing --> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Rename the history</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-renaming-a-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-renaming-a-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Renaming a history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ol>   <li>Click on <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> (<strong>Edit</strong>) next to the history name (which by default is “Unnamed history”)</li>   <li>Type the new name</li>   <li>Click on <strong>Save</strong></li> </ol>   <p>If you do not have the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> (<strong>Edit</strong>) next to the history name:</p>   <ol>   <li>Click on <strong>Unnamed history</strong> (or the current name of the history) (<strong>Click to rename history</strong>) at the top of your history panel</li>   <li>Type the new name</li>   <li>Press <kbd>Enter</kbd></li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p><span class=\"tool\" data-tool=\"upload1\" title=\"Import tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Import</strong></span> the contig file from <a href=\"https://zenodo.org/record/10572227\">Zenodo</a> or from Galaxy shared data libraries:</p>\n\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/10572227/files/DRR187559_contigs.fasta\n</code></pre></div>      </div>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-via-links\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-via-links\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing via links</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-data-from-a-data-library\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-data-from-a-data-library\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing data from a data library</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>As an alternative to uploading the data from a URL or your computer, the files may also have been made available from a <em>shared data library</em>:</p>   <ol>   <li>Go into <strong>Shared data</strong> (top panel) then <strong>Data libraries</strong></li>   <li>Navigate to  the correct folder as indicated by your instructor.     <ul>       <li>On most Galaxies tutorial data will be provided in a folder named <strong>GTN - Material –&gt; Topic Name -&gt; Tutorial Name</strong>.</li>     </ul>   </li>   <li>Select the desired files</li>   <li>Click on <strong>Add to History</strong> <i class=\"fas fa-caret-down\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-dropdown</span> near the top and select <strong>as Datasets</strong> from the dropdown menu</li>   <li>     <p>In the pop-up window, choose</p>     <ul>       <li><em>“Select history”</em>: the history you want to import the data to (or create a new one)</li>     </ul>   </li>   <li>Click on <strong>Import</strong></li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h1 id=\"contig-annotation\">Contig annotation</h1>\n\n<p>For annotating the contigs, several tools exists to do that: Prokka (<span class=\"citation\"><a href=\"#seemann2014prokka\">Seemann 2014</a></span>), Bakta (<span class=\"citation\"><a href=\"#schwengers2021bakta\">Schwengers <i>et al.</i> 2021</a></span>), etc. Here, we use <strong>Bakta</strong> as recommended by <a href=\"/training-material/hall-of-fame/tseemann/\" class=\"contributor-badge contributor-tseemann\"><img src=\"https://avatars.githubusercontent.com/tseemann?s=36\" alt=\"Torsten Seemann avatar\" width=\"36\" class=\"avatar\" />\n    Torsten Seemann</a> as the successor of <strong>Prokka</strong>.</p>\n\n<p><strong>Bakta</strong> is a tool for the rapid &amp; standardized annotation of bacterial genomes and plasmids from both isolates and metagenome-assembled genomes (MAGs). It implements a comprehensive annotation workflow for coding and non-coding genes (<em>i.e.</em> tRNA, rRNA).</p>\n\n<figure id=\"figure-1\" style=\"max-width: 90%;\"><img src=\"./images/bakta_wf.png\" alt=\"Flow diagram of Bakta. It depicts the sequential steps and connections involved in its functioning.\" width=\"2362\" height=\"1976\" loading=\"lazy\" /><a target=\"_blank\" href=\"./images/bakta_wf.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 1</strong>:</span> Overview of the Bakta annotation workflow (<span class=\"citation\"><a href=\"#schwengers2021bakta\">Schwengers <i>et al.</i> 2021</a></span>)</figcaption></figure>\n\n<p>It is also able to detect and annotate small proteins (sORF). Predicted CDS are annotated using an alignment-free protein sequence identification approach with cross-references to public databases via stable identifiers.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Contig annotation</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/bakta/bakta/1.8.2+galaxy0\" title=\"Bakta tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Bakta</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.8.2+galaxy0)</span> with the following parameters:\n      <ul>\n        <li>In <em>“Input/Output options”</em>:\n          <ul>\n            <li><em>“The bakta database”</em>: latest one</li>\n            <li><em>“The amrfinderplus database”</em>: latest one</li>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Select genome in fasta format”</em>: Contig file</li>\n          </ul>\n        </li>\n        <li>In <em>“Optional annotation”</em>:\n          <ul>\n            <li><em>“Keep original contig header (–keep-contig-headers)”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n          </ul>\n        </li>\n        <li>In <em>“Selection of the output files”</em>:\n          <ul>\n            <li><em>“Output files selection”</em>:\n              <ul>\n                <li><code class=\"language-plaintext highlighter-rouge\">Annotation file in TSV</code></li>\n                <li><code class=\"language-plaintext highlighter-rouge\">Annotation and sequence in GFF3</code></li>\n                <li><code class=\"language-plaintext highlighter-rouge\">Feature nucleotide sequences as FASTA</code></li>\n                <li><code class=\"language-plaintext highlighter-rouge\">Summary as TXT</code></li>\n                <li><code class=\"language-plaintext highlighter-rouge\">Plot of the annotation result as SVG</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<p><strong>Bakta</strong> can generate many outputs. Here we selected:</p>\n\n<ul>\n  <li>\n    <p><code class=\"language-plaintext highlighter-rouge\">Analysis_summary</code>: a summary of the analysis as text file</p>\n\n    <blockquote class=\"question\">\n      <question-title></question-title>\n\n      <ol>\n        <li>How many contigs have been provided as input?</li>\n        <li>How long is the draft genome?</li>\n        <li>How many CDSs have been found?</li>\n        <li>How many small proteins?</li>\n        <li>Which other components have been found?</li>\n      </ol>\n\n      <p>How does it compare to results for KUN1163 in <a href=\"https://journals.asm.org/doi/10.1128/mra.01212-19#tab1\">Table 1</a> in <span class=\"citation\"><a href=\"#Hikichi_2019\">Hikichi <i>et al.</i> 2019</a></span>?</p>\n\n      <blockquote class=\"solution\">\n        <solution-title></solution-title>\n\n        <ol>\n          <li>44 (the sequence count)</li>\n          <li>2,911,349 bp, with is a bit shorter than the expected 2,914,567 bp in <a href=\"https://journals.asm.org/doi/10.1128/mra.01212-19#tab1\">Table 1</a> in <span class=\"citation\"><a href=\"#Hikichi_2019\">Hikichi <i>et al.</i> 2019</a></span></li>\n          <li>2,717 CDSs, a bit more than the expected 2,704 CDSs in <a href=\"https://journals.asm.org/doi/10.1128/mra.01212-19#tab1\">Table 1</a> in <span class=\"citation\"><a href=\"#Hikichi_2019\">Hikichi <i>et al.</i> 2019</a></span></li>\n          <li>5 sORFs. There is no information about sORFs in <span class=\"citation\"><a href=\"#Hikichi_2019\">Hikichi <i>et al.</i> 2019</a></span></li>\n          <li>\n            <p>Other components</p>\n\n            <table>\n              <thead>\n                <tr>\n                  <th>Components</th>\n                  <th>Bakta</th>\n                  <th><span class=\"citation\"><a href=\"#Hikichi_2019\">Hikichi <i>et al.</i> 2019</a></span></th>\n                </tr>\n              </thead>\n              <tbody>\n                <tr>\n                  <td>tRNAs</td>\n                  <td>57</td>\n                  <td>61</td>\n                </tr>\n                <tr>\n                  <td>Transfer-messenger RNA (tmRNAs)</td>\n                  <td>1</td>\n                  <td>1</td>\n                </tr>\n                <tr>\n                  <td>rRNAs</td>\n                  <td>9</td>\n                  <td>5</td>\n                </tr>\n                <tr>\n                  <td>ncRNAs</td>\n                  <td>95</td>\n                  <td>No information</td>\n                </tr>\n              </tbody>\n            </table>\n          </li>\n        </ol>\n\n      </blockquote>\n    </blockquote>\n  </li>\n  <li>\n    <p><code class=\"language-plaintext highlighter-rouge\">Nucleotide_sequences</code> with feature nucleotide sequences as FASTA file</p>\n\n    <blockquote class=\"question\">\n      <question-title></question-title>\n\n      <ol>\n        <li>How many sequences are in this file?</li>\n        <li>What are the sequences stored there?</li>\n      </ol>\n\n      <blockquote class=\"solution\">\n        <solution-title></solution-title>\n\n        <ol>\n          <li>2,884 sequences</li>\n          <li>Here are stored:\n            <ul>\n              <li>tRNAs</li>\n              <li>tmRNAs</li>\n              <li>rRNAs</li>\n              <li>ncRNAs</li>\n              <li>CDSs</li>\n              <li>sORFs</li>\n            </ul>\n          </li>\n        </ol>\n\n      </blockquote>\n    </blockquote>\n  </li>\n  <li>\n    <p><code class=\"language-plaintext highlighter-rouge\">annotation_summary</code> with annotations as simple human readble TSV</p>\n\n    <blockquote class=\"question\">\n      <question-title></question-title>\n\n      <p>What is stored there?</p>\n\n      <blockquote class=\"solution\">\n        <solution-title></solution-title>\n\n        <p>This a table with 9 columns (<code class=\"language-plaintext highlighter-rouge\">Sequence Id</code>, <code class=\"language-plaintext highlighter-rouge\">Type</code>, <code class=\"language-plaintext highlighter-rouge\">Start</code>, <code class=\"language-plaintext highlighter-rouge\">Stop</code>, <code class=\"language-plaintext highlighter-rouge\">Strand</code>, <code class=\"language-plaintext highlighter-rouge\">Locus Tag</code>, <code class=\"language-plaintext highlighter-rouge\">Gene</code>, <code class=\"language-plaintext highlighter-rouge\">Product</code>, <code class=\"language-plaintext highlighter-rouge\">DbXrefs</code>). It contains here 2,916 lines, so the information and location for:</p>\n        <ul>\n          <li>tRNAs</li>\n          <li>tmRNAs</li>\n          <li>rRNAs</li>\n          <li>ncRNAs</li>\n          <li>CDSs</li>\n          <li>sORFs</li>\n          <li>gaps</li>\n          <li>oriCs</li>\n          <li>oriVs</li>\n          <li>oriTs</li>\n        </ul>\n\n      </blockquote>\n    </blockquote>\n  </li>\n  <li>\n    <p><code class=\"language-plaintext highlighter-rouge\">Annotation_and_sequences</code> in GFF3</p>\n\n    <p>GFF is a file format used for describing genes and other features of DNA, RNA and protein sequences. It is a tab delimited file with 9 fields per line:</p>\n\n    <ol>\n      <li><strong>seqid</strong>: The name of the sequence where the feature is located.</li>\n      <li><strong>source</strong>: The algorithm or procedure that generated the feature. This is typically the name of a software or database.</li>\n      <li><strong>type</strong>: The feature type name, like “gene” or “exon”. In a well structured GFF file, all the children features always follow their parents in a single block (so all exons of a transcript are put after their parent “transcript” feature line and before any other parent transcript line). In GFF3, all features and their relationships should be compatible with the standards released by the Sequence Ontology Project.</li>\n      <li><strong>start</strong>: Genomic start of the feature, with a 1-base offset. This is in contrast with other 0-offset half-open sequence formats, like BED.</li>\n      <li><strong>end</strong>: Genomic end of the feature, with a 1-base offset. This is the same end coordinate as it is in 0-offset half-open sequence formats, like BED.</li>\n      <li><strong>score</strong>: Numeric value that generally indicates the confidence of the source in the annotated feature. A value of “.” (a dot) is used to define a null value.</li>\n      <li><strong>strand</strong>: Single character that indicates the strand of the feature. This can be “+” (positive, or 5’-&gt;3’), “-“, (negative, or 3’-&gt;5’), “.” (undetermined), or “?” for features with relevant but unknown strands.</li>\n      <li><strong>phase</strong>: phase of CDS features; it can be either one of 0, 1, 2 (for CDS features) or “.” (for everything else). See the section below for a detailed explanation.</li>\n      <li><strong>attributes</strong>: A list of tag-value pairs separated by a semicolon with additional information about the feature.</li>\n    </ol>\n\n    <blockquote class=\"question\">\n      <question-title></question-title>\n\n      <p>How many features are annotated?</p>\n\n      <blockquote class=\"solution\">\n        <solution-title></solution-title>\n\n        <p>51k+ (number of lines in the GFF)</p>\n\n      </blockquote>\n    </blockquote>\n  </li>\n  <li>\n    <p>Plot of the annotation as circular genome annotation</p>\n\n    <p><a href=\"./images/bakta_plot.png\" rel=\"noopener noreferrer\"><img src=\"./images/bakta_plot.png\" alt=\"A circular plot showcasing the draft genome, providing a visual representation of its genetic information.\" width=\"3000\" height=\"3000\" loading=\"lazy\" /></a></p>\n\n    <blockquote class=\"question\">\n      <question-title></question-title>\n\n      <ol>\n        <li>What the 2 rings in the center?</li>\n        <li>How are plotted the features?</li>\n      </ol>\n\n      <blockquote class=\"solution\">\n        <solution-title></solution-title>\n\n        <ol>\n          <li>The first ring represents the GC content per sliding window over the entire sequence(s) with in green representing GC above  and red GC below average. The 2nd ring represents the GC skew in orange and blue.</li>\n          <li>All features are plotted on two rings representing the forward and reverse strand from outer to inner with CDS in grey (the other colors are hard to distinguish)</li>\n        </ol>\n\n      </blockquote>\n    </blockquote>\n  </li>\n</ul>\n\n<h1 id=\"further-structural-annotation\">Further structural annotation</h1>\n\n<p><strong>Bakta</strong> gives a lot of information already, especially regarding CDSs or RNAs, but some structural annotation might be missing, e.g. plasmids, or interesting to identify independently.</p>\n\n<h2 id=\"plasmids\">Plasmids</h2>\n\n<p>To identify plasmids in our contigs, we use <strong>PlasmidFinder</strong> (<span class=\"citation\"><a href=\"#carattoli2020plasmidfinder\">Carattoli and Hasman 2020</a></span>), a tool for the identification and typing of plasmid sequences in Whole-Genome Sequencing. It uses the <a href=\"https://bitbucket.org/genomicepidemiology/plasmidfinder_db/\">plasmidfinder database</a> with hundreds of sequences to predict the plasmid in the data.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title> Plasmid identification</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/plasmidfinder/plasmidfinder/2.1.6+galaxy1\" title=\"PlasmidFinder tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>PlasmidFinder</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.1.6+galaxy1)</span> with the following parameters:\n      <ul>\n        <li>In <em>“Input parameters”</em>:\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Choose a fasta or fastq file”</em>: Contig file</li>\n            <li><em>“PlasmidFinder database”</em>: most recent one</li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<p><strong>PlasmidFinder</strong> generates several outputs:</p>\n\n<ul>\n  <li><code class=\"language-plaintext highlighter-rouge\">raw_results.txt</code>: A text file containing the result table and alignments</li>\n  <li>\n    <p><code class=\"language-plaintext highlighter-rouge\">results.tsv</code>: A tabular file with the following columns:</p>\n\n    <ul>\n      <li><strong>Database</strong></li>\n      <li><strong>Plasmid</strong>: Plasmid against which the input genome has been aligned.</li>\n      <li><strong>Identity</strong>: Percent identity in the alignment between the best matching plasmid in the database and the corresponding sequence in the inputgenome (also called the high-scoring segment pair (HSP)). A perfect alignment is 100%, but must also cover the entire length of the plasmid in the database (compare example 1 and 3).</li>\n      <li><strong>Query/Template Length</strong>: Query length is the length of the best matching plasmid in the database, while HSP length is the length of the alignment between the best matching plasmid and the corresponding sequence in the genome (also called the high-scoring segment pair (HSP)).</li>\n      <li><strong>Contig</strong>: Name of contig the plasmid is found in.</li>\n      <li><strong>Position in contig</strong>: Starting position of the found gene in the contig.</li>\n      <li><strong>Note</strong>: Notes about the plasmid</li>\n      <li><strong>Accession number</strong>: Reference Genbank accession number accoding to NCBI for the plasmid in the database.</li>\n    </ul>\n\n    <blockquote class=\"question\">\n      <question-title></question-title>\n\n      <ol>\n        <li>How many plasmid sequences have been found?</li>\n        <li>Where are they located?</li>\n        <li>Are these sequences all associated with <em>Staphylococcus aureus</em>?</li>\n        <li>What can we conclude about contig00019?</li>\n      </ol>\n\n      <blockquote class=\"solution\">\n        <solution-title></solution-title>\n\n        <ol>\n          <li>5 plasmid sequences</li>\n          <li>3 are on the contig00019, 1 on contig00002, and 1 on contig00024</li>\n          <li>Looking at the accession number on the NCBI, we find that:\n            <ul>\n              <li>CP000737, AP003139 (2 times) correspond to <em>Staphylococcus aureus</em> plasmids</li>\n              <li>AF503772 corresponds to a <em>Enterococcus faecalis</em> plasmid</li>\n              <li>CP003584 corresponds to a <em>Enterococcus faecium</em> plasmid</li>\n            </ul>\n          </li>\n          <li>All plasmid sequences corresponding to <em>Staphylococcus aureus</em> plasmids are all on contig00019, making this contig likely a plasmid. In addition, this contig has a length of 30,347 bp, which is similar to the expected length of the plasmid for KUN1163 in <a href=\"https://journals.asm.org/doi/10.1128/mra.01212-19#tab1\">Table 1</a> in <span class=\"citation\"><a href=\"#Hikichi_2019\">Hikichi <i>et al.</i> 2019</a></span></li>\n        </ol>\n      </blockquote>\n    </blockquote>\n  </li>\n  <li><code class=\"language-plaintext highlighter-rouge\">plasmid.fasta</code>: A fasta file containing the best matching sequences from the query genome</li>\n  <li><code class=\"language-plaintext highlighter-rouge\">hit_in_genome.fasta</code>: A fasta file containing the best matching plasmid genes from the database</li>\n</ul>\n\n<h2 id=\"integrons\">Integrons</h2>\n\n<p>Integrons are genetic mechanisms that allow bacteria to adapt and evolve rapidly through the stockpiling and expression of new genes. An integron is minimally composed of:</p>\n\n<ul>\n  <li>a gene encoding for a site-specific recombinase (intI)</li>\n  <li>a proximal recombination site (attI), which is recognized by the integrase and at which gene cassettes may be inserted</li>\n  <li>a promoter (Pc) which directs transcription of cassette-encoded genes</li>\n</ul>\n\n<p>To detect integrons, we will use <strong>IntegronFinder</strong> (<span class=\"citation\"><a href=\"#neron2022integronfinder\">Néron <i>et al.</i> 2022</a></span>). This tool:</p>\n\n<ol>\n  <li>Annotates the CDS with <strong>Prodigal</strong></li>\n  <li>\n    <p>Detects independently:</p>\n\n    <ol>\n      <li>integron integrase using the intersection of two HMM profiles: one specific of tyrosine-recombinase (PF00589) and one specific of the integron integrase, near the patch III domain of tyrosine recombinases</li>\n      <li>attC recombination sites with a covariance model (CM), which models the secondary structure in addition to the few conserved sequence positions.</li>\n    </ol>\n  </li>\n  <li>\n    <p>Integrates the results to distinguish 3 types of elements</p>\n\n    <ul>\n      <li>Complete integron: Integron with integron integrase nearby attC site(s)</li>\n      <li>In0 element: Integron integrase only, without any attC site nearby</li>\n      <li>CALIN element: Cluster of attC sites Lacking INtegrase nearby</li>\n    </ul>\n  </li>\n</ol>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title> Integron identification</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/integron_finder/integron_finder/2.0.2+galaxy1\" title=\"IntegronFinder tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>IntegronFinder</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.0.2+galaxy1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Replicon file”</em>: Contig file</li>\n        <li><em>“Thorough local detection”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        <li><em>“Search also for promoter and attI sites?”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        <li><em>“Remove log file”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p><strong>IntegronFinder</strong> generates 2 outputs:</p>\n\n<ul>\n  <li>\n    <p>A summary with for each sequence in the input the number of identified CALIN elements, In0 elements, and complete integrons.</p>\n\n    <blockquote class=\"question\">\n      <question-title></question-title>\n\n      <p>How many integron elements have been found?</p>\n\n      <blockquote class=\"solution\">\n        <solution-title></solution-title>\n\n        <p>No integron elements have been found on any contig. It could be because the genome is too stable, or because the assembly quality is not good enough and some parts useful for the integron detection were removed.</p>\n      </blockquote>\n    </blockquote>\n  </li>\n  <li>\n    <p>An integron annotation file as a tabular</p>\n  </li>\n</ul>\n\n<h2 id=\"is-insertion-sequence-elements\">IS (Insertion Sequence) elements</h2>\n\n<p>Insertion sequence (IS) element is a short DNA sequence that acts as a simple transposable element. IS are the smallest but most abundant autonomous transposable elements in bacterial genomes.  They only code for proteins implicated in the transposition activity. They play then a key role in bacterial genome organization and evolution.</p>\n\n<p>To detect IS elements, we will use <strong>ISEScan</strong> (<span class=\"citation\"><a href=\"#xie2017isescan\">Xie and Tang 2017</a></span>). <strong>ISEScan</strong> is a highly sensitive software pipeline based on profile hidden Markov models constructed from manually curated IS elements</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title> IS identification </hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/isescan/isescan/1.7.2.3+galaxy0\" title=\"ISEScan tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>ISEScan</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.7.2.3+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Genome fasta input”</em>: Contig file</li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p><strong>ISEScan</strong> generates several files:</p>\n\n<ul>\n  <li>\n    <p>A summary as a table</p>\n  </li>\n  <li>\n    <p>The results as a table</p>\n\n    <blockquote class=\"question\">\n      <question-title></question-title>\n\n      <ol>\n        <li>How many IS elements have been detected?</li>\n        <li>Where are they located?</li>\n        <li>What the different IS families?</li>\n      </ol>\n\n      <blockquote class=\"solution\">\n        <solution-title></solution-title>\n\n        <ol>\n          <li>20</li>\n          <li>\n            <p>Using <span class=\"tool\" data-tool=\"Grouping1\" title=\"Group data by a column tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Group data by a column</strong></span> to group and count on 1st column, we find:</p>\n\n            <table>\n              <thead>\n                <tr>\n                  <th>Contig</th>\n                  <th>IS element number</th>\n                </tr>\n              </thead>\n              <tbody>\n                <tr>\n                  <td>contig00001</td>\n                  <td>2</td>\n                </tr>\n                <tr>\n                  <td>contig00002</td>\n                  <td>1</td>\n                </tr>\n                <tr>\n                  <td>contig00003</td>\n                  <td>2</td>\n                </tr>\n                <tr>\n                  <td>contig00004</td>\n                  <td>1</td>\n                </tr>\n                <tr>\n                  <td>contig00005</td>\n                  <td>1</td>\n                </tr>\n                <tr>\n                  <td>contig00006</td>\n                  <td>1</td>\n                </tr>\n                <tr>\n                  <td>contig00009</td>\n                  <td>3</td>\n                </tr>\n                <tr>\n                  <td>contig00010</td>\n                  <td>1</td>\n                </tr>\n                <tr>\n                  <td>contig00011</td>\n                  <td>1</td>\n                </tr>\n                <tr>\n                  <td>contig00012</td>\n                  <td>1</td>\n                </tr>\n                <tr>\n                  <td>contig00019</td>\n                  <td>3</td>\n                </tr>\n                <tr>\n                  <td>contig00027</td>\n                  <td>1</td>\n                </tr>\n                <tr>\n                  <td>contig00032</td>\n                  <td>1</td>\n                </tr>\n                <tr>\n                  <td>contig00037</td>\n                  <td>1</td>\n                </tr>\n              </tbody>\n            </table>\n          </li>\n          <li>\n            <p>As for previous question, when grouping and counting on 2nd column, we find 5 IS families:</p>\n\n            <table>\n              <thead>\n                <tr>\n                  <th>IS families</th>\n                  <th>Identified IS elements</th>\n                </tr>\n              </thead>\n              <tbody>\n                <tr>\n                  <td>IS1182</td>\n                  <td>4</td>\n                </tr>\n                <tr>\n                  <td>IS21</td>\n                  <td>7</td>\n                </tr>\n                <tr>\n                  <td>IS3</td>\n                  <td>3</td>\n                </tr>\n                <tr>\n                  <td>IS6</td>\n                  <td>5</td>\n                </tr>\n                <tr>\n                  <td>ISL3</td>\n                  <td>1</td>\n                </tr>\n              </tbody>\n            </table>\n          </li>\n        </ol>\n\n      </blockquote>\n    </blockquote>\n  </li>\n  <li>The results as a GFF file</li>\n  <li>Several FASTA files:\n    <ul>\n      <li>IS nucleotide sequences</li>\n      <li>ORF nucleotide sequences</li>\n      <li>ORF amino acide sequences</li>\n    </ul>\n  </li>\n</ul>\n\n<h1 id=\"visualisation-of-the-annotation\">Visualisation of the annotation</h1>\n\n<p>We would like to look at the annotation using <a href=\"https://jbrowse.org/jb2/\">JBrowse</a> (<span class=\"citation\"><a href=\"#diesh2023jbrowse\">Diesh <i>et al.</i> 2023</a></span>) with several information:</p>\n\n<ol>\n  <li>Annotations identified by <strong>Bakta</strong></li>\n  <li>Plasmid sequences identified by <strong>PlasmidFinder</strong></li>\n  <li>Integrons identified by <strong>IntegronFinder</strong></li>\n  <li>IS elements identified by <strong>ISEscan</strong></li>\n</ol>\n\n<p><strong>JBrowse</strong> needs the annotations to be in GFF format. <strong>Bakta</strong> and <strong>ISEscan</strong> generated both GFF files. For <strong>PlasmidFinder</strong> and <strong>IntegronFinder</strong>, we need to format the outputs.</p>\n\n<p><strong>PlasmidFinder</strong> generated the <code class=\"language-plaintext highlighter-rouge\">results.tsv</code> with all needed information. To transform it to a GFF, we need to:</p>\n\n<ol>\n  <li>Split the 6th column on <code class=\"language-plaintext highlighter-rouge\">..</code> to have start and end into 2 separated columns</li>\n  <li>Remove in the content of column 5 what is after the contig name</li>\n  <li>Remove the 1st line</li>\n  <li>Transform to GFF3</li>\n</ol>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title> Transform PlasmidFinder to GFF </hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_replace_in_column/1.1.3\" title=\"Replace Text in a specific column tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Replace Text in a specific column</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.1.3)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“File to process”</em>: <code class=\"language-plaintext highlighter-rouge\">results.tsv</code> output of <strong>PlasmidFinder</strong></li>\n        <li>In <em>“Replacement”</em>:\n          <ul>\n            <li>In <em>“1: Replacement”</em>\n              <ul>\n                <li><em>in column</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 6</code></li>\n                <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">(.*)\\.\\.(.*)</code></li>\n                <li><em>“Replace with”</em>: <code class=\"language-plaintext highlighter-rouge\">\\\\1\\t\\\\2</code></li>\n              </ul>\n\n              <p>This will split the content of the 6th column on <code class=\"language-plaintext highlighter-rouge\">..</code> and put it into column 6 and column 7. Column 7 will be then replaced.</p>\n            </li>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Factor”</em></li>\n            <li>In <em>“2: Replacement”</em>\n              <ul>\n                <li><em>in column</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 5</code></li>\n                <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">(.*)( len.*)</code></li>\n                <li><em>“Replace with”</em>: <code class=\"language-plaintext highlighter-rouge\">\\\\1</code></li>\n              </ul>\n\n              <p>This will remove in the content of column 5 what is after the contig name</p>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_tail_tool/1.1.0\" title=\"Select last lines from a dataset tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Select last lines from a dataset</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.1.0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Text file”</em>: output of <strong>Replace Text</strong> above</li>\n        <li><em>“Operation”</em>: <code class=\"language-plaintext highlighter-rouge\">Keep everything from this line on</code></li>\n        <li><em>“Number of lines”</em>: <code class=\"language-plaintext highlighter-rouge\">2</code></li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/tbl2gff3/tbl2gff3/1.2\" title=\"Table to GFF3 tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Table to GFF3</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.2)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Table”</em>: output of the above <strong>Select last</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> step</li>\n        <li><em>“Record ID column or value”</em>: <code class=\"language-plaintext highlighter-rouge\">5</code></li>\n        <li><em>“Start column or value”</em>: <code class=\"language-plaintext highlighter-rouge\">6</code></li>\n        <li><em>“End column or value”</em>: <code class=\"language-plaintext highlighter-rouge\">7</code></li>\n        <li><em>“Type column or value”</em>: <code class=\"language-plaintext highlighter-rouge\">2</code></li>\n        <li><em>“Score column or value”</em>: <code class=\"language-plaintext highlighter-rouge\">3</code></li>\n        <li><em>“Source column or value”</em>: <code class=\"language-plaintext highlighter-rouge\">1</code></li>\n        <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Qualifiers”</em>\n          <ul>\n            <li><em>“Name”</em>: <code class=\"language-plaintext highlighter-rouge\">name</code></li>\n            <li><em>“Qualifier value column or raw text”</em>: <code class=\"language-plaintext highlighter-rouge\">8</code></li>\n          </ul>\n        </li>\n        <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Qualifiers”</em>\n          <ul>\n            <li><em>“Name”</em>: <code class=\"language-plaintext highlighter-rouge\">accession</code></li>\n            <li><em>“Qualifier value column or raw text”</em>: <code class=\"language-plaintext highlighter-rouge\">9</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>Rename to <code class=\"language-plaintext highlighter-rouge\">PlasmidFinder GFF</code></li>\n  </ol>\n</blockquote>\n\n<blockquote class=\"details\">\n  <details-title>Transform IntegronFinder output to GFF if integrons found</details-title>\n  <p><strong>IntegronFinder</strong> tabular output can be transformed to GFF by:</p>\n\n  <ol>\n    <li>Replace <code class=\"language-plaintext highlighter-rouge\">NA</code> values on column 7 by <code class=\"language-plaintext highlighter-rouge\">0</code></li>\n    <li>Remove the first two lines</li>\n    <li>Transform to GFF3</li>\n  </ol>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title> Transform IntegronFinder to GFF </hands-on-title>\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_replace_in_column/1.1.3\" title=\"Replace Text in a specific column tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Replace Text in a specific column</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.1.3)</span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“File to process”</em>: tabular output of <strong>IntegronFinder</strong></li>\n          <li>In <em>“Replacement”</em>:\n            <ul>\n              <li>In <em>“1: Replacement”</em>\n                <ul>\n                  <li><em>in column</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 7</code></li>\n                  <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">NA</code></li>\n                  <li><em>“Replace with”</em>: <code class=\"language-plaintext highlighter-rouge\">0</code></li>\n                </ul>\n              </li>\n            </ul>\n          </li>\n        </ul>\n      </li>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_tail_tool/1.1.0\" title=\"Select last lines from a dataset tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Select last lines from a dataset</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.1.0)</span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Text file”</em>: output of <strong>Replace Text</strong> above</li>\n          <li><em>“Operation”</em>: <code class=\"language-plaintext highlighter-rouge\">Keep everything from this line on</code></li>\n          <li><em>“Number of lines”</em>: <code class=\"language-plaintext highlighter-rouge\">3</code></li>\n        </ul>\n      </li>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/tbl2gff3/tbl2gff3/1.2\" title=\"Table to GFF3 tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Table to GFF3</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.2)</span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Table”</em>: tabular output of <strong>IntegronFinder</strong></li>\n          <li><em>“Record ID column or value”</em>: <code class=\"language-plaintext highlighter-rouge\">2</code></li>\n          <li><em>“Start column or value”</em>: <code class=\"language-plaintext highlighter-rouge\">4</code></li>\n          <li><em>“End column or value”</em>: <code class=\"language-plaintext highlighter-rouge\">5</code></li>\n          <li><em>“Type column or value”</em>: <code class=\"language-plaintext highlighter-rouge\">11</code></li>\n          <li><em>“Score column or value”</em>: <code class=\"language-plaintext highlighter-rouge\">7</code></li>\n          <li><em>“Source column or value”</em>: <code class=\"language-plaintext highlighter-rouge\">IntegronFinder</code></li>\n          <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Qualifiers”</em>\n            <ul>\n              <li><em>“Name”</em>: <code class=\"language-plaintext highlighter-rouge\">name</code></li>\n              <li><em>“Qualifier value column or raw text”</em>: <code class=\"language-plaintext highlighter-rouge\">3</code></li>\n            </ul>\n          </li>\n          <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Qualifiers”</em>\n            <ul>\n              <li><em>“Name”</em>: <code class=\"language-plaintext highlighter-rouge\">annotation</code></li>\n              <li><em>“Qualifier value column or raw text”</em>: <code class=\"language-plaintext highlighter-rouge\">9</code></li>\n            </ul>\n          </li>\n        </ul>\n      </li>\n      <li>Rename to <code class=\"language-plaintext highlighter-rouge\">IntegronFinder GFF</code></li>\n    </ol>\n  </blockquote>\n</blockquote>\n\n<p>We can now launch <strong>JBrowse</strong> with different information track.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Visualize the Genome</hands-on-title>\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/jbrowse/jbrowse/1.16.11+galaxy1\" title=\"JBrowse tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>JBrowse</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.16.11+galaxy1)</span> with the following parameters:\n      <ul>\n        <li><em>“Reference genome to display”</em>: <code class=\"language-plaintext highlighter-rouge\">Use a genome from history</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Select the reference genome”</em>: Contig file</li>\n          </ul>\n        </li>\n        <li><em>“Genetic Code”</em>: <code class=\"language-plaintext highlighter-rouge\">11. The Bacterial, Archaeal and Plant Plastid Code</code></li>\n        <li>In <em>“Track Group”</em>:\n          <ul>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Track Group”</em>\n              <ul>\n                <li><em>“Track Category”</em>: <code class=\"language-plaintext highlighter-rouge\">Bakta</code></li>\n                <li>In <em>“Annotation Track”</em>:\n                  <ul>\n                    <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Annotation Track”</em>\n                      <ul>\n                        <li><em>“Track Type”</em>: <code class=\"language-plaintext highlighter-rouge\">GFF/GFF3/BED Features</code>\n                          <ul>\n                            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“GFF/GFF3/BED Track Data”</em>: <code class=\"language-plaintext highlighter-rouge\">Annotation_and_sequences</code> (output of <strong>Bakta</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n                            <li><em>“JBrowse Track Type [Advanced]”</em>: <code class=\"language-plaintext highlighter-rouge\">Neat Canvas Features</code></li>\n                            <li><em>“Track Visibility”</em>: <code class=\"language-plaintext highlighter-rouge\">On for new users</code></li>\n                          </ul>\n                        </li>\n                      </ul>\n                    </li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Track Group”</em>\n              <ul>\n                <li><em>“Track Category”</em>: <code class=\"language-plaintext highlighter-rouge\">Plasmid sequences</code></li>\n                <li>In <em>“Annotation Track”</em>:\n                  <ul>\n                    <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Annotation Track”</em>\n                      <ul>\n                        <li><em>“Track Type”</em>: <code class=\"language-plaintext highlighter-rouge\">GFF/GFF3/BED Features</code>\n                          <ul>\n                            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“GFF/GFF3/BED Track Data”</em>: <code class=\"language-plaintext highlighter-rouge\">PlasmidFinder GFF</code></li>\n                            <li><em>“JBrowse Track Type [Advanced]”</em>: <code class=\"language-plaintext highlighter-rouge\">Neat Canvas Features</code></li>\n                            <li><em>“Track Visibility”</em>: <code class=\"language-plaintext highlighter-rouge\">On for new users</code></li>\n                          </ul>\n                        </li>\n                      </ul>\n                    </li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Track Group”</em>\n              <ul>\n                <li><em>“Track Category”</em>: <code class=\"language-plaintext highlighter-rouge\">IS elements</code></li>\n                <li>In <em>“Annotation Track”</em>:\n                  <ul>\n                    <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Annotation Track”</em>\n                      <ul>\n                        <li><em>“Track Type”</em>: <code class=\"language-plaintext highlighter-rouge\">GFF/GFF3/BED Features</code>\n                          <ul>\n                            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“GFF/GFF3/BED Track Data”</em>: GFF output of <strong>ISEScan</strong></li>\n                            <li><em>“JBrowse Track Type [Advanced]”</em>: <code class=\"language-plaintext highlighter-rouge\">Neat Canvas Features</code></li>\n                            <li><em>“Track Visibility”</em>: <code class=\"language-plaintext highlighter-rouge\">On for new users</code></li>\n                          </ul>\n                        </li>\n                      </ul>\n                    </li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n          </ul>\n\n          <p><em>If integrons are found as <strong>IntegronFinder</strong></em></p>\n\n          <ul>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Track Group”</em>\n              <ul>\n                <li><em>“Track Category”</em>: <code class=\"language-plaintext highlighter-rouge\">Integrons</code></li>\n                <li>In <em>“Annotation Track”</em>:\n                  <ul>\n                    <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Annotation Track”</em>\n                      <ul>\n                        <li><em>“Track Type”</em>: <code class=\"language-plaintext highlighter-rouge\">GFF/GFF3/BED Features</code>\n                          <ul>\n                            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“GFF/GFF3/BED Track Data”</em>: <code class=\"language-plaintext highlighter-rouge\">IntegronFinder GFF</code></li>\n                            <li><em>“JBrowse Track Type [Advanced]”</em>: <code class=\"language-plaintext highlighter-rouge\">Neat Canvas Features</code></li>\n                            <li><em>“Track Visibility”</em>: <code class=\"language-plaintext highlighter-rouge\">On for new users</code></li>\n                          </ul>\n                        </li>\n                      </ul>\n                    </li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>View the output of JBrowse</li>\n  </ol>\n\n</blockquote>\n\n<p>In the output of the JBrowse you can view the genes, IS, plasmid, etc on the contigs. With the search tools you can easily find genes of interest. JBrowse can handle many inputs and can be very useful.</p>\n\n<p>If it takes too long to build the JBrowse instance, you can view an embedded one here:</p>\n\n<!--SNIPPET-->\n<iframe id=\"embedded_jbrowse\" src=\"/training-material/assets/jbrowse/index.html?loc=contig00019:1..30347&amp;data=/training-material/topics/genome-annotation/tutorials/bacterial-genome-annotation/data&amp;trackList=0\" border=\"0\" width=\"100%\" height=\"500px\"></iframe>\n<p><a href=\"/training-material/assets/jbrowse/index.html?loc=contig00019:1..30347&amp;data=/training-material/topics/genome-annotation/tutorials/bacterial-genome-annotation/data\" target=\"_blank\" style=\"padding: 0.5rem 1rem; background-color: #dfe5f9;border-bottom-left-radius: 8px; border-bottom-right-radius: 8px;\">Open JBrowse in a new tab</a></p>\n<p><!--END_SNIPPET--></p>\n\n<blockquote class=\"comment\">\n  <comment-title></comment-title>\n  <ol>\n    <li>It is ok to have the message stating <code class=\"language-plaintext highlighter-rouge\">Error reading from name store.</code>.</li>\n    <li>The feature name search will not work.</li>\n  </ol>\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>Have all sequences identified by <strong>PlasmidFinder</strong> on contig19 been identified by <strong>Bakta</strong>?</li>\n    <li>Have all sequences identified by <strong>ISEScan</strong> on contig19 been identified by <strong>Bakta</strong>?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>Yes all sequences in the <strong>PlasmidFinder</strong> track are also in the <strong>Bakta</strong> track. For</li>\n      <li>All Insertion Sequences in the <strong>ISEScan</strong> track are also in the <strong>Bakta</strong> track, but the Terminanl Inverted repeats are not in the <strong>Bakta</strong> track</li>\n    </ol>\n  </blockquote>\n</blockquote>\n\n<p>To learn more options for <strong>JBrowse</strong>, check out the <a href=\"/training-material/topics/visualisation/tutorials/jbrowse/tutorial.html\">dedicated tutorial</a></p>\n\n<h1 id=\"conclusion\">Conclusion</h1>\n\n<p>In this tutorial, contigs were annotated with different tools and then visualized.</p>\n\n<p>Other visualizations, specially for publications, can be done using <strong>Circos</strong>. To learn how to do it, you can follow the <a href=\"/training-material/topics/visualisation/tutorials/circos-microbial/tutorial.html\">dedicated tutorial</a>.</p>\n\n<p>To refine the genome annotation, you can also use <strong>Apollo</strong> and our <a href=\"/training-material/topics/genome-annotation/tutorials/apollo/tutorial.html\">tutorial</a>.</p>\n"],"ref_slides":[],"hands_on":true,"slides":false,"mod_date":"2024-03-13 15:39:01 +0000","pub_date":"2024-02-01 10:04:54 +0000","version":8,"workflows":[{"workflow":"Bacterial-Genome-Annotation.ga","tests":true,"url":"https://training.galaxyproject.org/training-material/topics/genome-annotation/tutorials/bacterial-genome-annotation/workflows/Bacterial-Genome-Annotation.ga","path":"topics/genome-annotation/tutorials/bacterial-genome-annotation/workflows/Bacterial-Genome-Annotation.ga","wfid":"genome-annotation-bacterial-genome-annotation","wfname":"bacterial-genome-annotation","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/genome-annotation-bacterial-genome-annotation/versions/bacterial-genome-annotation","license":"AGPL-3.0-or-later","creators":[{"class":"Person","identifier":"https://orcid.org/0000-0001-9852-1987","name":"Bérénice Batut"},{"class":"Person","identifier":"https://orcid.org/0000-0002-8304-138X","name":"Pierre Marin"}],"name":"Bacterial Genome Annotation","title":"Bacterial Genome Annotation","test_results":null,"modified":"2024-06-18 00:05:43 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\ncontigs\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"ISEScan\"];\n  0 -->|output| 1;\n  2bb672cb-4536-46b0-8a22-8590a0ca36c7[\"Output\\nisescan_results\"];\n  1 --> 2bb672cb-4536-46b0-8a22-8590a0ca36c7;\n  style 2bb672cb-4536-46b0-8a22-8590a0ca36c7 stroke:#2c3143,stroke-width:4px;\n  2[\"PlasmidFinder\"];\n  0 -->|output| 2;\n  614064e6-4b0f-4e38-b04e-e3f61ba41b46[\"Output\\nplasmidfinder_results\"];\n  2 --> 614064e6-4b0f-4e38-b04e-e3f61ba41b46;\n  style 614064e6-4b0f-4e38-b04e-e3f61ba41b46 stroke:#2c3143,stroke-width:4px;\n  3[\"Integron Finder\"];\n  0 -->|output| 3;\n  d26788cf-2441-4f29-ac39-b6be96f192eb[\"Output\\nintegronfinder_summary\"];\n  3 --> d26788cf-2441-4f29-ac39-b6be96f192eb;\n  style d26788cf-2441-4f29-ac39-b6be96f192eb stroke:#2c3143,stroke-width:4px;\n  4[\"Bakta\"];\n  0 -->|output| 4;\n  d3a40a8b-1bd1-42b6-a91e-756379b86d94[\"Output\\nbakta_summary\"];\n  4 --> d3a40a8b-1bd1-42b6-a91e-756379b86d94;\n  style d3a40a8b-1bd1-42b6-a91e-756379b86d94 stroke:#2c3143,stroke-width:4px;\n  5[\"Group\"];\n  1 -->|all_results| 5;\n  6[\"Group\"];\n  1 -->|all_results| 6;\n  7[\"Replace Text\"];\n  2 -->|result_file| 7;\n  8[\"Select last\"];\n  7 -->|outfile| 8;\n  9[\"Table to GFF3\"];\n  8 -->|outfile| 9;\n  10[\"JBrowse\"];\n  0 -->|output| 10;\n  4 -->|annotation_gff3| 10;\n  9 -->|output| 10;\n  1 -->|annotation| 10;"}],"api":"https://training.galaxyproject.org/training-material/api/topics/genome-annotation/tutorials/bacterial-genome-annotation/tutorial.json","tools":["Grouping1","toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_replace_in_column/1.1.3","toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_tail_tool/1.1.0","toolshed.g2.bx.psu.edu/repos/iuc/bakta/bakta/1.8.2+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/integron_finder/integron_finder/2.0.2+galaxy1","toolshed.g2.bx.psu.edu/repos/iuc/isescan/isescan/1.7.2.3+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/jbrowse/jbrowse/1.16.11+galaxy1","toolshed.g2.bx.psu.edu/repos/iuc/plasmidfinder/plasmidfinder/2.1.6+galaxy1","toolshed.g2.bx.psu.edu/repos/iuc/tbl2gff3/tbl2gff3/1.2","upload1"],"supported_servers":{"exact":[{"url":"https://galaxy.mesocentre.uca.fr","name":"Galaxy@AuBi","usegalaxy":false},{"url":"https://usegalaxy.cz/","name":"UseGalaxy.cz","usegalaxy":false},{"url":"https://usegalaxy.eu","name":"UseGalaxy.eu","usegalaxy":true},{"url":"https://usegalaxy.fr/","name":"UseGalaxy.fr","usegalaxy":false}],"inexact":[]},"topic_name_human":"Genome Annotation","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"text_processing","owner":"bgruening","revisions":"d698c222f354","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"text_processing","owner":"bgruening","revisions":"d698c222f354","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"bakta","owner":"iuc","revisions":"728dacaf08a9","tool_panel_section_label":"Annotation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"integron_finder","owner":"iuc","revisions":"4768f7f8e93f","tool_panel_section_label":"Annotation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"isescan","owner":"iuc","revisions":"19f42b3ea391","tool_panel_section_label":"Annotation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"jbrowse","owner":"iuc","revisions":"a6e57ff585c0","tool_panel_section_label":"Graph/Display Data","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"plasmidfinder","owner":"iuc","revisions":"7075b7a5441b","tool_panel_section_label":"Annotation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"tbl2gff3","owner":"iuc","revisions":"4a7f4b0cc0a3","tool_panel_section_label":"Annotation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: text_processing\n  owner: bgruening\n  revisions: d698c222f354\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: text_processing\n  owner: bgruening\n  revisions: d698c222f354\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bakta\n  owner: iuc\n  revisions: 728dacaf08a9\n  tool_panel_section_label: Annotation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: integron_finder\n  owner: iuc\n  revisions: 4768f7f8e93f\n  tool_panel_section_label: Annotation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: isescan\n  owner: iuc\n  revisions: 19f42b3ea391\n  tool_panel_section_label: Annotation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: jbrowse\n  owner: iuc\n  revisions: a6e57ff585c0\n  tool_panel_section_label: Graph/Display Data\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: plasmidfinder\n  owner: iuc\n  revisions: 7075b7a5441b\n  tool_panel_section_label: Annotation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: tbl2gff3\n  owner: iuc\n  revisions: 4a7f4b0cc0a3\n  tool_panel_section_label: Annotation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":false,"slides_recordings":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial","contributors":[{"name":"Bérénice Batut","email":"berenice.batut@gmail.com","twitter":"bebatut","linkedin":"berenicebatut","matrix":"bebatut:matrix.org","orcid":"0000-0001-9852-1987","joined":"2017-09","elixir_node":"fr","contact_for_training":true,"location":{"country":"FR","lat":45.77,"lon":3.08},"fediverse":"https://piaille.fr/@bebatut","fediverse_flavor":"mastodon","affiliations":["gallantries","ifb","elixir-europe"],"id":"bebatut","url":"https://training.galaxyproject.org/training-material/api/contributors/bebatut.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/bebatut/"},{"name":"ABRomics","github":false,"joined":"2024-01","avatar":"/training-material/assets/images/abromics.png","url":"https://training.galaxyproject.org/training-material/api/funders/abromics.json","funder":true,"id":"abromics","page":"https://training.galaxyproject.org/training-material/hall-of-fame/abromics/"}]}