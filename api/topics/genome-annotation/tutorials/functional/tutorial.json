{"layout":"tutorial_hands_on","title":"Functional annotation of protein sequences","zenodo_link":"https://zenodo.org/record/6861851","tags":["eukaryote"],"questions":["How to perform functional annotation on protein sequences?"],"objectives":["Perform functional annotation using EggNOG-mapper and InterProScan"],"time_estimation":"1h","level":"Introductory","key_points":["EggNOG Mapper compares sequences to a database of annotated orthologous sequences","InterProScan detects known motifs in protein sequences"],"contributions":{"authorship":["abretaud"],"funding":["gallantries","eurosciencegateway"]},"subtopic":"eukaryote","priority":6,"js_requirements":{"mathjax":null,"mermaid":false},"short_id":"T00173","url":"/topics/genome-annotation/tutorials/functional/tutorial.html","topic_name":"genome-annotation","tutorial_name":"functional","dir":"topics/genome-annotation/tutorials/functional","symlink":null,"id":"genome-annotation/functional","ref_tutorials":["<p>When performing the structural annotation of a genome sequence, you get the position of each gene, but you don’t have information about their name of their function. That’s the goal of <strong>functional annotation</strong>.</p>\n\n<p>In this short tutorial, we will run the most commonly used tools to perform functional annotation, starting from the predicted protein sequences of a few example genes.</p>\n\n<p>For a more complete view of how this step integrates into a whole genome sequencing and annotation process, you can have a look at the <a href=\"/training-material/topics/genome-annotation/tutorials/funannotate/tutorial.html\">Funannotate tutorial</a>.</p>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n  <p>In this tutorial, we will cover:</p>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#data-upload\" id=\"markdown-toc-data-upload\">Data upload</a></li>\n  <li><a href=\"#functional-annotation\" id=\"markdown-toc-functional-annotation\">Functional annotation</a>    <ol>\n      <li><a href=\"#eggnog-mapper\" id=\"markdown-toc-eggnog-mapper\">EggNOG Mapper</a></li>\n      <li><a href=\"#interproscan\" id=\"markdown-toc-interproscan\">InterProScan</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#conclusion\" id=\"markdown-toc-conclusion\">Conclusion</a></li>\n</ol>\n\n</blockquote>\n\n<h1 id=\"data-upload\">Data upload</h1>\n\n<p>We will annotate a small set of <strong>protein sequences</strong>. These sequences were predicted from the gene structures obtained in the <a href=\"/training-material/topics/genome-annotation/tutorials/funannotate/tutorial.html\">Funannotate tutorial</a>? Though these sequences from from a fungal species, you can run the same tools on proteins from any organisms, including prokaryotes.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Data upload</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Create a new history for this tutorial</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-new-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-new-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a new history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>Click the <i class=\"fas fa-plus\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">new-history</span> icon at the top of the history panel:</p>   <p><img src=\"/training-material/shared/images/history_create_new.svg\" alt=\"UI for creating new history\" /></p>   <!-- the original drawing can be found here https://docs.google.com/drawings/d/1cCBrLAo4kDGic5QyB70rRiWJAKTenTU8STsKDaLcVU8/edit?usp=sharing --> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Import the files from <a href=\"https://zenodo.org/record/6861851\">Zenodo</a> or from\nthe shared data library (<code class=\"language-plaintext highlighter-rouge\">GTN - Material</code> -&gt; <code class=\"language-plaintext highlighter-rouge\">genome-annotation</code>\n -&gt; <code class=\"language-plaintext highlighter-rouge\">Functional annotation of protein sequences</code>):</p>\n\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/6861851/files/proteins.fasta\n</code></pre></div>      </div>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-via-links\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-via-links\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing via links</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-data-from-a-data-library\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-data-from-a-data-library\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing data from a data library</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>As an alternative to uploading the data from a URL or your computer, the files may also have been made available from a <em>shared data library</em>:</p>   <ol>   <li>Go into <strong>Shared data</strong> (top panel) then <strong>Data libraries</strong></li>   <li>Navigate to  the correct folder as indicated by your instructor.     <ul>       <li>On most Galaxies tutorial data will be provided in a folder named <strong>GTN - Material –&gt; Topic Name -&gt; Tutorial Name</strong>.</li>     </ul>   </li>   <li>Select the desired files</li>   <li>Click on <strong>Add to History</strong> <i class=\"fas fa-caret-down\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-dropdown</span> near the top and select <strong>as Datasets</strong> from the dropdown menu</li>   <li>     <p>In the pop-up window, choose</p>     <ul>       <li><em>“Select history”</em>: the history you want to import the data to (or create a new one)</li>     </ul>   </li>   <li>Click on <strong>Import</strong></li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h1 id=\"functional-annotation\">Functional annotation</h1>\n\n<h2 id=\"eggnog-mapper\">EggNOG Mapper</h2>\n\n<p><strong>EggNOG Mapper</strong> compares each protein sequence of the annotation to a huge set of ortholog groups from the <a href=\"http://eggnog5.embl.de\">EggNOG database</a>. In this database, each ortholog group is associated with functional annotation like <a href=\"http://www.geneontology.org/\">Gene Ontology (GO)</a> terms or <a href=\"https://www.genome.jp/kegg/pathway.html\">KEGG pathways</a>. When the protein sequence of a new gene is found to be very similar to one of these ortholog groups, the corresponding functional annotation is transfered to this new gene.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title></hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/galaxyp/eggnog_mapper/eggnog_mapper/2.1.8+galaxy3\" title=\"eggNOG Mapper tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>eggNOG Mapper</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.1.8+galaxy3)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Fasta sequences to annotate”</em>: <code class=\"language-plaintext highlighter-rouge\">proteins.fasta</code> (Input dataset)</li>\n        <li><em>“Version of eggNOG Database”</em>: select the latest version available</li>\n        <li>In <em>“Output Options”</em>:\n          <ul>\n            <li><em>“Exclude header lines and stats from output files”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>The output of this tool is a tabular file, where each line represents a gene from our annotation, with the functional annotation that was found by EggNOG-mapper. It includes a predicted protein name, GO terms, EC numbers, KEGG identifiers, …</p>\n\n<p>Display the file and explore which kind of identifiers were found by EggNOG Mapper.</p>\n\n<h2 id=\"interproscan\">InterProScan</h2>\n\n<p><a href=\"https://www.ebi.ac.uk/interpro/\">InterPro</a> is a huge integrated database of protein families. Each family is characterized by one or muliple signatures (i.e. sequence motifs) that are specific to the protein family, and corresponding functional annotation like protein names or <a href=\"http://www.geneontology.org/\">Gene Ontology (GO)</a>. A good proportion of the signatures are manually curated, which means they are of very good quality.</p>\n\n<p><strong>InterProScan</strong> is a tool that analyses each protein sequence from our annotation to determine if they contain one or several of the signatures from InterPro. When a protein contains a known signature, the corresponding functional annotation will be assigned to it by <strong>InterProScan</strong>.</p>\n\n<p><strong>InterProScan</strong> itself runs multiple applications to search for the signatures in the protein sequences. It is possible to select exactly which ones we want to use when launching the analysis (by default all will be run).</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title></hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/interproscan/interproscan/5.59-91.0+galaxy3\" title=\"InterProScan tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>InterProScan</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 5.59-91.0+galaxy3)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Protein FASTA File”</em>: <code class=\"language-plaintext highlighter-rouge\">proteins.fasta</code> (Input dataset)</li>\n        <li><em>“InterProScan database”</em>: select the latest version available</li>\n        <li><em>“Use applications with restricted license, only for non-commercial use?”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code> (set it to <code class=\"language-plaintext highlighter-rouge\">No</code> if you run InterProScan for commercial use)</li>\n        <li><em>“Output format”</em>: <code class=\"language-plaintext highlighter-rouge\">Tab-separated values format (TSV)</code> and <code class=\"language-plaintext highlighter-rouge\">XML</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"comment\">\n  <comment-title></comment-title>\n\n  <p>To speed up the processing by InterProScan during this tutorial, you can disable <code class=\"language-plaintext highlighter-rouge\">Pfam</code> and <code class=\"language-plaintext highlighter-rouge\">PANTHER</code> applications. When analysing real data, it is adviced to keep them enabled.</p>\n\n  <p>When some applications are disabled, you will of course miss the corresponding results in the output of <strong>InterProScan</strong>.</p>\n</blockquote>\n\n<p>The output of this tool is both a tabular file and an XML file. Both contain the same information, but the tabular one is more readable for a Human: each line represents a gene from our annotation, with the different domains and motifs that were found by InterProScan.</p>\n\n<p>If you display the TSV file you should see something like this:</p>\n\n<p><img src=\"../../images/interproscan_output.png\" alt=\"InterProScan TSV output\" title=\"Extract of an InterProScan TSV output\" /></p>\n\n<p>Each line correspond to a motif found in one of the annotated proteins. The most interesting columns are:</p>\n\n<ul>\n  <li>Column 1: the protein identifier</li>\n  <li>Column 5: the identifier of the signature that was found in the protein sequence</li>\n  <li>Column 4: the databank where this signature comes from (InterProScan regroups several motifs databanks)</li>\n  <li>Column 6: the human readable description of the motif</li>\n  <li>Columns 7 and 8: the position where the motif was found</li>\n  <li>Column 9: a score for the match (if available)</li>\n  <li>Column 12 and 13: identifier of the signature integrated in InterPro (if available). Have a look an example webpage for <a href=\"https://www.ebi.ac.uk/interpro/entry/InterPro/IPR036859/\">IPR036859</a> on InterPro.</li>\n  <li>The following columns contains various identifiers that were assigned to the protein based on the match with the signature (Gene ontology term, Reactome, …)</li>\n</ul>\n\n<p>The XML output file contains the same information in a computer-friendly format, we will use it in the next step.</p>\n\n<h1 id=\"conclusion\">Conclusion</h1>\n\n<p>Congratulations for reaching the end of this tutorial! Now you know how to perform the functional annotation of a set of protein sequences, using EggNOG mapper and InterProScan.</p>\n\n<p>If you want to collect more functional annotation, you can try to run the <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/devteam/ncbi_blast_plus/ncbi_blastp_wrapper/2.10.1+galaxy2\" title=\"NCBI BLAST+ blastp tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>NCBI BLAST+ blastp</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.10.1+galaxy2)</span> or <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/diamond/bg_diamond/2.0.15+galaxy0\" title=\"Diamond tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Diamond</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.0.15+galaxy0)</span> tools against the UniProt or NR databases (Diamond runs much faster on big datasets). These tools will search for similarities between your protein sequences and the ones already described in big international databases.</p>\n\n<p>Also note that many other more specialised tools exist to collect even more functional annotation, in particular for certain species (prokaryotes forexample), or enzyme/protein families.</p>\n"],"ref_slides":[],"hands_on":true,"slides":false,"mod_date":"2024-01-08 15:22:52 +0000","pub_date":"2022-07-20 18:34:12 +0000","version":17,"workflows":[{"workflow":"functional.ga","tests":true,"url":"https://training.galaxyproject.org/training-material/topics/genome-annotation/tutorials/functional/workflows/functional.ga","path":"topics/genome-annotation/tutorials/functional/workflows/functional.ga","wfid":"genome-annotation-functional","wfname":"functional","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/genome-annotation-functional/versions/functional","license":"GPL-3.0-or-later","creators":[{"class":"Person","identifier":"https://orcid.org/0000-0003-0914-2470","name":"Anthony Bretaudeau"}],"name":"Functional annotation","title":"Functional annotation","test_results":null,"modified":"2024-06-17 13:05:35 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\nProtein sequences\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"eggNOG Mapper\"];\n  0 -->|output| 1;\n  2[\"InterProScan\"];\n  0 -->|output| 2;"}],"api":"https://training.galaxyproject.org/training-material/api/topics/genome-annotation/tutorials/functional/tutorial.json","tools":["toolshed.g2.bx.psu.edu/repos/bgruening/diamond/bg_diamond/2.0.15+galaxy0","toolshed.g2.bx.psu.edu/repos/bgruening/interproscan/interproscan/5.59-91.0+galaxy3","toolshed.g2.bx.psu.edu/repos/devteam/ncbi_blast_plus/ncbi_blastp_wrapper/2.10.1+galaxy2","toolshed.g2.bx.psu.edu/repos/galaxyp/eggnog_mapper/eggnog_mapper/2.1.8+galaxy3"],"supported_servers":{"exact":[{"url":"https://usegalaxy.cz/","name":"UseGalaxy.cz","usegalaxy":false},{"url":"https://usegalaxy.eu","name":"UseGalaxy.eu","usegalaxy":true},{"url":"https://usegalaxy.fr/","name":"UseGalaxy.fr","usegalaxy":false},{"url":"https://usegalaxy.org","name":"UseGalaxy.org (Main)","usegalaxy":true},{"url":"https://usegalaxy.org.au","name":"UseGalaxy.org.au","usegalaxy":true}],"inexact":[{"url":"https://usegalaxy.no/","name":"UseGalaxy.no","usegalaxy":false}]},"topic_name_human":"Genome Annotation","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"diamond","owner":"bgruening","revisions":"e8ac2b53f262","tool_panel_section_label":"NCBI Blast","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"interproscan","owner":"bgruening","revisions":"74810db257cc","tool_panel_section_label":"Annotation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"ncbi_blast_plus","owner":"devteam","revisions":"0e3cf9594bb7","tool_panel_section_label":"NCBI Blast","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"eggnog_mapper","owner":"galaxyp","revisions":"844fa988236b","tool_panel_section_label":"Proteomics","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: diamond\n  owner: bgruening\n  revisions: e8ac2b53f262\n  tool_panel_section_label: NCBI Blast\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: interproscan\n  owner: bgruening\n  revisions: 74810db257cc\n  tool_panel_section_label: Annotation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: ncbi_blast_plus\n  owner: devteam\n  revisions: 0e3cf9594bb7\n  tool_panel_section_label: NCBI Blast\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: eggnog_mapper\n  owner: galaxyp\n  revisions: 844fa988236b\n  tool_panel_section_label: Proteomics\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":false,"slides_recordings":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial","contributors":[{"name":"Anthony Bretaudeau","email":"anthony.bretaudeau@inrae.fr","twitter":"abretau","matrix":"abretaud:matrix.org","orcid":"0000-0003-0914-2470","joined":"2017-09","elixir_node":"fr","contact_for_training":true,"location":{"country":"FR","lat":48.11,"lon":-1.64},"fediverse":"https://genomic.social/@abretaud","fediverse_flavor":"mastodon","affiliations":["gallantries","eurosciencegateway","elixir-europe"],"id":"abretaud","url":"https://training.galaxyproject.org/training-material/api/contributors/abretaud.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/abretaud/"},{"name":"Gallantries: Bridging Training Communities in Life Science, Environment and Health","short_name":"Gallantries","start_date":"2020-09-01","end_date":"2023-09-30","joined":"2020-09","avatar":"https://gallantries.github.io/assets/images/gallantries-logo.png","github":false,"funder":true,"url":"https://training.galaxyproject.org/training-material/api/funders/gallantries.json","funder_name":"Erasmus+ Programme","funding_id":"2020-1-NL01-KA203-064717","funding_system":"erasmusplus","funding_statement":"This project (<a href=\"https://erasmus-plus.ec.europa.eu/projects/search/details/2020-1-NL01-KA203-064717\"><code class=\"language-plaintext highlighter-rouge\">2020-1-NL01-KA203-064717</code></a>) is funded with the support of the Erasmus+ programme of the European Union. Their funding has supported a large number of tutorials within the GTN across a wide array of topics.\n<img src=\"https://gallantries.github.io/assets/images/logosbeneficaireserasmusright_en.jpg\" alt=\"eu flag with the text: with the support of the erasmus programme of the european union\" />\n<img src=\"https://www.erasmusplus.nl/assets/images/logo.png\" alt=\"erasmus plus logo\" />","members":["abretaud","bebatut","colineroyaux","fpsom","hexylena","shiltemann","yvanlebras"],"id":"gallantries","page":"https://training.galaxyproject.org/training-material/hall-of-fame/gallantries/"},{"name":"EuroScienceGateway","github":false,"joined":"2023-10","avatar":"/training-material/assets/images/eurosciencegateway.png","url":"https://training.galaxyproject.org/training-material/api/funders/eurosciencegateway.json","funder":true,"funding_id":"101057388","funding_system":"cordis","funding_statement":"EuroScienceGateway was funded by the European Union programme Horizon Europe (HORIZON-INFRA-2021-EOSC-01-04) under grant agreement number 101057388 and by UK Research and Innovation (UKRI) under the UK government’s Horizon Europe funding guarantee grant number 10038963.","members":["abretaud","anuprulez","bgruening","erxleben","pauldg","rlibouba"],"id":"eurosciencegateway","page":"https://training.galaxyproject.org/training-material/hall-of-fame/eurosciencegateway/"}]}