{"layout":"tutorial_hands_on","title":"ATAC-Seq data analysis","zenodo_link":"https://zenodo.org/record/3862793","questions":["Which DNA regions are accessible in the human lymphoblastoid cell line GM12878?","How to analyse and visualise ATAC-Seq data?"],"objectives":["Apply appropriate analysis and quality control steps for ATAC-Seq","Generate a heatmap of transcription start site accessibility","Visualise peaks for specific regions"],"time_estimation":"3h","key_points":["ATAC-Seq can be used to identify accessible gene promoters and enhancers","Several filters are applied to the reads, such as removing those mapped to mitochondria","Fragment distribution can help determine whether an ATAC-Seq experiment has worked well"],"contributors":[{"name":"Lucille Delisle","email":"lucille.delisle@epfl.ch","orcid":"0000-0002-1964-4960","joined":"2019-08","elixir_node":"ch","contact_for_training":true,"location":{"country":"CH","lat":46.52,"lon":6.56},"affiliations":["elixir-europe"],"id":"lldelisle","url":"https://training.galaxyproject.org/training-material/api/contributors/lldelisle.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/lldelisle/"},{"name":"Maria Doyle","joined":"2018-09","orcid":"0000-0003-4847-8436","id":"mblue9","url":"https://training.galaxyproject.org/training-material/api/contributors/mblue9.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/mblue9/"},{"name":"Florian Heyl","joined":"2018-08","elixir_node":"de","orcid":"0000-0002-3651-5685","former_affiliations":["uni-freiburg","elixir-europe"],"id":"heylf","url":"https://training.galaxyproject.org/training-material/api/contributors/heylf.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/heylf/"}],"recordings":[{"captioners":["hrhotz"],"date":"2021-02-15","galaxy_version":"21.01","length":"1H50M","youtube_id":"Zc-bl6ZfcX4","speakers":["heylf"]}],"js_requirements":{"mathjax":null,"mermaid":false},"short_id":"T00137","url":"/topics/epigenetics/tutorials/atac-seq/tutorial.html","topic_name":"epigenetics","tutorial_name":"atac-seq","dir":"topics/epigenetics/tutorials/atac-seq","symlink":null,"id":"epigenetics/atac-seq","ref_tutorials":["<p>In many eukaryotic organisms, such as humans, the genome is tightly packed and organized with the help of nucleosomes (chromatin). A nucleosome is a complex formed by eight histone proteins that is wrapped with ~147bp of DNA. When the DNA is being actively transcribed into RNA, the DNA will be opened and loosened from the nucleosome complex. Many factors, such as the chromatin structure, the position of the nucleosomes, and histone modifications, play an important role in the organization and accessibility of the DNA. Consequently, these factors are also important for the activation and inactivation of genes. <strong>A</strong>ssay for <strong>T</strong>ransposase-<strong>A</strong>ccessible <strong>C</strong>hromatin using <strong>seq</strong>uencing (<a href=\"https://en.wikipedia.org/wiki/ATAC-seq\">ATAC-Seq</a>) is a method to investigate the accessibility of chromatin and thus a method to determine regulatory mechanisms of gene expression. The method can help identify promoter regions and potential enhancers and silencers. A promoter is the DNA region close to the transcription start site (TSS). It contains binding sites for transcription factors that will recruit the RNA polymerase. An enhancer is a DNA region that can be located up to 1 Mb downstream or upstream of the promoter. When transcription factors bind an enhancer and contact a promoter region, the transcription of the gene is increased. In contrast, a silencer decreases or inhibits the gene’s expression. ATAC-Seq has become popular for identifying accessible regions of the genome as it’s easier, faster and requires less cells than alternative techniques, such as FAIRE-Seq and DNase-Seq.</p>\n\n<figure id=\"figure-1\" style=\"max-width: 90%;\"><img src=\"../../images/atac-seq/atac-seq.jpeg\" alt=\"ATAC-Seq. \" width=\"617\" height=\"616\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/atac-seq/atac-seq.jpeg\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 1</strong>:</span> Buenrostro et al. 2013 Nat Methods</figcaption></figure>\n\n<p>With ATAC-Seq, to find accessible (open) chromatin regions, the genome is treated with a hyperactive derivative of the Tn5 transposase. A <a href=\"https://en.wikipedia.org/wiki/Transposase\">transposase</a> can bind to a <a href=\"https://en.wikipedia.org/wiki/Transposable_element\">transposable element</a>, which is a DNA sequence that can change its position (jump) within a genome (read the two links to get a deeper insight). During ATAC-Seq, the modified Tn5 inserts DNA sequences corresponding to truncated Nextera adapters into open regions of the genome and concurrently, the DNA is sheared by the transposase activity. The read library is then prepared for sequencing, including PCR amplification with full Nextera adapters and purification steps. Paired-end reads are recommended for ATAC-Seq for the reasons described <a href=\"https://informatics.fas.harvard.edu/atac-seq-guidelines.html\">in their guidelines</a>.</p>\n\n<p>In this tutorial we will use data from the study of <span class=\"citation\"><a href=\"#Buenrostro2013\">Buenrostro <i>et al.</i> 2013</a></span>, the first paper on the ATAC-Seq method. The data is from a human cell line of purified CD4+ T cells, called GM12878. The original dataset had 2 x 200 million reads and would be too big to process in a training session, so we downsampled the original dataset to 200,000 randomly selected reads. We also added about 200,000 reads pairs that will map to chromosome 22 to have a good profile on this chromosome, similar to what you might get with a typical ATAC-Seq sample (2 x 20 million reads in original FASTQ). Furthermore, we want to compare the predicted open chromatin regions to the known binding sites of CTCF, a DNA-binding protein implicated in 3D structure: <a href=\"https://en.wikipedia.org/wiki/CTCF\">CTCF</a>. CTCF is known to bind to thousands of sites in the genome and thus it can be used as a positive control for assessing if the ATAC-Seq experiment is good quality. Good ATAC-Seq data would have accessible regions both within and outside of TSS, for example, at some CTCF binding sites. For that reason, we will download binding sites of CTCF identified by ChIP in the same cell line from ENCODE (ENCSR000AKB, dataset ENCFF933NTR).</p>\n\n<h2 id=\"when-working-with-real-data\">When working with real data</h2>\n\n<p>When you use your own data we suggest you to use <a href=\"https://usegalaxy.eu/u/ldelisle/w/atac-seq-gtm-with-control\">this workflow</a> which includes the same steps but is compatible with replicates. If you do not have any control data you can import and edit this workflow, removing all steps with the controls. Controls for the ATAC-Seq procedure are not commonly performed, as discussed <a href=\"https://informatics.fas.harvard.edu/atac-seq-guidelines.html\">in the guidelines</a>, but could be ATAC-Seq of purified DNA.</p>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n  <p>In this tutorial, we will cover:</p>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#when-working-with-real-data\" id=\"markdown-toc-when-working-with-real-data\">When working with real data</a></li>\n  <li><a href=\"#preprocessing\" id=\"markdown-toc-preprocessing\">Preprocessing</a>    <ol>\n      <li><a href=\"#get-data\" id=\"markdown-toc-get-data\">Get Data</a></li>\n      <li><a href=\"#quality-control\" id=\"markdown-toc-quality-control\">Quality Control</a></li>\n      <li><a href=\"#trimming-reads\" id=\"markdown-toc-trimming-reads\">Trimming Reads</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#mapping\" id=\"markdown-toc-mapping\">Mapping</a>    <ol>\n      <li><a href=\"#mapping-reads-to-reference-genome\" id=\"markdown-toc-mapping-reads-to-reference-genome\">Mapping Reads to Reference Genome</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#filtering-mapped-reads\" id=\"markdown-toc-filtering-mapped-reads\">Filtering Mapped Reads</a>    <ol>\n      <li><a href=\"#filter-uninformative-reads\" id=\"markdown-toc-filter-uninformative-reads\">Filter Uninformative Reads</a></li>\n      <li><a href=\"#filter-duplicate-reads\" id=\"markdown-toc-filter-duplicate-reads\">Filter Duplicate Reads</a></li>\n      <li><a href=\"#check-insert-sizes\" id=\"markdown-toc-check-insert-sizes\">Check Insert Sizes</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#peak-calling\" id=\"markdown-toc-peak-calling\">Peak calling</a>    <ol>\n      <li><a href=\"#call-peaks\" id=\"markdown-toc-call-peaks\">Call Peaks</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#visualisation-of-coverage\" id=\"markdown-toc-visualisation-of-coverage\">Visualisation of Coverage</a>    <ol>\n      <li><a href=\"#prepare-the-datasets\" id=\"markdown-toc-prepare-the-datasets\">Prepare the Datasets</a></li>\n      <li><a href=\"#create-heatmap-of-coverage-at-tss-with-deeptools\" id=\"markdown-toc-create-heatmap-of-coverage-at-tss-with-deeptools\">Create heatmap of coverage at TSS with deepTools</a></li>\n      <li><a href=\"#visualise-regions-with-pygenometracks\" id=\"markdown-toc-visualise-regions-with-pygenometracks\">Visualise Regions with pyGenomeTracks</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#conclusion\" id=\"markdown-toc-conclusion\">Conclusion</a></li>\n</ol>\n\n</blockquote>\n\n<!--SNIPPET-->\n<blockquote class=\"comment\">   <div class=\"box-title comment-title\" id=\"comment-results-may-vary\"><i class=\"far fa-comment-dots\" aria-hidden=\"true\"></i> Comment: Results may vary</div>   <p>Your results may be slightly different from the ones presented in this tutorial due to differing versions of tools, reference data, external databases, or because of stochastic processes in the algorithms.</p> </blockquote>\n<p><!--END_SNIPPET--></p>\n\n<h1 id=\"preprocessing\">Preprocessing</h1>\n\n<h2 id=\"get-data\">Get Data</h2>\n\n<p>We first need to download the sequenced reads (FASTQs) as well as other annotation files. Then, to increase the number of reads that will map to the reference genome (here human genome version 38, GRCh38/hg38), we need to preprocess the reads.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Data upload</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Create a new history for this tutorial</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-new-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-new-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a new history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>Click the <i class=\"fas fa-plus\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">new-history</span> icon at the top of the history panel:</p>   <p><img src=\"/training-material/shared/images/history_create_new.svg\" alt=\"UI for creating new history\" /></p>   <!-- the original drawing can be found here https://docs.google.com/drawings/d/1cCBrLAo4kDGic5QyB70rRiWJAKTenTU8STsKDaLcVU8/edit?usp=sharing --> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Import the files from <a href=\"https://doi.org/10.5281/zenodo.3862792\">Zenodo</a> or from\nthe shared data library (<code class=\"language-plaintext highlighter-rouge\">GTN - Material</code> -&gt; <code class=\"language-plaintext highlighter-rouge\">epigenetics</code>\n -&gt; <code class=\"language-plaintext highlighter-rouge\">ATAC-Seq data analysis</code>):</p>\n\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/3862793/files/ENCFF933NTR.bed.gz\nhttps://zenodo.org/record/3862793/files/SRR891268_chr22_enriched_R1.fastq.gz\nhttps://zenodo.org/record/3862793/files/SRR891268_chr22_enriched_R2.fastq.gz\n</code></pre></div>      </div>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-via-links\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-via-links\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing via links</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-data-from-a-data-library\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-data-from-a-data-library\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing data from a data library</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>As an alternative to uploading the data from a URL or your computer, the files may also have been made available from a <em>shared data library</em>:</p>   <ol>   <li>Go into <strong>Shared data</strong> (top panel) then <strong>Data libraries</strong></li>   <li>Navigate to  the correct folder as indicated by your instructor.     <ul>       <li>On most Galaxies tutorial data will be provided in a folder named <strong>GTN - Material –&gt; Topic Name -&gt; Tutorial Name</strong>.</li>     </ul>   </li>   <li>Select the desired files</li>   <li>Click on <strong>Add to History</strong> <i class=\"fas fa-caret-down\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-dropdown</span> near the top and select <strong>as Datasets</strong> from the dropdown menu</li>   <li>     <p>In the pop-up window, choose</p>     <ul>       <li><em>“Select history”</em>: the history you want to import the data to (or create a new one)</li>     </ul>   </li>   <li>Click on <strong>Import</strong></li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Add a tag called <code class=\"language-plaintext highlighter-rouge\">#SRR891268_R1</code> to the R1 file and a tag called <code class=\"language-plaintext highlighter-rouge\">#SRR891268_R2</code> to the R2 file.</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-adding-a-tag\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-adding-a-tag\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Adding a tag</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ol>   <li>Click on the dataset to expand it</li>   <li>Click on <strong>Add Tags</strong> <i class=\"fas fa-tags\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-tags</span></li>   <li>Add a tag  starting with <code class=\"language-plaintext highlighter-rouge\">#</code>     <ul>       <li>Tags starting with <code class=\"language-plaintext highlighter-rouge\">#</code> will be automatically propagated to the outputs of tools using this dataset.</li>     </ul>   </li>   <li>Press <kbd>Enter</kbd></li>   <li>Check that the tag appears below the dataset name</li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Check that the datatype of the 2 FASTQ files is <code class=\"language-plaintext highlighter-rouge\">fastqsanger.gz</code> and the peak file (ENCFF933NTR.bed.gz) is <code class=\"language-plaintext highlighter-rouge\">encodepeak</code>. If they are not then change the datatype as described below.</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-changing-the-datatype\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-changing-the-datatype\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Changing the datatype</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, click <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Datatypes</strong> tab on the top</li>   <li>In the <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Assign Datatype</strong>, select <code class=\"language-plaintext highlighter-rouge\">datatypes</code> from “<em>New type</em>” dropdown     <ul>       <li>Tip: you can start typing the datatype into the field to filter the dropdown menu</li>     </ul>   </li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"comment\">\n  <comment-title>FASTQ format</comment-title>\n  <p>If you are not familiar with FASTQ format, see the <a href=\"/training-material/topics/sequence-analysis/tutorials/quality-control/tutorial.html\">Quality Control tutorial</a></p>\n</blockquote>\n<blockquote class=\"comment\">\n\n  <comment-title>BED / encode narrowPeak format</comment-title>\n  <p>If you are not familiar with BED format or encode narrowPeak format, see the <a href=\"https://genome.ucsc.edu/FAQ/FAQformat.html\">BED Format</a></p>\n</blockquote>\n\n<p>We will visualise regions later in the analysis and obtain the gene information now. We will get information for chromosome 22 genes (names of transcripts and genomic positions) using the UCSC tool.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Obtain Annotation for hg38 genes</hands-on-title>\n\n  <ol>\n    <li><span><strong>UCSC Main table browser</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i></span> with the following parameters:\n      <ul>\n        <li><em>“clade”</em>: <code class=\"language-plaintext highlighter-rouge\">Mammal</code></li>\n        <li><em>“genome”</em>: <code class=\"language-plaintext highlighter-rouge\">Human</code></li>\n        <li><em>“assembly”</em>: <code class=\"language-plaintext highlighter-rouge\">Dec. 2013 (GRCh38/hg38)</code></li>\n        <li><em>“group”</em>: <code class=\"language-plaintext highlighter-rouge\">Genes and Gene Prediction</code></li>\n        <li><em>“track”</em>: <code class=\"language-plaintext highlighter-rouge\">All GENCODE V37</code></li>\n        <li><em>“table”</em>: <code class=\"language-plaintext highlighter-rouge\">Basic</code></li>\n        <li><em>“region”</em>: <code class=\"language-plaintext highlighter-rouge\">position</code> <code class=\"language-plaintext highlighter-rouge\">chr22</code></li>\n        <li><em>“output format”</em>: <code class=\"language-plaintext highlighter-rouge\">all fields from selected table</code></li>\n        <li><em>“Send output to”</em>: <code class=\"language-plaintext highlighter-rouge\">Galaxy</code></li>\n      </ul>\n    </li>\n    <li>Click <strong>get output</strong></li>\n    <li>\n      <p>Click <strong>Send query to Galaxy</strong></p>\n\n      <p>This table contains all the information but is not in a BED format. To transform it into BED format we will cut out the required columns and rearrange:</p>\n    </li>\n    <li><span class=\"tool\" data-tool=\"Cut1\" title=\"Cut columns from a table tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Cut columns from a table</strong></span> with the following parameters:\n      <ul>\n        <li><em>“Cut columns”</em>: <code class=\"language-plaintext highlighter-rouge\">c3,c5,c6,c13,c12,c4</code></li>\n        <li><em>“Delimited by”</em>: <code class=\"language-plaintext highlighter-rouge\">Tab</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“From”</em>: <code class=\"language-plaintext highlighter-rouge\">UCSC Main on Human: wgEncodeGencodeBasicV37 (chr22:1-50,818,468)</code></li>\n      </ul>\n    </li>\n    <li>\n      <p>Check the contents of your file, is this as you expect it to be?</p>\n\n      <blockquote class=\"question\">\n        <question-title>Expected output</question-title>\n\n        <p>Our goal here was to convert the data to BED format.</p>\n\n        <ol>\n          <li>Which columns do you expect in your file? (Tip: read about <a href=\"https://genome.ucsc.edu/FAQ/FAQformat.html#format1\">BED format</a>)</li>\n          <li>Does your file look like a valid BED format?</li>\n        </ol>\n\n        <blockquote class=\"solution\">\n          <solution-title></solution-title>\n\n          <ol>\n            <li>We expect at least 3 columns, <code class=\"language-plaintext highlighter-rouge\">chromosome - start - end</code>, and possibly more optional columns</li>\n            <li>Your file should look something like this:\n              <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>chr22\t10736170\t10736283\tU2\t0\t-\nchr22\t11066417\t11068174\tCU104787.1\t0\t+\nchr22\t11249808\t11249959\t5_8S_rRNA\t0\t-\nchr22\t15273854\t15273961\tU6\t0\t+\n[..]\n</code></pre></div>              </div>\n            </li>\n          </ol>\n\n          <ul>\n            <li><strong>Troubleshooting:</strong> Is your second column the <code class=\"language-plaintext highlighter-rouge\">Strand</code> column?\n              <ul>\n                <li>Make sure you used the correct <strong>Cut</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> (the one that matches the tool name mentioned in the previous step <em>exactly</em>)</li>\n                <li>There is another tool with <code class=\"language-plaintext highlighter-rouge\">(cut)</code> behind the title, we do NOT want to use this tool in this step.</li>\n              </ul>\n            </li>\n            <li><strong>Tip:</strong> Always check your output files to make sure they match your expectations!</li>\n          </ul>\n\n        </blockquote>\n\n      </blockquote>\n    </li>\n    <li>\n      <p><strong>Rename</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> the dataset as <code class=\"language-plaintext highlighter-rouge\">chr22 genes</code></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-renaming-a-dataset\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-renaming-a-dataset\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Renaming a dataset</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, change the <strong>Name</strong> field</li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p><strong>Change</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> its datatype to BED</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-changing-the-datatype-1\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-changing-the-datatype-1\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Changing the datatype</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, click <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Datatypes</strong> tab on the top</li>   <li>In the <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Assign Datatype</strong>, select <code class=\"language-plaintext highlighter-rouge\">bed</code> from “<em>New type</em>” dropdown     <ul>       <li>Tip: you can start typing the datatype into the field to filter the dropdown menu</li>     </ul>   </li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>Click on the <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> (eye) icon of the file. It should have now column names and they should match the content.</li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"comment\">\n\n  <comment-title>Gene file</comment-title>\n  <p>The chr22 genes BED we produced only contains the start, the end, the name, and the strand of each transcript. It does not contain exon information.\nTo be able to have the exon information, you could use a GTF file which can be downloaded from the <a href=\"ftp://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_37/gencode.v37.annotation.gtf.gz\">gencode website</a> but this file would include the information for the whole genome and would slow the analysis.</p>\n</blockquote>\n\n<h2 id=\"quality-control\">Quality Control</h2>\n\n<p>The first step is to check the quality of the reads and the presence of the Nextera adapters. When we perform ATAC-Seq, we can get DNA fragments of about 40 bp if two adjacent Tn5 transposases cut the DNA <span class=\"citation\"><a href=\"#Adey2010\">Adey <i>et al.</i> 2010</a></span>. This can be smaller than the sequencing length so we expect to have Nextera adapters at the end of those reads. We can assess the reads with <strong>FastQC</strong>.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Task description</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/devteam/fastqc/fastqc/0.72+galaxy1\" title=\"FastQC tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>FastQC</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.72+galaxy1)</span> with the following parameters:\n      <ul>\n        <li><em>“Short read data from your current history”</em>: Choose here either only the <code class=\"language-plaintext highlighter-rouge\">SRR891268_R1</code> file with <i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> or use <i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <strong>Multiple datasets</strong> to choose both <code class=\"language-plaintext highlighter-rouge\">SRR891268_R1</code> and <code class=\"language-plaintext highlighter-rouge\">SRR891268_R2</code>.</li>\n      </ul>\n    </li>\n    <li>Inspect the web page output of <strong>FastQC</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> for the <code class=\"language-plaintext highlighter-rouge\">SRR891268_R1</code> sample. Check what adapters are found at the end of the reads.</li>\n  </ol>\n\n  <blockquote class=\"question\">\n    <question-title></question-title>\n\n    <ol>\n      <li>How many reads are in the FASTQ?</li>\n      <li>Which sections have a warning?</li>\n    </ol>\n\n    <blockquote class=\"solution\">\n      <solution-title></solution-title>\n\n      <ol>\n        <li>There are 285247 reads.</li>\n        <li>\n          <p>The 3 steps below have warnings:</p>\n\n          <ol>\n            <li>\n              <p><strong>Per base sequence content</strong></p>\n\n              <p>It is well known that the Tn5 has a strong sequence bias at the insertion site. You can read more about it in <span class=\"citation\"><a href=\"#Green2012\">Green <i>et al.</i> 2012</a></span>.</p>\n            </li>\n            <li>\n              <p><strong>Sequence Duplication Levels</strong></p>\n\n              <p>The read library quite often has PCR duplicates that are introduced\nsimply by the PCR itself. We will remove these duplicates later on.</p>\n            </li>\n            <li>\n              <p><strong>Overrepresented sequences</strong></p>\n\n              <p>One sequence is over represented: \nyou have 306 reads which are exactly the sequence of the Nextera adapter.\nThey correspond to adapters amplified head-to-head.\n306 is really low (only 0.1% of reads).</p>\n            </li>\n          </ol>\n        </li>\n      </ol>\n\n    </blockquote>\n\n  </blockquote>\n</blockquote>\n\n<blockquote class=\"comment\">\n  <comment-title>FastQC Results</comment-title>\n  <p>This is what you should expect from the <strong>Adapter Content</strong> section:</p>\n  <figure id=\"figure-2\" style=\"max-width: 90%;\"><img src=\"../../images/atac-seq/Screenshot_fastqcBeforecutadapt.png\" alt=\"FastQC screenshot of the Adapter Content section. \" width=\"1341\" height=\"825\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/atac-seq/Screenshot_fastqcBeforecutadapt.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 2</strong>:</span> FastQC screenshot on the Adapter Content section</figcaption></figure>\n</blockquote>\n\n<p>The FastQC web page <strong>Adapter Content</strong> section shows the presence of Nextera Transposase Sequence in the reads. We will remove the adapters with Cutadapt.</p>\n\n<h2 id=\"trimming-reads\">Trimming Reads</h2>\n\n<p>To trim the adapters we provide the Nextera adapter sequences to <strong>Cutadapt</strong>. These adapters are shown in the image below.</p>\n\n<figure id=\"figure-3\" style=\"max-width: 90%;\"><img src=\"../../images/atac-seq/nexteraLibraryPicture.svg.png\" alt=\"Nextera library with the sequence of adapters. \" width=\"1109\" height=\"43\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/atac-seq/nexteraLibraryPicture.svg.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 3</strong>:</span> Nextera library with the sequence of adapters</figcaption></figure>\n\n<p>The forward and reverse adapters are slightly different. We will also trim low quality bases at the ends of the reads (quality less than 20). We will only keep reads that are at least 20 bases long. We remove short reads (&lt; 20bp) as they are not useful, they will either be thrown out by the mapping or may interfere with our results at the end.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Task description</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/lparsons/cutadapt/cutadapt/1.16.5\" title=\"Cutadapt tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Cutadapt</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.16.5)</span> with the following parameters:\n      <ul>\n        <li><em>“Single-end or Paired-end reads?”</em>: <code class=\"language-plaintext highlighter-rouge\">Paired-end</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“FASTQ/A file #1”</em>: select <code class=\"language-plaintext highlighter-rouge\">SRR891268_R1</code></li>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“FASTQ/A file #2”</em>: select <code class=\"language-plaintext highlighter-rouge\">SRR891268_R2</code></li>\n            <li>In <em>“Read 1 Options”</em>:\n              <ul>\n                <li>In <em>“3’ (End) Adapters”</em>:\n                  <ul>\n                    <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert 3’ (End) Adapters”</em>\n                      <ul>\n                        <li><em>“Source”</em>: <code class=\"language-plaintext highlighter-rouge\">Enter custom sequence</code>\n                          <ul>\n                            <li><em>“Enter custom 3’ adapter name (Optional if Multiple output is ‘No’)”</em>: <code class=\"language-plaintext highlighter-rouge\">Nextera R1</code></li>\n                            <li><em>“Enter custom 3’ adapter sequence”</em>: <code class=\"language-plaintext highlighter-rouge\">CTGTCTCTTATACACATCTCCGAGCCCACGAGAC</code></li>\n                          </ul>\n                        </li>\n                      </ul>\n                    </li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n            <li>In <em>“Read 2 Options”</em>:\n              <ul>\n                <li>In <em>“3’ (End) Adapters”</em>:\n                  <ul>\n                    <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert 3’ (End) Adapters”</em>\n                      <ul>\n                        <li><em>“Source”</em>: <code class=\"language-plaintext highlighter-rouge\">Enter custom sequence</code>\n                          <ul>\n                            <li><em>“Enter custom 3’ adapter name (Optional)”</em>: <code class=\"language-plaintext highlighter-rouge\">Nextera R2</code></li>\n                            <li><em>“Enter custom 3’ adapter sequence”</em>: <code class=\"language-plaintext highlighter-rouge\">CTGTCTCTTATACACATCTGACGCTGCCGACGA</code></li>\n                          </ul>\n                        </li>\n                      </ul>\n                    </li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n        <li>In <em>“Filter Options”</em>:\n          <ul>\n            <li><em>“Minimum length”</em>: <code class=\"language-plaintext highlighter-rouge\">20</code></li>\n          </ul>\n        </li>\n        <li>In <em>“Read Modification Options”</em>:\n          <ul>\n            <li><em>“Quality cutoff”</em>: <code class=\"language-plaintext highlighter-rouge\">20</code></li>\n          </ul>\n        </li>\n        <li>In <em>“Output Options”</em>:\n          <ul>\n            <li><em>“Report”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>Click on the <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> (eye) icon of the report and read the first lines.</li>\n  </ol>\n</blockquote>\n\n<blockquote class=\"comment\">\n  <comment-title>Cutadapt Results</comment-title>\n  <p>You should get similar output to this from Cutadapt:</p>\n  <figure id=\"figure-4\" style=\"max-width: 90%;\"><img src=\"../../images/atac-seq/Screenshot_cutadaptSummary.png\" alt=\"Summary of cutadapt. \" width=\"384\" height=\"106\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/atac-seq/Screenshot_cutadaptSummary.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 4</strong>:</span> Summary of cutadapt</figcaption></figure>\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>What percentage of reads contain adapters?</li>\n    <li>What percentage of reads are still longer than 20bp after the trimming?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>~14%</li>\n      <li>~99%</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Check Adapter Removal with FastQC</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/devteam/fastqc/fastqc/0.72+galaxy1\" title=\"FastQC tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>FastQC</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.72+galaxy1)</span> with the following parameters:\n      <ul>\n        <li><em>“Short read data from your current history”</em>: select the output of <strong>Cutadapt</strong> <i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <strong>Multiple datasets</strong> to choose both <code class=\"language-plaintext highlighter-rouge\">Read 1 Output</code> and <code class=\"language-plaintext highlighter-rouge\">Read 2 Output</code>.</li>\n      </ul>\n    </li>\n    <li>Click on the <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> (eye) icon of the report and read the first lines.</li>\n  </ol>\n</blockquote>\n\n<blockquote class=\"comment\">\n  <comment-title>FastQC Results</comment-title>\n  <p>Now, you should see under <strong>Overrepresented sequences</strong> that there is no more overrepresented sequences and under <strong>Adapter Content</strong> that the Nextera adapters are no longer present.</p>\n  <figure id=\"figure-5\" style=\"max-width: 90%;\"><img src=\"../../images/atac-seq/Screenshot_fastqcAftercutadapt.png\" alt=\"FastQC screenshot on the adapter content section after cutadapt. \" width=\"1328\" height=\"813\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/atac-seq/Screenshot_fastqcAftercutadapt.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 5</strong>:</span> FastQC screenshot on the adapter content section after cutadapt</figcaption></figure>\n  <p>However, you may have noticed that you have a new section with warning: <strong>Sequence Length Distribution</strong>. This is expected as you trimmed part of the reads.</p>\n</blockquote>\n\n<h1 id=\"mapping\">Mapping</h1>\n\n<h2 id=\"mapping-reads-to-reference-genome\">Mapping Reads to Reference Genome</h2>\n\n<p>Next we map the trimmed reads to the human reference genome. Here we will use <strong>Bowtie2</strong>. We will extend the maximum fragment length (distance between read pairs) from 500 to 1000 because we know some valid read pairs are from this fragment length. We will use the <code class=\"language-plaintext highlighter-rouge\">--very-sensitive</code> parameter to have more chance to get the best match even if it takes a bit longer to run. We will run the <strong>end-to-end</strong> mode because we trimmed the adapters so we expect the whole read to map, no clipping of ends is needed. Regarding the genome to choose. The hg38 version of the human genome contains <a href=\"https://www.ncbi.nlm.nih.gov/grc/help/definitions/#ALTERNATE\">alternate loci</a>. This means that some region of the genome are present both in the canonical chromosome and on its alternate loci. The reads that map to these regions would map twice. To be able to filter reads falling into repetitive regions but keep reads falling into regions present in alternate loci, we will map on the Canonical version of hg38 (only the chromosome with numbers, chrX, chrY, and chrM).</p>\n\n<blockquote class=\"comment\">\n  <comment-title>Dovetailing</comment-title>\n  <p>We will allow dovetailing of read pairs with Bowtie2. This is because adapters are removed by Cutadapt only when at least 3 bases match the adapter sequence, so it is possible that after trimming a read can contain 1-2 bases of adapter and go beyond it’s mate start site. For example, if the first mate in the read pair is: <code class=\"language-plaintext highlighter-rouge\">GCTATGAAGAATAGGGCGAAGGGGCCTGCGGCGTATTCGATGTTGAAGCT</code> and the second mate is <code class=\"language-plaintext highlighter-rouge\">CTTCAACATCGAATACGCCGCAGGCCCCTTCGCCCTATTCTTCATAGCCT</code>, where both contain 2 bases of adapter sequence, they will not be trimmed by Cutadapt and will map this way:</p>\n  <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>&lt;--------------------Mate 1-----------------------\nAGCTTCAACATCGAATACGCCGCAGGCCCCTTCGCCCTATTCTTCATAGC\n  CTTCAACATCGAATACGCCGCAGGCCCCTTCGCCCTATTCTTCATAGCCT\n  ----------------------Mate 2---------------------&gt;\n</code></pre></div>  </div>\n  <p>This is what we call dovetailing and we want to consider this pair as a valid concordant alignment.</p>\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Mapping reads to reference genome</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/devteam/bowtie2/bowtie2/2.4.2+galaxy0\" title=\"Bowtie2 tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Bowtie2</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.4.2+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><em>“Is this single or paired library”</em>: <code class=\"language-plaintext highlighter-rouge\">Paired-end</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“FASTQ/A file #1”</em>: select the output of <strong>Cutadapt</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> <em>“Read 1 Output”</em></li>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“FASTQ/A file #2”</em>: select the output of <strong>Cutadapt</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> <em>“Read 2 Output”</em></li>\n            <li><em>“Do you want to set paired-end options?”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code>\n              <ul>\n                <li><em>“Set the maximum fragment length for valid paired-end alignments”</em>: <code class=\"language-plaintext highlighter-rouge\">1000</code></li>\n                <li><em>“Allow mate dovetailing”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n        <li><em>“Will you select a reference genome from your history or use a built-in index?”</em>: <code class=\"language-plaintext highlighter-rouge\">Use a built-in genome index</code>\n          <ul>\n            <li><em>“Select reference genome”</em>: <code class=\"language-plaintext highlighter-rouge\">Human (Homo sapiens): hg38 Canonical</code></li>\n          </ul>\n        </li>\n        <li><em>“Set read groups information?”</em>: <code class=\"language-plaintext highlighter-rouge\">Do not set</code></li>\n        <li><em>“Select analysis mode”</em>: <code class=\"language-plaintext highlighter-rouge\">1: Default setting only</code>\n          <ul>\n            <li><em>“Do you want to use presets?”</em>: <code class=\"language-plaintext highlighter-rouge\">Very sensitive end-to-end (--very-sensitive)</code></li>\n          </ul>\n        </li>\n        <li><em>“Do you want to tweak SAM/BAM Options?”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n        <li><em>“Save the bowtie2 mapping statistics to the history”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n      </ul>\n    </li>\n    <li>Click on the <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> (eye) icon of the mapping stats.</li>\n  </ol>\n</blockquote>\n\n<blockquote class=\"comment\">\n  <comment-title>Bowtie2 Results</comment-title>\n  <p>You should get similar results to this from Bowtie2:</p>\n  <figure id=\"figure-6\" style=\"max-width: 90%;\"><img src=\"../../images/atac-seq/Screenshot_bowtie2MappingStats.png\" alt=\"Mapping statistics of bowtie2. \" width=\"508\" height=\"225\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/atac-seq/Screenshot_bowtie2MappingStats.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 6</strong>:</span> Mapping statistics of bowtie2</figcaption></figure>\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>What percentage of read pairs mapped concordantly?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <p>54.8+42.87=97.67%</p>\n\n  </blockquote>\n\n</blockquote>\n\n<blockquote class=\"comment\">\n  <comment-title>On the number of uniquely mapped.</comment-title>\n\n  <p>You might be surprised by the number of uniquely mapped compared to the number of multi-mapped reads (reads mapping to more than one location in the genome).\nOne of the reasons is that we have used the parameter <code class=\"language-plaintext highlighter-rouge\">--very-sensitive</code>. Bowtie2 considers a read as multi-mapped even if the second hit has a much lower quality than the first one.\nAnother reason is that we have reads that map to the mitochondrial genome. The mitochondrial genome has a lot of regions with similar sequence.</p>\n\n</blockquote>\n\n<h1 id=\"filtering-mapped-reads\">Filtering Mapped Reads</h1>\n\n<h2 id=\"filter-uninformative-reads\">Filter Uninformative Reads</h2>\n\n<p>We apply some filters to the reads after the mapping. ATAC-Seq datasets can have a lot of reads that map to the mitchondrial genome because it is nucleosome-free and thus very accessible to Tn5 insertion. The mitchondrial genome is uninteresting for ATAC-Seq so we remove these reads. We also remove reads with low mapping quality and reads that are not properly paired.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Filtering of uninformative reads</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/devteam/bamtools_filter/bamFilter/2.4.1\" title=\"Filter BAM datasets on a variety of attributes tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Filter BAM datasets on a variety of attributes</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.4.1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“BAM dataset(s) to filter”</em>: Select the output of  <strong>Bowtie2</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> <em>“alignments”</em></li>\n        <li>In <em>“Condition”</em>:\n          <ul>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Condition”</em>\n              <ul>\n                <li>In <em>“Filter”</em>:\n                  <ul>\n                    <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Filter”</em>\n                      <ul>\n                        <li><em>“Select BAM property to filter on”</em>: <code class=\"language-plaintext highlighter-rouge\">mapQuality</code>\n                          <ul>\n                            <li><em>“Filter on read mapping quality (phred scale)”</em>: <code class=\"language-plaintext highlighter-rouge\">&gt;=30</code></li>\n                          </ul>\n                        </li>\n                      </ul>\n                    </li>\n                    <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Filter”</em>\n                      <ul>\n                        <li><em>“Select BAM property to filter on”</em>: <code class=\"language-plaintext highlighter-rouge\">isProperPair</code>\n                          <ul>\n                            <li><em>“Select properly paired reads”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n                          </ul>\n                        </li>\n                      </ul>\n                    </li>\n                    <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Filter”</em>\n                      <ul>\n                        <li><em>“Select BAM property to filter on”</em>: <code class=\"language-plaintext highlighter-rouge\">reference</code>\n                          <ul>\n                            <li><em>“Filter on the reference name for the read”</em>: <code class=\"language-plaintext highlighter-rouge\">!chrM</code></li>\n                          </ul>\n                        </li>\n                      </ul>\n                    </li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n        <li><em>“Would you like to set rules?”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n      </ul>\n    </li>\n    <li>Click on the input and the output BAM files of the filtering step. Check the size of the files.</li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>Based on the file size, what proportion of alignments was removed (approximately)?</li>\n    <li>Which parameter should be modified if you are interested in repetitive regions?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>\n        <p>The original BAM file is 28.1 MB, the filtered one is 15.2 MB. Approximately half of the alignments were removed.</p>\n      </li>\n      <li>\n        <p>You should modify the mapQuality criteria and decrease the threshold.</p>\n      </li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<p>High numbers of mitochondrial reads can be a problem in ATAC-Seq. Some ATAC-Seq samples have been reported to be 80% mitochondrial reads and so wet-lab methods have been developed to deal with this issue <span class=\"citation\"><a href=\"#Corces2017\">Corces <i>et al.</i> 2017</a></span> and <span class=\"citation\"><a href=\"#Litzenburger2017\">Litzenburger <i>et al.</i> 2017</a></span>. It can be a useful QC to assess the number of mitochondrial reads.\nHowever, it does not predict the quality of the rest of the data. It is just that sequencing reads have been wasted.</p>\n\n<blockquote class=\"tip\">\n  <tip-title>Getting the number of mitochondrial reads</tip-title>\n\n  <p>To get the number of reads that mapped to the mitochondrial genome (chrM) you can run <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/devteam/samtools_idxstats/samtools_idxstats/2.0.3\" title=\"Samtools idxstats tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Samtools idxstats</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.0.3)</span> on the output of  <strong>Bowtie2</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> <em>“alignments”</em>.\nThe columns of the output are: chromosome name, chromosome length, number of reads mapping to the chromosome, number of unaligned mate whose mate is mapping to the chromosome.\nThe first 2 lines of the result would be (after using <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_sort_header_tool/1.1.1\" title=\"Sort tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Sort</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.1.1)</span>):</p>\n\n  <figure id=\"figure-7\" style=\"max-width: 90%;\"><img src=\"../../images/atac-seq/Screenshot_samtoolsIdxStatsChrM.png\" alt=\"Samtools idxstats result. \" width=\"262\" height=\"58\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/atac-seq/Screenshot_samtoolsIdxStatsChrM.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 7</strong>:</span> Samtools idxstats result</figcaption></figure>\n\n  <p>There are 220 000 reads which map to chrM and 165 000 which map to chr22.</p>\n</blockquote>\n\n<h2 id=\"filter-duplicate-reads\">Filter Duplicate Reads</h2>\n\n<p>Because of the PCR amplification, there might be read duplicates (different reads mapping to exactly the same genomic region) from overamplification of some regions. As the Tn5 insertion is random within an accessible region, we do not expect to see fragments with the same coordinates. We consider such fragments to be PCR duplicates. We will remove them with <strong>Picard MarkDuplicates</strong>.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Remove duplicates</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/devteam/picard/picard_MarkDuplicates/2.18.2.2\" title=\"MarkDuplicates tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>MarkDuplicates</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.18.2.2)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Select SAM/BAM dataset or dataset collection”</em>: Select the output of  <strong>Filter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> <em>“BAM”</em></li>\n        <li><em>“If true do not write duplicates to the output file instead of writing them with appropriate flags set”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n      </ul>\n\n      <blockquote class=\"comment\">\n        <comment-title>Defaults of MarkDuplicates</comment-title>\n\n        <p>By default, the tool will only “Mark” the duplicates. This means that it will change the Flag of the duplicated reads to enable them to be filtered afterwards. We use the parameter <em>“If true do not write duplicates to the output file instead of writing them with appropriate flags set”</em> to directly remove the duplicates.</p>\n      </blockquote>\n    </li>\n    <li>Click on the <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> (eye) icon of the MarkDuplicate metrics.</li>\n  </ol>\n</blockquote>\n\n<blockquote class=\"comment\">\n  <comment-title>MarkDuplicates Results</comment-title>\n  <p>You should get similar output to this from MarkDuplicates:</p>\n  <figure id=\"figure-8\" style=\"max-width: 90%;\"><img src=\"../../images/atac-seq/Screenshot_picardRemoveDup.png\" alt=\"Metrics of MarkDuplicates. \" width=\"1139\" height=\"65\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/atac-seq/Screenshot_picardRemoveDup.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 8</strong>:</span> Metrics of MarkDuplicates</figcaption></figure>\n</blockquote>\n\n<blockquote class=\"tip\">\n  <tip-title>Formatting the MarkDuplicate metrics for readability</tip-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"Grep1\" title=\"Select lines that match an expression tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Select lines that match an expression</strong></span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Select lines from”</em>: Select the output of  <strong>MarkDuplicates</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n        <li><em>“that</em>: <code class=\"language-plaintext highlighter-rouge\">Matching</code></li>\n        <li><em>“the pattern</em>: <code class=\"language-plaintext highlighter-rouge\">(Library|LIBRARY)</code></li>\n      </ul>\n    </li>\n    <li>\n      <p>Check that the datatype is tabular. If not, change it.</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-changing-the-datatype-2\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-changing-the-datatype-2\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Changing the datatype</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, click <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Datatypes</strong> tab on the top</li>   <li>In the <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Assign Datatype</strong>, select <code class=\"language-plaintext highlighter-rouge\">tabular</code> from “<em>New type</em>” dropdown     <ul>       <li>Tip: you can start typing the datatype into the field to filter the dropdown menu</li>     </ul>   </li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/datamash_transpose/datamash_transpose/1.1.0\" title=\"Transpose rows/columns in a tabular file tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Transpose rows/columns in a tabular file</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.1.0)</span>:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Select lines from”</em>: Select the output of <strong>Select</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n      </ul>\n    </li>\n  </ol>\n\n  <figure id=\"figure-9\" style=\"max-width: 90%;\"><img src=\"../../images/atac-seq/Screenshot_picardRemoveDupAfterTranspose.png\" alt=\"Metrics of MarkDuplicates. \" width=\"421\" height=\"253\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/atac-seq/Screenshot_picardRemoveDupAfterTranspose.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 9</strong>:</span> Metrics of MarkDuplicates</figcaption></figure>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>How many pairs were in the input?</li>\n    <li>How many pairs are duplicates?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>135813</li>\n      <li>3584</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<p>Once again, if you have a high number of replicates it does not mean that your data are not good, it just means that you sequenced too much compared to the diversity of the library you generated. Consequently, libraries with a high portion of duplicates should not be resequenced as this would not increase the amount of data.</p>\n\n<h2 id=\"check-insert-sizes\">Check Insert Sizes</h2>\n\n<p>We will check the insert sizes with <strong>Paired-end histogram</strong> of insert size frequency. The insert size is the distance between the R1 and R2 read pairs. This tells us the size of the DNA fragment the read pairs came from. The fragment length distribution of a sample gives a very good indication of the quality of the ATAC-Seq.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Plot the distribution of fragment sizes.</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/pe_histogram/pe_histogram/1.0.1\" title=\"Paired-end histogram tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Paired-end histogram</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.0.1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“BAM file”</em>: Select the output of  <strong>MarkDuplicates</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> <em>“BAM output”</em></li>\n        <li><em>“Lower bp limit (optional)”</em>: <code class=\"language-plaintext highlighter-rouge\">0</code></li>\n        <li><em>“Upper bp limit (optional)”</em>: <code class=\"language-plaintext highlighter-rouge\">1000</code></li>\n      </ul>\n    </li>\n    <li>Click on the <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> (eye) icon of the lower one of the 2 outputs (the png file).</li>\n  </ol>\n</blockquote>\n\n<blockquote class=\"comment\">\n  <comment-title>CollectInsertSizeMetrics Results</comment-title>\n  <p>This is what you get from CollectInsertSizeMetrics:</p>\n  <figure id=\"figure-10\" style=\"max-width: 90%;\"><img src=\"../../images/atac-seq/Screenshot_sizeDistribution.png\" alt=\"Fragment size distribution. \" width=\"800\" height=\"600\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/atac-seq/Screenshot_sizeDistribution.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 10</strong>:</span> Fragment size distribution</figcaption></figure>\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>Could you guess what the peaks at approximately 50bp, 200bp, 400bp and 600bp correspond to?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <p>The first peak (50bp) corresponds to where the Tn5 transposase inserted into nucleosome-free regions. The second peak (a bit less than 200bp) corresponds to where Tn5 inserted around a single nucleosome. The third one (around 400bp) is where Tn5 inserted around two adjacent nucleosomes and the fourth one (around 600bp) is where Tn5 inserted around three adjacent nucleosomes.</p>\n\n  </blockquote>\n\n</blockquote>\n\n<p>This fragment size distribution is a good indication if your experiment worked or not.\nIn absence of chromatin (without nucleosome), this is the profile you would get:</p>\n\n<figure id=\"figure-11\" style=\"max-width: 90%;\"><img src=\"../../images/atac-seq/Screenshot_sizeDistribution_Naked.png\" alt=\"Fragment size distribution of a purified DNA. \" width=\"800\" height=\"600\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/atac-seq/Screenshot_sizeDistribution_Naked.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 11</strong>:</span> Fragment size distribution of a purified DNA</figcaption></figure>\n\n<p>Here are examples of Fragment size distributions of ATAC-Seq which were very noisy:</p>\n\n<figure id=\"figure-12\" style=\"max-width: 90%;\"><img src=\"../../images/atac-seq/Screenshot_sizeDistribution_Failed.png\" alt=\"Fragment size distribution of a failed ATAC-Seq. \" width=\"800\" height=\"600\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/atac-seq/Screenshot_sizeDistribution_Failed.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 12</strong>:</span> Fragment size distribution of a failed ATAC-Seq</figcaption></figure>\n\n<figure id=\"figure-13\" style=\"max-width: 90%;\"><img src=\"../../images/atac-seq/Screenshot_sizeDistribution_Failed2.png\" alt=\"Fragment size distribution of another failed ATAC-Seq. \" width=\"800\" height=\"600\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/atac-seq/Screenshot_sizeDistribution_Failed2.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 13</strong>:</span> Fragment size distribution of another very noisy ATAC-Seq</figcaption></figure>\n\n<p>A final example of a Fragment size distribution of a very good ATAC-Seq, even if we cannot see the third nucleosome “peak”.</p>\n<figure id=\"figure-14\" style=\"max-width: 90%;\"><img src=\"../../images/atac-seq/Screenshot_sizeDistribution_Good.png\" alt=\"Fragment size distribution of a good ATAC-Seq. \" width=\"800\" height=\"600\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/atac-seq/Screenshot_sizeDistribution_Good.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 14</strong>:</span> Fragment size distribution of a good ATAC-Seq</figcaption></figure>\n\n<h1 id=\"peak-calling\">Peak calling</h1>\n\n<h2 id=\"call-peaks\">Call Peaks</h2>\n\n<p>We have now finished the data preprocessing. Next, in order to find regions corresponding to potential open chromatin regions, we want to identify regions where reads have piled up (peaks) greater than the background read coverage. The tools which are currently used are <a href=\"https://github.com/jsh58/Genrich\">Genrich</a> and <a href=\"https://github.com/taoliu/MACS\">MACS2</a>. MACS2 is more widely used. Genrich has a mode dedicated to ATAC-Seq but is still not published and the more reads you have, the less peaks you get (see the issue <a href=\"https://github.com/jsh58/Genrich/issues/33\">Genrich#33</a>). That’s why we will not use Genrich in this tutorial.</p>\n\n<p>At this step, two approaches exists:</p>\n\n<ul>\n  <li>The first one is to select only paired whose fragment length is below 100bp corresponding to nucleosome-free regions and to use a peak calling like you would do for a ChIP-seq, joining signal between mates. The disadvantages of this approach is that you can only use it if you have paired-end data and you will miss small open regions where only one Tn5 bound.</li>\n  <li>The second one chosen here is to use all reads to be more exhaustive. In this approach, it is very important to re-center the signal of each reads on the 5’ extremity (read start site) as this is where Tn5 cuts. Indeed, you want your peaks around the nucleosomes and not directly on the nucleosome:</li>\n</ul>\n<figure id=\"figure-15\" style=\"max-width: 90%;\"><img src=\"../../images/atac-seq/schemeWithLegend.jpg\" alt=\"Scheme of ATAC-Seq reads relative to nucleosomes. \" width=\"680\" height=\"378\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/atac-seq/schemeWithLegend.jpg\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 15</strong>:</span> Scheme of ATAC-Seq reads relative to nucleosomes</figcaption></figure>\n\n<blockquote class=\"comment\">\n  <comment-title>on Tn5 insertion</comment-title>\n\n  <p>When Tn5 cuts an accessible chromatin locus it inserts adapters separated by 9bp (<span class=\"citation\"><a href=\"#Kia2017\">Kia <i>et al.</i> 2017</a></span>):</p>\n  <figure id=\"figure-16\" style=\"max-width: 90%;\"><img src=\"../../images/atac-seq/NexteraLibraryConstruction.jpg\" alt=\"Nextera Library Construction. \" width=\"378\" height=\"189\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/atac-seq/NexteraLibraryConstruction.jpg\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 16</strong>:</span> Nextera Library Construction</figcaption></figure>\n\n  <p>This means in order to have the read start site reflecting the centre of where Tn5 bound, the reads on the positive strand should be shifted 4 bp to the right and reads on the negative strands should be shifted 5 bp to the left as in <a href=\"https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3959825\">Buenrostro et al. 2013</a>. <strong>Genrich</strong> can apply these shifts when ATAC-seq mode is selected. In most cases, we do not have 9bp resolution so we don’t take it into account but if you are interested in the footprint, this is important.</p>\n</blockquote>\n\n<p>If we only assess the coverage of the 5’ extremity of the reads, the data would be too sparse and it would be impossible to call peaks. Thus, we will extend the start sites of the reads by 200bp (100bp in each direction) to assess coverage.</p>\n\n<h3 id=\"using-macs2\">Using MACS2</h3>\n\n<p>We convert the BAM file to BED format because when we set the extension size in MACS2, it will only consider one read of the pair while here we would like to use the information from both.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Convert the BAM to BED</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_bamtobed/2.30.0\" title=\"bedtools BAM to BED converter tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>bedtools BAM to BED converter</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.30.0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Convert the following BAM file to BED”</em>: Select the output of <strong>MarkDuplicates</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>We call peaks with MACS2. In order to get the coverage centered on the 5’ extended 100bp each side we will use <code class=\"language-plaintext highlighter-rouge\">--shift -100</code> and <code class=\"language-plaintext highlighter-rouge\">--extend 200</code>:</p>\n<figure id=\"figure-17\" style=\"max-width: 90%;\"><img src=\"../../images/atac-seq/macs2Options.jpg\" alt=\"MACS2 options to get 100bp each side. \" width=\"643\" height=\"113\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/atac-seq/macs2Options.jpg\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 17</strong>:</span> MACS2 options to get 100bp each side</figcaption></figure>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Call peaks with MACS2</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/macs2/macs2_callpeak/2.1.1.20160309.6\" title=\"MACS2 callpeak tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>MACS2 callpeak</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.1.1.20160309.6)</span> with the following parameters:\n      <ul>\n        <li><em>“Are you pooling Treatment Files?”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> Select the output of <strong>bedtools BAM to BED</strong> converter <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n          </ul>\n        </li>\n        <li><em>“Do you have a Control File?”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n        <li><em>“Format of Input Files”</em>: <code class=\"language-plaintext highlighter-rouge\">Single-end BED</code></li>\n        <li><em>“Effective genome size”</em>: <code class=\"language-plaintext highlighter-rouge\">H. sapiens (2.7e9)</code></li>\n        <li><em>“Build Model”</em>: <code class=\"language-plaintext highlighter-rouge\">Do not build the shifting model (--nomodel)</code>\n          <ul>\n            <li><em>“Set extension size”</em>: <code class=\"language-plaintext highlighter-rouge\">200</code></li>\n            <li><em>“Set shift size”</em>: <code class=\"language-plaintext highlighter-rouge\">-100</code>. It needs to be - half the extension size to be centered on the 5’.</li>\n          </ul>\n        </li>\n        <li><em>“Additional Outputs”</em>:\n          <ul>\n            <li>Check <code class=\"language-plaintext highlighter-rouge\">Peaks as tabular file (compatible with MultiQC)</code></li>\n            <li>Check <code class=\"language-plaintext highlighter-rouge\">Peak summits</code></li>\n            <li>Check <code class=\"language-plaintext highlighter-rouge\">Scores in bedGraph files</code></li>\n          </ul>\n        </li>\n        <li>In <em>“Advanced Options”</em>:\n          <ul>\n            <li><em>“Composite broad regions”</em>: <code class=\"language-plaintext highlighter-rouge\">No broad regions</code>\n              <ul>\n                <li><em>“Use a more sophisticated signal processing approach to find subpeak summits in each enriched peak region”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n              </ul>\n            </li>\n            <li><em>“How many duplicate tags at the exact same location are allowed?”</em>: <code class=\"language-plaintext highlighter-rouge\">all</code></li>\n          </ul>\n        </li>\n      </ul>\n\n      <blockquote class=\"comment\">\n        <comment-title>Why keeping all duplicates is important</comment-title>\n\n        <p>We previously removed duplicates using <strong>MarkDuplicates</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> using paired-end information. If two pairs had identical R1 but different R2, we knew it was not a PCR duplicate. Because we converted the BAM to BED we lost the pair information. If we keep the default (removing duplicates) one of the 2 identical R1 would be filtered out as duplicate.</p>\n      </blockquote>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h1 id=\"visualisation-of-coverage\">Visualisation of Coverage</h1>\n\n<h2 id=\"prepare-the-datasets\">Prepare the Datasets</h2>\n\n<h3 id=\"extract-ctcf-peaks-on-chr22-in-intergenic-regions\">Extract CTCF peaks on chr22 in intergenic regions</h3>\n<p>As our training dataset is focused on chromosome 22 we will only use the CTCF peaks from chr22. We expect to have ATAC-seq coverage at TSS but only good ATAC-seq have coverage on intergenic CTCF. Indeed, the CTCF protein is able to position nucleosomes and creates a region depleted of nucleosome of around 120bp <span class=\"citation\"><a href=\"#fu_insulator_2008\">Fu <i>et al.</i> 2008</a></span>. This is smaller than the 200bp nucleosome-free region around TSS and also probably not present in all cells. Thus it is more difficult to get enrichment. In order to get the list of intergenic CTCF peaks of chr22, we will first select the peaks on chr22 and then exclude the one which overlap with genes.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Select CTCF peaks from chr22 in intergenic regions:</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"Filter1\" title=\"Filter data on any column using simple expressions tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Filter data on any column using simple expressions</strong></span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Filter”</em>: Select the first dataset: <code class=\"language-plaintext highlighter-rouge\">ENCFF933NTR.bed.gz</code></li>\n        <li><em>“With following condition”</em>: <code class=\"language-plaintext highlighter-rouge\">c1=='chr22'</code></li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_intersectbed/2.30.0\" title=\"bedtools Intersect intervals find overlapping intervals in various ways tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>bedtools Intersect intervals find overlapping intervals in various ways</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.30.0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“File A to intersect with B”</em>: Select the output of <strong>Filter</strong> data on any column using simple expressions <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n        <li><em>“Combined or separate output files”</em>: <code class=\"language-plaintext highlighter-rouge\">One output file per 'input B' file</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“File B to intersect with A”</em>:  Select the dataset <code class=\"language-plaintext highlighter-rouge\">chr22 genes</code></li>\n          </ul>\n        </li>\n        <li><em>“What should be written to the output file?”</em>: <code class=\"language-plaintext highlighter-rouge\">Write the original entry in A for each overlap (-wa)</code></li>\n        <li><em>“Required overlap”</em>: <code class=\"language-plaintext highlighter-rouge\">Default: 1bp</code></li>\n        <li><em>“Report only those alignments that <strong>do not</strong> overlap with file(s) B”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n      </ul>\n    </li>\n    <li>Rename the datasets <code class=\"language-plaintext highlighter-rouge\">intergenic CTCF peaks chr22</code>.</li>\n  </ol>\n</blockquote>\n\n<h3 id=\"convert-bedgraph-from-macs2-to-bigwig\">Convert bedgraph from <strong>MACS2</strong> to bigwig</h3>\n<p>The bedgraph format is easily readable for human but it can be very large and visualising a specific region is quite slow. We will change it to bigwig format which is a binary format, so we can visualise any region of the genome very quickly.</p>\n\n<blockquote class=\"tip\">\n  <tip-title>Speed-up the bedgraph to bigwig conversion</tip-title>\n\n  <p>In this tutorial we focus on chr22, thus we could restrict our bedgraph to chr22 before doing the conversion. This will both speed-up the conversion and decrease the amount of memory needed.</p>\n\n  <p>To do so, we will use <span class=\"tool\" data-tool=\"Filter1\" title=\"Filter data on any column using simple expressions tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Filter data on any column using simple expressions</strong></span> with the following parameters:</p>\n  <ul>\n    <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Filter”</em>: Select the output of <strong>MACS2</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> (Bedgraph Treatment).</li>\n    <li><em>“With following condition”</em>: <code class=\"language-plaintext highlighter-rouge\">c1=='chr22'</code></li>\n  </ul>\n\n  <p>This will decrease by half the size of the file.\nIn the next step, choose the output of <strong>Filter</strong> instead of the output of <strong>MACS2</strong>.</p>\n\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Convert bedgraphs to bigWig.</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"wig_to_bigWig\" title=\"Wig/BedGraph-to-bigWig tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Wig/BedGraph-to-bigWig</strong></span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Convert”</em>: Select the output of <strong>MACS2</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> (Bedgraph Treatment).</li>\n        <li><em>“Converter settings to use”</em>: <code class=\"language-plaintext highlighter-rouge\">Default</code></li>\n      </ul>\n    </li>\n    <li>Rename the datasets <code class=\"language-plaintext highlighter-rouge\">MACS2 bigwig</code>.</li>\n  </ol>\n</blockquote>\n\n<h2 id=\"create-heatmap-of-coverage-at-tss-with-deeptools\">Create heatmap of coverage at TSS with deepTools</h2>\n\n<p>You might be interested in checking the coverage on specific regions. For this, you can compute a heatmap. We will use the <strong>deepTools plotHeatmap</strong>. As an example, we will here make a heatmap centered on the transcription start sites (TSS) and another one centered on intergenic CTCF peaks. First, on the TSS:</p>\n\n<h3 id=\"generate-computematrix\">Generate computeMatrix</h3>\n\n<p>The input of <strong>plotHeatmap</strong> is a matrix in a hdf5 format. To generate it we use the tool <strong>computeMatrix</strong> that will evaluate the coverage at each locus we are interested in.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Generate the matrix</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_compute_matrix/deeptools_compute_matrix/3.3.2.0.0\" title=\"computeMatrix tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>computeMatrix</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 3.3.2.0.0)</span> with the following parameters:\n      <ul>\n        <li>In <em>“Select regions”</em>:\n          <ul>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Select regions”</em>\n              <ul>\n                <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Regions to plot”</em>: Select the dataset <code class=\"language-plaintext highlighter-rouge\">chr22 genes</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n        <li><em>“Sample order matters”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Score file”</em>: Select the output of <strong>Wig/BedGraph-to-bigWig</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> that should be named <code class=\"language-plaintext highlighter-rouge\">MACS2 bigwig</code>.</li>\n          </ul>\n        </li>\n        <li><em>“computeMatrix has two main output options”</em>: <code class=\"language-plaintext highlighter-rouge\">reference-point</code></li>\n        <li><em>“The reference point for the plotting”</em>: <code class=\"language-plaintext highlighter-rouge\">beginning of region (e.g. TSS)</code></li>\n        <li><em>“Show advanced output settings”</em>: <code class=\"language-plaintext highlighter-rouge\">no</code></li>\n        <li><em>“Show advanced options”</em>: <code class=\"language-plaintext highlighter-rouge\">yes</code>\n          <ul>\n            <li><em>“Convert missing values to 0?”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h3 id=\"plot-with-plotheatmap\">Plot with <strong>plotHeatmap</strong></h3>\n\n<p>We will now generate a heatmap. Each line will be a transcript. The coverage will be summarized with a color code from red (no coverage) to blue (maximum coverage). All TSS will be aligned in the middle of the figure and only the 2 kb around the TSS will be displayed. Another plot, on top of the heatmap, will show the mean signal at the TSS. There will be one heatmap per bigwig.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Generate the heatmap</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_plot_heatmap/deeptools_plot_heatmap/3.3.2.0.1\" title=\"plotHeatmap tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>plotHeatmap</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 3.3.2.0.1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Matrix file from the computeMatrix tool”</em>: Select the output of <strong>computeMatrix</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>.</li>\n        <li><em>“Show advanced output settings”</em>: <code class=\"language-plaintext highlighter-rouge\">no</code></li>\n        <li><em>“Show advanced options”</em>: <code class=\"language-plaintext highlighter-rouge\">no</code></li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<blockquote class=\"comment\">\n  <comment-title>plotHeatmap Results</comment-title>\n  <p>This is what you get from plotHeatmap:</p>\n  <figure id=\"figure-18\" style=\"max-width: 90%;\"><img src=\"../../images/atac-seq/plotHeatmapOutput.png\" alt=\"plotHeatmap output. \" width=\"484\" height=\"2294\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/atac-seq/plotHeatmapOutput.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 18</strong>:</span> plotHeatmap output</figcaption></figure>\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>Is the coverage symmetric?</li>\n    <li>What is the mean value in genes?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>No, it is higher on the left which is expected as usually the promoter of active genes is accessible.</li>\n      <li>Around 5.5.</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<p>Now we will repeat the procedure for CTCF peaks of chr22 in intergenic regions:</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Generate the matrix</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_compute_matrix/deeptools_compute_matrix/3.3.2.0.0\" title=\"computeMatrix tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>computeMatrix</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 3.3.2.0.0)</span> with the following parameters:\n      <ul>\n        <li>In <em>“Select regions”</em>:\n          <ul>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Select regions”</em>\n              <ul>\n                <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Regions to plot”</em>: Select the dataset <code class=\"language-plaintext highlighter-rouge\">intergenic CTCF peaks chr22</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n        <li><em>“Sample order matters”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Score file”</em>: Select the output of <strong>Wig/BedGraph-to-bigWig</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> that should be named <code class=\"language-plaintext highlighter-rouge\">MACS2 bigwig</code>.</li>\n          </ul>\n        </li>\n        <li><em>“Would you like custom sample labels?”</em>: <code class=\"language-plaintext highlighter-rouge\">No, use sample names in the history</code></li>\n        <li><em>“computeMatrix has two main output options”</em>: <code class=\"language-plaintext highlighter-rouge\">reference-point</code>\n          <ul>\n            <li><em>“The reference point for the plotting”</em>: <code class=\"language-plaintext highlighter-rouge\">center of region</code></li>\n          </ul>\n        </li>\n        <li><em>“Show advanced output settings”</em>: <code class=\"language-plaintext highlighter-rouge\">no</code></li>\n        <li><em>“Show advanced options”</em>: <code class=\"language-plaintext highlighter-rouge\">yes</code>\n          <ul>\n            <li><em>“Convert missing values to 0?”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_plot_heatmap/deeptools_plot_heatmap/3.3.2.0.1\" title=\"plotHeatmap tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>plotHeatmap</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 3.3.2.0.1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Matrix file from the computeMatrix tool”</em>:  Select the output of <strong>computeMatrix</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>.</li>\n        <li><em>“Show advanced output settings”</em>: <code class=\"language-plaintext highlighter-rouge\">no</code></li>\n        <li><em>“Show advanced options”</em>: <code class=\"language-plaintext highlighter-rouge\">yes</code>\n          <ul>\n            <li>In <em>“Colormap to use for each sample”</em>:\n              <ul>\n                <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Colormap to use for each sample”</em>\n                  <ul>\n                    <li><em>“Color map to use for the heatmap”</em>: <code class=\"language-plaintext highlighter-rouge\">Blues</code> # Or what you want</li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n            <li><em>“The x-axis label”</em>: <code class=\"language-plaintext highlighter-rouge\">distance from peak center (bp)</code></li>\n            <li><em>“The y-axis label for the top panel”</em>: <code class=\"language-plaintext highlighter-rouge\">CTCF peaks</code></li>\n            <li><em>“Reference point label”</em>: <code class=\"language-plaintext highlighter-rouge\">peak center</code></li>\n            <li><em>“Labels for the regions plotted in the heatmap”</em>: <code class=\"language-plaintext highlighter-rouge\">CTCF_peaks</code></li>\n            <li><em>“Did you compute the matrix with more than one groups of regions?”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes, I used multiple groups of regions</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"comment\">\n  <comment-title>plotHeatmap Results</comment-title>\n  <p>This is what you get from plotHeatmap, this is much more symetric:</p>\n  <figure id=\"figure-19\" style=\"max-width: 90%;\"><img src=\"../../images/atac-seq/plotHeatmapOutput_CTCF.png\" alt=\"plotHeatmap output on CTCF. \" width=\"778\" height=\"2328\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/atac-seq/plotHeatmapOutput_CTCF.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 19</strong>:</span> plotHeatmap output on CTCF</figcaption></figure>\n</blockquote>\n\n<h2 id=\"visualise-regions-with-pygenometracks\">Visualise Regions with pyGenomeTracks</h2>\n\n<p>In order to visualise a specific region (e.g. the gene <em>RAC2</em>), we can either use a genome browser like <strong>IGV</strong> or <strong>UCSC browser</strong>, or use <strong>pyGenomeTracks</strong> to make publishable figures. We will use <strong>pyGenomeTracks</strong>.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Task description</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/pygenometracks/pygenomeTracks/3.6\" title=\"pyGenomeTracks tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>pyGenomeTracks</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 3.6)</span> with the following parameters:\n      <ul>\n        <li><em>“Region of the genome to limit the operation”</em>: <code class=\"language-plaintext highlighter-rouge\">chr22:37,193,000-37,252,000</code></li>\n        <li>In <em>“Include tracks in your plot”</em>:\n          <ul>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Include tracks in your plot”</em>\n              <ul>\n                <li><em>“Choose style of the track”</em>: <code class=\"language-plaintext highlighter-rouge\">Bigwig track</code>\n                  <ul>\n                    <li><em>“Plot title”</em>: <code class=\"language-plaintext highlighter-rouge\">Coverage from MACS2 (extended +/-100bp)</code></li>\n                    <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Track file(s) bigwig format”</em>: Select the output of <strong>Wig/BedGraph-to-bigWig</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> called <code class=\"language-plaintext highlighter-rouge\">MACS2 bigwig</code>.</li>\n                    <li><em>“Color of track”</em>: Select the color of your choice</li>\n                    <li><em>“Minimum value”</em>: <code class=\"language-plaintext highlighter-rouge\">0</code></li>\n                    <li><em>“height”</em>: <code class=\"language-plaintext highlighter-rouge\">5</code></li>\n                    <li><em>“Show visualization of data range”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Include tracks in your plot”</em>\n              <ul>\n                <li><em>“Choose style of the track”</em>: <code class=\"language-plaintext highlighter-rouge\">NarrowPeak track</code>\n                  <ul>\n                    <li><em>“Plot title”</em>: <code class=\"language-plaintext highlighter-rouge\">Peaks from MACS2 (extended +/-100bp)</code></li>\n                    <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Track file(s) encodepeak or bed format”</em>: Select the output of <strong>MACS2</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> (narrow Peaks).</li>\n                    <li><em>“Color of track”</em>: Select the color of your choice</li>\n                    <li><em>“display to use”</em>: <code class=\"language-plaintext highlighter-rouge\">box: Draw a box</code></li>\n                    <li><em>“Plot labels (name, p-val, q-val)”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Include tracks in your plot”</em>\n              <ul>\n                <li><em>“Choose style of the track”</em>: <code class=\"language-plaintext highlighter-rouge\">Gene track / Bed track</code>\n                  <ul>\n                    <li><em>“Plot title”</em>: <code class=\"language-plaintext highlighter-rouge\">Genes</code></li>\n                    <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Track file(s) bed or gtf format”</em>: <code class=\"language-plaintext highlighter-rouge\">chr22 genes</code></li>\n                    <li><em>“Color of track”</em>: Select the color of your choice</li>\n                    <li><em>“height”</em>: <code class=\"language-plaintext highlighter-rouge\">5</code></li>\n                    <li><em>“Plot labels”</em>: <code class=\"language-plaintext highlighter-rouge\">yes</code>\n                      <ul>\n                        <li><em>“Put all labels inside the plotted region”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n                        <li><em>“Allow to put labels in the right margin”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n                      </ul>\n                    </li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Include tracks in your plot”</em>\n              <ul>\n                <li><em>“Choose style of the track”</em>: <code class=\"language-plaintext highlighter-rouge\">NarrowPeak track</code>\n                  <ul>\n                    <li><em>“Plot title”</em>: <code class=\"language-plaintext highlighter-rouge\">CTCF peaks</code></li>\n                    <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Track file(s) encodepeak or bed format”</em>: Select the first dataset: <code class=\"language-plaintext highlighter-rouge\">ENCFF933NTR.bed.gz</code></li>\n                    <li><em>“Color of track”</em>: Select the color of your choice</li>\n                    <li><em>“display to use”</em>: <code class=\"language-plaintext highlighter-rouge\">box: Draw a box</code></li>\n                    <li><em>“Plot labels (name, p-val, q-val)”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Include tracks in your plot”</em>\n              <ul>\n                <li><em>“Choose style of the track”</em>: <code class=\"language-plaintext highlighter-rouge\">X-axis</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>Click on the <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> (eye) icon of the output.</li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"comment\">\n  <comment-title>pyGenomeTracks Results</comment-title>\n  <p>You should get similar to results to this from pyGenomeTracks:</p>\n  <figure id=\"figure-20\" style=\"max-width: 90%;\"><img src=\"../../images/atac-seq/pyGenomeTracksOutput.png\" alt=\"pyGenomeTracks output. \" width=\"1133\" height=\"448\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/atac-seq/pyGenomeTracksOutput.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 20</strong>:</span> pyGenomeTracks output</figcaption></figure>\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n  <p>In the ATAC-Seq sample in this selected region we see four peaks detected by MACS2.</p>\n\n  <ol>\n    <li>How many TSS are accessible in the sample in the displayed region?</li>\n    <li>How many CTCF binding loci are accessible?</li>\n    <li>Can you spot peaks with no TSS and no CTCF peak?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>\n        <p>In total, we can see 3 TSS for 6 transcripts for 2 genes. The TSS of RAC2 corresponds to an ATAC-Seq peak whereas there is no significant coverage on both TSS of SSTR3.</p>\n      </li>\n      <li>\n        <p>Only the first peak on the left overlaps with a CTCF binding site.</p>\n      </li>\n      <li>\n        <p>Amongst the 4 peaks in this region, the 2 in the middle do not correspond to CTCF peaks or TSS.</p>\n      </li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<p>As CTCF creates accessible regions, a region containing a peak with no corresponding CTCF peak or TSS could be a putative enhancer. In the pyGenomeTracks plot we see a region like this located in the intron of a gene and another one between genes. However, it is impossible to guess from the position which would be the gene controlled by this region. And of course, more analyses are needed to assess if it is a real enhancer, for example, histone ChIP-seq, 3D structure, transgenic assay, etc.</p>\n\n<h1 id=\"conclusion\">Conclusion</h1>\n\n<p>In this training you have learned the general principles of ATAC-Seq data analysis. ATAC-Seq\nis a method to investigate the chromatin accessibility and the genome is treated with\na transposase (enzyme) called Tn5. It marks open chromatin regions by cutting and\ninserting adapters for sequencing. The training material gave you an insight into how to quality control the data. You should look for low quality bases, adapter contamination, correct insert size and PCR duplicates (duplication level). We showed you how to remove adapters and PCR duplicates, if <strong>FastQC</strong>, shows a warning in these areas. We mapped the reads\nwith <strong>Bowtie2</strong>, filtered our reads for properly paired, good quality and reads that do not\nmap to the mitochondrial genome. We found open chromatin regions with <strong>MACS2</strong>, a tool to find regions of genomic enrichment (peaks). We investigated the read coverage around TSS with the help of <strong>computeMatrix</strong> and <strong>plotHeatmap</strong>. Last but not least, we visualised the peaks and other informative tracks, such as CTCF binding regions and hg38 genes, with the help of <strong>pyGenomeTracks</strong>. At the end, we found open chromatin regions that did not overlap with CTCF sites or TSS, which could be potential putative enhancer regions detected by the ATAC-Seq experiment.</p>\n\n<figure id=\"figure-21\" style=\"max-width: 90%;\"><div style=\"overflow-x: auto\"><object data=\"../../images/atac-seq/ATACWF.svg\" type=\"image/svg+xml\" alt=\"ATAC workflow. \">ATAC workflow.</object></div><a target=\"_blank\" href=\"../../images/atac-seq/ATACWF.svg\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 21</strong>:</span> ATAC workflow</figcaption></figure>\n"],"ref_slides":["### Where does my data come from?\n\n![Low resolution image from a paper with two subfigures a and b. In A closed and open chromatin exists, then tn5 transposase attaches to open chromatin regions. these fragments are amplifiable and become amplified and sequenced. In subfigure B open chromatin is shown as two strands in black, with a common end in grey on both strands' both ends. Adapter 1 and 2 are attached to 5' ends. this is extended at 72° for 5 minutes, PCR'd using barcoded primers, and then the final product is created for sequencing which has open chromatin regions, surrounded by a common end, and then the adapters with a barcode on adapter 2.](../../images/atac-seq/atac.jpg)\n\n<small>\n[*Buenrostro et al. 2013 Nat Methods*](https://doi.org/10.1002/0471142727.mb2129s109)\n</small>\n\n- Usage of hyperactive Tn5 transposase to insert sequencing adapters into open chromatin regions.\n- After adapter attachment the DNA is sheared by the Transposase itself.\n\n???\n\n- ATAC-seq uses a transposase to insert sequencing adapters into accessible regions.\n- On the left figure you have the nucleosomes, histones, which are represented by grey circles.\n- The transposase will insert sequencing adapters at DNA depleted of nucleosomes.\n- Fragments are defined as a piece of DNA flanked by two sequencing adapters.\n- We can distinguish three types of fragments.\n- Those with no nucleosome in between which are called nucleosome-free fragments.\n- Those with at least one nucleosome in between buth whose length is below 800bp.\n- Finally, those whose length is too big (bigger than 800bp).\n- They will not be correctly amplified by PCR and/or not efficiently sequenced by illumina sequencers.\n- Because of the second type of fragments,\n- it is important to build coverage around the insertion sites and not fully between the mates of the pairs.\n- If the pairs are larger apart than 170bp you don't know if there was a nucleosome between them.\n\n---\n\n### Characteristics of ATAC-Seq design\n\n- Typically you have at least two biological replicates.\n- You may also have a control. A control could be purified DNA, which has no more nucleosomes, treated with Tn5. It is sequenced along with the ATAC sample.\n- ATAC-Seq is usually paired-end sequencing. This way is easier to idenfiy a nucleosome-free region. That is why you need both reads.\n\n???\n\n- Here are the main characterstics of the design of a good ATAC-seq experiment.\n- You will usually have biological replicates.\n- You may also have a control.\n- If you want to distinguish between the two types of fragments described in the previous slide you want to have paired-end sequencing.\n\n---\n\n## How to analyze ATAC-Seq data?\n\n???\n\n- How to analyze ATAC-seq data?\n\n---\n\n### Check the Insert Size\n\n.image-50[\n  ![A bar chart mapping frequency to insert size in base pairs. The graph data starts at insert size 20, there is a large sharp peak around 50 to 2000 frequency, and this rapidly decreases to ~200 frequency. There are additional small and broad peaks at insert size 200, 400, and 600 but the graph steadily decreases.](../../images/atac-seq/Screenshot_sizeDistribution.png)\n]\n\n- Typical insert size of 50-300 bp.\n- The first peak of 50 basepairs correspond to nucleosome-free regions.\n- The second peak that is a bit less than 200 basepairs corresponds to a single nucleosome.\n\n???\n\n- A good indication of the quality of the ATAC-seq data is given by the profile of insert sizes.\n- We expect to see a high peak centered around 50bp which corresponds to nucleosome-free fragments and a second bump around 200bp corresponding to fragments exactly around a nucleosome.\n- The third one (around 400bp) is where Tn5 inserted around two adjacent nucleosomes and the fourth one (around 600bp) is where Tn5 inserted around three adjacent nucleosomes.\n\n---\n\n## Do not worry about a nucleotide bias\n\n![Fastqc plot showing sequence content as percent of the four bases, A C T G as a function of their position in the read. Below position 17, the lines are extremely jagged showing widely varying distribution of nucleotides that changes base by base. After position 17 in the read this stabilises to ~22% CG/~28% AT.](../../images/atac-seq/per_base_sequence_content.png)\n\n- Your experiment might have a nucelotide bias because of the transposase treatment ([Brian Green et. al. 2012](https://doi.org/10.1186/1759-8753-3-3))\n\n???\n\n- If you do a QC for nucleosome bias. You expect to find one bias because of the transposase treatment.\n\n---\n\n## Filtering Reads\n\n- Filter for uniquely mapped reads with end-to-end alignment.\n- Remove reads mapping to mitochondrial DNA.\n- Remove PCR duplicates.\n\n???\n\n- ATAC-seq analysis require filters which are commong to other applications like the filtering of uniquely mapped reads or PCR duplicates.\n- End-to-End alignement is probably useful because you are interested in the exact open chromatin regions.\n- Other filtering steps are specific to ATAC-seq.\n- ATAC-seq datasets usually contain a large percentage of reads that are derived from mitochondrial DNA.\n- Since there are no ATAC-seq peaks of interest in the mitochondrial genome you can discard those reads.\n- Especially because there is no nucleosome on the mitochondrion, so it makes this part of the genome very sensitive to Tn5.\n\n---\n\n## Peak Calling\n\n.image-50[\n  ![Cartoon of nucleosomes shown as large spheres with dna sequence wrapped aroud them and connecting them like lights on a string. Tn5 is binding to the DNA connecting the nucleosomes, and transcription factor is bound to the Tn5 molecules. Reads are shown as arrows pointing towards each other, below the Tn5 molecules.](../../images/atac-seq/schemeWithLegend.jpg)\n]\n\n- When Tn5 cuts an accessible chromatin locus it inserts adapters separated by 9 basepairs [Kia et al. 2017](https://doi.org/10.1186/s12896-016-0326-1).\n- You would prefer a peak caller taking into consideration that the adapters are separated by 9 basepairs.\n- Because the ATAC-seq fragments are mixture of nucleosome-free fragments and fragments with nucleosome between mates, you need to adapt the parameters of peak calling algorithms.\n- We recommand MACS2 with adapted parameters.\n\n???\n\n- During the process, the Tn5 introduces a 9bp duplications.\n- This means that to have the read start site reflect the centre of where Tn5 bound, the reads on the positive strand should be shifted 4 bp to the right and reads on the negative strands should be shifted 5 bp to the left as in Buenrostro et al. 2013.\n- While the previous steps were very close to a ChIP-seq analysis.\n- The peak calling need to be performed with care.\n- Indeed, to get peaks at accessible regions and not on nucleosome, the parameters of the peak calling need to be adapted to use the 5 prime position of the read.\n\n---\n\n## Overview\n\n![Schematic of the ATAC-Seq workflow. dataset R1 and R2 are run through FastQC which points to a cloud labelled \"QC Measures\". The two datasets also go through cutadapt to produce trimmed r1 and r2. This goes to bowtie2 which produces alignments, and another cloud labelled QC measures. The alignments output goes to bamtools filter to produce filtered alignments, which then goes to mark duplicates to produce a filtered without duplicate alignments file. This is sent to MACS2 which produces coverage and peaks outputs. Those, in combination with annotations for the genome are sent to deepTools for heatmaps summarizing multiple regions, and pyGenomeTracks for tracks displaying a specific region.](../../images/atac-seq/ATACWF.svg)\n\n- This is an overview of ATAC-Seq data analysis.\n\n???\n\n- This is an overview of the workflow which is used in the tutorial.\n- The preprocessing with cutadapt.\n- The mapping with bowtie2.\n- The different filtering steps.\n- The peak calling.\n- The different visualisations.\n"],"hands_on":true,"slides":true,"mod_date":"2024-05-29 14:28:52 +0000","pub_date":"2019-09-02 16:17:33 +0000","version":91,"workflows":[{"workflow":"main_workflow.ga","tests":false,"url":"https://training.galaxyproject.org/training-material/topics/epigenetics/tutorials/atac-seq/workflows/main_workflow.ga","path":"topics/epigenetics/tutorials/atac-seq/workflows/main_workflow.ga","wfid":"epigenetics-atac-seq","wfname":"main_workflow","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/epigenetics-atac-seq/versions/main_workflow","license":null,"creators":[],"name":"ATAC-seq GTM","title":"ATAC-seq GTM","test_results":null,"modified":"2024-06-20 10:21:35 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\nbed file with genes\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"ℹ️ Input Dataset\\nctcf peaks\"];\n  style 1 stroke:#2c3143,stroke-width:4px;\n  2[\"ℹ️ Input Dataset\\nATAC R2 read in fastq.gz format\"];\n  style 2 stroke:#2c3143,stroke-width:4px;\n  3[\"ℹ️ Input Dataset\\nATAC R1 read in fastq.gz format\"];\n  style 3 stroke:#2c3143,stroke-width:4px;\n  4[\"Filter\"];\n  1 -->|output| 4;\n  5[\"FastQC\"];\n  2 -->|output| 5;\n  6[\"ATAC remove nextera adapters with cutadapt\"];\n  3 -->|output| 6;\n  2 -->|output| 6;\n  7[\"FastQC\"];\n  3 -->|output| 7;\n  8[\"bedtools Intersect intervals\"];\n  4 -->|out_file1| 8;\n  0 -->|output| 8;\n  9[\"FastQC\"];\n  6 -->|out2| 9;\n  10[\"Bowtie2\"];\n  6 -->|out1| 10;\n  6 -->|out2| 10;\n  11[\"FastQC\"];\n  6 -->|out1| 11;\n  12[\"Filter BAM ATAC\"];\n  10 -->|output| 12;\n  13[\"MarkDuplicates\"];\n  12 -->|out_file1| 13;\n  14[\"bedtools BAM to BED\"];\n  13 -->|outFile| 14;\n  15[\"Paired-end histogram\"];\n  13 -->|outFile| 15;\n  16[\"MACS2 callpeak\"];\n  14 -->|output| 16;\n  17[\"Wig/BedGraph-to-bigWig\"];\n  16 -->|output_treat_pileup| 17;\n  18[\"computeMatrix\"];\n  17 -->|out_file1| 18;\n  0 -->|output| 18;\n  19[\"pyGenomeTracks\"];\n  17 -->|out_file1| 19;\n  16 -->|output_narrowpeaks| 19;\n  0 -->|output| 19;\n  1 -->|output| 19;\n  20[\"computeMatrix\"];\n  17 -->|out_file1| 20;\n  8 -->|output| 20;\n  65159c9c-050b-4069-8704-8f66c0563a98[\"Output\\ncomputeMatrix on input dataset(s): Matrix\"];\n  20 --> 65159c9c-050b-4069-8704-8f66c0563a98;\n  style 65159c9c-050b-4069-8704-8f66c0563a98 stroke:#2c3143,stroke-width:4px;\n  21[\"plotHeatmap\"];\n  18 -->|outFileName| 21;\n  22[\"plotHeatmap\"];\n  20 -->|outFileName| 22;\n  74a36643-b88f-4378-8f9c-c1b20ee2651e[\"Output\\nplotHeatmap on input dataset(s): Image\"];\n  22 --> 74a36643-b88f-4378-8f9c-c1b20ee2651e;\n  style 74a36643-b88f-4378-8f9c-c1b20ee2651e stroke:#2c3143,stroke-width:4px;"}],"api":"https://training.galaxyproject.org/training-material/api/topics/epigenetics/tutorials/atac-seq/tutorial.json","tools":["Cut1","Filter1","Grep1","toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_compute_matrix/deeptools_compute_matrix/3.3.2.0.0","toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_plot_heatmap/deeptools_plot_heatmap/3.3.2.0.1","toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_sort_header_tool/1.1.1","toolshed.g2.bx.psu.edu/repos/devteam/bamtools_filter/bamFilter/2.4.1","toolshed.g2.bx.psu.edu/repos/devteam/bowtie2/bowtie2/2.4.2+galaxy0","toolshed.g2.bx.psu.edu/repos/devteam/fastqc/fastqc/0.72+galaxy1","toolshed.g2.bx.psu.edu/repos/devteam/picard/picard_MarkDuplicates/2.18.2.2","toolshed.g2.bx.psu.edu/repos/devteam/samtools_idxstats/samtools_idxstats/2.0.3","toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_bamtobed/2.30.0","toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_intersectbed/2.30.0","toolshed.g2.bx.psu.edu/repos/iuc/macs2/macs2_callpeak/2.1.1.20160309.6","toolshed.g2.bx.psu.edu/repos/iuc/pe_histogram/pe_histogram/1.0.1","toolshed.g2.bx.psu.edu/repos/iuc/pygenometracks/pygenomeTracks/3.6","toolshed.g2.bx.psu.edu/repos/lparsons/cutadapt/cutadapt/1.16.5","wig_to_bigWig"],"supported_servers":{"exact":[],"inexact":[{"url":"https://usegalaxy.cz/","name":"UseGalaxy.cz","usegalaxy":false},{"url":"https://usegalaxy.fr/","name":"UseGalaxy.fr","usegalaxy":false}]},"topic_name_human":"Epigenetics","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"deeptools_compute_matrix","owner":"bgruening","revisions":"514fa53b5efb","tool_panel_section_label":"deepTools","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"deeptools_plot_heatmap","owner":"bgruening","revisions":"a4dfb122e52b","tool_panel_section_label":"deepTools","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"text_processing","owner":"bgruening","revisions":"d698c222f354","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"bamtools_filter","owner":"devteam","revisions":"cb20f99fd45b","tool_panel_section_label":"SAM/BAM","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"bowtie2","owner":"devteam","revisions":"a6d65b0c67af","tool_panel_section_label":"Mapping","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"fastqc","owner":"devteam","revisions":"e7b2202befea","tool_panel_section_label":"FASTA/FASTQ","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"picard","owner":"devteam","revisions":"a1f0b3f4b781","tool_panel_section_label":"Picard","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"samtools_idxstats","owner":"devteam","revisions":"7a6034296ae9","tool_panel_section_label":"SAM/BAM","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"bedtools","owner":"iuc","revisions":"ce3c7f062223","tool_panel_section_label":"BED","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"bedtools","owner":"iuc","revisions":"a68aa6c1204a","tool_panel_section_label":"BED","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"macs2","owner":"iuc","revisions":"424aefbd7777","tool_panel_section_label":"Peak Calling","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"pe_histogram","owner":"iuc","revisions":"bd1416eea1f0","tool_panel_section_label":"Graph/Display Data","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"pygenometracks","owner":"iuc","revisions":"2824d77cd8f8","tool_panel_section_label":"Graph/Display Data","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"cutadapt","owner":"lparsons","revisions":"49370cb85f0f","tool_panel_section_label":"FASTA/FASTQ","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: deeptools_compute_matrix\n  owner: bgruening\n  revisions: 514fa53b5efb\n  tool_panel_section_label: deepTools\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: deeptools_plot_heatmap\n  owner: bgruening\n  revisions: a4dfb122e52b\n  tool_panel_section_label: deepTools\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: text_processing\n  owner: bgruening\n  revisions: d698c222f354\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bamtools_filter\n  owner: devteam\n  revisions: cb20f99fd45b\n  tool_panel_section_label: SAM/BAM\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bowtie2\n  owner: devteam\n  revisions: a6d65b0c67af\n  tool_panel_section_label: Mapping\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: fastqc\n  owner: devteam\n  revisions: e7b2202befea\n  tool_panel_section_label: FASTA/FASTQ\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: picard\n  owner: devteam\n  revisions: a1f0b3f4b781\n  tool_panel_section_label: Picard\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: samtools_idxstats\n  owner: devteam\n  revisions: 7a6034296ae9\n  tool_panel_section_label: SAM/BAM\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bedtools\n  owner: iuc\n  revisions: ce3c7f062223\n  tool_panel_section_label: BED\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bedtools\n  owner: iuc\n  revisions: a68aa6c1204a\n  tool_panel_section_label: BED\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: macs2\n  owner: iuc\n  revisions: 424aefbd7777\n  tool_panel_section_label: Peak Calling\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: pe_histogram\n  owner: iuc\n  revisions: bd1416eea1f0\n  tool_panel_section_label: Graph/Display Data\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: pygenometracks\n  owner: iuc\n  revisions: 2824d77cd8f8\n  tool_panel_section_label: Graph/Display Data\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: cutadapt\n  owner: lparsons\n  revisions: 49370cb85f0f\n  tool_panel_section_label: FASTA/FASTQ\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":true,"slides_recordings":[{"captioners":["lldelisle"],"date":"2021-02-15","galaxy_version":"21.01","length":"15M","youtube_id":"2jPNNd5YJNM","speakers":["lldelisle"]}],"translations":{"tutorial":[],"slides":[],"video":true},"license":"CC-BY-4.0","type":"tutorial"}