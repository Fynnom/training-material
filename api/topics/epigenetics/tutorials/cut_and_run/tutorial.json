{"layout":"tutorial_hands_on","title":"CUT&RUN data analysis","draft":true,"zenodo_link":"https://zenodo.org/record/3862793","questions":["Which binding motif has the transcription factor GATA1?","What kind of quality control do I have to do?","How to analyse and visualise CUT&RUN data?"],"objectives":["Apply appropriate analysis and quality control steps for CUT&RUN","Apply an enrichment analysis and a robust peak detection","Find protein binding motifs"],"time_estimation":"3h","key_points":["CUT&RUN can be used to identify binding regions for DNA binding proteins.","Several filters are applied to the reads, such as removing those mapped to mitochondria","Fragment distribution can help determine whether an CUT&RUN experiment has worked well","A robust peak detection removes noise from the data"],"contributions":{"authorship":["heylf"],"editing":["hexylena","lldelisle"]},"abbreviations":{"CUT&RUN":"Cleavage Under Targets and Release Using Nuclease","POI":"protein of interest","pA(G)-MNase":"protein A(-protein G hybrid)-micrococcal nuclease","TF":"transcription factors"},"js_requirements":{"mathjax":null,"mermaid":false},"short_id":"T00424","url":"/topics/epigenetics/tutorials/cut_and_run/tutorial.html","topic_name":"epigenetics","tutorial_name":"cut_and_run","dir":"topics/epigenetics/tutorials/cut_and_run","symlink":null,"id":"epigenetics/cut_and_run","ref_tutorials":["<h1 id=\"introduction\">Introduction</h1>\n<p>In many organism, transcription factors (TF) play an important tole in the regulation of the gene expression. In human, we have up to 2,800 proteins and more than 1,600 are\nTF (<a href=\"https://en.wikipedia.org/wiki/List_of_human_transcription_factors\">list of transcription factors</a>), although the number might change over timer.\nInvestigating the role of TFs, such as <a href=\"https://en.wikipedia.org/wiki/GATA1\">GATA1</a>, is a very important task to understand the regulatory mechanisms in the cell and thus ascertain\nthe source of a disease, such as <a href=\"https://en.wikipedia.org/wiki/Primary_myelofibrosis\">myelofibrosis</a> a type of blood cancer.</p>\n\n<figure id=\"figure-1\" style=\"max-width: 90%;\"><img src=\"../../images/cut_and_run/cut_and_run.png\" alt=\"CUT_and_RUN. \" width=\"4240\" height=\"3282\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/cut_and_run/cut_and_run.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 1</strong>:</span> Skene and Henikoff 2017 eLIFE</figcaption></figure>\n\n<p>Cleavage Under Targets and Release Using Nuclease (CUT&amp;RUN) <span class=\"citation\"><a href=\"#Skene2017\">Skene and Henikoff 2017</a></span> became the new and advanced method to analyse DNA-associated proteins. CUT&amp;RUN uses an antibody just as <a href=\"https://en.wikipedia.org/wiki/ChIP_sequencing\">ChIP-Seq</a> to select the protein of interest (POI).\nThe big difference, CUT&amp;RUN couples the usage of an antibody with the usage of a pA-MNase, which you can see in <strong>Figure 1</strong>. In the revised version of the protocol <span class=\"citation\"><a href=\"#Meers2019\">Meers <i>et al.</i> 2019</a></span>,\nthe pA-MNase has been replaced by a {pA(G)-MNase} to expand this technology to mouse primary antibodies. The <a href=\"https://en.wikipedia.org/wiki/Micrococcal_nuclease\">enzyme</a> fused to the protein A/G is an\nendo-exonuclease that cleaves and shortens DNA. The fusion will ensure that the MNase comes in close proximity with the POI and thus cleaves DNA <em>in-situ</em>, close to POI binding sites. CUT&amp;RUN allows to\nfragment the DNA in unfixed cells and thus allows to study protein-DNA interactions in a more natural state. The added pA(G)-MNase thus creates shorted fragments that lead to a higher resolution for the mapping\nin comparison to your standard ChIP-Seq protocol. CUT&amp;RUN follows four fundamental steps: (1) permeabilize the nuclei or cells coated on beads, (2) incubate with the selective antibody of the POI, (3)\nadd the pA(G)-MNase and activate the enzyme for a small period of time, (4) release CUT&amp;RUN fragments and collect the DNA from the supernatant. Afterward, the DNA can be purified, PCR amplified and\nprepared for sequencing. You can find the CUT&amp;RUN protocol at <a href=\"https://www.protocols.io/view/cut-amp-run-targeted-in-situ-genome-wide-profiling-14egnr4ql5dy/v3\">protocols.io</a>.</p>\n\n<p>In this tutorial, we will use data from the study of <span class=\"citation\"><a href=\"#Zhu2019\">Zhu <i>et al.</i> 2019</a></span>. The article introduces a CUT&amp;RUN pipeline that we will <strong>not</strong> completely follow. It is important to note at this point that\na CUT&amp;RUN data analysis is more similar to an ATAC-Seq experiment than a standard ChIP-Seq. We will analyze the two biological replicates from a CUT&amp;RUN experiment for the aforementioned TF GATA1 in humans.\nWe downsampled the data to speed up the run times in this tutorial. Our results will be compared to identified binding sites of GATA1 of a ChIP-Seq experiment <span class=\"citation\"><a href=\"#Canver2017\">Canver <i>et al.</i> 2017</a></span>.</p>\n\n<h2 id=\"when-working-with-real-data\">When working with real data</h2>\n<p>The workflow for this training material can be found <a href=\"https://usegalaxy.eu/u/heylf/w/copy-of-cutandrunlong\">at the European Galaxy instance</a>. When you use your data we suggest using <a href=\"https://usegalaxy.eu/u/heylf/w/cutandrunlong\">this workflow</a>\nwhich includes additional steps for your data analysis. Both workflows do not support peak calling with controls as CUT&amp;RUN has a low background.\nIt is often recommended to use a positive or negative control as a comparison. Spike-in controls can be done for CUT&amp;RUN but need then additional steps in the provided workflows to consider them.</p>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n  <p>In this tutorial, we will cover:</p>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#introduction\" id=\"markdown-toc-introduction\">Introduction</a>    <ol>\n      <li><a href=\"#when-working-with-real-data\" id=\"markdown-toc-when-working-with-real-data\">When working with real data</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#step-1-preprocessing\" id=\"markdown-toc-step-1-preprocessing\">Step 1: Preprocessing</a>    <ol>\n      <li><a href=\"#get-data\" id=\"markdown-toc-get-data\">Get Data</a></li>\n      <li><a href=\"#quality-control\" id=\"markdown-toc-quality-control\">Quality Control</a></li>\n      <li><a href=\"#trimming-reads\" id=\"markdown-toc-trimming-reads\">Trimming Reads</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#step-2-mapping\" id=\"markdown-toc-step-2-mapping\">Step 2: Mapping</a>    <ol>\n      <li><a href=\"#mapping-reads-to-reference-genome\" id=\"markdown-toc-mapping-reads-to-reference-genome\">Mapping Reads to Reference Genome</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#step-3-filtering-mapped-reads-and-second-level-quality-control\" id=\"markdown-toc-step-3-filtering-mapped-reads-and-second-level-quality-control\">Step 3: Filtering Mapped Reads and second level Quality Control</a>    <ol>\n      <li><a href=\"#filter-uninformative-reads\" id=\"markdown-toc-filter-uninformative-reads\">Filter Uninformative Reads</a></li>\n      <li><a href=\"#filter-duplicate-reads\" id=\"markdown-toc-filter-duplicate-reads\">Filter Duplicate Reads</a></li>\n      <li><a href=\"#check-deduplication-and-adapter-removal\" id=\"markdown-toc-check-deduplication-and-adapter-removal\">Check Deduplication and Adapter Removal</a></li>\n      <li><a href=\"#check-insert-sizes\" id=\"markdown-toc-check-insert-sizes\">Check Insert Sizes</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#step-4-peak-calling\" id=\"markdown-toc-step-4-peak-calling\">Step 4: Peak calling</a>    <ol>\n      <li><a href=\"#call-peaks\" id=\"markdown-toc-call-peaks\">Call Peaks</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#step-5-identifying-binding-motifs\" id=\"markdown-toc-step-5-identifying-binding-motifs\">Step 5: Identifying Binding Motifs</a>    <ol>\n      <li><a href=\"#prepare-the-datasets\" id=\"markdown-toc-prepare-the-datasets\">Prepare the Datasets</a></li>\n      <li><a href=\"#motif-detection-with-meme-chip\" id=\"markdown-toc-motif-detection-with-meme-chip\">Motif detection with MEME-ChIP</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#conclusion\" id=\"markdown-toc-conclusion\">Conclusion</a></li>\n</ol>\n\n</blockquote>\n\n<!--SNIPPET-->\n<blockquote class=\"comment\">   <div class=\"box-title comment-title\" id=\"comment-results-may-vary\"><i class=\"far fa-comment-dots\" aria-hidden=\"true\"></i> Comment: Results may vary</div>   <p>Your results may be slightly different from the ones presented in this tutorial due to differing versions of tools, reference data, external databases, or because of stochastic processes in the algorithms.</p> </blockquote>\n<p><!--END_SNIPPET--></p>\n\n<h1 id=\"step-1-preprocessing\">Step 1: Preprocessing</h1>\n\n<h2 id=\"get-data\">Get Data</h2>\n\n<p>We first need to download the sequenced reads (FASTQs) as well as other annotation files. Then, to increase the number of reads that will map to the reference genome (here human genome version 38, GRCh38/hg38), we need to preprocess the reads.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Data upload</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Create a new history for this tutorial</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-new-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-new-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a new history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>Click the <i class=\"fas fa-plus\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">new-history</span> icon at the top of the history panel:</p>   <p><img src=\"/training-material/shared/images/history_create_new.svg\" alt=\"UI for creating new history\" /></p>   <!-- the original drawing can be found here https://docs.google.com/drawings/d/1cCBrLAo4kDGic5QyB70rRiWJAKTenTU8STsKDaLcVU8/edit?usp=sharing --> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Import the files from <a href=\"https://doi.org/10.5281/zenodo.3862792\">Zenodo</a> or from\nthe shared data library (<code class=\"language-plaintext highlighter-rouge\">GTN - Material</code> -&gt; <code class=\"language-plaintext highlighter-rouge\">epigenetics</code>\n -&gt; <code class=\"language-plaintext highlighter-rouge\">CUT&amp;RUN data analysis</code>):</p>\n\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/6823059/files/chip_seq_peaks.bed\nhttps://zenodo.org/record/6823059/files/Rep1_R1.fastq\nhttps://zenodo.org/record/6823059/files/Rep1_R2.fastq\nhttps://zenodo.org/record/6823059/files/Rep2_R1.fastq\nhttps://zenodo.org/record/6823059/files/Rep2_R2.fastq\n</code></pre></div>      </div>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-via-links\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-via-links\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing via links</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-data-from-a-data-library\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-data-from-a-data-library\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing data from a data library</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>As an alternative to uploading the data from a URL or your computer, the files may also have been made available from a <em>shared data library</em>:</p>   <ol>   <li>Go into <strong>Shared data</strong> (top panel) then <strong>Data libraries</strong></li>   <li>Navigate to  the correct folder as indicated by your instructor.     <ul>       <li>On most Galaxies tutorial data will be provided in a folder named <strong>GTN - Material –&gt; Topic Name -&gt; Tutorial Name</strong>.</li>     </ul>   </li>   <li>Select the desired files</li>   <li>Click on <strong>Add to History</strong> <i class=\"fas fa-caret-down\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-dropdown</span> near the top and select <strong>as Datasets</strong> from the dropdown menu</li>   <li>     <p>In the pop-up window, choose</p>     <ul>       <li><em>“Select history”</em>: the history you want to import the data to (or create a new one)</li>     </ul>   </li>   <li>Click on <strong>Import</strong></li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Add a tag called <code class=\"language-plaintext highlighter-rouge\">#rep1</code> to the Rep1 files and a tag called <code class=\"language-plaintext highlighter-rouge\">#rep2</code> to the Rep2 files.</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-adding-a-tag\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-adding-a-tag\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Adding a tag</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ol>   <li>Click on the dataset to expand it</li>   <li>Click on <strong>Add Tags</strong> <i class=\"fas fa-tags\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-tags</span></li>   <li>Add a tag  starting with <code class=\"language-plaintext highlighter-rouge\">#</code>     <ul>       <li>Tags starting with <code class=\"language-plaintext highlighter-rouge\">#</code> will be automatically propagated to the outputs of tools using this dataset.</li>     </ul>   </li>   <li>Press <kbd>Enter</kbd></li>   <li>Check that the tag appears below the dataset name</li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Check that the datatype of the 4 FASTQ files is <code class=\"language-plaintext highlighter-rouge\">fastqsanger</code> and the peak file (chip_seq_peaks.bed) is <code class=\"language-plaintext highlighter-rouge\">bed</code>. If they are not then change the datatype as described below.</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-changing-the-datatype\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-changing-the-datatype\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Changing the datatype</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, click <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Datatypes</strong> tab on the top</li>   <li>In the <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Assign Datatype</strong>, select <code class=\"language-plaintext highlighter-rouge\">datatypes</code> from “<em>New type</em>” dropdown     <ul>       <li>Tip: you can start typing the datatype into the field to filter the dropdown menu</li>     </ul>   </li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Create a paired collection named <code class=\"language-plaintext highlighter-rouge\">2 PE fastqs</code>, and rename your pairs with the sample name followed by the attributes: <code class=\"language-plaintext highlighter-rouge\">Rep1</code> and <code class=\"language-plaintext highlighter-rouge\">Rep2</code>.</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-paired-collection\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-paired-collection\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a paired collection</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on <i class=\"far fa-check-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-selector</span> <strong>Select Items</strong> at the top of the history panel <img src=\"/training-material/topics/galaxy-interface/images/historyItemControls.png\" alt=\"Select Items button\" /></li>   <li>Check all the datasets in your history you would like to include</li>   <li>     <p>Click <strong>n of N selected</strong> and choose <strong>Build List of Dataset Pairs</strong></p>   </li>   <li>Change the text of <em>unpaired forward</em> to a common selector for the forward reads</li>   <li>Change the text of <em>unpaired reverse</em> to a common selector for the reverse reads</li>   <li>Click <strong>Pair these datasets</strong> for each valid <em>forward</em> and <em>reverse</em> pair.</li>   <li>Enter a name for your collection</li>   <li>Click <strong>Create List</strong> to build your collection</li>   <li>Click on the checkmark icon at the top of your history again</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Rename the bed file <code class=\"language-plaintext highlighter-rouge\">GATA1 ChIP-Seq peaks</code>.</p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"comment\">\n  <comment-title>FASTQ format</comment-title>\n  <p>If you are not familiar with FASTQ format, see the <a href=\"/training-material/topics/sequence-analysis/tutorials/quality-control/tutorial.html\">Quality Control tutorial</a></p>\n</blockquote>\n<blockquote class=\"comment\">\n\n  <comment-title>BED / encode narrowPeak format</comment-title>\n  <p>If you are not familiar with BED format or encode narrowPeak format, see the <a href=\"https://genome.ucsc.edu/FAQ/FAQformat.html\">BED Format</a></p>\n</blockquote>\n\n<h2 id=\"quality-control\">Quality Control</h2>\n\n<p>We first have to check if our data contains adapter sequences that we have to remove. A typical CUT&amp;RUN experiment has a read length of 30-80 nt. We can check the raw data quality with <strong>FastQC</strong>.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Quality Control</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"__FLATTEN__\" title=\"Flatten collection tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Flatten collection</strong></span> with the following parameters convert the list of pairs into a simple list:\n      <ul>\n        <li><em>“Input Collection”</em>: <code class=\"language-plaintext highlighter-rouge\">2 PE fastqs</code></li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/devteam/fastqc/fastqc/0.73+galaxy0\" title=\"FastQC tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>FastQC</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.73+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><em>“Short read data from your current history”</em>: Choose the output of <strong>Flatten collection</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>selected as <strong>Dataset collection</strong>.</li>\n      </ul>\n    </li>\n    <li>Inspect the web page output of <strong>FastQC</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> for the <code class=\"language-plaintext highlighter-rouge\">Rep1_forward</code> sample. Check what adapters are found at the end of the reads.</li>\n  </ol>\n\n  <blockquote class=\"question\">\n    <question-title></question-title>\n\n    <ol>\n      <li>How many reads are in the FASTQ?</li>\n      <li>Which sections have a warning or an error?</li>\n    </ol>\n\n    <blockquote class=\"solution\">\n      <solution-title></solution-title>\n\n      <ol>\n        <li>There are 300,000 reads.</li>\n        <li>\n          <p>The 4 steps below have warnings:</p>\n\n          <ol>\n            <li>\n              <p><strong>Per base sequence content</strong></p>\n\n              <p>CUT&amp;RUN has sometimes base biases like ChIP-Seq.</p>\n            </li>\n            <li>\n              <p><strong>Sequence Duplication Levels</strong></p>\n\n              <p>The read library quite often has PCR duplicates that are introduced\nsimply by the PCR itself. We will remove these duplicates later on.</p>\n            </li>\n            <li>\n              <p><strong>Overrepresented sequences</strong></p>\n\n              <p>Our data contains TruSeq adapter, Illumina PCR Primer, and a read from the mitochondrial chromosome.</p>\n            </li>\n            <li>\n              <p><strong>Adapter Content</strong></p>\n\n              <p>Our data contains an adapter that we still have to remove.</p>\n            </li>\n          </ol>\n        </li>\n      </ol>\n\n    </blockquote>\n\n  </blockquote>\n</blockquote>\n\n<blockquote class=\"comment\">\n  <comment-title>FastQC Results</comment-title>\n  <p>This is what you should expect from the <strong>Adapter Content</strong> section:</p>\n  <figure id=\"figure-2\" style=\"max-width: 90%;\"><img src=\"../../images/cut_and_run/adapter_content_pre.png\" alt=\"FastQC screenshot of the Adapter Content section. \" width=\"821\" height=\"585\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/cut_and_run/adapter_content_pre.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 2</strong>:</span> FastQC screenshot on the Adapter Content section</figcaption></figure>\n</blockquote>\n\n<p>The FastQC report pointed out that we have in our data some standard Illumina adapter sequences, which we will remove with Trim Galore!.</p>\n\n<h2 id=\"trimming-reads\">Trimming Reads</h2>\n\n<p><strong>Trim Galore!</strong> is a handy tool that can automatically detect and trim standard Illumina adapters.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Task description</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\" https://toolshed.g2.bx.psu.edu/view/bgruening/trim_galore/cd7e644cae1d\" title=\"Trim Galore! tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Trim Galore!</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version cd7e644cae1d)</span> with the following parameters:\n      <ul>\n        <li><em>“Is this library paired- or single-end?”</em>: <code class=\"language-plaintext highlighter-rouge\">Paired Collection</code>\n          <ul>\n            <li><em>“Select a paired collection”</em>: select <code class=\"language-plaintext highlighter-rouge\">2 PE fastqs</code></li>\n          </ul>\n        </li>\n        <li>In <em>“Adapter sequence to be trimmed”</em>: <code class=\"language-plaintext highlighter-rouge\">Illumina universal</code></li>\n        <li><em>Avanced settings</em>: <code class=\"language-plaintext highlighter-rouge\">Full parameter list</code></li>\n        <li>In <em>“Trim low-quality ends from reads in addition to adapter removal (Enter phred quality score threshold)”</em>: <code class=\"language-plaintext highlighter-rouge\">30</code></li>\n        <li>In <em>“Discard reads that became shorter than length N”</em>: <code class=\"language-plaintext highlighter-rouge\">15</code></li>\n        <li>In <em>“Generate a report file”</em>:   <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n      </ul>\n    </li>\n    <li>Click on the <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> (eye) icon of the report for <code class=\"language-plaintext highlighter-rouge\">Rep1</code> and read the first lines.</li>\n  </ol>\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>What percentage of reads contain adapters?</li>\n    <li>What percentage of reads are still longer than 15bp after the trimming?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>~55% and ~57%</li>\n      <li>100%</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<h1 id=\"step-2-mapping\">Step 2: Mapping</h1>\n\n<h2 id=\"mapping-reads-to-reference-genome\">Mapping Reads to Reference Genome</h2>\n\n<p>Next, we map the trimmed reads to the human reference genome. Here we will use <strong>Bowtie2</strong>. We will extend the maximum fragment length (distance between read pairs) from 500 to 1000 because\nwe know some valid read pairs are from this fragment length. We will use the <code class=\"language-plaintext highlighter-rouge\">--very-sensitive</code> parameter to have more chances to get the best match even if it takes a bit longer to run.\nWe will run the <strong>end-to-end</strong> mode because we trimmed the adapters, so we expect the whole read to map, no clipping of ends is needed. Regarding the genome to choose.\nThe hg38 version of the human genome contains <a href=\"https://www.ncbi.nlm.nih.gov/grc/help/definitions/#ALTERNATE\">alternate loci</a>. This means that some regions of the genome\nare present both in the canonical chromosome and on its alternate loci. The reads that map to these regions would map twice. To be able to filter reads falling into\nrepetitive regions but keep reads falling into regions present in alternate loci, we will map on the Canonical version of hg38 (only the chromosome with numbers, chrX, chrY, and chrM).</p>\n\n<blockquote class=\"comment\">\n  <comment-title>Dovetailing</comment-title>\n  <p>We will allow dovetailing of read pairs with Bowtie2. This is because adapters are removed by Cutadapt only when at least 3 bases match the adapter sequence, so it is possible that after trimming a read can contain 1-2 bases of adapter and go beyond it’s mate start site. This occurs especially for CUT&amp;RUN because the read length is quite short. Bowtie thus discards reads such as:</p>\n  <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>---------------------Mate 1---------------------------------&gt;\n&lt;---------------------Mate 2----------------------\n</code></pre></div>  </div>\n\n  <p>or</p>\n\n  <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>---------------------Mate 1---------------------------------&gt;\n&lt;---------------------Mate 2---------------------------------\n</code></pre></div>  </div>\n\n  <p>This is what we call dovetailing and we want to consider this pair as a valid concordant alignment.</p>\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Mapping reads to reference genome</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/devteam/bowtie2/bowtie2/2.4.5+galaxy1\" title=\"Bowtie2 tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Bowtie2</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.4.5+galaxy1)</span> with the following parameters:\n      <ul>\n        <li><em>“Is this single or paired library”</em>: <code class=\"language-plaintext highlighter-rouge\">Paired-end Dataset Collection</code>\n          <ul>\n            <li><em>“FASTQ Paired Dataset</em>: select the output of <strong>Trim Galore!</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> <em>“paired reads”</em></li>\n            <li><em>“Do you want to set paired-end options?”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code>\n              <ul>\n                <li><em>“Set the maximum fragment length for valid paired-end alignments”</em>: <code class=\"language-plaintext highlighter-rouge\">1000</code></li>\n                <li><em>“Allow mate dovetailing”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n        <li><em>“Will you select a reference genome from your history or use a built-in index?”</em>: <code class=\"language-plaintext highlighter-rouge\">Use a built-in genome index</code>\n          <ul>\n            <li><em>“Select reference genome”</em>: <code class=\"language-plaintext highlighter-rouge\">Human (Homo sapiens): hg38 Canonical</code></li>\n          </ul>\n        </li>\n        <li><em>“Set read groups information?”</em>: <code class=\"language-plaintext highlighter-rouge\">Do not set</code></li>\n        <li><em>“Select analysis mode”</em>: <code class=\"language-plaintext highlighter-rouge\">1: Default setting only</code>\n          <ul>\n            <li><em>“Do you want to use presets?”</em>: <code class=\"language-plaintext highlighter-rouge\">Very sensitive end-to-end (--very-sensitive)</code></li>\n          </ul>\n        </li>\n        <li><em>“Do you want to tweak SAM/BAM Options?”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n        <li><em>“Save the bowtie2 mapping statistics to the history”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n      </ul>\n    </li>\n    <li>Click on the <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> (eye) icon of the mapping stats <code class=\"language-plaintext highlighter-rouge\">Rep1</code>.</li>\n  </ol>\n</blockquote>\n\n<blockquote class=\"comment\">\n  <comment-title>Bowtie2 Results</comment-title>\n  <p>You should get similar results to this from Bowtie2:</p>\n  <figure id=\"figure-3\" style=\"max-width: 90%;\"><img src=\"../../images/cut_and_run/mapping_stats.png\" alt=\"Mapping statistics of bowtie2. \" width=\"511\" height=\"269\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/cut_and_run/mapping_stats.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 3</strong>:</span> Mapping statistics of bowtie2</figcaption></figure>\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>What percentage of read pairs mapped concordantly?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <p>41.46+57.51=98.97%</p>\n\n  </blockquote>\n\n</blockquote>\n\n<h1 id=\"step-3-filtering-mapped-reads-and-second-level-quality-control\">Step 3: Filtering Mapped Reads and second level Quality Control</h1>\n\n<h2 id=\"filter-uninformative-reads\">Filter Uninformative Reads</h2>\n\n<p>We apply some filters to the reads after the mapping. CUT&amp;RUN datasets can have many reads that map to the mitochondrial genome because it is nucleosome-free and thus very accessible\nto the pA(G)-MNase. CUT&amp;RUN inserts adapter more easily in open chromatin regions due to the pA(G)-MNase activity. The mitochondrial genome is uninteresting for CUT&amp;RUN,\nso we remove these reads. We also remove reads with low mapping quality and reads that are not properly paired.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Filtering of uninformative reads</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/devteam/bamtools_filter/bamFilter/2.5.1+galaxy0\" title=\"Filter BAM datasets on a variety of attributes tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Filter BAM datasets on a variety of attributes</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.5.1+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“BAM dataset(s) to filter”</em>: Select the output of  <strong>Bowtie2</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> <em>“alignments”</em></li>\n        <li>In <em>“Condition”</em>:\n          <ul>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Condition”</em>\n              <ul>\n                <li>In <em>“Filter”</em>:\n                  <ul>\n                    <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Filter”</em>\n                      <ul>\n                        <li><em>“Select BAM property to filter on”</em>: <code class=\"language-plaintext highlighter-rouge\">mapQuality</code>\n                          <ul>\n                            <li><em>“Filter on read mapping quality (phred scale)”</em>: <code class=\"language-plaintext highlighter-rouge\">&gt;=30</code></li>\n                          </ul>\n                        </li>\n                      </ul>\n                    </li>\n                    <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Filter”</em>\n                      <ul>\n                        <li><em>“Select BAM property to filter on”</em>: <code class=\"language-plaintext highlighter-rouge\">Proper Pair</code>\n                          <ul>\n                            <li><em>“Select properly paired reads”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n                          </ul>\n                        </li>\n                      </ul>\n                    </li>\n                    <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Filter”</em>\n                      <ul>\n                        <li><em>“Select BAM property to filter on”</em>: <code class=\"language-plaintext highlighter-rouge\">Reference name of the read</code>\n                          <ul>\n                            <li><em>“Filter on the reference name for the read”</em>: <code class=\"language-plaintext highlighter-rouge\">!chrM</code></li>\n                          </ul>\n                        </li>\n                      </ul>\n                    </li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n        <li><em>“Would you like to set rules?”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n      </ul>\n    </li>\n    <li>Click on the input and the output BAM files of the filtering step. Check the size of the files.</li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>Based on the file size, what proportion of alignments was removed (approximately)?</li>\n    <li>Which parameter should be modified if you are interested in repetitive regions?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>\n        <p>The original BAM files are 14-15 MB, the filtered ones are 5.6 and 6.8 MB. Approximately half of the alignments were removed.</p>\n      </li>\n      <li>\n        <p>You should modify the mapQuality criteria and decrease the threshold.</p>\n      </li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<h2 id=\"filter-duplicate-reads\">Filter Duplicate Reads</h2>\n\n<p>Because of the PCR amplification, there might be read duplicates (different reads mapping to the same genomic region) from over amplification of some regions. We will remove them with <strong>Picard MarkDuplicates</strong>.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Remove duplicates</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/devteam/picard/picard_MarkDuplicates/2.18.2.3\" title=\"MarkDuplicates tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>MarkDuplicates</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.18.2.3)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“Select SAM/BAM dataset or dataset collection”</em>: Select the output of  <strong>Filter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> <em>“BAM”</em></li>\n        <li><em>“If true do not write duplicates to the output file instead of writing them with appropriate flags set”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n      </ul>\n\n      <blockquote class=\"comment\">\n        <comment-title>Default of  **MarkDuplicates** <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></comment-title>\n\n        <p>By default, the tool will only “Mark” the duplicates. This means that it will change the Flag of the duplicated reads to enable them to be filtered afterwards. We use the parameter <em>“If true do not write duplicates to the output file instead of writing them with appropriate flags set”</em> to directly remove the duplicates.</p>\n      </blockquote>\n    </li>\n    <li>Click on the <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> (eye) icon of the MarkDuplicate metrics.</li>\n  </ol>\n</blockquote>\n\n<blockquote class=\"comment\">\n  <comment-title>MarkDuplicates Results</comment-title>\n  <p>You should get a similar output to this from MarkDuplicates:</p>\n  <figure id=\"figure-4\" style=\"max-width: 90%;\"><img src=\"../../images/cut_and_run/mark_duplicates_screen.png\" alt=\"Metrics of MarkDuplicates. \" width=\"947\" height=\"497\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/cut_and_run/mark_duplicates_screen.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 4</strong>:</span> Metrics of MarkDuplicates</figcaption></figure>\n</blockquote>\n\n<blockquote class=\"tip\">\n  <tip-title>Formatting the MarkDuplicate metrics for readability</tip-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"Grep1\" title=\"Select lines that match an expression tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Select lines that match an expression</strong></span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“Select lines from”</em>: Select the output of  <strong>MarkDuplicates</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n        <li><em>“that</em>: <code class=\"language-plaintext highlighter-rouge\">Matching</code></li>\n        <li><em>“the pattern</em>: <code class=\"language-plaintext highlighter-rouge\">(Library|LIBRARY)</code></li>\n      </ul>\n    </li>\n    <li>\n      <p>Check that the datatype is tabular. If not, change it.</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-changing-the-datatype-1\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-changing-the-datatype-1\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Changing the datatype</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, click <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Datatypes</strong> tab on the top</li>   <li>In the <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Assign Datatype</strong>, select <code class=\"language-plaintext highlighter-rouge\">tabular</code> from “<em>New type</em>” dropdown     <ul>       <li>Tip: you can start typing the datatype into the field to filter the dropdown menu</li>     </ul>   </li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/datamash_transpose/datamash_transpose/1.1.0\" title=\"Transpose rows/columns in a tabular file tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Transpose rows/columns in a tabular file</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.1.0)</span>:\n      <ul>\n        <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“Select lines from”</em>: Select the output of <strong>Select</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n      </ul>\n    </li>\n  </ol>\n\n  <figure id=\"figure-5\" style=\"max-width: 90%;\"><img src=\"../../images/cut_and_run/mark_duplicates_transpose.png\" alt=\"Metrics of MarkDuplicates. \" width=\"435\" height=\"260\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/cut_and_run/mark_duplicates_transpose.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 5</strong>:</span> Metrics of MarkDuplicates</figcaption></figure>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>How many pairs were in the input?</li>\n    <li>How many pairs are duplicates?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>81466</li>\n      <li>983</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<p>Once again, if you have a high number of duplicates it does not mean that your data are not good, it just means that you sequenced\ntoo much compared to the diversity of the library you generated. Consequently, libraries with a high portion of duplicates should not be re-sequenced as this would not increase the amount of data.</p>\n\n<h2 id=\"check-deduplication-and-adapter-removal\">Check Deduplication and Adapter Removal</h2>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Check Adapter Removal with FastQC</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/devteam/fastqc/fastqc/0.73+galaxy0\" title=\"FastQC tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>FastQC</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.73+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“Short read data from your current history”</em>: select the output of <strong>MarkDuplicates</strong> .</li>\n      </ul>\n    </li>\n    <li>Click on the <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> (eye) icon of the report and read the first lines.</li>\n  </ol>\n</blockquote>\n\n<blockquote class=\"comment\">\n  <comment-title>FastQC Results</comment-title>\n  <p>Now, you should see under <strong>Overrepresented sequences</strong> that there is no more overrepresented sequences and under <strong>Adapter Content</strong> that the Illumina adapters are no longer present.</p>\n  <figure id=\"figure-6\" style=\"max-width: 90%;\"><img src=\"../../images/cut_and_run/adapter_content_post.png\" alt=\"FastQC screenshot on the adapter content section after Trim Galore!\" width=\"824\" height=\"584\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/cut_and_run/adapter_content_post.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 6</strong>:</span> FastQC screenshot on the adapter content section after Trim Galore!</figcaption></figure>\n  <p>However, you may have noticed that you have a new section with warning: <strong>Sequence Length Distribution</strong>. This is expected as you trimmed part of the reads.\nFurthermore, you will notice under <strong>Sequence Duplication Levels</strong> that we removed nearly all PCR duplicates.</p>\n  <figure id=\"figure-7\" style=\"max-width: 90%;\"><img src=\"../../images/cut_and_run/duplication_level.png\" alt=\"FastQC screenshot on the duplication level after MarkDuplicates. \" width=\"824\" height=\"592\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/cut_and_run/duplication_level.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 7</strong>:</span> FastQC screenshot on the duplication level after MarkDuplicates</figcaption></figure>\n</blockquote>\n\n<h2 id=\"check-insert-sizes\">Check Insert Sizes</h2>\n\n<p>We will check the insert sizes with <strong>Paired-end histogram</strong> of insert size frequency. The insert size is the distance between the R1 and R2 read pairs. This tells us the size of the DNA fragment the read pairs came from. The fragment length distribution of a sample gives an excellent indication of the quality of the CUT and RUN experiment.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Plot the distribution of fragment sizes</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/pe_histogram/pe_histogram/1.0.1\" title=\"Paired-end histogram tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Paired-end histogram</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.0.1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“BAM file”</em>: Select the output of  <strong>MarkDuplicates</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> <em>“BAM output”</em></li>\n        <li><em>“Lower bp limit (optional)”</em>: <code class=\"language-plaintext highlighter-rouge\">0</code></li>\n        <li><em>“Upper bp limit (optional)”</em>: <code class=\"language-plaintext highlighter-rouge\">1000</code></li>\n      </ul>\n    </li>\n    <li>Click on the <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> (eye) icon of the lower one of the 2 outputs (the png file).</li>\n  </ol>\n</blockquote>\n\n<blockquote class=\"comment\">\n  <comment-title>Paired-end histogram Results</comment-title>\n  <p>This is what you get from Paired-end histogram:</p>\n  <figure id=\"figure-8\" style=\"max-width: 90%;\"><img src=\"../../images/cut_and_run/insert_size.png\" alt=\"Fragment size distribution. \" width=\"794\" height=\"543\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/cut_and_run/insert_size.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 8</strong>:</span> Fragment size distribution</figcaption></figure>\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>Could you guess what the peaks at approximately 30bp correspond to?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <p>The first peak (30bp) corresponds to where the cleavage around our POI. Nevertheless, the cutting of our pA(G)-MNase-antibody-protein complex is not perfect. The arms can actually cut further away from the protein. Little bumps in the distribution are an indication of another protein(complex), such as a nucleosome that is located between the two cleavage sites.</p>\n\n  </blockquote>\n\n</blockquote>\n\n<p>This fragment size distribution is a good indication if your experiment worked or not. The CUT&amp;RUN yield can gradually increase over the digestion time <span class=\"citation\"><a href=\"#Skene2017\">Skene and Henikoff 2017</a></span>, which of course depends on the enzyme used for the cleavage of the DNA.</p>\n\n<figure id=\"figure-9\" style=\"max-width: 90%;\"><img src=\"../../images/cut_and_run/cut_and_run_yield.png\" alt=\"CUT and RUN yield. \" width=\"1440\" height=\"816\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/cut_and_run/cut_and_run_yield.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 9</strong>:</span> Fragment length distributions of a CUT&amp;RUN experiment with uniform digestion over time. No anti-FLAG primary antibody (No Ab). The track with No_Ab is the control experiment. Data is from two biological replicates. The studied protein showed fragments of size ≤120 bp corresponding to the binding sites, as seen on the left, whereas reads with ≥150 bp fragment size are randomly distributed in the local vicinity. The yield in the example increases from 5s to 10 minutes, which can be seen in the mapped profiles in the right. (Skene and Henikoff 2017 eLife)</figcaption></figure>\n\n<h1 id=\"step-4-peak-calling\">Step 4: Peak calling</h1>\n\n<h2 id=\"call-peaks\">Call Peaks</h2>\n\n<p>We have now finished the data preprocessing. Next, to find regions corresponding to potential binding sites, we want to identify regions where reads have piled up (peaks) greater than the background read coverage. <a href=\"https://github.com/taoliu/MACS\">MACS2</a> is widely used for CUT&amp;RUN.</p>\n\n<p>At this step, two approaches exist: Like in ATAC-Seq, we have to take a few things into account. The pA(G)-MNase does not need to bind the protein it can create fragments unspecifically a\nfew bases downstream and upstream away from the true binding site. This is to the <em>“long”</em> arms of the proteins. A big jump can happen if a nucleosome is between the protein binding site and the cutting site.</p>\n\n<p>It is critical to re-center the signal since the pA(G)-MNase cuts in different distances. Since some read pairs are not symmetric (i.e., the first mate might be further away from the\nbinding site than the second mate) we will turn off the shifting mode of MACS2 and apply a direct shift. If we only assess the coverage of the 5’ extremity of the reads, the data would be too sparse,\nand it would be impossible to call peaks. Thus, we will extend the start sites of the reads by 200bp (100bp in each direction) to assess coverage.</p>\n\n<h3 id=\"using-macs2\">Using MACS2</h3>\n\n<p>We convert the BAM file to BED format because when we set the extension size in MACS2, it will only consider one read of the pair while here we would like to use the information from both.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Convert the BAM to BED</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_bamtobed/2.30.0+galaxy2\" title=\"bedtools BAM to BED converter tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>bedtools BAM to BED converter</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.30.0+galaxy2)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“Convert the following BAM file to BED”</em>: Select the output of <strong>MarkDuplicates</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> BAM output</li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>We call peaks with MACS2. To get the coverage centered on the 5’ extended 100bp each side we will use <code class=\"language-plaintext highlighter-rouge\">--shift -100</code> and <code class=\"language-plaintext highlighter-rouge\">--extend 200</code>:</p>\n<figure id=\"figure-10\" style=\"max-width: 90%;\"><img src=\"../../images/atac-seq/macs2Options.jpg\" alt=\"MACS2 options to get 100bp each side. \" width=\"643\" height=\"113\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/atac-seq/macs2Options.jpg\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 10</strong>:</span> MACS2 options to get 100bp each side</figcaption></figure>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Call peaks with MACS2</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/macs2/macs2_callpeak/2.2.7.1+galaxy0\" title=\"MACS2 callpeak tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>MACS2 callpeak</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.2.7.1+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><em>“Are you pooling Treatment Files?”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code>\n          <ul>\n            <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> Select the output of <strong>bedtools BAM to BED</strong> converter <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n          </ul>\n        </li>\n        <li><em>“Do you have a Control File?”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n        <li><em>“Format of Input Files”</em>: <code class=\"language-plaintext highlighter-rouge\">Single-end BED</code></li>\n        <li><em>“Effective genome size”</em>: <code class=\"language-plaintext highlighter-rouge\">H. sapiens (2.7e9)</code></li>\n        <li><em>“Build Model”</em>: <code class=\"language-plaintext highlighter-rouge\">Do not build the shifting model (--nomodel)</code>\n          <ul>\n            <li><em>“Set extension size”</em>: <code class=\"language-plaintext highlighter-rouge\">200</code></li>\n            <li><em>“Set shift size”</em>: <code class=\"language-plaintext highlighter-rouge\">-100</code>. It needs to be - half the extension size to be centered on the 5’.</li>\n          </ul>\n        </li>\n        <li><em>“Additional Outputs”</em>:\n          <ul>\n            <li>Check <code class=\"language-plaintext highlighter-rouge\">Peaks as tabular file (compatible with MultiQC)</code></li>\n            <li>Check <code class=\"language-plaintext highlighter-rouge\">Peak summits</code></li>\n            <li>Check <code class=\"language-plaintext highlighter-rouge\">Scores in bedGraph files</code></li>\n          </ul>\n        </li>\n        <li>In <em>“Advanced Options”</em>:\n          <ul>\n            <li><em>“Composite broad regions”</em>: <code class=\"language-plaintext highlighter-rouge\">No broad regions</code>\n              <ul>\n                <li><em>“Use a more sophisticated signal processing approach to find subpeak summits in each enriched peak region”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n              </ul>\n            </li>\n            <li><em>“How many duplicate tags at the exact same location are allowed?”</em>: <code class=\"language-plaintext highlighter-rouge\">all</code></li>\n          </ul>\n        </li>\n      </ul>\n\n      <blockquote class=\"comment\">\n        <comment-title>Why keeping all duplicates is important</comment-title>\n\n        <p>We previously removed duplicates using <strong>MarkDuplicates</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> using paired-end information. If two pairs had identical R1 but different R2, we knew it was not a PCR duplicate. Because we converted the BAM to BED we lost the pair information. If we keep the default (removing duplicates) one of the 2 identical R1 would be filtered out as duplicate.</p>\n      </blockquote>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h1 id=\"step-5-identifying-binding-motifs\">Step 5: Identifying Binding Motifs</h1>\n\n<h2 id=\"prepare-the-datasets\">Prepare the Datasets</h2>\n\n<h3 id=\"extracting-individual-replicates-from-your-dataset-collection\">Extracting individual replicates from your dataset collection</h3>\n\n<p>In the following step, we want to apply a tool to identify robust peaks between our two replicates. However, we still have one dataset collection, holding both replicates, which we have to split.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Extract replicates from a dataset collection:</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"__EXTRACT_DATASET__\" title=\"Extract Dataset tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Extract Dataset</strong></span> with:\n      <ul>\n        <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“Input List”</em>: <code class=\"language-plaintext highlighter-rouge\">MACS2 callpeak on collection N (narrow Peaks)</code></li>\n        <li><em>“How should a dataset be selected?”</em>: <code class=\"language-plaintext highlighter-rouge\">Select by index</code></li>\n        <li><em>“Element index:”</em>: <code class=\"language-plaintext highlighter-rouge\">0</code></li>\n      </ul>\n    </li>\n  </ol>\n\n  <p>You can use the arrow to rerun the same tool just changing the last parameter:</p>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"__EXTRACT_DATASET__\" title=\"Extract Dataset tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Extract Dataset</strong></span> with:\n      <ul>\n        <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“Input List”</em>: <code class=\"language-plaintext highlighter-rouge\">MACS2 callpeak on collection N (narrow Peaks)</code></li>\n        <li><em>“How should a dataset be selected?”</em>: <code class=\"language-plaintext highlighter-rouge\">Select by index</code></li>\n        <li><em>“Element index:”</em>: <code class=\"language-plaintext highlighter-rouge\">1</code></li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<h3 id=\"extract-robust-peaks\">Extract Robust Peaks</h3>\n<p>MACS helped us to identify potential binding sites for GATA1. Yet, our peak set will contain false positives because of technical and biological noise.\nWe can first try to reduce some noise using the results for our two biological replicates. Since we applied MACS we have created two peak files.\nYet, both replicates have peaks that are only present in one replicate and thus might be a potential false positive due to noise.\nWe can remove such peaks if we simply overlap the two peak files and consequently search for peaks that appear in both replicates.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Select robust GATA1 peaks:</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_intersectbed/2.30.0+galaxy1\" title=\"bedtools Intersect intervals find overlapping intervals in various ways tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>bedtools Intersect intervals find overlapping intervals in various ways</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.30.0+galaxy1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“File A to intersect with B”</em>: Select <code class=\"language-plaintext highlighter-rouge\">Rep1</code></li>\n        <li><em>“Combined or separate output files”</em>: <code class=\"language-plaintext highlighter-rouge\">One output file per 'input B' file</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“File B to intersect with A”</em>:  Select <code class=\"language-plaintext highlighter-rouge\">Rep2</code></li>\n          </ul>\n        </li>\n        <li><em>“Calculation based on strandedness?”</em>: <code class=\"language-plaintext highlighter-rouge\">Overlaps occurring on either strand</code></li>\n        <li><em>“Required overlap”</em>: <code class=\"language-plaintext highlighter-rouge\">Specify minimum overlap(s)</code>\n          <ul>\n            <li><em>“Minimum overlap required as a fraction of A”</em>: <code class=\"language-plaintext highlighter-rouge\">0.5</code></li>\n            <li><em>“Require that the fraction of overlap be reciprocal for A and B”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n          </ul>\n        </li>\n        <li>*“Write the original A entry <em>once</em> if <em>any</em> overlaps found in B.”: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n      </ul>\n    </li>\n    <li>Rename the datasets <code class=\"language-plaintext highlighter-rouge\">Robust GATA1 CUT and RUN peaks</code>.</li>\n  </ol>\n\n  <blockquote class=\"question\">\n    <question-title></question-title>\n\n    <p>How many potential true positives do we obtain?\nHow many potential false positives have we removed?\nWhy have we set specified an overlap fraction of A with <code class=\"language-plaintext highlighter-rouge\">0.5</code>?\nWhy have we set <strong>“Require that the fraction of overlap be reciprocal for A and B”</strong>?</p>\n\n    <blockquote class=\"solution\">\n      <solution-title></solution-title>\n\n      <ol>\n        <li>2,863 peaks</li>\n        <li>We started with 6,314 and 7,683 peaks. Thus, we could remove 3,410 and 4765 peaks.</li>\n        <li>Finding robust peaks is a tricky process and not as simple as you think. Our approach defines a robust peak as an entity that is covered by two similar peaks in either one of the peak files of our two replicates. Our measurement for similarity is simply the amount of bases the peaks overlap. Yet, ask yourself, how much overlap do you need to state that they are similar? Is 1 base enough or maybe 10? The answer is not true or false and like so often needs more investigation. We define the overlap by a 50% fraction of each of the peak files. That means, if our peak in A is 100 bases then A has to overlap with 50 bases with the peak in file B.</li>\n        <li><strong>“Require that the fraction of overlap be reciprocal for A and B”</strong> means that 50% of the peak in file A overlaps with the peak in file B and also 50% of the peak in file B overlaps with the peak in file A. We set this to make our filtering very conservative and filter for peaks that we can be sure are true positives. For example, A has a 10 bp peak that overlaps a peak in B with 100 bp. <strong>Viewpoint of file A:</strong> An overlap-fraction of 0.5 for A means that we accept peak A if it overlaps with 5 bp with the peak in B. This is very likely because the peak in B is 100 bp long. <strong>Viewpoint of file B</strong>: An overlap-fraction of 0.5 for B means that we reject A no matter what, even if A completely overlaps B because 10 bp are not enough to cover 50% of B. That is to say the option <strong>“Require that the fraction of overlap be reciprocal for A and B”</strong> takes care that we trust peaks that have in file A <strong>and</strong> in file B a fair overlap.</li>\n      </ol>\n    </blockquote>\n\n  </blockquote>\n</blockquote>\n\n<p>Note, that this is one way to define robust peaks. Yet, there are more sophisticated algorithms in Galaxy, such as\n<span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/idr/idr/2.0.3\" title=\"IDR compare ranked list of identifications tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>IDR compare ranked list of identifications</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.0.3)</span>, and other methods that can help to define a robust peak.\nThe tool <strong>IDR</strong> has not been tested so far for CUT and RUN.</p>\n\n<h3 id=\"extract-positive-peaks\">Extract Positive Peaks</h3>\n\n<p>We can further remove some noise with a positive control, that is why we have downloaded a peak set from a ChIP experiment of GATA1.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Select GATA1 peaks from ChIP-Seq data:</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_intersectbed/2.30.0+galaxy1\" title=\"bedtools Intersect intervals find overlapping intervals in various ways tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>bedtools Intersect intervals find overlapping intervals in various ways</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.30.0+galaxy1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“File A to intersect with B”</em>: Select <strong>Robust GATA1 CUT and RUN peaks</strong></li>\n        <li><em>“Combined or separate output files”</em>: <code class=\"language-plaintext highlighter-rouge\">One output file per 'input B' file</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“File B to intersect with A”</em>:  Select the dataset <code class=\"language-plaintext highlighter-rouge\">GATA1 ChIP-Seq peaks</code></li>\n          </ul>\n        </li>\n        <li><em>“Calculation based on strandedness?”</em>: <code class=\"language-plaintext highlighter-rouge\">Overlaps occurring on either strand</code></li>\n        <li><em>“Required overlap”</em>: <code class=\"language-plaintext highlighter-rouge\">Specify minimum overlap(s)</code>\n          <ul>\n            <li><em>“Minimum overlap required as a fraction of A”</em>: <code class=\"language-plaintext highlighter-rouge\">0.5</code></li>\n          </ul>\n        </li>\n        <li>*“Write the original A entry <em>once</em> if <em>any</em> overlaps found in B.”: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n      </ul>\n    </li>\n    <li>Rename the datasets <code class=\"language-plaintext highlighter-rouge\">True GATA1 CUT and RUN peaks</code>.</li>\n  </ol>\n\n  <blockquote class=\"question\">\n    <question-title></question-title>\n\n    <p>How many potential true positives do we gain?\nHow many potential false positives have we removed?\nWhat is the precision of our analysis at this point? (Precision = True Positive / True Positive + False Positive)</p>\n\n    <blockquote class=\"solution\">\n      <solution-title></solution-title>\n\n      <ol>\n        <li>2,409 peaks</li>\n        <li>454 peaks</li>\n        <li>Our precision is ~ 84%. A high precision is an indicator that we can predict true binding regions with high confidence.</li>\n      </ol>\n    </blockquote>\n\n  </blockquote>\n</blockquote>\n\n<h3 id=\"extract-dna-sequence\">Extract DNA sequence</h3>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Obtain DNA sequences from a BED file</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/extract_genomic_dna/Extract genomic DNA 1/3.0.3+galaxy2\" title=\"Extract Genomic DNA using coordinates from assembled/unassembled genomes tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Extract Genomic DNA using coordinates from assembled/unassembled genomes</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 3.0.3+galaxy2)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Fetch sequences for intervals in”</em>: Select <strong>True GATA1 CUT and RUN peaks</strong></li>\n        <li><em>“Interpret features when possible”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n        <li>*“Choose the source for the reference genome”: <code class=\"language-plaintext highlighter-rouge\">locally cached</code></li>\n        <li><em>“Using reference genome”</em>: <code class=\"language-plaintext highlighter-rouge\">hg38</code></li>\n        <li><em>“Select output format”</em>: <code class=\"language-plaintext highlighter-rouge\">fasta</code></li>\n        <li><em>“Select fasta header format”</em>: <code class=\"language-plaintext highlighter-rouge\">bedtools getfasta default</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h2 id=\"motif-detection-with-meme-chip\">Motif detection with MEME-ChIP</h2>\n\n<p>Let’s find out the sequence motifs of the TF GATA1. Studies have revealed that GATA1 has the DNA binding motif (T/A)GATA(A/G) <span class=\"citation\"><a href=\"#Hasegawa2017\">Hasegawa and Shimizu 2017</a></span>. In this last task we search for this motif in our data.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Motif detection</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/meme_chip/meme_chip/4.11.2+galaxy1\" title=\"MEME-ChIP tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>MEME-ChIP</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 4.11.2+galaxy1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Primary sequences”</em>: Select the output of <strong>Extract Genomic DNA</strong> using coordinates from assembled/unassembled genomes <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Sequence alphabet”</em>: <code class=\"language-plaintext highlighter-rouge\">DNA</code></li>\n        <li><em>“Options Configuration”</em>: <code class=\"language-plaintext highlighter-rouge\">Advanced</code></li>\n      </ul>\n      <ul>\n        <li><em>“Should subsampling be random?”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code>\n          <ul>\n            <li><em>“Seed for the randomized selection of sequences”</em>: <code class=\"language-plaintext highlighter-rouge\">123</code></li>\n          </ul>\n        </li>\n        <li><em>“E-value threshold for including motifs”</em>: <code class=\"language-plaintext highlighter-rouge\">0.05</code></li>\n        <li><em>“What is the expected motif site distribution?”</em>: <code class=\"language-plaintext highlighter-rouge\">Zero or one occurrence per sequence</code></li>\n        <li><em>“Minimum motif width”</em>: <code class=\"language-plaintext highlighter-rouge\">5</code></li>\n        <li><em>“Maximum motif width”</em>: <code class=\"language-plaintext highlighter-rouge\">20</code></li>\n        <li><em>“Maximum number of motifs to find”</em>: <code class=\"language-plaintext highlighter-rouge\">5</code></li>\n        <li><em>“Stop DREME searching after reaching this E-value threshold”</em>: <code class=\"language-plaintext highlighter-rouge\">0.05</code></li>\n        <li><em>“Stop DREME searching after finding this many motifs”</em>: <code class=\"language-plaintext highlighter-rouge\">5</code>\n      - <em>“I certify that I am not using this tool for commercial purposes.”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n      </ul>\n    </li>\n    <li>View the <strong>MEME-ChIP</strong> HTML.</li>\n  </ol>\n\n  <blockquote class=\"question\">\n    <question-title></question-title>\n\n    <p>How many peaks support the main motif GATA?\nWhat is the E-value of the main motif?</p>\n\n    <blockquote class=\"solution\">\n      <solution-title></solution-title>\n\n      <ol>\n        <li>!!!!  Where is this info? !!!</li>\n        <li>E-value = 5.0e-383</li>\n      </ol>\n    </blockquote>\n\n  </blockquote>\n</blockquote>\n\n<figure id=\"figure-11\" style=\"max-width: 90%;\"><img src=\"../../images/cut_and_run/GATA_motif.png\" alt=\"MEME-ChiP motifs for GATA1. \" width=\"920\" height=\"761\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/cut_and_run/GATA_motif.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 11</strong>:</span> Plot of the first five sequence motifs of MEME-ChIP.</figcaption></figure>\n\n<p>Let us first investigate the result of MEME-ChIP. <strong>First column:</strong> The x-axis of the sequence plots represents the nucleotide position of the motif.\nThe y-axis stands for the total information (uncertainty) and thus stands for the probability that the nucleotide at a certain position is the specific letter (for DNA: T,C,G,A).\nBigger letters stand for a higher probability. For more information please read <a href=\"https://en.wikipedia.org/wiki/Sequence_logo\">the corresponding Wikipedia page</a>. <strong>Second column:</strong> Defines the algorithm that found the sequence motif.\nMEME-ChIP uses two different approaches called MEME and DREME, which can find more complex or simpler motifs. More information about these tools can be found <a href=\"http://meme-suite.org/\">in the Meme documentation</a>.\n<strong>Third column:</strong> Defines the E-value, which represents the expected number of times we would find our sequence motif in a database (peak file), just by chance.\nThis means, that a small E-value corresponds to a very significant motif because the expected number we would find that motif in our peak file just by chance is very low.\nOther sequences like repeats will have a high E-value on the other hand. <strong>Fourth column:</strong> This graph is the result of CentriMo, a tool that shows the distribution of\nthe best matches for that particular motif. The vertical line is the center of the motif. Therefore, if you have a long sequence motif CentriMo helps you to pinpoint a smaller sub-motif.\nYou can find more information on CentriMo <a href=\"https://meme-suite.org/meme/doc/centrimo.html\">in the Meme documentation</a>.</p>\n\n<p>The results of MEME-ChIP endorse the findings about the DNA binding motif (T/A)GATA(A/G) <span class=\"citation\"><a href=\"#Hasegawa2017\">Hasegawa and Shimizu 2017</a></span>. We also found other motifs, that might be secondary sequence motifs.\nThis, we could test with a deeper analysis.</p>\n\n<h1 id=\"conclusion\">Conclusion</h1>\n\n<p>In this training, you have learned the general principles of CUT&amp;RUN data analysis. CUT&amp;RUN is a method to analyse DNA-associated proteins. In contrast to ChIP-seq, CUT&amp;RUN couples the\nantibody with a pA(G)-MNase to reduce the size of the obtained sequences to increase the accuracy for the detection of the protein interaction. Based on this training material,\nyou gained some insights into the quality control of the data. You should know some pitfalls of CUT&amp;RUN and look for adapter contamination and PCR duplicates, which disrupt the later enrichment analysis.\nYou learned about <strong>Bowtie2</strong> to do the alignment, and how to filter for properly paired, good-quality and reads that do not map to the mitochondrial genome. Furthermore, you learned that\nan indicator for a good CUT&amp;RUN experiment is the fragment size plot and that you optimize your protocol based on this parameter. With <strong>MACS2</strong> we identified enriched regions, but\nwe had to remove some noise. We performed some robust peak analysis with <strong>bedtools intersect</strong> and performed a check with a ChIP-Seq experiment to remove some false positives.\nFinally, we used <strong>MEME-ChIP</strong> to identify our binding motifs.</p>\n\n<p><a href=\"../../images/cut_and_run/cut_and_run_mindmap.png\" rel=\"noopener noreferrer\"><img src=\"../../images/cut_and_run/cut_and_run_mindmap.png\" alt=\"CUT&amp;RUN workflow. \" width=\"511\" height=\"813\" loading=\"lazy\" /></a></p>\n"],"ref_slides":[],"hands_on":true,"slides":false,"mod_date":"2024-03-06 07:51:26 +0000","pub_date":"2024-03-06 07:59:37 +0000","version":20,"workflows":[{"workflow":"main_workflow.ga","tests":false,"url":"https://training.galaxyproject.org/training-material/topics/epigenetics/tutorials/cut_and_run/workflows/main_workflow.ga","path":"topics/epigenetics/tutorials/cut_and_run/workflows/main_workflow.ga","wfid":"epigenetics-cut_and_run","wfname":"main_workflow","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/epigenetics-cut_and_run/versions/main_workflow","license":null,"creators":[],"name":"ATAC-seq GTM","title":"ATAC-seq GTM","test_results":null,"modified":"2024-06-14 12:15:30 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\nbed file with genes\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"ℹ️ Input Dataset\\nctcf peaks\"];\n  style 1 stroke:#2c3143,stroke-width:4px;\n  2[\"ℹ️ Input Dataset\\nATAC R2 read in fastq.gz format\"];\n  style 2 stroke:#2c3143,stroke-width:4px;\n  3[\"ℹ️ Input Dataset\\nATAC R1 read in fastq.gz format\"];\n  style 3 stroke:#2c3143,stroke-width:4px;\n  4[\"Filter\"];\n  1 -->|output| 4;\n  5[\"FastQC\"];\n  2 -->|output| 5;\n  6[\"ATAC remove nextera adapters with cutadapt\"];\n  3 -->|output| 6;\n  2 -->|output| 6;\n  7[\"FastQC\"];\n  3 -->|output| 7;\n  8[\"bedtools Intersect intervals\"];\n  4 -->|out_file1| 8;\n  0 -->|output| 8;\n  9[\"FastQC\"];\n  6 -->|out2| 9;\n  10[\"Bowtie2\"];\n  6 -->|out1| 10;\n  6 -->|out2| 10;\n  11[\"FastQC\"];\n  6 -->|out1| 11;\n  12[\"Filter BAM ATAC\"];\n  10 -->|output| 12;\n  13[\"MarkDuplicates\"];\n  12 -->|out_file1| 13;\n  14[\"bedtools BAM to BED\"];\n  13 -->|outFile| 14;\n  15[\"Paired-end histogram\"];\n  13 -->|outFile| 15;\n  16[\"MACS2 callpeak\"];\n  14 -->|output| 16;\n  17[\"Wig/BedGraph-to-bigWig\"];\n  16 -->|output_treat_pileup| 17;\n  18[\"computeMatrix\"];\n  17 -->|out_file1| 18;\n  0 -->|output| 18;\n  19[\"pyGenomeTracks\"];\n  17 -->|out_file1| 19;\n  16 -->|output_narrowpeaks| 19;\n  0 -->|output| 19;\n  1 -->|output| 19;\n  20[\"computeMatrix\"];\n  17 -->|out_file1| 20;\n  8 -->|output| 20;\n  65159c9c-050b-4069-8704-8f66c0563a98[\"Output\\ncomputeMatrix on input dataset(s): Matrix\"];\n  20 --> 65159c9c-050b-4069-8704-8f66c0563a98;\n  style 65159c9c-050b-4069-8704-8f66c0563a98 stroke:#2c3143,stroke-width:4px;\n  21[\"plotHeatmap\"];\n  18 -->|outFileName| 21;\n  22[\"plotHeatmap\"];\n  20 -->|outFileName| 22;\n  74a36643-b88f-4378-8f9c-c1b20ee2651e[\"Output\\nplotHeatmap on input dataset(s): Image\"];\n  22 --> 74a36643-b88f-4378-8f9c-c1b20ee2651e;\n  style 74a36643-b88f-4378-8f9c-c1b20ee2651e stroke:#2c3143,stroke-width:4px;"}],"api":"https://training.galaxyproject.org/training-material/api/topics/epigenetics/tutorials/cut_and_run/tutorial.json","tools":[" https://toolshed.g2.bx.psu.edu/view/bgruening/trim_galore/cd7e644cae1d","Filter1","Grep1","__EXTRACT_DATASET__","__FLATTEN__","toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_compute_matrix/deeptools_compute_matrix/3.3.2.0.0","toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_plot_heatmap/deeptools_plot_heatmap/3.3.2.0.1","toolshed.g2.bx.psu.edu/repos/devteam/bamtools_filter/bamFilter/2.4.1","toolshed.g2.bx.psu.edu/repos/devteam/bamtools_filter/bamFilter/2.5.1+galaxy0","toolshed.g2.bx.psu.edu/repos/devteam/bowtie2/bowtie2/2.4.2+galaxy0","toolshed.g2.bx.psu.edu/repos/devteam/bowtie2/bowtie2/2.4.5+galaxy1","toolshed.g2.bx.psu.edu/repos/devteam/fastqc/fastqc/0.72+galaxy1","toolshed.g2.bx.psu.edu/repos/devteam/fastqc/fastqc/0.73+galaxy0","toolshed.g2.bx.psu.edu/repos/devteam/picard/picard_MarkDuplicates/2.18.2.2","toolshed.g2.bx.psu.edu/repos/devteam/picard/picard_MarkDuplicates/2.18.2.3","toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_bamtobed/2.30.0","toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_bamtobed/2.30.0+galaxy2","toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_intersectbed/2.30.0","toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_intersectbed/2.30.0+galaxy1","toolshed.g2.bx.psu.edu/repos/iuc/extract_genomic_dna/Extract genomic DNA 1/3.0.3+galaxy2","toolshed.g2.bx.psu.edu/repos/iuc/idr/idr/2.0.3","toolshed.g2.bx.psu.edu/repos/iuc/macs2/macs2_callpeak/2.1.1.20160309.6","toolshed.g2.bx.psu.edu/repos/iuc/macs2/macs2_callpeak/2.2.7.1+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/meme_chip/meme_chip/4.11.2+galaxy1","toolshed.g2.bx.psu.edu/repos/iuc/pe_histogram/pe_histogram/1.0.1","toolshed.g2.bx.psu.edu/repos/iuc/pygenometracks/pygenomeTracks/3.6","toolshed.g2.bx.psu.edu/repos/lparsons/cutadapt/cutadapt/1.16.5","wig_to_bigWig"],"supported_servers":{"exact":[],"inexact":[]},"topic_name_human":"Epigenetics","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"deeptools_compute_matrix","owner":"bgruening","revisions":"514fa53b5efb","tool_panel_section_label":"deepTools","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"deeptools_plot_heatmap","owner":"bgruening","revisions":"a4dfb122e52b","tool_panel_section_label":"deepTools","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"bamtools_filter","owner":"devteam","revisions":"cb20f99fd45b","tool_panel_section_label":"SAM/BAM","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"bamtools_filter","owner":"devteam","revisions":"1dfd95ee241e","tool_panel_section_label":"SAM/BAM","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"bowtie2","owner":"devteam","revisions":"a6d65b0c67af","tool_panel_section_label":"Mapping","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"bowtie2","owner":"devteam","revisions":"f6877ad76b00","tool_panel_section_label":"Mapping","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"fastqc","owner":"devteam","revisions":"e7b2202befea","tool_panel_section_label":"FASTA/FASTQ","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"fastqc","owner":"devteam","revisions":"3d0c7bdf12f5","tool_panel_section_label":"FASTA/FASTQ","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"picard","owner":"devteam","revisions":"a1f0b3f4b781","tool_panel_section_label":"Picard","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"picard","owner":"devteam","revisions":"b502c227b5e6","tool_panel_section_label":"Picard","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"bedtools","owner":"iuc","revisions":"ce3c7f062223","tool_panel_section_label":"BED","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"bedtools","owner":"iuc","revisions":"a1a923cd89e8","tool_panel_section_label":"BED","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"bedtools","owner":"iuc","revisions":"a68aa6c1204a","tool_panel_section_label":"BED","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"bedtools","owner":"iuc","revisions":"a1a923cd89e8","tool_panel_section_label":"BED","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"extract_genomic_dna","owner":"iuc","revisions":"5cc8e93ee98f","tool_panel_section_label":"Fetch Sequences/Alignments","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"idr","owner":"iuc","revisions":"de7795890bc5","tool_panel_section_label":"RNA Analysis","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"macs2","owner":"iuc","revisions":"424aefbd7777","tool_panel_section_label":"Peak Calling","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"macs2","owner":"iuc","revisions":"640d3af5d833","tool_panel_section_label":"Peak Calling","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"meme_chip","owner":"iuc","revisions":"cc100e0f61f4","tool_panel_section_label":"Motif Tools","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"pe_histogram","owner":"iuc","revisions":"bd1416eea1f0","tool_panel_section_label":"Graph/Display Data","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"pygenometracks","owner":"iuc","revisions":"2824d77cd8f8","tool_panel_section_label":"Graph/Display Data","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"cutadapt","owner":"lparsons","revisions":"49370cb85f0f","tool_panel_section_label":"FASTA/FASTQ","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: deeptools_compute_matrix\n  owner: bgruening\n  revisions: 514fa53b5efb\n  tool_panel_section_label: deepTools\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: deeptools_plot_heatmap\n  owner: bgruening\n  revisions: a4dfb122e52b\n  tool_panel_section_label: deepTools\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bamtools_filter\n  owner: devteam\n  revisions: cb20f99fd45b\n  tool_panel_section_label: SAM/BAM\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bamtools_filter\n  owner: devteam\n  revisions: 1dfd95ee241e\n  tool_panel_section_label: SAM/BAM\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bowtie2\n  owner: devteam\n  revisions: a6d65b0c67af\n  tool_panel_section_label: Mapping\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bowtie2\n  owner: devteam\n  revisions: f6877ad76b00\n  tool_panel_section_label: Mapping\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: fastqc\n  owner: devteam\n  revisions: e7b2202befea\n  tool_panel_section_label: FASTA/FASTQ\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: fastqc\n  owner: devteam\n  revisions: 3d0c7bdf12f5\n  tool_panel_section_label: FASTA/FASTQ\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: picard\n  owner: devteam\n  revisions: a1f0b3f4b781\n  tool_panel_section_label: Picard\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: picard\n  owner: devteam\n  revisions: b502c227b5e6\n  tool_panel_section_label: Picard\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bedtools\n  owner: iuc\n  revisions: ce3c7f062223\n  tool_panel_section_label: BED\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bedtools\n  owner: iuc\n  revisions: a1a923cd89e8\n  tool_panel_section_label: BED\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bedtools\n  owner: iuc\n  revisions: a68aa6c1204a\n  tool_panel_section_label: BED\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bedtools\n  owner: iuc\n  revisions: a1a923cd89e8\n  tool_panel_section_label: BED\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: extract_genomic_dna\n  owner: iuc\n  revisions: 5cc8e93ee98f\n  tool_panel_section_label: Fetch Sequences/Alignments\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: idr\n  owner: iuc\n  revisions: de7795890bc5\n  tool_panel_section_label: RNA Analysis\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: macs2\n  owner: iuc\n  revisions: 424aefbd7777\n  tool_panel_section_label: Peak Calling\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: macs2\n  owner: iuc\n  revisions: 640d3af5d833\n  tool_panel_section_label: Peak Calling\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: meme_chip\n  owner: iuc\n  revisions: cc100e0f61f4\n  tool_panel_section_label: Motif Tools\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: pe_histogram\n  owner: iuc\n  revisions: bd1416eea1f0\n  tool_panel_section_label: Graph/Display Data\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: pygenometracks\n  owner: iuc\n  revisions: 2824d77cd8f8\n  tool_panel_section_label: Graph/Display Data\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: cutadapt\n  owner: lparsons\n  revisions: 49370cb85f0f\n  tool_panel_section_label: FASTA/FASTQ\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":false,"slides_recordings":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial","tags":["work-in-progress"],"contributors":[{"name":"Florian Heyl","joined":"2018-08","elixir_node":"de","orcid":"0000-0002-3651-5685","former_affiliations":["uni-freiburg","elixir-europe"],"id":"heylf","url":"https://training.galaxyproject.org/training-material/api/contributors/heylf.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/heylf/"},{"name":"Helena Rasche","orcid":"0000-0001-9760-8992","maintainer_contact":"gitter","matrix":"hexylena:matrix.org","joined":"2017-09","elixir_node":"nl","affiliations":["gallantries","by-covid","erasmusmc","elixir-europe","elixir-converge"],"former_affiliations":["deNBI","avans-atgm","uni-freiburg"],"contact_for_training":false,"location":{"country":"NL","lat":51.91,"lon":4.46},"id":"hexylena","url":"https://training.galaxyproject.org/training-material/api/contributors/hexylena.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/hexylena/"},{"name":"Lucille Delisle","email":"lucille.delisle@epfl.ch","orcid":"0000-0002-1964-4960","joined":"2019-08","elixir_node":"ch","contact_for_training":true,"location":{"country":"CH","lat":46.52,"lon":6.56},"affiliations":["elixir-europe"],"id":"lldelisle","url":"https://training.galaxyproject.org/training-material/api/contributors/lldelisle.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/lldelisle/"}]}