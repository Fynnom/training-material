{"layout":"tutorial_slides","redirect_from":["/short/epigenetics/formation_of_super-structures_on_xi/slides","/short/S00058"],"title":"ChIP-seq data analysis","zenodo_link":"","tags":["ChIP-seq"],"questions":["What is ChIP-seq?"],"objectives":["Identify ChIP-seq data"],"time_estimation":"15M","key_points":[""],"contributors":["LeilyR","bebatut"],"js_requirements":{"mathjax":null,"mermaid":false},"short_id":"S00058","url":"/topics/epigenetics/tutorials/formation_of_super-structures_on_xi/slides.html","topic_name":"epigenetics","tutorial_name":"formation_of_super-structures_on_xi","dir":"topics/epigenetics/tutorials/formation_of_super-structures_on_xi","symlink":null,"id":"epigenetics/formation_of_super-structures_on_xi","ref_tutorials":["<p>Within a cell nucleus, the DNA is tightly-packed and the chromatin is spatially distributed with different levels and scales of organizations.</p>\n\n<p>At the smallest scale, DNA is packaged into units called nucleosomes, made of eight histone proteins.</p>\n\n<p>On a larger scale than nucleosomes, DNA is forming loops. DNA elements that would be otherwise separated by large distances can interact. The corresponding self-interacting (or self-associating) domains are found in many organisms: they are called Topologically Associating Domains (TADs) in mammalian cells. Mammalian chromosomes are also partitioned into two spatial compartments, labeled “A” and “B”, where regions in compartment A tend to interact preferentially with A compartment-associated regions than B compartment-associated ones. Similarly, regions in compartment B tend to associate with other B compartment-associated regions.</p>\n\n<blockquote class=\"comment\">\n  <comment-title>Tip: Learn more about chromosome conformation</comment-title>\n  <p>To learn more about chromosome conformation and TADs, you can follow our <a href=\"/training-material/topics/epigenetics/tutorials/hicexplorer/tutorial.html\">HiC tutorial</a></p>\n</blockquote>\n\n<p>In mammals, the X chromosome inactivation (XCI) balances the dosage of X-linked genes between females and males. The genes on the inactive X (Xi) chromosome are not expressed.</p>\n\n<p>Binding certain molecules to histone proteins can modify the chromatin structure and may result in changes in transcription level. For example, the H3K4me3 results from adding 3 methyl-group to the 4th lysine in the histone 3 protein. This modification is known to activate the transcription on nearby genes by opening the chromatin. The H3K27me3 on the other hand is inactivating the transcription of the nearby genes:</p>\n\n<figure id=\"figure-1\" style=\"max-width: 90%;\"><img src=\"../../images/formation_of_super-structures_on_xi/histone_modifications.jpg\" alt=\"Fadloun et al, 2013. \" width=\"478\" height=\"254\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/formation_of_super-structures_on_xi/histone_modifications.jpg\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 1</strong>:</span> Source: Fadloun et al, 2013</figcaption></figure>\n\n<p>More H3K27me3 and less H3K4me3 on the Xi could explain a lower expression of the genes there.</p>\n\n<p>It has been also observed that the Xi reconfigures uniquely into a specific chromosomal conformation. cohesins, condensins and CCCTC-binding factor (CTCF) play key roles in chromosomal architectures and TAD formation which are other potential cause of the repression of the expression of the genes on Xi.</p>\n\n<p>The structural-maintenance-of-chromosomes hinge domain containing 1 (SMCHD1) has been found enriched on the Xi. It may be the potential actor in the shape of Xi and the change in gene expression there.</p>\n\n<p><span class=\"citation\"><a href=\"#Wang2018\">Wang <i>et al.</i> 2018</a></span> investigates the mechanism by which the SMCHD1 gene shapes the Xi and represses the expression of the genes on Xi in mouse.</p>\n\n<p>Their idea was to identify the differences which could be observed between the Xi and activated X chromosome, on both wild-type and SMCHD1 gene knockdown samples to study the SMCHD1 effect.\nIn different experiments, they targeted histones with H3K27me3 or H3K4me3 and CTCF using ChIP-seq experiments.</p>\n\n<figure id=\"figure-2\" style=\"max-width: 90%;\"><img src=\"../../images/formation_of_super-structures_on_xi/Chromatin_immunoprecipitation_sequencing.jpg\" alt=\"ChIP-seq workflow. \" width=\"700\" height=\"933\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/formation_of_super-structures_on_xi/Chromatin_immunoprecipitation_sequencing.jpg\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 2</strong>:</span> Source: http://e.biohackers.net/ChIP-seq</figcaption></figure>\n\n<p>They obtained sequences corresponding to a portion of DNA linked to histones with H3K27me3, H3K4me3 or CTCF. Using this information, they could identify if there are differences in the H3K27me3, H3K4me3 and CTCF between the X (active or inactive) chromosomes and the potentially influenced genes.</p>\n\n<p>In the upcoming tutorial, we will only use the wild type data from <span class=\"citation\"><a href=\"#Wang2018\">Wang <i>et al.</i> 2018</a></span> and analyze the ChIP-seq data step by step:</p>\n\n<ul>\n  <li>CTCF with 2 replicates: <code class=\"language-plaintext highlighter-rouge\">wt_CTCF_rep1</code> and <code class=\"language-plaintext highlighter-rouge\">wt_CTCF_rep2</code></li>\n  <li>H3K4me3 with 2 replicates: <code class=\"language-plaintext highlighter-rouge\">wt_H3K4me3_rep1</code> and <code class=\"language-plaintext highlighter-rouge\">wt_H3K4me3_rep2</code></li>\n  <li>H3K27me3 with 2 replicates: <code class=\"language-plaintext highlighter-rouge\">wt_H3K27me3_rep1</code> and <code class=\"language-plaintext highlighter-rouge\">wt_H3K27me3_rep2</code></li>\n  <li>\n    <p>‘input’ with 2 replicates: <code class=\"language-plaintext highlighter-rouge\">wt_input_rep1</code> and <code class=\"language-plaintext highlighter-rouge\">wt_input_rep2</code></p>\n\n    <p>In ‘input’ samples, the same treatment as the ChIP-seq samples was done except for the immunoprecipitation step.\n  They are also used along with the ‘ChIP-seq’ samples to identify the potential sequencing bias and help for differential analysis.</p>\n  </li>\n</ul>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#step-1-quality-control-and-treatment-of-the-sequences\" id=\"markdown-toc-step-1-quality-control-and-treatment-of-the-sequences\">Step 1: Quality control and treatment of the sequences</a></li>\n  <li><a href=\"#step-2-mapping-of-the-reads\" id=\"markdown-toc-step-2-mapping-of-the-reads\">Step 2: Mapping of the reads</a>    <ol>\n      <li><a href=\"#running-bowtie2\" id=\"markdown-toc-running-bowtie2\">Running Bowtie2</a></li>\n      <li><a href=\"#inspection-of-a-bam-file\" id=\"markdown-toc-inspection-of-a-bam-file\">Inspection of a BAM file</a></li>\n      <li><a href=\"#visualization-using-a-genome-browser\" id=\"markdown-toc-visualization-using-a-genome-browser\">Visualization using a Genome Browser</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#step-3-chip-seq-quality-control\" id=\"markdown-toc-step-3-chip-seq-quality-control\">Step 3: ChIP-seq Quality Control</a>    <ol>\n      <li><a href=\"#correlation-between-samples\" id=\"markdown-toc-correlation-between-samples\">Correlation between samples</a></li>\n      <li><a href=\"#ip-strength-estimation\" id=\"markdown-toc-ip-strength-estimation\">IP strength estimation</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#step-4-normalization\" id=\"markdown-toc-step-4-normalization\">Step 4: Normalization</a>    <ol>\n      <li><a href=\"#generation-of-coverage-files-normalized-by-sequencing-depth\" id=\"markdown-toc-generation-of-coverage-files-normalized-by-sequencing-depth\">Generation of coverage files normalized by sequencing depth</a></li>\n      <li><a href=\"#generation-of-input-normalized-coverage-files\" id=\"markdown-toc-generation-of-input-normalized-coverage-files\">Generation of input-normalized coverage files</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#step-5-detecting-enriched-regions-peak-calling\" id=\"markdown-toc-step-5-detecting-enriched-regions-peak-calling\">Step 5: Detecting enriched regions (peak calling)</a></li>\n  <li><a href=\"#step-6-plot-the-signal-between-samples\" id=\"markdown-toc-step-6-plot-the-signal-between-samples\">Step 6: Plot the signal between samples</a></li>\n  <li><a href=\"#conclusion\" id=\"markdown-toc-conclusion\">Conclusion</a></li>\n</ol>\n\n</blockquote>\n\n<h1 id=\"step-1-quality-control-and-treatment-of-the-sequences\">Step 1: Quality control and treatment of the sequences</h1>\n\n<p>The first step of any ChIP-Seq data analysis is quality control of the raw sequencing data.</p>\n\n<p>To save time, we will do it only on the data of one sample <code class=\"language-plaintext highlighter-rouge\">wt_H3K4me3_rep1</code> which has been already down-sampled. keep in mind that with real data this should be done on each and every sample.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Import the data</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Create a new history for this tutorial and give it a proper name</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-new-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-new-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a new history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>Click the <i class=\"fas fa-plus\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">new-history</span> icon at the top of the history panel:</p>   <p><img src=\"/training-material/shared/images/history_create_new.svg\" alt=\"UI for creating new history\" /></p>   <!-- the original drawing can be found here https://docs.google.com/drawings/d/1cCBrLAo4kDGic5QyB70rRiWJAKTenTU8STsKDaLcVU8/edit?usp=sharing --> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-renaming-a-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-renaming-a-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Renaming a history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ol>   <li>Click on <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> (<strong>Edit</strong>) next to the history name (which by default is “Unnamed history”)</li>   <li>Type the new name</li>   <li>Click on <strong>Save</strong></li> </ol>   <p>If you do not have the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> (<strong>Edit</strong>) next to the history name:</p>   <ol>   <li>Click on <strong>Unnamed history</strong> (or the current name of the history) (<strong>Click to rename history</strong>) at the top of your history panel</li>   <li>Type the new name</li>   <li>Press <kbd>Enter</kbd></li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Import <code class=\"language-plaintext highlighter-rouge\">wt_H3K4me3_read1.fastq.gz</code> and <code class=\"language-plaintext highlighter-rouge\">wt_H3K4me3_read2.fastq.gz</code> from <a href=\"https://zenodo.org/record/1324070\">Zenodo</a> or from the data library (ask your instructor)</p>\n\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/1324070/files/wt_H3K4me3_read1.fastq.gz\nhttps://zenodo.org/record/1324070/files/wt_H3K4me3_read2.fastq.gz\n</code></pre></div>      </div>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-via-links\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-via-links\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing via links</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-data-from-a-data-library\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-data-from-a-data-library\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing data from a data library</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>As an alternative to uploading the data from a URL or your computer, the files may also have been made available from a <em>shared data library</em>:</p>   <ol>   <li>Go into <strong>Shared data</strong> (top panel) then <strong>Data libraries</strong></li>   <li>Navigate to  the correct folder as indicated by your instructor.     <ul>       <li>On most Galaxies tutorial data will be provided in a folder named <strong>GTN - Material –&gt; Topic Name -&gt; Tutorial Name</strong>.</li>     </ul>   </li>   <li>Select the desired files</li>   <li>Click on <strong>Add to History</strong> <i class=\"fas fa-caret-down\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-dropdown</span> near the top and select <strong>as Datasets</strong> from the dropdown menu</li>   <li>     <p>In the pop-up window, choose</p>     <ul>       <li><em>“Select history”</em>: the history you want to import the data to (or create a new one)</li>     </ul>   </li>   <li>Click on <strong>Import</strong></li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <p>As default, Galaxy takes the link as name, so rename them.</p>\n    </li>\n    <li>\n      <p>Rename the files <code class=\"language-plaintext highlighter-rouge\">wt_H3K4me3_read1</code> and <code class=\"language-plaintext highlighter-rouge\">wt_H3K4me3_read2</code></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-renaming-a-dataset\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-renaming-a-dataset\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Renaming a dataset</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, change the <strong>Name</strong> field</li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Inspect the first file by clicking on the <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> (eye) icon (<strong>View data</strong>)</p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>How are the DNA sequences stored?</li>\n    <li>What are the other entries of the file?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n    <ol>\n      <li>The DNA sequences are stored in a FASTQ file, in the second line of every 4-line group.</li>\n      <li>This file format is called <a href=\"https://en.wikipedia.org/wiki/FASTQ_format\">FASTQ format</a>. It stores sequence information and quality information. Each sequence is represented by a group of 4 lines with the 1st line being the sequence id, the second the sequence of nucleotides, the third a transition line and the last one a sequence of quality score for each nucleotide.</li>\n    </ol>\n  </blockquote>\n</blockquote>\n\n<p>During sequencing, errors are introduced, such as incorrect nucleotides being called. These are due to the technical limitations of each sequencing platform. Sequencing errors might bias the analysis and can lead to a misinterpretation of the data.</p>\n\n<p>Sequence quality control is therefore an essential first step in your analysis. We use here similar tools as described in <a href=\"/training-material/topics/sequence-analysis\">“Quality control” tutorial</a>: <a href=\"https://www.bioinformatics.babraham.ac.uk/projects/fastqc/\">FastQC</a> and <a href=\"https://www.bioinformatics.babraham.ac.uk/projects/trim_galore/\">Trim Galore</a>.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Quality control</hands-on-title>\n\n  <ol>\n    <li>Run <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/devteam/fastqc/fastqc/0.73+galaxy0\" title=\"FastQC tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>FastQC</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.73+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“Short read data from your current history”</em>: <code class=\"language-plaintext highlighter-rouge\">wt_H3K4me3_read1</code> and <code class=\"language-plaintext highlighter-rouge\">wt_H3K4me3_read2</code> (Input datasets selected with <strong>Multiple datasets</strong>)</li>\n      </ul>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-select-multiple-datasets\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-select-multiple-datasets\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Select multiple datasets</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ol>   <li>Click on <i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <strong>Multiple datasets</strong></li>   <li>Select several files by keeping the <kbd>Ctrl</kbd> (or <kbd>COMMAND</kbd>) key pressed and clicking on the files of interest</li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Inspect the generated HTML files</p>\n\n      <blockquote class=\"question\">\n        <question-title></question-title>\n\n        <ol>\n          <li>How is the quality of the reads in <code class=\"language-plaintext highlighter-rouge\">wt_H3K4me3_read1</code>?</li>\n          <li>And in <code class=\"language-plaintext highlighter-rouge\">wt_H3K4me3_read2</code>?</li>\n          <li>What should we do if the quality of the reads is not good?</li>\n        </ol>\n\n        <blockquote class=\"solution\">\n          <solution-title></solution-title>\n          <ol>\n            <li>The reads in <code class=\"language-plaintext highlighter-rouge\">wt_H3K4me3_read1</code> are of good quality:\n              <ul>\n                <li>There is 50,000 sequences, all of 51 bp</li>\n                <li>\n                  <p>The “Per base sequence quality” is not decreasing too much at the end of the sequences</p>\n\n                  <figure id=\"figure-3\" style=\"max-width: 90%;\"><img src=\"../../images/formation_of_super-structures_on_xi/read1_per_base_sequence_quality.png\" alt=\"Per base sequence quality for read1. \" width=\"600\" height=\"438\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/formation_of_super-structures_on_xi/read1_per_base_sequence_quality.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 3</strong>:</span> Per base sequence quality</figcaption></figure>\n                </li>\n                <li>\n                  <p>The mean quality score over the reads is quite high</p>\n\n                  <figure id=\"figure-4\" style=\"max-width: 90%;\"><img src=\"../../images/formation_of_super-structures_on_xi/read1_per_sequence_quality_scores.png\" alt=\"Per sequence quality scores for read1. \" width=\"500\" height=\"366\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/formation_of_super-structures_on_xi/read1_per_sequence_quality_scores.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 4</strong>:</span> Per sequence quality scores</figcaption></figure>\n                </li>\n                <li>\n                  <p>Homogeneous percentage of the bases</p>\n\n                  <figure id=\"figure-5\" style=\"max-width: 90%;\"><img src=\"../../images/formation_of_super-structures_on_xi/read1_per_base_sequence_content.png\" alt=\"Per base sequence content for read1. \" width=\"500\" height=\"362\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/formation_of_super-structures_on_xi/read1_per_base_sequence_content.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 5</strong>:</span> Per base sequence content</figcaption></figure>\n                </li>\n                <li>\n                  <p>No N in the reads</p>\n\n                  <figure id=\"figure-6\" style=\"max-width: 90%;\"><img src=\"../../images/formation_of_super-structures_on_xi/read1_per_base_n_content.png\" alt=\"Per base N content for read1. \" width=\"500\" height=\"364\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/formation_of_super-structures_on_xi/read1_per_base_n_content.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 6</strong>:</span> Per base N content</figcaption></figure>\n                </li>\n                <li>\n                  <p>No duplicated sequences</p>\n\n                  <figure id=\"figure-7\" style=\"max-width: 90%;\"><img src=\"../../images/formation_of_super-structures_on_xi/read1_sequence_duplication_levels.png\" alt=\"Sequence Duplication Levels for read1. \" width=\"500\" height=\"366\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/formation_of_super-structures_on_xi/read1_sequence_duplication_levels.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 7</strong>:</span> Sequence Duplication Levels</figcaption></figure>\n                </li>\n                <li>\n                  <p>No more known adapters</p>\n\n                  <figure id=\"figure-8\" style=\"max-width: 90%;\"><img src=\"../../images/formation_of_super-structures_on_xi/read1_adapter_content.png\" alt=\"Adapter Content for read1. \" width=\"500\" height=\"365\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/formation_of_super-structures_on_xi/read1_adapter_content.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 8</strong>:</span> Adapter Content</figcaption></figure>\n                </li>\n              </ul>\n            </li>\n            <li>\n              <p>The reads in <code class=\"language-plaintext highlighter-rouge\">wt_H3K4me3_read2</code> are a bit worse:</p>\n\n              <ul>\n                <li>\n                  <p>The “Per base sequence quality” is decreasing more at the end of the sequences, but it stays correct</p>\n\n                  <figure id=\"figure-9\" style=\"max-width: 90%;\"><img src=\"../../images/formation_of_super-structures_on_xi/read1_per_base_sequence_quality.png\" alt=\"Per base sequence quality for read2. \" width=\"600\" height=\"438\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/formation_of_super-structures_on_xi/read1_per_base_sequence_quality.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 9</strong>:</span> Per base sequence quality</figcaption></figure>\n                </li>\n                <li>\n                  <p>The sequence <code class=\"language-plaintext highlighter-rouge\">NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN</code> is over represented</p>\n                </li>\n              </ul>\n\n              <p>Despite these small things, the overall quality of the reads is really good.</p>\n            </li>\n            <li>If the quality of the reads is not good, we should:\n              <ol>\n                <li>Check what is wrong and think about it: it may come from the type of sequencing or what we sequenced (high quantity of overrepresented sequences in transcriptomics data, biaised percentage of bases in HiC data)</li>\n                <li>Ask the sequencing facility about it</li>\n                <li>Perform some quality treatment (in a reasonable way to not loose too much information) with some trimming or removal of bad reads</li>\n              </ol>\n            </li>\n          </ol>\n\n        </blockquote>\n      </blockquote>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>It is often necessary to trim sequenced read, for example, to get rid of bases that were sequenced with high uncertainty (= low quality bases) at the read ends.</p>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>What is the relation between <code class=\"language-plaintext highlighter-rouge\">wt_H3K4me3_read1</code> and <code class=\"language-plaintext highlighter-rouge\">wt_H3K4me3_read2</code> ?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n    <p>The data has been sequenced using paired-end sequencing.</p>\n\n    <p>The paired-end sequencing is based on the idea that the initial DNA fragments (longer than the actual read length) is sequenced from both sides. This approach results in two reads per fragment, with the first read in forward orientation and the second read in reverse-complement orientation. The distance between both reads is known. Thus, it can be used as an additional piece of information to improve the read mapping.</p>\n\n    <p>With paired-end sequencing, each fragment is more covered than with single-end sequencing (only forward orientation sequenced):</p>\n\n    <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>    ------&gt;\n      ------&gt;\n        ------&gt;\n          ------&gt;\n\n    ----------------------------- [fragment]\n\n    ------&gt;         &lt;------\n      ------&gt;         &lt;------\n        ------&gt;         &lt;------\n          ------&gt;         &lt;------\n</code></pre></div>    </div>\n\n    <p>The paired-end sequencing generates then 2 files:</p>\n    <ul>\n      <li>One file with the sequences corresponding to forward orientation of all the fragments</li>\n      <li>One file with the sequences corresponding to reverse orientation of all the fragments</li>\n    </ul>\n\n    <p>Here <code class=\"language-plaintext highlighter-rouge\">wt_H3K4me3_read1</code> corresponds to the forward reads and <code class=\"language-plaintext highlighter-rouge\">wt_H3K4me3_read2</code> to the reverse reads.</p>\n  </blockquote>\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Trimming low quality bases</hands-on-title>\n\n  <ol>\n    <li>Run <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/trim_galore/trim_galore/0.6.7+galaxy0\" title=\"Trim Galore! tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Trim Galore!</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.6.7+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><em>“Is this library paired- or single-end?”</em>: <code class=\"language-plaintext highlighter-rouge\">Paired-end</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Reads in FASTQ format”</em>: <code class=\"language-plaintext highlighter-rouge\">wt_H3K4me3_read1</code> (Input dataset)</li>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Reads in FASTQ format”</em>: <code class=\"language-plaintext highlighter-rouge\">wt_H3K4me3_read2</code> (Input dataset)</li>\n          </ul>\n\n          <p>The order is important here!</p>\n\n          <blockquote class=\"tip\">\n            <tip-title>Not selectable files?</tip-title>\n\n            <p>If your FASTQ files cannot be selected, you might check whether their format is FASTQ with Sanger-scaled quality values (<code class=\"language-plaintext highlighter-rouge\">fastqsanger</code>). You can edit the data type by clicking on the <code class=\"language-plaintext highlighter-rouge\">pencil</code> symbol.</p>\n          </blockquote>\n        </li>\n        <li><em>“Trim Galore! advanced settings”</em>: <code class=\"language-plaintext highlighter-rouge\">Full parameter list</code>\n          <ul>\n            <li><em>“Trim low-quality ends from reads in addition to adapter removal”</em>: <code class=\"language-plaintext highlighter-rouge\">15</code></li>\n            <li><em>“Overlap with adapter sequence required to trim a sequence”</em>: <code class=\"language-plaintext highlighter-rouge\">3</code></li>\n            <li><em>“Generate a report file”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>\n      <p>Inspect the generated txt file (<code class=\"language-plaintext highlighter-rouge\">report file</code>)</p>\n\n      <blockquote class=\"question\">\n        <question-title></question-title>\n\n        <ol>\n          <li>How many basepairs has been removed from the forwards reads because of bad quality?</li>\n          <li>And from the reverse reads?</li>\n          <li>How many sequence pairs have been removed because at least one read was shorter than the length cutoff?</li>\n        </ol>\n\n        <blockquote class=\"solution\">\n          <solution-title></solution-title>\n          <ol>\n            <li>32,198 bp (1.3%) (first <code class=\"language-plaintext highlighter-rouge\">Quality-trimmed:</code>)</li>\n            <li>116,414 bp (4.6%) (second <code class=\"language-plaintext highlighter-rouge\">Quality-trimmed:</code>). It is not a surprise: we saw that the quality was dropping more at the end of the sequences for the reverse reads thant for the forward reads.</li>\n            <li>1569 (3.14%) sequences (last line of the file)</li>\n          </ol>\n        </blockquote>\n      </blockquote>\n    </li>\n  </ol>\n</blockquote>\n\n<h1 id=\"step-2-mapping-of-the-reads\">Step 2: Mapping of the reads</h1>\n\n<p>With ChiP sequencing, we obtain sequences corresponding to a portion of DNA linked to the histone mark of interest, H3K4me3 in this case. As H3K4me3 opens the chromatime, nearby genes are gioing to be more transcribed. It would be interesting to know if there is a difference in the quantity of DNA impacted by H3K4me3 and the impacted genes between active and inactive X chromosome.</p>\n\n<p>We first need to figure out where the sequenced DNA fragments originated from in the genome. The reads must be aligned to a reference genome to identify the binding sites.</p>\n\n<p>This is equivalent to solving a jigsaw puzzles, but unfortunately, not all pieces are unique.</p>\n\n<p>In principle, we could do a BLAST analysis to figure out where the sequenced pieces fit best in the known genome. Aligning millions of short sequences this way may, however, take a couple of weeks. And we do not really care about the exact base to base correspondence (<strong>alignment</strong>). What we are really interested in is “where these reads came from”. This approach is called <strong>mapping</strong>.</p>\n\n<p>Nowadays, there are many mapping programs for shotgun sequenced DNA. We will use <a href=\"http://bowtie-bio.sourceforge.net/bowtie2/index.shtml\">Bowtie2</a>.</p>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>What is a reference genome?</li>\n    <li>For each model organism, several possible reference genomes may be available (e.g. <code class=\"language-plaintext highlighter-rouge\">hg19</code> and <code class=\"language-plaintext highlighter-rouge\">hg38</code> for human). What do they correspond to?</li>\n    <li>Which reference genome should we use?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n    <ol>\n      <li>A reference genome (or reference assembly) is a set of nucleic acid sequences assembled as a representative example of a species’ genetic material. As they are often assembled from the sequencing of different individuals, they do not accurately represent the set of genes of any single organism, but a mosaic of different nucleic acid sequences from each individual.</li>\n      <li>As the cost of DNA sequencing falls, and new full genome sequencing technologies emerge, more genome sequences continue to be generated. Using these new sequences, new alignments are built and the reference genomes improved (fewer gaps, fixed misrepresentations in the sequence, etc). The different reference genomes correspond to the different released versions (called “builds”).</li>\n      <li>Wang et al. (2018) did ChIP-seq on mouse. So we should use the mouse reference genome. We will use mm10 (the latest build)</li>\n    </ol>\n  </blockquote>\n</blockquote>\n\n<h2 id=\"running-bowtie2\">Running Bowtie2</h2>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Mapping</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/devteam/bowtie2/bowtie2/2.5.0+galaxy0\" title=\"Bowtie2 tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Bowtie2</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.5.0+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><em>“Is this single or paired library”</em>: <code class=\"language-plaintext highlighter-rouge\">Paired-end</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“FASTA/Q file #1”</em>: <code class=\"language-plaintext highlighter-rouge\">trimmed reads pair 1</code> (output of <strong>Trim Galore!</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“FASTA/Q file #2”</em>: <code class=\"language-plaintext highlighter-rouge\">trimmed reads pair 2</code> (output of <strong>Trim Galore!</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n          </ul>\n        </li>\n        <li><em>“Will you select a reference genome from your history or use a built-in index?”</em>: <code class=\"language-plaintext highlighter-rouge\">Use a built-in genome index</code>\n          <ul>\n            <li><em>“Select reference genome”</em>: <code class=\"language-plaintext highlighter-rouge\">Mouse (Mus musculus): mm10</code></li>\n          </ul>\n        </li>\n        <li><em>“Save the bowtie2 mapping statistics to the history”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n      </ul>\n    </li>\n    <li>\n      <p>Inspect the mapping stats</p>\n\n      <blockquote class=\"question\">\n        <question-title></question-title>\n\n        <p>How many reads where mapped? Uniquely or several times?</p>\n\n        <blockquote class=\"solution\">\n          <solution-title></solution-title>\n          <p>The overall alignment rate is 98.57%. This score is quite high. If you have less than 70-80%, you should investigate the cause: contamination, etc.</p>\n\n          <p>41514 (85.72%) reads have been aligned concordantly exactly 1 time and 5190 (10.72%) aligned concordantly &gt;1 times. The latter ones correspond to multiple mapped reads. Allowing for multiple  mapped reads increases the number of usable reads and the sensitivity of peak detection;\nhowever, the number of false positives may also increase.</p>\n        </blockquote>\n      </blockquote>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>The output of Bowtie2 is a BAM file.</p>\n\n<h2 id=\"inspection-of-a-bam-file\">Inspection of a BAM file</h2>\n\n<p>A BAM (<a href=\"https://en.wikipedia.org/wiki/SAM_(file_format)\">Binary Alignment Map</a>) file is a compressed binary file storing the read sequences, whether they have been aligned to a reference sequence (e.g. a chromosome), and if so, the position on the reference sequence at which they have been aligned.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Inspect a BAM/SAM file</hands-on-title>\n\n  <ol>\n    <li>Inspect the <i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> output of <strong>Bowtie2</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n  </ol>\n\n</blockquote>\n\n<p>A BAM file (or a SAM file, the non-compressed version) consists of:</p>\n\n<ul>\n  <li>A header section (the lines starting with <code class=\"language-plaintext highlighter-rouge\">@</code>) containing metadata particularly the chromosome names and lengths (lines starting with the <code class=\"language-plaintext highlighter-rouge\">@SQ</code> symbol)</li>\n  <li>\n    <p>An alignment section consisting of a table with 11 mandatory fields, as well as a variable number of optional fields:</p>\n\n    <table>\n      <thead>\n        <tr>\n          <th>Col</th>\n          <th>Field</th>\n          <th>Type</th>\n          <th>Brief Description</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr>\n          <td>1</td>\n          <td>QNAME</td>\n          <td>String</td>\n          <td>Query template NAME</td>\n        </tr>\n        <tr>\n          <td>2</td>\n          <td>FLAG</td>\n          <td>Integer</td>\n          <td>Bitwise FLAG</td>\n        </tr>\n        <tr>\n          <td>3</td>\n          <td>RNAME</td>\n          <td>String</td>\n          <td>References sequence NAME</td>\n        </tr>\n        <tr>\n          <td>4</td>\n          <td>POS</td>\n          <td>Integer</td>\n          <td>1- based leftmost mapping POSition</td>\n        </tr>\n        <tr>\n          <td>5</td>\n          <td>MAPQ</td>\n          <td>Integer</td>\n          <td>MAPping Quality</td>\n        </tr>\n        <tr>\n          <td>6</td>\n          <td>CIGAR</td>\n          <td>String</td>\n          <td>CIGAR String</td>\n        </tr>\n        <tr>\n          <td>7</td>\n          <td>RNEXT</td>\n          <td>String</td>\n          <td>Ref. name of the mate/next read</td>\n        </tr>\n        <tr>\n          <td>8</td>\n          <td>PNEXT</td>\n          <td>Integer</td>\n          <td>Position of the mate/next read</td>\n        </tr>\n        <tr>\n          <td>9</td>\n          <td>TLEN</td>\n          <td>Integer</td>\n          <td>Observed Template LENgth</td>\n        </tr>\n        <tr>\n          <td>10</td>\n          <td>SEQ</td>\n          <td>String</td>\n          <td>Segment SEQuence</td>\n        </tr>\n        <tr>\n          <td>11</td>\n          <td>QUAL</td>\n          <td>String</td>\n          <td>ASCII of Phred-scaled base QUALity+33</td>\n        </tr>\n      </tbody>\n    </table>\n  </li>\n</ul>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>Which information do you find in a SAM/BAM file?</li>\n    <li>What is the additional information compared to a FASTQ file?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n    <ol>\n      <li>Sequences and quality information, like a FASTQ</li>\n      <li>Mapping information, Location of the read on the chromosome, Mapping quality, etc</li>\n    </ol>\n  </blockquote>\n</blockquote>\n\n<h2 id=\"visualization-using-a-genome-browser\">Visualization using a Genome Browser</h2>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Visualization of the reads in IGV</hands-on-title>\n\n  <p>There are two ways to run it:</p>\n\n  <ol>\n    <li>If you have IGV installed (or want to install it):\n      <ol>\n        <li>Install <a href=\"https://software.broadinstitute.org/software/igv/download\">IGV</a></li>\n        <li>Launch IGV on your computer</li>\n        <li>Expand the <i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> output of <strong>Bowtie2</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n        <li>Click on the <code class=\"language-plaintext highlighter-rouge\">local</code> in <code class=\"language-plaintext highlighter-rouge\">display with IGV</code> to load the reads into the IGV browser</li>\n      </ol>\n    </li>\n    <li>If you do not have IGV\n      <ol>\n        <li>Click on the <code class=\"language-plaintext highlighter-rouge\">Mouse mm10</code> (or correct organism) in <code class=\"language-plaintext highlighter-rouge\">display with IGV</code> to load the reads into the IGV browser</li>\n      </ol>\n    </li>\n    <li>Zoom on the <code class=\"language-plaintext highlighter-rouge\">chr2:91,053,413-91,055,345</code></li>\n  </ol>\n</blockquote>\n\n<p>The reads have a direction: they are mapped to the forward or reverse strand, respectively. When hovering over a read, extra information is displayed</p>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>What could it mean if a bar in the coverage view is colored?</li>\n    <li>What could be the reason why a read is white instead of grey?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n    <ol>\n      <li>If a nucleotide differs from the reference sequence in more than 20% of quality weighted reads, IGV colors the bar in proportion to the read count of each base.</li>\n      <li>They have a mapping quality equal to zero. Interpretation of this mapping quality depends on the mapping aligner as some commonly used aligners use this convention to mark a read with multiple alignments. In such a case, the read also maps to another location with equally good placement. It is also possible that the read could not be uniquely placed but the other placements do not necessarily give equally good quality hits.</li>\n    </ol>\n  </blockquote>\n</blockquote>\n\n<blockquote class=\"comment\">\n  <comment-title>Tips for IGV</comment-title>\n  <ol>\n    <li>Because the number of reads over a region can be quite large, the IGV browser by default only displays the reads that fall into a small window. This behaviour can be changed in the IGV from <code class=\"language-plaintext highlighter-rouge\">view &gt; Preferences &gt; Alignments</code>.</li>\n    <li>\n      <p>If the genome of your interest is not there check if it is available via <strong>More…</strong>. If this is not the case, you can add it manually via the menu <strong>Genomes</strong> -&gt; <strong>Load Genome from…</strong></p>\n\n      <p><img src=\"../../images/igv_select_genome.png\" alt=\"Select genome in IGV\" title=\"Select genome in IGV\" /></p>\n    </li>\n  </ol>\n\n  <p>A general description of the user interface of the IGV browser is available here: <a href=\"/training-material/topics/introduction/tutorials/igv-introduction/tutorial.html\">IGV Browser description</a></p>\n</blockquote>\n\n<h1 id=\"step-3-chip-seq-quality-control\">Step 3: ChIP-seq Quality Control</h1>\n\n<p>We already checked the quality of the raw sequencing reads in the first step.\nNow we would like to test the quality of the ChIP-seq preparation, to know if our ChIP-seq samples are more enriched than the control (input) samples.</p>\n\n<h2 id=\"correlation-between-samples\">Correlation between samples</h2>\n\n<p>To assess the similarity between the replicates of the ChIP and the input, respectively, it is a common technique to calculate the correlation of read counts on different regions for all different samples.\nWe expect that the replicates of the ChIP-seq experiments should be clustered more closely to each other than the replicates of the input sample. That is, because the input samples should not have enriched regions included - remember the immuno-precipitation step was skiped during the sample preparation.</p>\n\n<p>To compute the correlation between the samples we are going to to use the QC modules of <a href=\"http://deeptools.readthedocs.io/\">deepTools</a>, a software package for the QC, processing and analysis of NGS data. Before computing the correlation a time consuming step is required, which is to compute the read coverage (number of unique reads mapped at a given nucleotide) over a large number of regions from each of the inputed BAM files. For this we will use the tool <strong>multiBamSummary</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>. Then, we use <strong>plotCorrelation</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> from deepTools to compute and visualize the sample correlation. This is a fast process that allows to quickly try different color combinations and outputs.</p>\n\n<p>Since in this tutorial we are interested in assessing H3K4me3, H3K27me3 and CTCF ChIP samples, the previous steps (quality control and mapping) needs to be run on all the replicates of ChIP samples as well as the input samples. To save time, we have already done that and you can now work directly on the BAM files of the provided 8 samples. For simplicity, the files include only the ChrX.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Correlation between samples</hands-on-title>\n\n  <ol>\n    <li>Create a new history</li>\n    <li>\n      <p>Import the 8 BAM files from <a href=\"https://zenodo.org/record/1324070\">Zenodo</a> or from the data library into the history</p>\n\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/1324070/files/wt_CTCF_rep1.bam\nhttps://zenodo.org/record/1324070/files/wt_CTCF_rep2.bam\nhttps://zenodo.org/record/1324070/files/wt_H3K4me3_rep1.bam\nhttps://zenodo.org/record/1324070/files/wt_H3K4me3_rep2.bam\nhttps://zenodo.org/record/1324070/files/wt_H3K27me3_rep1.bam\nhttps://zenodo.org/record/1324070/files/wt_H3K27me3_rep2.bam\nhttps://zenodo.org/record/1324070/files/wt_input_rep1.bam\nhttps://zenodo.org/record/1324070/files/wt_input_rep2.bam\n</code></pre></div>      </div>\n    </li>\n    <li>Rename the files</li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_multi_bam_summary/deeptools_multi_bam_summary/3.5.1.0.0\" title=\"multiBamSummary tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>multiBamSummary</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 3.5.1.0.0)</span> with the following parameters:\n      <ul>\n        <li><em>“Sample order matters”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code>\n          <ul>\n            <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“BAM/CRAM file”</em>: the 8 imported BAM files</li>\n          </ul>\n        </li>\n        <li><em>“Choose computation mode”</em>: <code class=\"language-plaintext highlighter-rouge\">Bins</code>\n          <ul>\n            <li>\n              <p><em>“Bin size in bp”</em>: <code class=\"language-plaintext highlighter-rouge\">1000</code></p>\n\n              <p>This corresponds to the length of the fragments that were sequenced; it is not the read length!</p>\n            </li>\n            <li>\n              <p><em>“Distance between bins”</em>: <code class=\"language-plaintext highlighter-rouge\">500</code></p>\n\n              <p>It reduces the computation time for the tutorial</p>\n            </li>\n          </ul>\n        </li>\n        <li><em>“Region of the genome to limit the operation to”</em>: <code class=\"language-plaintext highlighter-rouge\">chrX</code></li>\n      </ul>\n\n      <p>Using these parameters, the tool will take bins of 1000 bp separated by 500 bp on the chromosome X. For each bin the overlapping reads in each sample will be computed and stored into a matrix.</p>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_plot_correlation/deeptools_plot_correlation/3.5.1.0.0\" title=\"plotCorrelation tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>plotCorrelation</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 3.5.1.0.0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“Matrix file from the multiBamSummary tool”</em>: <code class=\"language-plaintext highlighter-rouge\">correlation matrix</code>(output of <strong>multiBamSummary</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Correlation method”</em>: <code class=\"language-plaintext highlighter-rouge\">Pearson</code></li>\n      </ul>\n\n      <p>Feel free to try different parameters for the configuration of the plot (colors, title, etc)</p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <figure id=\"figure-10\" style=\"max-width: 90%;\"><img src=\"../../images/formation_of_super-structures_on_xi/plotCorrelation.png\" alt=\"Output for plotCorrelation with the correlation scores between the 8 samples. \" width=\"1100\" height=\"950\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/formation_of_super-structures_on_xi/plotCorrelation.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 10</strong>:</span> Correlation scores between the 8 samples</figcaption></figure>\n\n  <p>How are your samples clustered? Does that correspond to your expectations?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n    <p>As one could expect, the input replicates cluster together and the ChIP replicates cluster together. It confirms that the immuno-precipitation step worked on our ChIP replicates.</p>\n\n    <p>Moreover, for each sample, there is a high correlation between the two replicates which confirms the validity of the experiments.</p>\n\n  </blockquote>\n</blockquote>\n\n<h2 id=\"ip-strength-estimation\">IP strength estimation</h2>\n\n<p>To evaluate the quality of the immuno-precipitation(IP) step, we can compute the IP strength. It determines how well the signal in the ChIP-seq sample can be differentiated from the background distribution of reads in the control sample (‘input’). After all, around 90% of all DNA fragments in a ChIP experiment will represent the genomic background.</p>\n\n<p>To do that we take the data from the <code class=\"language-plaintext highlighter-rouge\">rep1</code> of the <code class=\"language-plaintext highlighter-rouge\">wt_H3K4me3</code> ChIP-seq sample and compare it with its corresponding input sample, using <strong>plotFingerprint</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> of deepTools.</p>\n\n<p>Similar to <strong>multiBamSummary</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>, <strong>plotFingerprint</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> randomly samples genome regions of a specified length (bins) and sums the per-base coverage in the indexed BAM files that overlap with those regions. These coverage values are then sorted according to their rank and the cumulative sum of read counts is plotted.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>IP strength estimation</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_plot_fingerprint/deeptools_plot_fingerprint/3.5.1.0.0\" title=\"plotFingerprint tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>plotFingerprint</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 3.5.1.0.0)</span> with the following parameters:\n      <ul>\n        <li><em>“Sample order matters”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code>\n          <ul>\n            <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“BAM/CRAM file”</em>: <code class=\"language-plaintext highlighter-rouge\">wt_input_rep1</code> and <code class=\"language-plaintext highlighter-rouge\">wt_H3K4me3_rep1</code></li>\n          </ul>\n        </li>\n        <li><em>“Region of the genome to limit the operation to”</em>: <code class=\"language-plaintext highlighter-rouge\">chrX</code></li>\n        <li><em>“Show advanced options”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code>\n          <ul>\n            <li><em>“Number of samples”</em>: <code class=\"language-plaintext highlighter-rouge\">10000</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<p>The plotFingerprint tool generates a fingerprint plot. You need to intepret it to know the IP strength.</p>\n\n<p>An ideal ‘input’ with perfect uniform distribution of reads along the genome (i.e. without enrichments in open chromatin) and infinite sequencing coverage should generate a straight diagonal line. A very specific and strong ChIP enrichment will be indicated by a prominent and steep rise of the cumulative sum towards the highest rank. This means that a big chunk of reads from the ChIP sample is located in few bins which corresponds to high, narrow enrichments typically seen for transcription factors.</p>\n\n<figure id=\"figure-11\" style=\"max-width: 90%;\"><img src=\"../../images/estrogen-receptor-binding-site-identification/QC_fingerprint.png\" alt=\"A guide to interpret a fingerprint plot. \" width=\"1436\" height=\"722\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/estrogen-receptor-binding-site-identification/QC_fingerprint.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 11</strong>:</span> How to interpret a fingerprint plot? Image extracted from the deepTools documentation</figcaption></figure>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <figure id=\"figure-12\" style=\"max-width: 90%;\"><img src=\"../../images/formation_of_super-structures_on_xi/plotFingerPrint.png\" alt=\"Output for plotFingerprint with the fingerprint plot to estimate the IP strength. \" width=\"640\" height=\"480\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/formation_of_super-structures_on_xi/plotFingerPrint.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 12</strong>:</span> Fingerprint plot for the first replicates to estimate the IP strength</figcaption></figure>\n\n  <p>What do you think about the quality of the IP for this experiment?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n    <p>There is clear distinction between H3K4me3 and the input.</p>\n\n    <p>A small percentage of the genome contain a very large fraction of the reads (&gt;70%, point of change in the blue curve)</p>\n\n    <p>The curves start to rise around 0.25. It means that almost 25% of the chromosome X is not sequenced at all.</p>\n  </blockquote>\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>(Optional) IP strength estimation (other samples)</hands-on-title>\n\n  <p>Run the same analysis on the other ChIP-seq data along with their corresponding input and compare the output</p>\n</blockquote>\n\n<h1 id=\"step-4-normalization\">Step 4: Normalization</h1>\n\n<p>One of the goals in ChIP-seq data analysis is finding regions on the genome which are enriched for the ChIP data of interest (regions with significantly higher read coverage for the ChIP data comparing to its corresponding input). In the following exercise we would like to know where the H3K4me3 sites are. For this we need to extract which parts of the genome have been enriched (i.e. more reads mapped) within the samples that underwent immunoprecipitation. However, to reach a reliable comparison the data needs to be normalized to remove any technical bias. For the normalization we have two steps:</p>\n\n<ol>\n  <li>Normalization by sequencing depth</li>\n  <li>Normalization by input file</li>\n</ol>\n\n<p>To learn how to do the normalization, we will take the <code class=\"language-plaintext highlighter-rouge\">wt_H3K4me3_rep1</code> sample as ChIP data and <code class=\"language-plaintext highlighter-rouge\">wt_input_rep1</code> as input.</p>\n\n<h2 id=\"generation-of-coverage-files-normalized-by-sequencing-depth\">Generation of coverage files normalized by sequencing depth</h2>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Estimation of the sequencing depth</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/devteam/samtools_idxstats/samtools_idxstats/2.0.4\" title=\"Samtools idxstats tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Samtools idxstats</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.0.4)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“BAM file”</em>: <code class=\"language-plaintext highlighter-rouge\">wt_H3K4me3_rep1.bam</code> and <code class=\"language-plaintext highlighter-rouge\">wt_input_rep1.bam</code></li>\n      </ul>\n    </li>\n  </ol>\n\n  <blockquote class=\"question\">\n    <question-title></question-title>\n\n    <ol>\n      <li>What is the output of <strong>Samtools idxstats</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>?</li>\n      <li>How many reads has been mapped on chrX for the input and for the ChIP-seq samples?</li>\n      <li>Why are the number of reads different? And what could be the impact of this difference?</li>\n    </ol>\n\n    <blockquote class=\"solution\">\n      <solution-title></solution-title>\n      <ol>\n        <li>This tool generates a table with 4 columns:  reference sequence identifier, reference sequence length, number of mapped reads and number of placed but unmapped reads. Here it estimates how many reads mapped to which chromosome. Furthermore, it tells the chromosome lengths and naming convention (with or without ‘chr’ in the beginning)</li>\n        <li>1,204,821 for ChIP-seq samples and 1,893,595 for the input</li>\n        <li>The number of reads can be different because of  different sequencing depth. It can bias the interpretation of the number of reads mapped to a specific genome region and the identification of the H3K4me3 sites. Specially here, as the number of reads for the input is higher than the ChIP data less regions could be identified having a significantly higher read coverage for the ChIP data comparing to the corresponding input.</li>\n      </ol>\n    </blockquote>\n  </blockquote>\n</blockquote>\n\n<p>The different samples have usually a different sequencing depth, i.e. a different number of reads. These differences can bias the interpretation of the number of reads mapped to a specific genome region. We first need to make the samples comparable by normalizing the coverage by the sequencing depth.</p>\n\n<p>We are using <strong>bamCoverage</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>. Given a BAM file, this tool generates coverages by first calculating all the number of reads (either extended to match the fragment length or not) that overlap each bin in the genome and then normalizing with various options. It produces a coverage file where for each bin the number of overlapping reads (possibly normalized) is noted.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Coverage file normalization</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_bam_coverage/deeptools_bam_coverage/3.5.1.0.0\" title=\"bamCoverage tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>bamCoverage</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 3.5.1.0.0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“BAM file”</em>: <code class=\"language-plaintext highlighter-rouge\">wt_H3K4me3_rep1.bam</code> and <code class=\"language-plaintext highlighter-rouge\">wt_input_rep1.bam</code></li>\n        <li><em>“Bin size in bases”</em>: <code class=\"language-plaintext highlighter-rouge\">25</code></li>\n        <li><em>“Scaling/Normalization method”</em>: <code class=\"language-plaintext highlighter-rouge\">Normalize coverage to 1x</code>\n          <ul>\n            <li><em>“Effective genome size”</em>: <code class=\"language-plaintext highlighter-rouge\">GRCm38/mm10 (2308125349)</code></li>\n          </ul>\n        </li>\n        <li><em>“Coverage file format”</em>: <code class=\"language-plaintext highlighter-rouge\">bedgraph</code></li>\n        <li><em>“Region of the genome to limit the operation to”</em>: <code class=\"language-plaintext highlighter-rouge\">chrX</code></li>\n      </ul>\n\n      <blockquote class=\"question\">\n        <question-title></question-title>\n\n        <ol>\n          <li>What is a <code class=\"language-plaintext highlighter-rouge\">bedgraph</code> file?</li>\n          <li>Which regions have the highest coverage in ChIP data and in the input?</li>\n        </ol>\n\n        <blockquote class=\"solution\">\n          <solution-title></solution-title>\n          <ol>\n            <li>It is a tabular file with 4 columns: chrom, chromStart, chromEnd and a data value (coverage)</li>\n            <li>We can run <strong>Sort</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> on the 4th column in descending order to get the regions with the highest (normalized) coverage. For <code class=\"language-plaintext highlighter-rouge\">wt_H3K4me3_rep1</code>, the regions between 152,233,600\tand 152,233,625\t are the most covered. For <code class=\"language-plaintext highlighter-rouge\">wt_input_rep1</code>, between 143,483,000 and 143,483,100.</li>\n          </ol>\n        </blockquote>\n      </blockquote>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_bam_coverage/deeptools_bam_coverage/3.5.1.0.0\" title=\"bamCoverage tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>bamCoverage</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 3.5.1.0.0)</span> with the same parameters but\n      <ul>\n        <li><em>“Coverage file format”</em>: <code class=\"language-plaintext highlighter-rouge\">bigWig</code></li>\n      </ul>\n\n      <blockquote class=\"question\">\n        <question-title></question-title>\n\n        <p>What is a <code class=\"language-plaintext highlighter-rouge\">bigWig</code> file?</p>\n\n        <blockquote class=\"solution\">\n          <solution-title></solution-title>\n          <p>A <code class=\"language-plaintext highlighter-rouge\">bigWig</code> file is a compressed <code class=\"language-plaintext highlighter-rouge\">bedgraph</code> file. Similar in relation as BAM to SAM, but this time just for coverage data. This means bigWig and bedgraph files are much smaller than BAM or SAM files (no sequence or quality information).</p>\n        </blockquote>\n      </blockquote>\n    </li>\n    <li>Use <strong>IGV</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> to inspect both signal coverages (input and ChIP samples).</li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>If you zoom to <code class=\"language-plaintext highlighter-rouge\">chrX:151,385,260-152,426,526</code>, what do you observe?</p>\n\n  <figure id=\"figure-13\" style=\"max-width: 90%;\"><img src=\"../../images/formation_of_super-structures_on_xi/bamcoverage_igv.png\" alt=\"Output of bamCoverage. \" width=\"1265\" height=\"337\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/formation_of_super-structures_on_xi/bamcoverage_igv.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 13</strong>:</span> bamCoverage for wt_H3K4me3_rep1 and wt_input_rep1 on chrX:151,385,260-152,426,526</figcaption></figure>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n    <p>The track with the coverage for the input (<code class=\"language-plaintext highlighter-rouge\">wt_input_rep1</code>) seems quite homogeneous. On the other hand, for <code class=\"language-plaintext highlighter-rouge\">wt_H3K4me3_rep1</code>, we can observe some clear peaks at the beginning of the genes.</p>\n  </blockquote>\n</blockquote>\n\n<h2 id=\"generation-of-input-normalized-coverage-files\">Generation of input-normalized coverage files</h2>\n\n<p>To extract only the information induced by the immunoprecipitation, we normalize the coverage file for the sample that underwent immunoprecipitation by the coverage file for the input sample. Here we use the tool <strong>bamCompare</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> which compare 2 BAM files while caring for sequencing depth normalization.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Generation of input-normalized coverage files</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_bam_compare/deeptools_bam_compare/3.5.1.0.0\" title=\"bamCompare tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>bamCompare</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 3.5.1.0.0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“First BAM file (e.g. treated sample)”</em>: <code class=\"language-plaintext highlighter-rouge\">wt_H3K4me3_rep1.bam</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Second BAM file (e.g. control sample)”</em>: <code class=\"language-plaintext highlighter-rouge\">wt_input_rep1.bam</code></li>\n        <li><em>“Bin size in bases”</em>: <code class=\"language-plaintext highlighter-rouge\">50</code></li>\n        <li><em>“How to compare the two files”</em>: <code class=\"language-plaintext highlighter-rouge\">Compute log2 of the number of reads ratio</code></li>\n        <li><em>“Coverage file format”</em>: <code class=\"language-plaintext highlighter-rouge\">bedgraph</code></li>\n        <li><em>“Region of the genome to limit the operation to”</em>: <code class=\"language-plaintext highlighter-rouge\">chrX</code></li>\n      </ul>\n\n      <blockquote class=\"question\">\n        <question-title></question-title>\n\n        <ol>\n          <li>What does a positive value or a negative value mean in the 4th column?</li>\n          <li>Which regions have the highest coverage in the ChIP data? and the lowest?</li>\n        </ol>\n\n        <blockquote class=\"solution\">\n          <solution-title></solution-title>\n          <ol>\n            <li>The 4th column contains the log2 of the number of reads ratio between the ChIP-seq sample and the input sample. A positive value means that the coverage on this portion of genome is higher in the ChIP-seq sample than in the input sample</li>\n            <li>The highest: 152,233,800-152,233,850 (consistent with the most covered regions in <code class=\"language-plaintext highlighter-rouge\">wt_H3K4me3_rep1</code> given by <strong>bamCoverage</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>). The lowest: 169,916,600-169,916,650</li>\n          </ol>\n        </blockquote>\n      </blockquote>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_bam_compare/deeptools_bam_compare/3.5.1.0.0\" title=\"bamCompare tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>bamCompare</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 3.5.1.0.0)</span> with the same parameters but:\n      <ul>\n        <li><em>“Coverage file format”</em>: <code class=\"language-plaintext highlighter-rouge\">bigWig</code></li>\n      </ul>\n    </li>\n    <li>Use <strong>IGV</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> to inspect the log2 ratio.</li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>How could you interpret the new track if you zoom to <code class=\"language-plaintext highlighter-rouge\">chrX:151,385,260-152,426,526</code>?</p>\n\n  <figure id=\"figure-14\" style=\"max-width: 90%;\"><img src=\"../../images/formation_of_super-structures_on_xi/bamcompare_igv.png\" alt=\"Output of bamCoverage. \" width=\"1266\" height=\"336\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/formation_of_super-structures_on_xi/bamcompare_igv.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 14</strong>:</span> bamCoverage for wt_H3K4me3_rep1 and wt_input_rep1 on chrX:151,385,260-152,426,526</figcaption></figure>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n    <p>The new track is the difference between the first track (<code class=\"language-plaintext highlighter-rouge\">wt_H3K4me3_rep1</code>) and the second track (<code class=\"language-plaintext highlighter-rouge\">wt_input_rep1</code>)</p>\n  </blockquote>\n</blockquote>\n\n<h1 id=\"step-5-detecting-enriched-regions-peak-calling\">Step 5: Detecting enriched regions (peak calling)</h1>\n\n<p>We could see in the ChIP data some enriched regions (peaks). We now would like to call these regions to obtain their coordinates, using <strong>MACS2 callpeak</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Peak calling</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/macs2/macs2_callpeak/2.2.7.1+galaxy0\" title=\"MACS2 callpeak tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>MACS2 callpeak</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.2.7.1+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><em>“Are you pooling Treatment Files?”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“ChIP-Seq Treatment File”</em>: <code class=\"language-plaintext highlighter-rouge\">wt_H3K4me3_rep1.bam</code></li>\n          </ul>\n        </li>\n        <li><em>“Do you have a Control File?”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code>\n          <ul>\n            <li><em>“Are you pooling Treatment Files?”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code>\n              <ul>\n                <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“ChIP-Seq Treatment File”</em>: <code class=\"language-plaintext highlighter-rouge\">wt_input_rep1.bam</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n        <li><em>“Format of Input Files”</em>: <code class=\"language-plaintext highlighter-rouge\">Paired-end BAM</code></li>\n        <li><em>“Effective genome size”</em>: <code class=\"language-plaintext highlighter-rouge\">M.musculus (1.87e9)</code></li>\n        <li><em>“Outputs”</em>: <code class=\"language-plaintext highlighter-rouge\">Summary page (html)</code></li>\n      </ul>\n\n      <blockquote class=\"comment\">\n        <comment-title></comment-title>\n        <p>The advanced options may be adjusted, depending of the samples.\nIf your ChIP-seq experiment targets regions of broad enrichment, <em>e.g.</em> non-punctuate histone modifications, select calling of broad regions.\nIf your sample has a low duplication rate (<em>e.g.</em> below 10%), you might keep all duplicate reads (tags). Otherwise, you might use the ‘auto’ option to estimate the maximal allowed number of duplicated reads per genomic location.</p>\n      </blockquote>\n    </li>\n    <li>\n      <p>Inspect the <i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <code class=\"language-plaintext highlighter-rouge\">(narrow Peaks)</code> file (output of <strong>MACS2 callpeak</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</p>\n\n      <blockquote class=\"question\">\n        <question-title></question-title>\n\n        <p>Which type of files were generated? What do they include?</p>\n\n        <blockquote class=\"solution\">\n          <solution-title></solution-title>\n          <p><strong>MACS2 callpeak</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> has generated a bed file with the coordinates of the identified peaks: chromosome, start, stop, name, integer score, strand, fold-change, -log10pvalue, -log10qvalue and relative summit position to peak start, as well as a html report which contains links to additional bed and xls files.</p>\n        </blockquote>\n      </blockquote>\n    </li>\n    <li><strong>IGV</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> to inspect with the signal coverage and log2 ratio tracks</li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>\n      <p>How many peaks have been identified in <code class=\"language-plaintext highlighter-rouge\">chrX:151,385,260-152,426,526</code> based on IGV?</p>\n\n      <figure id=\"figure-15\" style=\"max-width: 90%;\"><img src=\"../../images/formation_of_super-structures_on_xi/macs2_igv.png\" alt=\"Output of MACS2. \" width=\"1267\" height=\"393\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/formation_of_super-structures_on_xi/macs2_igv.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 15</strong>:</span> Peaks for wt_H3K4me3_rep1 and wt_input_rep1 on chrX:151,385,260-152,426,526</figcaption></figure>\n    </li>\n    <li>What are the fold change of the peaks identified in <code class=\"language-plaintext highlighter-rouge\">chrX:151,385,260-152,426,526</code>? Hint: using the BED file</li>\n    <li>How many peaks have been identified on the full chromosome X? How many peaks have a fold change &gt; 50?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n    <ol>\n      <li>We can see 11 peaks (track below the genes).</li>\n      <li>Using <span class=\"tool\" data-tool=\"Filter1\" title=\"Filter tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Filter</strong></span> with <code class=\"language-plaintext highlighter-rouge\">c2&gt;151385260 and c3&lt;152426526</code>, we found that the 11 peaks with fold changes between 3.81927 and 162.06572</li>\n      <li>On the 656 peaks on the full chromosome (number of lines of the original BED file) there are 252 peaks with FC&gt;50 (using <strong>Filter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with <code class=\"language-plaintext highlighter-rouge\">c7&gt;50</code>)</li>\n    </ol>\n  </blockquote>\n</blockquote>\n\n<p>The called peak regions can be filtered by, <em>e.g.</em> fold change, FDR and region length for further downstream analysis.</p>\n\n<h1 id=\"step-6-plot-the-signal-between-samples\">Step 6: Plot the signal between samples</h1>\n\n<p>So far, we have normalized the data and identified peaks. Now, we would like to visualize scores associated with certain genomic regions, for example ChIP enrichment values around the TSS of genes. Moreover, we would like to compare the enrichment of several ChIP samples (e.g. CTCF and H3K4me3 )on the regions of interest.</p>\n\n<p>Since we already generated the required files for the H3K4me3 sample, let’s make them only for the CTCF sample:</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Prepare the peaks and data for CTCF</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_bam_compare/deeptools_bam_compare/3.5.1.0.0\" title=\"bamCompare tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>bamCompare</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 3.5.1.0.0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“First BAM file (e.g. treated sample)”</em>: <code class=\"language-plaintext highlighter-rouge\">wt_CTCF_rep1.bam</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Second BAM file (e.g. control sample)”</em>: <code class=\"language-plaintext highlighter-rouge\">wt_input_rep1.bam</code></li>\n        <li><em>“Bin size in bases”</em>: <code class=\"language-plaintext highlighter-rouge\">50</code></li>\n        <li><em>“How to compare the two files”</em>: <code class=\"language-plaintext highlighter-rouge\">Compute log2 of the number of reads ratio</code></li>\n        <li><em>“Coverage file format”</em>: <code class=\"language-plaintext highlighter-rouge\">bigwig</code></li>\n        <li><em>“Region of the genome to limit the operation to”</em>: <code class=\"language-plaintext highlighter-rouge\">chrX</code></li>\n      </ul>\n    </li>\n    <li>Rename the output of <strong>bamCompare</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the name of the sample</li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/macs2/macs2_callpeak/2.2.7.1+galaxy0\" title=\"MACS2 callpeak tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>MACS2 callpeak</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.2.7.1+galaxy0)</span> with the following parameters\n      <ul>\n        <li><em>“Are you pooling Treatment Files?”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“ChIP-Seq Treatment File”</em>: <code class=\"language-plaintext highlighter-rouge\">wt_CTCF_rep1.bam</code></li>\n          </ul>\n        </li>\n        <li><em>“Do you have a Control File?”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code>\n          <ul>\n            <li><em>“Are you pooling Treatment Files?”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code>\n              <ul>\n                <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“ChIP-Seq Treatment File”</em>: <code class=\"language-plaintext highlighter-rouge\">wt_input_rep1.bam</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n        <li><em>“Format of Input Files”</em>: <code class=\"language-plaintext highlighter-rouge\">Paired-end BAM</code></li>\n        <li><em>“Effective genome size”</em>: <code class=\"language-plaintext highlighter-rouge\">M.musculus (1.87e9)</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>We can now concatenate the MACS2 outputs with the location of the peaks (concatenate the files and merge the overlapping regions) to obtain one BED file corresponding to the coordinates of the interesting regions to plot.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Prepare the peak coordinates</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"cat1\" title=\"Concatenate datasets tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Concatenate datasets</strong></span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Concatenate Dataset”</em>: output of <strong>MACS2 callpeak</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> for <code class=\"language-plaintext highlighter-rouge\">wt_CTCF_rep1</code></li>\n        <li>Click on <em>“Insert Dataset”</em>:\n          <ul>\n            <li>For <em>“Dataset”</em>: select the output of <strong>MACS2 callpeak</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> for <code class=\"language-plaintext highlighter-rouge\">wt_H3K4me3_rep1</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_sortbed/2.30.0+galaxy2\" title=\"bedtools SortBED tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>bedtools SortBED</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.30.0+galaxy2)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Sort the following BED/bedGraph/GFF/VCF/EncodePeak file”</em>: output of <strong>Concatenate</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_mergebed/2.30.0\" title=\"bedtools MergeBED tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>bedtools MergeBED</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.30.0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Sort the following BAM/BED/bedGraph/GFF/VCF/EncodePeak file”</em>: output of <strong>SortBED</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>To plot the the peaks score on the region generated above (MergeBED output) two tools from the <a href=\"http://deeptools.readthedocs.io/\">deepTools</a> package are used:</p>\n<ul>\n  <li><strong>computeMatrix</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>: it computes the signal on given regions, using the <code class=\"language-plaintext highlighter-rouge\">bigwig</code> coverage files from different samples.</li>\n  <li><strong>plotHeatmap</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>: it plots heatMap of the signals using the <strong>computeMatrix</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> output.</li>\n</ul>\n\n<p>Optionally, we can also use <strong>plotProfile</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> to create a profile plot from <strong>computeMatrix</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> output.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Plot the heatmap</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_compute_matrix/deeptools_compute_matrix/3.5.1.0.0\" title=\"computeMatrix tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>computeMatrix</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 3.5.1.0.0)</span> with the following parameters:\n      <ul>\n        <li><em>“Select regions”</em>:\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Regions to plot”</em>: output of <strong>MergeBED</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n          </ul>\n        </li>\n        <li><em>“Sample order matters”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code>\n          <ul>\n            <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“Score file”</em>: the 2 <code class=\"language-plaintext highlighter-rouge\">bigwig</code> files generated by <strong>bamCompare</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> and renamed</li>\n          </ul>\n        </li>\n        <li><em>“computeMatrix has two main output options”</em>: <code class=\"language-plaintext highlighter-rouge\">reference-point</code>\n          <ul>\n            <li><em>“The reference point for the plotting”</em>: <code class=\"language-plaintext highlighter-rouge\">center of region</code></li>\n            <li><em>“Distance upstream of the start site of the regions defined in the region file”</em>: <code class=\"language-plaintext highlighter-rouge\">3000</code></li>\n            <li><em>“Distance downstream of the end site of the given regions”</em>: <code class=\"language-plaintext highlighter-rouge\">3000</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_plot_heatmap/deeptools_plot_heatmap/3.5.1.0.1\" title=\"plotHeatmap tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>plotHeatmap</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 3.5.1.0.1)</span> with the following parameters\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Matrix file from the computeMatrix tool”</em>: <code class=\"language-plaintext highlighter-rouge\">Matrix</code> (output of <strong>computeMatrix</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Show advanced options”</em>: <code class=\"language-plaintext highlighter-rouge\">yes</code>\n          <ul>\n            <li><em>“Reference point label”</em>: select the right label</li>\n            <li><em>“Did you compute the matrix with more than one groups of regions?”</em>: <code class=\"language-plaintext highlighter-rouge\">No, I used only one group</code>\n              <ul>\n                <li><em>“Clustering algorithm”</em>: <code class=\"language-plaintext highlighter-rouge\">Kmeans clustering</code></li>\n                <li><em>“Number of clusters to compute”</em>: <code class=\"language-plaintext highlighter-rouge\">2</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<p>It should generate an heatmap similar to:</p>\n\n<figure id=\"figure-16\" style=\"max-width: 90%;\"><img src=\"../../images/formation_of_super-structures_on_xi/peak_heatmap_1.png\" alt=\"Output of plotHeatmap for 2 samples. \" width=\"849\" height=\"1500\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/formation_of_super-structures_on_xi/peak_heatmap_1.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 16</strong>:</span> Scores around the peaks for wt_H3K4me3_rep1 and wt_input_rep1</figcaption></figure>\n\n<p>When we look at this graph, it seems that less but larger peaks are found for <code class=\"language-plaintext highlighter-rouge\">H3K4me3_rep1</code> and that only few peaks are shared.</p>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>How many peaks have been found for <code class=\"language-plaintext highlighter-rouge\">CTCF_rep1</code> and for <code class=\"language-plaintext highlighter-rouge\">H3K4me3_rep1</code>?</li>\n    <li>What are the mean width of the peaks for <code class=\"language-plaintext highlighter-rouge\">CTCF_rep1</code> and for <code class=\"language-plaintext highlighter-rouge\">H3K4me3_rep1</code>?</li>\n    <li>How many peaks are specific to <code class=\"language-plaintext highlighter-rouge\">CTCF_rep1</code> or <code class=\"language-plaintext highlighter-rouge\">H3K4me3_rep1</code>?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n    <ol>\n      <li>656 peaks for <code class=\"language-plaintext highlighter-rouge\">H3K4me3_rep1</code> and 2,688 for <code class=\"language-plaintext highlighter-rouge\">CTCF_rep1</code> (number of lines in the <strong>MACS2 callpeak</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> BED file)</li>\n      <li>1630.77 bp for <code class=\"language-plaintext highlighter-rouge\">H3K4me3_rep1</code> and 404.55 for <code class=\"language-plaintext highlighter-rouge\">CTCF_rep1</code> (<strong>Compute</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with <code class=\"language-plaintext highlighter-rouge\">c3-c2</code> and then <strong>Datamash</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with <code class=\"language-plaintext highlighter-rouge\">Mean</code> on <code class=\"language-plaintext highlighter-rouge\">Column:11</code>)</li>\n      <li>443 peaks (over 656) are specific to <code class=\"language-plaintext highlighter-rouge\">H3K4me3_rep1</code> and 2,464 (over 2,688) to <code class=\"language-plaintext highlighter-rouge\">CTCF_rep1</code> (<strong>Intersect intervals</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>). Around 220 peaks are then overlapping.</li>\n    </ol>\n  </blockquote>\n</blockquote>\n\n<p>So far, we have only analyzed 2 samples, but we can do the same for all the 6 samples:</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>(Optional) Plot the heatmap for all the samples</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_bam_compare/deeptools_bam_compare/3.5.1.0.0\" title=\"bamCompare tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>bamCompare</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 3.5.1.0.0)</span> for each combination input - ChIP data:\n      <ol>\n        <li><code class=\"language-plaintext highlighter-rouge\">wt_CTCF_rep1</code> - <code class=\"language-plaintext highlighter-rouge\">wt_input_rep1</code> (already done)</li>\n        <li><code class=\"language-plaintext highlighter-rouge\">wt_H3K4me3_rep1</code> - <code class=\"language-plaintext highlighter-rouge\">wt_input_rep1</code> (already done)</li>\n        <li><code class=\"language-plaintext highlighter-rouge\">wt_H3K27me3_rep1</code> - <code class=\"language-plaintext highlighter-rouge\">wt_input_rep1</code></li>\n        <li><code class=\"language-plaintext highlighter-rouge\">wt_CTCF_rep2</code> - <code class=\"language-plaintext highlighter-rouge\">wt_input_rep2</code></li>\n        <li><code class=\"language-plaintext highlighter-rouge\">wt_H3K4me3_rep2</code> - <code class=\"language-plaintext highlighter-rouge\">wt_input_rep2</code></li>\n        <li><code class=\"language-plaintext highlighter-rouge\">wt_H3K27me3_rep2</code> - <code class=\"language-plaintext highlighter-rouge\">wt_input_rep2</code></li>\n      </ol>\n    </li>\n    <li>Rename the outputs of <strong>bamCompare</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the name of the ChIP data</li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/macs2/macs2_callpeak/2.2.7.1+galaxy0\" title=\"MACS2 callpeak tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>MACS2 callpeak</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.2.7.1+galaxy0)</span> for each combination input - ChIP data</li>\n    <li><span class=\"tool\" data-tool=\"cat1\" title=\"Concatenate datasets tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Concatenate datasets</strong></span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Concatenate Dataset”</em>: one output of <strong>MACS2 callpeak</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n        <li>Click on <em>“Insert Dataset”</em>:\n          <ul>\n            <li>In <em>“Select”</em>: one other output of <strong>MACS2 callpeak</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n          </ul>\n        </li>\n        <li>Redo for the 6 outputs of <strong>MACS2 callpeak</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_sortbed/2.30.0+galaxy2\" title=\"bedtools SortBED tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>bedtools SortBED</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.30.0+galaxy2)</span> with the following parameters\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Sort the following bed,bedgraph,gff,vcf file”</em>: output of <strong>Concatenate</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_mergebed/2.30.0\" title=\"bedtools MergeBED tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>bedtools MergeBED</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.30.0)</span> with the following parameters\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Sort the following bed,bedgraph,gff,vcf file”</em>: output of <strong>SortBED</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_compute_matrix/deeptools_compute_matrix/3.5.1.0.0\" title=\"computeMatrix tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>computeMatrix</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 3.5.1.0.0)</span> with the same parameters but:\n      <ul>\n        <li><em>“Select regions”</em>:\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Regions to plot”</em>: output of <strong>MergeBED</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n          </ul>\n        </li>\n        <li><em>“Sample order matters”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code>\n          <ul>\n            <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“Score file”</em>: the 6 <code class=\"language-plaintext highlighter-rouge\">bigwig</code> files generated by <strong>bamCompare</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> and renamed</li>\n          </ul>\n        </li>\n        <li><em>“computeMatrix has two main output options”</em>: <code class=\"language-plaintext highlighter-rouge\">reference-point</code>\n          <ul>\n            <li><em>“The reference point for the plotting”</em>: <code class=\"language-plaintext highlighter-rouge\">center of region</code></li>\n            <li><em>“Distance upstream of the start site of the regions defined in the region file”</em>: <code class=\"language-plaintext highlighter-rouge\">3000</code></li>\n            <li><em>“Distance downstream of the end site of the given regions”</em>: <code class=\"language-plaintext highlighter-rouge\">3000</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_plot_heatmap/deeptools_plot_heatmap/3.5.1.0.1\" title=\"plotHeatmap tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>plotHeatmap</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 3.5.1.0.1)</span> with the following parameters\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Matrix file from the computeMatrix tool”</em>: <code class=\"language-plaintext highlighter-rouge\">Matrix</code> (output of <strong>computeMatrix</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Show advanced options”</em>: <code class=\"language-plaintext highlighter-rouge\">yes</code>\n          <ul>\n            <li><em>“Reference point label”</em>: select the right label</li>\n            <li><em>“Did you compute the matrix with more than one groups of regions?”</em>: <code class=\"language-plaintext highlighter-rouge\">No, I used only one group</code>\n              <ul>\n                <li><em>“Clustering algorithm”</em>: <code class=\"language-plaintext highlighter-rouge\">Kmeans clustering</code></li>\n                <li><em>“Number of clusters to compute”</em>: <code class=\"language-plaintext highlighter-rouge\">6</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>How many peaks are found for the different samples?</li>\n    <li>\n      <p>How are the peaks?</p>\n\n      <figure id=\"figure-17\" style=\"max-width: 90%;\"><img src=\"../../images/formation_of_super-structures_on_xi/peak_heatmap_all.png\" alt=\"Output of plotHeatmap for all samples. \" width=\"1500\" height=\"995\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/formation_of_super-structures_on_xi/peak_heatmap_all.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 17</strong>:</span> Scores around the peaks for all samples</figcaption></figure>\n    </li>\n    <li>\n      <p>How could be interpreted the peaks and read coverage in the <code class=\"language-plaintext highlighter-rouge\">chrX:151,385,260-152,426,526</code> region?</p>\n\n      <figure id=\"figure-18\" style=\"max-width: 90%;\"><img src=\"../../images/formation_of_super-structures_on_xi/rep1_igv.png\" alt=\"Coverage and peaks for the replicate 1. \" width=\"1270\" height=\"445\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/formation_of_super-structures_on_xi/rep1_igv.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 18</strong>:</span> Coverage and peaks for the replicate 1</figcaption></figure>\n    </li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n    <ol>\n      <li>\n        <p>Found peaks (number of lines in <strong>MACS2 callpeak</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> outputs):</p>\n\n        <table>\n          <thead>\n            <tr>\n              <th>Target</th>\n              <th>Rep 1</th>\n              <th>Rep 2</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr>\n              <td>CTCF</td>\n              <td>2,672</td>\n              <td>2,061</td>\n            </tr>\n            <tr>\n              <td>H3K4me3</td>\n              <td>657</td>\n              <td>718</td>\n            </tr>\n            <tr>\n              <td>H3K27me3</td>\n              <td>220</td>\n              <td>73</td>\n            </tr>\n          </tbody>\n        </table>\n\n        <p>The tendencies are similar for both replicates: more peaks for CTCF, less for H3K4me3 and only few for H3K27me3.</p>\n      </li>\n      <li>As observed with the 2 samples, the peaks for H3K4me3 are wider than for CTCF. We also observe that the peaks found with one replicate are found with the other replicate.</li>\n      <li>\n        <p>The H3K4me3 sample has clear and large regions in which the read coverage are enriched. H3K4me3 is one of the least abundant histone modifications. It is highly enriched at active promoters near transcription start sites (TSS) and positively correlated with transcription.</p>\n\n        <p>For H3K27me3, the coverage is more homogeneous. A gene is a broad domain of H3K27me3 enrichment across its body of genes corresponds to a gene with a transcription inhibited by H3K27me3. We can also identified some “bivalent” genes: gene with a peak around the TSS for H3K27me3(e.g. region_208 for gene Gpr173) but also H3K4me3. We also observe some H3K27me3-depleted regions sharply demarcated, with boundaries coinciding with gene borders (e.g. Kdm5c). This is a chromatin signature reminiscent of genes that escape XCI.</p>\n\n        <p>To reproduce, run <strong>bamCoverage</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>, <strong>IGV</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> and <strong>MACS2 callpeak</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> outputs.</p>\n      </li>\n    </ol>\n  </blockquote>\n</blockquote>\n\n<h1 id=\"conclusion\">Conclusion</h1>\n\n<p>Along this tutorial, we learn how to extract peaks and coverage information from raw data of ChIP experiments:</p>\n\n<figure id=\"figure-19\" style=\"max-width: 90%;\"><img src=\"../../images/formation_of_super-structures_on_xi/tutorial-scheme.png\" alt=\"Workflow to extract peaks and coverage information from raw data of ChIP experiments. \" width=\"2672\" height=\"2917\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/formation_of_super-structures_on_xi/tutorial-scheme.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 19</strong>:</span> Workflow to extract peaks and coverage information from raw data of ChIP experiments</figcaption></figure>\n\n<p>This information can be then related to the biology to answer the original question. We tried then to relate the observed differences of peak and read coverage between H3K27me3 and H3K4me3 to the known biology. We could go even further in the analysis to reproduce the results of the original paper (e.g. by looking at the bivalent genes, identifying the differences between Xa and Xi).</p>\n"],"ref_slides":["## ChIP-seq\n\n- **Ch**romatin **I**mmuno**P**recipitation combined with **seq**uencing\n- Identifying the location of proteins binding sites\n    - Transcription Factors\n    - Histone modifications\n- 2 Types of sequenced data\n    - ChIP data\n    - Input data\n\n.image-75[![A complicated figure showing a set of nucleosomes at the top with the following regions appearing to be exposed to sequencing: enhancer, promoter, gene, and tss regions. several charts appear below, chromatin accessibility showing broad peaks around the enhancer, promoter, and gene. the transcription factor chart shows peaks around enhancer and promoter. A line labelled TFBS shows sequences in repressive state (the nucleosome regions), enhancer, and promoter. The PollI track shows peaks below promoter and gene. Then several organisms labelled things like H3K4me1, H3K36me3 show various peaks along the regions of repressive state, enhancer, promoter, transcribed state (the gene) and poised state (the transcription start site.).](../../images/formation_of_super-structures_on_xi/chipseq.png)]\n\n---\n\n## Generating ChIP-seq data\n\n![A diagram illustrating the principles of Chromatin Immunoprecipitation Sequencing (ChIP-sequencing), where the location of binding by a specific protein to DNA is investigated. DNA from the nucleus is taken, and cross-linked to protein DNA. This is then sheared by sonication, and the cells are lysed. Bead-attached antibodies are added to immunoprecipitate the target protein. A large red callout says input data is NOT going through the Immunoprecipitation step. The resulting beads with bound protein are sequenced and mapped to the genome. Another bred text says millions of reads to map.](../../images/formation_of_super-structures_on_xi/chipseq_generation.png)\n\n<small>\nSource: [Wikipedia](https://en.wikipedia.org/wiki/ChIP-sequencing\n)\n</small>\n\n---\n\n## ChIP vs Input\n\n![A cartoon of sequencing shows a line labelled genome. Input reads shown below map along the entire genome. ChIP reads map in broad peaks, along only specific regions.](../../images/formation_of_super-structures_on_xi/chip_vs_input.png)\n\n---\n\n![Graphic labelled Pipeline overview. Reads go through QC, mapping to a reference, ChIP QC, Visualisation, and Peak Calling.](../../images/formation_of_super-structures_on_xi/chipseq_pipeline.png)\n\n---\n\n## Studying the effect of SCHMD1 protein in chromosome X\n\nSCHMD1 in known to have an effect on gene expression in X chromosome\n\n![12 different sets of line graphs are shown showing various peaks along the genome. Genes are shown below the genome, some, but not all, lining up with the peaks. Below is a graphic of two line charts comparing two genomes. One has a region with no reads mapping which is circled.](../../images/formation_of_super-structures_on_xi/SCHMD1.png)\n\nChen-Yu Wang et al. 2018; Vivek Bhardwaj, Steffen Heyne et al. 2018\n\n???\nWe probe a potential architectural role for SMCHD1 and investigate the mechanism by which it shapes the Xi and represses gene expression\n\n"],"hands_on":true,"slides":true,"mod_date":"2023-11-03 14:30:27 +0000","pub_date":"2018-09-17 07:13:05 +0000","version":16,"workflows":[{"workflow":"formation_of_super_structures_on_xi.ga","tests":true,"url":"https://training.galaxyproject.org/training-material/topics/epigenetics/tutorials/formation_of_super-structures_on_xi/workflows/formation_of_super_structures_on_xi.ga","path":"topics/epigenetics/tutorials/formation_of_super-structures_on_xi/workflows/formation_of_super_structures_on_xi.ga","wfid":"epigenetics-formation_of_super-structures_on_xi","wfname":"formation_of_super_structures_on_xi","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/epigenetics-formation_of_super-structures_on_xi/versions/formation_of_super_structures_on_xi","license":"CC-BY-4.0","creators":[{"class":"Person","identifier":"0000-0002-2301-112X","name":"Friederike Dündar"},{"class":"Person","identifier":"0000-0002-7427-6478","name":"Anika Erxleben"},{"class":"Person","identifier":"0000-0001-9852-1987","name":"Bérénice Batut"},{"class":"Person","identifier":"0000-0002-5570-9338","name":"Vivek Bhardwaj"},{"class":"Person","identifier":"0000-0002-9142-417X","name":"Fidel Ramirez"},{"class":"Person","identifier":"0009-0007-0755-3643","name":"Leily Rabbani"},{"class":"Person","identifier":"0000-0002-5192-126X","name":"Pavankumar Videm"}],"name":"GTN - ChIP Seq - Formation Of Super Structures On Xi","title":"GTN - ChIP Seq - Formation Of Super Structures On Xi","test_results":null,"modified":"2024-06-14 10:06:48 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\nwt_H3K4me3_read2.fastq.gz\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"ℹ️ Input Dataset\\nwt_H3K4me3_read1.fastq.gz\"];\n  style 1 stroke:#2c3143,stroke-width:4px;\n  2[\"ℹ️ Input Dataset\\nwt_input_rep1.bam\"];\n  style 2 stroke:#2c3143,stroke-width:4px;\n  3[\"ℹ️ Input Dataset\\nwt_H3K4me3_rep1.bam\"];\n  style 3 stroke:#2c3143,stroke-width:4px;\n  4[\"ℹ️ Input Dataset\\nwt_CTCF_rep1.bam\"];\n  style 4 stroke:#2c3143,stroke-width:4px;\n  5[\"ℹ️ Input Dataset\\nwt_H3K27me3_rep1.bam\"];\n  style 5 stroke:#2c3143,stroke-width:4px;\n  6[\"ℹ️ Input Dataset\\nwt_input_rep2.bam\"];\n  style 6 stroke:#2c3143,stroke-width:4px;\n  7[\"ℹ️ Input Dataset\\nwt_H3K4me3_rep2.bam\"];\n  style 7 stroke:#2c3143,stroke-width:4px;\n  8[\"ℹ️ Input Dataset\\nwt_CTCF_rep2.bam\"];\n  style 8 stroke:#2c3143,stroke-width:4px;\n  9[\"ℹ️ Input Dataset\\nwt_H3K27me3_rep2.bam\"];\n  style 9 stroke:#2c3143,stroke-width:4px;\n  10[\"FastQC\"];\n  0 -->|output| 10;\n  892e22b2-3194-4076-af80-357530c17186[\"Output\\nwt_H3K4me3_rep1_read2_fastqc\"];\n  10 --> 892e22b2-3194-4076-af80-357530c17186;\n  style 892e22b2-3194-4076-af80-357530c17186 stroke:#2c3143,stroke-width:4px;\n  11[\"Trim Galore!\"];\n  1 -->|output| 11;\n  0 -->|output| 11;\n  a66a6432-690f-4e66-88c0-7eba0a014677[\"Output\\nwt_H3K4me3_rep1_trim_galore\"];\n  11 --> a66a6432-690f-4e66-88c0-7eba0a014677;\n  style a66a6432-690f-4e66-88c0-7eba0a014677 stroke:#2c3143,stroke-width:4px;\n  12[\"FastQC\"];\n  1 -->|output| 12;\n  da453096-fdd9-44ee-b83b-e4eca5c800f9[\"Output\\nwt_H3K4me3_rep1_read1_fastqc\"];\n  12 --> da453096-fdd9-44ee-b83b-e4eca5c800f9;\n  style da453096-fdd9-44ee-b83b-e4eca5c800f9 stroke:#2c3143,stroke-width:4px;\n  13[\"Samtools idxstats\"];\n  2 -->|output| 13;\n  14[\"bamCoverage\"];\n  2 -->|output| 14;\n  15[\"bamCoverage\"];\n  3 -->|output| 15;\n  16[\"bamCoverage\"];\n  3 -->|output| 16;\n  73e2f018-d9e4-4f74-8110-598b9b43a940[\"Output\\nwt_H3K4me3_rep1_bamcoverage\"];\n  16 --> 73e2f018-d9e4-4f74-8110-598b9b43a940;\n  style 73e2f018-d9e4-4f74-8110-598b9b43a940 stroke:#2c3143,stroke-width:4px;\n  17[\"Samtools idxstats\"];\n  3 -->|output| 17;\n  09449d6f-ce88-4448-9928-064c729c32d1[\"Output\\nwt_H3K4me3_rep1_idxstats\"];\n  17 --> 09449d6f-ce88-4448-9928-064c729c32d1;\n  style 09449d6f-ce88-4448-9928-064c729c32d1 stroke:#2c3143,stroke-width:4px;\n  18[\"plotFingerprint\"];\n  3 -->|output| 18;\n  2 -->|output| 18;\n  19[\"bamCompare\"];\n  3 -->|output| 19;\n  2 -->|output| 19;\n  20[\"MACS2 callpeak\"];\n  2 -->|output| 20;\n  3 -->|output| 20;\n  a36b5a6c-d992-4a2d-8fd8-95e8eac74cbd[\"Output\\nwt_H3K4me3_input_rep1_macs2\"];\n  20 --> a36b5a6c-d992-4a2d-8fd8-95e8eac74cbd;\n  style a36b5a6c-d992-4a2d-8fd8-95e8eac74cbd stroke:#2c3143,stroke-width:4px;\n  21[\"bamCompare\"];\n  3 -->|output| 21;\n  2 -->|output| 21;\n  5174d1aa-21f6-4187-8935-70ba8bd0f6e0[\"Output\\nwt_H3K4me3_input_rep1_bamcompare\"];\n  21 --> 5174d1aa-21f6-4187-8935-70ba8bd0f6e0;\n  style 5174d1aa-21f6-4187-8935-70ba8bd0f6e0 stroke:#2c3143,stroke-width:4px;\n  22[\"bamCompare\"];\n  4 -->|output| 22;\n  2 -->|output| 22;\n  23[\"MACS2 callpeak\"];\n  2 -->|output| 23;\n  4 -->|output| 23;\n  24[\"bamCompare\"];\n  4 -->|output| 24;\n  2 -->|output| 24;\n  25[\"bamCompare\"];\n  5 -->|output| 25;\n  2 -->|output| 25;\n  26[\"MACS2 callpeak\"];\n  2 -->|output| 26;\n  5 -->|output| 26;\n  27[\"bamCompare\"];\n  7 -->|output| 27;\n  6 -->|output| 27;\n  28[\"MACS2 callpeak\"];\n  6 -->|output| 28;\n  7 -->|output| 28;\n  29[\"bamCompare\"];\n  8 -->|output| 29;\n  6 -->|output| 29;\n  30[\"MACS2 callpeak\"];\n  6 -->|output| 30;\n  8 -->|output| 30;\n  31[\"multiBamSummary\"];\n  2 -->|output| 31;\n  3 -->|output| 31;\n  4 -->|output| 31;\n  5 -->|output| 31;\n  6 -->|output| 31;\n  7 -->|output| 31;\n  8 -->|output| 31;\n  9 -->|output| 31;\n  32[\"bamCompare\"];\n  9 -->|output| 32;\n  6 -->|output| 32;\n  33[\"MACS2 callpeak\"];\n  6 -->|output| 33;\n  9 -->|output| 33;\n  34[\"Bowtie2\"];\n  11 -->|trimmed_reads_pair1| 34;\n  11 -->|trimmed_reads_pair2| 34;\n  4c3ca5b1-2298-4bb4-8d2f-f62619f35158[\"Output\\nwt_H3K4me3_rep1_bowtie2\"];\n  34 --> 4c3ca5b1-2298-4bb4-8d2f-f62619f35158;\n  style 4c3ca5b1-2298-4bb4-8d2f-f62619f35158 stroke:#2c3143,stroke-width:4px;\n  35[\"Concatenate datasets\"];\n  20 -->|output_narrowpeaks| 35;\n  23 -->|output_narrowpeaks| 35;\n  36[\"plotCorrelation\"];\n  31 -->|outFile| 36;\n  37[\"Concatenate datasets\"];\n  20 -->|output_narrowpeaks| 37;\n  23 -->|output_narrowpeaks| 37;\n  26 -->|output_narrowpeaks| 37;\n  28 -->|output_narrowpeaks| 37;\n  30 -->|output_narrowpeaks| 37;\n  33 -->|output_narrowpeaks| 37;\n  38[\"bedtools SortBED\"];\n  35 -->|out_file1| 38;\n  39[\"bedtools SortBED\"];\n  37 -->|out_file1| 39;\n  40[\"bedtools MergeBED\"];\n  38 -->|output| 40;\n  931eb26a-0e5d-4556-b67f-1c37372aaf28[\"Output\\nwt_H3K4me3_CTCF_rep1_mergebed\"];\n  40 --> 931eb26a-0e5d-4556-b67f-1c37372aaf28;\n  style 931eb26a-0e5d-4556-b67f-1c37372aaf28 stroke:#2c3143,stroke-width:4px;\n  41[\"bedtools MergeBED\"];\n  39 -->|output| 41;\n  9c4c5a1f-f2c1-4e83-b1f9-ff32ee48baeb[\"Output\\nwt_all_mergebed\"];\n  41 --> 9c4c5a1f-f2c1-4e83-b1f9-ff32ee48baeb;\n  style 9c4c5a1f-f2c1-4e83-b1f9-ff32ee48baeb stroke:#2c3143,stroke-width:4px;\n  42[\"computeMatrix\"];\n  19 -->|outFileName| 42;\n  22 -->|outFileName| 42;\n  40 -->|output| 42;\n  43[\"computeMatrix\"];\n  19 -->|outFileName| 43;\n  22 -->|outFileName| 43;\n  25 -->|outFileName| 43;\n  27 -->|outFileName| 43;\n  29 -->|outFileName| 43;\n  32 -->|outFileName| 43;\n  41 -->|output| 43;\n  44[\"plotHeatmap\"];\n  42 -->|outFileName| 44;\n  45[\"plotHeatmap\"];\n  43 -->|outFileName| 45;"}],"api":"https://training.galaxyproject.org/training-material/api/topics/epigenetics/tutorials/formation_of_super-structures_on_xi/tutorial.json","tools":["Filter1","cat1","toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_bam_compare/deeptools_bam_compare/3.5.1.0.0","toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_bam_coverage/deeptools_bam_coverage/3.5.1.0.0","toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_compute_matrix/deeptools_compute_matrix/3.5.1.0.0","toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_multi_bam_summary/deeptools_multi_bam_summary/3.5.1.0.0","toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_plot_correlation/deeptools_plot_correlation/3.5.1.0.0","toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_plot_fingerprint/deeptools_plot_fingerprint/3.5.1.0.0","toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_plot_heatmap/deeptools_plot_heatmap/3.5.1.0.1","toolshed.g2.bx.psu.edu/repos/bgruening/trim_galore/trim_galore/0.6.7+galaxy0","toolshed.g2.bx.psu.edu/repos/devteam/bowtie2/bowtie2/2.5.0+galaxy0","toolshed.g2.bx.psu.edu/repos/devteam/fastqc/fastqc/0.73+galaxy0","toolshed.g2.bx.psu.edu/repos/devteam/samtools_idxstats/samtools_idxstats/2.0.4","toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_mergebed/2.30.0","toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_sortbed/2.30.0+galaxy2","toolshed.g2.bx.psu.edu/repos/iuc/macs2/macs2_callpeak/2.2.7.1+galaxy0"],"supported_servers":{"exact":[{"url":"https://usegalaxy.eu","name":"UseGalaxy.eu","usegalaxy":true},{"url":"https://usegalaxy.fr/","name":"UseGalaxy.fr","usegalaxy":false},{"url":"https://usegalaxy.org","name":"UseGalaxy.org (Main)","usegalaxy":true},{"url":"https://usegalaxy.org.au","name":"UseGalaxy.org.au","usegalaxy":true}],"inexact":[{"url":"https://galaxy.mesocentre.uca.fr","name":"Galaxy@AuBi","usegalaxy":false},{"url":"https://usegalaxy.be/","name":"UseGalaxy.be","usegalaxy":false},{"url":"https://usegalaxy.cz/","name":"UseGalaxy.cz","usegalaxy":false},{"url":"https://usegalaxy.no/","name":"UseGalaxy.no","usegalaxy":false}]},"topic_name_human":"Epigenetics","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"deeptools_bam_compare","owner":"bgruening","revisions":"de72ba3ed6f2","tool_panel_section_label":"deepTools","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"deeptools_bam_coverage","owner":"bgruening","revisions":"12af64f93288","tool_panel_section_label":"deepTools","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"deeptools_compute_matrix","owner":"bgruening","revisions":"9470f29702f8","tool_panel_section_label":"deepTools","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"deeptools_multi_bam_summary","owner":"bgruening","revisions":"004aea905d4d","tool_panel_section_label":"deepTools","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"deeptools_plot_correlation","owner":"bgruening","revisions":"fd408d755394","tool_panel_section_label":"deepTools","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"deeptools_plot_fingerprint","owner":"bgruening","revisions":"793665fff0f8","tool_panel_section_label":"deepTools","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"deeptools_plot_heatmap","owner":"bgruening","revisions":"ba6efa77fb79","tool_panel_section_label":"deepTools","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"trim_galore","owner":"bgruening","revisions":"cd7e644cae1d","tool_panel_section_label":"FASTA/FASTQ","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"bowtie2","owner":"devteam","revisions":"03e9b2fbc005","tool_panel_section_label":"Mapping","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"fastqc","owner":"devteam","revisions":"3d0c7bdf12f5","tool_panel_section_label":"FASTA/FASTQ","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"samtools_idxstats","owner":"devteam","revisions":"7def34e6cf4d","tool_panel_section_label":"SAM/BAM","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"bedtools","owner":"iuc","revisions":"a1a923cd89e8","tool_panel_section_label":"BED","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"bedtools","owner":"iuc","revisions":"a1a923cd89e8","tool_panel_section_label":"BED","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"macs2","owner":"iuc","revisions":"640d3af5d833","tool_panel_section_label":"Peak Calling","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: deeptools_bam_compare\n  owner: bgruening\n  revisions: de72ba3ed6f2\n  tool_panel_section_label: deepTools\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: deeptools_bam_coverage\n  owner: bgruening\n  revisions: 12af64f93288\n  tool_panel_section_label: deepTools\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: deeptools_compute_matrix\n  owner: bgruening\n  revisions: 9470f29702f8\n  tool_panel_section_label: deepTools\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: deeptools_multi_bam_summary\n  owner: bgruening\n  revisions: 004aea905d4d\n  tool_panel_section_label: deepTools\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: deeptools_plot_correlation\n  owner: bgruening\n  revisions: fd408d755394\n  tool_panel_section_label: deepTools\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: deeptools_plot_fingerprint\n  owner: bgruening\n  revisions: 793665fff0f8\n  tool_panel_section_label: deepTools\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: deeptools_plot_heatmap\n  owner: bgruening\n  revisions: ba6efa77fb79\n  tool_panel_section_label: deepTools\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: trim_galore\n  owner: bgruening\n  revisions: cd7e644cae1d\n  tool_panel_section_label: FASTA/FASTQ\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bowtie2\n  owner: devteam\n  revisions: 03e9b2fbc005\n  tool_panel_section_label: Mapping\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: fastqc\n  owner: devteam\n  revisions: 3d0c7bdf12f5\n  tool_panel_section_label: FASTA/FASTQ\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: samtools_idxstats\n  owner: devteam\n  revisions: 7def34e6cf4d\n  tool_panel_section_label: SAM/BAM\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bedtools\n  owner: iuc\n  revisions: a1a923cd89e8\n  tool_panel_section_label: BED\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bedtools\n  owner: iuc\n  revisions: a1a923cd89e8\n  tool_panel_section_label: BED\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: macs2\n  owner: iuc\n  revisions: 640d3af5d833\n  tool_panel_section_label: Peak Calling\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":false,"slides_recordings":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial","logo":"GTN","class":"enlarge120"}