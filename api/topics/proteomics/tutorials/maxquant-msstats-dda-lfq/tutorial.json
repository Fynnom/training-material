{"layout":"tutorial_hands_on","title":"MaxQuant and MSstats for the analysis of label-free data","zenodo_link":"","level":"Intermediate","questions":["How to perform label-free shotgun (DDA) data analysis in MaxQuant and MSstats?","Which proteins are differentially abundant in the two types of cutaneous squamous cell carcinomas?"],"objectives":["Learn how to use MaxQuant and MSstats for the analysis of label-free shotgun (DDA) data"],"time_estimation":"2H","key_points":["MaxQuant offers a single tool solution for protein identification and quantification.","Label-free quantitation reveals the most abundant proteins in serum samples."],"contributors":[{"name":"Melanie Föll","email":"melanie.foell@mol-med.uni-freiburg.de","twitter":"MCFoell","matrix":"foellmelanie:matrix.org","orcid":"0000-0002-1887-7543","joined":"2018-10","affiliations":["uni-freiburg"],"id":"foellmelanie","url":"https://training.galaxyproject.org/training-material/api/contributors/foellmelanie.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/foellmelanie/"},{"name":"Matthias Fahrner","email":"matthias.fahrner@uniklinik-freiburg.de","twitter":"mfahrner313","orcid":"0000-0001-7955-2518","joined":"2019-03","affiliations":["uni-freiburg"],"id":"matthias313","url":"https://training.galaxyproject.org/training-material/api/contributors/matthias313.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/matthias313/"}],"requirements":[{"type":"internal","topic_name":"proteomics","tutorials":["maxquant-label-free"]}],"subtopic":"id-quant","tags":["label-free"],"recordings":[{"captioners":["foellmelanie"],"date":"2021-02-15","galaxy_version":"21.01","length":"1H","youtube_id":"IXdLAt2PAT4","speakers":["foellmelanie"]}],"js_requirements":{"mathjax":null,"mermaid":false},"short_id":"T00219","url":"/topics/proteomics/tutorials/maxquant-msstats-dda-lfq/tutorial.html","topic_name":"proteomics","tutorial_name":"maxquant-msstats-dda-lfq","dir":"topics/proteomics/tutorials/maxquant-msstats-dda-lfq","symlink":null,"id":"proteomics/maxquant-msstats-dda-lfq","ref_tutorials":["<p>Modern mass spectrometry-based proteomics enables the identification and quantification of thousands of proteins. Therefore, quantitative mass spectrometry represents an indispensable technology for biological and clinical research. Statistical analyses are required for the unbiased answering of scientific questions and to uncover all important information in the proteomic data. Classical statistical approaches and methods from other omics technologies are not ideal because they do not take into account the speciality of mass spectrometry data that include several thousands of proteins but often only a few dozens of samples (referred to as ‘curse of dimensionality’) and stochastic data properties that reflect sample preparation and spectral acquisition (Choi 2014).</p>\n\n<p>In this training we will cover the full analysis workflow from label-free, data dependent acquisition (DDA) raw data to statistical results. We’ll use two popular quantitative proteomics software: MaxQuant and MSstats. MaxQuant allows protein identification and quantification for many different kinds of proteomics data (Cox and Mann 2008).  In case you have no previous experience with MaxQuant, we recommend to go through the <a href=\"/training-material/topics/proteomics/tutorials/maxquant-label-free/tutorial.html\">MaxQuant beginners tutorial</a> before. MSstats provides statistical functionalities to find differentially abundant peptides or proteins from data dependent acquisition (DDA), data independent acquisition (DIA) or single reaction monitoring (SRM) proteomic experiments.\nThe training dataset consists of a skin cancer cohort of 19 patients, which is a subset of a <a href=\"https://doi.org/10.1016/j.matbio.2017.11.004\">published study</a>. One fifth of all non melanoma skin cancers are cutaneous squamous cell carcinomas (cSCC) that mainly derive from exposure to ultraviolet light. Most cSCC have a good prognosis but the few metastasizing cSCC have dramatically increased mortality. Here, we compare these metastasizing cSCC to cSCC in patients with the genetic disease recessive dystrophic epidermolysis bullosa (RDEB). RDEB is a genetic skin blistering and extracellular matrix disease caused by collagen VII deficiency. To investigate molecular differences between these two aggressive cSCCs with different origin, we used global proteomic analysis of formalin-fixed paraffin-embedded human cSCC tissues.</p>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n  <p>In this tutorial, we will cover:</p>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#get-data\" id=\"markdown-toc-get-data\">Get data</a></li>\n  <li><a href=\"#maxquant-analysis\" id=\"markdown-toc-maxquant-analysis\">MaxQuant analysis</a></li>\n  <li><a href=\"#msstats-analysis\" id=\"markdown-toc-msstats-analysis\">MSstats analysis</a>    <ol>\n      <li><a href=\"#more-details-on-msstats\" id=\"markdown-toc-more-details-on-msstats\">More details on MSstats</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#follow-up-on-msstats-results\" id=\"markdown-toc-follow-up-on-msstats-results\">Follow up on MSstats results</a></li>\n  <li><a href=\"#filtering-msstats-results\" id=\"markdown-toc-filtering-msstats-results\">Filtering MSstats results</a></li>\n  <li><a href=\"#finding-differentially-abundant-proteins\" id=\"markdown-toc-finding-differentially-abundant-proteins\">Finding differentially abundant proteins</a></li>\n  <li><a href=\"#follow-up-on-differentially-abundant-proteins\" id=\"markdown-toc-follow-up-on-differentially-abundant-proteins\">Follow up on differentially abundant proteins</a></li>\n</ol>\n\n</blockquote>\n\n<h1 id=\"get-data\">Get data</h1>\n\n<p>The annotation file, group comparison file and FASTA file for this training is deposited at <a href=\"https://zenodo.org/record/4896554\">Zenodo</a>. It is of course possible to use another FASTA file with human proteome sequences, but to ensure that the results are compatible we recommend to use the provided FASTA file. MaxQuant not only adds known contaminants to the FASTA file, but also generates the “decoy” hits for false discovery rate estimation itself, therefore the FASTA file is not allowed to have decoy entries. To learn more about FASTA files, have a look at <a href=\"/training-material/topics/proteomics/tutorials/database-handling/tutorial.html\">Protein FASTA Database Handling tutorial</a>. The raw data is available via the <a href=\"https://www.ebi.ac.uk/pride/archive/projects/PXD006914\">PRIDE repository</a>. As this is a real life study, the raw data sizes are large and computation time in MaxQuant is long. To save time and storage capacity, you can skip downloading the raw data and the MaxQuant run and instead continue with the MaxQuant outputs which we provide later on. In this case skip the data upload steps 5-8 which are only necessary for the MaxQuant run.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Data upload</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Create a new history for this tutorial and give it a meaningful name</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-new-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-new-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a new history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>Click the <i class=\"fas fa-plus\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">new-history</span> icon at the top of the history panel:</p>   <p><img src=\"/training-material/shared/images/history_create_new.svg\" alt=\"UI for creating new history\" /></p>   <!-- the original drawing can be found here https://docs.google.com/drawings/d/1cCBrLAo4kDGic5QyB70rRiWJAKTenTU8STsKDaLcVU8/edit?usp=sharing --> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Import the FASTA database, annotation file and comparison matrix from <a href=\"https://zenodo.org/record/4896554\">Zenodo</a></p>\n\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/4896554/files/input_protein_database.fasta\nhttps://zenodo.org/record/4896554/files/input_annotation_file.tabular\nhttps://zenodo.org/record/4896554/files/input_comparison_matrix.tabular\n</code></pre></div>      </div>\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-via-links\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-via-links\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing via links</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Once the files are green, rename the fasta file into ‘protein database’, the annotation file into ‘annotation file’ and the comparison matrix file into ‘comparison matrix’.</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-renaming-a-dataset\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-renaming-a-dataset\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Renaming a dataset</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, change the <strong>Name</strong> field</li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Steps 4 to 7 can be skipped to save time and storage capacity by not running MaxQuant. To run MaxQuant, import the raw data from <a href=\"https://www.ebi.ac.uk/pride/archive/projects/PXD006914\">PRIDE</a>.</p>\n\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>ftp://ftp.pride.ebi.ac.uk/pride-archive/2017/11/PXD006914/Experiment105_metast_cSCC1.raw\nftp://ftp.pride.ebi.ac.uk/pride-archive/2017/11/PXD006914/Experiment106_metast_cSCC2.raw\nftp://ftp.pride.ebi.ac.uk/pride-archive/2017/11/PXD006914/Experiment107_metast_cSCC3.raw\nftp://ftp.pride.ebi.ac.uk/pride-archive/2017/11/PXD006914/Experiment109_metast_cSCC4.raw\nftp://ftp.pride.ebi.ac.uk/pride-archive/2017/11/PXD006914/Experiment116_metast_cSCC5.raw\nftp://ftp.pride.ebi.ac.uk/pride-archive/2017/11/PXD006914/Experiment117_metast_cSCC6.raw\nftp://ftp.pride.ebi.ac.uk/pride-archive/2017/11/PXD006914/Experiment118_metast_cSCC7.raw\nftp://ftp.pride.ebi.ac.uk/pride-archive/2017/11/PXD006914/Experiment119_metast_cSCC8.raw\nftp://ftp.pride.ebi.ac.uk/pride-archive/2017/11/PXD006914/Experiment120_metast_cSCC9.raw\nftp://ftp.pride.ebi.ac.uk/pride-archive/2017/11/PXD006914/Experiment121_metast_cSCC10.raw\nftp://ftp.pride.ebi.ac.uk/pride-archive/2017/11/PXD006914/Experiment122_metast_cSCC11.raw\nftp://ftp.pride.ebi.ac.uk/pride-archive/2017/11/PXD006914/Experiment123_metast_cSCC12.raw\nftp://ftp.pride.ebi.ac.uk/pride-archive/2017/11/PXD006914/Experiment124_metast_cSCC13.raw\nftp://ftp.pride.ebi.ac.uk/pride-archive/2017/11/PXD006914/Experiment110_RDEB_cSCC1.raw\nftp://ftp.pride.ebi.ac.uk/pride-archive/2017/11/PXD006914/Experiment111_RDEB_cSCC2.raw\nftp://ftp.pride.ebi.ac.uk/pride-archive/2017/11/PXD006914/Experiment112_RDEB_cSCC3.raw\nftp://ftp.pride.ebi.ac.uk/pride-archive/2017/11/PXD006914/Experiment113_RDEB_cSCC4.raw\nftp://ftp.pride.ebi.ac.uk/pride-archive/2017/11/PXD006914/Experiment114_RDEB_cSCC5.raw\nftp://ftp.pride.ebi.ac.uk/pride-archive/2017/11/PXD006914/Experiment115_RDEB_cSCC6.raw\n\n</code></pre></div>      </div>\n    </li>\n    <li>\n      <p>Rename the raw datasets into ‘metast_cSCC1.raw’, ‘metast_cSCC2.raw’, etc.. The naming for the raw files have to be exactly this way to later match the file names provided in the MSstats annotation file.</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-renaming-a-dataset-1\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-renaming-a-dataset-1\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Renaming a dataset</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, change the <strong>Name</strong> field</li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Control that the data type of the raw files is ‘thermo.raw’ otherwise change the datatype into ‘thermo.raw’</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-changing-the-datatype\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-changing-the-datatype\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Changing the datatype</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, click <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Datatypes</strong> tab on the top</li>   <li>In the <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Assign Datatype</strong>, select <code class=\"language-plaintext highlighter-rouge\">thermo.raw</code> from “<em>New type</em>” dropdown     <ul>       <li>Tip: you can start typing the datatype into the field to filter the dropdown menu</li>     </ul>   </li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Generate a collection for all raw files and name it ‘raw_files’, hide the individual raw files</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-dataset-collection\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-dataset-collection\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a dataset collection</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on <i class=\"far fa-check-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-selector</span> <strong>Select Items</strong> at the top of the history panel <img src=\"/training-material/topics/galaxy-interface/images/historyItemControls.png\" alt=\"Select Items button\" /></li>   <li>Check all the datasets in your history you would like to include</li>   <li>     <p>Click <strong>n of N selected</strong> and choose <strong>Build Dataset List</strong></p>     <p><img src=\"/training-material/topics/galaxy-interface/images/buildList.png\" alt=\"build list collection menu item\" width=\"15%\" /></p>   </li>   <li>Enter a name for your collection</li>   <li>Click <strong>Create collection</strong> to build your collection</li>   <li>Click on the checkmark icon at the top of your history again</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h1 id=\"maxquant-analysis\">MaxQuant analysis</h1>\n\n<p>The run time of <strong>MaxQuant</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> depends on the number and size of the input files and on the chosen parameters. The run of the training datasets will take a few hours, but the training can be directly continued with the MaxQuant result files from Zenodo. We start the MaxQuant run with the default parameters, with a few adjustments. Protein level quantification parameters do not really matter here, because MSstats will use feature quantifications and perform protein summarization based on them. A quality control report is generated with the <a href=\"https://pubs.acs.org/doi/10.1021/acs.jproteome.5b00780\">PTXQC functionality</a> that is directly implemented in the MaxQuant Galaxy tool. To continue with statistical analysis in MSstats, the Protein Groups and the Evidence files are needed from MaxQuant.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Optional: MaxQuant analysis</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/galaxyp/maxquant/maxquant/1.6.10.43+galaxy3\" title=\"MaxQuant tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>MaxQuant</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.6.10.43+galaxy3)</span> with the following parameters:\n      <ul>\n        <li>In <em>“Input Options”</em>:\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“FASTA files”</em>: <code class=\"language-plaintext highlighter-rouge\">protein database</code></li>\n          </ul>\n        </li>\n        <li>In <em>“Search Options”</em>:</li>\n        <li><em>“minimum unique peptides”</em>: <code class=\"language-plaintext highlighter-rouge\">1</code></li>\n        <li><em>“Match between runs”</em>: <code class=\"language-plaintext highlighter-rouge\">yes</code></li>\n        <li>In <em>“Parameter Group”</em>:\n          <ul>\n            <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“Infiles”</em>: <code class=\"language-plaintext highlighter-rouge\">raw_files</code></li>\n          </ul>\n        </li>\n        <li><em>“Generate PTXQC (proteomics quality control pipeline) report?”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        <li>In <em>“Output Options”</em>:\n          <ul>\n            <li><em>“Select the desired outputs.”</em>: <code class=\"language-plaintext highlighter-rouge\">Protein Groups</code> <code class=\"language-plaintext highlighter-rouge\">Evidence</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>Because the MaxQuant run takes really long, we recommend to download the MaxQuant results from Zenodo and continue with the tutorial.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Load MaxQuant results from Zenodo</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Import the files from <a href=\"https://zenodo.org/record/4896554\">Zenodo</a></p>\n\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/4896554/files/MaxQuant_Evidence.tabular\nhttps://zenodo.org/record/4896554/files/MaxQuant_proteingroups.tabular\nhttps://zenodo.org/record/4896554/files/PTXQC_report.pdf\n</code></pre></div>      </div>\n    </li>\n  </ol>\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>How many proteins and features were identified in total?</li>\n    <li>In which columns (number) are the potential contaminants in the protein group and evidence file respectively?</li>\n    <li>How large is the proportion of potential contaminants?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>2622 protein groups and ~240000 features were found in total (number of lines of protein group and evidence files)</li>\n      <li>They are in column 118 (protein groups) and 54 (evidence)</li>\n      <li>Up to 60% of the samples intensities derive from potential contaminants (PTXQC plots page 7)</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<h1 id=\"msstats-analysis\">MSstats analysis</h1>\n\n<p>The protein groups and evidence files of MaxQuant can directly be input into MSstats. MSstats automatically removes all proteins that are labelled as contaminants (‘+’ sign in the column ‘potential contaminant’ of both MaxQuant outputs). However, in this skin dataset we expect that the skin proteins are part of the sample and not a contamination. Therefore, we keep all human contaminants by first removing non human proteins (by selecting only lines that contain the word ‘HUMAN’ or a word from the header line) and then for the human potential contaminants remove the ‘+’ (replacing ‘+’ with ‘‘(empty field) in the ‘potential contaminant’ column) to keep them for the analysis.</p>\n\n<p>We use the modified MaxQuant protein groups and evidence files as input in MSstats. In addition, an annotation file that describes the experimental design and a comparison matrix is needed. Please start the MSstats run first and while it is running you can find more details on its parameters below.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>MSstats Analysis</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"Grep1\" title=\"Select tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Select</strong></span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Select lines from”</em>: <code class=\"language-plaintext highlighter-rouge\">Protein Groups</code> (output of <strong>MaxQuant</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“the pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">(HUMAN)|(Majority)</code></li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"Grep1\" title=\"Select tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Select</strong></span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Select lines from”</em>: <code class=\"language-plaintext highlighter-rouge\">Evidence</code> (output of <strong>MaxQuant</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“the pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">(HUMAN)|(Sequence)</code></li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_replace_in_column/1.1.3\" title=\"Replace Text tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Replace Text</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.1.3)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“File to process”</em>: <code class=\"language-plaintext highlighter-rouge\">select protein groups</code> (output of <strong>Select</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li>In <em>“Replacement”</em>:\n      - <em>“in column”</em>: <code class=\"language-plaintext highlighter-rouge\">c118</code>\n      - <em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">+</code></li>\n        <li>Once finished, rename the file into <code class=\"language-plaintext highlighter-rouge\">protein groups input for MSstats</code></li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_replace_in_column/1.1.3\" title=\"Replace Text tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Replace Text</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.1.3)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“File to process”</em>: <code class=\"language-plaintext highlighter-rouge\">select evidence</code> (output of <strong>Select</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li>In <em>“Replacement”</em>:\n      - <em>“in column”</em>: <code class=\"language-plaintext highlighter-rouge\">c54</code>\n      - <em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">+</code></li>\n        <li>Once finished, rename the file into <code class=\"language-plaintext highlighter-rouge\">evidence input for MSstats</code></li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/galaxyp/msstats/msstats/4.0.0.0\" title=\"MSstats tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>MSstats</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 4.0.0.0)</span>  with the following parameters:\n      <ul>\n        <li><em>“input source”</em>: <code class=\"language-plaintext highlighter-rouge\">MaxQuant</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“evidence.txt - feature-level data”</em>: <code class=\"language-plaintext highlighter-rouge\">evidence input for MSstats</code> (output of <strong>Replace</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“proteinGroups.txt - protein-level data”</em>: <code class=\"language-plaintext highlighter-rouge\">protein groups input for MSstats</code> (output of <strong>Replace</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“annotation file”</em>: <code class=\"language-plaintext highlighter-rouge\">annotation file</code></li>\n            <li><em>“Select Protein ID in evidence.txt”</em>: <code class=\"language-plaintext highlighter-rouge\">Leading razor protein column</code></li>\n            <li>In <em>“MaxQtoMSstatsFormat Options”</em>:\n              <ul>\n                <li><em>“Remove the proteins which have only 1 peptide and charge”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n        <li>In <em>“dataProcess Options”</em>:\n          <ul>\n            <li><em>“Select outputs”</em>: <code class=\"language-plaintext highlighter-rouge\">MSstats log</code> <code class=\"language-plaintext highlighter-rouge\">MSstats FeatureLevelData</code> <code class=\"language-plaintext highlighter-rouge\">ProteinLevelData</code> <code class=\"language-plaintext highlighter-rouge\">Group Quantification Matrix Table</code> <code class=\"language-plaintext highlighter-rouge\">Sample Quantification Matrix Table</code></li>\n            <li>In <em>“dataProcess Plot Options”</em>:\n              <ul>\n                <li><em>“Select visualization outputs”</em>: <code class=\"language-plaintext highlighter-rouge\">QCPlot</code></li>\n                <li><em>“Select protein IDs to draw plots”</em>: <code class=\"language-plaintext highlighter-rouge\">Option for QC plot: \"allonly\" will generate one QC plot with all proteins</code></li>\n                <li>In <em>“Advanced visualization parameters”</em>:\n                  <ul>\n                    <li><em>“Angle of labels represented each condition at the top of graph”</em>: <code class=\"language-plaintext highlighter-rouge\">0</code></li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n        <li><em>“Compare Groups”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Comparison Matrix”</em>: <code class=\"language-plaintext highlighter-rouge\">comparison_matrix</code></li>\n            <li><em>“Select outputs”</em>: <code class=\"language-plaintext highlighter-rouge\">MSstats ComparisonResult</code></li>\n            <li>In <em>“Comparison Visualization Options”</em>:\n              <ul>\n                <li><em>“Select visualization outputs”</em>: <code class=\"language-plaintext highlighter-rouge\">MSstats VolcanoPlot</code></li>\n                <li>In <em>“Advanced visualization parameters”</em>:\n                  <ul>\n                    <li><em>“Involve fold change cutoff or not for volcano plot or heatmap”</em>: <code class=\"language-plaintext highlighter-rouge\">1.5</code></li>\n                    <li><em>“Display protein names in Volcano Plot”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>How many proteins were removed as potential non human contaminants?</li>\n    <li>How many proteins were included into the statistical analysis?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>28 (2622 lines in protein group file minus 2594 lines after select)</li>\n      <li>1764 (MSstats log)</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<h2 id=\"more-details-on-msstats\">More details on MSstats</h2>\n\n<p>MSstats  is designed for statistical modelling of mass spectrometry based proteomic data <a href=\"https://doi.org/10.1093/bioinformatics/btu305\">Choi 2014</a>.\nProteomic data analysis requires statistical approaches that reduce bias and inefficiencies and distinguish systematic variation from random artifacts <a href=\"https://doi.org/10.1371/journal.pcbi.1002277\">Käll and Vitek 2011</a>.</p>\n\n<p>MSstats is directly compatible with the output of several quantitative proteomics software. In addition to the results of the proteomics software an annotation file is needed as input. The annotation file describes the experimental design such as the conditions, biological and technical replicates. To be compatible with MaxQuant results, an additional column with the label type is needed, which only contains L (light) in DDA experiments. A wrong setup of the annotation file is the most common source of errors in MSstats, thus we collected more information in the box below to allow you to adjust the annotation file when analyzing your own experiments.</p>\n\n<blockquote class=\"tip\">\n  <tip-title>Generating the MSstats annotation file</tip-title>\n\n  <p>For label-free MaxQuant data, the annotation file should have 5 columns with exactly these headers: Raw.file, Condition, BioReplicate, Run; IsotopeLabelType</p>\n  <ol>\n    <li>Raw.file: The names must match exactly to the file names in the MaxQuant evidence.txt “Raw file” column. (e.g. “file1.raw.thermo”).</li>\n    <li>Condition: The conditions which will be compared in the statistical modelling. They are not allowed to start with a number or contain any special characters except for ‘_’.</li>\n    <li>BioReplicate: This column should contain a unique identifier for each biological replicate in the experiment. For example, in a clinical proteomic investigation this should be a unique patient id. If technical replicates are present, all samples from the same biological replicate should have the same id but different run ids. MSstats automatically detects the presence of technical replicates and accounts for them in the model-based analysis.</li>\n    <li>Run: This column contains the identifier of a mass spectrometry run. Each mass spectrometry run should have a unique identifier (number or name), regardless of the origin of the biological sample.</li>\n    <li>IsotopeLabelType: This is L (light) for all MaxQuant DDA experiments.</li>\n  </ol>\n\n</blockquote>\n\n<p>MSstats will compare all conditions that are indicated in the comparison matrix. The comparison matrix has to be setup correctly to avoid errors and wrong statistical modelling. It contains a first column that gives the comparisons a name and one column per condition. This matrix is filled with 1 and -1 to specify the conditions that are compared in each comparison and with 0 for conditions that are not part of the comparison.</p>\n\n<blockquote class=\"tip\">\n  <tip-title>Generating the MSstats comparison matrix</tip-title>\n\n  <ol>\n    <li>The first column of the comparison matrix contains the names of the comparisons and should have ‘names’ as header. These names will be used in all MSstats output files, therefore it is important that the names are meaningful and reflect the actual comparison (see below)</li>\n    <li>An additional column for each condition that is present in the data. This means each condition present in the annotation file has to be a separate column even when the condition will not be used for any comparison. The header should contain the condition name exactly as written in the annotation file.</li>\n    <li>Fill the matrix: Use 1 and -1 to indicate the conditions to compare and 0 for conditions that are not compared. Multiple groups can be combined by using 0.5.</li>\n    <li>Example: to compare condition1 with condition2: write 1 into the column of condition1 and write -1 in the column of condition2. In the first column of the matrix name this comparison condition1-condition2. The naming of the comparison should reflect the direction of the comparison and thus always have the condition that is set to 1 first and the condition that is set to -1 second (condition1-condition2 and NOT condition2-condition1).</li>\n  </ol>\n\n</blockquote>\n\n<p>The first analysis step in MSstats is the conversion of the input data into an MSstats compatible table. For this step several parameters to filter and adjust the input data can be selected. We keep the default parameters and only change one parameter in order to remove proteins which have only a single peptide measurement.\nNext, data processing optimizes the data for statistical modelling via log-transformation, and normalization of intensities, feature selection, missing value imputation, and run-level summarization.\nLog- transformation is performed to transform multiplicative signals to additive signals which are compatible with linear statistical models and bring the intensity distribution close to a normal distribution. Furthermore, it changes the dependence of variances from the intensity values: in the raw data larger intensities have larger variances but after log transformation lower intensities have larger variances.</p>\n\n<p>Normalization aims to make the intensities of different runs more comparable to each other. The default normalization method, equalize medians, assumes that the majority of proteins do not change across runs and shifts all intensities of a run by a constant to obtain equal median intensities across runs.\nA feature in label-free DDA data corresponds to a peptide at a given charge state (m/z value), resulting from the identification of MS2 spectra combined with the quantitative information from the MS1 scans. Feature selection allows the use of either all, only the most abundant features or only high quality peptides for protein summarization.</p>\n\n<p>Missing values and noisy features with outliers are typical in label-free DDA datasets but influence protein summarization. Therefore, it is recommended to perform missing value imputation. Missing values are reported differently in different Softwares. MaxQuant reports them as NA and MSstats assumes that missing intensity values from MaxQuant mean that the intensity was below the limit of quantification. This means the values are not missing for random but for the reason of low abundance. Therefore, the values are only partially known and  called “censored”. This may also be the case for very low intensity values, which might not be reliable. The percentile that is not trusted and should be considered a censored value is defined via the “Maximum quantile for deciding censored missing values” parameter. Censored values are replaced by an intensity that is generated via an accelerated failure time model (AFT). Alternatively censored values may be replaced by the minimum value of the features, runs or both as defined in the “Cutoff value for censoring”. Runs with no intensity measurement for a protein will be removed for any further calculation on this protein.</p>\n\n<p>Protein summarization is by default performed via Tukey’s median polish for robust parameter estimation with median across rows and columns. Run-level summaries are later used for statistical group comparison.</p>\n\n<p>Any two groups can be compared to find differentially abundant proteins between them. MSstats uses a family of linear mixed models that are automatically adjusted for the comparison type according to the information in the annotation file, such as conditions, biological and technical replicates and runs. This allows comparison of groups with different sizes; comparison of the mean of some groups, paired designs and time course experiments.</p>\n\n<h1 id=\"follow-up-on-msstats-results\">Follow up on MSstats results</h1>\n\n<p>We obtain several output files from MSstats. MSstats log file contains the MSstats report with warnings and information about the analysis steps.\nThe MSstats QCPlot visualizes the log transformed intensities for all proteins and runs.\nThe volcano plot plots the statistical result as transformed p-values vs. the log2 fold change. A fold change of 1.5 means that a protein is 50% more abundand in one condition than the other. The log2 fold change is 0.58.</p>\n\n<figure id=\"figure-1\" style=\"max-width: 90%;\"><img src=\"../../images/maxquant-msstats-lfq/qc_plot.png\" alt=\"qc plot. \" width=\"949\" height=\"594\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/maxquant-msstats-lfq/qc_plot.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 1</strong>:</span> QC plot of all proteins</figcaption></figure>\n\n<figure id=\"figure-2\" style=\"max-width: 90%;\"><img src=\"../../images/maxquant-msstats-lfq/volcano_plot.png\" alt=\"volcano plot. \" width=\"951\" height=\"580\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/maxquant-msstats-lfq/volcano_plot.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 2</strong>:</span> Volcano plot showing p-values and log2 fold changes for all proteins. Dashed line indicates p-value of 0.05 and log2 fold change of ± 0.58</figcaption></figure>\n\n<p>The FeatureLevelData file contains the transformed, normalized and imputed intensities for each peptide in each run. ProteinLevelData data summarizes intensities per run and protein.\nWe’ll count and visualize the number of features per run and calculate the distribution of proteins per sample.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Follow up on MSstats results</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"Summary_Statistics1\" title=\"Summary Statistics tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Summary Statistics</strong></span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Summary statistics on”</em>: <code class=\"language-plaintext highlighter-rouge\">ProteinLevelData</code> (output of <strong>MSstats</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Column or expression”</em>: <code class=\"language-plaintext highlighter-rouge\">c8</code></li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/datamash_ops/datamash_ops/datamash_ops/1.0.6\" title=\"Datamash tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Datamash</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.0.6)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input tabular dataset”</em>: <code class=\"language-plaintext highlighter-rouge\">ProteinLevelData</code> (output of <strong>MSstats</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Group by fields”</em>: <code class=\"language-plaintext highlighter-rouge\">4</code></li>\n        <li><em>“Input file has a header line”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        <li><em>“Print header line”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        <li><em>“Sort input”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        <li>In <em>“Operation to perform on each group”</em>:\n          <ul>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Operation to perform on each group”</em>\n              <ul>\n                <li><em>“On column”</em>: <code class=\"language-plaintext highlighter-rouge\">c1</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>Click on <i class=\"fas fa-chart-column\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-barchart</span> “Visualize this data” on the <strong>Datamash</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> result.\n      <ul>\n        <li>Select <code class=\"language-plaintext highlighter-rouge\">Bar diagram (NVD3)</code></li>\n        <li><em>“Provide a title”</em>: <code class=\"language-plaintext highlighter-rouge\">Number of features per sample</code></li>\n        <li>Click <code class=\"language-plaintext highlighter-rouge\">Select data</code> <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span></li>\n        <li><em>“Data point labels”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 1</code></li>\n        <li>Save <i class=\"far fa-save\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-save</span> (file is saved under “User” –&gt; “Visualizations”)</li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>Which sample has the lowest amount of proteins after protein summarization?</li>\n    <li>In the complete experiment, how many features has a protein on average?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>RDEB cSCC4</li>\n    </ol>\n    <figure id=\"figure-3\" style=\"max-width: 90%;\"><img src=\"../../images/maxquant-msstats-lfq/features_sample.png\" alt=\"Number of proteins per sample. \" width=\"1272\" height=\"858\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/maxquant-msstats-lfq/features_sample.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 3</strong>:</span> Number of proteins per sample (run)</figcaption></figure>\n    <ol>\n      <li>Around 6 features per protein (mean in summary statistics).</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<h1 id=\"filtering-msstats-results\">Filtering MSstats results</h1>\n\n<p>The comparison result table summarizes the statistical results per protein and comparison. First, we keep only the Uniprot ID in column 1 to make the ID less cluttered. This is done by deleting everything before the first pipe ‘|’ and everything after the second pipe ‘|’. \nThen we keep only statistically significant proteins that means they have an adjusted p-value below 0.05.\nNext, we separate up- and down-regulated proteins by filtering for a positive and negative log2FC.\nThe Sample Quantification Matrix Table contains the summarized intensities per protein and sample.\nIn order to make its IDs compatible with the ones from the comparison result at a later step, we keep only the Uniprot ID as well.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Filtering MSstats results</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_replace_in_column/1.1.3\" title=\"Replace Text tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Replace Text</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.1.3)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“File to process”</em>: <code class=\"language-plaintext highlighter-rouge\">Comparison Result</code> (output of <strong>MSstats</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li>In <em>“Replacement”</em>:\n      - <em>“in column”</em>: <code class=\"language-plaintext highlighter-rouge\">c1</code>\n      - <em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">sp\\|</code>\n          <ul>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Replacement”</em>\n              <ul>\n                <li><em>“in column”</em>: <code class=\"language-plaintext highlighter-rouge\">c1</code></li>\n                <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">\\|.*</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"Filter1\" title=\"Filter tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Filter</strong></span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Filter”</em>: <code class=\"language-plaintext highlighter-rouge\">replaced comparison result</code> (output of <strong>Replace Text</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“With following condition”</em>: <code class=\"language-plaintext highlighter-rouge\">c8&lt;0.05</code></li>\n        <li><em>“Number of header lines to skip”</em>: <code class=\"language-plaintext highlighter-rouge\">1</code></li>\n        <li>Once finished, rename the file into <code class=\"language-plaintext highlighter-rouge\">significant proteins</code></li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"Filter1\" title=\"Filter tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Filter</strong></span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Filter”</em>: <code class=\"language-plaintext highlighter-rouge\">significant proteins</code> (output of <strong>Filter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“With following condition”</em>: <code class=\"language-plaintext highlighter-rouge\">c3&gt;0.58</code></li>\n        <li><em>“Number of header lines to skip”</em>: <code class=\"language-plaintext highlighter-rouge\">1</code></li>\n      </ul>\n    </li>\n    <li>\n      <p>Add a tag <code class=\"language-plaintext highlighter-rouge\">#metastasized</code> to the filtered file and rename it into <code class=\"language-plaintext highlighter-rouge\">metastasized filtered</code></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-adding-a-tag\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-adding-a-tag\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Adding a tag</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ol>   <li>Click on the dataset to expand it</li>   <li>Click on <strong>Add Tags</strong> <i class=\"fas fa-tags\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-tags</span></li>   <li>Add a tag  starting with <code class=\"language-plaintext highlighter-rouge\">#</code>     <ul>       <li>Tags starting with <code class=\"language-plaintext highlighter-rouge\">#</code> will be automatically propagated to the outputs of tools using this dataset.</li>     </ul>   </li>   <li>Press <kbd>Enter</kbd></li>   <li>Check that the tag appears below the dataset name</li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li><span class=\"tool\" data-tool=\"Filter1\" title=\"Filter tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Filter</strong></span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Filter”</em>: <code class=\"language-plaintext highlighter-rouge\">significant proteins</code> (output of the first <strong>Filter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“With following condition”</em>: <code class=\"language-plaintext highlighter-rouge\">c3&lt;-0.58</code></li>\n        <li><em>“Number of header lines to skip”</em>: <code class=\"language-plaintext highlighter-rouge\">1</code></li>\n      </ul>\n    </li>\n    <li>Add a tag <code class=\"language-plaintext highlighter-rouge\">#rdeb</code> to the filtered file and rename it into <code class=\"language-plaintext highlighter-rouge\">rdeb filtered</code></li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>Why do we filter for the adjusted p-value?</li>\n    <li>How many proteins have a p-value below 0.05?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>Adjusted p-values control for the multiplicity of testing. Since we fit a separate model, and conduct a separate comparison for each protein, the number of tests equals the number of comparisons. A 0.05 cutoff of an adjusted p-value controls the False Discovery Rate in the collection of tests over all the proteins at 5%. Since they account for the multiplicity, adjusted p-values are more conservative (i.e. it is more difficult to detect a change).</li>\n      <li>148 in total (first filtering step); 133 are upregulated in metastasized cSCC (metastasized filtered) and 13 are upregulated in RDEB cSCC (rdeb filtered).</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<h1 id=\"finding-differentially-abundant-proteins\">Finding differentially abundant proteins</h1>\n\n<p>For each condition we select only the significant proteins, which are proteins with a p-value above 0 and below 0.05. Proteins with a p-value of 0 are missing in one condition and are therfore discarded in the next steps. We’ll keep only the column with the Uniprot ID and extract the average protein intensities per sample from the sample quantification matrix file and vizualize them at heatmap. We do the exact same steps for both conditions, therefore, each time you start a tool (except for the replace step) you can use the multiple input file to start the step for the metastasized and rdeb files at the same time.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>filter differentially abundant proteins</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"Filter1\" title=\"Filter tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Filter</strong></span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Filter”</em>: <code class=\"language-plaintext highlighter-rouge\">metastasized filtered</code> (output of <strong>Filter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“With following condition”</em>: <code class=\"language-plaintext highlighter-rouge\">c8&gt;0</code></li>\n        <li><em>“Number of header lines to skip”</em>: <code class=\"language-plaintext highlighter-rouge\">1</code></li>\n        <li>Rename the file into <code class=\"language-plaintext highlighter-rouge\">significant metastasized</code></li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"Cut1\" title=\"Cut tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Cut</strong></span> with the following parameters:\n      <ul>\n        <li><em>“Cut columns”</em>: <code class=\"language-plaintext highlighter-rouge\">c1</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“From”</em>: <code class=\"language-plaintext highlighter-rouge\">significant metastasized </code> (output of last <strong>Filter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"Filter1\" title=\"Filter tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Filter</strong></span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Filter”</em>: <code class=\"language-plaintext highlighter-rouge\">rdeb filtered</code> (output of <strong>Filter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“With following condition”</em>: <code class=\"language-plaintext highlighter-rouge\">c8&gt;0</code></li>\n        <li><em>“Number of header lines to skip”</em>: <code class=\"language-plaintext highlighter-rouge\">1</code></li>\n        <li>Rename the file into <code class=\"language-plaintext highlighter-rouge\">significant rdeb</code></li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"Cut1\" title=\"Cut tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Cut</strong></span> with the following parameters:\n      <ul>\n        <li><em>“Cut columns”</em>: <code class=\"language-plaintext highlighter-rouge\">c1</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“From”</em>: <code class=\"language-plaintext highlighter-rouge\">significant rdeb</code> (output of last <strong>Filter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_replace_in_column/1.1.3\" title=\"Replace Text tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Replace Text</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.1.3)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“File to process”</em>: <code class=\"language-plaintext highlighter-rouge\">Sample Quantification Matrix Table</code> (output of <strong>MSstats</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li>In <em>“Replacement”</em>:\n      - <em>“in column”</em>: <code class=\"language-plaintext highlighter-rouge\">c1</code>\n      - <em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">sp\\|</code>\n          <ul>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Replacement”</em>\n              <ul>\n                <li><em>“in column”</em>: <code class=\"language-plaintext highlighter-rouge\">c1</code></li>\n                <li><em>“Find pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">\\|.*</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_easyjoin_tool/1.1.2\" title=\"Join tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Join</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.1.2)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“1st file”</em>: <code class=\"language-plaintext highlighter-rouge\">replaced sample quantification matrix</code> (output of <strong>Replace text</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Column to use from 1st file”</em>: <code class=\"language-plaintext highlighter-rouge\">c1</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“2nd File”</em>: <code class=\"language-plaintext highlighter-rouge\">metastasized cut</code> (output of <strong>Cut</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Column to use from 2nd file”</em>: <code class=\"language-plaintext highlighter-rouge\">c1</code></li>\n        <li><em>“First line is a header line”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_easyjoin_tool/1.1.2\" title=\"Join tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Join</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.1.2)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“1st file”</em>: <code class=\"language-plaintext highlighter-rouge\">replaced sample quantification matrix</code> (output of <strong>Replace Text</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Column to use from 1st file”</em>: <code class=\"language-plaintext highlighter-rouge\">c1</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“2nd File”</em>: <code class=\"language-plaintext highlighter-rouge\">rdeb cut</code> (output of <strong>Cut</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Column to use from 2nd file”</em>: <code class=\"language-plaintext highlighter-rouge\">c1</code></li>\n        <li><em>“First line is a header line”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/ggplot2_heatmap2/ggplot2_heatmap2/3.0.1\" title=\"Heatmap2 tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Heatmap2</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 3.0.1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input should have column headers - these will be the columns that are plotted”</em>: <code class=\"language-plaintext highlighter-rouge\">metastasized join</code> (output of <strong>Join</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Plot title”</em>: <code class=\"language-plaintext highlighter-rouge\">Upregulated proteins in metastasized cSCC</code></li>\n        <li><em>“Enable data clustering”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n        <li><em>“Data scaling”</em>: <code class=\"language-plaintext highlighter-rouge\">Scale my data by row</code></li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/ggplot2_heatmap2/ggplot2_heatmap2/3.0.1\" title=\"Heatmap2 tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Heatmap2</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 3.0.1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input should have column headers - these will be the columns that are plotted”</em>: <code class=\"language-plaintext highlighter-rouge\">rdeb join</code> (output of <strong>Join</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Plot title”</em>: <code class=\"language-plaintext highlighter-rouge\">Upregulated proteins in RDEB cSCC</code></li>\n        <li><em>“Enable data clustering”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n        <li><em>“Data scaling”</em>: <code class=\"language-plaintext highlighter-rouge\">Scale my data by row</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>How many proteins are differentially abundant?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>85 are upregulated in metastasized cSCC and 12 are upregulated in RDEB cSCC (number of lines minus 1 in the first filtering step per condition).</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<h1 id=\"follow-up-on-differentially-abundant-proteins\">Follow up on differentially abundant proteins</h1>\n\n<p>In addition we retrieve for each Uniprot ID the corresponding protein names from uniprot to allow an easier interpretation.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>MSstats visualizations</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/uniprot_rest_interface/uniprot/0.2\" title=\"UniProt ID mapping and retrieval tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>UniProt ID mapping and retrieval</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.2)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input file with IDs”</em>: <code class=\"language-plaintext highlighter-rouge\">metastasized join</code> (output of <strong>Join</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“ID column”</em>: <code class=\"language-plaintext highlighter-rouge\">c1</code></li>\n        <li><em>“Do you want to map IDs or retrieve data from UniProt”</em>: <code class=\"language-plaintext highlighter-rouge\">Retrieve: request entries by uniprot accession using batch retrieval</code></li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/uniprot_rest_interface/uniprot/0.2\" title=\"UniProt ID mapping and retrieval tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>UniProt ID mapping and retrieval</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.2)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input file with IDs”</em>: <code class=\"language-plaintext highlighter-rouge\">rdeb join</code> (output of <strong>Join</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“ID column”</em>: <code class=\"language-plaintext highlighter-rouge\">c1</code></li>\n        <li><em>“Do you want to map IDs or retrieve data from UniProt”</em>: <code class=\"language-plaintext highlighter-rouge\">Retrieve: request entries by uniprot accession using batch retrieval</code></li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/devteam/fasta_to_tabular/fasta2tab/1.1.1\" title=\"FASTA-to-Tabular tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>FASTA-to-Tabular</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.1.1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Convert these sequences”</em>: <code class=\"language-plaintext highlighter-rouge\">metastasized uniprot</code> (output of <strong>UniProt</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“How many columns to divide title string into?”</em>: <code class=\"language-plaintext highlighter-rouge\">2</code></li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/devteam/fasta_to_tabular/fasta2tab/1.1.1\" title=\"FASTA-to-Tabular tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>FASTA-to-Tabular</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.1.1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Convert these sequences”</em>: <code class=\"language-plaintext highlighter-rouge\">rdeb uniprot</code> (output of <strong>UniProt</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“How many columns to divide title string into?”</em>: <code class=\"language-plaintext highlighter-rouge\">2</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>Three of the differentially abundant proteins found here were also found and stained with antibodies in the original publication: Collagen XIV which is higher in RDEB cSCC than in metastasizing cSCC and Serum amyloid P-component as well as X-ray repair cross-complementing protein 6, which are both higher in metastasizing cSCC than in RDEB cSCC. Collagen XIV is a fibril associated collagen which may have tissue stabilizing function in the dermis. The upregulation of collagen XIV as well as other collagens in RDEB cSCC could be a compensation effort for the impaired collagen VII in RDEB tissues. Collagen VII is indeed only found in some RDEB samples and with such low intensities that it appears as upregulated in metastasized cSCC.</p>\n\n<figure id=\"figure-4\" style=\"max-width: 90%;\"><img src=\"../../images/maxquant-msstats-lfq/col14_ihc.png\" alt=\"col14 staining. \" width=\"781\" height=\"307\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/maxquant-msstats-lfq/col14_ihc.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 4</strong>:</span> Immunoflourescence staining of collagen XIV in RDEB and metastasizing cSCC skin tissues</figcaption></figure>\n"],"ref_slides":[],"hands_on":true,"slides":false,"mod_date":"2024-05-29 14:28:52 +0000","pub_date":"2021-02-17 12:39:38 +0000","version":18,"workflows":[{"workflow":"main_workflow.ga","tests":false,"url":"https://training.galaxyproject.org/training-material/topics/proteomics/tutorials/maxquant-msstats-dda-lfq/workflows/main_workflow.ga","path":"topics/proteomics/tutorials/maxquant-msstats-dda-lfq/workflows/main_workflow.ga","wfid":"proteomics-maxquant-msstats-dda-lfq","wfname":"main_workflow","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/proteomics-maxquant-msstats-dda-lfq/versions/main_workflow","license":null,"creators":[],"name":"Proteomics: MaxQuant and MSstats LFQ workflow","title":"Proteomics: MaxQuant and MSstats LFQ workflow","test_results":null,"modified":"2024-06-14 10:01:51 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\nannotation file\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"ℹ️ Input Dataset\\ncomparison matrix\"];\n  style 1 stroke:#2c3143,stroke-width:4px;\n  2[\"ℹ️ Input Dataset\\nfasta protein database\"];\n  style 2 stroke:#2c3143,stroke-width:4px;\n  3[\"ℹ️ Input Collection\\nraw files\"];\n  style 3 stroke:#2c3143,stroke-width:4px;\n  4[\"MaxQuant\"];\n  2 -->|output| 4;\n  3 -->|output| 4;\n  5[\"Select\"];\n  4 -->|proteinGroups| 5;\n  6[\"Select\"];\n  4 -->|evidence| 6;\n  7[\"Replace Text\"];\n  5 -->|out_file1| 7;\n  8[\"Replace Text\"];\n  6 -->|out_file1| 8;\n  9[\"MSstats\"];\n  1 -->|output| 9;\n  0 -->|output| 9;\n  8 -->|outfile| 9;\n  7 -->|outfile| 9;\n  10[\"Datamash\"];\n  9 -->|runlevel_data| 10;\n  11[\"Summary Statistics\"];\n  9 -->|runlevel_data| 11;\n  12[\"Replace Text\"];\n  9 -->|comparison_result| 12;\n  13[\"Replace Text\"];\n  9 -->|quant_sample_matrix| 13;\n  14[\"Filter\"];\n  12 -->|outfile| 14;\n  15[\"Filter\"];\n  14 -->|out_file1| 15;\n  16[\"Filter\"];\n  14 -->|out_file1| 16;\n  17[\"Filter\"];\n  15 -->|out_file1| 17;\n  18[\"Filter\"];\n  16 -->|out_file1| 18;\n  19[\"Cut\"];\n  17 -->|out_file1| 19;\n  20[\"Cut\"];\n  18 -->|out_file1| 20;\n  21[\"Join\"];\n  13 -->|outfile| 21;\n  19 -->|out_file1| 21;\n  22[\"Join\"];\n  13 -->|outfile| 22;\n  20 -->|out_file1| 22;\n  23[\"heatmap2\"];\n  21 -->|output| 23;\n  24[\"UniProt\"];\n  21 -->|output| 24;\n  25[\"heatmap2\"];\n  22 -->|output| 25;\n  26[\"UniProt\"];\n  22 -->|output| 26;\n  27[\"FASTA-to-Tabular\"];\n  24 -->|outfile_retrieve_fasta| 27;\n  28[\"FASTA-to-Tabular\"];\n  26 -->|outfile_retrieve_fasta| 28;"}],"api":"https://training.galaxyproject.org/training-material/api/topics/proteomics/tutorials/maxquant-msstats-dda-lfq/tutorial.json","tools":["Cut1","Filter1","Grep1","Summary_Statistics1","toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_easyjoin_tool/1.1.2","toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_replace_in_column/1.1.3","toolshed.g2.bx.psu.edu/repos/bgruening/uniprot_rest_interface/uniprot/0.2","toolshed.g2.bx.psu.edu/repos/devteam/fasta_to_tabular/fasta2tab/1.1.1","toolshed.g2.bx.psu.edu/repos/galaxyp/maxquant/maxquant/1.6.10.43+galaxy3","toolshed.g2.bx.psu.edu/repos/galaxyp/maxquant/maxquant/1.6.10.43+galaxy4","toolshed.g2.bx.psu.edu/repos/galaxyp/msstats/msstats/3.22.0.1","toolshed.g2.bx.psu.edu/repos/galaxyp/msstats/msstats/4.0.0.0","toolshed.g2.bx.psu.edu/repos/iuc/datamash_ops/datamash_ops/datamash_ops/1.0.6","toolshed.g2.bx.psu.edu/repos/iuc/ggplot2_heatmap2/ggplot2_heatmap2/3.0.1"],"supported_servers":{"exact":[{"url":"https://usegalaxy.eu","name":"UseGalaxy.eu","usegalaxy":true}],"inexact":[{"url":"https://usegalaxy.be/","name":"UseGalaxy.be","usegalaxy":false},{"url":"https://usegalaxy.cz/","name":"UseGalaxy.cz","usegalaxy":false},{"url":"https://usegalaxy.no/","name":"UseGalaxy.no","usegalaxy":false},{"url":"https://usegalaxy.org","name":"UseGalaxy.org (Main)","usegalaxy":true},{"url":"https://usegalaxy.org.au","name":"UseGalaxy.org.au","usegalaxy":true}]},"topic_name_human":"Proteomics","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"text_processing","owner":"bgruening","revisions":"d698c222f354","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"text_processing","owner":"bgruening","revisions":"d698c222f354","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"uniprot_rest_interface","owner":"bgruening","revisions":"054483e27a35","tool_panel_section_label":"Convert Formats","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"fasta_to_tabular","owner":"devteam","revisions":"e7ed3c310b74","tool_panel_section_label":"FASTA/FASTQ","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"maxquant","owner":"galaxyp","revisions":"37d669de2828","tool_panel_section_label":"Proteomics","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"maxquant","owner":"galaxyp","revisions":"f522c08e900c","tool_panel_section_label":"Proteomics","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"msstats","owner":"galaxyp","revisions":"593839e1f2c3","tool_panel_section_label":"Proteomics","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"msstats","owner":"galaxyp","revisions":"28434abe6c5c","tool_panel_section_label":"Proteomics","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"ggplot2_heatmap2","owner":"iuc","revisions":"ca7cb0eaad62","tool_panel_section_label":"Graph/Display Data","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: text_processing\n  owner: bgruening\n  revisions: d698c222f354\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: text_processing\n  owner: bgruening\n  revisions: d698c222f354\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: uniprot_rest_interface\n  owner: bgruening\n  revisions: '054483e27a35'\n  tool_panel_section_label: Convert Formats\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: fasta_to_tabular\n  owner: devteam\n  revisions: e7ed3c310b74\n  tool_panel_section_label: FASTA/FASTQ\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: maxquant\n  owner: galaxyp\n  revisions: 37d669de2828\n  tool_panel_section_label: Proteomics\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: maxquant\n  owner: galaxyp\n  revisions: f522c08e900c\n  tool_panel_section_label: Proteomics\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: msstats\n  owner: galaxyp\n  revisions: 593839e1f2c3\n  tool_panel_section_label: Proteomics\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: msstats\n  owner: galaxyp\n  revisions: 28434abe6c5c\n  tool_panel_section_label: Proteomics\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: ggplot2_heatmap2\n  owner: iuc\n  revisions: ca7cb0eaad62\n  tool_panel_section_label: Graph/Display Data\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":false,"slides_recordings":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial"}