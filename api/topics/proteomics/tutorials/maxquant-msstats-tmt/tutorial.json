{"layout":"tutorial_hands_on","title":"MaxQuant and MSstats for the analysis of TMT data","zenodo_link":"https://zenodo.org/record/5195800","questions":["How to analyze tandem-mass-tag (TMT) labelled shotgun (DDA) data analysis in MaxQuant and MSstats?","Which proteins are differentially abundant between KMT9α knock-down and control cells?"],"objectives":["Learn how to use MaxQuant and MSstats for the analysis of TMT labelled shotgun (DDA) data","Learn how to create an experimental design template for fractionated data in MaxQuant","Learn how to create an annotation file for MSstatsTMT"],"time_estimation":"3H","key_points":["MaxQuant in combination with MSstatsTMT enables quantitative analysis of TMT data."],"contributors":[{"name":"Klemens Fröhlich","joined":"2021-08","id":"KlemensFroehlich","url":"https://training.galaxyproject.org/training-material/api/contributors/KlemensFroehlich.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/KlemensFroehlich/"},{"name":"Melanie Föll","email":"melanie.foell@mol-med.uni-freiburg.de","twitter":"MCFoell","matrix":"foellmelanie:matrix.org","orcid":"0000-0002-1887-7543","joined":"2018-10","affiliations":["uni-freiburg"],"id":"foellmelanie","url":"https://training.galaxyproject.org/training-material/api/contributors/foellmelanie.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/foellmelanie/"},{"name":"Matthias Fahrner","email":"matthias.fahrner@uniklinik-freiburg.de","twitter":"mfahrner313","orcid":"0000-0001-7955-2518","joined":"2019-03","affiliations":["uni-freiburg"],"id":"matthias313","url":"https://training.galaxyproject.org/training-material/api/contributors/matthias313.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/matthias313/"}],"subtopic":"id-quant","tags":["DDA","TMT"],"js_requirements":{"mathjax":null,"mermaid":false},"short_id":"T00220","url":"/topics/proteomics/tutorials/maxquant-msstats-tmt/tutorial.html","topic_name":"proteomics","tutorial_name":"maxquant-msstats-tmt","dir":"topics/proteomics/tutorials/maxquant-msstats-tmt","symlink":null,"id":"proteomics/maxquant-msstats-tmt","ref_tutorials":["<p>In this training we will cover the full analysis workflow from tandem mass tag (TMT) labeled samples using MaxQuant in conjunction with MSstatsTMT.</p>\n\n<p>The training dataset consists of a dataset from <span class=\"citation\"><a href=\"#Baumert_2020\">Baumert <i>et al.</i> 2020</a></span> which investigates the effects of a recently discovered histone methyltransferase, lysine methyl transferase 9 (KMT9α) in A549 cells. High KMT9α expression in lung cancer correlates with poor patient survival. Therefore,  KMT9α is a very interesting research target in light of the fact that lung cancer survival rates could not be improved over the last 15 years. The example dataset consists of 4 cell culture samples from KMT9α knock-down cells and 4 cell culture samples from control (Ctrl) cells. In order to increase the proteome coverage the TMT experiment was pre-fractionated using offline high pH reverse phase chromatography resulting in 12 MS runs.</p>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n  <p>In this tutorial, we will cover:</p>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#get-data\" id=\"markdown-toc-get-data\">Get data</a></li>\n  <li><a href=\"#maxquant-analysis\" id=\"markdown-toc-maxquant-analysis\">MaxQuant analysis</a></li>\n  <li><a href=\"#msstatstmt-analysis\" id=\"markdown-toc-msstatstmt-analysis\">MSstatsTMT analysis</a></li>\n  <li><a href=\"#follow-up-on-msstatstmt-results\" id=\"markdown-toc-follow-up-on-msstatstmt-results\">Follow up on MSstatsTMT results</a></li>\n</ol>\n\n</blockquote>\n\n<h2 id=\"get-data\">Get data</h2>\n\n<p>The raw data is available via the PRIDE repository under the ID: <a href=\"https://www.ebi.ac.uk/pride/archive/projects/PXD014145\">PXD014145</a>. The MaxQuant experimental design template file, MSstatsTMT annotation file and FASTA file for this training are deposited at Zenodo(https://zenodo.org/record/5195800). It is of course possible to use another FASTA file with human proteome sequences, but to ensure that the results are compatible, we recommend using the provided FASTA file. MaxQuant not only adds known contaminants to the FASTA file, but also generates the “decoy” hits for false discovery rate estimation itself, therefore the FASTA file is not allowed to have decoy entries. To learn more about FASTA files, have a look at <a href=\"/training-material/topics/proteomics/tutorials/database-handling/tutorial.html\">Protein FASTA Database Handling tutorial</a>.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Data upload</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Create a new history for this tutorial and give it a meaningful name</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-new-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-new-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a new history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>Click the <i class=\"fas fa-plus\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">new-history</span> icon at the top of the history panel:</p>   <p><img src=\"/training-material/shared/images/history_create_new.svg\" alt=\"UI for creating new history\" /></p>   <!-- the original drawing can be found here https://docs.google.com/drawings/d/1cCBrLAo4kDGic5QyB70rRiWJAKTenTU8STsKDaLcVU8/edit?usp=sharing --> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Import the FASTA database, experimental design template, and annotation file <a href=\"https://zenodo.org/record/5195800\">Zenodo</a></p>\n\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/5195800/files/protein_database.fasta\nhttps://zenodo.org/record/5195800/files/MaxQuant%20experimental%20design%20template.tabular\nhttps://zenodo.org/record/5195800/files/MSstatsTMT%20annotation%20file.tabular\n</code></pre></div>      </div>\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-via-links\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-via-links\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing via links</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Once the files are green, rename the fasta file into ‘protein database’, the experimental design template into ‘experimental design template’, and the annotation file into ‘annotation file’.</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-renaming-a-dataset\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-renaming-a-dataset\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Renaming a dataset</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, change the <strong>Name</strong> field</li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>To run MaxQuant, import the raw data from <a href=\"https://www.ebi.ac.uk/pride/archive/projects/PXD014145\">PRIDE</a> as a ‘Collection’.</p>\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>ftp://ftp.pride.ebi.ac.uk/pride-archive/2020/05/PXD014145/MFA380.raw\nftp://ftp.pride.ebi.ac.uk/pride-archive/2020/05/PXD014145/MFA381.raw\nftp://ftp.pride.ebi.ac.uk/pride-archive/2020/05/PXD014145/MFA382.raw\nftp://ftp.pride.ebi.ac.uk/pride-archive/2020/05/PXD014145/MFA383.raw\nftp://ftp.pride.ebi.ac.uk/pride-archive/2020/05/PXD014145/MFA384.raw\nftp://ftp.pride.ebi.ac.uk/pride-archive/2020/05/PXD014145/MFA385.raw\nftp://ftp.pride.ebi.ac.uk/pride-archive/2020/05/PXD014145/MFA386.raw\nftp://ftp.pride.ebi.ac.uk/pride-archive/2020/05/PXD014145/MFA387.raw\nftp://ftp.pride.ebi.ac.uk/pride-archive/2020/05/PXD014145/MFA388.raw\nftp://ftp.pride.ebi.ac.uk/pride-archive/2020/05/PXD014145/MFA389.raw\nftp://ftp.pride.ebi.ac.uk/pride-archive/2020/05/PXD014145/MFA390.raw\nftp://ftp.pride.ebi.ac.uk/pride-archive/2020/05/PXD014145/MFA391.raw\n</code></pre></div>      </div>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-via-links-1\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-via-links-1\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing via links</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>     <p>Click on <strong>Collection</strong> on the top</p>   </li>   <li>     <p>Click on <strong>Collection Type</strong> and select <code class=\"language-plaintext highlighter-rouge\">List</code></p>   </li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Change <strong>Type (set all):</strong> from “Auto-detect” to <code class=\"language-plaintext highlighter-rouge\">thermo.raw</code></p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li>     <p>Click on <strong>Build</strong> when available</p>   </li>   <li>     <p>Enter a name for the collection</p>     <ul>       <li>raw_files</li>     </ul>   </li>   <li>Click on <strong>Create list</strong> (and wait a bit)</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n</blockquote>\n\n<h1 id=\"maxquant-analysis\">MaxQuant analysis</h1>\n\n<p>We start the MaxQuant run with TMT parameters for MS2 based reporter quantitation. A quality control report will be generated with the <a href=\"https://pubs.acs.org/doi/10.1021/acs.jproteome.5b00780\">PTXQC functionality</a> that is directly implemented in the MaxQuant Galaxy tool. For more information about MaxQuant and its parameter please have a look at the <a href=\"/training-material/topics/proteomics/tutorials/maxquant-label-free/tutorial.html\">Label-free data analysis using MaxQuant tutorial</a>. To continue with statistical analysis in MSstatsTMT, the Protein Groups and the Evidence files are needed from MaxQuant. The run time of MaxQuant depends on the number and size of the input files and on the chosen parameters. The run of the training datasets will take a while, but the training can be directly continued with the MaxQuant result files from Zenodo.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>MaxQuant analysis</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/galaxyp/maxquant/maxquant/1.6.17.0+galaxy2\" title=\"MaxQuant tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>MaxQuant</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.6.17.0+galaxy2)</span> with the following parameters:\n      <ul>\n        <li>In <em>“Input Options”</em>:\n          <ul>\n            <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“FASTA files”</em>: <code class=\"language-plaintext highlighter-rouge\">protein database</code></li>\n          </ul>\n        </li>\n        <li>In <em>“Search Options”</em>:\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Specify an experimental design template”</em>: <code class=\"language-plaintext highlighter-rouge\">experimental design template</code></li>\n          </ul>\n        </li>\n        <li>In <em>“Parameter Group”</em>:\n          <ul>\n            <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“Infiles”</em>: <code class=\"language-plaintext highlighter-rouge\">MFA380.raw</code> <code class=\"language-plaintext highlighter-rouge\">MFA381.raw</code> <code class=\"language-plaintext highlighter-rouge\">MFA382.raw</code> <code class=\"language-plaintext highlighter-rouge\">MFA383.raw</code> <code class=\"language-plaintext highlighter-rouge\">MFA384.raw</code> <code class=\"language-plaintext highlighter-rouge\">MFA385.raw</code> <code class=\"language-plaintext highlighter-rouge\">MFA386.raw</code> <code class=\"language-plaintext highlighter-rouge\">MFA387.raw</code> <code class=\"language-plaintext highlighter-rouge\">MFA388.raw</code> <code class=\"language-plaintext highlighter-rouge\">MFA389.raw</code> <code class=\"language-plaintext highlighter-rouge\">MFA390.raw</code> <code class=\"language-plaintext highlighter-rouge\">MFA391.raw</code></li>\n            <li><em>“Quantitation Methods”</em>: <code class=\"language-plaintext highlighter-rouge\">reporter ion MS2</code>\n              <ul>\n                <li><em>“isobaric labeling”</em>: <code class=\"language-plaintext highlighter-rouge\">TMT11plex</code></li>\n                <li><em>“Filter by PIF”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n        <li><em>“Generate PTXQC (proteomics quality control pipeline) report? (experimental setting)”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        <li>In <em>“Output Options”</em>:\n          <ul>\n            <li><em>“Select the desired outputs.”</em>: <code class=\"language-plaintext highlighter-rouge\">Protein Groups</code> <code class=\"language-plaintext highlighter-rouge\">mqpar.xml</code> <code class=\"language-plaintext highlighter-rouge\">Evidence</code> <code class=\"language-plaintext highlighter-rouge\">MaxQuant and PTXQC log</code></li>\n          </ul>\n        </li>\n      </ul>\n\n      <blockquote class=\"tip\">\n        <tip-title>Continue with results from Zenodo</tip-title>\n\n        <p>Because the MaxQuant run takes quite a while, we recommend to download the MaxQuant results from Zenodo and continue with the tutorial</p>\n        <ol>\n          <li>Import the files from <a href=\"https://zenodo.org/record/5195800\">Zenodo</a></li>\n        </ol>\n\n        <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/5195800/files/MaxQuant%20Result%20evidence.tabular\nhttps://zenodo.org/record/5195800/files/MaxQuant%20Result%20protein%20groups.tabular\n</code></pre></div>        </div>\n      </blockquote>\n    </li>\n  </ol>\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>How many protein groups were found with MaxQuant?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>6911 (numbers might slightly vary with different MaxQuant versions); number of lines minus header line in the MaxQuant protein groups output</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<blockquote class=\"tip\">\n  <tip-title>PIF parameter for TMT data</tip-title>\n  <p>Co-isolation of multiple peptides can lead to inaccurate TMT signals, as not only one peptide is fragmented but multiple different peptides are fragmented and the TMT signals cannot be distinguished anymore. MaxQuant can “check” the MS1 scans to predict, whether multiple different peptides were cofragmented. Precursor Intensity Filtering (PIF) allows you to implement a cutoff how high the purity of fragmentation was (1 = no coisolation, 0.75 = default).</p>\n</blockquote>\n\n<blockquote class=\"tip\">\n  <tip-title>Preparing an MaxQuant experimental design template for your own analysis</tip-title>\n  <p>For this tutorial all files needed for the analysis are provided. Nevertheless here are some guidelines for the generation of the experimental design template for MaxQuant for your own data analyses.\nFor thermo.raw files, “.raw” is considered a part of the filename. Therefore, file names should be ‘Filename1.raw’, ‘Filename2.raw’ etc.. Please pay special attention to your experimental design, since MaxQuant will summarize peptide and protein intensities differently depending on this input. In brief, MaxQuant will summarize the protein intensities within each specified experiment. Often, TMT experiments are not measured in one MS run, but in multiple runs (either as so called fractions, or as replicates). Over the last years, high pH prefractionation has become the standard for fractionating TMT samples. Alternatively, SCX or HILIC fractionations can be employed. Although you fractionated your samples prior to measurement you still want MaxQuant to group all samples which belong to “one” TMT experiment. Since the fractions originate from one sample the experimental design template allows to map multiple measurements to one experiment (= Sample). Additionally, it is possible to have a more complex experimental setup including multiple TMT experiments, possibly containing multiple fractions per experiment. All MS files which are labeled with the same “Experiment” name are summarized in the proteinGroups and peptides output of MaxQuant.</p>\n</blockquote>\n\n<h1 id=\"msstatstmt-analysis\">MSstatsTMT analysis</h1>\n\n<p>The protein groups and evidence files of MaxQuant can directly be used as an input for MSstatsTMT. MSstatsTMT automatically removes all proteins that are labelled as contaminants (‘+’ sign in the column ‘potential contaminant’ of both MaxQuant outputs). In case you want to prevent this step either run MaxQuant with “Include Contaminants: No” or remove the ‘+’ sign from the MaxQuant files as described in the <a href=\"/training-material/topics/proteomics/tutorials/maxquant-msstats-dda-lfq/tutorial.html\">label-free MSstats training</a>. Additionally, MSstatsTMT will combine all quantitations according to the annotation file, which you have to provide (e.g all fractions of the same mixture are combined).\nFor this dataset, the standard parameters of MSstatsTMT fit quite nicely, as this is a straightforward two group comparison. If you have more than two groups, you may consider using the comparison matrix option of MSstatsTMT (for more information see <a href=\"/training-material/topics/proteomics/tutorials/maxquant-msstats-dda-lfq/tutorial.html\">label-free MSstats training</a>).</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>MSstatsTMT analysis</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/galaxyp/msstatstmt/msstatstmt/2.0.0+galaxy0\" title=\"MSstatsTMT tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>MSstatsTMT</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.0.0+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><em>“Input Source”</em>: <code class=\"language-plaintext highlighter-rouge\">MaxQuant</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“evidence.txt - feature-level data”</em>: <code class=\"language-plaintext highlighter-rouge\">evidence</code> (output of <strong>MaxQuant</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“proteinGroups.txt”</em>: <code class=\"language-plaintext highlighter-rouge\">proteinGroups</code> (output of <strong>MaxQuant</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“annotation.txt”</em>: <code class=\"language-plaintext highlighter-rouge\">annotation file</code></li>\n          </ul>\n        </li>\n        <li>In <em>“Plot Output Options”</em>:\n          <ul>\n            <li><em>“Select protein IDs to draw plots”</em>: <code class=\"language-plaintext highlighter-rouge\">Option for QC plot: \"allonly\" will generate one QC plot with all proteins</code></li>\n          </ul>\n        </li>\n        <li><em>“Compare Groups”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code>\n          <ul>\n            <li>In <em>“Comparison Plot Options”</em>:\n              <ul>\n                <li><em>“Display protein names in Volcano Plot.”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n        <li><em>“Select Outputs”</em>: <code class=\"language-plaintext highlighter-rouge\">MSstatsTMT summarization log</code> <code class=\"language-plaintext highlighter-rouge\">Protein Abundance</code> <code class=\"language-plaintext highlighter-rouge\">QC Plot</code></li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<blockquote class=\"tip\">\n  <tip-title>Waiting for MSstatsTMT result</tip-title>\n  <p>This training consists of a real proteomics experiments. Therefore, calculation times take longer than in usual Galaxy tutorials. You may want to come back later to the training or use the time to prepare your own data for the analysis with MaxQuant and MSstatsTMT with the tips provided in this training (yellow boxes).</p>\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>How many differentially regulated proteins were detected in the MSstatsTMT group comparison?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>7139 (numbers might slightly vary with different MSstatsTMT versions); number of lines minus header line in the MSstatsTMT group comparison output</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<blockquote class=\"tip\">\n  <tip-title>Preparing an MSstatsTMT annotation file for your own analysis</tip-title>\n\n  <p>For this tutorial all files needed for the analysis are provided. Nevertheless here are some guidelines for the generation of annotation file for MSstatsTMT for your own data analyses.\nAs MSstatsTMT has to perform statistical analyses, you have to provide the following basic information: Which quantitation channel in every sample corresponds to which original biological sample and which biological condition (e.g WT or knock-down) does this sample belong to? To fully automate the process of choosing an appropriate statistical model for analysis, MSstatsTMT needs an annotation matrix that is extremely powerful because it can deal with any experimental setup.</p>\n\n  <p>The annotation file contains the following columns:</p>\n  <ul>\n    <li><strong>Run</strong> corresponds to your MS file names. Please note that MaxQuant in Galaxy will add a “.thermo” to your raw file name as it appears in your history. Since we first analyse the data with MaxQuant, MSstatsTMT needs this additional extension for this annotation file. The correct run names can be found after MaxQuant is finished in the evidence file in the column ‘Raw file’.</li>\n    <li><strong>Fraction</strong> corresponds to the aforementioned optional pre-fractionation fraction of your samples (e.g high pH RP, or SCX)</li>\n    <li><strong>TechRepMixture</strong> corresponds to the n-th time this fraction was measured. If you measured the first Fraction of your first sample twice, Fraction would stay the same, but the TechRepMixture would have to differ.</li>\n    <li><strong>Channel</strong> corresponds to the TMT channel which was used in your Experiments.We recommend to always include all channels in your searches and your annotations, even when these channels are empty. So if you only used 9 of 11 channels in your TMT experiments, add the last 2 channels anyway and just label them as “Empty” in the Condition column. In Galaxy the channel names need to be named ‘channel.X’, with X being the number of the channel.</li>\n    <li><strong>Condition</strong> represents the biological condition, which the observation belongs to (e.g Ctrl). Normalization Channel are labeled as “Norm”. Empty Channels as “Empty”</li>\n    <li><strong>Mixture</strong> corresponds to the “TMT experiment” mentioned above.</li>\n    <li><strong>BioReplicate</strong> corresponds to the biological specimen this observation derives from.\nOn first glance this might sound overwhelming, but used correctly, this annotation matrix can describe very complex experimental setups in a definitive way.</li>\n  </ul>\n\n  <p>An example:</p>\n\n  <p>Consider you perform a study on the difference between primary liver tumors and liver tumor metastases. It makes a very big difference whether all your samples derive from different patients, or whether you were able to obtain some primary tumors and metastases samples from the same patient. The samples obtained from the same patient are expected to be related to each other (they are not independent observations and this must be considered during statistical testing).\nA short illustration: \nYou measured 2 different samples of one patient (metastasis and primary tumor sample).This patient would be considered patient 1 and you would label the primary tumor with the first channel of a TMT-11 plex kit (126) and you would label the metastasis with the second channel (127N). After labeling you combine both samples in one Mixture and measure them in one MS run.</p>\n\n  <p>Your annotation file for this case would look like this:</p>\n\n  <table>\n    <thead>\n      <tr>\n        <th>Run</th>\n        <th>Fraction</th>\n        <th>TechRepMixture</th>\n        <th>Channel</th>\n        <th>Condition</th>\n        <th>Mixture</th>\n        <th>BioReplicate</th>\n      </tr>\n    </thead>\n    <tbody>\n      <tr>\n        <td>File1.thermo.raw</td>\n        <td>1</td>\n        <td>1</td>\n        <td>channel.1</td>\n        <td>primary</td>\n        <td>mixture1</td>\n        <td>1</td>\n      </tr>\n      <tr>\n        <td>File1.thermo.raw</td>\n        <td>1</td>\n        <td>1</td>\n        <td>channel.2</td>\n        <td>metastasis</td>\n        <td>mixture1</td>\n        <td>1</td>\n      </tr>\n    </tbody>\n  </table>\n\n  <p>Let us assume you now have 10 primary tumors and 10 metastases (from 20 different patients). Since you do not have 20plex capabilities, you have to divide your samples into two experiments / mixtures. For simplicity, after labeling and combining all channels belonging to the same experiments, the mixtures are directly measured ( 1 fraction per Mixture). To avoid batch effects due to allocation you use randomization. In order to be able to normalize all quantitations you use a reference sample, which you add to each experiment (this is referred to as “Normalization Channel”). The reference sample is ideally a mixture of all your samples.</p>\n\n  <p>The annotation matrix would now look like this:</p>\n\n  <table>\n    <thead>\n      <tr>\n        <th>Run</th>\n        <th>Fraction</th>\n        <th>TechRepMixture</th>\n        <th>Channel</th>\n        <th>Condition</th>\n        <th>Mixture</th>\n        <th>BioReplicate</th>\n      </tr>\n    </thead>\n    <tbody>\n      <tr>\n        <td>File1.thermo.raw</td>\n        <td>1</td>\n        <td>1</td>\n        <td>channel.1</td>\n        <td>primary</td>\n        <td>mixture1</td>\n        <td>1</td>\n      </tr>\n      <tr>\n        <td>File1.thermo.raw</td>\n        <td>1</td>\n        <td>1</td>\n        <td>channel.2</td>\n        <td>metastasis</td>\n        <td>mixture1</td>\n        <td>2</td>\n      </tr>\n      <tr>\n        <td>File1.thermo.raw</td>\n        <td>1</td>\n        <td>1</td>\n        <td>channel.3</td>\n        <td>primary</td>\n        <td>mixture1</td>\n        <td>3</td>\n      </tr>\n      <tr>\n        <td>File1.thermo.raw</td>\n        <td>1</td>\n        <td>1</td>\n        <td>channel.4</td>\n        <td>metastasis</td>\n        <td>mixture1</td>\n        <td>4</td>\n      </tr>\n      <tr>\n        <td>File1.thermo.raw</td>\n        <td>1</td>\n        <td>1</td>\n        <td>channel.5</td>\n        <td>primary</td>\n        <td>mixture1</td>\n        <td>5</td>\n      </tr>\n      <tr>\n        <td>File1.thermo.raw</td>\n        <td>1</td>\n        <td>1</td>\n        <td>channel.6</td>\n        <td>metastasis</td>\n        <td>mixture1</td>\n        <td>6</td>\n      </tr>\n      <tr>\n        <td>File1.thermo.raw</td>\n        <td>1</td>\n        <td>1</td>\n        <td>channel.7</td>\n        <td>primary</td>\n        <td>mixture1</td>\n        <td>7</td>\n      </tr>\n      <tr>\n        <td>File1.thermo.raw</td>\n        <td>1</td>\n        <td>1</td>\n        <td>channel.8</td>\n        <td>metastasis</td>\n        <td>mixture1</td>\n        <td>8</td>\n      </tr>\n      <tr>\n        <td>File1.thermo.raw</td>\n        <td>1</td>\n        <td>1</td>\n        <td>channel.9</td>\n        <td>primary</td>\n        <td>mixture1</td>\n        <td>9</td>\n      </tr>\n      <tr>\n        <td>File1.thermo.raw</td>\n        <td>1</td>\n        <td>1</td>\n        <td>channel.10</td>\n        <td>metastasis</td>\n        <td>mixture1</td>\n        <td>10</td>\n      </tr>\n      <tr>\n        <td>File1.thermo.raw</td>\n        <td>1</td>\n        <td>1</td>\n        <td>channel.11</td>\n        <td>Norm</td>\n        <td>mixture1</td>\n        <td>100</td>\n      </tr>\n      <tr>\n        <td>File2.thermo.raw</td>\n        <td>1</td>\n        <td>1</td>\n        <td>channel.1</td>\n        <td>primary</td>\n        <td>mixture2</td>\n        <td>1</td>\n      </tr>\n      <tr>\n        <td>File2.thermo.raw</td>\n        <td>1</td>\n        <td>1</td>\n        <td>channel.2</td>\n        <td>metastasis</td>\n        <td>mixture2</td>\n        <td>2</td>\n      </tr>\n      <tr>\n        <td>File2.thermo.raw</td>\n        <td>1</td>\n        <td>1</td>\n        <td>channel.3</td>\n        <td>primary</td>\n        <td>mixture2</td>\n        <td>3</td>\n      </tr>\n      <tr>\n        <td>File2.thermo.raw</td>\n        <td>1</td>\n        <td>1</td>\n        <td>channel.4</td>\n        <td>metastasis</td>\n        <td>mixture2</td>\n        <td>4</td>\n      </tr>\n      <tr>\n        <td>File2.thermo.raw</td>\n        <td>1</td>\n        <td>1</td>\n        <td>channel.5</td>\n        <td>primary</td>\n        <td>mixture2</td>\n        <td>5</td>\n      </tr>\n      <tr>\n        <td>File2.thermo.raw</td>\n        <td>1</td>\n        <td>1</td>\n        <td>channel.6</td>\n        <td>metastasis</td>\n        <td>mixture2</td>\n        <td>6</td>\n      </tr>\n      <tr>\n        <td>File2.thermo.raw</td>\n        <td>1</td>\n        <td>1</td>\n        <td>channel.7</td>\n        <td>primary</td>\n        <td>mixture2</td>\n        <td>7</td>\n      </tr>\n      <tr>\n        <td>File2.thermo.raw</td>\n        <td>1</td>\n        <td>1</td>\n        <td>channel.8</td>\n        <td>metastasis</td>\n        <td>mixture2</td>\n        <td>8</td>\n      </tr>\n      <tr>\n        <td>File2.thermo.raw</td>\n        <td>1</td>\n        <td>1</td>\n        <td>channel.9</td>\n        <td>primary</td>\n        <td>mixture2</td>\n        <td>9</td>\n      </tr>\n      <tr>\n        <td>File2.thermo.raw</td>\n        <td>1</td>\n        <td>1</td>\n        <td>channel.10</td>\n        <td>metastasis</td>\n        <td>mixture2</td>\n        <td>10</td>\n      </tr>\n      <tr>\n        <td>File2.thermo.raw</td>\n        <td>1</td>\n        <td>1</td>\n        <td>channel.11</td>\n        <td>Norm</td>\n        <td>mixture2</td>\n        <td>100</td>\n      </tr>\n    </tbody>\n  </table>\n\n  <p>Normalization Channels are always labeled as “Norm” in Condition and get an arbitrary BioReplicate number. Since we want the Normalization channel to be a reference, it always has to be the same sample and therefore also should have the same BioReplicate number.\nIf you have empty channels, label them as “Empty” in the Condition column and also give them an arbitrary BioReplicate number.</p>\n\n  <p>Exercise:</p>\n\n  <p>How would the annotation file look like for the following experiment:\n27 samples (12 primary, 12 metastases samples from different patients + 3 reference samples) over 3 TMT experiments / mixtures. \nYou use Channels 1-8 in Exp1, 2-9 in Exp2 and 3-11 in Exp3. Your first used channel is always taken for the reference channel (Exp1: Channel1 = Norm, Exp2: Channel2 = Norm etc). \nYou fractionate all 3 experiments / mixtures into 3 fractions each and measure every MS sample twice (resulting in 18 measurements / raw files total).</p>\n\n  <p>The solution can be found on <a href=\"https://zenodo.org/record/5195800/files/annotation_exercise.txt\">Zenodo</a>.</p>\n</blockquote>\n\n<p>For more information on MSstats parameters and ideas on how to follow up with your MSstatsTMT results visit the <a href=\"/training-material/topics/proteomics/tutorials/maxquant-msstats-dda-lfq/tutorial.html\">label-free MSstats training</a>.</p>\n\n<h1 id=\"follow-up-on-msstatstmt-results\">Follow up on MSstatsTMT results</h1>\n\n<p>We obtain several output files from MSstatsTMT. MSstats log file contains the MSstats report with warnings and information about the analysis steps. \nThe QC report allows to visualize protein abundance of conditions for all proteins (first page) or if enabled for each individual protein (following pages).</p>\n\n<figure id=\"figure-1\" style=\"max-width: 90%;\"><img src=\"../../images/maxquant-msstats-tmt/QC_plot.png\" alt=\"QC report. \" width=\"768\" height=\"768\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/maxquant-msstats-tmt/QC_plot.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 1</strong>:</span> QC report for all samples, each boxplot summarizes the protein abundances of one sample</figcaption></figure>\n\n<p>The MSstatsTMT Group Comparison Plot is a very convenient pdf, which you can search for your favorite proteins of interest to check whether these are dysregulated between the conditions. The red error bar gives you a confidence interval of the fold change.</p>\n\n<figure id=\"figure-2\" style=\"max-width: 90%;\"><img src=\"../../images/maxquant-msstats-tmt/example_protein.png\" alt=\"Group comparison plot. \" width=\"944\" height=\"593\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/maxquant-msstats-tmt/example_protein.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 2</strong>:</span> Group comparison plot for the protein A5YKK6 (CCR4-NOT transcription complex subunit 1)</figcaption></figure>\n\n<p>The volcano plot plots the negative log10 of the adjusted P Value derived from statistical testing over the log2 fold change between the conditions you compared. A value of 3 on the y axis corresponds to an adjusted P Value of 0.001, whereas a value of 1 on the x axis corresponds to a ratio of 2 meaning that the protein is twice as high in condition 1 than condition 2..\nPlease bear in mind that TMT quantitation suffers from ratio compression. There are ways to calculate more accurate fold changes from measured data (or alternatively you can use MS3 quantitation on some machines). However, even with ratio compression, MS2 TMT is an excellent quantitation strategy to detect differentially regulated proteins. Just bear in mind that the reported fold chances of proteins are almost always smaller than the real fold changes between your conditions.</p>\n\n<figure id=\"figure-3\" style=\"max-width: 90%;\"><img src=\"../../images/maxquant-msstats-tmt/volcano_plot.png\" alt=\"Volcano plot. \" width=\"951\" height=\"578\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/maxquant-msstats-tmt/volcano_plot.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 3</strong>:</span> Volcano plot QC report for all samples, each boxplot summarizes the protein abundances of one sample</figcaption></figure>\n"],"ref_slides":[],"video_library":{"tutorial":null,"slides":null,"demo":null,"both":null,"session":null},"hands_on":true,"slides":false,"mod_date":"2023-11-03 14:30:27 +0000","pub_date":"2021-08-13 21:11:55 +0000","version":16,"workflows":[{"workflow":"main_workflow.ga","tests":false,"url":"https://training.galaxyproject.org/training-material/topics/proteomics/tutorials/maxquant-msstats-tmt/workflows/main_workflow.ga","path":"topics/proteomics/tutorials/maxquant-msstats-tmt/workflows/main_workflow.ga","wfid":"proteomics-maxquant-msstats-tmt","wfname":"main_workflow","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/proteomics-maxquant-msstats-tmt/versions/main_workflow","license":null,"creators":[],"name":"MaxQuant MSstatsTMT Training","title":"MaxQuant MSstatsTMT Training","test_results":null,"modified":"2024-06-13 08:34:27 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Collection\\nInput Dataset Collection\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"ℹ️ Input Dataset\\nExperimental design template\"];\n  style 1 stroke:#2c3143,stroke-width:4px;\n  2[\"ℹ️ Input Dataset\\nMSstats annotation file\"];\n  style 2 stroke:#2c3143,stroke-width:4px;\n  3[\"MaxQuant\"];\n  0 -->|output| 3;\n  1 -->|output| 3;\n  4[\"MSstatsTMT\"];\n  2 -->|output| 4;\n  3 -->|evidence| 4;\n  3 -->|proteinGroups| 4;"}],"api":"https://training.galaxyproject.org/training-material/api/topics/proteomics/tutorials/maxquant-msstats-tmt/tutorial.json","tools":["toolshed.g2.bx.psu.edu/repos/galaxyp/maxquant/maxquant/1.6.17.0+galaxy2","toolshed.g2.bx.psu.edu/repos/galaxyp/msstatstmt/msstatstmt/2.0.0+galaxy0"],"supported_servers":{"exact":[{"url":"https://usegalaxy.eu","name":"UseGalaxy.eu","usegalaxy":true},{"url":"https://usegalaxy.org.au","name":"UseGalaxy.org.au","usegalaxy":true}],"inexact":[{"url":"https://usegalaxy.cz/","name":"UseGalaxy.cz","usegalaxy":false}]},"topic_name_human":"Proteomics","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"maxquant","owner":"galaxyp","revisions":"e42225f8a659","tool_panel_section_label":"Proteomics","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"msstatstmt","owner":"galaxyp","revisions":"a5e394b36d87","tool_panel_section_label":"Proteomics","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: maxquant\n  owner: galaxyp\n  revisions: e42225f8a659\n  tool_panel_section_label: Proteomics\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: msstatstmt\n  owner: galaxyp\n  revisions: a5e394b36d87\n  tool_panel_section_label: Proteomics\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial"}