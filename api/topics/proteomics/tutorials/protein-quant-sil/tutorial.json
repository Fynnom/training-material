{"layout":"tutorial_hands_on","title":"Peptide and Protein Quantification via Stable Isotope Labelling (SIL)","zenodo_link":"https://zenodo.org/record/1051552","level":"Advanced","questions":["What are MS1 features?","How to quantify based on MS1 features?","How to map MS1 features to MS2 identifications?","How to evaluate and optimize the results?"],"objectives":["MS1 feature quantitation and mapping of quantitations to peptide and protein IDs."],"time_estimation":"1h","requirements":[{"type":"internal","topic_name":"proteomics","tutorials":["database-handling","protein-id-oms"]}],"key_points":["Peptides labelled with stable isotopes result in multiple parallel MS1 ion traces.","MS1 features can be used for relative protein quantitation.","Quantitations have to be mapped to PSMs.","PSM quantitations can be used to calculate protein quantitations.","Proper quantitation and mapping needs careful evaluation and optimization."],"contributors":[{"name":"Florian Christoph Sigloch","email":"sigloch+github@mailbox.org","joined":"2017-09","former_affiliations":["uni-freiburg"],"id":"stortebecker","url":"https://training.galaxyproject.org/training-material/api/contributors/stortebecker.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/stortebecker/"},{"name":"Björn Grüning","email":"bjoern.gruening@gmail.com","twitter":"bjoerngruening","fediverse":"https://fosstodon.org/@bgruening","fediverse_flavor":"mastodon","matrix":"bgruening:matrix.org","orcid":"0000-0002-3079-6586","elixir_node":"de","linkedin":"bgruening","contact_for_training":true,"joined":"2017-09","location":{"country":"DE","lat":47.997791,"lon":7.842609},"affiliations":["eurosciencegateway","eosc-life","by-covid","deNBI","sfb992","elixir-converge","uni-freiburg","elixir-europe"],"id":"bgruening","url":"https://training.galaxyproject.org/training-material/api/contributors/bgruening.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/bgruening/"},{"name":"Matthias Fahrner","email":"matthias.fahrner@uniklinik-freiburg.de","twitter":"mfahrner313","orcid":"0000-0001-7955-2518","joined":"2019-03","affiliations":["uni-freiburg"],"id":"matthias313","url":"https://training.galaxyproject.org/training-material/api/contributors/matthias313.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/matthias313/"}],"subtopic":"id-quant","tags":["DDA","SILAC"],"js_requirements":{"mathjax":8638,"mermaid":false},"short_id":"T00230","url":"/topics/proteomics/tutorials/protein-quant-sil/tutorial.html","topic_name":"proteomics","tutorial_name":"protein-quant-sil","dir":"topics/proteomics/tutorials/protein-quant-sil","symlink":null,"id":"proteomics/protein-quant-sil","ref_tutorials":["<p>To compare protein amounts in different samples from MS/MS data, two different experiment setups exist. Firstly, unmodified proteins can be measured in separate runs at one sample per MS-run. Secondly, proteins of samples to compare can be labelled with small chemical tags, mixed, and measured side-by-side in a single MS-run.\nThere are two types of chemical tags:</p>\n<ol>\n  <li>Isobaric tags display the same mass on first hand, but fragment during the generation of the MS/MS spectra to yield reporter ions of different mass. The intensity of those reporter ions can be compared in MS/MS spectra. There are two types of isobaric tags commercially available: <em>tandem mass tags</em> (TMT) and <em>isobaric tags for relative and absolute quantitation</em> (iTRAQ).</li>\n  <li>Isotopic tags are chemically identical, but differ in their mass due to incorporated stable isotopes. Examples of different isotopic tags for stable isotope labelling (SIL) are ICAT, SILAC, dimethylation, or heavy oxygen (<sup>18</sup>O).</li>\n</ol>\n\n<p>This tutorial deals with protein quantitation via stable isotope labelling (SIL). For isotopic tags, quantitation can be achieved by comparing the intensity of MS1 peptide mass traces. The whole MS1 profile of a peptide, i.e. the intensities of all its isotopic peaks over time, is called a <em>peptide feature</em> (Figure 1a).\nIncorporation of stable isotopes results in different peptide masses on MS1 level, which give rise to coeluting ion traces in the TIC with a mass difference typical for each different chemical tag (Figure 1b). Figure originally published in <a href=\"http://www.ncbi.nlm.nih.gov/pubmed/25931027\">Nilse et al, 2015</a>.</p>\n\n<p>In this tutorial, we will use tools of the <a href=\"http://www.openms.org\">OpenMS suite</a> to identify and quantify peptides and proteins.</p>\n\n<figure id=\"figure-1\" style=\"max-width: 90%;\"><img src=\"../../images/protein-quant-sil_ms1feature.png\" alt=\"ms1 feature. \" width=\"3265\" height=\"684\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/protein-quant-sil_ms1feature.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 1</strong>:</span> MS1 mass traces. A) Two peptide features of co-eluting SIL peptides. B) MS1 spectra at a given RT. C) XIC monoisotopic peak light peptide. D) XIC monoisotopic peak heavy peptide.</figcaption></figure>\n\n<h2 id=\"prerequisites\">Prerequisites</h2>\n\n<p>If you are in the planning phase of your quantitative proteomics experiment, you may want to consider our tutorial on different <a href=\"/training-material/topics/proteomics/tutorials/labelfree-vs-labelled/tutorial.html\">quantitation methods</a> first.</p>\n\n<p>To learn about <em>protein identification</em> in Galaxy, please consider our OpenMS-based <a href=\"/training-material/topics/proteomics/tutorials/protein-id-oms/tutorial.html\">peptide ID tutorial</a>.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Introduction</hands-on-title>\n  <p>In the hands-on section of this tutorial, we will use a quantitative comparison of HEK cell lysate as a test dataset. In this experiment, HEK cells were once labelled with light, once with heavy SILAC. Both cultures were lysed simultaneously and the cell lysates were mixed in a certain ratio.\nA detailed description of the full dataset is available in the <a href=\"https://www.ebi.ac.uk/pride/\">PRIDE archive</a>.</p>\n\n  <p>Your objective in this hands-on-tutorial is to find out the correct mixing ratio of the test sample.</p>\n\n  <p>To speed up analysis, the input dataset was filtered to include only those data acquired in second 2000-3000 of the original LC gradient.</p>\n</blockquote>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n  <p>In this tutorial, we will deal with:</p>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#prerequisites\" id=\"markdown-toc-prerequisites\">Prerequisites</a></li>\n  <li><a href=\"#peptide-and-protein-identification\" id=\"markdown-toc-peptide-and-protein-identification\">Peptide and Protein Identification</a></li>\n  <li><a href=\"#ms1-feature-detection\" id=\"markdown-toc-ms1-feature-detection\">MS1 Feature Detection</a></li>\n  <li><a href=\"#mapping-identifications-to-features\" id=\"markdown-toc-mapping-identifications-to-features\">Mapping Identifications to Features</a></li>\n  <li><a href=\"#descriptive-statistics-and-plotting-of-protein-quantitations\" id=\"markdown-toc-descriptive-statistics-and-plotting-of-protein-quantitations\">Descriptive Statistics and Plotting of Protein Quantitations</a></li>\n  <li><a href=\"#evaluation-and-optimization-of-quantitation-results\" id=\"markdown-toc-evaluation-and-optimization-of-quantitation-results\">Evaluation and Optimization of Quantitation Results</a>    <ol>\n      <li><a href=\"#examples\" id=\"markdown-toc-examples\">Examples</a></li>\n      <li><a href=\"#typical-problems\" id=\"markdown-toc-typical-problems\">Typical Problems</a></li>\n      <li><a href=\"#optimization-of-quantitation-results\" id=\"markdown-toc-optimization-of-quantitation-results\">Optimization of Quantitation Results</a></li>\n    </ol>\n  </li>\n</ol>\n\n</blockquote>\n\n<h1 id=\"peptide-and-protein-identification\">Peptide and Protein Identification</h1>\n\n<p>In this tutorial, peptide identification will be performed using the workflow of the previous <a href=\"/training-material/topics/proteomics/tutorials/protein-id-oms/tutorial.html\">Peptide ID Tutorial</a>. Alternatively one can perform the protein identification step by step in the <a href=\"/training-material/topics/proteomics/tutorials/protein-id-oms/tutorial.html\">Peptide ID Tutorial</a> using the SILAC dataset from <a href=\"https://zenodo.org/record/1051552\">zenodo</a> <strong>but</strong> beware to specify the labels in the <code class=\"language-plaintext highlighter-rouge\">param_variable_modifications</code> of <strong>XTandemAdapter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>.</p>\n\n<p>A common problem in mass spectrometry are misassigned mono-isotopic precursor peaks. Most search engines allow for some adaptation of the monoisotopic peak and we will use this by leaving <code class=\"language-plaintext highlighter-rouge\">By default, misassignment to the first and second isotopic 13C peak are also considered</code> at <code class=\"language-plaintext highlighter-rouge\">No</code>.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Data upload</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Create a new history for this SILAC Proteome exercise</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-new-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-new-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a new history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>Click the <i class=\"fas fa-plus\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">new-history</span> icon at the top of the history panel:</p>   <p><img src=\"/training-material/shared/images/history_create_new.svg\" alt=\"UI for creating new history\" /></p>   <!-- the original drawing can be found here https://docs.google.com/drawings/d/1cCBrLAo4kDGic5QyB70rRiWJAKTenTU8STsKDaLcVU8/edit?usp=sharing --> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Import the mzml file, containing the measured mass spectra from <a href=\"https://doi.org/10.5281/zenodo.1051552\">Zenodo</a> or a data library:</p>\n\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/1051552/files/HEK_SILAC-K6R6_ST905_part.mzml\n</code></pre></div>      </div>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-via-links\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-via-links\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing via links</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-data-from-a-data-library\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-data-from-a-data-library\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing data from a data library</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>As an alternative to uploading the data from a URL or your computer, the files may also have been made available from a <em>shared data library</em>:</p>   <ol>   <li>Go into <strong>Shared data</strong> (top panel) then <strong>Data libraries</strong></li>   <li>Navigate to  the correct folder as indicated by your instructor.     <ul>       <li>On most Galaxies tutorial data will be provided in a folder named <strong>GTN - Material –&gt; Topic Name -&gt; Tutorial Name</strong>.</li>     </ul>   </li>   <li>Select the desired files</li>   <li>Click on <strong>Add to History</strong> <i class=\"fas fa-caret-down\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-dropdown</span> near the top and select <strong>as Datasets</strong> from the dropdown menu</li>   <li>     <p>In the pop-up window, choose</p>     <ul>       <li><em>“Select history”</em>: the history you want to import the data to (or create a new one)</li>     </ul>   </li>   <li>Click on <strong>Import</strong></li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <blockquote class=\"comment\">\n        <comment-title></comment-title>\n        <p>The data have been preprocessed during the conversion from the machine raw file. We used background removal on MS1 and MS2 level, and MS2 deisotoping.</p>\n      </blockquote>\n    </li>\n    <li>\n      <p>Import the human protein database (including cRAP contaminants and decoys) from <a href=\"https://zenodo.org/record/892005/files/Human_database_including_decoys_%28cRAP_added%29.fasta\">zenodo</a> or a data library:</p>\n\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/892005/files/Human_database_including_decoys_%28cRAP_added%29.fasta\n</code></pre></div>      </div>\n    </li>\n    <li>\n      <p>Import the <a href=\"/training-material/topics/proteomics/tutorials/protein-id-oms/workflows/workflow.ga\">workflow</a></p>\n\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://training.galaxyproject.org//training-material/topics/proteomics/tutorials/protein-id-oms/workflows/workflow.ga\n</code></pre></div>      </div>\n    </li>\n    <li>\n      <p>Modify the workflow</p>\n    </li>\n    <li>Connect the <code class=\"language-plaintext highlighter-rouge\">mzML</code> input directly to the <strong>XTandemAdapter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> node and delete <strong>PeakPickerHiRes</strong>.</li>\n    <li>\n      <p>Change the <strong>XTandemAdapter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> parameters: Add the <strong>param_variable_modifications</strong> <code class=\"language-plaintext highlighter-rouge\">Label:13C(6) (K)</code> and <code class=\"language-plaintext highlighter-rouge\">Label:13C(6) (R)</code></p>\n    </li>\n    <li>Run the workflow with\n      <ul>\n        <li>the mzML dataset <code class=\"language-plaintext highlighter-rouge\">1: mzML dataset</code></li>\n        <li>the human FASTA database <code class=\"language-plaintext highlighter-rouge\">2: protein FASTA database</code></li>\n      </ul>\n    </li>\n  </ol>\n\n  <blockquote class=\"tip\">\n    <tip-title>Using Galaxy Workflows</tip-title>\n    <p>If you want to learn more about Galaxy workflows, please consult the <a href=\"/training-material/topics/introduction/tutorials/galaxy-intro-101/tutorial.html#the-workflow-editor\">Galaxy Introduction</a></p>\n  </blockquote>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n  <ol>\n    <li>How many peptides and proteins were successfully identified?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n    <ol>\n      <li>2217 non-redundant peptides and 763 proteins were identified.\nNumbers may slightly vary depending on the versions of the tools and the used FASTA file.</li>\n    </ol>\n  </blockquote>\n</blockquote>\n\n<h1 id=\"ms1-feature-detection\">MS1 Feature Detection</h1>\n\n<p>MS1 feature detection is a critical step in quantitative workflows. In principle, there are two different ways to define features:</p>\n<ol>\n  <li>Feature detection solely based upon MS1 data (mzML/raw files) without prior knowledge of peptide identifications (IDs).\n    <ul>\n      <li>Advantage: Feature results can be used to assist in peptide identification.</li>\n      <li>Drawback: Not all peptide identifications can be mapped to features, thus not every identified peptide can be quantified.</li>\n    </ul>\n  </li>\n  <li>Feature detection based upon peptide IDs.\n    <ul>\n      <li>Advantage: Most peptide IDs trigger a feature detection.</li>\n      <li>Drawback: Feature results cannot be used to improve peptide ID.</li>\n    </ul>\n  </li>\n</ol>\n\n<p>The OpenMS suite provides several tools (FeatureFinders) for MS1 feature detection. For SIL we have to use <strong>FeatureFinderMultiplex</strong>, which does not take peptide IDs as an input.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>MS1 Feature Detection</hands-on-title>\n\n  <ol>\n    <li>Run <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/galaxyp/openms_featurefindermultiplex/FeatureFinderMultiplex/2.6+galaxy0\" title=\"FeatureFinderMultiplex tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>FeatureFinderMultiplex</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.6+galaxy0)</span> with\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“LC-MS dataset in centroid or profile mode”</em>: mzML file</li>\n        <li>In <em>“algorithmic parameters”</em>\n          <ul>\n            <li><em>“Labels used for labelling the samples”</em>: <code class=\"language-plaintext highlighter-rouge\">[ ][Arg6,Lys6]</code></li>\n            <li><em>“m/z tolerance for search of peak patterns”</em>: <code class=\"language-plaintext highlighter-rouge\">10</code></li>\n            <li><em>“Maximum number of missed cleavages due to incomplete digestion”</em>: <code class=\"language-plaintext highlighter-rouge\">1</code></li>\n          </ul>\n        </li>\n        <li><em>“Optional outputs”</em>: <code class=\"language-plaintext highlighter-rouge\">out_multiplets (Optional output file containing all detected peptide groups</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"comment\">\n  <comment-title>Multiple labels per peptide</comment-title>\n  <p>When using SILAC-KR or dimethyl-labelling and trypsin digestion, exactly one labelled amino acid per peptide is expected. The only labelled amino acids are lysine (K) and arginine (R) and trypsin cuts after each of them. However, a small percentage of missed cleavage normally occur also in those datasets. Setting <em>“Maximum number of missed cleavages due to incomplete digestion”</em> to <code class=\"language-plaintext highlighter-rouge\">1</code> will be sufficient to deal with most missed cleavages.</p>\n\n  <p>When using other enzymes (e.g. Lys-C) or other labels (e.g. \\(^{18}O\\)), several labelled amino acids per peptide are expected. You can search for those features by increasing the parameter <em>“Maximum number of missed cleavages due to incomplete digestion”</em>.</p>\n</blockquote>\n\n<h1 id=\"mapping-identifications-to-features\">Mapping Identifications to Features</h1>\n\n<p>We now have feature quantifications for MS1 elution peaks, peptide identifications for the MS2 spectra and protein identifications.\nThe next step is to map the MS2-based peptide identifications to the quantified MS1 precursor peaks (“peptide features”). This will enable the quantification of identified peptides.\nFor labelled data, it is necessary to map peptide identifications to <em>consensus</em> features (i.e. a pair of one light peptide feature with one matching heavy feature in the correct m/z distance).\nFor <code class=\"language-plaintext highlighter-rouge\">consensusXML</code>, IDMapper uses the consensus centroids, not the feature boundaries for mapping. Therefore, the RT tolerance has to be set higher than for mapping to <code class=\"language-plaintext highlighter-rouge\">featureXML</code>. A good starting value is half the expected typical retention time.</p>\n\n<p>Sometimes several peptide identifications are mapped to a feature. The tool <a href=\"http://ftp.mi.fu-berlin.de/pub/OpenMS/release-documentation/html/TOPP_IDConflictResolver.html\">IDConflictResolver</a> filters the mapping so that only the identification with the best score is associated to each feature.\nAnother refinement of the quantitative result is obtained by removing falsely mapped identifications e.g. light identification mapped to heavy feature. This step is performed by the <strong>MultiplexResolver</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> that returns a first file with the correctly mapped peptides and as a second output the falsly mapped peptides.</p>\n\n<p>Finally, the correctly mapped peptides will be combined into protein quantifications with the <strong>ProteinQuantifier</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Quant to ID matching</hands-on-title>\n\n  <ol>\n    <li>Run <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/galaxyp/openms_idmapper/IDMapper/2.6+galaxy0\" title=\"IDMapper tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>IDMapper</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.6+galaxy0)</span> with\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Protein/peptide identifications file”</em>: output of <strong>FalseDiscoveryRate</strong></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Feature map/consensus map file”</em>: output of <strong>FeatureFinderMultiplex</strong></li>\n        <li><em>“RT tolerance (in seconds) for the matching of peptide identifications and (consensus) features”</em>: <code class=\"language-plaintext highlighter-rouge\">20</code></li>\n        <li><em>“m/z tolerance (in ppm or Da) for matching of peptide identifications and (consensus) features”</em>: <code class=\"language-plaintext highlighter-rouge\">10</code></li>\n        <li>In <em>“Additional options for consensusXML input”</em>\n          <ul>\n            <li><em>“Match using RT and m/z of sub-features instead of consensus RT and m/z”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n            <li><em>“Store the map index of the sub-feature in the peptide ID”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>Run <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/galaxyp/openms_idconflictresolver/IDConflictResolver/2.6+galaxy0\" title=\"IDConflictResolver tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>IDConflictResolver</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.6+galaxy0)</span> with\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input file”</em>: output of <strong>IDMapper</strong></li>\n      </ul>\n    </li>\n    <li>Run <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/galaxyp/openms_multiplexresolver/MultiplexResolver/2.5+galaxy0\" title=\"MultiplexResolver tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>MultiplexResolver</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.5+galaxy0)</span> with\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Peptide multiplets with assigned sequence information”</em>: output of <strong>IDConflictResolver</strong></li>\n        <li><em>“Labels used for labelling the samples”</em>: <code class=\"language-plaintext highlighter-rouge\">[ ][Arg6,Lys6]</code></li>\n        <li><em>“Maximum number of missed cleavages due to incomplete digestion”</em>: <code class=\"language-plaintext highlighter-rouge\">1</code></li>\n      </ul>\n    </li>\n    <li>Run <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/galaxyp/openms_proteinquantifier/ProteinQuantifier/2.6+galaxy0\" title=\"ProteinQuantifier tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>ProteinQuantifier</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.6+galaxy0)</span> with\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input file”</em>: first output of <strong>MultiplexResolver</strong></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Protein inference results”</em>: output of <strong>FalseDiscoveryRate</strong></li>\n        <li><em>“Calculate protein abundance from this number of proteotypic peptides (most abundant first; ‘0’ for all)”</em>: <code class=\"language-plaintext highlighter-rouge\">0</code></li>\n        <li><em>“Averaging method used to compute protein abundances from peptide abundances”</em>: <code class=\"language-plaintext highlighter-rouge\">sum</code></li>\n        <li><em>“Add the log2 ratios of the abundance values to the output”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        <li><em>“Optional outputs”</em>: <code class=\"language-plaintext highlighter-rouge\">out (Output file for protein abundances)</code> and <code class=\"language-plaintext highlighter-rouge\">peptide_out (Output file for peptide abundances)</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"comment\">\n  <comment-title>ProteinQuantifier parameters</comment-title>\n  <p>Peptide quantitation algorithms are more precise for high abundant peptides. Therefore, it is recommended to base protein quantitations on those peptides. In ProteinQuantifier, you may restrict the calculation of protein abundances to the most abundant peptides by using the option “Calculate protein abundance from this number of proteotypic peptides”.\nHowever, we recommend to use the averaging method <code class=\"language-plaintext highlighter-rouge\">sum</code> instead. By using this option, protein ratios are based on the sum of all peptide abundances. Thus, highly abundant peptides thus have more influence on protein abundance calculation than low abundant peptides.\nA simple sum-of-intensities algorithm provided the best estimates of true protein ratios in a comparison of several protein quantitation algorithms (<a href=\"https://www.ncbi.nlm.nih.gov/pubmed/19892804\">Carrillo et al., Bioinformatics, 2009</a>).</p>\n</blockquote>\n\n<h1 id=\"descriptive-statistics-and-plotting-of-protein-quantitations\">Descriptive Statistics and Plotting of Protein Quantitations</h1>\n\n<p><strong>ProteinQuantifier</strong> produces two output tables: the first one gives information about the quantified proteins, the second one gives information about the quantified peptides.\nFor proteins, we added a log-transformed ratio to the output, which is saved in column 8 of the protein table. The ratio is calculated as <strong>log2 (abundance2/abundance1)</strong>, which is sometimes called the <em>fold change (FC)</em> ratio.</p>\n\n<p>To get a quick overview of the results, you can calculate basic descriptive statistics and plot the data as a histogram.\nComment lines in the beginning of a <code class=\"language-plaintext highlighter-rouge\">tabular</code> file may sometimes cause errors, therefore we will remove them with the tool <strong>Select last lines from a dataset (tail)</strong>.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Descriptive Statistics</hands-on-title>\n  <ol>\n    <li>Run <span class=\"tool\" data-tool=\"Summary_Statistics1\" title=\"Summary Statistics tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Summary Statistics</strong></span> with\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Summary statistics on”</em>: protein table output (first file) of <strong>ProteinQuantifier</strong></li>\n        <li><em>“Column or expression”</em>: <code class=\"language-plaintext highlighter-rouge\">c8</code></li>\n      </ul>\n    </li>\n    <li>Run <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_tail_tool/1.1.0\" title=\"Select last lines from a dataset (tail) tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Select last lines from a dataset (tail)</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.1.0)</span> with\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Text file”</em>: protein table output (first file) of <strong>ProteinQuantifier</strong></li>\n        <li><em>“Operation”</em>: <code class=\"language-plaintext highlighter-rouge\">Keep everything from this line on</code></li>\n        <li><em>“Number of lines”</em>: <code class=\"language-plaintext highlighter-rouge\">4</code></li>\n      </ul>\n    </li>\n    <li>Run <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/devteam/histogram/histogram_rpy/1.0.4\" title=\"Histogram tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Histogram</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.0.4)</span> with\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Dataset”</em>: output of <strong>Select last</strong></li>\n        <li><em>“Numerical column for x axis”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 8</code></li>\n        <li><em>“Number of breaks (bars)”</em>: <code class=\"language-plaintext highlighter-rouge\">20</code></li>\n        <li><em>“Plot title”</em> and <em>“Label for x axis”</em> to something meaningful.</li>\n      </ul>\n    </li>\n  </ol>\n\n  <blockquote class=\"comment\">\n    <comment-title>Calculating descriptive statistics for peptides</comment-title>\n    <p>The peptide table output of <strong>ProteinQuantifier</strong> does not give the log-transformed ratio for each peptide. Nonetheless, you may calculate basic statistics of the FC values by running <strong>Summary Statistics</strong> with <em>“Column or expression”</em> set to <code class=\"language-plaintext highlighter-rouge\">log(c6/c5,2)</code>.</p>\n  </blockquote>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n  <ol>\n    <li>How many peptides and proteins were successfully quantified?</li>\n    <li>What might have been the mixing ratio of the input dataset?</li>\n    <li>In the histogram, there is a second local maximum at about FC 0. What might that mean?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n    <ol>\n      <li>With the above parameters, you should have quantified 870 peptides and 421 proteins (slight variations are expected depending on tool version or fasta file)</li>\n      <li>In the histogram, you see that the peak of the density curve is between -1.1 and -1.2. In the summary statistics, you can see that the mean protein ratio was -0.98. An FC of -1 indicates that the unlabelled proteins were twice as abundant as their heavy-labelled counterparts. Indeed, the mixing ratio of the dataset was 2 parts light labelled HEK cell lysate and 1 part heavy labelled HEK cell lysate.</li>\n      <li>Some proteins were quantified with an FC close to 0. These may stem from incomplete SILAC labelling. Even after two weeks of cell culture in SILAC medium, some proteins with a very low turnover rate may remain unlabelled.</li>\n    </ol>\n  </blockquote>\n</blockquote>\n\n<h1 id=\"evaluation-and-optimization-of-quantitation-results\">Evaluation and Optimization of Quantitation Results</h1>\n\n<p>Protein quantitation is a multi-step procedure. Many parameters of different steps influence the final results. Therefore, it is recommended to optimize the tool parameters for each dataset and to carefully evaluate quantitation results. While the total number of quantified proteins is a first important parameter for optimization, it is also necessary to visualize the results and check for correct feature finding and ID mapping.</p>\n\n<p>Galaxy does not provide a tool for proteomics visualization, we recommend to use the OpenMS Viewer <strong>TOPPView</strong>.\nBasic TOPPView tutorials are available as <a href=\"https://www.openms.de/getting-started/command-line-and-visualisations/\">videos</a> and a more comprehensive tutorial as <a href=\"http://ftp.mi.fu-berlin.de/pub/OpenMS/release-documentation/html/TOPP_TOPPView.html\">HTML</a> or <a href=\"http://ftp.mi.fu-berlin.de/pub/OpenMS/release-documentation/TOPP_tutorial.pdf\">PDF</a>.</p>\n\n<p>For the optimization of tool parameters, it is recommended not to work with a complete LC-MS/MS run. Instead, we will use <strong>FileFilter</strong> to extract a small <em>RT-slice</em> of our input dataset, i.e. a fraction of the original dataset that was measured during a short period of time. Reducing the test data reduces the time needed for analysis and facilitates visual examination of the data.</p>\n\n<p>Using Galaxy Workflows enables us to quickly re-run a full analysis with changed parameters. To learn about Galaxy Workflows, consult this <a href=\"/training-material/topics/galaxy-interface/tutorials/history-to-workflow/tutorial.html\">tutorial</a>.</p>\n\n<p><strong>Cave:</strong> Be aware that only very small parts of your dataset can be checked by visual examination. To minimize biases, try to look at the same areas / features of each result file.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Data reduction and visual evaluation with TOPPView</hands-on-title>\n\n  <ol>\n    <li>Run <strong>FileFilter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input file”</em>: <code class=\"language-plaintext highlighter-rouge\">mzML</code> file</li>\n        <li><em>“Retention time range to extract”</em>: <code class=\"language-plaintext highlighter-rouge\">2000:2200</code></li>\n      </ul>\n    </li>\n    <li>\n      <p>Extract a workflow out of your history or import the <a href=\"/training-material/topics/proteomics/tutorials/protein-id-oms/workflows/workflow.ga\">premade workflow</a></p>\n    </li>\n    <li>\n      <p>Run the whole workflow again with default settings on the reduced <code class=\"language-plaintext highlighter-rouge\">mzML</code> file.</p>\n    </li>\n    <li>Run <strong>FileFilter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input file”</em>: <strong>IDConflictResolver</strong> output</li>\n        <li><em>“Remove features without annotations”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n      </ul>\n    </li>\n    <li>\n      <p>Rename the <strong>FileFilter</strong> output to <code class=\"language-plaintext highlighter-rouge\">Annotated features</code></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-renaming-a-dataset\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-renaming-a-dataset\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Renaming a dataset</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, change the <strong>Name</strong> field</li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>Run <strong>FileFilter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input file”</em>: <strong>IDConflictResolver</strong> output</li>\n        <li><em>“Remove features without annotations”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n      </ul>\n    </li>\n    <li>\n      <p>Rename the <strong>FileFilter</strong> output to <code class=\"language-plaintext highlighter-rouge\">UNannotated features</code></p>\n    </li>\n    <li>Download locally the following files:\n      <ul>\n        <li>Spectra: <code class=\"language-plaintext highlighter-rouge\">mzML</code> file</li>\n        <li>peptide IDs: <strong>IDScoreSwitcher</strong> <code class=\"language-plaintext highlighter-rouge\">idXML</code> output file</li>\n        <li>features: <strong>FeatureFinderMultiplex</strong> <code class=\"language-plaintext highlighter-rouge\">featureXML</code> output file</li>\n        <li>consensus features: <strong>FileFilter</strong> <code class=\"language-plaintext highlighter-rouge\">consensusXML</code> output files (“Annotated” and “UNannotated” features)</li>\n      </ul>\n    </li>\n    <li>Open <strong>TOPPView</strong></li>\n    <li>Open the <code class=\"language-plaintext highlighter-rouge\">mzML</code> file in <strong>TOPPView</strong> with\n      <ul>\n        <li><strong>Open as</strong> set to <code class=\"language-plaintext highlighter-rouge\">new window</code></li>\n        <li><strong>Map view</strong> set to <code class=\"language-plaintext highlighter-rouge\">2D</code></li>\n        <li><strong>Low intensity cutoff</strong> set to <code class=\"language-plaintext highlighter-rouge\">off</code></li>\n      </ul>\n    </li>\n    <li>Open all other downloaded files in <strong>TOPPView</strong> with\n      <ul>\n        <li><strong>Open as</strong> set to <code class=\"language-plaintext highlighter-rouge\">new layer</code></li>\n      </ul>\n    </li>\n    <li>Activate the <code class=\"language-plaintext highlighter-rouge\">mzML</code> layer and click on <code class=\"language-plaintext highlighter-rouge\">Show projections</code></li>\n  </ol>\n\n  <figure id=\"figure-2\" style=\"max-width: 90%;\"><img src=\"../../images/protein-quant-sil_showProjections.png\" alt=\"showProjections. \" width=\"1265\" height=\"692\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/protein-quant-sil_showProjections.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 2</strong>:</span> The projections display intensities plotted against RT (top panel) and plotted against m/z (right panel).</figcaption></figure>\n\n  <ol>\n    <li>Activate the <code class=\"language-plaintext highlighter-rouge\">consensusXML</code> layers and click on <code class=\"language-plaintext highlighter-rouge\">Show consensus feature element positions</code></li>\n  </ol>\n\n  <figure id=\"figure-3\" style=\"max-width: 90%;\"><img src=\"../../images/protein-quant-sil_showConsensus.png\" alt=\"showConsensus. \" width=\"1396\" height=\"214\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/protein-quant-sil_showConsensus.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 3</strong>:</span> Arrows between linked light and heavy features centroids are displayed.</figcaption></figure>\n\n  <ol>\n    <li>Evaluate your data analysis, by\n      <ul>\n        <li>zooming into a specific region (hold <code class=\"language-plaintext highlighter-rouge\">Ctrl</code> and use the mouse to zoom)</li>\n        <li>measuring m/z and RT distances (select the <code class=\"language-plaintext highlighter-rouge\">mzML</code> layer, hold <code class=\"language-plaintext highlighter-rouge\">Shift</code> and use the mouse to measure)</li>\n        <li>displaying an area in 3D view (<code class=\"language-plaintext highlighter-rouge\">right-click</code> into the 2D View and select <code class=\"language-plaintext highlighter-rouge\">Switch to 3D view</code>)</li>\n        <li>switching on and off the display of single layers (<code class=\"language-plaintext highlighter-rouge\">left-click</code> at the tick-boxes in the window “Layers”)</li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<h2 id=\"examples\">Examples</h2>\n\n<ol>\n  <li>\n    <p><strong>Displaying annotated vs. UNannotated features</strong>: visualize annotated (= mapped) and unannotated (= unmapped) features by switching between activating only the “Annotated_features.consensusxml” or only the “UNannotated_features.consensusxml” layer</p>\n\n    <figure id=\"figure-4\" style=\"max-width: 90%;\"><img src=\"../../images/protein-quant-sil_example_featureAnnotation.png\" alt=\"displaying feature annotations. \" width=\"2496\" height=\"565\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/protein-quant-sil_example_featureAnnotation.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 4</strong>:</span> The feature below was mapped to and annotated with a peptide identification, the feature above was not mapped. A) Annotated layer is active. B) UNannotated layer is active.</figcaption></figure>\n  </li>\n  <li>\n    <p><strong>Correct mapping</strong>: a feature was detected, a peptide was identified and the two were mapped.</p>\n\n    <figure id=\"figure-5\" style=\"max-width: 90%;\"><img src=\"../../images/protein-quant-sil_example_highAbundant.png\" alt=\"Correct mapping of a high-abundant peptide. \" width=\"1772\" height=\"584\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/protein-quant-sil_example_highAbundant.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 5</strong>:</span> A high-abundant peptide. A) 2D View. B) 3D View.</figcaption></figure>\n    <figure id=\"figure-6\" style=\"max-width: 90%;\"><img src=\"../../images/protein-quant-sil_example_lowAbundant.png\" alt=\"Correct mapping of a low-abundant peptide. \" width=\"1802\" height=\"611\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/protein-quant-sil_example_lowAbundant.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 6</strong>:</span> A low-abundant peptide. A) 2D View. B) 3D View.</figcaption></figure>\n  </li>\n  <li>\n    <p><strong>No feature detected for a contaminant.</strong> Contaminants are often not labelled, but occur only in their unlabelled isoform. Therefore, they do not give rise to a consensus feature in FeatureFinderMultiplex.</p>\n\n    <figure id=\"figure-7\" style=\"max-width: 90%;\"><img src=\"../../images/protein-quant-sil_example_contaminant.png\" alt=\"contaminant. \" width=\"1893\" height=\"591\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/protein-quant-sil_example_contaminant.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 7</strong>:</span> A contaminant. There are no elution peaks for the heavy labelled peptide isoform. A) 2D View. B) 3D View.</figcaption></figure>\n  </li>\n</ol>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Check a possible contaminant</hands-on-title>\n  <ol>\n    <li>Run <strong>TextExporter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input file”</em>: <strong>IDFilter</strong> output file</li>\n      </ul>\n    </li>\n    <li>Run <strong>Search in textfiles (grep)</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span><em>“Select lines from”</em>: output of <strong>TextExporter</strong></li>\n        <li><em>“Regular Expression”</em>: the peptide sequence (e.g. <code class=\"language-plaintext highlighter-rouge\">MFLSFPTTK</code>)</li>\n      </ul>\n    </li>\n    <li>Check if the peptide was mapped to a protein marked with “CONTAMINANT”.</li>\n  </ol>\n</blockquote>\n\n<h2 id=\"typical-problems\">Typical Problems</h2>\n\n<p>Three problems typically hamper correct peptide mapping:</p>\n\n<ol>\n  <li>\n    <p><strong>A feature is detected, but no peptide identification is nearby.</strong></p>\n\n    <ul>\n      <li><em>Possible cause</em>: This may be caused by imperfect peptide identification. However, it is never expected that every single MS2-spectrum leads to an identification. The protein might be missing in the database, or the peptide may carry a modification that was not included in the search.</li>\n      <li><em>Possible solution</em>: Improve your search engine settings.</li>\n    </ul>\n\n    <figure id=\"figure-8\" style=\"max-width: 90%;\"><img src=\"../../images/protein-quant-sil_problem_noID.png\" alt=\"noID. \" width=\"1267\" height=\"692\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/protein-quant-sil_problem_noID.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 8</strong>:</span> Several features without peptide IDs. Several MS2 spectra were generated (fragment scan precursors marked with red circles), but did not lead to a peptide identification.</figcaption></figure>\n  </li>\n  <li>\n    <p><strong>A peptide was identified, but no feature is nearby.</strong></p>\n\n    <ul>\n      <li><em>Possible cause</em>:\n        <ol>\n          <li>The elution peaks of the peptide may be distorted. This is typical for low intensity peptides. If a lot of peptides have distorted elution peaks this may be a sign of spray instability.</li>\n          <li>The peptide is a contaminant.</li>\n        </ol>\n      </li>\n      <li><em>Possible solution</em>:\n        <ol>\n          <li>Lower the FeatureFinderMultiplex parameters <strong>Two peptides in a multiplet are expected to have the same isotopic pattern</strong> and/or <strong>The isotopic pattern of a peptide should resemble the averagine model at this m/z position</strong> or broaden the <strong>Range of isotopes per peptide in the sample</strong> (in <strong>Advanced Options</strong>).</li>\n          <li>No optimization of parameters is needed (see <a href=\"#examples\">example above</a>)</li>\n        </ol>\n      </li>\n    </ul>\n\n    <figure id=\"figure-9\" style=\"max-width: 90%;\"><img src=\"../../images/protein-quant-sil_problem_noFeature.png\" alt=\"noID. \" width=\"1793\" height=\"586\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/protein-quant-sil_problem_noFeature.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 9</strong>:</span> A peptide was identified in its unlabelled and in its labelled isoform, but no feature was detected. A) 2D View. No third isotopic peak was detected for the labelled peptide. B) 3D View.</figcaption></figure>\n  </li>\n  <li>\n    <p><strong>A peptide was identified and a feature was detected nearby, but the two are not mapped to each other.</strong></p>\n\n    <ul>\n      <li><em>Possible cause</em>:\n        <ol>\n          <li>The MS2 event and the feature are too far apart to be mapped.</li>\n          <li>The precursor of the MS2 was not correctly assigned to the mono-isotopic peak.</li>\n          <li>The detected feature is too small in RT dimension and covers only a part of the peptide peaks.</li>\n        </ol>\n      </li>\n      <li><em>Possible solution</em>:\n        <ol>\n          <li>Increase the IDMapper parameter <strong>RT tolerance (in seconds) for the matching of peptide identifications and (consensus) features</strong>.</li>\n          <li>Feature size in RT dimension cannot be directly corrected, use solution 1 instead.</li>\n        </ol>\n      </li>\n    </ul>\n\n    <figure id=\"figure-10\" style=\"max-width: 90%;\"><img src=\"../../images/protein-quant-sil_problem_noMapping.png\" alt=\"noMapping. \" width=\"1833\" height=\"589\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/protein-quant-sil_problem_noMapping.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 10</strong>:</span> A feature was detected, but the RT dimension is shorter than the peptides's elution peak. Also, the 2nd isotopic peak was fragmented and was not corrected due to the short feature. A) 2D View. B) 3D View.</figcaption></figure>\n  </li>\n</ol>\n\n<p>Two problems typically disturb correct peptide quantitation:</p>\n\n<ol>\n  <li><strong>A peptide is mapped to the wrong feature.</strong>\n    <ul>\n      <li><em>Possible cause</em>: Co-eluting peptides of a similar mass may be falsely mapped to a nearby feature, if the correct peptide did not lead to an identification or was identified only with a low score. In <em>high-resolution data</em>, this problem of is very limited. Co-eluting peptides can normally be distinguished by slightly different m/z values. In <em>low-resolution data</em>, wrong assignment may occur more often.</li>\n      <li><em>Possible solution</em>: If a high value is used for the precursor mass tolerance, try to keep the RT tolerance low to avoid false mapping.</li>\n    </ul>\n  </li>\n  <li><strong>Background noise (1) or co-eluting peptides (2) are incorporated in a feature.</strong>\n    <ul>\n      <li><em>Possible solution</em>:\n        <ol>\n          <li>Use noise-filtering either during pre-processing or by increasing the FeatureFinderMultiplex parameter <strong>Lower bound for the intensity of isotopic peaks</strong></li>\n          <li>Reduce the FeatureFinderMultiplex parameter <strong>m/z tolerance for search of peak patterns</strong>.</li>\n        </ol>\n      </li>\n    </ul>\n  </li>\n</ol>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n  <ol>\n    <li>How many peptides could not be mapped to MS1 features? (Click on the <strong>IDMapper</strong> output and look at the tool’s infobox.)</li>\n    <li>How many features could not be mapped to a peptide identification? (Click on the <strong>ProteinQuantifier</strong> output and look at the tool’s infobox.)</li>\n    <li>Which problems are most prominent in the test dataset?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n    <ol>\n      <li>1,395 peptide IDs could not be mapped to a feature.</li>\n      <li>1,898 features, corresponding to 949 consensus features could not be mapped to a peptide identification.</li>\n      <li>The mapping of peptide IDs to features seems to have worked mostly fine. The main problems seem to be (1) missing peptide identifications, (2) missing features where a peptide was identified and (3) features that span a shorter RT range than the corresponding peptide’s elution peak.</li>\n    </ol>\n  </blockquote>\n</blockquote>\n\n<h2 id=\"optimization-of-quantitation-results\">Optimization of Quantitation Results</h2>\n\n<p>For optimization, it is critical to modify <strong>only one parameter at a time</strong>.\nAlso, it is recommended to optimize the tools in the order of their position in the workflow.</p>\n\n<p>In the test dataset, several peptides were identified, but not quantified. Some of the peptides were even identified in the unlabelled, as well as in the labelled form. To optimize the feature detection, we will relax the parameters of FeatureFinderMultiplex.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Optimize Feature Detection</hands-on-title>\n\n  <ol>\n    <li>Run the whole workflow again:\n      <ul>\n        <li>Change the <strong>FeatureFinderMultiplex</strong> parameter <em>“Range of isotopes per peptide in the sample”</em> from <code class=\"language-plaintext highlighter-rouge\">3:6</code> to <code class=\"language-plaintext highlighter-rouge\">2:6</code>.</li>\n      </ul>\n    </li>\n    <li>Integrate the <strong>HighResPrecursorMassCorrector</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> into the workflow.\n      <ul>\n        <li>Use the mzML file and the featureXML from the <strong>FeatureFinderMultiplex</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> as input</li>\n        <li>Set <strong>Additional retention time tolerance added to feature boundaries</strong> between <code class=\"language-plaintext highlighter-rouge\">0.0</code> and <code class=\"language-plaintext highlighter-rouge\">10.0</code></li>\n        <li>Connect the output with the search engine.</li>\n      </ul>\n    </li>\n    <li>Compare the number of identified proteins, unmatched features and unmapped peptides for each parameter setting.</li>\n    <li>Visualize the results with TOPPView to check for correct feature detection and feature-to-peptide mapping.</li>\n  </ol>\n\n  <blockquote class=\"tip\">\n    <tip-title>Sending workflow results to new history</tip-title>\n    <p>When running a workflow, you may send the results to a new history. This helps keeping track of different parameter settings.</p>\n  </blockquote>\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n  <p>Which parameter improved the number of quantified proteins?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n    <p>Both changes led to more quantified proteins. Increasing the isotope range led to 26 \\% more protein quantitations, increasing the RT tolerance led to 7 \\% more protein quantitations.</p>\n  </blockquote>\n</blockquote>\n"],"ref_slides":[],"hands_on":true,"slides":false,"mod_date":"2023-11-03 14:30:27 +0000","pub_date":"2017-03-17 17:43:31 +0000","version":66,"workflows":[{"workflow":"workflow.ga","tests":true,"url":"https://training.galaxyproject.org/training-material/topics/proteomics/tutorials/protein-quant-sil/workflows/workflow.ga","path":"topics/proteomics/tutorials/protein-quant-sil/workflows/workflow.ga","wfid":"proteomics-protein-quant-sil","wfname":"workflow","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/proteomics-protein-quant-sil/versions/workflow","license":null,"creators":[],"name":"Proteomics: Peptide and Protein Quantification via stable istobe labeling","title":"Proteomics: Peptide and Protein Quantification via stable istobe labeling","test_results":null,"modified":"2024-06-20 10:21:37 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\nmzml raw file\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"ℹ️ Input Dataset\\nfasta file\"];\n  style 1 stroke:#2c3143,stroke-width:4px;\n  2[\"FeatureFinderMultiplex\"];\n  0 -->|output| 2;\n  3[\"XTandemAdapter\"];\n  1 -->|output| 3;\n  0 -->|output| 3;\n  4[\"FileInfo\"];\n  3 -->|out| 4;\n  5[\"PeptideIndexer\"];\n  1 -->|output| 5;\n  3 -->|out| 5;\n  6[\"IDPosteriorErrorProbability\"];\n  5 -->|out| 6;\n  7[\"FalseDiscoveryRate\"];\n  6 -->|out| 7;\n  8[\"IDScoreSwitcher\"];\n  7 -->|out| 8;\n  9[\"FileInfo\"];\n  8 -->|out| 9;\n  10[\"FidoAdapter\"];\n  8 -->|out| 10;\n  11[\"FalseDiscoveryRate\"];\n  10 -->|out| 11;\n  12[\"FileInfo\"];\n  11 -->|out| 12;\n  13[\"TextExporter\"];\n  11 -->|out| 13;\n  14[\"IDMapper\"];\n  11 -->|out| 14;\n  2 -->|out_multiplets| 14;\n  15[\"Select\"];\n  13 -->|out| 15;\n  16[\"Select\"];\n  13 -->|out| 16;\n  17[\"IDConflictResolver\"];\n  14 -->|out| 17;\n  18[\"MultiplexResolver\"];\n  17 -->|out| 18;\n  19[\"ProteinQuantifier\"];\n  18 -->|out| 19;\n  11 -->|out| 19;\n  20[\"Summary Statistics\"];\n  19 -->|out| 20;\n  21[\"Select last\"];\n  19 -->|out| 21;\n  22[\"Histogram\"];\n  21 -->|outfile| 22;"}],"api":"https://training.galaxyproject.org/training-material/api/topics/proteomics/tutorials/protein-quant-sil/tutorial.json","tools":["Grep1","Summary_Statistics1","toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_tail_tool/1.1.0","toolshed.g2.bx.psu.edu/repos/devteam/histogram/histogram_rpy/1.0.4","toolshed.g2.bx.psu.edu/repos/galaxyp/openms_falsediscoveryrate/FalseDiscoveryRate/2.6+galaxy0","toolshed.g2.bx.psu.edu/repos/galaxyp/openms_featurefindermultiplex/FeatureFinderMultiplex/2.6+galaxy0","toolshed.g2.bx.psu.edu/repos/galaxyp/openms_fidoadapter/FidoAdapter/2.6+galaxy0","toolshed.g2.bx.psu.edu/repos/galaxyp/openms_fileinfo/FileInfo/2.6+galaxy0","toolshed.g2.bx.psu.edu/repos/galaxyp/openms_idconflictresolver/IDConflictResolver/2.6+galaxy0","toolshed.g2.bx.psu.edu/repos/galaxyp/openms_idmapper/IDMapper/2.6+galaxy0","toolshed.g2.bx.psu.edu/repos/galaxyp/openms_idposteriorerrorprobability/IDPosteriorErrorProbability/2.6+galaxy0","toolshed.g2.bx.psu.edu/repos/galaxyp/openms_idscoreswitcher/IDScoreSwitcher/2.6+galaxy0","toolshed.g2.bx.psu.edu/repos/galaxyp/openms_multiplexresolver/MultiplexResolver/2.5+galaxy0","toolshed.g2.bx.psu.edu/repos/galaxyp/openms_peptideindexer/PeptideIndexer/2.6+galaxy0","toolshed.g2.bx.psu.edu/repos/galaxyp/openms_proteinquantifier/ProteinQuantifier/2.6+galaxy0","toolshed.g2.bx.psu.edu/repos/galaxyp/openms_textexporter/TextExporter/2.6+galaxy0","toolshed.g2.bx.psu.edu/repos/galaxyp/openms_xtandemadapter/XTandemAdapter/2.6+galaxy0"],"supported_servers":{"exact":[{"url":"https://usegalaxy.eu","name":"UseGalaxy.eu","usegalaxy":true}],"inexact":[{"url":"https://usegalaxy.cz/","name":"UseGalaxy.cz","usegalaxy":false},{"url":"https://usegalaxy.no/","name":"UseGalaxy.no","usegalaxy":false},{"url":"https://usegalaxy.org.au","name":"UseGalaxy.org.au","usegalaxy":true}]},"topic_name_human":"Proteomics","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"text_processing","owner":"bgruening","revisions":"d698c222f354","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"histogram","owner":"devteam","revisions":"6f134426c2b0","tool_panel_section_label":"Graph/Display Data","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"openms_falsediscoveryrate","owner":"galaxyp","revisions":"c9eff69a7c62","tool_panel_section_label":"Proteomics","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"openms_featurefindermultiplex","owner":"galaxyp","revisions":"5e948629bc73","tool_panel_section_label":"Proteomics","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"openms_fidoadapter","owner":"galaxyp","revisions":"658494a2cb00","tool_panel_section_label":"Proteomics","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"openms_fileinfo","owner":"galaxyp","revisions":"52ba9695e752","tool_panel_section_label":"Proteomics","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"openms_idconflictresolver","owner":"galaxyp","revisions":"c28f13cab67a","tool_panel_section_label":"Proteomics","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"openms_idmapper","owner":"galaxyp","revisions":"39caaa778d2e","tool_panel_section_label":"Proteomics","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"openms_idposteriorerrorprobability","owner":"galaxyp","revisions":"111c3a00136d","tool_panel_section_label":"Proteomics","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"openms_idscoreswitcher","owner":"galaxyp","revisions":"be74a8cd7d66","tool_panel_section_label":"Proteomics","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"openms_multiplexresolver","owner":"galaxyp","revisions":"fb647b7cf2c1","tool_panel_section_label":"Proteomics","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"openms_peptideindexer","owner":"galaxyp","revisions":"dd173849c3d8","tool_panel_section_label":"Proteomics","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"openms_proteinquantifier","owner":"galaxyp","revisions":"16026cdb1330","tool_panel_section_label":"Proteomics","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"openms_textexporter","owner":"galaxyp","revisions":"9020199dba0a","tool_panel_section_label":"Proteomics","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"openms_xtandemadapter","owner":"galaxyp","revisions":"7f6a1f27553e","tool_panel_section_label":"Proteomics","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: text_processing\n  owner: bgruening\n  revisions: d698c222f354\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: histogram\n  owner: devteam\n  revisions: 6f134426c2b0\n  tool_panel_section_label: Graph/Display Data\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: openms_falsediscoveryrate\n  owner: galaxyp\n  revisions: c9eff69a7c62\n  tool_panel_section_label: Proteomics\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: openms_featurefindermultiplex\n  owner: galaxyp\n  revisions: 5e948629bc73\n  tool_panel_section_label: Proteomics\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: openms_fidoadapter\n  owner: galaxyp\n  revisions: 658494a2cb00\n  tool_panel_section_label: Proteomics\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: openms_fileinfo\n  owner: galaxyp\n  revisions: 52ba9695e752\n  tool_panel_section_label: Proteomics\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: openms_idconflictresolver\n  owner: galaxyp\n  revisions: c28f13cab67a\n  tool_panel_section_label: Proteomics\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: openms_idmapper\n  owner: galaxyp\n  revisions: 39caaa778d2e\n  tool_panel_section_label: Proteomics\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: openms_idposteriorerrorprobability\n  owner: galaxyp\n  revisions: 111c3a00136d\n  tool_panel_section_label: Proteomics\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: openms_idscoreswitcher\n  owner: galaxyp\n  revisions: be74a8cd7d66\n  tool_panel_section_label: Proteomics\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: openms_multiplexresolver\n  owner: galaxyp\n  revisions: fb647b7cf2c1\n  tool_panel_section_label: Proteomics\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: openms_peptideindexer\n  owner: galaxyp\n  revisions: dd173849c3d8\n  tool_panel_section_label: Proteomics\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: openms_proteinquantifier\n  owner: galaxyp\n  revisions: 16026cdb1330\n  tool_panel_section_label: Proteomics\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: openms_textexporter\n  owner: galaxyp\n  revisions: 9020199dba0a\n  tool_panel_section_label: Proteomics\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: openms_xtandemadapter\n  owner: galaxyp\n  revisions: 7f6a1f27553e\n  tool_panel_section_label: Proteomics\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":false,"slides_recordings":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial"}