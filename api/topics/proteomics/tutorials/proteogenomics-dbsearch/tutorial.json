{"layout":"tutorial_hands_on","title":"Proteogenomics 2: Database Search","zenodo_link":"https://doi.org/10.5281/zenodo.1489208","level":"Intermediate","questions":["How to identify variant proteoforms in MS data by searching with the customized Protein database?"],"objectives":["A proteogenomic data analysis of mass spectrometry data to identify and visualize variant peptides."],"time_estimation":"15m","key_points":["With SearchGUI and PeptideShaker you can gain access to multiple search engines"],"requirements":[{"type":"internal","topic_name":"proteomics","tutorials":["proteogenomics-dbcreation"]}],"follow_up_training":[{"type":"internal","topic_name":"proteomics","tutorials":["proteogenomics-novel-peptide-analysis"]}],"contributors":[{"name":"Subina Mehta","email":"subinamehta@gmail.com","twitter":"Subina_Mehta","linkedin":"subinamehta","matrix":"subinamehta:matrix.org","orcid":"0000-0001-9818-0537","joined":"2018-06","id":"subinamehta","url":"https://training.galaxyproject.org/training-material/api/contributors/subinamehta.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/subinamehta/"},{"name":"Timothy J. Griffin","email":"tgriffin@umn.edu","github":false,"joined":"2017-09","orcid":"0000-0001-6801-2559","id":"timothygriffin","url":"https://training.galaxyproject.org/training-material/api/contributors/timothygriffin.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/timothygriffin/"},{"name":"Pratik Jagtap","email":"pjagtap@umn.edu","joined":"2017-09","orcid":"0000-0003-0984-0973","id":"pratikdjagtap","url":"https://training.galaxyproject.org/training-material/api/contributors/pratikdjagtap.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/pratikdjagtap/"},{"name":"Ray Sajulga","email":"rsajulga@umn.edu","joined":"2018-11","id":"jraysajulga","url":"https://training.galaxyproject.org/training-material/api/contributors/jraysajulga.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/jraysajulga/"},{"name":"James Johnson","email":"jj@umn.edu","joined":"2017-09","in_memoriam":"<a href=\"https://galaxyproject.org/news/2024-03-19-remembrances-of-jj/\">James ‘JJ’ Johnson, was a Galaxy community rock star most known for his indispensable contributions to the Galaxy Proteomics community.</a>\n\nJJ’s works will live on in so many Galaxy tools and workflows for years to come.","id":"jj-umn","url":"https://training.galaxyproject.org/training-material/api/contributors/jj-umn.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/jj-umn/"},{"name":"Praveen Kumar","email":"kumar207@umn.edu","joined":"2019-04","id":"pravs3683","url":"https://training.galaxyproject.org/training-material/api/contributors/pravs3683.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/pravs3683/"}],"subtopic":"multi-omics","tags":["proteogenomics"],"recordings":[{"captioners":["emmaleith"],"date":"2021-02-15","galaxy_version":"21.01","length":"30M","youtube_id":"q1OjmTcbvBA","speakers":["andrewr"]}],"js_requirements":{"mathjax":null,"mermaid":false},"short_id":"T00232","url":"/topics/proteomics/tutorials/proteogenomics-dbsearch/tutorial.html","topic_name":"proteomics","tutorial_name":"proteogenomics-dbsearch","dir":"topics/proteomics/tutorials/proteogenomics-dbsearch","symlink":null,"id":"proteomics/proteogenomics-dbsearch","ref_tutorials":["<p>In this tutorial, we perform proteogenomic database searching using the Mass Spectrometry data. The inputs for performing the proteogenomic database searching are the peaklist MGF files and the FASTA database file. The FASTA database is obtained by running the first workflow “Uniprot_cRAP_SAV_indel_translatedbed.FASTA”. The second workflow focuses on performing database search of the peak list files (MGFs).</p>\n\n<p><a href=\"../../images/second_workflow.png\" rel=\"noopener noreferrer\"><img src=\"../../images/second_workflow.png\" alt=\"Workflow. \" width=\"1712\" height=\"492\" loading=\"lazy\" /></a></p>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n  <p>In this tutorial, we will deal with:</p>\n<ol id=\"markdown-toc\">\n  <li><a href=\"#pretreatments\" id=\"markdown-toc-pretreatments\">Pretreatments</a></li>\n  <li><a href=\"#match-peptide-sequences\" id=\"markdown-toc-match-peptide-sequences\">Match peptide sequences</a>    <ol>\n      <li><a href=\"#searchgui\" id=\"markdown-toc-searchgui\">SearchGUI</a></li>\n      <li><a href=\"#peptideshaker\" id=\"markdown-toc-peptideshaker\">PeptideShaker</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#create-a-sqlite-database-for-peptide-protein-and-genomic-annotation-visualization\" id=\"markdown-toc-create-a-sqlite-database-for-peptide-protein-and-genomic-annotation-visualization\">Create a SQLite database for peptide, protein and genomic annotation visualization</a>    <ol>\n      <li><a href=\"#query-tabular\" id=\"markdown-toc-query-tabular\">Query Tabular</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#getting-data-blast-p-ready\" id=\"markdown-toc-getting-data-blast-p-ready\">Getting data Blast-P ready</a></li>\n  <li><a href=\"#conclusion\" id=\"markdown-toc-conclusion\"><strong>Conclusion</strong></a></li>\n</ol>\n\n</blockquote>\n\n<h1 id=\"pretreatments\">Pretreatments</h1>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>data upload and organization</hands-on-title>\n\n  <ol>\n    <li>Create a <strong>new history</strong> and name it something meaningful (e.g. <em>Proteogenomics DB search</em>)</li>\n    <li>Import the four MGF MS/MS files and the Trimmed_ref_5000_uniprot_cRAP.FASTA sequence file from Zenodo.<a href=\"https://doi.org/10.5281/zenodo.1489208\"><a href=\"https://zenodo.org/badge/DOI/10.5281/zenodo.1489208.svg\" rel=\"noopener noreferrer\"><img src=\"https://zenodo.org/badge/DOI/10.5281/zenodo.1489208.svg\" alt=\"DOI. \" loading=\"lazy\" /></a></a>\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/1489208/files/Mo_Tai_Trimmed_mgfs__Mo_Tai_iTRAQ_f4.mgf\nhttps://zenodo.org/record/1489208/files/Mo_Tai_Trimmed_mgfs__Mo_Tai_iTRAQ_f5.mgf\nhttps://zenodo.org/record/1489208/files/Mo_Tai_Trimmed_mgfs__Mo_Tai_iTRAQ_f8.mgf\nhttps://zenodo.org/record/1489208/files/Mo_Tai_Trimmed_mgfs__Mo_Tai_iTRAQ_f9.mgf\n</code></pre></div>      </div>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-via-links\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-via-links\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing via links</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>Rename the datasets to something more recognizable (strip the URL prefix)</li>\n    <li>\n      <p>Build a <strong>Dataset list</strong> for the three MGF files, name it as “<strong>Mo_Tai_MGFs</strong>”</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-dataset-collection\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-dataset-collection\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a dataset collection</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on <i class=\"far fa-check-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-selector</span> <strong>Select Items</strong> at the top of the history panel <img src=\"/training-material/topics/galaxy-interface/images/historyItemControls.png\" alt=\"Select Items button\" /></li>   <li>Check all the datasets in your history you would like to include</li>   <li>     <p>Click <strong>n of N selected</strong> and choose <strong>Build Dataset List</strong></p>     <p><img src=\"/training-material/topics/galaxy-interface/images/buildList.png\" alt=\"build list collection menu item\" width=\"15%\" /></p>   </li>   <li>Enter a name for your collection</li>   <li>Click <strong>Create collection</strong> to build your collection</li>   <li>Click on the checkmark icon at the top of your history again</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h1 id=\"match-peptide-sequences\">Match peptide sequences</h1>\n\n<p>The search database labelled <code class=\"language-plaintext highlighter-rouge\">Uniprot_cRAP_SAV_indel_translatedbed.FASTA</code> is the input database that\nwill be used to match MS/MS to peptide sequences via a sequence database search.</p>\n\n<p>For this, the sequence database-searching program called <a href=\"https://compomics.github.io/projects/searchgui.html\">SearchGUI</a> will be used.The generated dataset collection of the three <em>MGF files</em> in the history is used as the MS/MS input. We will walk through a number of these settings in order to utilize SearchGUI on these example MGF files.</p>\n\n<blockquote class=\"comment\">\n  <comment-title>Tool Versions</comment-title>\n\n  <p>The tools are subjected to changes while being upgraded. Here we have used an older version of SearchGUI (v3.3.10.1)-Peptide Shaker (v1.16.36.3).\nThe new versions are available in Galaxy.</p>\n\n</blockquote>\n\n<h2 id=\"searchgui\">SearchGUI</h2>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>SearchGUI</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/galaxyp/peptideshaker/search_gui/3.3.10.1\" title=\"Search GUI tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Search GUI</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 3.3.10.1)</span> with the following parameters:\n      <ul>\n        <li>\n          <p><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Protein Database”</em>: <code class=\"language-plaintext highlighter-rouge\">Uniprot_cRAP_SAV_indel_translatedbed.FASTA</code> (Or however you named the <code class=\"language-plaintext highlighter-rouge\">FASTA</code> file)</p>\n\n          <blockquote class=\"comment\">\n            <comment-title></comment-title>\n            <p>The “Uniprot_cRAP_SAV_indel_translatedbed” FASTA database is obtained when you run the first proteogenomics workflow.\n   Please make sure to run the 1st workflow.</p>\n          </blockquote>\n        </li>\n        <li>\n          <p><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“Input Peak lists (mgf)”</em>: <code class=\"language-plaintext highlighter-rouge\">MGF files</code> dataset collection.</p>\n\n          <blockquote class=\"tip\">\n            <tip-title>Select dataset collections as input</tip-title>\n\n            <ul>\n              <li>\n                <p>Click the <strong>Dataset collection</strong> icon on the left of the input field:</p>\n              </li>\n              <li>\n                <p>Select the appropriate dataset collection from the list</p>\n              </li>\n            </ul>\n          </blockquote>\n        </li>\n        <li>Section <strong>Search Engine Options</strong>:\n          <ul>\n            <li>\n              <p><i class=\"far fa-check-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-check</span> <em>“DB-Search Engines”</em>: <code class=\"language-plaintext highlighter-rouge\">X!Tandem</code></p>\n\n              <blockquote class=\"comment\">\n                <comment-title></comment-title>\n                <p>The section <strong>Search Engine Options</strong> contains a selection of sequence database searching\n   programs that are available in SearchGUI. Any combination of these programs can be used for\n   generating PSMs from MS/MS data. For the purpose of this tutorial, <strong>X!Tandem</strong> we will be\n   used.</p>\n              </blockquote>\n            </li>\n          </ul>\n        </li>\n        <li>Section <strong>Protein Digestion Options</strong>:\n          <ul>\n            <li><i class=\"fas fa-filter\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-select</span> <em>“Enzyme”</em>: <code class=\"language-plaintext highlighter-rouge\">Trypsin</code></li>\n            <li><i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-text</span> <em>“Maximum Missed Cleavages”</em>: <code class=\"language-plaintext highlighter-rouge\">2</code></li>\n          </ul>\n        </li>\n        <li>Section <strong>Precursor options</strong>:\n          <ul>\n            <li><i class=\"fas fa-filter\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-select</span> <em>“Precursor Ion Tolerance Units”</em>: <code class=\"language-plaintext highlighter-rouge\">Parts per million (ppm)</code></li>\n            <li><i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-text</span> <em>“Precursor Ion Tolerance”</em>:<code class=\"language-plaintext highlighter-rouge\"> 10</code></li>\n            <li><i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-text</span> <em>“Fragment Tolerance (Daltons)”</em>: <code class=\"language-plaintext highlighter-rouge\">0.05</code> (this is high resolution MS/MS data)</li>\n            <li><i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-text</span> <em>“Minimum charge”</em>:<code class=\"language-plaintext highlighter-rouge\">2</code></li>\n            <li><i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-text</span> <em>“Maximum charge”</em>:<code class=\"language-plaintext highlighter-rouge\">6</code></li>\n            <li><i class=\"fas fa-filter\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-select</span> <em>“Forward Ion”</em>: <code class=\"language-plaintext highlighter-rouge\">b</code></li>\n            <li><i class=\"fas fa-filter\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-select</span> <em>“Reverse Ion”</em>:<code class=\"language-plaintext highlighter-rouge\"> y</code></li>\n            <li><i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-text</span> <em>“Minimum Precursor Isotope”</em> :<code class=\"language-plaintext highlighter-rouge\">0</code></li>\n            <li><i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-text</span> <em>“Maximum Precursor Isotope”</em> :<code class=\"language-plaintext highlighter-rouge\">1</code></li>\n          </ul>\n        </li>\n        <li>Section <strong>Protein Modification Options</strong>:\n          <ul>\n            <li><i class=\"fas fa-filter\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-select</span> <em>“Fixed Modifications”</em>: <code class=\"language-plaintext highlighter-rouge\">Carbamidomethylation of C, ITRAQ-4Plex of K, ITRAQ-4Plex of Ntermini</code></li>\n            <li>\n              <p><i class=\"fas fa-filter\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-select</span> <em>“Variable modifications”</em>: <code class=\"language-plaintext highlighter-rouge\">Oxidation of M, ITRAQ-4Plex of Y</code></p>\n\n              <blockquote class=\"tip\">\n                <tip-title>Search for options</tip-title>\n                <p>For selection lists, typing the first few letters in the window will filter the\navailable options.</p>\n              </blockquote>\n            </li>\n          </ul>\n        </li>\n        <li>Section <strong>Advanced Options</strong>:\n          <ul>\n            <li><i class=\"fas fa-filter\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-select</span> <em>“X!Tandem Options”</em>: <code class=\"language-plaintext highlighter-rouge\">Advanced</code>\n              <ul>\n                <li><i class=\"far fa-check-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-check</span> <em>“X!Tandem: Quick Acetyl”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n                <li><i class=\"far fa-check-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-check</span> <em>“X!Tandem: Quick Pyrolidone”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n                <li><i class=\"far fa-check-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-check</span> <em>“X!Tandem: Protein stP Bias”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n                <li><i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-text</span> <em>“X!Tandem: Maximum Valid Expectation Value”</em>: <code class=\"language-plaintext highlighter-rouge\">100</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n  </ol>\n\n  <p>Once the database search is completed, the SearchGUI tool will output a file (called a\nSearchGUI archive file) that will serve as an input for the next section, PeptideShaker.\nRename the output as “<strong>Compressed SearchGUI results</strong>”</p>\n\n  <blockquote class=\"comment\">\n    <comment-title></comment-title>\n    <p>Note that sequence databases used for proteogenomics are usually much larger than\nthe excerpt used in this tutorial. When using large databases, the peptide identification\nstep can take much more time for computation. In proteogenomics, choosing the optimal\ndatabase is a crucial step of your workflow.</p>\n  </blockquote>\n\n</blockquote>\n\n<h2 id=\"peptideshaker\">PeptideShaker</h2>\n\n<p><a href=\"https://compomics.github.io/projects/peptide-shaker.html\">PeptideShaker</a> is a post-processing software tool that\nprocesses data from the SearchGUI software tool. It serves to organize the Peptide-Spectral\nMatches (PSMs) generated from SearchGUI processing and is contained in the SearchGUI archive.\nIt provides an assessment of confidence of the data, inferring proteins identified from the\nmatched peptide sequences and generates outputs that can be visualized by users to interpret\nresults. PeptideShaker has been wrapped in Galaxy to work in combination with SearchGUI\noutputs.</p>\n\n<blockquote class=\"comment\">\n  <comment-title>File Formats</comment-title>\n  <p>There are a number of choices for different data files that can be generated using\n  PeptideShaker. A compressed file can be made containing all information needed to\n  view them results in the standalone PeptideShaker viewer. A <code class=\"language-plaintext highlighter-rouge\">mzidentML</code> file can\n  be generated that contains all peptide sequence matching information and can be\n  utilized by compatible downstream software. Other outputs are focused on the inferred\n  proteins identified from the PSMs, as well as phosphorylation reports, relevant if\n  a phosphoproteomics experiment has been undertaken.</p>\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>PeptideShaker</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/galaxyp/peptideshaker/peptide_shaker/1.16.36.3\" title=\"Peptide Shaker tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Peptide Shaker</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.16.36.3)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Compressed SearchGUI results”</em>: The SearchGUI archive file</li>\n        <li><i class=\"fas fa-filter\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-select</span> <em>“Specify Advanced PeptideShaker Processing Options”</em>: <code class=\"language-plaintext highlighter-rouge\">Default Processing Options</code></li>\n        <li><i class=\"fas fa-filter\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-select</span> <em>“Specify Advanced Filtering Options”</em>: <code class=\"language-plaintext highlighter-rouge\">Default Filtering Options</code></li>\n        <li><i class=\"far fa-check-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-check</span> <em>“Include the protein sequences in mzIdentML”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n        <li><i class=\"far fa-check-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-check</span> <em>“Output options”</em>: Select the <code class=\"language-plaintext highlighter-rouge\">PSM Report</code> (Peptide-Spectral Match) and the <code class=\"language-plaintext highlighter-rouge\">Certificate of Analysis</code></li>\n      </ul>\n\n      <blockquote class=\"comment\">\n        <comment-title>Certificate of Analysis</comment-title>\n\n        <p>The “Certificate of Analysis” provides details on all the parameters\nused by both SearchGUI and PeptideShaker in the analysis. This can be downloaded from the\nGalaxy instance to your local computer in a text file if desired.</p>\n\n      </blockquote>\n    </li>\n    <li>Inspect <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> the resulting files</li>\n  </ol>\n\n</blockquote>\n\n<p>A number of new items will appear in your History, each corresponding to the outputs selected in the PeptideShaker parameters. The Peptide Shaker’s PSM report is used as an input for the BlastP analysis. Before performing BlastP analysis. The Query Tabular tool and few test manipulation tools are used to remove spectra that belongs to the reference proteins. The output tabular file “Peptides_for_Blast-P_analysis” will contain only those spectra that did not belong to any known proteins.</p>\n\n<h1 id=\"create-a-sqlite-database-for-peptide-protein-and-genomic-annotation-visualization\">Create a SQLite database for peptide, protein and genomic annotation visualization</h1>\n\n<p>The mzidentml output from the Peptide shaker is converted into an sqlite database file by using the mz to sqlite tool. This sqlite output is used to open the Multi-omics visualization platform, wherein you can view the spectra of the peptides using Lorikeet parameters. To open the MVP viewer, click on the “Visualize in MVP Application” icon ( this will pop-open the interactive multi-omics viewer in a new window/tab)</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>mz to sqlite</hands-on-title>\n\n  <p>This tool extracts mzidentml and its associated proteomics datasets into a sqlite db</p>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/galaxyp/mz_to_sqlite/mz_to_sqlite/2.0.4+galaxy1\" title=\"mz to sqlite tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>mz to sqlite</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.0.4+galaxy1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Proteomics identification files”</em>: <code class=\"language-plaintext highlighter-rouge\">PeptideShaker_mzidentml</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Proteomics Spectrum files”</em>: <code class=\"language-plaintext highlighter-rouge\">Mo_Tai_MGFs</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Proteomics Search Database Fasta”</em>: <code class=\"language-plaintext highlighter-rouge\">Uniprot_cRAP_SAV_indel_translatedbed.FASTA</code></li>\n      </ul>\n\n      <p><a href=\"../../images/mz2sqlite.png\" rel=\"noopener noreferrer\"><img src=\"../../images/mz2sqlite.png\" alt=\"mz2sqlite. \" width=\"432\" height=\"548\" loading=\"lazy\" /></a></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>The next step is to remove known peptides from the list of PSM’s that we acquired from the Peptide Shaker results. For that we need to perform Query tabular to extract list of known peptides from the UniProt and cRAP database.</p>\n\n<h2 id=\"query-tabular\">Query Tabular</h2>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Remove Reference proteins</hands-on-title>\n\n  <ol>\n    <li><strong>Query Tabular</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters:</li>\n  </ol>\n\n  <ul>\n    <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <strong>Insert Database Table</strong> (b): <code class=\"language-plaintext highlighter-rouge\">PSM report</code>\n      <ul>\n        <li>Section <strong>Filter Dataset Input</strong>:\n          <ul>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <strong>Insert Filter Tabular Input Lines</strong>\n              <ul>\n                <li><em>“Filter by”</em>:  <code class=\"language-plaintext highlighter-rouge\">skip leading lines</code></li>\n                <li><em>“Skip lines”</em>: <code class=\"language-plaintext highlighter-rouge\">1</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n        <li>Section <strong>Table Options</strong>:\n          <ul>\n            <li><em>“Specify Name for Table”</em>: <code class=\"language-plaintext highlighter-rouge\">psms</code></li>\n            <li><em>“Use first line as column names”</em> : <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n            <li><em>“Specify Column Names (comma-separated list)”</em>:<code class=\"language-plaintext highlighter-rouge\">id,Proteins,Sequence</code></li>\n            <li><em>“Only load the columns you have named into database”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <strong>Table Index</strong>\n              <ul>\n                <li><em>“Table Index”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n                <li><em>“Index on Columns”</em>: <code class=\"language-plaintext highlighter-rouge\">id</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>\n      <p><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <strong>Insert Database Table</strong> (c):<code class=\"language-plaintext highlighter-rouge\">PSM report</code></p>\n\n      <ul>\n        <li>Section <strong>Filter Dataset Input</strong>\n          <ul>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <strong>Insert Filter Tabular Input Lines</strong>\n              <ul>\n                <li><em>“Filter by”</em>:  <code class=\"language-plaintext highlighter-rouge\">skip leading lines</code></li>\n                <li><em>“Skip lines”</em>: <code class=\"language-plaintext highlighter-rouge\">1</code></li>\n              </ul>\n            </li>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <strong>Insert Filter Tabular Input Lines</strong>\n              <ul>\n                <li><em>“Filter by”</em>:  <code class=\"language-plaintext highlighter-rouge\">select columns</code></li>\n                <li><em>“Enter column numbers to keep”</em>: <code class=\"language-plaintext highlighter-rouge\">1,2</code></li>\n              </ul>\n            </li>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <strong>Insert Filter Tabular Input Lines</strong>\n              <ul>\n                <li><em>“Filter by”</em>:  <code class=\"language-plaintext highlighter-rouge\">normalize list columns,replicate rows for each item in the list</code></li>\n                <li><em>“Enter column numbers to normalize”</em>: <code class=\"language-plaintext highlighter-rouge\">2</code></li>\n                <li><em>“List item delimiter in column”</em>: <code class=\"language-plaintext highlighter-rouge\">,</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n        <li>Section <strong>Table Options</strong>:\n          <ul>\n            <li><em>“Specify Name for Table”</em>: <code class=\"language-plaintext highlighter-rouge\">prots</code></li>\n            <li><em>“Use first line as column names”</em> : <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n            <li><em>“Specify Column Names (comma-separated list)”</em>:<code class=\"language-plaintext highlighter-rouge\">id,prot</code></li>\n            <li><em>“Only load the columns you have named into database”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <strong>Insert Table Index</strong>:\n              <ul>\n                <li><em>“Table Index”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n                <li><em>“Index on Columns”</em>: <code class=\"language-plaintext highlighter-rouge\">prot,id</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <strong>Insert Database Table</strong> (a): <code class=\"language-plaintext highlighter-rouge\">Reference_Protein_Acessions</code>\n      <ul>\n        <li>Section <strong>Table Options</strong>:\n          <ul>\n            <li><em>“Tabular Dataset for Table”</em>: <code class=\"language-plaintext highlighter-rouge\">Uniprot</code></li>\n            <li><em>“Use first line as column names”</em> : <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n            <li><em>“Specify Column Names (comma-separated list)”</em>:<code class=\"language-plaintext highlighter-rouge\">prot</code></li>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <strong>Insert Table Index</strong>:\n              <ul>\n                <li><em>“Table Index”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n                <li><em>“Index on Columns”</em>: <code class=\"language-plaintext highlighter-rouge\">prot</code></li>\n              </ul>\n            </li>\n          </ul>\n\n          <blockquote class=\"comment\">\n            <comment-title></comment-title>\n\n            <p>By default, table columns will be named: c1,c2,c3,…,cn (column names for a table must be unique).\nYou can override the default names by entering a comma separated list of names, e.g. <code class=\"language-plaintext highlighter-rouge\">,name1,,,name2</code>\nwould rename the second and fifth columns.\nCheck your input file to find the settings which best fits your needs.</p>\n\n          </blockquote>\n        </li>\n        <li>\n          <p><em>“Save the sqlite database in your history”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></p>\n\n          <blockquote class=\"comment\">\n            <comment-title>Querying an SQLite Database</comment-title>\n            <p><strong>Query Tabular</strong> can also use an existing SQLite database.\nActivating <code class=\"language-plaintext highlighter-rouge\">Save the sqlite database in your history</code>\nwill store the generated database in the history, allowing to reuse it directly.</p>\n          </blockquote>\n        </li>\n        <li><em>“SQL Query to generate tabular output”</em>:\n          <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>SELECT psms.*\nFROM psms\nWHERE psms.id NOT IN\n(SELECT distinct prots.id\nFROM prots JOIN uniprot ON prots.prot = uniprot.prot)\nORDER BY psms.id\n</code></pre></div>          </div>\n        </li>\n        <li><em>“include query result column headers”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n      </ul>\n    </li>\n    <li>Click <strong>Run Tool</strong> and inspect the query results file after it turned green.</li>\n  </ul>\n\n</blockquote>\n\n<p>The output from this step is that the resultant peptides would be those which doesn’t belong in the Uniprot or cRAP database. The query tabular tool is used again to create a tabular output containing peptides ready for Blast P analysis.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Query Tabular</hands-on-title>\n\n  <p><strong>Query Tabular</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>: with the following parameters:</p>\n\n  <ul>\n    <li>Section <strong>Filter Dataset Input</strong>\n      <ul>\n        <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Filter Tabular Input Lines”</em>\n          <ul>\n            <li><em>“Filter by”</em>:  <code class=\"language-plaintext highlighter-rouge\">skip leading lines</code></li>\n            <li><em>“Skip lines”</em>: <code class=\"language-plaintext highlighter-rouge\">1</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>Section <strong>Table Options</strong>:\n      <ul>\n        <li><em>“Specify Name for Table”</em>: <code class=\"language-plaintext highlighter-rouge\">psm</code></li>\n        <li><em>“Use first line as column names”</em> : <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n        <li><em>“Specify Column Names (comma-separated list)”</em>:<code class=\"language-plaintext highlighter-rouge\">id,Proteins,Sequence</code></li>\n        <li><em>“Only load the columns you have named into database”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n      </ul>\n    </li>\n    <li><em>“SQL Query to generate tabular output”</em>:\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>SELECT Sequence || ' PSM=' || group_concat(id,',') || ' length='\n|| length(Sequence) as \"ID\",Sequence\nFROM  psm\nWHERE length(Sequence) &gt;6\nAND length(Sequence) &lt;= 30\nGROUP BY Sequence\nORDER BY length(Sequence),Sequence\n</code></pre></div>      </div>\n    </li>\n    <li>\n      <p><em>“include query result column headers”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></p>\n    </li>\n    <li>Click <strong>Run Tool</strong> and inspect the query results file after it turned green.</li>\n  </ul>\n\n  <p><a href=\"../../images/QT_output.png\" rel=\"noopener noreferrer\"><img src=\"../../images/QT_output.png\" alt=\"QT. \" width=\"557\" height=\"633\" loading=\"lazy\" /></a></p>\n\n</blockquote>\n\n<h1 id=\"getting-data-blast-p-ready\">Getting data Blast-P ready</h1>\n\n<p>BlastP search is carried out with the PSM report (output from PeptideShaker). Before, BlastP analysis the “Peptides_for_Blast-P_analysis” is first converted from Tabular format to FASTA file format which can be easily read by the BlastP algorithm. This is done with the help of “Tabular to FASTA” conversion tool.\nThe short BlastP uses parameters for short peptide sequences (8-30 aas). Please use the rerun option to look at the parameters used.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Tabular to FASTA (version 1.1.1)</hands-on-title>\n  <ol>\n    <li><strong>Tabular-to-FASTA</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>: with the following parameters:\n      <ul>\n        <li><em>“Title column”</em>: <code class=\"language-plaintext highlighter-rouge\">1</code></li>\n        <li><em>“Sequence Column”</em>:<code class=\"language-plaintext highlighter-rouge\">2</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>The output FASTA file is going to be subjected to BLAST-P analysis.</p>\n\n<blockquote class=\"comment\">\n  <comment-title>Tool Versions</comment-title>\n\n  <p>The tools are subjected to changes while being upgraded.\nThus, running the workflow provided with the tutorial, the user might need to make sure they are using the latest version including updating the parameters.</p>\n\n</blockquote>\n\n<h1 id=\"conclusion\"><strong>Conclusion</strong></h1>\n\n<p>This completes the walkthrough of the proteogenomics database search workflow. This tutorial is a guide to perform database searching with mass spectronetry files and have peptides ready for Blast-P analysis, you can perform follow up analysis using the next GTN “Proteogenomics Novel Peptide Analysis”.\nResearchers can use this workflow with their data also, please note that the tool parameters, reference genomes and the workflow will be needed to be modified accordingly.</p>\n\n<p>This workflow was developed by the Galaxy-P team at the University of Minnesota. For more information about Galaxy-P or our ongoing work, please visit us at <a href=\"https://galaxyp.org\">galaxyp.org</a></p>\n\n"],"ref_slides":[],"hands_on":true,"slides":false,"mod_date":"2024-05-29 14:28:52 +0000","pub_date":"2018-11-20 19:05:23 +0000","version":55,"workflows":[{"workflow":"galaxy-workflow-mouse_rnaseq_dbsearch.ga","tests":false,"url":"https://training.galaxyproject.org/training-material/topics/proteomics/tutorials/proteogenomics-dbsearch/workflows/galaxy-workflow-mouse_rnaseq_dbsearch.ga","path":"topics/proteomics/tutorials/proteogenomics-dbsearch/workflows/galaxy-workflow-mouse_rnaseq_dbsearch.ga","wfid":"proteomics-proteogenomics-dbsearch","wfname":"galaxy-workflow-mouse_rnaseq_dbsearch","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/proteomics-proteogenomics-dbsearch/versions/galaxy-workflow-mouse_rnaseq_dbsearch","license":null,"creators":[],"name":"GTN Proteogemics2 Database Search","title":"GTN Proteogemics2 Database Search","test_results":null,"modified":"2024-06-19 00:05:32 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\nUniprot_cRAP_SAV_indel_translatedbed.FASTA\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"ℹ️ Input Collection\\nMGF Collection\"];\n  style 1 stroke:#2c3143,stroke-width:4px;\n  2[\"ℹ️ Input Dataset\\nReference Protein Accessions\"];\n  style 2 stroke:#2c3143,stroke-width:4px;\n  3[\"Search GUI\"];\n  0 -->|output| 3;\n  1 -->|output| 3;\n  d14f9481-80db-4c15-8afc-6fa38ef61deb[\"Output\\nSearch GUI on input dataset(s)\"];\n  3 --> d14f9481-80db-4c15-8afc-6fa38ef61deb;\n  style d14f9481-80db-4c15-8afc-6fa38ef61deb stroke:#2c3143,stroke-width:4px;\n  4[\"Peptide Shaker\"];\n  3 -->|searchgui_results| 4;\n  afe0f1a5-28bb-44bd-b32b-c634aa2154f3[\"Output\\nPeptide Shaker on input dataset(s): mzidentML file\"];\n  4 --> afe0f1a5-28bb-44bd-b32b-c634aa2154f3;\n  style afe0f1a5-28bb-44bd-b32b-c634aa2154f3 stroke:#2c3143,stroke-width:4px;\n  5[\"mz to sqlite\"];\n  4 -->|mzidentML| 5;\n  1 -->|output| 5;\n  0 -->|output| 5;\n  b43a2136-cf59-4fb0-bb2b-0d5b446c8ba9[\"Output\\nmz to sqlite on input dataset(s)\"];\n  5 --> b43a2136-cf59-4fb0-bb2b-0d5b446c8ba9;\n  style b43a2136-cf59-4fb0-bb2b-0d5b446c8ba9 stroke:#2c3143,stroke-width:4px;\n  6[\"Removing reference proteins\"];\n  4 -->|output_psm| 6;\n  4 -->|output_psm| 6;\n  2 -->|output| 6;\n  a06ad5fa-9a00-4867-b976-3745c5e59c80[\"Output\\nRemoving reference proteins\"];\n  6 --> a06ad5fa-9a00-4867-b976-3745c5e59c80;\n  style a06ad5fa-9a00-4867-b976-3745c5e59c80 stroke:#2c3143,stroke-width:4px;\n  7[\"Selecting sequence with length >6 and <30\"];\n  6 -->|output| 7;\n  b71e5417-2864-4712-b5c1-c90725976baf[\"Output\\nSelecting sequence with length >6 and <30\"];\n  7 --> b71e5417-2864-4712-b5c1-c90725976baf;\n  style b71e5417-2864-4712-b5c1-c90725976baf stroke:#2c3143,stroke-width:4px;\n  8[\"Peptides for BlastP analysis\"];\n  7 -->|output| 8;\n  1ac3c776-8095-4db1-8518-3643dc081006[\"Output\\nPeptides_for_BlastP_analysis\"];\n  8 --> 1ac3c776-8095-4db1-8518-3643dc081006;\n  style 1ac3c776-8095-4db1-8518-3643dc081006 stroke:#2c3143,stroke-width:4px;"}],"api":"https://training.galaxyproject.org/training-material/api/topics/proteomics/tutorials/proteogenomics-dbsearch/tutorial.json","tools":["toolshed.g2.bx.psu.edu/repos/devteam/tabular_to_fasta/tab2fasta/1.1.1","toolshed.g2.bx.psu.edu/repos/galaxyp/mz_to_sqlite/mz_to_sqlite/2.0.4+galaxy1","toolshed.g2.bx.psu.edu/repos/galaxyp/peptideshaker/peptide_shaker/1.16.36.3","toolshed.g2.bx.psu.edu/repos/galaxyp/peptideshaker/search_gui/3.3.10.1","toolshed.g2.bx.psu.edu/repos/iuc/query_tabular/query_tabular/3.0.0"],"supported_servers":{"exact":[{"url":"https://usegalaxy.eu","name":"UseGalaxy.eu","usegalaxy":true},{"url":"https://usegalaxy.no/","name":"UseGalaxy.no","usegalaxy":false},{"url":"https://usegalaxy.org","name":"UseGalaxy.org (Main)","usegalaxy":true},{"url":"https://usegalaxy.org.au","name":"UseGalaxy.org.au","usegalaxy":true}],"inexact":[{"url":"https://usegalaxy.be/","name":"UseGalaxy.be","usegalaxy":false},{"url":"https://usegalaxy.cz/","name":"UseGalaxy.cz","usegalaxy":false}]},"topic_name_human":"Proteomics","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"tabular_to_fasta","owner":"devteam","revisions":"0a7799698fe5","tool_panel_section_label":"FASTA/FASTQ","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"mz_to_sqlite","owner":"galaxyp","revisions":"f5c632894818","tool_panel_section_label":"Convert Formats","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"peptideshaker","owner":"galaxyp","revisions":"7fdd9119cc4f","tool_panel_section_label":"Proteomics","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"peptideshaker","owner":"galaxyp","revisions":"7fdd9119cc4f","tool_panel_section_label":"Proteomics","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"query_tabular","owner":"iuc","revisions":"33d61c89fb8d","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: tabular_to_fasta\n  owner: devteam\n  revisions: 0a7799698fe5\n  tool_panel_section_label: FASTA/FASTQ\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: mz_to_sqlite\n  owner: galaxyp\n  revisions: f5c632894818\n  tool_panel_section_label: Convert Formats\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: peptideshaker\n  owner: galaxyp\n  revisions: 7fdd9119cc4f\n  tool_panel_section_label: Proteomics\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: peptideshaker\n  owner: galaxyp\n  revisions: 7fdd9119cc4f\n  tool_panel_section_label: Proteomics\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: query_tabular\n  owner: iuc\n  revisions: 33d61c89fb8d\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":false,"slides_recordings":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial"}