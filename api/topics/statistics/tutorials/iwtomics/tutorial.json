{"layout":"tutorial_hands_on","title":"Interval-Wise Testing for omics data","zenodo_link":"https://doi.org/10.5281/zenodo.5589610","questions":["How to visualize high-resolution omics data in different groups of genomic regions?","How to evaluate differences in high-resolution omics data between groups of genomic regions?","How to detect locations and scales at which the significant effects unfold?"],"objectives":["Pre-process high-resolution omics data","Create pointwise boxplots corresponding to different groups of genomic regions","Perform the Interval-Wise Testing between two groups of genomic regions","Visualize and inspect test results","Detect relevant locations and scales"],"requirements":null,"time_estimation":"1h","key_points":["High-resolution omics data can be represented as curves along the genome","IWTomics permits to visualize these data","The Interval-Wise Testing detects statistically significant differences between pairs of genomic regions","The Interval-Wise Testing corrects p-values taking into consideration the ordered nature of measurements along the genome","Locations and scales do not need to be specified at the outset, indeed IWTomics permits to detect them"],"contributors":[{"name":"Marzia A Cremona","email":"mac78@psu.edu","joined":"2018-02","id":"marziacremona","url":"https://training.galaxyproject.org/training-material/api/contributors/marziacremona.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/marziacremona/"},{"name":"Fabio Cumbo","email":"fabio.cumbo@gmail.com","twitter":"cumbofabio","linkedin":"fabiocumbo","orcid":"0000-0003-2920-5838","joined":"2018-02","id":"cumbof","url":"https://training.galaxyproject.org/training-material/api/contributors/cumbof.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/cumbof/"}],"js_requirements":{"mathjax":null,"mermaid":false},"short_id":"T00269","url":"/topics/statistics/tutorials/iwtomics/tutorial.html","topic_name":"statistics","tutorial_name":"iwtomics","dir":"topics/statistics/tutorials/iwtomics","symlink":null,"id":"statistics/iwtomics","ref_tutorials":["<p>IWTomics (<span class=\"citation\"><a href=\"#Cremona2018\">Cremona <i>et al.</i> 2018</a></span>) implements the Interval-Wise Testing (IWT; <span class=\"citation\"><a href=\"#Pini2017\">Pini and Vantini 2017</a></span>) for omics data. This\ninferential procedure tests for differences in “Omics” data between two groups\nof genomic regions, and does not require fixing location and scale at the\noutset.</p>\n\n<p>In this tutorial we use real data about endogenous retroviruses (ERVs) in mouse.\nIn particular, we compare recombination hotspots in the flanking regions of fixed ETn versus control regions.\nThe dataset contains two region datasets “ETn fixed”, “Control” and one feature “Recombination hotspots content”. The region dataset “ETn fixed” contains 1296 genomic regions of 64 kb surrounding fixed ETns elements (32-kb flanking sequences upstream and 32-kb flanking sequences downstream of each element). The region dataset “Control” contains 1142 regions of 64 kb without elements, used as control in the test. The regions are aligned around their center (i.e. around the ETn integration sites).</p>\n\n<p>Recombination hotspots measurements are associated to each “ETn fixed” and “Control” region. In particular, this feature is measured in 1-kb windows, so that each region is associated to a recombination hotspots curve made of 64 values. The measurement used is the feature content, i.e. the fraction of the 1-kb window that is covered by recombination hotspots</p>\n\n<p>The data we use in this tutorial is available at <a href=\"https://doi.org/10.5281/zenodo.5589610\">Zenodo</a>.</p>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n  <p>IWTomics is composed of three steps (corresponding to three tools):</p>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#step-1-loading-and-pre-processing\" id=\"markdown-toc-step-1-loading-and-pre-processing\">Step 1: Loading and pre-processing</a></li>\n  <li><a href=\"#step-2-performing-interval-wise-testing\" id=\"markdown-toc-step-2-performing-interval-wise-testing\">Step 2: Performing Interval-Wise Testing</a></li>\n  <li><a href=\"#step-3-selecting-test-scale\" id=\"markdown-toc-step-3-selecting-test-scale\">Step 3: Selecting test scale</a></li>\n</ol>\n\n</blockquote>\n\n<h1 id=\"step-1-loading-and-pre-processing\">Step 1: Loading and pre-processing</h1>\n\n<p>The first tool (IWTomics Load Smooth and Plot) imports a collection of genomic region datasets, and associates to each region multiple genomic feature measurements. It allows to align the regions in multiple ways (center, left, right or scale alignment), to smooth the feature curves (possibly filling gaps in the measurements) and to create a graphical representation of the feature measurements in each region datasets (aligned curves or pointwise quantile curves).</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Get the data</hands-on-title>\n  <ol>\n    <li>\n      <p>Create a new history for this tutorial</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-new-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-new-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a new history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>Click the <i class=\"fas fa-plus\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">new-history</span> icon at the top of the history panel:</p>   <p><img src=\"/training-material/shared/images/history_create_new.svg\" alt=\"UI for creating new history\" /></p>   <!-- the original drawing can be found here https://docs.google.com/drawings/d/1cCBrLAo4kDGic5QyB70rRiWJAKTenTU8STsKDaLcVU8/edit?usp=sharing --> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>Import datasets:\n      <ul>\n        <li>Fixed ETn (<code class=\"language-plaintext highlighter-rouge\">ETn_fixed.bed</code>) regions</li>\n        <li>Control (<code class=\"language-plaintext highlighter-rouge\">Control.bed</code>) regions</li>\n        <li>Recombination Hotspot (<code class=\"language-plaintext highlighter-rouge\">Recombination_hotspots.txt</code>) content</li>\n      </ul>\n\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/5589610/files/ETn_fixed.bed\nhttps://zenodo.org/record/5589610/files/Control.bed\nhttps://zenodo.org/record/5589610/files/Recombination_hotspots.txt\n</code></pre></div>      </div>\n    </li>\n    <li>Import header files for regions and features:\n      <ul>\n        <li><code class=\"language-plaintext highlighter-rouge\">regions_header.tabular</code></li>\n        <li><code class=\"language-plaintext highlighter-rouge\">features_header.tabular</code></li>\n      </ul>\n\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/5589610/files/regions_header.tabular\nhttps://zenodo.org/record/5589610/files/features_header.tabular\n</code></pre></div>      </div>\n\n      <p>Please note that the file names in the first column of the header files must exactly match the dataset names in the Galaxy history.</p>\n    </li>\n  </ol>\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Pre-process data and create pointwise boxplot</hands-on-title>\n  <p><strong>Load, Smooth and Plot</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>: Run <strong>Load, Smooth and Plot</strong> with:</p>\n  <ul>\n    <li>Select the two region datasets <code class=\"language-plaintext highlighter-rouge\">ETn_fixed.bed</code> and <code class=\"language-plaintext highlighter-rouge\">Control.bed</code>.</li>\n    <li>Select the region header file <code class=\"language-plaintext highlighter-rouge\">regions_header.tabular</code>.</li>\n    <li>Select the feature file <code class=\"language-plaintext highlighter-rouge\">Recombination_hotspot.txt</code>.</li>\n    <li>Select the feature header file <code class=\"language-plaintext highlighter-rouge\">features_header.tabular</code>.</li>\n    <li>Start positions are 0-based in this example; all region alignments are equivalent in this case.</li>\n    <li>You can choose to smooth the feature curves.</li>\n    <li>Select the graphical representation type <strong>Pointwise quantile curves (boxplot)</strong>.</li>\n  </ul>\n\n  <p><a href=\"../../images/load_smooth_and_plot_output.png\" rel=\"noopener noreferrer\"><img src=\"../../images/load_smooth_and_plot_output.png\" alt=\"Recombination hotspot pointwise boxplot. \" width=\"958\" height=\"765\" loading=\"lazy\" /></a></p>\n</blockquote>\n\n<h1 id=\"step-2-performing-interval-wise-testing\">Step 2: Performing Interval-Wise Testing</h1>\n\n<p>The second tool (IWTomics Test and Plot) statistically evaluates differences in genomic features between groups of regions along the genome. In particular, it implements the Interval-Wise Testing for omics data, an extended version of the Interval-Wise Testing for functional data presented in <span class=\"citation\"><a href=\"#Pini2017\">Pini and Vantini 2017</a></span>.</p>\n\n<p>It allows to perform multiple two sample permutation tests between pairs of region datasets, on several features. It returns the adjusted p-value curves for every test and all possible scales. Moreover, it creates a graphical representation of the Interval-Wise Testing results and a summary plot (optional) with p-values at the maximum scale. The tool IWTomics Plot with Threshold on Test Scale permits to select the scale to be used in the plots.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Test for difference between ETn and Control regions</hands-on-title>\n  <p><strong>Test and Plot</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>: Run <strong>Test and Plot</strong> with:</p>\n  <ul>\n    <li>Select the <code class=\"language-plaintext highlighter-rouge\">IWTomicsData Object</code>, <code class=\"language-plaintext highlighter-rouge\">Region Dataset IDs</code>, and <code class=\"language-plaintext highlighter-rouge\">Feature IDs</code> created during <strong>Step 1</strong>.</li>\n    <li>Select pairs of genomic region datasets to be compared using two-sample Interval-Wise Testing. In this example we consider one two-sample test contrasting <code class=\"language-plaintext highlighter-rouge\">ETn_fixed</code> (select it as <strong>Region 1</strong>) to <code class=\"language-plaintext highlighter-rouge\">Control</code> (select it as <strong>Region 2</strong>).</li>\n    <li>Select feature measurements to be tested. In this example, select <code class=\"language-plaintext highlighter-rouge\">Recomb_hot</code> feature.</li>\n    <li>You can choose the test statistic, the number of permutations, and the significance level of the test (alpha).</li>\n    <li>Select the graphical representation type <strong>Pointwise quantile curves (boxplot)</strong>.</li>\n  </ul>\n\n  <p><a href=\"../../images/test_and_plot_output.png\" rel=\"noopener noreferrer\"><img src=\"../../images/test_and_plot_output.png\" alt=\"Recombination hotspot IWT results. \" width=\"418\" height=\"586\" loading=\"lazy\" /></a></p>\n</blockquote>\n\n<h1 id=\"step-3-selecting-test-scale\">Step 3: Selecting test scale</h1>\n\n<p>The third tool (IWTomics Plot with Threshold on Test Scale) allows to select the scale for the Interval-Wise Testing results. In particular it returns the p-value curves for the different tests performed at the selected scale, and it creates a graphical representation of the Interval-Wise Testing results and a summary plot (optional) at the selected scale.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Change scale for test results</hands-on-title>\n  <p><strong>Plot with Threshold on Test Scale</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>: Run <strong>Plot with Threshold on Test Scale</strong> with:</p>\n  <ul>\n    <li>Select the <code class=\"language-plaintext highlighter-rouge\">IWTomicsData Object with Test Results</code>, <code class=\"language-plaintext highlighter-rouge\">Test IDs</code>, and <code class=\"language-plaintext highlighter-rouge\">Feature IDs</code> created during <strong>Step 2</strong>.</li>\n    <li>Select the scale to be used in Interval-Wise Testing results and plot. Select the test identifier <code class=\"language-plaintext highlighter-rouge\">ETn_fixed vs Control</code>, the feature identifier <code class=\"language-plaintext highlighter-rouge\">Recomb_hot</code>, and the scale <code class=\"language-plaintext highlighter-rouge\">8</code> (8-kb scale).</li>\n    <li>Select the graphical representation type <strong>Pointwise quantile curves (boxplot)</strong>.</li>\n  </ul>\n\n  <p><a href=\"../../images/plot_with_threshold_on_test_scale_output.png\" rel=\"noopener noreferrer\"><img src=\"../../images/plot_with_threshold_on_test_scale_output.png\" alt=\"Recombination hotspot IWT results scale 8. \" width=\"418\" height=\"584\" loading=\"lazy\" /></a></p>\n</blockquote>\n\n<blockquote class=\"details\">\n  <details-title>Additional resources</details-title>\n\n  <p>Read more about <strong>IWTomics</strong> <a href=\"https://bioconductor.org/packages/release/bioc/vignettes/IWTomics/inst/doc/IWTomics.pdf\">in the documentation (PDF)</a>.</p>\n</blockquote>\n"],"ref_slides":[],"hands_on":true,"slides":false,"mod_date":"2023-11-03 14:30:27 +0000","pub_date":"2018-06-14 09:51:52 +0000","version":33,"workflows":[{"workflow":"IWTomics_Workflow.ga","tests":false,"url":"https://training.galaxyproject.org/training-material/topics/statistics/tutorials/iwtomics/workflows/IWTomics_Workflow.ga","path":"topics/statistics/tutorials/iwtomics/workflows/IWTomics_Workflow.ga","wfid":"statistics-iwtomics","wfname":"iwtomics_workflow","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/statistics-iwtomics/versions/iwtomics_workflow","license":null,"creators":[],"name":"Workflow Constructed From History 'IWTomics Workflow'","title":"Workflow Constructed From History 'IWTomics Workflow'","test_results":null,"modified":"2024-06-21 00:05:32 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\nETn_fixed.bed\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"ℹ️ Input Dataset\\nControl.bed\"];\n  style 1 stroke:#2c3143,stroke-width:4px;\n  2[\"ℹ️ Input Dataset\\nfeatures_header.tabular\"];\n  style 2 stroke:#2c3143,stroke-width:4px;\n  3[\"ℹ️ Input Dataset\\nregions_header.tabular\"];\n  style 3 stroke:#2c3143,stroke-width:4px;\n  4[\"ℹ️ Input Dataset\\nRecombination_hotspots.txt\"];\n  style 4 stroke:#2c3143,stroke-width:4px;\n  5[\"IWTomics Load\"];\n  4 -->|output| 5;\n  2 -->|output| 5;\n  0 -->|output| 5;\n  1 -->|output| 5;\n  3 -->|output| 5;\n  6[\"IWTomics Test\"];\n  5 -->|outfeatures| 6;\n  5 -->|outrdata| 6;\n  5 -->|outregions| 6;\n  7[\"IWTomics Plot with Threshold\"];\n  6 -->|iwtomicsselectedfeatures| 7;\n  6 -->|iwtomicsrdata| 7;\n  6 -->|iwtomicstests| 7;"}],"api":"https://training.galaxyproject.org/training-material/api/topics/statistics/tutorials/iwtomics/tutorial.json","tools":["toolshed.g2.bx.psu.edu/repos/iuc/iwtomics_loadandplot/iwtomics_loadandplot/1.0.0.0","toolshed.g2.bx.psu.edu/repos/iuc/iwtomics_plotwithscale/iwtomics_plotwithscale/1.0.0.0","toolshed.g2.bx.psu.edu/repos/iuc/iwtomics_testandplot/iwtomics_testandplot/1.0.0.0"],"supported_servers":{"exact":[{"url":"https://usegalaxy.cz/","name":"UseGalaxy.cz","usegalaxy":false},{"url":"https://usegalaxy.eu","name":"UseGalaxy.eu","usegalaxy":true},{"url":"https://usegalaxy.no/","name":"UseGalaxy.no","usegalaxy":false},{"url":"https://usegalaxy.org","name":"UseGalaxy.org (Main)","usegalaxy":true},{"url":"https://usegalaxy.org.au","name":"UseGalaxy.org.au","usegalaxy":true}],"inexact":[]},"topic_name_human":"Statistics and machine learning","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"iwtomics_loadandplot","owner":"iuc","revisions":"ce633cc8f5f9","tool_panel_section_label":"Statistics","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"iwtomics_plotwithscale","owner":"iuc","revisions":"1bc9150ed125","tool_panel_section_label":"Statistics","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"iwtomics_testandplot","owner":"iuc","revisions":"94965e369be4","tool_panel_section_label":"Statistics","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: iwtomics_loadandplot\n  owner: iuc\n  revisions: ce633cc8f5f9\n  tool_panel_section_label: Statistics\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: iwtomics_plotwithscale\n  owner: iuc\n  revisions: 1bc9150ed125\n  tool_panel_section_label: Statistics\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: iwtomics_testandplot\n  owner: iuc\n  revisions: 94965e369be4\n  tool_panel_section_label: Statistics\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":false,"slides_recordings":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial"}