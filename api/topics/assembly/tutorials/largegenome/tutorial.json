{"layout":"tutorial_hands_on","title":"Large genome assembly and polishing","zenodo_link":"https://doi.org/10.5281/zenodo.7055935","tags":["assembly","polishing","nanopore"],"questions":["How can we assemble a large plant or animal genome?"],"objectives":["Assemble a large genome from long reads","Polish the assembly","Assess the quality of the assembly"],"time_estimation":"2h","key_points":["We can assemble long reads from plant or animal species into large contigs","These contigs can be polished with both long and short reads","We can assess the quality of this assembly with various tools"],"contributors":[{"name":"Anna Syme","joined":"2017-09","orcid":"0000-0002-9906-0673","id":"annasyme","url":"https://training.galaxyproject.org/training-material/api/contributors/annasyme.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/annasyme/"}],"recordings":[{"youtube_id":"BM70nvwWjOY","captioners":["annasyme"],"speakers":["annasyme"],"length":"25M","date":"2023-05-16","galaxy_version":"23.01"}],"js_requirements":{"mathjax":null,"mermaid":false},"short_id":"T00331","url":"/topics/assembly/tutorials/largegenome/tutorial.html","topic_name":"assembly","tutorial_name":"largegenome","dir":"topics/assembly/tutorials/largegenome","symlink":null,"id":"assembly/largegenome","ref_tutorials":["<p><em>Note: We recommend running this tutorial on either the Galaxy Europe or Galaxy Australia servers. Other servers (such as Galaxy main) have not yet been configured fully for all the tools in this analysis.</em></p>\n\n<h2 id=\"what-is-genome-assembly\">What is genome assembly?</h2>\n\n<p>A genome is a representation of the set of DNA in an organism, such as the set of chromosomes. When the DNA is extracted from the sample, it is broken up into fragments much smaller than the lengths of DNA in the chromosomes. After being sequenced, these fragments (and their copies) are called sequencing reads. To assemble the genome, we need to join the reads back into, ideally, chromosome-sized lengths.</p>\n\n<p><a href=\"images/sampletogenome.png\" rel=\"noopener noreferrer\"><img src=\"images/sampletogenome.png\" alt=\"&quot;Image showing the concept of a genome assembly: a sample (a tree), with an arrow going to sequencing reads, with an arrow going to a genome (a set of diploid chromosomes)&quot;. \" width=\"938\" height=\"270\" loading=\"lazy\" /></a></p>\n\n<h3 id=\"assembly-challenges\">Assembly challenges</h3>\n\n<p>In reality, we rarely get chromosome-length assemblies, due to many challenges. Here are some examples of particular challenges in a diploid genome assembly:</p>\n\n<p><a href=\"images/challenges.png\" rel=\"noopener noreferrer\"><img src=\"images/challenges.png\" alt=\"&quot;Image showing potential assembly challenges: a set of diploid chromosomes with descriptions of different problems which are: a contig may be a consensus from both chromosomes; telomeres and centromeres are difficult to assemble; contigs may be assembled separately as a copy in both chromosomes but it is unclear which parental chromosome they are from; some contigs are short or missing; some contigs are not placed in the assembly.&quot;. \" width=\"936\" height=\"436\" loading=\"lazy\" /></a></p>\n\n<p>Even though most assemblies are not chromosome-length, the assembly in contigs is still valuable for many research questions. Lengths of assembled contigs are increasing as sequencing technology and assembly tools improve.</p>\n\n<h3 id=\"can-i-use-my-own-data-with-these-workflows\">Can I use my own data with these workflows?</h3>\n\n<p>This tutorial has been tested on real-sized data sets and should work with your own data. However, there will most likely be some modifications required to tools and settings. Furthermore, as most species have never had their genome sequenced, it is not possible to guarantee existing workflows are optimal for new data.</p>\n\n<p>It is most likely that any new genome assembly will have its own set of required workflow and analysis customisations to account for things such as ploidy and repeats. Usually, an assembly workflow will need testing and customising, in concert with reading the biological domain literature.</p>\n\n<p>Before using these workflows on real datasets, we recommend completing all the relevant GTN tutorials about Data QC and Asssembly to give extra familiarity with the concepts. Then, we suggest creating subsampled data sets from your full-sized data, for testing. For best results, it is recommended to test each tool separately, and consider the parameters and their relevance and suitability for your own research questions.</p>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n  <p>In this tutorial we will deal with:</p>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#what-is-genome-assembly\" id=\"markdown-toc-what-is-genome-assembly\">What is genome assembly?</a></li>\n  <li><a href=\"#analysis-workflow\" id=\"markdown-toc-analysis-workflow\">Analysis workflow</a>    <ol>\n      <li><a href=\"#how-to-run-a-workflow-in-galaxy\" id=\"markdown-toc-how-to-run-a-workflow-in-galaxy\">How to run a workflow in Galaxy</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#upload-data\" id=\"markdown-toc-upload-data\">Upload data</a>    <ol>\n      <li><a href=\"#what-sequence-data-are-we-using-in-the-tutorial\" id=\"markdown-toc-what-sequence-data-are-we-using-in-the-tutorial\">What sequence data are we using in the tutorial?</a></li>\n      <li><a href=\"#how-has-this-data-subset-been-prepared\" id=\"markdown-toc-how-has-this-data-subset-been-prepared\">How has this data subset been prepared?</a></li>\n      <li><a href=\"#import-the-data\" id=\"markdown-toc-import-the-data\">Import the data</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#check-read-quality\" id=\"markdown-toc-check-read-quality\">Check read quality</a>    <ol>\n      <li><a href=\"#data-qc-workflow\" id=\"markdown-toc-data-qc-workflow\">Data QC workflow</a></li>\n      <li><a href=\"#data-qc-results\" id=\"markdown-toc-data-qc-results\">Data QC results</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#determine-genome-characteristics\" id=\"markdown-toc-determine-genome-characteristics\">Determine genome characteristics</a>    <ol>\n      <li><a href=\"#kmer-counting-workflow\" id=\"markdown-toc-kmer-counting-workflow\">Kmer counting workflow</a></li>\n      <li><a href=\"#kmer-counting-results\" id=\"markdown-toc-kmer-counting-results\">Kmer counting results</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#trim-and-filter-reads\" id=\"markdown-toc-trim-and-filter-reads\">Trim and filter reads</a>    <ol>\n      <li><a href=\"#trimming-and-filtering-workflow\" id=\"markdown-toc-trimming-and-filtering-workflow\">Trimming and filtering workflow</a></li>\n      <li><a href=\"#trim-and-filter-reads-results\" id=\"markdown-toc-trim-and-filter-reads-results\">Trim and filter reads: results</a></li>\n      <li><a href=\"#summary-of-read-data-for-genome-assembly\" id=\"markdown-toc-summary-of-read-data-for-genome-assembly\">Summary of read data for genome assembly</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#genome-assembly\" id=\"markdown-toc-genome-assembly\">Genome Assembly</a>    <ol>\n      <li><a href=\"#which-assembly-tool-and-approach-to-use\" id=\"markdown-toc-which-assembly-tool-and-approach-to-use\">Which assembly tool and approach to use?</a></li>\n      <li><a href=\"#assembly-with-flye-workflow\" id=\"markdown-toc-assembly-with-flye-workflow\">Assembly with Flye workflow</a></li>\n      <li><a href=\"#assembly-results\" id=\"markdown-toc-assembly-results\">Assembly results</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#assembly-polishing\" id=\"markdown-toc-assembly-polishing\">Assembly polishing</a>    <ol>\n      <li><a href=\"#polishing-workflow\" id=\"markdown-toc-polishing-workflow\">Polishing workflow</a></li>\n      <li><a href=\"#polishing-results\" id=\"markdown-toc-polishing-results\">Polishing results</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#genome-quality-assessment\" id=\"markdown-toc-genome-quality-assessment\">Genome quality assessment</a>    <ol>\n      <li><a href=\"#genome-assessment-workflow\" id=\"markdown-toc-genome-assessment-workflow\">Genome assessment workflow</a></li>\n      <li><a href=\"#assessment-results\" id=\"markdown-toc-assessment-results\">Assessment results</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#combining-workflows\" id=\"markdown-toc-combining-workflows\">Combining workflows</a>    <ol>\n      <li><a href=\"#combined-assembly-and-polishing-workflow\" id=\"markdown-toc-combined-assembly-and-polishing-workflow\">Combined assembly and polishing workflow</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#summary\" id=\"markdown-toc-summary\">Summary</a></li>\n</ol>\n\n</blockquote>\n\n<h1 id=\"analysis-workflow\">Analysis workflow</h1>\n\n<p>In this tutorial, we will follow these steps:</p>\n\n<p><a href=\"images/steps.png\" rel=\"noopener noreferrer\"><img src=\"images/steps.png\" alt=\"&quot;An image showing the steps in the tutorial in a stylized form: quality control and kmer counting, represented by bold lines as sequencing reads; trimming and filtering reads, represented by truncated reads; assembly, represented by joined reads into one long piece; polishing, represented by corrections (ticks) in the assembly; the finished genome assembly, represented by a set of diploid chromosomes; quality assessment, represented by ticks and crosses at different chromosome locations.&quot;. \" width=\"960\" height=\"540\" loading=\"lazy\" /></a></p>\n\n<ul>\n  <li>Each of these steps is described in a section in this tutorial.</li>\n  <li>For each step, we will run a workflow.</li>\n  <li>We will stay in the same Galaxy history throughout.</li>\n</ul>\n\n<h2 id=\"how-to-run-a-workflow-in-galaxy\">How to run a workflow in Galaxy</h2>\n\n<ul>\n  <li>All of these workflows have been uploaded to <a href=\"https://workflowhub.eu/\">workflowhub.eu</a> and have been tagged with “Large-genome-assembly”. There, each workflow is accompanied by an image of the workflow canvas and the tool connections.</li>\n  <li>The workflows are also linked to this tutorial - see above and import them into your own Galaxy Account.</li>\n  <li>If you are using Galaxy Australia, the workflows are published with the tag “lg-wf”.</li>\n  <li>A note: as of September 2022, these workflows have been tested on Galaxy Australia and we are now in the process of testing them on Galaxy Europe and Galaxy Main.</li>\n</ul>\n\n<p>Here is a list of the workflows:</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>Tutorial section</th>\n      <th>Workflow name</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>Quality Control</td>\n      <td>Data QC</td>\n    </tr>\n    <tr>\n      <td>Kmer counting</td>\n      <td>kmer counting - meryl</td>\n    </tr>\n    <tr>\n      <td>Trim and filter reads</td>\n      <td>Trim and filter reads - fastp</td>\n    </tr>\n    <tr>\n      <td>Assembly</td>\n      <td>Assembly with Flye</td>\n    </tr>\n    <tr>\n      <td>Polish assembly</td>\n      <td>Assembly polishing</td>\n    </tr>\n    <tr>\n      <td>Assess quality</td>\n      <td>Assess genome quality</td>\n    </tr>\n  </tbody>\n</table>\n\n<!--SNIPPET-->\n<blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-import-workflows-from-workflowhub\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-import-workflows-from-workflowhub\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Import workflows from WorkflowHub</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p><a href=\"https://workflowhub.eu/\">WorkflowHub</a> is a workflow management system which allows workflows to be FAIR (Findable, Accessible, Interoperable, and Reusable), citable, have managed metadata profiles, and be openly available for review and analytics.</p>   <ol>   <li>Ensure that you are logged in to your Galaxy account.</li>   <li>Click on the <strong>Workflow</strong> menu, located in the top bar.</li>   <li>Click on the <strong>Import</strong> button, located in the right corner.</li>   <li>In the section “Import a Workflow from Configured GA4GH Tool Registry Servers (e.g. Dockstore)”, click on <strong>Search form</strong>.</li>   <li>In the <strong>TRS Server: <em>workflowhub.eu</em></strong> menu you should type <code class=\"language-plaintext highlighter-rouge\">Large-genome-assembly</code> <img src=\"/training-material/topics/assembly/images/vgp_assembly/workflow_list.png\" alt=\"galaxy TRS workflow search field, name:vgp is entered in the search bar, and five different workflows all labelled VGP are listed\" /></li>   <li>Click on the desired workflow, and finally select the latest available version.</li> </ol>   <p>After that, the imported workflows will appear in the main workflow menu. In order to run the workflow, just need to click in the <i class=\"fas fa-play\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">workflow-run</span> <strong>Run workflow</strong> icon.</p>   <p>Below is a short video showing this uncomplicated procedure:</p>   <figure> <iframe credentialless=\"\" allowfullscreen=\"\" referrerpolicy=\"no-referrer\" sandbox=\"allow-scripts allow-same-origin\" allow=\"accelerometer 'none'; ambient-light-sensor 'none'; autoplay 'none'; battery 'none'; bluetooth 'none'; browsing-topics 'none'; camera 'none'; ch-ua 'none'; display-capture 'none'; domain-agent 'none'; document-domain 'none'; encrypted-media 'none'; execution-while-not-rendered 'none'; execution-while-out-of-viewport 'none'; gamepad 'none'; geolocation 'none'; gyroscope 'none'; hid 'none'; identity-credentials-get 'none'; idle-detection 'none'; keyboard-map 'none'; local-fonts 'none'; magnetometer 'none'; microphone 'none'; midi 'none'; navigation-override 'none'; otp-credentials 'none'; payment 'none'; picture-in-picture 'none'; publickey-credentials-create 'none'; publickey-credentials-get 'none'; screen-wake-lock 'none'; serial 'none'; speaker-selection 'none'; sync-xhr 'none'; usb 'none'; web-share 'none'; window-management 'none'; xr-spatial-tracking 'none'\" csp=\"sandbox allow-scripts allow-same-origin;\" width=\"560\" height=\"315\" src=\"https://www.youtube-nocookie.com/embed/hoP36Te5wko\" title=\"Importing from WorkflowHub\" frameborder=\"0\" loading=\"lazy\"></iframe> <figcaption>   <span class=\"figcaption-prefix\"><strong>Video</strong>:</span> Importing from WorkflowHub</figcaption> </figure> </blockquote>\n<p><!--END_SNIPPET--></p>\n\n<p>After importing the workflows into your account:</p>\n\n<ul>\n  <li>Look at your of Workflows. (Galaxy top panel: Workflow)</li>\n  <li>For the workflow you want to run, go to the right hand side and see the arrow button (a triangle), click</li>\n  <li>This brings up the workflow in the centre Galaxy panel</li>\n  <li>Click “Expand to full workflow form”</li>\n  <li>For “Send results to a new history”, leave it as “No”.</li>\n  <li>Each time you run a workflow, you need to specify the input data set (or sets). Galaxy will try to guess which file this is, but change if required using the drop-down arrow.</li>\n  <li>At the top right, click “Run Workflow”.</li>\n  <li>The result files will appear at the top of your current history</li>\n</ul>\n\n<p>Each workflow will be discussed in a separate section.</p>\n\n<h1 id=\"upload-data\">Upload data</h1>\n\n<p>Let’s start with uploading the data.</p>\n\n<h2 id=\"what-sequence-data-are-we-using-in-the-tutorial\">What sequence data are we using in the tutorial?</h2>\n\n<ul>\n  <li>The data sets for genome projects can be very large and tools can take some time to run. It is a good idea to test that your planned tools and workflows will work on smaller-sized test data sets, as it is much quicker to find out about any problems.</li>\n  <li>In this tutorial we will use a subset of real sequencing data from a plant genome, the snow gum, <em>Eucalyptus pauciflora</em>, from a genome project described in this paper: <span class=\"citation\"><a href=\"#Wang2020\">Wang <i>et al.</i> 2020</a></span>. Data is hosted at NCBI BioProject number: PRJNA450887.</li>\n</ul>\n\n<h2 id=\"how-has-this-data-subset-been-prepared\">How has this data subset been prepared?</h2>\n\n<ul>\n  <li>From NCBI, three read files were imported into Galaxy for this tutorial: nanopore reads (SRR7153076), and paired Illumina reads (SRR7153045).</li>\n  <li>These were randomly subsampled to 10% of the original file size.</li>\n  <li>Plant genomes may contain an excess of reads from the chloroplast genome (of which there are many copies per cell). To ensure our test data sets are not swamped from excessive chloroplast-genome reads, reads that mapped to a set of known chloroplast gene sequences were discarded.</li>\n</ul>\n\n<p>We are also using a reference genome <em>Arabidopsis thaliana</em> for a later comparison step - file TAIR10_chr_all.fas downloaded from <a href=\"https://www.arabidopsis.org/download/index-auto.jsp?dir=%2Fdownload_files%2FGenes%2FTAIR10_genome_release%2FTAIR10_chromosome_files\">The Arabidopsis Information Resource</a>.</p>\n\n<h2 id=\"import-the-data\">Import the data</h2>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Import the data</hands-on-title>\n  <ol>\n    <li>\n      <p>Create a new history for this tutorial and give it a proper name</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-new-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-new-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a new history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>Click the <i class=\"fas fa-plus\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">new-history</span> icon at the top of the history panel:</p>   <p><img src=\"/training-material/shared/images/history_create_new.svg\" alt=\"UI for creating new history\" /></p>   <!-- the original drawing can be found here https://docs.google.com/drawings/d/1cCBrLAo4kDGic5QyB70rRiWJAKTenTU8STsKDaLcVU8/edit?usp=sharing --> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-renaming-a-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-renaming-a-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Renaming a history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ol>   <li>Click on <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> (<strong>Edit</strong>) next to the history name (which by default is “Unnamed history”)</li>   <li>Type the new name</li>   <li>Click on <strong>Save</strong></li> </ol>   <p>If you do not have the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> (<strong>Edit</strong>) next to the history name:</p>   <ol>   <li>Click on <strong>Unnamed history</strong> (or the current name of the history) (<strong>Click to rename history</strong>) at the top of your history panel</li>   <li>Type the new name</li>   <li>Press <kbd>Enter</kbd></li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Import from <a href=\"https://zenodo.org/record/7055935\">Zenodo</a> or a data library (ask your instructor):</p>\n\n      <ul>\n        <li>2 FASTQ files with illumina reads: these files have a R1 or R2 in the name</li>\n        <li>1 FASTQ file with nanopore reads: this file has nano in the name</li>\n        <li>1 FASTQ file for the genome Arabidopsis</li>\n      </ul>\n\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/7055935/files/Eucalyptus_subsample_ten_pc_SRR7153045_R1.fastq.gz\nhttps://zenodo.org/record/7055935/files/Eucalyptus_subsample_ten_pc_SRR7153045_R2.fastq.gz\nhttps://zenodo.org/record/7055935/files/Eucalyptus_subsample_ten_pc_nano_SRR7153076.fastq.gz\nhttps://zenodo.org/record/7055935/files/Ref_genome_Arabidopsis.fasta\n</code></pre></div>      </div>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-via-links\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-via-links\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing via links</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-data-from-a-data-library\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-data-from-a-data-library\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing data from a data library</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>As an alternative to uploading the data from a URL or your computer, the files may also have been made available from a <em>shared data library</em>:</p>   <ol>   <li>Go into <strong>Shared data</strong> (top panel) then <strong>Data libraries</strong></li>   <li>Navigate to  the correct folder as indicated by your instructor.     <ul>       <li>On most Galaxies tutorial data will be provided in a folder named <strong>GTN - Material –&gt; Topic Name -&gt; Tutorial Name</strong>.</li>     </ul>   </li>   <li>Select the desired files</li>   <li>Click on <strong>Add to History</strong> <i class=\"fas fa-caret-down\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-dropdown</span> near the top and select <strong>as Datasets</strong> from the dropdown menu</li>   <li>     <p>In the pop-up window, choose</p>     <ul>       <li><em>“Select history”</em>: the history you want to import the data to (or create a new one)</li>     </ul>   </li>   <li>Click on <strong>Import</strong></li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Check that the datatypes for the three files of sequencing reads are <code class=\"language-plaintext highlighter-rouge\">fastq.gz</code>, not <code class=\"language-plaintext highlighter-rouge\">fastqsanger.gz</code> and change datatype if needed.</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-changing-the-datatype\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-changing-the-datatype\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Changing the datatype</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, click <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Datatypes</strong> tab on the top</li>   <li>In the <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Assign Datatype</strong>, select <code class=\"language-plaintext highlighter-rouge\">datatypes</code> from “<em>New type</em>” dropdown     <ul>       <li>Tip: you can start typing the datatype into the field to filter the dropdown menu</li>     </ul>   </li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<ul>\n  <li>This tutorial uses these input files and gives some examples from the results.</li>\n  <li>It is likely that your results will differ slightly (e.g. number of bases in the genome assembly). This is common, because many tools start from different random seeds.</li>\n  <li>Also, tool versions are being constantly updated.  Newer versions may be available since this tutorial was written and could give slightly different results.</li>\n</ul>\n\n<h1 id=\"check-read-quality\">Check read quality</h1>\n\n<p>Let’s look at how many reads we have and their quality scores using the Data QC workflow.</p>\n\n<h2 id=\"data-qc-workflow\">Data QC workflow</h2>\n\n<p>What it does: Reports statistics from sequencing reads</p>\n\n<p>Inputs:</p>\n<ul>\n  <li>long reads (fastq.gz format)</li>\n  <li>short reads (R1 and R2) (fastq.gz format)</li>\n</ul>\n\n<p>Outputs:</p>\n<ul>\n  <li>For long reads: a nanoplot report (the HTML report summarizes all the information).</li>\n  <li>For short reads: a MultiQC report</li>\n</ul>\n\n<p>Tools used:</p>\n<ul>\n  <li>Nanoplot</li>\n  <li>FastQC</li>\n  <li>MultiQC</li>\n</ul>\n\n<p>Workflow steps:</p>\n<ul>\n  <li>Long reads are analysed by Nanoplot.</li>\n  <li>Short reads (R1 and R2) are analysed by FastQC</li>\n  <li>the resulting reports are processed by MultiQC</li>\n</ul>\n\n<p>Options:</p>\n<ul>\n  <li>See the tool settings options at runtime and change as required.</li>\n  <li>Alternative tool option: fastp</li>\n</ul>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Run the Data QC workflow</hands-on-title>\n\n  <ol>\n    <li>\n      <p><strong>Import the workflow</strong> into Galaxy:</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"hands_on\">   <div class=\"box-title hands_on-title\" id=\"hands-on-importing-and-launching-a-gtn-workflow\"><i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i> Hands-on: Importing and launching a GTN workflow</div>   <div class=\"show-when-galaxy-proxy-active\"> <span class=\"workflow\" data-workflow=\"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/assembly-largegenome/versions/galaxy-workflow-data_qc\">Launch <strong>Galaxy Workflow Data QC</strong> <i class=\"fas fa-share-alt\" aria-hidden=\"true\"></i></span> (<a href=\"https://github.com/galaxyproject/training-material/blob/main/topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-Data_QC.ga\">View on GitHub</a>, <a href=\"https://training.galaxyproject.org/training-material/topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-Data_QC.ga\">Download workflow</a>) workflow. </div>   <div class=\"hide-when-galaxy-proxy-active\"> Click to  <a href=\"https://my.galaxy.training/?path=/workflows/trs_import%3Frun_form=true%26trs_url=https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/assembly-largegenome/versions/galaxy-workflow-data_qc\">     Launch <strong>Galaxy Workflow Data QC</strong> <i class=\"fas fa-share-alt\" aria-hidden=\"true\"></i> </a> (<a href=\"https://github.com/galaxyproject/training-material/blob/main/topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-Data_QC.ga\">View on GitHub</a>, <a href=\"https://training.galaxyproject.org/training-material/topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-Data_QC.ga\">Download workflow</a>) </div>   <!--SNIPPET-->   <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-if-this-does-not-work\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-if-this-does-not-work\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: If this does not work</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on <em>Workflow</em> on the top menu bar of Galaxy. You will see a list of all your workflows.</li>   <li>Click on <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Import</strong> at the top-right of the screen</li>   <li>Paste the following URL into the box labelled <em>“Archived Workflow URL”</em>: <code class=\"language-plaintext highlighter-rouge\">https://training.galaxyproject.org/training-material/topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-Data_QC.ga</code></li>   <li>Click the <strong>Import workflow</strong> button</li> </ul>   <p>Below is a short video demonstrating how to import a workflow from GitHub using this procedure:</p>   <figure> <iframe credentialless=\"\" allowfullscreen=\"\" referrerpolicy=\"no-referrer\" sandbox=\"allow-scripts allow-same-origin\" allow=\"accelerometer 'none'; ambient-light-sensor 'none'; autoplay 'none'; battery 'none'; bluetooth 'none'; browsing-topics 'none'; camera 'none'; ch-ua 'none'; display-capture 'none'; domain-agent 'none'; document-domain 'none'; encrypted-media 'none'; execution-while-not-rendered 'none'; execution-while-out-of-viewport 'none'; gamepad 'none'; geolocation 'none'; gyroscope 'none'; hid 'none'; identity-credentials-get 'none'; idle-detection 'none'; keyboard-map 'none'; local-fonts 'none'; magnetometer 'none'; microphone 'none'; midi 'none'; navigation-override 'none'; otp-credentials 'none'; payment 'none'; picture-in-picture 'none'; publickey-credentials-create 'none'; publickey-credentials-get 'none'; screen-wake-lock 'none'; serial 'none'; speaker-selection 'none'; sync-xhr 'none'; usb 'none'; web-share 'none'; window-management 'none'; xr-spatial-tracking 'none'\" csp=\"sandbox allow-scripts allow-same-origin;\" width=\"560\" height=\"315\" src=\"https://www.youtube-nocookie.com/embed/hoP36Te5wko\" title=\"Importing a workflow from URL\" frameborder=\"0\" loading=\"lazy\"></iframe> <figcaption>   <span class=\"figcaption-prefix\"><strong>Video</strong>:</span> Importing a workflow from URL</figcaption> </figure> </blockquote>   <p><!--END_SNIPPET--></p> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <ul>\n        <li>Click “Expand to full workflow form”</li>\n      </ul>\n    </li>\n    <li>\n      <p>Run <strong>Data QC</strong> <i class=\"fas fa-share-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">workflow</span> using the following parameters:</p>\n      <ul>\n        <li><em>“Send results to a new history”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“1: Input file: long reads”</em>: the nanopore fastq.gz file</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“2: Input file: Illumina reads R1”</em>: the illumina R1 fastq.gz file</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“3: Input file: Illumina reads R2”</em>: the illumina R2 fastq.gz file</li>\n      </ul>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-running-a-workflow\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-running-a-workflow\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Running a workflow</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on <em>Workflow</em> on the top menu bar of Galaxy. You will see a list of all your workflows.</li>   <li>Click on the <i class=\"fas fa-play\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">workflow-run</span> (<em>Run workflow</em>) button next to your workflow</li>   <li>Configure the workflow as needed</li>   <li>Click the <strong>Run Workflow</strong> button at the top-right of the screen</li>   <li>You may have to refresh your history to see the queued jobs</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n</blockquote>\n\n<h2 id=\"data-qc-results\">Data QC results</h2>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>What are the results from the two output files? Are the reads long enough and of high enough quality for our downstream analyses?  Will reads need any trimming or filtering?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>Common things to check are average read length, average quality, and whether quality varies by position in the reads.\n        <ul>\n          <li>Look at the plot for MultiQC for the Sequence Quality Histograms. This shows how the read quality of Illumina reads (y axis) varies according to base position (x axis).You may see for Illumina reads that there is some drop-off in quality towards the end of the reads, which may benefit from trimming.</li>\n          <li>Look at the plot from Nanoplot for “Read lengths vs Average read quality”. The nanopore reads have a mean read quality of 9.0. Depending on the size of our input read sets and the research question, we may filter out reads below a certain average quality. If we had a lot of reads, we may be able to set a higher threshold for filtering according to read quality.</li>\n        </ul>\n      </li>\n    </ol>\n  </blockquote>\n</blockquote>\n\n<blockquote class=\"comment\">\n  <comment-title>Additional information about the tools</comment-title>\n  <p>More about interpreting nanoplot plots:</p>\n  <ul>\n    <li><a href=\"https://github.com/wdecoster/NanoPlot\">Nanoplot on Github</a></li>\n    <li><a href=\"https://gigabaseorgigabyte.wordpress.com/2017/06/01/example-gallery-of-nanoplot/\">Example nanoplots</a></li>\n  </ul>\n\n  <p>More about FastQC results:</p>\n  <ul>\n    <li><a href=\"https://www.bioinformatics.babraham.ac.uk/projects/fastqc/\">FastQC webpage</a></li>\n    <li><a href=\"https://timkahlke.github.io/LongRead_tutorials/QC_F.html\">FastQC tips</a></li>\n  </ul>\n</blockquote>\n\n<h1 id=\"determine-genome-characteristics\">Determine genome characteristics</h1>\n\n<p>To prepare for genome assembly you might want to know things about your genome such as size, ploidy level (how many sets of chromosomes) and heterozygosity (how variable the sequence is between homologous chromosomes). A relatively fast way to estimate these things is to count small fragments of the sequencing reads (called kmers).</p>\n\n<p>A read broken into kmers:</p>\n\n<p><a href=\"images/kmers.png\" rel=\"noopener noreferrer\"><img src=\"images/kmers.png\" alt=\"&quot;An image of the a read broken into kmers: the read is a bold bar with the letters ABCDEF; each kmer is a smaller bar with three letters in it: the kmers are ABC, BCD, CDE, and DEF.&quot;. \" width=\"819\" height=\"414\" loading=\"lazy\" /></a></p>\n\n<blockquote class=\"comment\">\n  <comment-title>What is kmer counting?</comment-title>\n\n  <p>Kmer counting is usually done with high-accuracy short reads, not long reads which may have high error rates.  After counting how many times each kmer is seen in the reads, we can see what sorts of counts are common. For example, lots of kmers may have been found 24 or 25 times. A graph shows the number of different kmers (y axis) found at different counts, or depths (x axis).</p>\n\n  <p>Many different kmers will be found the same number of times; e.g. X25. If kmer length approaches read length, this means the average depth of your sequencing is also ~X25, and there would be a peak in the graph at this position (smaller kmers = higher kmer depth). There may be smaller peaks of kmer counts at higher depths, e.g. X50 or X100, indicating repeats in the genome. There may be other smaller peaks of kmers found at half the average depth, indicating a diploid genome with a certain amount of difference between the homologous chromosomes - this is known as heterozygosity. Thus, the plot of how many different kmers are found at all the depths will help inform estimates of sequencing depth, ploidy level, heterozygosity, and genome size.</p>\n</blockquote>\n\n<h2 id=\"kmer-counting-workflow\">Kmer counting workflow</h2>\n\n<p>What it does: Estimates genome size and heterozygosity based on counts of kmers</p>\n\n<p>Inputs: One set of short reads: e.g. R1.fq.gz</p>\n\n<p>Outputs: GenomeScope graphs</p>\n\n<p>Tools used:</p>\n<ul>\n  <li>Meryl</li>\n  <li>GenomeScope</li>\n</ul>\n\n<p>Workflow steps:</p>\n<ul>\n  <li>The tool meryl counts kmers in the input reads (k=21), then converts this into a histogram.</li>\n  <li>GenomeScope: runs a model on the histogram; reports estimates. k-mer size set to 21.</li>\n</ul>\n\n<p>Options:</p>\n<ul>\n  <li>Use a different kmer counting tool. e.g. khmer. If so, for the settings, advanced parameters:</li>\n  <li>k-mer size: 21 (as per <a href=\"https://github.com/schatzlab/genomescope/issues/32\">this recommendation</a>).</li>\n  <li>n_tables: 4. tablesize: set at 8 billion (as per <a href=\"https://khmer.readthedocs.io/en/v1.0/choosing-table-sizes.html\">this recommendation</a>).</li>\n  <li>Will also need to run some formatting steps to convert khmer output to a two-column matrix, for the  Genomscope. See <a href=\"https://usegalaxy.org.au/u/anna/w/kmer-counting-khmer\">this workflow</a>.</li>\n  <li>Note: khmer: to use both R1 and R2 read sets, khmer needs these paired reads in interleaved format.</li>\n</ul>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Run the Kmer counting workflow</hands-on-title>\n\n  <ol>\n    <li><strong>Import the Kmer counting workflow</strong> into Galaxy:\n      <ul>\n        <li>Copy the URL (e.g. via right-click) of <a href=\"/training-material/topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-kmer_counting.ga\">this workflow</a> or download it to your computer.</li>\n        <li>Import the workflow into Galaxy</li>\n      </ul>\n    </li>\n    <li>\n      <p><strong>Import the workflow</strong> into Galaxy:</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"hands_on\">   <div class=\"box-title hands_on-title\" id=\"hands-on-importing-and-launching-a-gtn-workflow-1\"><i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i> Hands-on: Importing and launching a GTN workflow</div>   <div class=\"show-when-galaxy-proxy-active\"> <span class=\"workflow\" data-workflow=\"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/assembly-largegenome/versions/galaxy-workflow-kmer_counting\">Launch <strong>Kmer counting workflow</strong> <i class=\"fas fa-share-alt\" aria-hidden=\"true\"></i></span> (<a href=\"https://github.com/galaxyproject/training-material/blob/main/topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-kmer_counting.ga\">View on GitHub</a>, <a href=\"https://training.galaxyproject.org/training-material/topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-kmer_counting.ga\">Download workflow</a>) workflow. </div>   <div class=\"hide-when-galaxy-proxy-active\"> Click to  <a href=\"https://my.galaxy.training/?path=/workflows/trs_import%3Frun_form=true%26trs_url=https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/assembly-largegenome/versions/galaxy-workflow-kmer_counting\">     Launch <strong>Kmer counting workflow</strong> <i class=\"fas fa-share-alt\" aria-hidden=\"true\"></i> </a> (<a href=\"https://github.com/galaxyproject/training-material/blob/main/topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-kmer_counting.ga\">View on GitHub</a>, <a href=\"https://training.galaxyproject.org/training-material/topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-kmer_counting.ga\">Download workflow</a>) </div>   <!--SNIPPET-->   <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-if-this-does-not-work-1\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-if-this-does-not-work-1\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: If this does not work</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on <em>Workflow</em> on the top menu bar of Galaxy. You will see a list of all your workflows.</li>   <li>Click on <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Import</strong> at the top-right of the screen</li>   <li>Paste the following URL into the box labelled <em>“Archived Workflow URL”</em>: <code class=\"language-plaintext highlighter-rouge\">https://training.galaxyproject.org/training-material/topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-kmer_counting.ga</code></li>   <li>Click the <strong>Import workflow</strong> button</li> </ul>   <p>Below is a short video demonstrating how to import a workflow from GitHub using this procedure:</p>   <figure> <iframe credentialless=\"\" allowfullscreen=\"\" referrerpolicy=\"no-referrer\" sandbox=\"allow-scripts allow-same-origin\" allow=\"accelerometer 'none'; ambient-light-sensor 'none'; autoplay 'none'; battery 'none'; bluetooth 'none'; browsing-topics 'none'; camera 'none'; ch-ua 'none'; display-capture 'none'; domain-agent 'none'; document-domain 'none'; encrypted-media 'none'; execution-while-not-rendered 'none'; execution-while-out-of-viewport 'none'; gamepad 'none'; geolocation 'none'; gyroscope 'none'; hid 'none'; identity-credentials-get 'none'; idle-detection 'none'; keyboard-map 'none'; local-fonts 'none'; magnetometer 'none'; microphone 'none'; midi 'none'; navigation-override 'none'; otp-credentials 'none'; payment 'none'; picture-in-picture 'none'; publickey-credentials-create 'none'; publickey-credentials-get 'none'; screen-wake-lock 'none'; serial 'none'; speaker-selection 'none'; sync-xhr 'none'; usb 'none'; web-share 'none'; window-management 'none'; xr-spatial-tracking 'none'\" csp=\"sandbox allow-scripts allow-same-origin;\" width=\"560\" height=\"315\" src=\"https://www.youtube-nocookie.com/embed/hoP36Te5wko\" title=\"Importing a workflow from URL\" frameborder=\"0\" loading=\"lazy\"></iframe> <figcaption>   <span class=\"figcaption-prefix\"><strong>Video</strong>:</span> Importing a workflow from URL</figcaption> </figure> </blockquote>   <p><!--END_SNIPPET--></p> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <ul>\n        <li>Click “Expand to full workflow form”</li>\n      </ul>\n    </li>\n    <li>Run <strong>Kmer counting</strong> <i class=\"fas fa-share-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">workflow</span> using the following parameters:\n      <ul>\n        <li><em>“Send results to a new history”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“1: Input file: Illumina reads R1”</em>: the illumina R1 fastq.gz file</li>\n      </ul>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-running-a-workflow-1\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-running-a-workflow-1\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Running a workflow</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on <em>Workflow</em> on the top menu bar of Galaxy. You will see a list of all your workflows.</li>   <li>Click on the <i class=\"fas fa-play\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">workflow-run</span> (<em>Run workflow</em>) button next to your workflow</li>   <li>Configure the workflow as needed</li>   <li>Click the <strong>Run Workflow</strong> button at the top-right of the screen</li>   <li>You may have to refresh your history to see the queued jobs</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n</blockquote>\n\n<h2 id=\"kmer-counting-results\">Kmer counting results</h2>\n\n<p>GenomeScope transformed linear plot:</p>\n\n<p><a href=\"images/genomescope.png\" rel=\"noopener noreferrer\"><img src=\"images/genomescope.png\" alt=\"&quot;An image of the Genomescope plot, described fully in the text following this image.&quot;. \" width=\"791\" height=\"791\" loading=\"lazy\" /></a></p>\n\n<p>Here we can see a central peak - showing that most of the different kmers were found at counts of ~ 120. These are kmers from single-copy homozygous alleles. To the left, a smaller peak at around half the coverage, showing kmers from heterozygous alleles (note that this peak gets higher than the main peak when heterozygosity is only ~ 1.2%). To the right, another smaller peak showing kmers at higher coverage, from repeat regions. Information from these three peaks provide a haploid genome length estimate of ~240,000 bp (note this is test data so smaller than whole plant genome size).</p>\n\n<p>The output Summary file shows more detail:</p>\n<ul>\n  <li>Genome unique length: from single copy homozygous and heterozygous alleles (under the main and left peak).</li>\n  <li>Genome repeat length: from repeat copies (under the graph to the right of the main peak).</li>\n  <li>Genome haploid length: unique length + repeat length</li>\n</ul>\n\n<p>More about kmer counting: See <a href=\"https://bioinformatics.uconn.edu/genome-size-estimation-tutorial/#\">this tutorial</a></p>\n\n<p>For more about Meryl see <span class=\"citation\"><a href=\"#Rhie2020\">Rhie <i>et al.</i> 2020</a></span>.</p>\n\n<p>For more about Genomescope see <span class=\"citation\"><a href=\"#Vurture2017\">Vurture <i>et al.</i> 2017</a></span>(Note: the supplementary information is very informative).</p>\n\n<h1 id=\"trim-and-filter-reads\">Trim and filter reads</h1>\n\n<p>Using information from Data QC and kmer counting, we may want to trim and/or filter reads. The settings for trimming and filtering depend on many things, including:</p>\n<ul>\n  <li>your aim (accuracy; contiguity)</li>\n  <li>your data: type, error rate, read depth, lengths, quality (average, variation by position)</li>\n  <li>the ploidy and heterozygosity of your sample</li>\n  <li>choice of assembly tool (e.g. it may automatically deal with adapters, low qualities, etc.)</li>\n</ul>\n\n<p>Because of all these factors, few specific recommendations are made here, but the workflow is provided and can be customised. If you are unsure how to start, use your test data to try different settings and see the effect on the resulting size and quality of the reads, and the downstream assembly contigs. Newer assemblers are often configured to work well with long-read data and in some cases, read trimming/filtering for long reads may be unnecessary.</p>\n\n<p>Trimming and filtering reads:</p>\n\n<p><a href=\"images/trimfilterreads.png\" rel=\"noopener noreferrer\"><img src=\"images/trimfilterreads.png\" alt=\"&quot;An image of the concepts of trimming and filtering reads, with reads represented by bold bars; trimming represented by crosses over various locations in each read.&quot;. \" width=\"830\" height=\"409\" loading=\"lazy\" /></a></p>\n\n<h2 id=\"trimming-and-filtering-workflow\">Trimming and filtering workflow</h2>\n\n<p>What it does: Trims and filters raw sequence reads according to specified settings.</p>\n\n<p>Inputs:</p>\n<ul>\n  <li>Long reads (format fastq)</li>\n  <li>Short reads R1 and R2 (format fastq)</li>\n</ul>\n\n<p>Outputs: Trimmed and filtered reads:</p>\n<ul>\n  <li>fastp_filtered_long_reads.fastq.gz (But note: no trimming or filtering is on by default)</li>\n  <li>fastp_filtered_R1.fastq.gz</li>\n  <li>fastp_filtered_R2.fastq.gz</li>\n</ul>\n\n<p>Tools used:  fastp (Note. The latest version (0.20.1) of fastp has an issue displaying plot results. Using version 0.19.5 here instead until this is rectified).</p>\n\n<p>Input parameters: None required, but recommend removing the long reads from the workflow if not using any trimming/filtering settings.</p>\n\n<p>Workflow parameter settings:</p>\n<ul>\n  <li>Long reads: fastp settings:\n    <ul>\n      <li>These settings have been changed from the defaults (so that all filtering and trimming settings are now disabled).</li>\n      <li>Adapter trimming options: Disable adapter trimming: yes.</li>\n      <li>Filter options: Quality filtering options: Disable quality filtering: yes.</li>\n      <li>Filter options: Length filtering options: Disable length filtering: yes.</li>\n      <li>Read modification options: PolyG tail trimming: Disable.</li>\n      <li>Output options: output JSON report: yes</li>\n    </ul>\n  </li>\n  <li>Short reads: fastp settings:\n    <ul>\n      <li>adapter trimming (default setting: adapters are auto-detected)</li>\n      <li>quality filtering (default: phred quality 15), unqualified bases limit (default = 40%), number of Ns allowed in a read (default = 5)</li>\n      <li>length filtering (default length = min 15)</li>\n      <li>polyG tail trimming (default = on for NextSeq/NovaSeq data which is auto detected)</li>\n    </ul>\n  </li>\n  <li>Output options: output JSON report: yes</li>\n</ul>\n\n<p>Options:</p>\n<ul>\n  <li>Change any settings in fastp for any of the input reads.</li>\n  <li>Adapter trimming: input the actual adapter sequences. (Alternative tool for long read adapter trimming: Porechop.)</li>\n  <li>Trimming n bases from ends of reads if quality less than value x  (Alternative tool for trimming long reads: NanoFilt.)</li>\n  <li>Discard post-trimmed reads if length is &lt; x (e.g. for long reads, 1000 bp)</li>\n  <li>Example filtering/trimming that you might do on long reads: remove adapters (can also be done with Porechop), trim bases from ends of the reads with low quality (can also be done with NanoFilt), after this can keep only reads of length x (e.g. 1000 bp)</li>\n  <li>If not running any trimming/filtering on nanopore reads, could delete this step from the workflow entirely.</li>\n</ul>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Run the Trim and Filter Reads workflow</hands-on-title>\n\n  <ol>\n    <li>\n      <p><strong>Import the workflow</strong> into Galaxy:</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"hands_on\">   <div class=\"box-title hands_on-title\" id=\"hands-on-importing-and-launching-a-gtn-workflow-2\"><i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i> Hands-on: Importing and launching a GTN workflow</div>   <div class=\"show-when-galaxy-proxy-active\"> <span class=\"workflow\" data-workflow=\"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/assembly-largegenome/versions/galaxy-workflow-trim_and_filter_reads\">Launch <strong>Trim and Filter reads</strong> <i class=\"fas fa-share-alt\" aria-hidden=\"true\"></i></span> (<a href=\"https://github.com/galaxyproject/training-material/blob/main/topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-Trim_and_filter_reads.ga\">View on GitHub</a>, <a href=\"https://training.galaxyproject.org/training-material/topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-Trim_and_filter_reads.ga\">Download workflow</a>) workflow. </div>   <div class=\"hide-when-galaxy-proxy-active\"> Click to  <a href=\"https://my.galaxy.training/?path=/workflows/trs_import%3Frun_form=true%26trs_url=https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/assembly-largegenome/versions/galaxy-workflow-trim_and_filter_reads\">     Launch <strong>Trim and Filter reads</strong> <i class=\"fas fa-share-alt\" aria-hidden=\"true\"></i> </a> (<a href=\"https://github.com/galaxyproject/training-material/blob/main/topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-Trim_and_filter_reads.ga\">View on GitHub</a>, <a href=\"https://training.galaxyproject.org/training-material/topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-Trim_and_filter_reads.ga\">Download workflow</a>) </div>   <!--SNIPPET-->   <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-if-this-does-not-work-2\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-if-this-does-not-work-2\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: If this does not work</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on <em>Workflow</em> on the top menu bar of Galaxy. You will see a list of all your workflows.</li>   <li>Click on <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Import</strong> at the top-right of the screen</li>   <li>Paste the following URL into the box labelled <em>“Archived Workflow URL”</em>: <code class=\"language-plaintext highlighter-rouge\">https://training.galaxyproject.org/training-material/topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-Trim_and_filter_reads.ga</code></li>   <li>Click the <strong>Import workflow</strong> button</li> </ul>   <p>Below is a short video demonstrating how to import a workflow from GitHub using this procedure:</p>   <figure> <iframe credentialless=\"\" allowfullscreen=\"\" referrerpolicy=\"no-referrer\" sandbox=\"allow-scripts allow-same-origin\" allow=\"accelerometer 'none'; ambient-light-sensor 'none'; autoplay 'none'; battery 'none'; bluetooth 'none'; browsing-topics 'none'; camera 'none'; ch-ua 'none'; display-capture 'none'; domain-agent 'none'; document-domain 'none'; encrypted-media 'none'; execution-while-not-rendered 'none'; execution-while-out-of-viewport 'none'; gamepad 'none'; geolocation 'none'; gyroscope 'none'; hid 'none'; identity-credentials-get 'none'; idle-detection 'none'; keyboard-map 'none'; local-fonts 'none'; magnetometer 'none'; microphone 'none'; midi 'none'; navigation-override 'none'; otp-credentials 'none'; payment 'none'; picture-in-picture 'none'; publickey-credentials-create 'none'; publickey-credentials-get 'none'; screen-wake-lock 'none'; serial 'none'; speaker-selection 'none'; sync-xhr 'none'; usb 'none'; web-share 'none'; window-management 'none'; xr-spatial-tracking 'none'\" csp=\"sandbox allow-scripts allow-same-origin;\" width=\"560\" height=\"315\" src=\"https://www.youtube-nocookie.com/embed/hoP36Te5wko\" title=\"Importing a workflow from URL\" frameborder=\"0\" loading=\"lazy\"></iframe> <figcaption>   <span class=\"figcaption-prefix\"><strong>Video</strong>:</span> Importing a workflow from URL</figcaption> </figure> </blockquote>   <p><!--END_SNIPPET--></p> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <ul>\n        <li>Click “Expand to full workflow form”</li>\n      </ul>\n    </li>\n    <li>\n      <p>Run <strong>Trim and Filter Reads</strong> <i class=\"fas fa-share-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">workflow</span> using the following parameters:</p>\n      <ul>\n        <li><em>“Send results to a new history”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“1: Input file: long reads”</em>: the nanopore fastq.gz file</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“2: Input file: Illumina reads R1”</em>: the illumina R1 fastq.gz file</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“3: Input file: Illumina reads R2”</em>: the illumina R2 fastq.gz file</li>\n        <li><em>Note: the workflow parameter settings described above are already set, and don’t need to be changed when running the workflow, unless you wish to.</em></li>\n      </ul>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-running-a-workflow-2\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-running-a-workflow-2\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Running a workflow</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on <em>Workflow</em> on the top menu bar of Galaxy. You will see a list of all your workflows.</li>   <li>Click on the <i class=\"fas fa-play\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">workflow-run</span> (<em>Run workflow</em>) button next to your workflow</li>   <li>Configure the workflow as needed</li>   <li>Click the <strong>Run Workflow</strong> button at the top-right of the screen</li>   <li>You may have to refresh your history to see the queued jobs</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n</blockquote>\n\n<h2 id=\"trim-and-filter-reads-results\">Trim and filter reads: results</h2>\n\n<p>There are two fastp reports - one for the illumina reads and one for the nanopore reads. We have only processed illumina reads in this example. Look at the fastp illumina report. (Note: the title in the report refers to only one of the input read sets but the report is for both read sets. This is a known issue under investigation.)</p>\n\n<p>Filtering results from fastp on short reads:</p>\n\n<p><a href=\"images/fastp.png\" rel=\"noopener noreferrer\"><img src=\"images/fastp.png\" alt=\"&quot;Image of a table of results from fastp, showing the percentage of reads that were low quality, had too many Ns, or too short.&quot;. \" width=\"1239\" height=\"229\" loading=\"lazy\" /></a></p>\n\n<p>Here we can see that less than 0.5 % of the reads were discarded based on quality. If our read set had high enough coverage for downstream analyses, we might choose to apply a stricter quality filter.</p>\n\n<h2 id=\"summary-of-read-data-for-genome-assembly\">Summary of read data for genome assembly</h2>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n  <ol>\n    <li>How many reads do we have now for our genome assembly? Is the read coverage high enough?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n    <ul>\n      <li>Genome size: From kmer counting, the estimated genome size is ~ 240,000 bp  (this is only subsampled data; full data would likely suggest a size of 0.5 - 1 Gbp for a typical plant genome)</li>\n      <li>Genome coverage (or depth):  total base pairs in the reads / base pairs in genome</li>\n      <li>Short reads: From the fastp report after trimming and filtering short reads, there are 3.2 million reads, comprising 482 million base pairs</li>\n      <li>Short read coverage:  = X2008</li>\n      <li>Long reads: From the fastp report of the long reads (although no filtering and trimming performed) there are 85 thousand reads, comprising 761 million base pairs.  From the nanoplot tool we ran in the Data QC section , we know that the mean read length is almost 9,000 base pairs, and the longest read is &gt; 140,000 base pairs.</li>\n      <li>Long read coverage:  = X3170\nThese coverages are very high but are ok to use with tutorial data. With a typical full data set, coverage would be more in the order of X40 to X200.</li>\n    </ul>\n\n  </blockquote>\n</blockquote>\n\n<h1 id=\"genome-assembly\">Genome Assembly</h1>\n\n<p>Genome assembly means joining the reads up to make contiguous sections of the genome. A simplified way to imagine this is overlapping all the different sequencing reads to make a single length or contig, ideally one for each original chromosome. The output is a set of contigs and a graph showing how contigs are connected.</p>\n\n<p>Extreme simplification of genome assembly:</p>\n\n<p><a href=\"images/assembly.png\" rel=\"noopener noreferrer\"><img src=\"images/assembly.png\" alt=\"&quot;Image of the simplified process of genome assembly, from a tree, to reads (represented by bold bars), to an assembly (represented by one long bold bar), to contigs (various long bold bars) and to an assembly graph.&quot;. \" width=\"876\" height=\"311\" loading=\"lazy\" /></a></p>\n\n<p>Genome assembly algorithms use different approaches to work with the complexities of large sequencing read data sets, large genomes, different sequencing error rates, and computational resources. Many use graph-based algorithms.  For more about genome assembly algorithms see <a href=\"https://langmead-lab.org/teaching-materials/\">these tutorials by Ben Langmead</a>.</p>\n\n<h2 id=\"which-assembly-tool-and-approach-to-use\">Which assembly tool and approach to use?</h2>\n\n<p>Here, we will use the assembly tool called Flye to assemble the long reads. This is fast and deals well with the high error rate. Then, we will polish (correct) the assembly using information from the long reads (in their unassembled state), as well as the more accurate short Illumina reads.</p>\n\n<p>There are many other approaches and combinations of using short and long reads, and the polishing steps. For example, the long reads can be polished before assembly (with themselves, or with short reads). This may increase accuracy of the assembly, but it may also introduce errors if similar sequences are “corrected” into an artificial consensus. Long reads are usually used in the assembly, but it is possible to assemble short reads and then scaffold these into longer contigs using information from long reads.</p>\n\n<p>For more about the differences between current assembly and polishing tools see <span class=\"citation\"><a href=\"#Chen2021\">Chen <i>et al.</i> 2021</a></span> and <span class=\"citation\"><a href=\"#McCartney2021\">McCartney <i>et al.</i> 2021</a></span>.</p>\n\n<h2 id=\"assembly-with-flye-workflow\">Assembly with Flye workflow</h2>\n\n<p>What it does: Assembles long reads with the tool Flye</p>\n\n<p>Inputs: long reads (may be raw, or filtered, and/or corrected); fastq.gz format</p>\n\n<p>Outputs:</p>\n<ul>\n  <li>Flye assembly fasta.</li>\n  <li>Fasta stats on assembly.fasta</li>\n  <li>Assembly graph image from Bandage</li>\n  <li>Bar chart of contig sizes</li>\n  <li>Quast reports of genome assembly</li>\n</ul>\n\n<p>Tools used:</p>\n<ul>\n  <li>Flye</li>\n  <li>Fasta statistics</li>\n  <li>Bandage</li>\n  <li>Bar chart</li>\n  <li>Quast</li>\n</ul>\n\n<p>Input parameters: None required, but recommend setting assembly mode to match input sequence type</p>\n\n<p>Workflow steps:</p>\n<ul>\n  <li>Long reads are assembled with Flye, using default tool settings. Note: the default setting for read type (“mode”) is nanopore raw. Change this at runtime if required.</li>\n  <li>Statistics are computed from the assembly.fasta file output, using Fasta Statistics and Quast (is genome large: Yes; distinguish contigs with more that 50% unaligned bases: no)</li>\n  <li>The graphical fragment assembly file is visualized with the tool Bandage.</li>\n  <li>Assembly information sent to bar chart to visualize contig sizes</li>\n</ul>\n\n<p>Options</p>\n<ul>\n  <li>See other Flye options.</li>\n  <li>Use a different assembler (in a different workflow).</li>\n  <li>Bandage image options - change size (max size is 32767), labels - add (e.g. node lengths). You can also install Bandage on your own computer and download the “graphical fragment assembly” file to view in greater detail.</li>\n</ul>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Run the Assembly with Flye workflow</hands-on-title>\n\n  <ol>\n    <li>\n      <p><strong>Import the workflow</strong> into Galaxy:</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"hands_on\">   <div class=\"box-title hands_on-title\" id=\"hands-on-importing-and-launching-a-gtn-workflow-3\"><i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i> Hands-on: Importing and launching a GTN workflow</div>   <div class=\"show-when-galaxy-proxy-active\"> <span class=\"workflow\" data-workflow=\"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/assembly-largegenome/versions/galaxy-workflow-assembly_with_flye\">Launch <strong>Assembly with Flye</strong> <i class=\"fas fa-share-alt\" aria-hidden=\"true\"></i></span> (<a href=\"https://github.com/galaxyproject/training-material/blob/main/topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-Assembly_with_Flye.ga\">View on GitHub</a>, <a href=\"https://training.galaxyproject.org/training-material/topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-Assembly_with_Flye.ga\">Download workflow</a>) workflow. </div>   <div class=\"hide-when-galaxy-proxy-active\"> Click to  <a href=\"https://my.galaxy.training/?path=/workflows/trs_import%3Frun_form=true%26trs_url=https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/assembly-largegenome/versions/galaxy-workflow-assembly_with_flye\">     Launch <strong>Assembly with Flye</strong> <i class=\"fas fa-share-alt\" aria-hidden=\"true\"></i> </a> (<a href=\"https://github.com/galaxyproject/training-material/blob/main/topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-Assembly_with_Flye.ga\">View on GitHub</a>, <a href=\"https://training.galaxyproject.org/training-material/topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-Assembly_with_Flye.ga\">Download workflow</a>) </div>   <!--SNIPPET-->   <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-if-this-does-not-work-3\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-if-this-does-not-work-3\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: If this does not work</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on <em>Workflow</em> on the top menu bar of Galaxy. You will see a list of all your workflows.</li>   <li>Click on <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Import</strong> at the top-right of the screen</li>   <li>Paste the following URL into the box labelled <em>“Archived Workflow URL”</em>: <code class=\"language-plaintext highlighter-rouge\">https://training.galaxyproject.org/training-material/topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-Assembly_with_Flye.ga</code></li>   <li>Click the <strong>Import workflow</strong> button</li> </ul>   <p>Below is a short video demonstrating how to import a workflow from GitHub using this procedure:</p>   <figure> <iframe credentialless=\"\" allowfullscreen=\"\" referrerpolicy=\"no-referrer\" sandbox=\"allow-scripts allow-same-origin\" allow=\"accelerometer 'none'; ambient-light-sensor 'none'; autoplay 'none'; battery 'none'; bluetooth 'none'; browsing-topics 'none'; camera 'none'; ch-ua 'none'; display-capture 'none'; domain-agent 'none'; document-domain 'none'; encrypted-media 'none'; execution-while-not-rendered 'none'; execution-while-out-of-viewport 'none'; gamepad 'none'; geolocation 'none'; gyroscope 'none'; hid 'none'; identity-credentials-get 'none'; idle-detection 'none'; keyboard-map 'none'; local-fonts 'none'; magnetometer 'none'; microphone 'none'; midi 'none'; navigation-override 'none'; otp-credentials 'none'; payment 'none'; picture-in-picture 'none'; publickey-credentials-create 'none'; publickey-credentials-get 'none'; screen-wake-lock 'none'; serial 'none'; speaker-selection 'none'; sync-xhr 'none'; usb 'none'; web-share 'none'; window-management 'none'; xr-spatial-tracking 'none'\" csp=\"sandbox allow-scripts allow-same-origin;\" width=\"560\" height=\"315\" src=\"https://www.youtube-nocookie.com/embed/hoP36Te5wko\" title=\"Importing a workflow from URL\" frameborder=\"0\" loading=\"lazy\"></iframe> <figcaption>   <span class=\"figcaption-prefix\"><strong>Video</strong>:</span> Importing a workflow from URL</figcaption> </figure> </blockquote>   <p><!--END_SNIPPET--></p> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <ul>\n        <li>Click “Expand to full workflow form”</li>\n      </ul>\n    </li>\n    <li>\n      <p>Run <strong>Assembly with Flye</strong> <i class=\"fas fa-share-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">workflow</span> using the following parameters:</p>\n      <ul>\n        <li><em>“Send results to a new history”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“1: Input file: long reads”</em>: the fastp filtered long reads fastq.gz file</li>\n      </ul>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-running-a-workflow-3\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-running-a-workflow-3\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Running a workflow</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on <em>Workflow</em> on the top menu bar of Galaxy. You will see a list of all your workflows.</li>   <li>Click on the <i class=\"fas fa-play\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">workflow-run</span> (<em>Run workflow</em>) button next to your workflow</li>   <li>Configure the workflow as needed</li>   <li>Click the <strong>Run Workflow</strong> button at the top-right of the screen</li>   <li>You may have to refresh your history to see the queued jobs</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n</blockquote>\n\n<h2 id=\"assembly-results\">Assembly results</h2>\n\n<p>The assembled contigs are in the “Flye assembly on data X (consensus)” (X is a number that will vary depending on where it sits in your history).<br />\nOpen the Quast tabular report to see the assembly statistics:</p>\n\n<p><a href=\"images/quast.png\" rel=\"noopener noreferrer\"><img src=\"images/quast.png\" alt=\"&quot;Image of the Quast tabular report, showing various assembly statistics.&quot;. \" width=\"753\" height=\"597\" loading=\"lazy\" /></a></p>\n\n<p>There are 153 contigs, largest is ~246,000 bp, and total length almost 10 million bp. This is a fair bit longer than the estimated genome size from kmer counting (which was ~240,000 bp), but the difference is likely mainly due to idiosyncrasies of using a subsampled data set. The read coverage was likely &lt;1, causing many kmers to have frequency of &lt;1 and be classed as errors, rather than contributing to the genome size estimate.</p>\n\n<p>Open the Quast HTML report, then click on “View in Icarus contig browser”.  This is a way to visualize the contigs and their sizes:</p>\n\n<p><a href=\"images/icarus.png\" rel=\"noopener noreferrer\"><img src=\"images/icarus.png\" alt=\"&quot;Image of the Icarus contig browser, showing the set of contigs arranged from larges to smallest, represented by rectangles of different widths.&quot;. \" width=\"1246\" height=\"526\" loading=\"lazy\" /></a></p>\n\n<p>View the Bandage image of the assembly graph:</p>\n\n<p><a href=\"images/bandagegraphpartial.png\" rel=\"noopener noreferrer\"><img src=\"images/bandagegraphpartial.png\" alt=\"&quot;Image of the bandage graph showing one multi-part set of joined contigs, some smaller one- or two- piece contigs, and many single contigs.&quot;. \" width=\"1212\" height=\"466\" loading=\"lazy\" /></a></p>\n\n<p>As this is a subsampled data set, it is not surprising that most of the contigs are unjoined. The joined contigs at the top left are likely to be part of the mitochondrial genome as these reads were probably over-represented in our subsampled data set.</p>\n\n<h3 id=\"what-about-centromeres-and-telomeres\">What about centromeres and telomeres?</h3>\n\n<p>Some genomic areas such as centromeres, telomeres, and ribosomal DNA arrays, are much harder to assemble. These are long stretches of very similar repeats. With improved sequencing accuracy, length, and technologies (particularly long-range scaffolding), these may soon be much easier to assemble. The latest human genome assembly has a good demonstration of the techniques used for this.   See <span class=\"citation\"><a href=\"#Nurk2021\">Nurk <i>et al.</i> 2021</a></span>, and in particular, Figure 2: Bandage graphs of the human genome chromosomes, with the grey shading showing centromeric regions.</p>\n\n<h3 id=\"what-about-haplotigs\">What about haplotigs?</h3>\n\n<p>Although our sample may be diploid, with pairs of chromosomes, the resulting assembly is often a haploid (or “collapsed”) assembly. This is not the sequence of one of the chromosomes, but a mix of the two.</p>\n\n<p>Some assemblers will produce extra contigs called haplotigs. These are parts of the assembly from heterozygous regions (that is, the sequence is relatively different between the chromosome pair). There are tools to remove haplotigs from the assembly if that is preferred.</p>\n\n<p>For more on differences between collapsed, primary/alternate and partially-phased assemblies, with a great visual representation: see <a href=\"http://lh3.github.io/2021/04/17/concepts-in-phased-assemblies\">Heng Li’s Github page</a></p>\n\n<p>For more on the phased assemblies, particularly for diploids or polyploids, see <span class=\"citation\"><a href=\"#Garg2021\">Garg 2021</a></span>.</p>\n\n<h1 id=\"assembly-polishing\">Assembly polishing</h1>\n\n<p>We will polish the assembly using both the long reads and short reads. This process aligns the reads to the assembly contigs, and makes corrections to the contigs where warranted.  For more, see <span class=\"citation\"><a href=\"#Aury2021\">Aury and Istace 2021</a></span>, particularly for a discussion about polishing diploid genomes.</p>\n\n<p>Assembly polishing:</p>\n\n<p><a href=\"images/polish.png\" rel=\"noopener noreferrer\"><img src=\"images/polish.png\" alt=\"&quot;Image of the concept of assembly polishing, showing reads mapped to the assembly contigs.&quot;. \" width=\"848\" height=\"275\" loading=\"lazy\" /></a></p>\n\n<h2 id=\"polishing-workflow\">Polishing workflow</h2>\n\n<p>Workflow structure: The workflow includes two subworkflows:</p>\n<ul>\n  <li>Racon polish with long reads, x 4</li>\n  <li>Racon polish with illumina reads, x2</li>\n</ul>\n\n<p>What it does: Polishes (corrects) an assembly, using long reads (with the tools Racon and Medaka) and short reads (with the tool Racon). (Note: medaka is only for nanopore reads, not PacBio reads).</p>\n\n<p>Inputs:</p>\n<ul>\n  <li>assembly to be polished:  assembly.fasta</li>\n  <li>long reads - the same set used in the assembly (e.g. may be raw or filtered) fastq.gz format</li>\n  <li>short reads, R1 only, in fastq.gz format</li>\n</ul>\n\n<p>Outputs:</p>\n<ul>\n  <li>Racon+Medaka+Racon polished_assembly. fasta</li>\n  <li>Fasta statistics after each polishing tool</li>\n</ul>\n\n<p>Tools used:</p>\n<ul>\n  <li>Minimap2</li>\n  <li>Racon</li>\n  <li>Fasta statistics</li>\n  <li>Medaka</li>\n</ul>\n\n<p>Input parameters: None required, but recommended to set the Medaka model correctly (default = r941_min_high_g360). See drop down list for options.</p>\n\n<p>Workflow steps for Part 1, Polish with long reads: using Racon</p>\n<ul>\n  <li>Long reads and assembly contigs =&gt; Racon polishing (subworkflow):</li>\n  <li>minimap2 : long reads are mapped to assembly =&gt; overlaps.paf.</li>\n  <li>overaps, long reads, assembly =&gt; Racon =&gt; polished assembly 1</li>\n  <li>using polished assembly 1 as input; repeat minimap2 + racon =&gt; polished assembly 2</li>\n  <li>using polished assembly 2 as input, repeat minimap2 + racon =&gt; polished assembly 3</li>\n  <li>using polished assembly 3 as input, repeat minimap2 + racon =&gt; polished assembly 4</li>\n  <li>Racon long-read polished assembly =&gt; Fasta statistics</li>\n  <li>Note: The Racon tool panel can be a bit confusing and is under review for improvement. Presently it requires sequences (= long reads), overlaps (= the paf file created by minimap2), and target sequences (= the contigs to be polished) as per “usage” described at this link <a href=\"https://github.com/isovic/racon/blob/master/README.md\">https://github.com/isovic/racon/blob/master/README.md</a></li>\n  <li>Note: Racon: the default setting for “output unpolished target sequences?” is No. This has been changed to Yes for all Racon steps in these polishing workflows.  This means that even if no polishes are made in some contigs, they will be part of the output fasta file.</li>\n  <li>Note: the contigs output by Racon have new tags in their headers. For more on this see <a href=\"https://github.com/isovic/racon/issues/85\">this issue</a>.</li>\n</ul>\n\n<p>Workflow steps for Part 2, Polish with long reads: using Medaka</p>\n<ul>\n  <li>Racon polished assembly + long reads =&gt; medaka polishing X1 =&gt; medaka polished assembly</li>\n  <li>Medaka polished assembly =&gt; Fasta statistics</li>\n</ul>\n\n<p>Workflow steps for Part 3, Polish with short reads: using Racon</p>\n<ul>\n  <li>Short reads and Medaka polished assembly =&gt;Racon polish (subworkflow):</li>\n  <li>minimap2: short reads (R1 only) are mapped to the assembly =&gt; overlaps.paf. Minimap2 setting is for short reads.</li>\n  <li>overlaps + short reads + assembly =&gt; Racon =&gt; polished assembly 1</li>\n  <li>using polished assembly 1 as input; repeat minimap2 + racon =&gt; polished assembly 2</li>\n  <li>Racon short-read polished assembly =&gt; Fasta statistics</li>\n</ul>\n\n<p>Options:</p>\n<ul>\n  <li>Change settings for Racon long read polishing if using PacBio reads:  The default profile setting for Racon long read polishing: minimap2 read mapping is “Oxford Nanopore read to reference mapping”, which is specified as an input parameter to the whole Assembly polishing workflow, as text: map-ont. If you are not using nanopore reads and/or need a different setting, change this input. To see the other available settings, open the minimap2 tool, find “Select a profile of preset options”, and click on the drop down menu. For each described option, there is a short text in brackets at the end (e.g. map-pb). This is the text to enter into the assembly polishing workflow at runtime instead of the default (map-ont).</li>\n  <li>Other options: change the number of polishes (in Racon and/or Medaka). There are ways to assess how much improvement in assembly quality has occurred per polishing round (for example, the number of corrections made; the change in Busco score - see section “Genome quality assessment” for more on Busco).</li>\n  <li>Option: change polishing settings for any of these tools. Note: for Racon - these will have to be changed within those subworkflows first. Then, in the main workflow, update the</li>\n</ul>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Run the Assembly polishing workflow</hands-on-title>\n\n  <ol>\n    <li>\n      <p><strong>Import the workflow</strong> into Galaxy:</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"hands_on\">   <div class=\"box-title hands_on-title\" id=\"hands-on-importing-and-launching-a-gtn-workflow-4\"><i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i> Hands-on: Importing and launching a GTN workflow</div>   <div class=\"show-when-galaxy-proxy-active\"> <span class=\"workflow\" data-workflow=\"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/assembly-largegenome/versions/galaxy-workflow-assembly_polishing\">Launch <strong>Assembly polishing workflow</strong> <i class=\"fas fa-share-alt\" aria-hidden=\"true\"></i></span> (<a href=\"https://github.com/galaxyproject/training-material/blob/main/topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-Assembly_polishing.ga\">View on GitHub</a>, <a href=\"https://training.galaxyproject.org/training-material/topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-Assembly_polishing.ga\">Download workflow</a>) workflow. </div>   <div class=\"hide-when-galaxy-proxy-active\"> Click to  <a href=\"https://my.galaxy.training/?path=/workflows/trs_import%3Frun_form=true%26trs_url=https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/assembly-largegenome/versions/galaxy-workflow-assembly_polishing\">     Launch <strong>Assembly polishing workflow</strong> <i class=\"fas fa-share-alt\" aria-hidden=\"true\"></i> </a> (<a href=\"https://github.com/galaxyproject/training-material/blob/main/topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-Assembly_polishing.ga\">View on GitHub</a>, <a href=\"https://training.galaxyproject.org/training-material/topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-Assembly_polishing.ga\">Download workflow</a>) </div>   <!--SNIPPET-->   <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-if-this-does-not-work-4\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-if-this-does-not-work-4\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: If this does not work</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on <em>Workflow</em> on the top menu bar of Galaxy. You will see a list of all your workflows.</li>   <li>Click on <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Import</strong> at the top-right of the screen</li>   <li>Paste the following URL into the box labelled <em>“Archived Workflow URL”</em>: <code class=\"language-plaintext highlighter-rouge\">https://training.galaxyproject.org/training-material/topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-Assembly_polishing.ga</code></li>   <li>Click the <strong>Import workflow</strong> button</li> </ul>   <p>Below is a short video demonstrating how to import a workflow from GitHub using this procedure:</p>   <figure> <iframe credentialless=\"\" allowfullscreen=\"\" referrerpolicy=\"no-referrer\" sandbox=\"allow-scripts allow-same-origin\" allow=\"accelerometer 'none'; ambient-light-sensor 'none'; autoplay 'none'; battery 'none'; bluetooth 'none'; browsing-topics 'none'; camera 'none'; ch-ua 'none'; display-capture 'none'; domain-agent 'none'; document-domain 'none'; encrypted-media 'none'; execution-while-not-rendered 'none'; execution-while-out-of-viewport 'none'; gamepad 'none'; geolocation 'none'; gyroscope 'none'; hid 'none'; identity-credentials-get 'none'; idle-detection 'none'; keyboard-map 'none'; local-fonts 'none'; magnetometer 'none'; microphone 'none'; midi 'none'; navigation-override 'none'; otp-credentials 'none'; payment 'none'; picture-in-picture 'none'; publickey-credentials-create 'none'; publickey-credentials-get 'none'; screen-wake-lock 'none'; serial 'none'; speaker-selection 'none'; sync-xhr 'none'; usb 'none'; web-share 'none'; window-management 'none'; xr-spatial-tracking 'none'\" csp=\"sandbox allow-scripts allow-same-origin;\" width=\"560\" height=\"315\" src=\"https://www.youtube-nocookie.com/embed/hoP36Te5wko\" title=\"Importing a workflow from URL\" frameborder=\"0\" loading=\"lazy\"></iframe> <figcaption>   <span class=\"figcaption-prefix\"><strong>Video</strong>:</span> Importing a workflow from URL</figcaption> </figure> </blockquote>   <p><!--END_SNIPPET--></p> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <ul>\n        <li>Click “Expand to full workflow form”</li>\n      </ul>\n    </li>\n    <li>\n      <p>Run <strong>Assembly polishing</strong> <i class=\"fas fa-share-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">workflow</span> using the following parameters:</p>\n      <ul>\n        <li><em>“Send results to a new history”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“1: Assembly to be polished”</em>: the assembly fasta file</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“2: long reads”</em>: the nanopore reads, the same set that was used for the assembly</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“3: Illumina reads R1”</em>: the illumina R1 fastq.gz file</li>\n        <li>No other settings need to be changed, as they are set as described above, but recommended to set the Medaka model correctly (default = r941_min_high_g360). See drop down list for options.</li>\n      </ul>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-running-a-workflow-4\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-running-a-workflow-4\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Running a workflow</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on <em>Workflow</em> on the top menu bar of Galaxy. You will see a list of all your workflows.</li>   <li>Click on the <i class=\"fas fa-play\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">workflow-run</span> (<em>Run workflow</em>) button next to your workflow</li>   <li>Configure the workflow as needed</li>   <li>Click the <strong>Run Workflow</strong> button at the top-right of the screen</li>   <li>You may have to refresh your history to see the queued jobs</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n</blockquote>\n\n<h2 id=\"polishing-results\">Polishing results</h2>\n\n<p>The polished assembly is the final Racon file.</p>\n\n<p>Look at the Fasta Statistics output files for the status of the assemblies after each polishing tool. From these, we can see that some polishes decrease or increase the size of the assembly. The final size is approximately 300,000 bp shorter than the original Flye assembly. (These numbers may vary slightly even if the same input data is used).</p>\n\n<h1 id=\"genome-quality-assessment\">Genome quality assessment</h1>\n\n<p>The polished genome is in 145 contigs with a total length of ~ 9.6 million base pairs.  We have some idea of how these contigs may be joined (or not) from the Bandage assembly graph.</p>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>How good is the assembly?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>One measure is the N50, a number that indicates how large the contigs are (although, have the contigs been joined correctly)? Another measure is to see if expected gene sequences are found in the assembly, using a tool called BUSCO. For a discussion on these and other methods, see <span class=\"citation\"><a href=\"#Wang2020\">Wang <i>et al.</i> 2020</a></span>.</li>\n    </ol>\n\n  </blockquote>\n</blockquote>\n\n<p>Here, we will use the BUSCO tool to annotate the genome and then assess whether expected genes are found. Note: this is a brief annotation only, not the full genome annotation that would typically be done following genome assembly.</p>\n\n<p>For more about Busco see <span class=\"citation\"><a href=\"#Simo2015\">Simão <i>et al.</i> 2015</a></span>.</p>\n\n<p>Genome assessment:</p>\n\n<p><a href=\"images/assess.png\" rel=\"noopener noreferrer\"><img src=\"images/assess.png\" alt=\"&quot;Image of genome assessment, showing contigs as bold bars, with one contig annotated (various sections labelled by coloured boxes), and then compared to an expected annotation.&quot;. \" width=\"906\" height=\"276\" loading=\"lazy\" /></a></p>\n\n<p>We will also map the assembled contigs to a known reference genome using the tool Quast, to see how they align. For more about quast see <a href=\"http://quast.sourceforge.net/docs/manual.html\">the manual</a>.</p>\n\n<p>For more about the Icarus browser see <span class=\"citation\"><a href=\"#Mikheenko2016\">Mikheenko <i>et al.</i> 2016</a></span>.</p>\n\n<h2 id=\"genome-assessment-workflow\">Genome assessment workflow</h2>\n\n<p>What it does:</p>\n<ul>\n  <li>Assesses the quality of the genome assembly: generate some statistics and determine if expected genes are present</li>\n  <li>Align contigs to a reference genome.</li>\n</ul>\n\n<p>Inputs:</p>\n<ul>\n  <li>polished assembly</li>\n  <li>reference_genome.fasta (e.g. of a closely-related species, if available).</li>\n</ul>\n\n<p>Outputs</p>\n<ul>\n  <li>Busco table of genes found</li>\n  <li>Quast HTML report, and link to Icarus contigs browser, showing contigs aligned to a reference genome</li>\n</ul>\n\n<p>Tools used:</p>\n<ul>\n  <li>Busco</li>\n  <li>Quast</li>\n</ul>\n\n<p>Input parameters: None required</p>\n\n<p>Workflow steps:</p>\n<ul>\n  <li>Polished assembly =&gt; Busco:</li>\n  <li>First: predict genes in the assembly: using Metaeuk</li>\n  <li>Second: compare the set of predicted genes to the set of expected genes in a particular lineage. Default setting for lineage: Eukaryota</li>\n  <li>Polished assembly and a reference genome =&gt; Quast:</li>\n  <li>For the tutorial we will use the Arabidopsis genome. This is not closely related to our Eucalyptus species but will give an idea of how to use Quast.</li>\n  <li>Contigs/scaffolds file: polished assembly</li>\n  <li>Type of assembly: Genome</li>\n  <li>Use a reference genome: Yes</li>\n  <li>Reference genome: Arabidopsis genome</li>\n  <li>Is the genome large (&gt; 100Mbp)? Yes. (Our test data set won’t be, but this will still give us some results).</li>\n  <li>All other settings as defaults, except second last setting: Distinguish contigs with more than 50% unaligned bases as a separate group of contigs?: change to No</li>\n</ul>\n\n<p>Options:</p>\n<ul>\n  <li><strong>Gene prediction:</strong></li>\n  <li>Change tool used by Busco to predict genes in the assembly: instead of Metaeuk, use Augustus (Metaeuk is meant to be faster; unsure which is better).</li>\n  <li>select: Use Augustus; Use another predefined species model; then choose from the drop down list.</li>\n  <li>select from a database of trained species models. Link to lists of species models: <a href=\"https://github.com/Gaius-Augustus/Augustus/tree/master/config/species\">https://github.com/Gaius-Augustus/Augustus/tree/master/config/species</a></li>\n  <li>Note: if using Augustus: it may fail if the input assembly is too small (e.g. a test-size data assembly). It can’t do the training part properly.</li>\n  <li><strong>Compare genes found to other lineage:</strong></li>\n  <li>Busco has databases of lineages and their expected genes. Option to change lineage. Not all lineages are available - there is a mix of broader and narrower lineages.</li>\n  <li>link to list of lineages <a href=\"https://busco.ezlab.org/list_of_lineages.html\">https://busco.ezlab.org/list_of_lineages.html</a></li>\n  <li>link to groups in taxonomic hierarchies <a href=\"https://busco.ezlab.org/frames/euka.htm\">https://busco.ezlab.org/frames/euka.htm</a></li>\n  <li>For example,  if you have a plant species from Fabales, you could set that as the lineage.</li>\n  <li>The narrower the taxonomic group, the more total genes are expected.</li>\n</ul>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Run the Assess Genome Quality workflow</hands-on-title>\n\n  <ol>\n    <li>\n      <p><strong>Import the workflow</strong> into Galaxy:</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"hands_on\">   <div class=\"box-title hands_on-title\" id=\"hands-on-importing-and-launching-a-gtn-workflow-5\"><i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i> Hands-on: Importing and launching a GTN workflow</div>   <div class=\"show-when-galaxy-proxy-active\"> <span class=\"workflow\" data-workflow=\"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/assembly-largegenome/versions/galaxy-workflow-assess_genome_quality\">Launch <strong>Assess Genome Quality</strong> <i class=\"fas fa-share-alt\" aria-hidden=\"true\"></i></span> (<a href=\"https://github.com/galaxyproject/training-material/blob/main/topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-Assess_genome_quality.ga\">View on GitHub</a>, <a href=\"https://training.galaxyproject.org/training-material/topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-Assess_genome_quality.ga\">Download workflow</a>) workflow. </div>   <div class=\"hide-when-galaxy-proxy-active\"> Click to  <a href=\"https://my.galaxy.training/?path=/workflows/trs_import%3Frun_form=true%26trs_url=https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/assembly-largegenome/versions/galaxy-workflow-assess_genome_quality\">     Launch <strong>Assess Genome Quality</strong> <i class=\"fas fa-share-alt\" aria-hidden=\"true\"></i> </a> (<a href=\"https://github.com/galaxyproject/training-material/blob/main/topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-Assess_genome_quality.ga\">View on GitHub</a>, <a href=\"https://training.galaxyproject.org/training-material/topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-Assess_genome_quality.ga\">Download workflow</a>) </div>   <!--SNIPPET-->   <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-if-this-does-not-work-5\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-if-this-does-not-work-5\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: If this does not work</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on <em>Workflow</em> on the top menu bar of Galaxy. You will see a list of all your workflows.</li>   <li>Click on <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Import</strong> at the top-right of the screen</li>   <li>Paste the following URL into the box labelled <em>“Archived Workflow URL”</em>: <code class=\"language-plaintext highlighter-rouge\">https://training.galaxyproject.org/training-material/topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-Assess_genome_quality.ga</code></li>   <li>Click the <strong>Import workflow</strong> button</li> </ul>   <p>Below is a short video demonstrating how to import a workflow from GitHub using this procedure:</p>   <figure> <iframe credentialless=\"\" allowfullscreen=\"\" referrerpolicy=\"no-referrer\" sandbox=\"allow-scripts allow-same-origin\" allow=\"accelerometer 'none'; ambient-light-sensor 'none'; autoplay 'none'; battery 'none'; bluetooth 'none'; browsing-topics 'none'; camera 'none'; ch-ua 'none'; display-capture 'none'; domain-agent 'none'; document-domain 'none'; encrypted-media 'none'; execution-while-not-rendered 'none'; execution-while-out-of-viewport 'none'; gamepad 'none'; geolocation 'none'; gyroscope 'none'; hid 'none'; identity-credentials-get 'none'; idle-detection 'none'; keyboard-map 'none'; local-fonts 'none'; magnetometer 'none'; microphone 'none'; midi 'none'; navigation-override 'none'; otp-credentials 'none'; payment 'none'; picture-in-picture 'none'; publickey-credentials-create 'none'; publickey-credentials-get 'none'; screen-wake-lock 'none'; serial 'none'; speaker-selection 'none'; sync-xhr 'none'; usb 'none'; web-share 'none'; window-management 'none'; xr-spatial-tracking 'none'\" csp=\"sandbox allow-scripts allow-same-origin;\" width=\"560\" height=\"315\" src=\"https://www.youtube-nocookie.com/embed/hoP36Te5wko\" title=\"Importing a workflow from URL\" frameborder=\"0\" loading=\"lazy\"></iframe> <figcaption>   <span class=\"figcaption-prefix\"><strong>Video</strong>:</span> Importing a workflow from URL</figcaption> </figure> </blockquote>   <p><!--END_SNIPPET--></p> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <ul>\n        <li>Click “Expand to full workflow form”</li>\n      </ul>\n    </li>\n    <li>\n      <p>Run <strong>Assess Genome Quality</strong> <i class=\"fas fa-share-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">workflow</span> using the following parameters:</p>\n      <ul>\n        <li><em>“Send results to a new history”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“1: Input file: Polished assembly”</em>: the polished assembly fasta file from the previous polishing workflow</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“2: Input file: Reference genome”</em>: Arabidopsis.fasta</li>\n      </ul>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-running-a-workflow-5\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-running-a-workflow-5\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Running a workflow</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on <em>Workflow</em> on the top menu bar of Galaxy. You will see a list of all your workflows.</li>   <li>Click on the <i class=\"fas fa-play\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">workflow-run</span> (<em>Run workflow</em>) button next to your workflow</li>   <li>Configure the workflow as needed</li>   <li>Click the <strong>Run Workflow</strong> button at the top-right of the screen</li>   <li>You may have to refresh your history to see the queued jobs</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n</blockquote>\n\n<h2 id=\"assessment-results\">Assessment results</h2>\n\n<p>The output is a set of Quast and Busco reports.</p>\n\n<p>Busco: As this is a test dataset, the assembly is small (~ 10 million base pairs, rather than ~ 1 billion base pairs), and likely missing most of the real genome (and genes). Thus, for this test case, we would expect most of the genes not to be found, but we can view the Busco results to see an example of how it works. Open the Busco short summary file: only 1 complete BUSCO has been found, out of 255 expected. You can re-run the workflow and change the lineage to “Embryophyta” to see that more BUSCOs are found (8 out of 1614).</p>\n\n<p>Open the Quast HTML report, and at the top of this, click on “View in Icarus contig browser”.  This shows how our assembly contigs have mapped to the reference genome. For this reference genome there are 5 chromosomes and two organelles. As this reference genome species is not closely related, not many contigs have mapped well. But we can see that some of them match the organelles (which is expected, as these reads are likely to be overrepresented in the test data). For the nuclear genome, there are some matches to parts of chromosome 2 and 3.</p>\n\n<p><a href=\"images/quast2.png\" rel=\"noopener noreferrer\"><img src=\"images/quast2.png\" alt=\"&quot;Image of quast results showing contig lengths.&quot;. \" width=\"1238\" height=\"438\" loading=\"lazy\" /></a></p>\n\n<p>Click on the “mitochondria” to see how the assembly contigs align to the reference mitochondrial genome. Click the -5x button to zoom out to the full length.</p>\n\n<p><a href=\"images/mitocontigs.png\" rel=\"noopener noreferrer\"><img src=\"images/mitocontigs.png\" alt=\"&quot;Image of mitochondrial contigs.&quot;. \" width=\"1239\" height=\"404\" loading=\"lazy\" /></a></p>\n\n<h1 id=\"combining-workflows\">Combining workflows</h1>\n\n<p>We can combine these galaxy workflows into a single workflow. (See <a href=\"/training-material/topics/galaxy-interface/tutorials/workflow-editor/tutorial.html\">this GTN tutorial</a> for more information.)</p>\n\n<h2 id=\"combined-assembly-and-polishing-workflow\">Combined assembly and polishing workflow</h2>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Run the Combined Assembly and Polishing workflow</hands-on-title>\n  <ul>\n    <li>Find this workflow, enter the correct input files, and run.</li>\n    <li>What it does:  A workflow for genome assembly, containing subworkflows:\n      <ul>\n        <li>Data QC</li>\n        <li>Kmer counting</li>\n        <li>Trim and filter reads</li>\n        <li>Assembly with Flye</li>\n        <li>Assembly polishing</li>\n        <li>Assess genome quality</li>\n      </ul>\n    </li>\n    <li>Inputs\n      <ul>\n        <li>long reads and short reads in fastq format</li>\n        <li>reference genome for Quast</li>\n      </ul>\n    </li>\n    <li>Outputs\n      <ul>\n        <li>Data information - QC, kmers</li>\n        <li>Filtered, trimmed reads</li>\n        <li>Genome assembly, assembly graph, stats</li>\n        <li>Polished assembly, stats</li>\n        <li>Quality metrics - Busco, Quast</li>\n      </ul>\n    </li>\n    <li>Tools used: Sum of tools in each of the subworkflows</li>\n    <li>Input parameters: None required</li>\n    <li>Workflow steps: For detail see each subworkflow</li>\n    <li>Options:\n      <ul>\n        <li>Omit some steps - e.g. Data QC and kmer counting</li>\n        <li>Replace a module with one using a different tool - e.g. change assembly tool</li>\n      </ul>\n    </li>\n  </ul>\n</blockquote>\n\n<h1 id=\"summary\">Summary</h1>\n\n<p>In this tutorial we have assembled sequencing reads into contigs, using tools and workflows in Galaxy. Although we have used test data, these tools and workflows should work on real-sized eukaryotic data sets although please see our recommendations in the Introduction section.</p>\n\n<p>A summary of the workflow steps and the main tools used:</p>\n\n<p><a href=\"images/summary.png\" rel=\"noopener noreferrer\"><img src=\"images/summary.png\" alt=\"&quot;A graphical summary of the steps in the assembly: quality control, kmer counting, trimming/filtering reads, assembly, polishing and assessment. A composite of all the earlier images in the tutorial.&quot;. \" width=\"960\" height=\"540\" loading=\"lazy\" /></a></p>\n\n<p>We hope this has been useful for both learning about genome assembly concepts and as a customisable example for your own assembly data.</p>\n\n"],"ref_slides":[],"hands_on":true,"slides":false,"mod_date":"2024-05-29 14:28:52 +0000","pub_date":"2023-03-06 16:02:30 +0000","version":27,"workflows":[{"workflow":"Galaxy-Workflow-Assembly_polishing.ga","tests":false,"url":"https://training.galaxyproject.org/training-material/topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-Assembly_polishing.ga","path":"topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-Assembly_polishing.ga","wfid":"assembly-largegenome","wfname":"galaxy-workflow-assembly_polishing","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/assembly-largegenome/versions/galaxy-workflow-assembly_polishing","license":"GPL-3.0-or-later","creators":[{"class":"Person","identifier":"0000-0002-9906-0673","name":"Anna Syme"}],"name":"Assembly polishing - upgraded","title":"Assembly polishing - upgraded","test_results":null,"modified":"2024-06-14 09:58:01 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\nAssembly to be polished\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"ℹ️ Input Dataset\\nlong reads\"];\n  style 1 stroke:#2c3143,stroke-width:4px;\n  2[\"ℹ️ Input Parameter\\nminimap setting for long reads\"];\n  style 2 fill:#ded,stroke:#393,stroke-width:4px;\n  3[\"ℹ️ Input Dataset\\nIllumina reads R1\"];\n  style 3 stroke:#2c3143,stroke-width:4px;\n  4[\"🛠️ Subworkflow\\nRacon polish with long reads, x4 - upgraded\"];\n  style 4 fill:#edd,stroke:#900,stroke-width:4px;\n  0 -->|output| 4;\n  1 -->|output| 4;\n  2 -->|output| 4;\n  5[\"Medaka polish\"];\n  4 -->|Assembly polished by long reads using Racon| 5;\n  1 -->|output| 5;\n  e3136060-bce7-4af3-87c4-9dcbb0d1f531[\"Output\\nAssembly polished by long reads using Medaka\"];\n  5 --> e3136060-bce7-4af3-87c4-9dcbb0d1f531;\n  style e3136060-bce7-4af3-87c4-9dcbb0d1f531 stroke:#2c3143,stroke-width:4px;\n  6[\"Fasta statistics after Racon long read polish\"];\n  4 -->|Assembly polished by long reads using Racon| 6;\n  7[\"Fasta statistics after Medaka polish\"];\n  5 -->|out_consensus| 7;\n  8[\"🛠️ Subworkflow\\nRacon polish with Illumina reads R1 only, x2 - upgraded\"];\n  style 8 fill:#edd,stroke:#900,stroke-width:4px;\n  5 -->|out_consensus| 8;\n  3 -->|output| 8;\n  9[\"Fasta statistics after Racon short read polish\"];\n  8 -->|Assembly polished by short reads using Racon| 9;"},{"workflow":"Galaxy-Workflow-Assembly_with_Flye.ga","tests":false,"url":"https://training.galaxyproject.org/training-material/topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-Assembly_with_Flye.ga","path":"topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-Assembly_with_Flye.ga","wfid":"assembly-largegenome","wfname":"galaxy-workflow-assembly_with_flye","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/assembly-largegenome/versions/galaxy-workflow-assembly_with_flye","license":"GPL-3.0-or-later","creators":[{"class":"Person","identifier":"0000-0002-9906-0673","name":"Anna Syme"}],"name":"Assembly with Flye - upgraded","title":"Assembly with Flye - upgraded","test_results":null,"modified":"2024-06-14 09:58:01 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\nlong reads\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"Flye: assembly\"];\n  0 -->|output| 1;\n  3960e31d-7a9e-400c-bb21-f6e47b75e649[\"Output\\nFlye assembly on input dataset(s) (consensus)\"];\n  1 --> 3960e31d-7a9e-400c-bb21-f6e47b75e649;\n  style 3960e31d-7a9e-400c-bb21-f6e47b75e649 stroke:#2c3143,stroke-width:4px;\n  e524f295-a957-4c91-838c-f8e98e809b6c[\"Output\\nFlye assembly on input dataset(s) (assembly_graph)\"];\n  1 --> e524f295-a957-4c91-838c-f8e98e809b6c;\n  style e524f295-a957-4c91-838c-f8e98e809b6c stroke:#2c3143,stroke-width:4px;\n  48b854e2-dd6e-4345-8d05-09abca6659da[\"Output\\nFlye assembly on input dataset(s) (Graphical Fragment Assembly)\"];\n  1 --> 48b854e2-dd6e-4345-8d05-09abca6659da;\n  style 48b854e2-dd6e-4345-8d05-09abca6659da stroke:#2c3143,stroke-width:4px;\n  8672c172-71a7-432c-9679-a8e37f36cf53[\"Output\\nFlye assembly on input dataset(s) (assembly_info)\"];\n  1 --> 8672c172-71a7-432c-9679-a8e37f36cf53;\n  style 8672c172-71a7-432c-9679-a8e37f36cf53 stroke:#2c3143,stroke-width:4px;\n  2[\"Fasta statistics\"];\n  1 -->|consensus| 2;\n  3[\"Quast genome report\"];\n  1 -->|consensus| 3;\n  17cdf8e0-8ad4-4570-afae-1861934fc678[\"Output\\nQuast on input dataset(s):  HTML report\"];\n  3 --> 17cdf8e0-8ad4-4570-afae-1861934fc678;\n  style 17cdf8e0-8ad4-4570-afae-1861934fc678 stroke:#2c3143,stroke-width:4px;\n  4[\"Bandage image: Flye assembly\"];\n  1 -->|assembly_gfa| 4;\n  e66bd129-146f-48dc-95b8-39a2a1ffb68d[\"Output\\nBandage Image on input dataset(s): Assembly Graph Image\"];\n  4 --> e66bd129-146f-48dc-95b8-39a2a1ffb68d;\n  style e66bd129-146f-48dc-95b8-39a2a1ffb68d stroke:#2c3143,stroke-width:4px;\n  5[\"Bar chart: show contig sizes\"];\n  1 -->|assembly_info| 5;\n  6d0a4e23-d631-4e37-8930-3d22fc91369b[\"Output\\nBar chart showing contig sizes\"];\n  5 --> 6d0a4e23-d631-4e37-8930-3d22fc91369b;\n  style 6d0a4e23-d631-4e37-8930-3d22fc91369b stroke:#2c3143,stroke-width:4px;"},{"workflow":"Galaxy-Workflow-Assess_genome_quality.ga","tests":false,"url":"https://training.galaxyproject.org/training-material/topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-Assess_genome_quality.ga","path":"topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-Assess_genome_quality.ga","wfid":"assembly-largegenome","wfname":"galaxy-workflow-assess_genome_quality","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/assembly-largegenome/versions/galaxy-workflow-assess_genome_quality","license":"GPL-3.0-or-later","creators":[{"class":"Person","identifier":"0000-0002-9906-0673","name":"Anna Syme"}],"name":"Assess genome quality - upgraded","title":"Assess genome quality - upgraded","test_results":null,"modified":"2024-06-14 09:58:01 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\nPolished assembly\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"ℹ️ Input Dataset\\nReference genome\"];\n  style 1 stroke:#2c3143,stroke-width:4px;\n  2[\"Busco: assess assembly\"];\n  0 -->|output| 2;\n  219e4952-36e0-4b01-a407-e774b5b02dca[\"Output\\nBusco short summary\"];\n  2 --> 219e4952-36e0-4b01-a407-e774b5b02dca;\n  style 219e4952-36e0-4b01-a407-e774b5b02dca stroke:#2c3143,stroke-width:4px;\n  3[\"Quast: assess assembly\"];\n  1 -->|output| 3;\n  0 -->|output| 3;\n  77ab0186-4cfd-460f-b71e-39a923414ef4[\"Output\\nQuast on input dataset(s):  HTML report\"];\n  3 --> 77ab0186-4cfd-460f-b71e-39a923414ef4;\n  style 77ab0186-4cfd-460f-b71e-39a923414ef4 stroke:#2c3143,stroke-width:4px;"},{"workflow":"Galaxy-Workflow-Combined_workflows_for_large_genome_assembly.ga","tests":false,"url":"https://training.galaxyproject.org/training-material/topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-Combined_workflows_for_large_genome_assembly.ga","path":"topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-Combined_workflows_for_large_genome_assembly.ga","wfid":"assembly-largegenome","wfname":"galaxy-workflow-combined_workflows_for_large_genome_assembly","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/assembly-largegenome/versions/galaxy-workflow-combined_workflows_for_large_genome_assembly","license":"GPL-3.0-or-later","creators":[{"class":"Person","identifier":"0000-0002-9906-0673","name":"Anna Syme"}],"name":"Combined workflows for large genome assembly - upgraded ","title":"Combined workflows for large genome assembly - upgraded ","test_results":null,"modified":"2024-06-14 09:58:01 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\nlong reads\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"ℹ️ Input Dataset\\nR1\"];\n  style 1 stroke:#2c3143,stroke-width:4px;\n  2[\"ℹ️ Input Dataset\\nR2\"];\n  style 2 stroke:#2c3143,stroke-width:4px;\n  3[\"ℹ️ Input Parameter\\nminimap settings for long reads\"];\n  style 3 fill:#ded,stroke:#393,stroke-width:4px;\n  4[\"ℹ️ Input Dataset\\nReference genome for Quast\"];\n  style 4 stroke:#2c3143,stroke-width:4px;\n  5[\"🛠️ Subworkflow\\nkmer counting - meryl - upgraded\"];\n  style 5 fill:#edd,stroke:#900,stroke-width:4px;\n  1 -->|output| 5;\n  6[\"🛠️ Subworkflow\\nData QC - upgraded\"];\n  style 6 fill:#edd,stroke:#900,stroke-width:4px;\n  1 -->|output| 6;\n  2 -->|output| 6;\n  0 -->|output| 6;\n  7[\"🛠️ Subworkflow\\nTrim and filter reads - fastp - upgraded \"];\n  style 7 fill:#edd,stroke:#900,stroke-width:4px;\n  1 -->|output| 7;\n  2 -->|output| 7;\n  0 -->|output| 7;\n  8[\"🛠️ Subworkflow\\nAssembly with Flye - upgraded\"];\n  style 8 fill:#edd,stroke:#900,stroke-width:4px;\n  7 -->|fastp filtered long reads| 8;\n  9[\"🛠️ Subworkflow\\nAssembly polishing - upgraded\"];\n  style 9 fill:#edd,stroke:#900,stroke-width:4px;\n  8 -->|Flye assembly on input datasets consensus| 9;\n  7 -->|fastp filtered R1 reads| 9;\n  7 -->|fastp filtered long reads| 9;\n  3 -->|output| 9;\n  10[\"🛠️ Subworkflow\\nAssess genome quality - upgraded\"];\n  style 10 fill:#edd,stroke:#900,stroke-width:4px;\n  9 -->|Assembly polished by long reads using Medaka| 10;\n  4 -->|output| 10;"},{"workflow":"Galaxy-Workflow-Data_QC.ga","tests":false,"url":"https://training.galaxyproject.org/training-material/topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-Data_QC.ga","path":"topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-Data_QC.ga","wfid":"assembly-largegenome","wfname":"galaxy-workflow-data_qc","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/assembly-largegenome/versions/galaxy-workflow-data_qc","license":"GPL-3.0-or-later","creators":[{"class":"Person","identifier":"0000-0002-9906-0673","name":"Anna Syme"}],"name":"Data QC - upgraded","title":"Data QC - upgraded","test_results":null,"modified":"2024-06-14 09:58:01 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\nInput file: long reads\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"ℹ️ Input Dataset\\nInput file: Illumina reads R1\"];\n  style 1 stroke:#2c3143,stroke-width:4px;\n  2[\"ℹ️ Input Dataset\\nInput file: Illumina reads R2\"];\n  style 2 stroke:#2c3143,stroke-width:4px;\n  3[\"Nanoplot: long reads\"];\n  0 -->|output| 3;\n  73d0e4cf-366e-41c1-810a-b269638826b3[\"Output\\nNanoPlot on input dataset(s): HTML report\"];\n  3 --> 73d0e4cf-366e-41c1-810a-b269638826b3;\n  style 73d0e4cf-366e-41c1-810a-b269638826b3 stroke:#2c3143,stroke-width:4px;\n  4[\"FastQC on R1\"];\n  1 -->|output| 4;\n  5[\"FastQC on R2\"];\n  2 -->|output| 5;\n  6[\"MultiQC: combine fastQC reports\"];\n  4 -->|text_file| 6;\n  5 -->|text_file| 6;\n  8baf8700-876e-4a74-ad99-6e656f3ba618[\"Output\\nMultiQC on input dataset(s): Webpage\"];\n  6 --> 8baf8700-876e-4a74-ad99-6e656f3ba618;\n  style 8baf8700-876e-4a74-ad99-6e656f3ba618 stroke:#2c3143,stroke-width:4px;"},{"workflow":"Galaxy-Workflow-Racon_polish_with_Illumina_reads_x2.ga","tests":false,"url":"https://training.galaxyproject.org/training-material/topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-Racon_polish_with_Illumina_reads_x2.ga","path":"topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-Racon_polish_with_Illumina_reads_x2.ga","wfid":"assembly-largegenome","wfname":"galaxy-workflow-racon_polish_with_illumina_reads_x2","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/assembly-largegenome/versions/galaxy-workflow-racon_polish_with_illumina_reads_x2","license":"GPL-3.0-or-later","creators":[{"class":"Person","identifier":"0000-0002-9906-0673","name":"Anna Syme"}],"name":"Racon polish with Illumina reads (R1 only), x2 - upgraded","title":"Racon polish with Illumina reads (R1 only), x2 - upgraded","test_results":null,"modified":"2024-06-14 09:58:01 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\nAssembly to be polished\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"ℹ️ Input Dataset\\nIllumina reads, R1, in fastq.gz format\"];\n  style 1 stroke:#2c3143,stroke-width:4px;\n  2[\"Minimap2 round 1: map reads to assembly\"];\n  1 -->|output| 2;\n  0 -->|output| 2;\n  3[\"Racon round 1: polish assembly\"];\n  0 -->|output| 3;\n  2 -->|alignment_output| 3;\n  1 -->|output| 3;\n  4[\"Minimap2 round 2: map reads to assembly\"];\n  1 -->|output| 4;\n  3 -->|consensus| 4;\n  5[\"Racon round 2: polish assembly\"];\n  3 -->|consensus| 5;\n  4 -->|alignment_output| 5;\n  1 -->|output| 5;\n  594819c3-668e-4575-b9a6-4459ffacf952[\"Output\\nAssembly polished by short reads using Racon\"];\n  5 --> 594819c3-668e-4575-b9a6-4459ffacf952;\n  style 594819c3-668e-4575-b9a6-4459ffacf952 stroke:#2c3143,stroke-width:4px;"},{"workflow":"Galaxy-Workflow-Racon_polish_with_long_reads_x4.ga","tests":false,"url":"https://training.galaxyproject.org/training-material/topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-Racon_polish_with_long_reads_x4.ga","path":"topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-Racon_polish_with_long_reads_x4.ga","wfid":"assembly-largegenome","wfname":"galaxy-workflow-racon_polish_with_long_reads_x4","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/assembly-largegenome/versions/galaxy-workflow-racon_polish_with_long_reads_x4","license":"GPL-3.0-or-later","creators":[{"class":"Person","identifier":"0000-0002-9906-0673","name":"Anna Syme"}],"name":"Racon polish with long reads, x4 - upgraded","title":"Racon polish with long reads, x4 - upgraded","test_results":null,"modified":"2024-06-14 09:58:01 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\nAssembly to be polished\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"ℹ️ Input Dataset\\nlong reads\"];\n  style 1 stroke:#2c3143,stroke-width:4px;\n  2[\"ℹ️ Input Parameter\\nminimap setting for long reads \"];\n  style 2 fill:#ded,stroke:#393,stroke-width:4px;\n  3[\"Minimap2: map long reads to assembly\"];\n  2 -->|output| 3;\n  1 -->|output| 3;\n  0 -->|output| 3;\n  4[\"Racon: polish 1\"];\n  0 -->|output| 4;\n  3 -->|alignment_output| 4;\n  1 -->|output| 4;\n  5[\"Minimap2: map long reads to polished assembly 1\"];\n  2 -->|output| 5;\n  1 -->|output| 5;\n  4 -->|consensus| 5;\n  6[\"Racon: polish 2\"];\n  4 -->|consensus| 6;\n  5 -->|alignment_output| 6;\n  1 -->|output| 6;\n  7[\"Minimap2: map long reads to polished assembly 2\"];\n  2 -->|output| 7;\n  1 -->|output| 7;\n  6 -->|consensus| 7;\n  8[\"Racon: polish 3\"];\n  6 -->|consensus| 8;\n  7 -->|alignment_output| 8;\n  1 -->|output| 8;\n  9[\"Minimap2: map long reads to polished assembly 3\"];\n  2 -->|output| 9;\n  1 -->|output| 9;\n  8 -->|consensus| 9;\n  10[\"Racon: polish 4\"];\n  8 -->|consensus| 10;\n  9 -->|alignment_output| 10;\n  1 -->|output| 10;\n  bcf0f03c-5951-46a7-aa38-545aed9bc183[\"Output\\nAssembly polished by long reads using Racon\"];\n  10 --> bcf0f03c-5951-46a7-aa38-545aed9bc183;\n  style bcf0f03c-5951-46a7-aa38-545aed9bc183 stroke:#2c3143,stroke-width:4px;"},{"workflow":"Galaxy-Workflow-Trim_and_filter_reads.ga","tests":false,"url":"https://training.galaxyproject.org/training-material/topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-Trim_and_filter_reads.ga","path":"topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-Trim_and_filter_reads.ga","wfid":"assembly-largegenome","wfname":"galaxy-workflow-trim_and_filter_reads","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/assembly-largegenome/versions/galaxy-workflow-trim_and_filter_reads","license":"GPL-3.0-or-later","creators":[{"class":"Person","identifier":"0000-0002-9906-0673","name":"Anna Syme"}],"name":"Trim and filter reads - fastp - upgraded ","title":"Trim and filter reads - fastp - upgraded ","test_results":null,"modified":"2024-06-14 09:58:01 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\nIllumina reads R1\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"ℹ️ Input Dataset\\nIllumina reads R2\"];\n  style 1 stroke:#2c3143,stroke-width:4px;\n  2[\"ℹ️ Input Dataset\\nlong reads\"];\n  style 2 stroke:#2c3143,stroke-width:4px;\n  3[\"fastp on short reads\"];\n  0 -->|output| 3;\n  1 -->|output| 3;\n  656e4138-41ab-4561-8989-33de9ac9a2f3[\"Output\\nfastp report on short reads html\"];\n  3 --> 656e4138-41ab-4561-8989-33de9ac9a2f3;\n  style 656e4138-41ab-4561-8989-33de9ac9a2f3 stroke:#2c3143,stroke-width:4px;\n  0d53f347-0368-47cb-953a-2e4dac57e013[\"Output\\nfastp filtered R1 reads\"];\n  3 --> 0d53f347-0368-47cb-953a-2e4dac57e013;\n  style 0d53f347-0368-47cb-953a-2e4dac57e013 stroke:#2c3143,stroke-width:4px;\n  10fbe1e5-400c-4ffe-8794-9b776b0d7322[\"Output\\nfastp report on short reads json\"];\n  3 --> 10fbe1e5-400c-4ffe-8794-9b776b0d7322;\n  style 10fbe1e5-400c-4ffe-8794-9b776b0d7322 stroke:#2c3143,stroke-width:4px;\n  639ed3f7-0e51-4e5d-b6f8-081378962109[\"Output\\nfastp filtered R2 reads\"];\n  3 --> 639ed3f7-0e51-4e5d-b6f8-081378962109;\n  style 639ed3f7-0e51-4e5d-b6f8-081378962109 stroke:#2c3143,stroke-width:4px;\n  4[\"fastp on long reads\"];\n  2 -->|output| 4;\n  5e0d2c3d-41a4-4823-ae9c-b1e4d2826541[\"Output\\nfastp report on long reads html\"];\n  4 --> 5e0d2c3d-41a4-4823-ae9c-b1e4d2826541;\n  style 5e0d2c3d-41a4-4823-ae9c-b1e4d2826541 stroke:#2c3143,stroke-width:4px;\n  e6018ad6-86f4-4e78-8cf2-ccc8b97022fe[\"Output\\nfastp filtered long reads\"];\n  4 --> e6018ad6-86f4-4e78-8cf2-ccc8b97022fe;\n  style e6018ad6-86f4-4e78-8cf2-ccc8b97022fe stroke:#2c3143,stroke-width:4px;\n  69f8383b-a1be-4a74-95f4-3dba35e01426[\"Output\\nfastp report on long reads json\"];\n  4 --> 69f8383b-a1be-4a74-95f4-3dba35e01426;\n  style 69f8383b-a1be-4a74-95f4-3dba35e01426 stroke:#2c3143,stroke-width:4px;"},{"workflow":"Galaxy-Workflow-kmer_counting.ga","tests":false,"url":"https://training.galaxyproject.org/training-material/topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-kmer_counting.ga","path":"topics/assembly/tutorials/largegenome/workflows/Galaxy-Workflow-kmer_counting.ga","wfid":"assembly-largegenome","wfname":"galaxy-workflow-kmer_counting","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/assembly-largegenome/versions/galaxy-workflow-kmer_counting","license":"GPL-3.0-or-later","creators":[{"class":"Person","identifier":"0000-0002-9906-0673","name":"Anna Syme"}],"name":"kmer counting - meryl - upgraded","title":"kmer counting - meryl - upgraded","test_results":null,"modified":"2024-06-14 09:58:01 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\nIllumina reads R1\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"Meryl - count kmers\"];\n  0 -->|output| 1;\n  899ddd93-4c0f-4f81-a973-8120494ed983[\"Output\\nMeryl on input dataset(s): read-db.meryldb\"];\n  1 --> 899ddd93-4c0f-4f81-a973-8120494ed983;\n  style 899ddd93-4c0f-4f81-a973-8120494ed983 stroke:#2c3143,stroke-width:4px;\n  2[\"Meryl - generate histogram\"];\n  1 -->|read_db| 2;\n  3[\"Genomescope\"];\n  2 -->|read_db_hist| 3;\n  efc727b6-1ef4-4c4c-8cce-35c7d3cc8aac[\"Output\\nGenomeScope on input dataset(s) Transformed log plot\"];\n  3 --> efc727b6-1ef4-4c4c-8cce-35c7d3cc8aac;\n  style efc727b6-1ef4-4c4c-8cce-35c7d3cc8aac stroke:#2c3143,stroke-width:4px;\n  701df341-5767-44bc-ade2-6af498ab7467[\"Output\\nGenomeScope on input dataset(s) Transformed linear plot\"];\n  3 --> 701df341-5767-44bc-ade2-6af498ab7467;\n  style 701df341-5767-44bc-ade2-6af498ab7467 stroke:#2c3143,stroke-width:4px;\n  85fa4004-b351-47b3-84aa-6788d338037a[\"Output\\nGenomeScope on input dataset(s) Log plot\"];\n  3 --> 85fa4004-b351-47b3-84aa-6788d338037a;\n  style 85fa4004-b351-47b3-84aa-6788d338037a stroke:#2c3143,stroke-width:4px;\n  c71ce055-98f0-4354-9397-2f8833b90cc4[\"Output\\nGenomeScope on input dataset(s) Linear plot\"];\n  3 --> c71ce055-98f0-4354-9397-2f8833b90cc4;\n  style c71ce055-98f0-4354-9397-2f8833b90cc4 stroke:#2c3143,stroke-width:4px;"}],"api":"https://training.galaxyproject.org/training-material/api/topics/assembly/tutorials/largegenome/tutorial.json","tools":["barchart_gnuplot","toolshed.g2.bx.psu.edu/repos/bgruening/flye/flye/2.9.3+galaxy0","toolshed.g2.bx.psu.edu/repos/bgruening/racon/racon/1.5.0+galaxy1","toolshed.g2.bx.psu.edu/repos/devteam/fastqc/fastqc/0.74+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/bandage/bandage_image/2022.09+galaxy4","toolshed.g2.bx.psu.edu/repos/iuc/busco/busco/5.5.0+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/fasta_stats/fasta-stats/2.0","toolshed.g2.bx.psu.edu/repos/iuc/fastp/fastp/0.23.4+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/genomescope/genomescope/2.0+galaxy2","toolshed.g2.bx.psu.edu/repos/iuc/medaka_consensus_pipeline/medaka_consensus_pipeline/1.7.2+galaxy1","toolshed.g2.bx.psu.edu/repos/iuc/meryl/meryl/1.3+galaxy6","toolshed.g2.bx.psu.edu/repos/iuc/minimap2/minimap2/2.26+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/multiqc/multiqc/1.11+galaxy1","toolshed.g2.bx.psu.edu/repos/iuc/nanoplot/nanoplot/1.42.0+galaxy1","toolshed.g2.bx.psu.edu/repos/iuc/quast/quast/5.2.0+galaxy1"],"supported_servers":{"exact":[{"url":"https://usegalaxy.eu","name":"UseGalaxy.eu","usegalaxy":true},{"url":"https://usegalaxy.org.au","name":"UseGalaxy.org.au","usegalaxy":true}],"inexact":[{"url":"https://usegalaxy.cz/","name":"UseGalaxy.cz","usegalaxy":false}]},"topic_name_human":"Assembly","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"flye","owner":"bgruening","revisions":"291923e6f276","tool_panel_section_label":"Assembly","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"racon","owner":"bgruening","revisions":"78c533842eeb","tool_panel_section_label":"Assembly","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"fastqc","owner":"devteam","revisions":"5ec9f6bceaee","tool_panel_section_label":"FASTA/FASTQ","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"bandage","owner":"iuc","revisions":"ddddce450736","tool_panel_section_label":"Graph/Display Data","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"busco","owner":"iuc","revisions":"ea8146ee148f","tool_panel_section_label":"Annotation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"fasta_stats","owner":"iuc","revisions":"0dbb995c7d35","tool_panel_section_label":"FASTA/FASTQ","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"fastp","owner":"iuc","revisions":"c59d48774d03","tool_panel_section_label":"FASTA/FASTQ","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"genomescope","owner":"iuc","revisions":"01210c4e9144","tool_panel_section_label":"Assembly","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"medaka_consensus_pipeline","owner":"iuc","revisions":"fc8804320156","tool_panel_section_label":"Nanopore","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"meryl","owner":"iuc","revisions":"29dabd8db6f2","tool_panel_section_label":"Assembly","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"minimap2","owner":"iuc","revisions":"be1d967337e4","tool_panel_section_label":"Mapping","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"multiqc","owner":"iuc","revisions":"abfd8a6544d7","tool_panel_section_label":"Quality Control","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"nanoplot","owner":"iuc","revisions":"a02b8b3f5a0c","tool_panel_section_label":"Nanopore","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"quast","owner":"iuc","revisions":"72472698a2df","tool_panel_section_label":"Assembly","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: flye\n  owner: bgruening\n  revisions: 291923e6f276\n  tool_panel_section_label: Assembly\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: racon\n  owner: bgruening\n  revisions: 78c533842eeb\n  tool_panel_section_label: Assembly\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: fastqc\n  owner: devteam\n  revisions: 5ec9f6bceaee\n  tool_panel_section_label: FASTA/FASTQ\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bandage\n  owner: iuc\n  revisions: ddddce450736\n  tool_panel_section_label: Graph/Display Data\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: busco\n  owner: iuc\n  revisions: ea8146ee148f\n  tool_panel_section_label: Annotation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: fasta_stats\n  owner: iuc\n  revisions: 0dbb995c7d35\n  tool_panel_section_label: FASTA/FASTQ\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: fastp\n  owner: iuc\n  revisions: c59d48774d03\n  tool_panel_section_label: FASTA/FASTQ\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: genomescope\n  owner: iuc\n  revisions: 01210c4e9144\n  tool_panel_section_label: Assembly\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: medaka_consensus_pipeline\n  owner: iuc\n  revisions: fc8804320156\n  tool_panel_section_label: Nanopore\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: meryl\n  owner: iuc\n  revisions: 29dabd8db6f2\n  tool_panel_section_label: Assembly\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: minimap2\n  owner: iuc\n  revisions: be1d967337e4\n  tool_panel_section_label: Mapping\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: multiqc\n  owner: iuc\n  revisions: abfd8a6544d7\n  tool_panel_section_label: Quality Control\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: nanoplot\n  owner: iuc\n  revisions: a02b8b3f5a0c\n  tool_panel_section_label: Nanopore\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: quast\n  owner: iuc\n  revisions: 72472698a2df\n  tool_panel_section_label: Assembly\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":false,"slides_recordings":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial"}