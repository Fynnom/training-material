{"layout":"tutorial_hands_on","redirect_from":["/topics/introduction/tutorials/r-advanced/tutorial","/short/data-science/r-advanced","/short/T00102"],"title":"Advanced R in Galaxy","level":"Intermediate","zenodo_link":"","requirements":[{"type":"internal","topic_name":"galaxy-interface","tutorials":["rstudio"]},{"type":"internal","topic_name":"data-science","tutorials":["r-basics"]}],"follow_up_training":[{"type":"internal","topic_name":"transcriptomics","tutorials":["rna-seq-counts-to-viz-in-r"]}],"questions":["How can I manipulate data using R in Galaxy?","How do I get started with tabular data from Galaxy in R?"],"objectives":["Be able to load and explore the shape and contents of a tabular dataset using base R functions.","Understand factors and how they can be used to store and work with categorical data.","Apply common `dplyr` functions to manipulate data in R.","Employ the ‘pipe’ operator to link together a sequence of functions."],"time_estimation":"2H","key_points":["It is easy to import data into R from tabular formats. However, you still need to check that R has imported and interpreted your data correctly.","Just like Galaxy, base R's capabilities can be further enhanced by software packages developed by the user community.","Use the `dplyr` package to manipulate data frames.","Pipes can be used to combine simple operations into complex procedures."],"subtopic":"r","priority":2,"contributors":[{"name":"The Carpentries","joined":"2021-09","id":"carpentries","url":"https://training.galaxyproject.org/training-material/api/organisations/carpentries.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/carpentries/"},{"name":"Bérénice Batut","email":"berenice.batut@gmail.com","twitter":"bebatut","linkedin":"berenicebatut","matrix":"bebatut:matrix.org","orcid":"0000-0001-9852-1987","joined":"2017-09","elixir_node":"fr","contact_for_training":true,"location":{"country":"FR","lat":45.77,"lon":3.08},"fediverse":"https://piaille.fr/@bebatut","fediverse_flavor":"mastodon","affiliations":["gallantries","ifb","elixir-europe"],"id":"bebatut","url":"https://training.galaxyproject.org/training-material/api/contributors/bebatut.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/bebatut/"},{"name":"Fotis E. Psomopoulos","email":"fpsom@certh.gr","twitter":"fopsom","matrix":"fpsom:matrix.org","orcid":"0000-0002-0222-4273","linkedin":"fpsom","joined":"2019-03","elixir_node":"gr","affiliations":["gallantries","elixir-europe"],"id":"fpsom","url":"https://training.galaxyproject.org/training-material/api/contributors/fpsom.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/fpsom/"},{"name":"Toby Hodges","email":"tbyhdgs@gmail.com","twitter":"tbyhdgs","orcid":"0000-0003-1766-456X","joined":"2019-07","id":"tobyhodges","url":"https://training.galaxyproject.org/training-material/api/contributors/tobyhodges.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/tobyhodges/"},{"name":"Gallantries: Bridging Training Communities in Life Science, Environment and Health","short_name":"Gallantries","start_date":"2020-09-01","end_date":"2023-09-30","joined":"2020-09","avatar":"https://gallantries.github.io/assets/images/gallantries-logo.png","github":false,"funder":true,"url":"https://training.galaxyproject.org/training-material/api/funders/gallantries.json","funder_name":"Erasmus+ Programme","funding_id":"2020-1-NL01-KA203-064717","funding_system":"erasmusplus","funding_statement":"This project (<a href=\"https://erasmus-plus.ec.europa.eu/projects/search/details/2020-1-NL01-KA203-064717\"><code class=\"language-plaintext highlighter-rouge\">2020-1-NL01-KA203-064717</code></a>) is funded with the support of the Erasmus+ programme of the European Union. Their funding has supported a large number of tutorials within the GTN across a wide array of topics.\n<img src=\"https://gallantries.github.io/assets/images/logosbeneficaireserasmusright_en.jpg\" alt=\"eu flag with the text: with the support of the erasmus programme of the european union\" />\n<img src=\"https://www.erasmusplus.nl/assets/images/logo.png\" alt=\"erasmus plus logo\" />","members":["abretaud","bebatut","colineroyaux","fpsom","hexylena","shiltemann","yvanlebras"],"id":"gallantries","page":"https://training.galaxyproject.org/training-material/hall-of-fame/gallantries/"}],"tags":["R"],"recordings":[{"captioners":["ksuderman","nagoue"],"date":"2021-02-15","galaxy_version":"21.01","length":"1H","youtube_id":"_hWBGdlICqg","speakers":["fpsom"]}],"js_requirements":{"mathjax":46635,"mermaid":false},"short_id":"T00102","url":"/topics/data-science/tutorials/r-advanced/tutorial.html","topic_name":"data-science","tutorial_name":"r-advanced","dir":"topics/data-science/tutorials/r-advanced","symlink":null,"id":"data-science/r-advanced","ref_tutorials":["<p>With HTS-Seq data analysis, we generated tables containing list of DE genes, their expression, some statistics, etc. We can manipulate these tables using Galaxy, as we saw in some tutorials, e.g. <a href=\"/training-material/topics/transcriptomics/tutorials/ref-based/tutorial.html\">“Reference-based RNA-Seq data analysis”</a>, and create some visualisations.</p>\n\n<p>Sometimes we want to have some customizations on visualization, some complex table manipulations or some statistical analysis. If we can not find a Galaxy tools for that or the right parameters, we may need to use programming languages as R or Python.</p>\n\n<!-- Keeping this here because people may be familiar enough with R, that they go directly to this tutorial, and it is still useful information. -->\n\n<p>R is one of the most widely-used and powerful programming languages in bioinformatics. R especially shines where a variety of statistical tools are required (e.g. RNA-Seq, population genomics, etc.) and in the generation of publication-quality graphs and figures. Rather than get into an R vs. Python debate (both are useful), keep in mind that many of the concepts you will learn apply to Python and other programming languages.</p>\n\n<blockquote class=\"comment\">\n  <comment-title>On the content of the tutorial</comment-title>\n\n  <p>We believe that every learner can <strong>achieve competency with R</strong>. You have reached competency when you find that you are able to <strong>use R to handle common analysis challenges in a reasonable amount of time</strong> (which includes time needed to look at learning materials, search for answers online, and ask colleagues for help). As you spend more time using R (there is no substitute for regular use and practice) you will find yourself gaining competency and even expertise. The more familiar you get, the more complex the analyses you will be able to carry out, with less frustration, and in less time - the fantastic world of R awaits you!</p>\n\n  <p>Nobody wants to learn how to use R. People want to learn how to use R to answer their own research questions! Ok, maybe some folks learn R for R’s sake, but these lessons assume that you want to start analyzing genomic data as soon as possible. Given this, there are many valuable pieces of information about R that we simply won’t have time to cover. Hopefully, we will clear the hurdle of giving you just enough knowledge to be dangerous, which can be a high bar in R! We suggest you look into the additional learning materials in the box below.</p>\n\n  <p><strong>Some R skills we will <em>not</em> cover in these lessons</strong></p>\n\n  <ul>\n    <li>How to create and work with R matrices and R lists</li>\n    <li>How to create and work with loops and conditional statements, and the “apply” of functions (which are super useful, read more <a href=\"https://www.r-bloggers.com/r-tutorial-on-the-apply-family-of-functions/\">on this blog about apply functions</a>)</li>\n    <li>How to do basic string manipulations (e.g. finding patterns in text using grep, replacing text)</li>\n    <li>How to plot using the default R graphic tools (we <em>will</em> cover plot creation, but will do so using the popular plotting package <code class=\"language-plaintext highlighter-rouge\">ggplot2</code>)</li>\n    <li>How to use advanced R statistical functions</li>\n  </ul>\n\n  <blockquote class=\"tip\">\n    <tip-title>Where to learn more</tip-title>\n\n    <p>The following are good resources for learning more about R. Some of them can be quite technical, but if you are a regular R user you may ultimately need this technical knowledge.</p>\n    <ul>\n      <li><a href=\"https://cran.r-project.org/doc/contrib/Paradis-rdebuts_en.pdf\">R for Beginners</a>, by Emmanuel Paradis: a great starting point</li>\n      <li><a href=\"https://cran.r-project.org/manuals.html\">The R Manuals</a>, by the R project people</li>\n      <li><a href=\"https://cran.r-project.org/other-docs.html\">R contributed documentation</a>, also linked to the R project, with materials available in several languages</li>\n      <li><a href=\"http://r4ds.had.co.nz/\">R for Data Science</a>: a wonderful collection by noted R educators and developers Garrett Grolemund and Hadley Wickham</li>\n      <li><a href=\"https://peerj.com/collections/50-practicaldatascistats/\">Practical Data Science for Stats</a>: not exclusively about R usage, but a nice collection of pre-prints on data science and applications for R</li>\n      <li><a href=\"https://software-carpentry.org/lessons/\">Programming in R Software Carpentry lesson</a>: several Software Carpentry lessons in R to choose from</li>\n      <li><a href=\"https://www.datacamp.com/courses/free-introduction-to-r\">Data Camp Introduction to R</a>: a fun online learning platform for Data Science, including R.</li>\n    </ul>\n  </blockquote>\n</blockquote>\n\n<p>In this tutorial, we will take the list of DE genes extracted from DESEq2’s output that we generated in the <a href=\"/training-material/topics/transcriptomics/tutorials/ref-based/tutorial.html\">“Reference-based RNA-Seq data analysis” tutorial</a>, manipulate it and create some visualizations.</p>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n  <p>In this tutorial, we will cover:</p>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#get-familiar-with-the-annotated-de-genes-table-in-r\" id=\"markdown-toc-get-familiar-with-the-annotated-de-genes-table-in-r\">Get familiar with the annotated DE genes table in R</a>    <ol>\n      <li><a href=\"#import-tabular-data-into-r\" id=\"markdown-toc-import-tabular-data-into-r\">Import tabular data into R</a></li>\n      <li><a href=\"#summarize-and-determine-the-structure-of-a-data-frame\" id=\"markdown-toc-summarize-and-determine-the-structure-of-a-data-frame\">Summarize and determine the structure of a data frame</a></li>\n      <li><a href=\"#factors\" id=\"markdown-toc-factors\">Factors</a></li>\n      <li><a href=\"#subset-a-data-frame\" id=\"markdown-toc-subset-a-data-frame\">Subset a data frame</a></li>\n      <li><a href=\"#change-type-of-columns\" id=\"markdown-toc-change-type-of-columns\">Change type of columns</a></li>\n      <li><a href=\"#inspect-a-numerical-column-using-math-sorting-renaming\" id=\"markdown-toc-inspect-a-numerical-column-using-math-sorting-renaming\">Inspect a numerical column using math, sorting, renaming</a></li>\n      <li><a href=\"#save-the-data-frame-to-a-file\" id=\"markdown-toc-save-the-data-frame-to-a-file\">Save the data frame to a file</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#aggregate-and-analyze-with-dplyr\" id=\"markdown-toc-aggregate-and-analyze-with-dplyr\">Aggregate and Analyze with dplyr</a>    <ol>\n      <li><a href=\"#select-columns-and-filter-rows\" id=\"markdown-toc-select-columns-and-filter-rows\">Select columns and filter rows</a></li>\n      <li><a href=\"#create-columns\" id=\"markdown-toc-create-columns\">Create columns</a></li>\n      <li><a href=\"#group-and-summarize-data\" id=\"markdown-toc-group-and-summarize-data\">Group and summarize data</a></li>\n      <li><a href=\"#reshape-data-frames\" id=\"markdown-toc-reshape-data-frames\">Reshape data frames</a></li>\n    </ol>\n  </li>\n</ol>\n\n</blockquote>\n\n<h1 id=\"get-familiar-with-the-annotated-de-genes-table-in-r\">Get familiar with the annotated DE genes table in R</h1>\n\n<p>A substantial amount of the data we work with in science is tabular data, i.e. data arranged in rows and columns - also known as spreadsheets.</p>\n\n<blockquote class=\"comment\">\n  <comment-title>Few principles when working with data</comment-title>\n  <p>We want to remind you of a few principles before we work with our first set of example data:</p>\n\n  <ol>\n    <li>\n      <p><strong>Keep raw data separate from analyzed data</strong></p>\n\n      <p>This is principle number one, because if you can’t tell which files are the original raw data, you risk making some serious mistakes (e.g. drawing conclusion from data which have been manipulated in some unknown way).</p>\n\n      <p>When you work with data in R, you are not changing the original file which you loaded the data from. This is different than (for example) working with a spreadsheet program where changing the value of the cell leaves you one “save”-click away from overwriting the original file. You have to purposely use a writing function (e.g. <code class=\"language-plaintext highlighter-rouge\">write.csv()</code>) to save data loaded into R. In that case, be sure to save the manipulated data into a new file. More on this later in the lesson.</p>\n    </li>\n    <li>\n      <p><strong>Keep spreadsheet data Tidy</strong></p>\n\n      <p>The simplest principle of <em>Tidy</em> data is that we have one row in our spreadsheet for each observation or sample, and one column for every variable that we measure or report on. As simple as this sounds, it’s very easily violated. Most data scientists agree that significant amounts of their time is spent tidying data for analysis.</p>\n    </li>\n    <li>\n      <p><strong>Trust but verify</strong></p>\n\n      <p>Finally, while you don’t need to be paranoid about data, you should have a plan for how you will prepare it for analysis. <strong>This a focus of this lesson</strong>. You probably already have a lot of intuition, expectations, assumptions about your data - the range of values you expect, how many values should have been recorded, etc. Of course, as the data get larger our human ability to keep track will start to fail (and yes, it can fail for small data sets too). R will help you to examine your data so that you can have greater confidence in your analysis, and its reproducibility.</p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h2 id=\"import-tabular-data-into-r\">Import tabular data into R</h2>\n\n<p>As in the “R Basics” tutorial, we will continue in <span class=\"tool\" data-tool=\"interactive_tool_rstudio\" title=\"RStudio tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>RStudio</strong></span>.</p>\n\n<!--SNIPPET-->\n<blockquote class=\"hands_on\">   <div class=\"box-title hands_on-title\" id=\"hands-on-launch-rstudio\"><i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i> Hands-on: Launch RStudio</div>   <p>Depending on which server you are using, you may be able to run RStudio directly in Galaxy. If that is not available, RStudio Cloud can be an alternative.</p>   <blockquote class=\"tip\">   <tip-title>Launch RStudio in Galaxy</tip-title>   <p>Currently RStudio in Galaxy is only available on <a href=\"https://usegalaxy.eu\">UseGalaxy.eu</a> and <a href=\"https://usegalaxy.org\">UseGalaxy.org</a></p>   <ol>     <li>Open the Rstudio tool <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> by clicking <a href=\"https://usegalaxy.eu/?tool_id=interactive_tool_rstudio\">here to launch RStudio</a></li>     <li>Click Run Tool</li>     <li>The tool will start running and will stay running permanently</li>     <li>Click on the “User” menu at the top and go to “Active InteractiveTools” and locate the RStudio instance you started.</li>   </ol> </blockquote>   <blockquote class=\"tip\">   <tip-title>Launch RStudio Cloud if not available on Galaxy</tip-title>   <p>If RStudio is not available on the Galaxy instance:</p>   <ol>     <li>Register for <a href=\"https://client.login.rstudio.cloud/oauth/login?show_auth=0&amp;show_login=1&amp;show_setup=1\">RStudio Cloud</a>, or login if you already have an account</li>     <li>Create a new project</li>   </ol> </blockquote> </blockquote>\n<p><!--END_SNIPPET--></p>\n\n<p>There are several ways to import data into R. For our purpose here, we will focus on using the tools every R installation comes with (so called “base” R) to import a comma-delimited file containing the results of our variant calling workflow. We will need to load the sheet using a function called <code class=\"language-plaintext highlighter-rouge\">read.csv()</code>.</p>\n\n<blockquote class=\"question\">\n  <question-title>Review the arguments of the `read.csv()` function</question-title>\n\n  <p>Before using the <code class=\"language-plaintext highlighter-rouge\">read.csv()</code> function, use R’s help feature to answer the following questions.</p>\n\n  <blockquote class=\"tip\">\n    <tip-title>Getting help in R</tip-title>\n    <p>Entering <code class=\"language-plaintext highlighter-rouge\">?</code> before the function name and then running that line will bring up the help documentation. Also, when reading this particular help be careful to pay attention to the <code class=\"language-plaintext highlighter-rouge\">read.csv</code> expression under the <strong>Usage</strong> heading. Other answers will be in the <strong>Arguments</strong> heading.</p>\n  </blockquote>\n\n  <ol>\n    <li>What is the default parameter for <code class=\"language-plaintext highlighter-rouge\">header</code> in the <code class=\"language-plaintext highlighter-rouge\">read.csv()</code> function?</li>\n    <li>What argument would you have to change to read a file that was delimited by semicolons (<code class=\"language-plaintext highlighter-rouge\">;</code>) rather than commas?</li>\n    <li>What argument would you have to change to read file in which numbers used commas for decimal separation (i.e. 1,00)?</li>\n    <li>What argument would you have to change to read in only the first 10,000 rows of a very large file?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>The <code class=\"language-plaintext highlighter-rouge\">read.csv() </code>function has the argument <code class=\"language-plaintext highlighter-rouge\">header</code> set to <code class=\"language-plaintext highlighter-rouge\">TRUE</code> by default, this means the function always assumes the first row is header information, (i.e. column names)</li>\n      <li>The <code class=\"language-plaintext highlighter-rouge\">read.csv()</code> function has the argument ‘sep’ set to “,”. This means the function assumes commas are used as delimiters, as you would expect. Changing this parameter (e.g. <code class=\"language-plaintext highlighter-rouge\">sep=\";\"</code>) would now interpret semicolons as delimiters.</li>\n      <li>Although it is not listed in the <code class=\"language-plaintext highlighter-rouge\">read.csv()</code> usage, <code class=\"language-plaintext highlighter-rouge\">read.csv()</code> is a “version” of the function <code class=\"language-plaintext highlighter-rouge\">read.table()</code> and accepts all its arguments. If you set <code class=\"language-plaintext highlighter-rouge\">dec=\",\"</code> you could change the decimal operator. We’d probably assume the delimiter is some other character.</li>\n      <li>You can set <code class=\"language-plaintext highlighter-rouge\">nrow</code> to a numeric value (e.g. <code class=\"language-plaintext highlighter-rouge\">nrow=10000</code>) to choose how many rows of a file you read in. This may be useful for very large files where not all the data is needed to test some data cleaning steps you are applying.</li>\n    </ol>\n\n    <p>Hopefully, this exercise gets you thinking about using the provided help documentation in R. There are many arguments that exist, but which we wont have time to cover. Look here to get familiar with functions you use frequently, you may be surprised at what you find they can do.</p>\n\n  </blockquote>\n</blockquote>\n\n<p>Now, let’s read the file with the annotated differentially expressed genes that was produced in the “<a href=\"/training-material/topics/transcriptomics/tutorials/ref-based/tutorial.html\">Reference-based RNA-Seq data analysis</a>” tutorial.</p>\n\n<!--\n> <hands-on-title>Import dataset into Galaxy</hands-on-title>\n> 1. In Galaxy, upload the following file from Zenodo:\n>    ```\n>    https://zenodo.org/record/3477564/files/annotatedDEgenes.tabular\n>    ```\n> 2. Remember the dataset number (e.g. `2` in the example below)\n>    <a href=\"../../images/rna-seq-counts-to-viz-in-r/dataset_number.png\" rel=\"noopener noreferrer\"><img src=\"../../images/rna-seq-counts-to-viz-in-r/dataset_number.png\"  alt=\"todo. \"   loading=\"lazy\"></a>\n>\n{: .hands_on}\n-->\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Read the annotated differentially expressed genes</hands-on-title>\n  <ol>\n    <li>Create a new script (if needed)</li>\n    <li>\n      <p>Read the tabular file in an object called <code class=\"language-plaintext highlighter-rouge\">annotatedDEgenes</code>. We can import directly by URL:</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\">## read in a CSV file and save it as 'annotatedDEgenes'</span><span class=\"w\">\n</span><span class=\"n\">annotatedDEgenes</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">read.csv</span><span class=\"p\">(</span><span class=\"s2\">\"https://zenodo.org/record/3477564/files/annotatedDEgenes.tabular\"</span><span class=\"p\">)</span><span class=\"w\">\n</span></code></pre></div>      </div>\n\n      <p>The first argument to pass to our <code class=\"language-plaintext highlighter-rouge\">read.csv()</code> function is the file path for our data. The file path must be in quotes and now is a good time to remember to use tab autocompletion. If you use tab autocompletion you avoid typos and errors in file paths. Use it!</p>\n    </li>\n    <li>Inspect the <strong>Environment</strong> panel</li>\n  </ol>\n\n  <blockquote class=\"tip\">\n    <tip-title>Upload files from a Galaxy history to RStudio</tip-title>\n    <p>Rstudio in Galaxy provides some special functions to import and export from your history.</p>\n\n    <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">gx_get</span><span class=\"p\">(</span><span class=\"m\">2</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"c1\"># will import dataset number 2 from your history</span><span class=\"w\">\n</span></code></pre></div>    </div>\n  </blockquote>\n</blockquote>\n\n<p>In the <strong>Environment</strong> panel, you should have the <code class=\"language-plaintext highlighter-rouge\">annotatedDEgenes</code> object, listed as 130 obs. (observations/rows) of 1 variable (column) - so the command worked (sort of)!</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Inspect the annotatedDEgenes file</hands-on-title>\n  <ol>\n    <li>Double-click on the name of the object in the <strong>Environment</strong> panel</li>\n  </ol>\n\n</blockquote>\n\n<p>It will open a view of the data in a new tab on the top-left panel.</p>\n\n<p>As you can see, there is a problem with how the data has been loaded. The table should contain 130 observations of 13 variables.</p>\n\n<blockquote class=\"question\">\n  <question-title>Identify the issue with data</question-title>\n\n  <ol>\n    <li>What is wrong?</li>\n    <li>How should you adjust the parameters for <code class=\"language-plaintext highlighter-rouge\">read.csv()</code> in order to produce the intended output?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>The data file was not delimited by commas (<code class=\"language-plaintext highlighter-rouge\">,</code>) which is the default expected delimiter for <code class=\"language-plaintext highlighter-rouge\">read.csv()</code>. Instead it seems like it’s delimited by “white space”, i.e. spaces and/or tabs.</li>\n      <li>We need to set the correct delimiter using the parameter <code class=\"language-plaintext highlighter-rouge\">sep</code>. Given that we are not sure what the actual delimiter is, we could try both options, i.e. <code class=\"language-plaintext highlighter-rouge\">sep=\" \"</code> (<em>space</em>) and <code class=\"language-plaintext highlighter-rouge\">sep=\"\\t\"</code> (<em>tab</em>).</li>\n    </ol>\n\n  </blockquote>\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Read correctly tabular file</hands-on-title>\n  <ol>\n    <li>\n      <p>Read the file given it’s a tabular file</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">annotatedDEgenes</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">read.csv</span><span class=\"p\">(</span><span class=\"s2\">\"https://zenodo.org/record/3477564/files/annotatedDEgenes.tabular\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">sep</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"\\t\"</span><span class=\"p\">)</span><span class=\"w\">\n</span></code></pre></div>      </div>\n    </li>\n    <li>Inspect the object in the <strong>Environment</strong> panel</li>\n    <li>\n      <p>Open the object</p>\n\n      <p>You should have now a nice table</p>\n    </li>\n    <li>\n      <p>Check the column names</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">colnames</span><span class=\"p\">(</span><span class=\"n\">annotatedDEgenes</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"p\">[</span><span class=\"m\">1</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"s2\">\"GeneID\"</span><span class=\"w\">     </span><span class=\"s2\">\"Base.mean\"</span><span class=\"w\">  </span><span class=\"s2\">\"log2.FC.\"</span><span class=\"w\">   </span><span class=\"s2\">\"StdErr\"</span><span class=\"w\">     </span><span class=\"s2\">\"Wald.Stats\"</span><span class=\"w\">\n</span><span class=\"p\">[</span><span class=\"m\">6</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"s2\">\"P.value\"</span><span class=\"w\">    </span><span class=\"s2\">\"P.adj\"</span><span class=\"w\">      </span><span class=\"s2\">\"Chromosome\"</span><span class=\"w\"> </span><span class=\"s2\">\"Start\"</span><span class=\"w\">      </span><span class=\"s2\">\"End\"</span><span class=\"w\">\n</span><span class=\"p\">[</span><span class=\"m\">11</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"s2\">\"Strand\"</span><span class=\"w\">     </span><span class=\"s2\">\"Feature\"</span><span class=\"w\">    </span><span class=\"s2\">\"Gene.name\"</span><span class=\"w\">\n</span></code></pre></div>      </div>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>Congratulations! You’ve successfully loaded your data into RStudio!</p>\n\n<h2 id=\"summarize-and-determine-the-structure-of-a-data-frame\">Summarize and determine the structure of a data frame</h2>\n\n<p>Tabular data are stored in R using <strong>data frame</strong>. A data frame could also be thought of as a collection of vectors, all of which have the same length.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Learn more about our data frame</hands-on-title>\n  <ol>\n    <li>\n      <p>Get summary statistics of <code class=\"language-plaintext highlighter-rouge\">annotatedDEgenes</code> using <code class=\"language-plaintext highlighter-rouge\">summary</code> function</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\">## get summary statistics on a data frame</span><span class=\"w\">\n</span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">summary</span><span class=\"p\">(</span><span class=\"n\">annotatedDEgenes</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"n\">GeneID</span><span class=\"w\">            </span><span class=\"n\">Base.mean</span><span class=\"w\">          </span><span class=\"n\">log2.FC.</span><span class=\"w\">          </span><span class=\"n\">StdErr</span><span class=\"w\">            </span><span class=\"n\">Wald.Stats</span><span class=\"w\">\n</span><span class=\"n\">FBgn0000071</span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"m\">1</span><span class=\"w\">   </span><span class=\"n\">Min.</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"w\">   </span><span class=\"m\">19.15</span><span class=\"w\">   </span><span class=\"n\">Min.</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"m\">-4.1485</span><span class=\"w\">   </span><span class=\"n\">Min.</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"m\">0.08433</span><span class=\"w\">   </span><span class=\"n\">Min.</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"m\">-30.741</span><span class=\"w\">\n</span><span class=\"n\">FBgn0000079</span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"m\">1</span><span class=\"w\">   </span><span class=\"m\">1</span><span class=\"n\">st</span><span class=\"w\"> </span><span class=\"n\">Qu.</span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"m\">100.29</span><span class=\"w\">   </span><span class=\"m\">1</span><span class=\"n\">st</span><span class=\"w\"> </span><span class=\"n\">Qu.</span><span class=\"o\">:</span><span class=\"m\">-1.3363</span><span class=\"w\">   </span><span class=\"m\">1</span><span class=\"n\">st</span><span class=\"w\"> </span><span class=\"n\">Qu.</span><span class=\"o\">:</span><span class=\"m\">0.12849</span><span class=\"w\">   </span><span class=\"m\">1</span><span class=\"n\">st</span><span class=\"w\"> </span><span class=\"n\">Qu.</span><span class=\"o\">:</span><span class=\"m\">-10.005</span><span class=\"w\">\n</span><span class=\"n\">FBgn0000116</span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"m\">1</span><span class=\"w\">   </span><span class=\"n\">Median</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"m\">237.99</span><span class=\"w\">   </span><span class=\"n\">Median</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"m\">-1.0272</span><span class=\"w\">   </span><span class=\"n\">Median</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"m\">0.16370</span><span class=\"w\">   </span><span class=\"n\">Median</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"m\">-4.982</span><span class=\"w\">\n</span><span class=\"n\">FBgn0000406</span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"m\">1</span><span class=\"w\">   </span><span class=\"n\">Mean</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"m\">1911.27</span><span class=\"w\">   </span><span class=\"n\">Mean</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"m\">-0.2074</span><span class=\"w\">   </span><span class=\"n\">Mean</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"m\">0.16432</span><span class=\"w\">   </span><span class=\"n\">Mean</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"m\">-1.901</span><span class=\"w\">\n</span><span class=\"n\">FBgn0000567</span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"m\">1</span><span class=\"w\">   </span><span class=\"m\">3</span><span class=\"n\">rd</span><span class=\"w\"> </span><span class=\"n\">Qu.</span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"m\">948.66</span><span class=\"w\">   </span><span class=\"m\">3</span><span class=\"n\">rd</span><span class=\"w\"> </span><span class=\"n\">Qu.</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"m\">1.2203</span><span class=\"w\">   </span><span class=\"m\">3</span><span class=\"n\">rd</span><span class=\"w\"> </span><span class=\"n\">Qu.</span><span class=\"o\">:</span><span class=\"m\">0.19866</span><span class=\"w\">   </span><span class=\"m\">3</span><span class=\"n\">rd</span><span class=\"w\"> </span><span class=\"n\">Qu.</span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"m\">7.692</span><span class=\"w\">\n</span><span class=\"n\">FBgn0001137</span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"m\">1</span><span class=\"w\">   </span><span class=\"n\">Max.</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"m\">65114.84</span><span class=\"w\">   </span><span class=\"n\">Max.</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"m\">2.6999</span><span class=\"w\">   </span><span class=\"n\">Max.</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"m\">0.23292</span><span class=\"w\">   </span><span class=\"n\">Max.</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"m\">27.566</span><span class=\"w\">\n</span><span class=\"p\">(</span><span class=\"n\">Other</span><span class=\"p\">)</span><span class=\"w\">    </span><span class=\"o\">:</span><span class=\"m\">124</span><span class=\"w\">\n</span><span class=\"n\">P.value</span><span class=\"w\">             </span><span class=\"n\">P.adj</span><span class=\"w\">               </span><span class=\"n\">Seqname</span><span class=\"w\">    </span><span class=\"n\">Start</span><span class=\"w\">              </span><span class=\"n\">End</span><span class=\"w\">                </span><span class=\"n\">Strand</span><span class=\"w\">\n</span><span class=\"n\">Min.</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"m\">0.000e+00</span><span class=\"w\">   </span><span class=\"n\">Min.</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"m\">0.000e+00</span><span class=\"w\">   </span><span class=\"n\">chr2L</span><span class=\"o\">:</span><span class=\"m\">24</span><span class=\"w\">   </span><span class=\"n\">Min.</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"m\">127448</span><span class=\"w\">   </span><span class=\"n\">Min.</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"m\">140340</span><span class=\"w\">   </span><span class=\"o\">-:</span><span class=\"m\">58</span><span class=\"w\">\n</span><span class=\"m\">1</span><span class=\"n\">st</span><span class=\"w\"> </span><span class=\"n\">Qu.</span><span class=\"o\">:</span><span class=\"m\">0.000e+00</span><span class=\"w\">   </span><span class=\"m\">1</span><span class=\"n\">st</span><span class=\"w\"> </span><span class=\"n\">Qu.</span><span class=\"o\">:</span><span class=\"m\">0.000e+00</span><span class=\"w\">   </span><span class=\"n\">chr2R</span><span class=\"o\">:</span><span class=\"m\">31</span><span class=\"w\">   </span><span class=\"m\">1</span><span class=\"n\">st</span><span class=\"w\"> </span><span class=\"n\">Qu.</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"m\">7277516</span><span class=\"w\">   </span><span class=\"m\">1</span><span class=\"n\">st</span><span class=\"w\"> </span><span class=\"n\">Qu.</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"m\">7279063</span><span class=\"w\">   </span><span class=\"o\">+:</span><span class=\"m\">72</span><span class=\"w\">\n</span><span class=\"n\">Median</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"m\">0.000e+00</span><span class=\"w\">   </span><span class=\"n\">Median</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"m\">0.000e+00</span><span class=\"w\">   </span><span class=\"n\">chr3L</span><span class=\"o\">:</span><span class=\"m\">27</span><span class=\"w\">   </span><span class=\"n\">Median</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"m\">13161546</span><span class=\"w\">   </span><span class=\"n\">Median</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"m\">13166253</span><span class=\"w\">\n</span><span class=\"n\">Mean</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"m\">4.201e-07</span><span class=\"w\">   </span><span class=\"n\">Mean</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"m\">9.321e-06</span><span class=\"w\">   </span><span class=\"n\">chr3R</span><span class=\"o\">:</span><span class=\"m\">32</span><span class=\"w\">   </span><span class=\"n\">Mean</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"m\">13436843</span><span class=\"w\">   </span><span class=\"n\">Mean</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"m\">13446444</span><span class=\"w\">\n</span><span class=\"m\">3</span><span class=\"n\">rd</span><span class=\"w\"> </span><span class=\"n\">Qu.</span><span class=\"o\">:</span><span class=\"m\">7.000e-12</span><span class=\"w\">   </span><span class=\"m\">3</span><span class=\"n\">rd</span><span class=\"w\"> </span><span class=\"n\">Qu.</span><span class=\"o\">:</span><span class=\"m\">3.700e-10</span><span class=\"w\">   </span><span class=\"n\">chrX</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"m\">16</span><span class=\"w\">   </span><span class=\"m\">3</span><span class=\"n\">rd</span><span class=\"w\"> </span><span class=\"n\">Qu.</span><span class=\"o\">:</span><span class=\"m\">19250429</span><span class=\"w\">   </span><span class=\"m\">3</span><span class=\"n\">rd</span><span class=\"w\"> </span><span class=\"n\">Qu.</span><span class=\"o\">:</span><span class=\"m\">19284637</span><span class=\"w\">\n</span><span class=\"n\">Max.</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"m\">9.418e-06</span><span class=\"w\">   </span><span class=\"n\">Max.</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"m\">1.951e-04</span><span class=\"w\">              </span><span class=\"n\">Max.</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"m\">31196915</span><span class=\"w\">   </span><span class=\"n\">Max.</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"m\">31203722</span><span class=\"w\">\n\n</span><span class=\"n\">Feature</span><span class=\"w\">              </span><span class=\"n\">Gene.Name</span><span class=\"w\">\n</span><span class=\"n\">lincRNA</span><span class=\"w\">       </span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"m\">3</span><span class=\"w\">   </span><span class=\"n\">Ama</span><span class=\"w\">        </span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"m\">1</span><span class=\"w\">\n</span><span class=\"n\">protein_coding</span><span class=\"o\">:</span><span class=\"m\">126</span><span class=\"w\">   </span><span class=\"n\">Amy</span><span class=\"o\">-</span><span class=\"n\">p</span><span class=\"w\">      </span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"m\">1</span><span class=\"w\">\n</span><span class=\"n\">pseudogene</span><span class=\"w\">    </span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"m\">1</span><span class=\"w\">   </span><span class=\"n\">Ant2</span><span class=\"w\">       </span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"m\">1</span><span class=\"w\">\n                     </span><span class=\"n\">Argk</span><span class=\"w\">       </span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"m\">1</span><span class=\"w\">\n                     </span><span class=\"n\">BM</span><span class=\"m\">-40</span><span class=\"o\">-</span><span class=\"n\">SPARC</span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"m\">1</span><span class=\"w\">\n                     </span><span class=\"n\">bou</span><span class=\"w\">        </span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"m\">1</span><span class=\"w\">\n                     </span><span class=\"p\">(</span><span class=\"n\">Other</span><span class=\"p\">)</span><span class=\"w\">    </span><span class=\"o\">:</span><span class=\"m\">124</span><span class=\"w\">\n</span></code></pre></div>      </div>\n    </li>\n    <li>\n      <p>Get the structure of <code class=\"language-plaintext highlighter-rouge\">annotatedDEgenes</code> using <code class=\"language-plaintext highlighter-rouge\">str</code> function</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\">## get the structure of a data frame</span><span class=\"w\">\n</span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">str</span><span class=\"p\">(</span><span class=\"n\">annotatedDEgenes</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"s1\">'data.frame'</span><span class=\"o\">:</span><span class=\"w\">\t</span><span class=\"m\">130</span><span class=\"w\"> </span><span class=\"n\">obs.</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\">  </span><span class=\"m\">13</span><span class=\"w\"> </span><span class=\"n\">variables</span><span class=\"o\">:</span><span class=\"w\">\n </span><span class=\"o\">$</span><span class=\"w\"> </span><span class=\"n\">GeneID</span><span class=\"w\">    </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Factor</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"o\">/</span><span class=\"w\"> </span><span class=\"m\">130</span><span class=\"w\"> </span><span class=\"n\">levels</span><span class=\"w\"> </span><span class=\"s2\">\"FBgn0000071\"</span><span class=\"p\">,</span><span class=\"n\">..</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"m\">87</span><span class=\"w\"> </span><span class=\"m\">12</span><span class=\"w\"> </span><span class=\"m\">28</span><span class=\"w\"> </span><span class=\"m\">26</span><span class=\"w\"> </span><span class=\"m\">31</span><span class=\"w\"> </span><span class=\"m\">96</span><span class=\"w\"> </span><span class=\"m\">65</span><span class=\"w\"> </span><span class=\"m\">62</span><span class=\"w\"> </span><span class=\"m\">125</span><span class=\"w\"> </span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"n\">...</span><span class=\"w\">\n </span><span class=\"o\">$</span><span class=\"w\"> </span><span class=\"n\">Base.mean</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">num</span><span class=\"w\">  </span><span class=\"m\">1087</span><span class=\"w\"> </span><span class=\"m\">6410</span><span class=\"w\"> </span><span class=\"m\">65115</span><span class=\"w\"> </span><span class=\"m\">2192</span><span class=\"w\"> </span><span class=\"m\">5430</span><span class=\"w\"> </span><span class=\"n\">...</span><span class=\"w\">\n </span><span class=\"o\">$</span><span class=\"w\"> </span><span class=\"n\">log2.FC.</span><span class=\"w\">  </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">num</span><span class=\"w\">  </span><span class=\"m\">-4.15</span><span class=\"w\"> </span><span class=\"m\">-3</span><span class=\"w\"> </span><span class=\"m\">-2.38</span><span class=\"w\"> </span><span class=\"m\">2.7</span><span class=\"w\"> </span><span class=\"m\">-2.11</span><span class=\"w\"> </span><span class=\"n\">...</span><span class=\"w\">\n </span><span class=\"o\">$</span><span class=\"w\"> </span><span class=\"n\">StdErr</span><span class=\"w\">    </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">num</span><span class=\"w\">  </span><span class=\"m\">0.1349</span><span class=\"w\"> </span><span class=\"m\">0.1043</span><span class=\"w\"> </span><span class=\"m\">0.0843</span><span class=\"w\"> </span><span class=\"m\">0.0979</span><span class=\"w\"> </span><span class=\"m\">0.0925</span><span class=\"w\"> </span><span class=\"n\">...</span><span class=\"w\">\n </span><span class=\"o\">$</span><span class=\"w\"> </span><span class=\"n\">Wald.Stats</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">num</span><span class=\"w\">  </span><span class=\"m\">-30.7</span><span class=\"w\"> </span><span class=\"m\">-28.7</span><span class=\"w\"> </span><span class=\"m\">-28.2</span><span class=\"w\"> </span><span class=\"m\">27.6</span><span class=\"w\"> </span><span class=\"m\">-22.7</span><span class=\"w\"> </span><span class=\"n\">...</span><span class=\"w\">\n </span><span class=\"o\">$</span><span class=\"w\"> </span><span class=\"n\">P.value</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">num</span><span class=\"w\">  </span><span class=\"m\">1.62e-207</span><span class=\"w\"> </span><span class=\"m\">9.42e-182</span><span class=\"w\"> </span><span class=\"m\">2.85e-175</span><span class=\"w\"> </span><span class=\"m\">2.85e-167</span><span class=\"w\"> </span><span class=\"m\">1.57e-114</span><span class=\"w\"> </span><span class=\"n\">...</span><span class=\"w\">\n </span><span class=\"o\">$</span><span class=\"w\"> </span><span class=\"n\">P.adj</span><span class=\"w\">     </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">num</span><span class=\"w\">  </span><span class=\"m\">1.39e-203</span><span class=\"w\"> </span><span class=\"m\">4.04e-178</span><span class=\"w\"> </span><span class=\"m\">8.15e-172</span><span class=\"w\"> </span><span class=\"m\">6.10e-164</span><span class=\"w\"> </span><span class=\"m\">2.70e-111</span><span class=\"w\"> </span><span class=\"n\">...</span><span class=\"w\">\n </span><span class=\"o\">$</span><span class=\"w\"> </span><span class=\"n\">Seqname</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Factor</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"o\">/</span><span class=\"w\"> </span><span class=\"m\">5</span><span class=\"w\"> </span><span class=\"n\">levels</span><span class=\"w\"> </span><span class=\"s2\">\"chr2L\"</span><span class=\"p\">,</span><span class=\"s2\">\"chr2R\"</span><span class=\"p\">,</span><span class=\"n\">..</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"m\">4</span><span class=\"w\"> </span><span class=\"m\">5</span><span class=\"w\"> </span><span class=\"m\">4</span><span class=\"w\"> </span><span class=\"m\">5</span><span class=\"w\"> </span><span class=\"m\">3</span><span class=\"w\"> </span><span class=\"m\">4</span><span class=\"w\"> </span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"m\">3</span><span class=\"w\"> </span><span class=\"m\">4</span><span class=\"w\"> </span><span class=\"n\">...</span><span class=\"w\">\n </span><span class=\"o\">$</span><span class=\"w\"> </span><span class=\"n\">Start</span><span class=\"w\">     </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">int</span><span class=\"w\">  </span><span class=\"m\">24141394</span><span class=\"w\"> </span><span class=\"m\">10780892</span><span class=\"w\"> </span><span class=\"m\">26869237</span><span class=\"w\"> </span><span class=\"m\">10778953</span><span class=\"w\"> </span><span class=\"m\">13846053</span><span class=\"w\"> </span><span class=\"m\">31196915</span><span class=\"w\"> </span><span class=\"m\">24945138</span><span class=\"w\"> </span><span class=\"m\">22550093</span><span class=\"w\"> </span><span class=\"m\">820758</span><span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\">    </span><span class=\"m\">6762592</span><span class=\"w\"> </span><span class=\"n\">...</span><span class=\"w\">\n </span><span class=\"o\">$</span><span class=\"w\"> </span><span class=\"n\">End</span><span class=\"w\">       </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">int</span><span class=\"w\">  </span><span class=\"m\">24147490</span><span class=\"w\"> </span><span class=\"m\">10786958</span><span class=\"w\"> </span><span class=\"m\">26871995</span><span class=\"w\"> </span><span class=\"m\">10786907</span><span class=\"w\"> </span><span class=\"m\">13860001</span><span class=\"w\"> </span><span class=\"m\">31203722</span><span class=\"w\"> </span><span class=\"m\">24946636</span><span class=\"w\"> </span><span class=\"m\">22552113</span><span class=\"w\"> </span><span class=\"m\">821512</span><span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\">    </span><span class=\"m\">6765261</span><span class=\"w\"> </span><span class=\"n\">...</span><span class=\"w\">\n </span><span class=\"o\">$</span><span class=\"w\"> </span><span class=\"n\">Strand</span><span class=\"w\">    </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Factor</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"o\">/</span><span class=\"w\"> </span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"n\">levels</span><span class=\"w\"> </span><span class=\"s2\">\"-\"</span><span class=\"p\">,</span><span class=\"s2\">\"+\"</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"n\">...</span><span class=\"w\">\n </span><span class=\"o\">$</span><span class=\"w\"> </span><span class=\"n\">Feature</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Factor</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"o\">/</span><span class=\"w\"> </span><span class=\"m\">3</span><span class=\"w\"> </span><span class=\"n\">levels</span><span class=\"w\"> </span><span class=\"s2\">\"lincRNA\"</span><span class=\"p\">,</span><span class=\"s2\">\"protein_coding\"</span><span class=\"p\">,</span><span class=\"n\">..</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"n\">...</span><span class=\"w\">\n </span><span class=\"o\">$</span><span class=\"w\"> </span><span class=\"n\">Gene.Name</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Factor</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"o\">/</span><span class=\"w\"> </span><span class=\"m\">130</span><span class=\"w\"> </span><span class=\"n\">levels</span><span class=\"w\"> </span><span class=\"s2\">\"Ama\"</span><span class=\"p\">,</span><span class=\"s2\">\"Amy-p\"</span><span class=\"p\">,</span><span class=\"n\">..</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"m\">88</span><span class=\"w\"> </span><span class=\"m\">113</span><span class=\"w\"> </span><span class=\"m\">5</span><span class=\"w\"> </span><span class=\"m\">3</span><span class=\"w\"> </span><span class=\"m\">84</span><span class=\"w\"> </span><span class=\"m\">26</span><span class=\"w\"> </span><span class=\"m\">41</span><span class=\"w\"> </span><span class=\"m\">53</span><span class=\"w\"> </span><span class=\"m\">69</span><span class=\"w\"> </span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"n\">...</span><span class=\"w\">\n</span></code></pre></div>      </div>\n    </li>\n  </ol>\n</blockquote>\n\n<p>Ok, thats a lot to unpack! Some things to notice:</p>\n\n<ul>\n  <li>the object type <code class=\"language-plaintext highlighter-rouge\">data.frame</code> is displayed in the first row along with its dimensions, in this case 130 observations (rows) and 13 variables (columns)</li>\n  <li>Each variable (column) has a name (e.g. <code class=\"language-plaintext highlighter-rouge\">GeneID</code>). This is followed by the object mode (e.g. <code class=\"language-plaintext highlighter-rouge\">factor</code>, <code class=\"language-plaintext highlighter-rouge\">int</code>, <code class=\"language-plaintext highlighter-rouge\">num</code>, etc.). Notice that before each variable name there is a <code class=\"language-plaintext highlighter-rouge\">$</code> - this will be important later.</li>\n</ul>\n\n<p>So from both <code class=\"language-plaintext highlighter-rouge\">summary</code> and <code class=\"language-plaintext highlighter-rouge\">str</code>, we know that our data frame had 13 variables that summarize the data.</p>\n\n<ul>\n  <li>\n    <p><code class=\"language-plaintext highlighter-rouge\">Base.mean</code>, <code class=\"language-plaintext highlighter-rouge\">log2.FC.</code> and <code class=\"language-plaintext highlighter-rouge\">P.value</code> variables (and several others) are numerical data</p>\n\n    <p>We get summary statistics on the min and max values for these columns, as well as mean, median, and interquartile ranges</p>\n  </li>\n  <li>\n    <p>Many of the other variables (e.g. <code class=\"language-plaintext highlighter-rouge\">Strand</code>) are treated as categorical data</p>\n\n    <p>This type has special treatment in R - more on this in a bit. The most frequent 6 different categories and the number of times they appear (e.g. the <code class=\"language-plaintext highlighter-rouge\">Strand</code> called <code class=\"language-plaintext highlighter-rouge\">-</code> appeared 58 times) are displayed. Another example is the <code class=\"language-plaintext highlighter-rouge\">protein_coding</code> value for <code class=\"language-plaintext highlighter-rouge\">Feature</code> which appeared in 126 observations.</p>\n  </li>\n</ul>\n\n<h2 id=\"factors\">Factors</h2>\n\n<p>Factors, the final major data structure we will introduce, can be thought of as vectors which are specialized for categorical data. Given R’s specialization for statistics, this make sense since categorial and continuous variables usually have different treatments. Sometimes you may want to have data treated as a factor, but in other cases, this may be undesirable.</p>\n\n<p>Since some of the data in our data frame are factors, lets see how factors work.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Inspect a factor object</hands-on-title>\n  <ol>\n    <li>\n      <p>Extract the <code class=\"language-plaintext highlighter-rouge\">feature</code> column to a new object called <code class=\"language-plaintext highlighter-rouge\">feature</code></p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\">## extract the \"feature\" column to a new object</span><span class=\"w\">\n</span><span class=\"n\">feature</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">annotatedDEgenes</span><span class=\"o\">$</span><span class=\"n\">Feature</span><span class=\"w\">\n</span></code></pre></div>      </div>\n    </li>\n    <li>\n      <p>Inspect the first few items in our  using <code class=\"language-plaintext highlighter-rouge\">head</code> function</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">head</span><span class=\"p\">(</span><span class=\"n\">feature</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"p\">[</span><span class=\"m\">1</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">protein_coding</span><span class=\"w\"> </span><span class=\"n\">protein_coding</span><span class=\"w\"> </span><span class=\"n\">protein_coding</span><span class=\"w\"> </span><span class=\"n\">protein_coding</span><span class=\"w\">\n</span><span class=\"p\">[</span><span class=\"m\">5</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">protein_coding</span><span class=\"w\"> </span><span class=\"n\">protein_coding</span><span class=\"w\">\n</span><span class=\"n\">Levels</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">lincRNA</span><span class=\"w\"> </span><span class=\"n\">protein_coding</span><span class=\"w\"> </span><span class=\"n\">pseudogene</span><span class=\"w\">\n</span></code></pre></div>      </div>\n    </li>\n  </ol>\n</blockquote>\n\n<p>What we get back are the items in our factor, and also something called “Levels”. <strong>Levels are the different categories contained in a factor</strong>. By default, R will organize the levels in a factor in alphabetical order. So the first level in this factor is “lincRNA”.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Get the structure of a factor object</hands-on-title>\n  <ol>\n    <li>\n      <p>Get the structure of the <code class=\"language-plaintext highlighter-rouge\">feature</code> object</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">str</span><span class=\"p\">(</span><span class=\"n\">feature</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"n\">Factor</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"o\">/</span><span class=\"w\"> </span><span class=\"m\">3</span><span class=\"w\"> </span><span class=\"n\">levels</span><span class=\"w\"> </span><span class=\"s2\">\"lincRNA\"</span><span class=\"p\">,</span><span class=\"s2\">\"protein_coding\"</span><span class=\"p\">,</span><span class=\"n\">..</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"n\">...</span><span class=\"w\">\n</span></code></pre></div>      </div>\n    </li>\n  </ol>\n</blockquote>\n\n<p>For the sake of efficiency, R stores the content of a factor as a vector of integers, which an integer is assigned to each of the possible levels. Recall levels are assigned in alphabetical order. In this case, the first item in our “Feature” object is “protein_coding”, which happens to be the 2nd level of our factor, ordered alphabeticaly. The 9th item in the list is “lincRNA”, which is the 1st level of our factor.</p>\n\n<p>One of the most common uses for factors is to plot categorical values. For example, suppose we want to know how many of our differentially expressed genes correspond to different features.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Plot a factor object</hands-on-title>\n  <ol>\n    <li>\n      <p>Plot the number of levels in the <code class=\"language-plaintext highlighter-rouge\">feature</code> object using <code class=\"language-plaintext highlighter-rouge\">plot</code> function</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">feature</span><span class=\"p\">)</span><span class=\"w\">\n</span></code></pre></div>      </div>\n    </li>\n  </ol>\n</blockquote>\n\n<p><a href=\"../../../introduction/images/rna-seq-counts-to-viz-in-r/featurePlot.png\" rel=\"noopener noreferrer\"><img src=\"../../../introduction/images/rna-seq-counts-to-viz-in-r/featurePlot.png\" alt=\"feature plot. \" width=\"720\" height=\"478\" loading=\"lazy\" /></a></p>\n\n<p>This isn’t a particularly pretty example of a plot. We’ll be learning much more about creating nice, publication-quality graphics later.</p>\n\n<h2 id=\"subset-a-data-frame\">Subset a data frame</h2>\n\n<p>Now we would like to know how to get specific values from data frames, and where necessary, change the mode of a column of values.</p>\n\n<p>The first thing to remember is that a data frame is two-dimensional (rows and columns). Therefore, to select a specific value we will once again use <code class=\"language-plaintext highlighter-rouge\">[]</code> (bracket) notation, but we will specify more than one value (except in some cases where we are taking a range).</p>\n\n<blockquote class=\"question\">\n  <question-title>Subsetting a data frame</question-title>\n\n  <p>Run the following indices and functions to figure out what they return</p>\n\n  <ol>\n    <li><code class=\"language-plaintext highlighter-rouge\">annotatedDEgenes[1, 1]</code></li>\n    <li><code class=\"language-plaintext highlighter-rouge\">annotatedDEgenes[2, 4]</code></li>\n    <li><code class=\"language-plaintext highlighter-rouge\">annotatedDEgenes[130, 13]</code></li>\n    <li><code class=\"language-plaintext highlighter-rouge\">annotatedDEgenes[2, ]</code></li>\n    <li><code class=\"language-plaintext highlighter-rouge\">annotatedDEgenes[-1, ]</code></li>\n    <li><code class=\"language-plaintext highlighter-rouge\">annotatedDEgenes[1:4, 1]</code></li>\n    <li><code class=\"language-plaintext highlighter-rouge\">annotatedDEgenes[1:10, c(\"Feature\", \"Gene.Name\")]</code></li>\n    <li><code class=\"language-plaintext highlighter-rouge\">annotatedDEgenes[, c(\"Gene.Name\")]</code></li>\n    <li><code class=\"language-plaintext highlighter-rouge\">head(annotatedDEgenes)</code></li>\n    <li><code class=\"language-plaintext highlighter-rouge\">tail(annotatedDEgenes)</code></li>\n    <li><code class=\"language-plaintext highlighter-rouge\">annotatedDEgenes$GeneID</code></li>\n    <li><code class=\"language-plaintext highlighter-rouge\">annotatedDEgenes[annotatedDEgenes$Feature == \"pseudogene\", ]</code></li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>\n        <p><code class=\"language-plaintext highlighter-rouge\">annotatedDEgenes[1, 1]</code></p>\n\n        <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">annotatedDEgenes</span><span class=\"p\">[</span><span class=\"m\">1</span><span class=\"p\">,</span><span class=\"m\">1</span><span class=\"p\">]</span><span class=\"w\">\n </span><span class=\"p\">[</span><span class=\"m\">1</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">FBgn0039155</span><span class=\"w\">\n </span><span class=\"m\">130</span><span class=\"w\"> </span><span class=\"n\">Levels</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FBgn0000071</span><span class=\"w\"> </span><span class=\"n\">FBgn0000079</span><span class=\"w\"> </span><span class=\"n\">FBgn0000116</span><span class=\"w\"> </span><span class=\"n\">FBgn0000406</span><span class=\"w\"> </span><span class=\"n\">FBgn0000567</span><span class=\"w\"> </span><span class=\"n\">FBgn0001137</span><span class=\"w\"> </span><span class=\"n\">...</span><span class=\"w\"> </span><span class=\"n\">FBgn0267635</span><span class=\"w\">\n</span></code></pre></div>        </div>\n      </li>\n      <li>\n        <p><code class=\"language-plaintext highlighter-rouge\">annotatedDEgenes[2, 4]</code></p>\n\n        <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">annotatedDEgenes</span><span class=\"p\">[</span><span class=\"m\">2</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"m\">4</span><span class=\"p\">]</span><span class=\"w\">\n </span><span class=\"p\">[</span><span class=\"m\">1</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"m\">0.1043451</span><span class=\"w\">\n</span></code></pre></div>        </div>\n      </li>\n      <li>\n        <p><code class=\"language-plaintext highlighter-rouge\">annotatedDEgenes[130, 13]</code></p>\n\n        <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">annotatedDEgenes</span><span class=\"p\">[</span><span class=\"m\">130</span><span class=\"p\">,</span><span class=\"m\">13</span><span class=\"p\">]</span><span class=\"w\">\n </span><span class=\"p\">[</span><span class=\"m\">1</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">CG10440</span><span class=\"w\">\n </span><span class=\"m\">130</span><span class=\"w\"> </span><span class=\"n\">Levels</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Ama</span><span class=\"w\"> </span><span class=\"n\">Amy</span><span class=\"o\">-</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">Ant2</span><span class=\"w\"> </span><span class=\"n\">Argk</span><span class=\"w\"> </span><span class=\"n\">BM</span><span class=\"m\">-40</span><span class=\"o\">-</span><span class=\"n\">SPARC</span><span class=\"w\"> </span><span class=\"n\">bou</span><span class=\"w\"> </span><span class=\"n\">bves</span><span class=\"w\"> </span><span class=\"n\">CAHbeta</span><span class=\"w\"> </span><span class=\"n\">cbt</span><span class=\"w\"> </span><span class=\"n\">CG10063</span><span class=\"w\"> </span><span class=\"n\">CG10365</span><span class=\"w\"> </span><span class=\"n\">CG10440</span><span class=\"w\"> </span><span class=\"n\">...</span><span class=\"w\"> </span><span class=\"n\">zye</span><span class=\"w\">\n</span></code></pre></div>        </div>\n      </li>\n      <li>\n        <p><code class=\"language-plaintext highlighter-rouge\">annotatedDEgenes[2, ]</code></p>\n\n        <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">annotatedDEgenes</span><span class=\"p\">[</span><span class=\"m\">2</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"p\">]</span><span class=\"w\">\n        </span><span class=\"n\">GeneID</span><span class=\"w\"> </span><span class=\"n\">Base.mean</span><span class=\"w\">   </span><span class=\"n\">log2.FC.</span><span class=\"w\">   </span><span class=\"n\">StdErr</span><span class=\"w\"> </span><span class=\"n\">Wald.Stats</span><span class=\"w\">       </span><span class=\"n\">P.value</span><span class=\"w\">         </span><span class=\"n\">P.adj</span><span class=\"w\"> </span><span class=\"n\">Seqname</span><span class=\"w\">    </span><span class=\"n\">Start</span><span class=\"w\">\n </span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"n\">FBgn0003360</span><span class=\"w\">  </span><span class=\"m\">6409.577</span><span class=\"w\"> </span><span class=\"m\">-2.999777</span><span class=\"w\"> </span><span class=\"m\">0.1043451</span><span class=\"w\">  </span><span class=\"m\">-28.74863</span><span class=\"w\"> </span><span class=\"m\">9.422382e-182</span><span class=\"w\"> </span><span class=\"m\">4.040788e-178</span><span class=\"w\">    </span><span class=\"n\">chrX</span><span class=\"w\"> </span><span class=\"m\">10780892</span><span class=\"w\">\n        </span><span class=\"n\">End</span><span class=\"w\"> </span><span class=\"n\">Strand</span><span class=\"w\">        </span><span class=\"n\">Feature</span><span class=\"w\"> </span><span class=\"n\">Gene.Name</span><span class=\"w\">\n </span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"m\">10786958</span><span class=\"w\">      </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">protein_coding</span><span class=\"w\">      </span><span class=\"n\">sesB</span><span class=\"w\">\n</span></code></pre></div>        </div>\n      </li>\n      <li>\n        <p><code class=\"language-plaintext highlighter-rouge\">annotatedDEgenes[-1, ]</code></p>\n\n        <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">annotatedDEgenes</span><span class=\"p\">[</span><span class=\"m\">-1</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"p\">]</span><span class=\"w\">\n         </span><span class=\"n\">GeneID</span><span class=\"w\">   </span><span class=\"n\">Base.mean</span><span class=\"w\">  </span><span class=\"n\">log2.FC.</span><span class=\"w\">     </span><span class=\"n\">StdErr</span><span class=\"w\"> </span><span class=\"n\">Wald.Stats</span><span class=\"w\">       </span><span class=\"n\">P.value</span><span class=\"w\">         </span><span class=\"n\">P.adj</span><span class=\"w\"> </span><span class=\"n\">Seqname</span><span class=\"w\">\n </span><span class=\"m\">2</span><span class=\"w\">  </span><span class=\"n\">FBgn0003360</span><span class=\"w\">  </span><span class=\"m\">6409.57713</span><span class=\"w\"> </span><span class=\"m\">-2.999777</span><span class=\"w\"> </span><span class=\"m\">0.10434506</span><span class=\"w\"> </span><span class=\"m\">-28.748628</span><span class=\"w\"> </span><span class=\"m\">9.422382e-182</span><span class=\"w\"> </span><span class=\"m\">4.040788e-178</span><span class=\"w\">    </span><span class=\"n\">chrX</span><span class=\"w\">\n </span><span class=\"m\">3</span><span class=\"w\">  </span><span class=\"n\">FBgn0026562</span><span class=\"w\"> </span><span class=\"m\">65114.84056</span><span class=\"w\"> </span><span class=\"m\">-2.380164</span><span class=\"w\"> </span><span class=\"m\">0.08432692</span><span class=\"w\"> </span><span class=\"m\">-28.225437</span><span class=\"w\"> </span><span class=\"m\">2.850473e-175</span><span class=\"w\"> </span><span class=\"m\">8.149503e-172</span><span class=\"w\">   </span><span class=\"n\">chr3R</span><span class=\"w\">\n </span><span class=\"m\">4</span><span class=\"w\">  </span><span class=\"n\">FBgn0025111</span><span class=\"w\">  </span><span class=\"m\">2192.32237</span><span class=\"w\">  </span><span class=\"m\">2.699939</span><span class=\"w\"> </span><span class=\"m\">0.09794457</span><span class=\"w\">  </span><span class=\"m\">27.565988</span><span class=\"w\"> </span><span class=\"m\">2.846764e-167</span><span class=\"w\"> </span><span class=\"m\">6.104174e-164</span><span class=\"w\">    </span><span class=\"n\">chrX</span><span class=\"w\">\n </span><span class=\"m\">5</span><span class=\"w\">  </span><span class=\"n\">FBgn0029167</span><span class=\"w\">  </span><span class=\"m\">5430.06728</span><span class=\"w\"> </span><span class=\"m\">-2.105062</span><span class=\"w\"> </span><span class=\"m\">0.09254660</span><span class=\"w\"> </span><span class=\"m\">-22.745964</span><span class=\"w\"> </span><span class=\"m\">1.573283e-114</span><span class=\"w\"> </span><span class=\"m\">2.698810e-111</span><span class=\"w\">   </span><span class=\"n\">chr3L</span><span class=\"w\">\n </span><span class=\"m\">6</span><span class=\"w\">  </span><span class=\"n\">FBgn0039827</span><span class=\"w\">   </span><span class=\"m\">390.90178</span><span class=\"w\"> </span><span class=\"m\">-3.503014</span><span class=\"w\"> </span><span class=\"m\">0.16002962</span><span class=\"w\"> </span><span class=\"m\">-21.889786</span><span class=\"w\"> </span><span class=\"m\">3.250384e-106</span><span class=\"w\"> </span><span class=\"m\">4.646424e-103</span><span class=\"w\">   </span><span class=\"n\">chr3R</span><span class=\"w\">\n </span><span class=\"m\">7</span><span class=\"w\">  </span><span class=\"n\">FBgn0035085</span><span class=\"w\">   </span><span class=\"m\">928.26381</span><span class=\"w\"> </span><span class=\"m\">-2.414074</span><span class=\"w\"> </span><span class=\"m\">0.11518516</span><span class=\"w\"> </span><span class=\"m\">-20.958204</span><span class=\"w\">  </span><span class=\"m\">1.579343e-97</span><span class=\"w\">  </span><span class=\"m\">1.935147e-94</span><span class=\"w\">   </span><span class=\"n\">chr2R</span><span class=\"w\">\n </span><span class=\"m\">8</span><span class=\"w\">  </span><span class=\"n\">FBgn0034736</span><span class=\"w\">   </span><span class=\"m\">330.38302</span><span class=\"w\"> </span><span class=\"m\">-3.018179</span><span class=\"w\"> </span><span class=\"m\">0.15815418</span><span class=\"w\"> </span><span class=\"m\">-19.083774</span><span class=\"w\">  </span><span class=\"m\">3.444661e-81</span><span class=\"w\">  </span><span class=\"m\">3.693107e-78</span><span class=\"w\">   </span><span class=\"n\">chr2R</span><span class=\"w\">\n </span><span class=\"m\">9</span><span class=\"w\">  </span><span class=\"n\">FBgn0264475</span><span class=\"w\">   </span><span class=\"m\">955.45445</span><span class=\"w\"> </span><span class=\"m\">-2.334486</span><span class=\"w\"> </span><span class=\"m\">0.12423003</span><span class=\"w\"> </span><span class=\"m\">-18.791643</span><span class=\"w\">  </span><span class=\"m\">8.840041e-79</span><span class=\"w\">  </span><span class=\"m\">8.424559e-76</span><span class=\"w\">   </span><span class=\"n\">chr3L</span><span class=\"w\">\n </span><span class=\"m\">10</span><span class=\"w\"> </span><span class=\"n\">FBgn0000071</span><span class=\"w\">   </span><span class=\"m\">468.05793</span><span class=\"w\">  </span><span class=\"m\">2.360017</span><span class=\"w\"> </span><span class=\"m\">0.13564397</span><span class=\"w\">  </span><span class=\"m\">17.398615</span><span class=\"w\">  </span><span class=\"m\">8.452137e-68</span><span class=\"w\">  </span><span class=\"m\">7.249398e-65</span><span class=\"w\">   </span><span class=\"n\">chr3R</span><span class=\"w\">\n </span><span class=\"c1\"># ... with 120 more rows</span><span class=\"w\">\n\n       </span><span class=\"n\">Start</span><span class=\"w\">      </span><span class=\"n\">End</span><span class=\"w\"> </span><span class=\"n\">Strand</span><span class=\"w\">        </span><span class=\"n\">Feature</span><span class=\"w\">   </span><span class=\"n\">Gene.Name</span><span class=\"w\">\n </span><span class=\"m\">2</span><span class=\"w\">  </span><span class=\"m\">10780892</span><span class=\"w\"> </span><span class=\"m\">10786958</span><span class=\"w\">      </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">protein_coding</span><span class=\"w\">        </span><span class=\"n\">sesB</span><span class=\"w\">\n </span><span class=\"m\">3</span><span class=\"w\">  </span><span class=\"m\">26869237</span><span class=\"w\"> </span><span class=\"m\">26871995</span><span class=\"w\">      </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">protein_coding</span><span class=\"w\"> </span><span class=\"n\">BM</span><span class=\"m\">-40</span><span class=\"o\">-</span><span class=\"n\">SPARC</span><span class=\"w\">\n </span><span class=\"m\">4</span><span class=\"w\">  </span><span class=\"m\">10778953</span><span class=\"w\"> </span><span class=\"m\">10786907</span><span class=\"w\">      </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">protein_coding</span><span class=\"w\">        </span><span class=\"n\">Ant2</span><span class=\"w\">\n </span><span class=\"m\">5</span><span class=\"w\">  </span><span class=\"m\">13846053</span><span class=\"w\"> </span><span class=\"m\">13860001</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">protein_coding</span><span class=\"w\">         </span><span class=\"n\">Hml</span><span class=\"w\">\n </span><span class=\"m\">6</span><span class=\"w\">  </span><span class=\"m\">31196915</span><span class=\"w\"> </span><span class=\"m\">31203722</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">protein_coding</span><span class=\"w\">      </span><span class=\"n\">CG1544</span><span class=\"w\">\n </span><span class=\"m\">7</span><span class=\"w\">  </span><span class=\"m\">24945138</span><span class=\"w\"> </span><span class=\"m\">24946636</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">protein_coding</span><span class=\"w\">      </span><span class=\"n\">CG3770</span><span class=\"w\">\n </span><span class=\"m\">8</span><span class=\"w\">  </span><span class=\"m\">22550093</span><span class=\"w\"> </span><span class=\"m\">22552113</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">protein_coding</span><span class=\"w\">      </span><span class=\"n\">CG6018</span><span class=\"w\">\n </span><span class=\"m\">9</span><span class=\"w\">    </span><span class=\"m\">820758</span><span class=\"w\">   </span><span class=\"m\">821512</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\">        </span><span class=\"n\">lincRNA</span><span class=\"w\">     </span><span class=\"n\">CR43883</span><span class=\"w\">\n </span><span class=\"m\">10</span><span class=\"w\">  </span><span class=\"m\">6762592</span><span class=\"w\">  </span><span class=\"m\">6765261</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">protein_coding</span><span class=\"w\">         </span><span class=\"n\">Ama</span><span class=\"w\">\n </span><span class=\"c1\"># ... with 120 more rows</span><span class=\"w\">\n</span></code></pre></div>        </div>\n      </li>\n      <li>\n        <p><code class=\"language-plaintext highlighter-rouge\">annotatedDEgenes[1:4,1]</code></p>\n\n        <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">annotatedDEgenes</span><span class=\"p\">[</span><span class=\"m\">1</span><span class=\"o\">:</span><span class=\"m\">4</span><span class=\"p\">,</span><span class=\"m\">1</span><span class=\"p\">]</span><span class=\"w\">\n </span><span class=\"p\">[</span><span class=\"m\">1</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">FBgn0039155</span><span class=\"w\"> </span><span class=\"n\">FBgn0003360</span><span class=\"w\"> </span><span class=\"n\">FBgn0026562</span><span class=\"w\"> </span><span class=\"n\">FBgn0025111</span><span class=\"w\">\n </span><span class=\"m\">130</span><span class=\"w\"> </span><span class=\"n\">Levels</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FBgn0000071</span><span class=\"w\"> </span><span class=\"n\">FBgn0000079</span><span class=\"w\"> </span><span class=\"n\">FBgn0000116</span><span class=\"w\"> </span><span class=\"n\">FBgn0000406</span><span class=\"w\"> </span><span class=\"n\">FBgn0000567</span><span class=\"w\"> </span><span class=\"n\">FBgn0001137</span><span class=\"w\"> </span><span class=\"n\">...</span><span class=\"w\"> </span><span class=\"n\">FBgn0267635</span><span class=\"w\">\n</span></code></pre></div>        </div>\n      </li>\n      <li>\n        <p>annotatedDEgenes[1:10,c(“Feature”,”Gene.Name”)]</p>\n\n        <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">annotatedDEgenes</span><span class=\"p\">[</span><span class=\"m\">1</span><span class=\"o\">:</span><span class=\"m\">10</span><span class=\"p\">,</span><span class=\"nf\">c</span><span class=\"p\">(</span><span class=\"s2\">\"Feature\"</span><span class=\"p\">,</span><span class=\"s2\">\"Gene.Name\"</span><span class=\"p\">)]</span><span class=\"w\">\n           </span><span class=\"n\">Feature</span><span class=\"w\">   </span><span class=\"n\">Gene.Name</span><span class=\"w\">\n </span><span class=\"m\">1</span><span class=\"w\">  </span><span class=\"n\">protein_coding</span><span class=\"w\">        </span><span class=\"n\">Kal1</span><span class=\"w\">\n </span><span class=\"m\">2</span><span class=\"w\">  </span><span class=\"n\">protein_coding</span><span class=\"w\">        </span><span class=\"n\">sesB</span><span class=\"w\">\n </span><span class=\"m\">3</span><span class=\"w\">  </span><span class=\"n\">protein_coding</span><span class=\"w\"> </span><span class=\"n\">BM</span><span class=\"m\">-40</span><span class=\"o\">-</span><span class=\"n\">SPARC</span><span class=\"w\">\n </span><span class=\"m\">4</span><span class=\"w\">  </span><span class=\"n\">protein_coding</span><span class=\"w\">        </span><span class=\"n\">Ant2</span><span class=\"w\">\n </span><span class=\"m\">5</span><span class=\"w\">  </span><span class=\"n\">protein_coding</span><span class=\"w\">         </span><span class=\"n\">Hml</span><span class=\"w\">\n </span><span class=\"m\">6</span><span class=\"w\">  </span><span class=\"n\">protein_coding</span><span class=\"w\">      </span><span class=\"n\">CG1544</span><span class=\"w\">\n </span><span class=\"m\">7</span><span class=\"w\">  </span><span class=\"n\">protein_coding</span><span class=\"w\">      </span><span class=\"n\">CG3770</span><span class=\"w\">\n </span><span class=\"m\">8</span><span class=\"w\">  </span><span class=\"n\">protein_coding</span><span class=\"w\">      </span><span class=\"n\">CG6018</span><span class=\"w\">\n </span><span class=\"m\">9</span><span class=\"w\">         </span><span class=\"n\">lincRNA</span><span class=\"w\">     </span><span class=\"n\">CR43883</span><span class=\"w\">\n </span><span class=\"m\">10</span><span class=\"w\"> </span><span class=\"n\">protein_coding</span><span class=\"w\">         </span><span class=\"n\">Ama</span><span class=\"w\">\n</span></code></pre></div>        </div>\n      </li>\n      <li>\n        <p><code class=\"language-plaintext highlighter-rouge\">annotatedDEgenes[,c(\"Gene.Name\")]</code></p>\n\n        <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">annotatedDEgenes</span><span class=\"p\">[,</span><span class=\"nf\">c</span><span class=\"p\">(</span><span class=\"s2\">\"Gene.Name\"</span><span class=\"p\">)]</span><span class=\"w\">\n </span><span class=\"p\">[</span><span class=\"m\">1</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">Kal1</span><span class=\"w\">         </span><span class=\"n\">sesB</span><span class=\"w\">         </span><span class=\"n\">BM</span><span class=\"m\">-40</span><span class=\"o\">-</span><span class=\"n\">SPARC</span><span class=\"w\">  </span><span class=\"n\">Ant2</span><span class=\"w\">         </span><span class=\"n\">Hml</span><span class=\"w\">          </span><span class=\"n\">CG1544</span><span class=\"w\">       </span><span class=\"n\">CG3770</span><span class=\"w\">\n </span><span class=\"p\">[</span><span class=\"m\">8</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">CG6018</span><span class=\"w\">       </span><span class=\"n\">CR43883</span><span class=\"w\">      </span><span class=\"n\">Ama</span><span class=\"w\">          </span><span class=\"n\">CG3168</span><span class=\"w\">       </span><span class=\"n\">CG15695</span><span class=\"w\">      </span><span class=\"n\">CG8500</span><span class=\"w\">       </span><span class=\"n\">Rgk1</span><span class=\"w\">\n </span><span class=\"p\">[</span><span class=\"m\">15</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">Sesn</span><span class=\"w\">         </span><span class=\"n\">CG9119</span><span class=\"w\">       </span><span class=\"n\">Sema</span><span class=\"m\">-2</span><span class=\"n\">a</span><span class=\"w\">      </span><span class=\"n\">l</span><span class=\"p\">(</span><span class=\"m\">1</span><span class=\"p\">)</span><span class=\"n\">G0196</span><span class=\"w\">    </span><span class=\"n\">lectin</span><span class=\"m\">-28</span><span class=\"n\">C</span><span class=\"w\">   </span><span class=\"n\">Sox100B</span><span class=\"w\">      </span><span class=\"n\">Hsp27</span><span class=\"w\">\n </span><span class=\"p\">[</span><span class=\"m\">22</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">CG34330</span><span class=\"w\">      </span><span class=\"n\">Ugt58Fa</span><span class=\"w\">      </span><span class=\"n\">Src64B</span><span class=\"w\">       </span><span class=\"n\">Tequila</span><span class=\"w\">      </span><span class=\"n\">CG32407</span><span class=\"w\">      </span><span class=\"n\">LpR2</span><span class=\"w\">         </span><span class=\"n\">CG12290</span><span class=\"w\">\n </span><span class=\"p\">[</span><span class=\"m\">29</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">ps</span><span class=\"w\">           </span><span class=\"n\">CG8157</span><span class=\"w\">       </span><span class=\"n\">nemy</span><span class=\"w\">         </span><span class=\"n\">bves</span><span class=\"w\">         </span><span class=\"n\">CG8468</span><span class=\"w\">       </span><span class=\"n\">CR43855</span><span class=\"w\">      </span><span class=\"n\">CG13315</span><span class=\"w\">\n </span><span class=\"p\">[</span><span class=\"m\">36</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">CG1124</span><span class=\"w\">       </span><span class=\"n\">Reg</span><span class=\"m\">-2</span><span class=\"w\">        </span><span class=\"n\">CG5261</span><span class=\"w\">       </span><span class=\"n\">Treh</span><span class=\"w\">         </span><span class=\"n\">Hsp23</span><span class=\"w\">        </span><span class=\"n\">Gale</span><span class=\"w\">         </span><span class=\"n\">PPO1</span><span class=\"w\">\n </span><span class=\"p\">[</span><span class=\"m\">43</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">Picot</span><span class=\"w\">        </span><span class=\"n\">RpS24</span><span class=\"w\">        </span><span class=\"n\">CG14946</span><span class=\"w\">      </span><span class=\"n\">CG10365</span><span class=\"w\">      </span><span class=\"n\">NimC4</span><span class=\"w\">        </span><span class=\"n\">CG42694</span><span class=\"w\">      </span><span class=\"n\">CG33307</span><span class=\"w\">\n </span><span class=\"p\">[</span><span class=\"m\">50</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">CG6006</span><span class=\"w\">       </span><span class=\"n\">grk</span><span class=\"w\">          </span><span class=\"n\">CG42369</span><span class=\"w\">      </span><span class=\"n\">GILT1</span><span class=\"w\">        </span><span class=\"n\">CG5001</span><span class=\"w\">       </span><span class=\"n\">Hsp26</span><span class=\"w\">        </span><span class=\"n\">MtnA</span><span class=\"w\">\n </span><span class=\"p\">[</span><span class=\"m\">57</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">CG6330</span><span class=\"w\">       </span><span class=\"n\">l</span><span class=\"p\">(</span><span class=\"m\">3</span><span class=\"p\">)</span><span class=\"n\">neo38</span><span class=\"w\">    </span><span class=\"n\">Cyt</span><span class=\"o\">-</span><span class=\"n\">b5</span><span class=\"o\">-</span><span class=\"n\">r</span><span class=\"w\">     </span><span class=\"n\">CG12116</span><span class=\"w\">      </span><span class=\"n\">PPO2</span><span class=\"w\">         </span><span class=\"n\">zye</span><span class=\"w\">          </span><span class=\"n\">tnc</span><span class=\"w\">\n </span><span class=\"p\">[</span><span class=\"m\">64</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">CG14257</span><span class=\"w\">      </span><span class=\"n\">GstE2</span><span class=\"w\">        </span><span class=\"n\">olf413</span><span class=\"w\">       </span><span class=\"n\">CG31642</span><span class=\"w\">      </span><span class=\"n\">Nxf3</span><span class=\"w\">         </span><span class=\"n\">CG8292</span><span class=\"w\">       </span><span class=\"n\">CG5397</span><span class=\"w\">\n </span><span class=\"p\">[</span><span class=\"m\">71</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">Mctp</span><span class=\"w\">         </span><span class=\"n\">CG7777</span><span class=\"w\">       </span><span class=\"n\">CG4019</span><span class=\"w\">       </span><span class=\"n\">ChLD3</span><span class=\"w\">        </span><span class=\"n\">Argk</span><span class=\"w\">         </span><span class=\"n\">bou</span><span class=\"w\">          </span><span class=\"n\">Mct1</span><span class=\"w\">\n </span><span class=\"p\">[</span><span class=\"m\">78</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">CG9416</span><span class=\"w\">       </span><span class=\"n\">CG12512</span><span class=\"w\">      </span><span class=\"n\">CG32625</span><span class=\"w\">      </span><span class=\"n\">Npc2b</span><span class=\"w\">        </span><span class=\"n\">CG30463</span><span class=\"w\">      </span><span class=\"n\">Eip74EF</span><span class=\"w\">      </span><span class=\"n\">CAHbeta</span><span class=\"w\">\n </span><span class=\"p\">[</span><span class=\"m\">85</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">CG14326</span><span class=\"w\">      </span><span class=\"n\">Cyp6w1</span><span class=\"w\">       </span><span class=\"n\">CG3457</span><span class=\"w\">       </span><span class=\"n\">wdp</span><span class=\"w\">          </span><span class=\"n\">cbt</span><span class=\"w\">          </span><span class=\"n\">CrebA</span><span class=\"w\">        </span><span class=\"n\">Cyp4d20</span><span class=\"w\">\n </span><span class=\"p\">[</span><span class=\"m\">92</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">CR45973</span><span class=\"w\">      </span><span class=\"n\">Sr</span><span class=\"o\">-</span><span class=\"n\">CIV</span><span class=\"w\">       </span><span class=\"n\">SPH93</span><span class=\"w\">        </span><span class=\"n\">Cyp9h1</span><span class=\"w\">       </span><span class=\"n\">sug</span><span class=\"w\">          </span><span class=\"n\">CG14516</span><span class=\"w\">      </span><span class=\"n\">Ggamma30A</span><span class=\"w\">\n </span><span class=\"p\">[</span><span class=\"m\">99</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">CG4297</span><span class=\"w\">       </span><span class=\"n\">CG9503</span><span class=\"w\">       </span><span class=\"n\">CG10063</span><span class=\"w\">      </span><span class=\"n\">CG8501</span><span class=\"w\">       </span><span class=\"n\">CG43336</span><span class=\"w\">      </span><span class=\"n\">stet</span><span class=\"w\">         </span><span class=\"n\">CG8852</span><span class=\"w\">\n </span><span class=\"p\">[</span><span class=\"m\">106</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">CG15080</span><span class=\"w\">      </span><span class=\"n\">Amy</span><span class=\"o\">-</span><span class=\"n\">p</span><span class=\"w\">        </span><span class=\"n\">sn</span><span class=\"w\">           </span><span class=\"n\">CG9989</span><span class=\"w\">       </span><span class=\"n\">mlt</span><span class=\"w\">          </span><span class=\"n\">CG2444</span><span class=\"w\">       </span><span class=\"n\">CG17189</span><span class=\"w\">\n </span><span class=\"p\">[</span><span class=\"m\">113</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">RhoGAP1A</span><span class=\"w\">     </span><span class=\"n\">CG13743</span><span class=\"w\">      </span><span class=\"n\">TwdlU</span><span class=\"w\">        </span><span class=\"n\">Galphaf</span><span class=\"w\">      </span><span class=\"n\">CG32335</span><span class=\"w\">      </span><span class=\"n\">E</span><span class=\"p\">(</span><span class=\"n\">spl</span><span class=\"p\">)</span><span class=\"n\">m3</span><span class=\"o\">-</span><span class=\"n\">HLH</span><span class=\"w\"> </span><span class=\"n\">CG16749</span><span class=\"w\">\n </span><span class=\"p\">[</span><span class=\"m\">120</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">CG34434</span><span class=\"w\">      </span><span class=\"n\">CG43799</span><span class=\"w\">      </span><span class=\"n\">Pde6</span><span class=\"w\">         </span><span class=\"n\">Sr</span><span class=\"o\">-</span><span class=\"n\">CIII</span><span class=\"w\">      </span><span class=\"n\">NimC2</span><span class=\"w\">        </span><span class=\"n\">CG5895</span><span class=\"w\">       </span><span class=\"n\">SP1173</span><span class=\"w\">\n </span><span class=\"p\">[</span><span class=\"m\">127</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">CG1311</span><span class=\"w\">       </span><span class=\"n\">CG14856</span><span class=\"w\">      </span><span class=\"n\">CG6356</span><span class=\"w\">       </span><span class=\"n\">CG10440</span><span class=\"w\">\n </span><span class=\"m\">130</span><span class=\"w\"> </span><span class=\"n\">Levels</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Ama</span><span class=\"w\"> </span><span class=\"n\">Amy</span><span class=\"o\">-</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">Ant2</span><span class=\"w\"> </span><span class=\"n\">Argk</span><span class=\"w\"> </span><span class=\"n\">BM</span><span class=\"m\">-40</span><span class=\"o\">-</span><span class=\"n\">SPARC</span><span class=\"w\"> </span><span class=\"n\">bou</span><span class=\"w\"> </span><span class=\"n\">bves</span><span class=\"w\"> </span><span class=\"n\">CAHbeta</span><span class=\"w\"> </span><span class=\"n\">cbt</span><span class=\"w\"> </span><span class=\"n\">CG10063</span><span class=\"w\"> </span><span class=\"n\">CG10365</span><span class=\"w\"> </span><span class=\"n\">CG10440</span><span class=\"w\"> </span><span class=\"n\">...</span><span class=\"w\"> </span><span class=\"n\">zye</span><span class=\"w\">\n</span></code></pre></div>        </div>\n      </li>\n      <li>\n        <p><code class=\"language-plaintext highlighter-rouge\">head(annotatedDEgenes)</code></p>\n\n        <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">head</span><span class=\"p\">(</span><span class=\"n\">annotatedDEgenes</span><span class=\"p\">)</span><span class=\"w\">\n        </span><span class=\"n\">GeneID</span><span class=\"w\">  </span><span class=\"n\">Base.mean</span><span class=\"w\">  </span><span class=\"n\">log2.FC.</span><span class=\"w\">      </span><span class=\"n\">StdErr</span><span class=\"w\"> </span><span class=\"n\">Wald.Stats</span><span class=\"w\">       </span><span class=\"n\">P.value</span><span class=\"w\">         </span><span class=\"n\">P.adj</span><span class=\"w\"> </span><span class=\"n\">Seqname</span><span class=\"w\">    </span><span class=\"n\">Start</span><span class=\"w\">\n </span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"n\">FBgn0039155</span><span class=\"w\">  </span><span class=\"m\">1086.9743</span><span class=\"w\"> </span><span class=\"m\">-4.148450</span><span class=\"w\"> </span><span class=\"m\">0.13494887</span><span class=\"w\">  </span><span class=\"m\">-30.74090</span><span class=\"w\"> </span><span class=\"m\">1.617921e-207</span><span class=\"w\"> </span><span class=\"m\">1.387691e-203</span><span class=\"w\">   </span><span class=\"n\">chr3R</span><span class=\"w\"> </span><span class=\"m\">24141394</span><span class=\"w\">\n </span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"n\">FBgn0003360</span><span class=\"w\">  </span><span class=\"m\">6409.5771</span><span class=\"w\"> </span><span class=\"m\">-2.999777</span><span class=\"w\"> </span><span class=\"m\">0.10434506</span><span class=\"w\">  </span><span class=\"m\">-28.74863</span><span class=\"w\"> </span><span class=\"m\">9.422382e-182</span><span class=\"w\"> </span><span class=\"m\">4.040788e-178</span><span class=\"w\">    </span><span class=\"n\">chrX</span><span class=\"w\"> </span><span class=\"m\">10780892</span><span class=\"w\">\n </span><span class=\"m\">3</span><span class=\"w\"> </span><span class=\"n\">FBgn0026562</span><span class=\"w\"> </span><span class=\"m\">65114.8406</span><span class=\"w\"> </span><span class=\"m\">-2.380164</span><span class=\"w\"> </span><span class=\"m\">0.08432692</span><span class=\"w\">  </span><span class=\"m\">-28.22544</span><span class=\"w\"> </span><span class=\"m\">2.850473e-175</span><span class=\"w\"> </span><span class=\"m\">8.149503e-172</span><span class=\"w\">   </span><span class=\"n\">chr3R</span><span class=\"w\"> </span><span class=\"m\">26869237</span><span class=\"w\">\n </span><span class=\"m\">4</span><span class=\"w\"> </span><span class=\"n\">FBgn0025111</span><span class=\"w\">  </span><span class=\"m\">2192.3224</span><span class=\"w\">  </span><span class=\"m\">2.699939</span><span class=\"w\"> </span><span class=\"m\">0.09794457</span><span class=\"w\">   </span><span class=\"m\">27.56599</span><span class=\"w\"> </span><span class=\"m\">2.846764e-167</span><span class=\"w\"> </span><span class=\"m\">6.104174e-164</span><span class=\"w\">    </span><span class=\"n\">chrX</span><span class=\"w\"> </span><span class=\"m\">10778953</span><span class=\"w\">\n </span><span class=\"m\">5</span><span class=\"w\"> </span><span class=\"n\">FBgn0029167</span><span class=\"w\">  </span><span class=\"m\">5430.0673</span><span class=\"w\"> </span><span class=\"m\">-2.105062</span><span class=\"w\"> </span><span class=\"m\">0.09254660</span><span class=\"w\">  </span><span class=\"m\">-22.74596</span><span class=\"w\"> </span><span class=\"m\">1.573283e-114</span><span class=\"w\"> </span><span class=\"m\">2.698810e-111</span><span class=\"w\">   </span><span class=\"n\">chr3L</span><span class=\"w\"> </span><span class=\"m\">13846053</span><span class=\"w\">\n </span><span class=\"m\">6</span><span class=\"w\"> </span><span class=\"n\">FBgn0039827</span><span class=\"w\">   </span><span class=\"m\">390.9018</span><span class=\"w\"> </span><span class=\"m\">-3.503014</span><span class=\"w\"> </span><span class=\"m\">0.16002962</span><span class=\"w\">  </span><span class=\"m\">-21.88979</span><span class=\"w\"> </span><span class=\"m\">3.250384e-106</span><span class=\"w\"> </span><span class=\"m\">4.646424e-103</span><span class=\"w\">   </span><span class=\"n\">chr3R</span><span class=\"w\"> </span><span class=\"m\">31196915</span><span class=\"w\">\n\n </span><span class=\"n\">End</span><span class=\"w\"> </span><span class=\"n\">Strand</span><span class=\"w\">        </span><span class=\"n\">Feature</span><span class=\"w\">   </span><span class=\"n\">Gene.Name</span><span class=\"w\">\n </span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"m\">24147490</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">protein_coding</span><span class=\"w\">        </span><span class=\"n\">Kal1</span><span class=\"w\">\n </span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"m\">10786958</span><span class=\"w\">      </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">protein_coding</span><span class=\"w\">        </span><span class=\"n\">sesB</span><span class=\"w\">\n </span><span class=\"m\">3</span><span class=\"w\"> </span><span class=\"m\">26871995</span><span class=\"w\">      </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">protein_coding</span><span class=\"w\"> </span><span class=\"n\">BM</span><span class=\"m\">-40</span><span class=\"o\">-</span><span class=\"n\">SPARC</span><span class=\"w\">\n </span><span class=\"m\">4</span><span class=\"w\"> </span><span class=\"m\">10786907</span><span class=\"w\">      </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">protein_coding</span><span class=\"w\">        </span><span class=\"n\">Ant2</span><span class=\"w\">\n </span><span class=\"m\">5</span><span class=\"w\"> </span><span class=\"m\">13860001</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">protein_coding</span><span class=\"w\">         </span><span class=\"n\">Hml</span><span class=\"w\">\n </span><span class=\"m\">6</span><span class=\"w\"> </span><span class=\"m\">31203722</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">protein_coding</span><span class=\"w\">      </span><span class=\"n\">CG1544</span><span class=\"w\">\n</span></code></pre></div>        </div>\n      </li>\n      <li>\n        <p><code class=\"language-plaintext highlighter-rouge\">tail(annotatedDEgenes)</code></p>\n\n        <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">tail</span><span class=\"p\">(</span><span class=\"n\">annotatedDEgenes</span><span class=\"p\">)</span><span class=\"w\">\n          </span><span class=\"n\">GeneID</span><span class=\"w\"> </span><span class=\"n\">Base.mean</span><span class=\"w\">  </span><span class=\"n\">log2.FC.</span><span class=\"w\">    </span><span class=\"n\">StdErr</span><span class=\"w\"> </span><span class=\"n\">Wald.Stats</span><span class=\"w\">      </span><span class=\"n\">P.value</span><span class=\"w\">        </span><span class=\"n\">P.adj</span><span class=\"w\"> </span><span class=\"n\">Seqname</span><span class=\"w\">    </span><span class=\"n\">Start</span><span class=\"w\">\n </span><span class=\"m\">125</span><span class=\"w\"> </span><span class=\"n\">FBgn0036560</span><span class=\"w\">  </span><span class=\"m\">27.71424</span><span class=\"w\">  </span><span class=\"m\">1.089000</span><span class=\"w\"> </span><span class=\"m\">0.2327527</span><span class=\"w\">   </span><span class=\"m\">4.678786</span><span class=\"w\"> </span><span class=\"m\">2.885785e-06</span><span class=\"w\"> </span><span class=\"m\">6.671531e-05</span><span class=\"w\">   </span><span class=\"n\">chr3L</span><span class=\"w\"> </span><span class=\"m\">16035484</span><span class=\"w\">\n </span><span class=\"m\">126</span><span class=\"w\"> </span><span class=\"n\">FBgn0035710</span><span class=\"w\">  </span><span class=\"m\">26.16177</span><span class=\"w\">  </span><span class=\"m\">1.048979</span><span class=\"w\"> </span><span class=\"m\">0.2329221</span><span class=\"w\">   </span><span class=\"m\">4.503559</span><span class=\"w\"> </span><span class=\"m\">6.682472e-06</span><span class=\"w\"> </span><span class=\"m\">1.436480e-04</span><span class=\"w\">   </span><span class=\"n\">chr3L</span><span class=\"w\">  </span><span class=\"m\">6689326</span><span class=\"w\">\n </span><span class=\"m\">127</span><span class=\"w\"> </span><span class=\"n\">FBgn0035523</span><span class=\"w\">  </span><span class=\"m\">70.99820</span><span class=\"w\">  </span><span class=\"m\">1.004819</span><span class=\"w\"> </span><span class=\"m\">0.2237625</span><span class=\"w\">   </span><span class=\"m\">4.490560</span><span class=\"w\"> </span><span class=\"m\">7.103600e-06</span><span class=\"w\"> </span><span class=\"m\">1.523189e-04</span><span class=\"w\">   </span><span class=\"n\">chr3L</span><span class=\"w\">  </span><span class=\"m\">4277961</span><span class=\"w\">\n </span><span class=\"m\">128</span><span class=\"w\"> </span><span class=\"n\">FBgn0038261</span><span class=\"w\">  </span><span class=\"m\">44.27058</span><span class=\"w\">  </span><span class=\"m\">1.006264</span><span class=\"w\"> </span><span class=\"m\">0.2241243</span><span class=\"w\">   </span><span class=\"m\">4.489756</span><span class=\"w\"> </span><span class=\"m\">7.130482e-06</span><span class=\"w\"> </span><span class=\"m\">1.525141e-04</span><span class=\"w\">   </span><span class=\"n\">chr3R</span><span class=\"w\"> </span><span class=\"m\">14798985</span><span class=\"w\">\n </span><span class=\"m\">129</span><span class=\"w\"> </span><span class=\"n\">FBgn0039178</span><span class=\"w\">  </span><span class=\"m\">23.55006</span><span class=\"w\">  </span><span class=\"m\">1.040917</span><span class=\"w\"> </span><span class=\"m\">0.2326264</span><span class=\"w\">   </span><span class=\"m\">4.474631</span><span class=\"w\"> </span><span class=\"m\">7.654326e-06</span><span class=\"w\"> </span><span class=\"m\">1.629061e-04</span><span class=\"w\">   </span><span class=\"n\">chr3R</span><span class=\"w\"> </span><span class=\"m\">24283954</span><span class=\"w\">\n </span><span class=\"m\">130</span><span class=\"w\"> </span><span class=\"n\">FBgn0034636</span><span class=\"w\">  </span><span class=\"m\">24.77052</span><span class=\"w\"> </span><span class=\"m\">-1.028531</span><span class=\"w\"> </span><span class=\"m\">0.2321678</span><span class=\"w\">  </span><span class=\"m\">-4.430119</span><span class=\"w\"> </span><span class=\"m\">9.418101e-06</span><span class=\"w\"> </span><span class=\"m\">1.951185e-04</span><span class=\"w\">   </span><span class=\"n\">chr2R</span><span class=\"w\"> </span><span class=\"m\">21560245</span><span class=\"w\">\n\n </span><span class=\"n\">End</span><span class=\"w\"> </span><span class=\"n\">Strand</span><span class=\"w\">        </span><span class=\"n\">Feature</span><span class=\"w\"> </span><span class=\"n\">Gene.Name</span><span class=\"w\">\n </span><span class=\"m\">125</span><span class=\"w\"> </span><span class=\"m\">16037227</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">protein_coding</span><span class=\"w\">    </span><span class=\"n\">CG5895</span><span class=\"w\">\n </span><span class=\"m\">126</span><span class=\"w\">  </span><span class=\"m\">6703521</span><span class=\"w\">      </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">protein_coding</span><span class=\"w\">    </span><span class=\"n\">SP1173</span><span class=\"w\">\n </span><span class=\"m\">127</span><span class=\"w\">  </span><span class=\"m\">4281585</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">protein_coding</span><span class=\"w\">    </span><span class=\"n\">CG1311</span><span class=\"w\">\n </span><span class=\"m\">128</span><span class=\"w\"> </span><span class=\"m\">14801163</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">protein_coding</span><span class=\"w\">   </span><span class=\"n\">CG14856</span><span class=\"w\">\n </span><span class=\"m\">129</span><span class=\"w\"> </span><span class=\"m\">24288617</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">protein_coding</span><span class=\"w\">    </span><span class=\"n\">CG6356</span><span class=\"w\">\n </span><span class=\"m\">130</span><span class=\"w\"> </span><span class=\"m\">21576035</span><span class=\"w\">      </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">protein_coding</span><span class=\"w\">   </span><span class=\"n\">CG10440</span><span class=\"w\">\n</span></code></pre></div>        </div>\n      </li>\n      <li>\n        <p><code class=\"language-plaintext highlighter-rouge\">annotatedDEgenes$GeneID</code></p>\n\n        <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">annotatedDEgenes</span><span class=\"o\">$</span><span class=\"n\">GeneID</span><span class=\"w\">\n </span><span class=\"p\">[</span><span class=\"m\">1</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">FBgn0039155</span><span class=\"w\"> </span><span class=\"n\">FBgn0003360</span><span class=\"w\"> </span><span class=\"n\">FBgn0026562</span><span class=\"w\"> </span><span class=\"n\">FBgn0025111</span><span class=\"w\"> </span><span class=\"n\">FBgn0029167</span><span class=\"w\"> </span><span class=\"n\">FBgn0039827</span><span class=\"w\"> </span><span class=\"n\">FBgn0035085</span><span class=\"w\"> </span><span class=\"n\">FBgn0034736</span><span class=\"w\">\n </span><span class=\"p\">[</span><span class=\"m\">9</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">FBgn0264475</span><span class=\"w\"> </span><span class=\"n\">FBgn0000071</span><span class=\"w\"> </span><span class=\"n\">FBgn0029896</span><span class=\"w\"> </span><span class=\"n\">FBgn0038832</span><span class=\"w\"> </span><span class=\"n\">FBgn0037754</span><span class=\"w\"> </span><span class=\"n\">FBgn0264753</span><span class=\"w\"> </span><span class=\"n\">FBgn0034897</span><span class=\"w\"> </span><span class=\"n\">FBgn0035189</span><span class=\"w\">\n </span><span class=\"p\">[</span><span class=\"m\">17</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">FBgn0011260</span><span class=\"w\"> </span><span class=\"n\">FBgn0027279</span><span class=\"w\"> </span><span class=\"n\">FBgn0040099</span><span class=\"w\"> </span><span class=\"n\">FBgn0024288</span><span class=\"w\"> </span><span class=\"n\">FBgn0001226</span><span class=\"w\"> </span><span class=\"n\">FBgn0085359</span><span class=\"w\"> </span><span class=\"n\">FBgn0040091</span><span class=\"w\"> </span><span class=\"n\">FBgn0262733</span><span class=\"w\">\n </span><span class=\"p\">[</span><span class=\"m\">25</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">FBgn0023479</span><span class=\"w\"> </span><span class=\"n\">FBgn0052407</span><span class=\"w\"> </span><span class=\"n\">FBgn0051092</span><span class=\"w\"> </span><span class=\"n\">FBgn0039419</span><span class=\"w\"> </span><span class=\"n\">FBgn0261552</span><span class=\"w\"> </span><span class=\"n\">FBgn0034010</span><span class=\"w\"> </span><span class=\"n\">FBgn0261673</span><span class=\"w\"> </span><span class=\"n\">FBgn0031150</span><span class=\"w\">\n </span><span class=\"p\">[</span><span class=\"m\">33</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">FBgn0033913</span><span class=\"w\"> </span><span class=\"n\">FBgn0264437</span><span class=\"w\"> </span><span class=\"n\">FBgn0040827</span><span class=\"w\"> </span><span class=\"n\">FBgn0037290</span><span class=\"w\"> </span><span class=\"n\">FBgn0016715</span><span class=\"w\"> </span><span class=\"n\">FBgn0031912</span><span class=\"w\"> </span><span class=\"n\">FBgn0003748</span><span class=\"w\"> </span><span class=\"n\">FBgn0001224</span><span class=\"w\">\n </span><span class=\"p\">[</span><span class=\"m\">41</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">FBgn0035147</span><span class=\"w\"> </span><span class=\"n\">FBgn0261362</span><span class=\"w\"> </span><span class=\"n\">FBgn0024315</span><span class=\"w\"> </span><span class=\"n\">FBgn0261596</span><span class=\"w\"> </span><span class=\"n\">FBgn0032405</span><span class=\"w\"> </span><span class=\"n\">FBgn0039109</span><span class=\"w\"> </span><span class=\"n\">FBgn0260011</span><span class=\"w\"> </span><span class=\"n\">FBgn0261584</span><span class=\"w\">\n </span><span class=\"p\">[</span><span class=\"m\">49</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">FBgn0053307</span><span class=\"w\"> </span><span class=\"n\">FBgn0063649</span><span class=\"w\"> </span><span class=\"n\">FBgn0001137</span><span class=\"w\"> </span><span class=\"n\">FBgn0259715</span><span class=\"w\"> </span><span class=\"n\">FBgn0038149</span><span class=\"w\"> </span><span class=\"n\">FBgn0031322</span><span class=\"w\"> </span><span class=\"n\">FBgn0001225</span><span class=\"w\"> </span><span class=\"n\">FBgn0002868</span><span class=\"w\">\n </span><span class=\"p\">[</span><span class=\"m\">57</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">FBgn0039464</span><span class=\"w\"> </span><span class=\"n\">FBgn0265276</span><span class=\"w\"> </span><span class=\"n\">FBgn0000406</span><span class=\"w\"> </span><span class=\"n\">FBgn0030041</span><span class=\"w\"> </span><span class=\"n\">FBgn0033367</span><span class=\"w\"> </span><span class=\"n\">FBgn0036985</span><span class=\"w\"> </span><span class=\"n\">FBgn0039257</span><span class=\"w\"> </span><span class=\"n\">FBgn0039479</span><span class=\"w\">\n </span><span class=\"p\">[</span><span class=\"m\">65</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">FBgn0063498</span><span class=\"w\"> </span><span class=\"n\">FBgn0037153</span><span class=\"w\"> </span><span class=\"n\">FBgn0051642</span><span class=\"w\"> </span><span class=\"n\">FBgn0263232</span><span class=\"w\"> </span><span class=\"n\">FBgn0032004</span><span class=\"w\"> </span><span class=\"n\">FBgn0031327</span><span class=\"w\"> </span><span class=\"n\">FBgn0034389</span><span class=\"w\"> </span><span class=\"n\">FBgn0033635</span><span class=\"w\">\n </span><span class=\"p\">[</span><span class=\"m\">73</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">FBgn0034885</span><span class=\"w\"> </span><span class=\"n\">FBgn0032598</span><span class=\"w\"> </span><span class=\"n\">FBgn0000116</span><span class=\"w\"> </span><span class=\"n\">FBgn0261284</span><span class=\"w\"> </span><span class=\"n\">FBgn0023549</span><span class=\"w\"> </span><span class=\"n\">FBgn0034438</span><span class=\"w\"> </span><span class=\"n\">FBgn0031703</span><span class=\"w\"> </span><span class=\"n\">FBgn0052625</span><span class=\"w\">\n </span><span class=\"p\">[</span><span class=\"m\">81</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">FBgn0038198</span><span class=\"w\"> </span><span class=\"n\">FBgn0050463</span><span class=\"w\"> </span><span class=\"n\">FBgn0000567</span><span class=\"w\"> </span><span class=\"n\">FBgn0037646</span><span class=\"w\"> </span><span class=\"n\">FBgn0038528</span><span class=\"w\"> </span><span class=\"n\">FBgn0033065</span><span class=\"w\"> </span><span class=\"n\">FBgn0024984</span><span class=\"w\"> </span><span class=\"n\">FBgn0034718</span><span class=\"w\">\n </span><span class=\"p\">[</span><span class=\"m\">89</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">FBgn0043364</span><span class=\"w\"> </span><span class=\"n\">FBgn0004396</span><span class=\"w\"> </span><span class=\"n\">FBgn0035344</span><span class=\"w\"> </span><span class=\"n\">FBgn0267635</span><span class=\"w\"> </span><span class=\"n\">FBgn0031547</span><span class=\"w\"> </span><span class=\"n\">FBgn0032638</span><span class=\"w\"> </span><span class=\"n\">FBgn0033775</span><span class=\"w\"> </span><span class=\"n\">FBgn0033782</span><span class=\"w\">\n </span><span class=\"p\">[</span><span class=\"m\">97</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">FBgn0039640</span><span class=\"w\"> </span><span class=\"n\">FBgn0267252</span><span class=\"w\"> </span><span class=\"n\">FBgn0031258</span><span class=\"w\"> </span><span class=\"n\">FBgn0030598</span><span class=\"w\"> </span><span class=\"n\">FBgn0035727</span><span class=\"w\"> </span><span class=\"n\">FBgn0033724</span><span class=\"w\"> </span><span class=\"n\">FBgn0263041</span><span class=\"w\"> </span><span class=\"n\">FBgn0020248</span><span class=\"w\">\n </span><span class=\"p\">[</span><span class=\"m\">105</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">FBgn0031548</span><span class=\"w\"> </span><span class=\"n\">FBgn0034391</span><span class=\"w\"> </span><span class=\"n\">FBgn0000079</span><span class=\"w\"> </span><span class=\"n\">FBgn0003447</span><span class=\"w\"> </span><span class=\"n\">FBgn0039593</span><span class=\"w\"> </span><span class=\"n\">FBgn0265512</span><span class=\"w\"> </span><span class=\"n\">FBgn0030326</span><span class=\"w\"> </span><span class=\"n\">FBgn0039485</span><span class=\"w\">\n </span><span class=\"p\">[</span><span class=\"m\">113</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">FBgn0025836</span><span class=\"w\"> </span><span class=\"n\">FBgn0033368</span><span class=\"w\"> </span><span class=\"n\">FBgn0037223</span><span class=\"w\"> </span><span class=\"n\">FBgn0010223</span><span class=\"w\"> </span><span class=\"n\">FBgn0063667</span><span class=\"w\"> </span><span class=\"n\">FBgn0002609</span><span class=\"w\"> </span><span class=\"n\">FBgn0037678</span><span class=\"w\"> </span><span class=\"n\">FBgn0250904</span><span class=\"w\">\n </span><span class=\"p\">[</span><span class=\"m\">121</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">FBgn0264343</span><span class=\"w\"> </span><span class=\"n\">FBgn0038237</span><span class=\"w\"> </span><span class=\"n\">FBgn0020376</span><span class=\"w\"> </span><span class=\"n\">FBgn0028939</span><span class=\"w\"> </span><span class=\"n\">FBgn0036560</span><span class=\"w\"> </span><span class=\"n\">FBgn0035710</span><span class=\"w\"> </span><span class=\"n\">FBgn0035523</span><span class=\"w\"> </span><span class=\"n\">FBgn0038261</span><span class=\"w\">\n </span><span class=\"p\">[</span><span class=\"m\">129</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">FBgn0039178</span><span class=\"w\"> </span><span class=\"n\">FBgn0034636</span><span class=\"w\">\n </span><span class=\"m\">130</span><span class=\"w\"> </span><span class=\"n\">Levels</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FBgn0000071</span><span class=\"w\"> </span><span class=\"n\">FBgn0000079</span><span class=\"w\"> </span><span class=\"n\">FBgn0000116</span><span class=\"w\"> </span><span class=\"n\">FBgn0000406</span><span class=\"w\"> </span><span class=\"n\">FBgn0000567</span><span class=\"w\"> </span><span class=\"n\">FBgn0001137</span><span class=\"w\"> </span><span class=\"n\">...</span><span class=\"w\"> </span><span class=\"n\">FBgn0267635</span><span class=\"w\">\n</span></code></pre></div>        </div>\n      </li>\n      <li>\n        <p><code class=\"language-plaintext highlighter-rouge\">annotatedDEgenes[annotatedDEgenes$Feature == \"pseudogene\",]</code></p>\n\n        <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">annotatedDEgenes</span><span class=\"p\">[</span><span class=\"n\">annotatedDEgenes</span><span class=\"o\">$</span><span class=\"n\">Feature</span><span class=\"w\"> </span><span class=\"o\">==</span><span class=\"w\"> </span><span class=\"s2\">\"pseudogene\"</span><span class=\"p\">,]</span><span class=\"w\">\n</span><span class=\"n\">GeneID</span><span class=\"w\"> </span><span class=\"n\">Base.mean</span><span class=\"w\">   </span><span class=\"n\">log2.FC.</span><span class=\"w\">    </span><span class=\"n\">StdErr</span><span class=\"w\"> </span><span class=\"n\">Wald.Stats</span><span class=\"w\">      </span><span class=\"n\">P.value</span><span class=\"w\">        </span><span class=\"n\">P.adj</span><span class=\"w\"> </span><span class=\"n\">Seqname</span><span class=\"w\">   </span><span class=\"n\">Start</span><span class=\"w\">\n</span><span class=\"m\">115</span><span class=\"w\"> </span><span class=\"n\">FBgn0037223</span><span class=\"w\">  </span><span class=\"m\">37.00783</span><span class=\"w\"> </span><span class=\"m\">-1.161706</span><span class=\"w\"> </span><span class=\"m\">0.2297393</span><span class=\"w\">  </span><span class=\"m\">-5.056627</span><span class=\"w\"> </span><span class=\"m\">4.267378e-07</span><span class=\"w\"> </span><span class=\"m\">1.192225e-05</span><span class=\"w\">   </span><span class=\"n\">chr3R</span><span class=\"w\"> </span><span class=\"m\">4243605</span><span class=\"w\">\n</span><span class=\"n\">End</span><span class=\"w\"> </span><span class=\"n\">Strand</span><span class=\"w\">    </span><span class=\"n\">Feature</span><span class=\"w\"> </span><span class=\"n\">Gene.Name</span><span class=\"w\">\n</span><span class=\"m\">115</span><span class=\"w\"> </span><span class=\"m\">4245511</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">pseudogene</span><span class=\"w\">     </span><span class=\"n\">TwdlU</span><span class=\"w\">\n</span></code></pre></div>        </div>\n      </li>\n    </ol>\n\n  </blockquote>\n</blockquote>\n\n<p>The subsetting notation is very similar to what we learned for vectors. The key differences include:</p>\n<ul>\n  <li>2 values, separated by commas: <code class=\"language-plaintext highlighter-rouge\">data.frame[row, column]</code></li>\n  <li>Use of a colon between the numbers (<code class=\"language-plaintext highlighter-rouge\">start:stop, inclusive</code>) for a continuous range of numbers</li>\n  <li>Passing a vector using <code class=\"language-plaintext highlighter-rouge\">c()</code> for a non continuous set of numbers, pass a vector</li>\n  <li>Index using the name of a column(s) by passing them as vectors using <code class=\"language-plaintext highlighter-rouge\">c()</code></li>\n</ul>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Create a new data frame by subsetting an existing one</hands-on-title>\n  <ol>\n    <li>\n      <p>Create a new data frame containing only observations from the “+” strand</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\"># create a new data frame containing only observations from the \"+\" strand</span><span class=\"w\">\n</span><span class=\"n\">annotatedDEgenes_plusStrand</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">annotatedDEgenes</span><span class=\"p\">[</span><span class=\"n\">annotatedDEgenes</span><span class=\"o\">$</span><span class=\"n\">Strand</span><span class=\"w\"> </span><span class=\"o\">==</span><span class=\"w\"> </span><span class=\"s2\">\"+\"</span><span class=\"p\">,]</span><span class=\"w\">\n</span></code></pre></div>      </div>\n    </li>\n    <li>\n      <p>Check the dimension of the new data frame</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\"># check the dimension of the data frame</span><span class=\"w\">\n</span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"nf\">dim</span><span class=\"p\">(</span><span class=\"n\">annotatedDEgenes_plusStrand</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"p\">[</span><span class=\"m\">1</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"m\">72</span><span class=\"w\"> </span><span class=\"m\">13</span><span class=\"w\">\n</span></code></pre></div>      </div>\n    </li>\n    <li>\n      <p>Get a summary of the data frame</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\"># get a summary of the data frame</span><span class=\"w\">\n</span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">summary</span><span class=\"p\">(</span><span class=\"n\">annotatedDEgenes_plusStrand</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"n\">GeneID</span><span class=\"w\">           </span><span class=\"n\">Base.mean</span><span class=\"w\">           </span><span class=\"n\">log2.FC.</span><span class=\"w\">         </span><span class=\"n\">StdErr</span><span class=\"w\">            </span><span class=\"n\">Wald.Stats</span><span class=\"w\">\n</span><span class=\"n\">FBgn0000071</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"m\">1</span><span class=\"w\">   </span><span class=\"n\">Min.</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"w\">   </span><span class=\"m\">23.55</span><span class=\"w\">   </span><span class=\"n\">Min.</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"m\">-4.1485</span><span class=\"w\">   </span><span class=\"n\">Min.</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"m\">0.08603</span><span class=\"w\">   </span><span class=\"n\">Min.</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"m\">-30.741</span><span class=\"w\">\n</span><span class=\"n\">FBgn0001224</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"m\">1</span><span class=\"w\">   </span><span class=\"m\">1</span><span class=\"n\">st</span><span class=\"w\"> </span><span class=\"n\">Qu.</span><span class=\"o\">:</span><span class=\"w\">   </span><span class=\"m\">96.04</span><span class=\"w\">   </span><span class=\"m\">1</span><span class=\"n\">st</span><span class=\"w\"> </span><span class=\"n\">Qu.</span><span class=\"o\">:</span><span class=\"m\">-1.3664</span><span class=\"w\">   </span><span class=\"m\">1</span><span class=\"n\">st</span><span class=\"w\"> </span><span class=\"n\">Qu.</span><span class=\"o\">:</span><span class=\"m\">0.12523</span><span class=\"w\">   </span><span class=\"m\">1</span><span class=\"n\">st</span><span class=\"w\"> </span><span class=\"n\">Qu.</span><span class=\"o\">:</span><span class=\"m\">-11.223</span><span class=\"w\">\n</span><span class=\"n\">FBgn0001226</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"m\">1</span><span class=\"w\">   </span><span class=\"n\">Median</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"m\">275.91</span><span class=\"w\">   </span><span class=\"n\">Median</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"m\">-1.0739</span><span class=\"w\">   </span><span class=\"n\">Median</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"m\">0.15648</span><span class=\"w\">   </span><span class=\"n\">Median</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"m\">-5.290</span><span class=\"w\">\n</span><span class=\"n\">FBgn0002609</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"m\">1</span><span class=\"w\">   </span><span class=\"n\">Mean</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"m\">1365.34</span><span class=\"w\">   </span><span class=\"n\">Mean</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"m\">-0.3133</span><span class=\"w\">   </span><span class=\"n\">Mean</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"m\">0.16087</span><span class=\"w\">   </span><span class=\"n\">Mean</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"m\">-2.729</span><span class=\"w\">\n</span><span class=\"n\">FBgn0003447</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"m\">1</span><span class=\"w\">   </span><span class=\"m\">3</span><span class=\"n\">rd</span><span class=\"w\"> </span><span class=\"n\">Qu.</span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"m\">988.33</span><span class=\"w\">   </span><span class=\"m\">3</span><span class=\"n\">rd</span><span class=\"w\"> </span><span class=\"n\">Qu.</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"m\">1.1856</span><span class=\"w\">   </span><span class=\"m\">3</span><span class=\"n\">rd</span><span class=\"w\"> </span><span class=\"n\">Qu.</span><span class=\"o\">:</span><span class=\"m\">0.19743</span><span class=\"w\">   </span><span class=\"m\">3</span><span class=\"n\">rd</span><span class=\"w\"> </span><span class=\"n\">Qu.</span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"m\">7.592</span><span class=\"w\">\n</span><span class=\"n\">FBgn0003748</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"m\">1</span><span class=\"w\">   </span><span class=\"n\">Max.</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"m\">28915.90</span><span class=\"w\">   </span><span class=\"n\">Max.</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"m\">2.3600</span><span class=\"w\">   </span><span class=\"n\">Max.</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"m\">0.23275</span><span class=\"w\">   </span><span class=\"n\">Max.</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"m\">17.399</span><span class=\"w\">\n</span><span class=\"p\">(</span><span class=\"n\">Other</span><span class=\"p\">)</span><span class=\"w\">    </span><span class=\"o\">:</span><span class=\"m\">66</span><span class=\"w\">\n\n</span><span class=\"n\">P.value</span><span class=\"w\">             </span><span class=\"n\">P.adj</span><span class=\"w\">              </span><span class=\"n\">Seqname</span><span class=\"w\">    </span><span class=\"n\">Start</span><span class=\"w\">              </span><span class=\"n\">End</span><span class=\"w\">               </span><span class=\"n\">Strand</span><span class=\"w\">\n</span><span class=\"n\">Min.</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"m\">0.000e+00</span><span class=\"w\">   </span><span class=\"n\">Min.</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"m\">0.000e+00</span><span class=\"w\">   </span><span class=\"n\">chr2L</span><span class=\"o\">:</span><span class=\"m\">12</span><span class=\"w\">   </span><span class=\"n\">Min.</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"m\">127448</span><span class=\"w\">   </span><span class=\"n\">Min.</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"m\">140340</span><span class=\"w\">   </span><span class=\"o\">-:</span><span class=\"w\"> </span><span class=\"m\">0</span><span class=\"w\">\n</span><span class=\"m\">1</span><span class=\"n\">st</span><span class=\"w\"> </span><span class=\"n\">Qu.</span><span class=\"o\">:</span><span class=\"m\">0.000e+00</span><span class=\"w\">   </span><span class=\"m\">1</span><span class=\"n\">st</span><span class=\"w\"> </span><span class=\"n\">Qu.</span><span class=\"o\">:</span><span class=\"m\">0.000e+00</span><span class=\"w\">   </span><span class=\"n\">chr2R</span><span class=\"o\">:</span><span class=\"m\">14</span><span class=\"w\">   </span><span class=\"m\">1</span><span class=\"n\">st</span><span class=\"w\"> </span><span class=\"n\">Qu.</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"m\">7377082</span><span class=\"w\">   </span><span class=\"m\">1</span><span class=\"n\">st</span><span class=\"w\"> </span><span class=\"n\">Qu.</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"m\">7379907</span><span class=\"w\">   </span><span class=\"o\">+:</span><span class=\"m\">72</span><span class=\"w\">\n</span><span class=\"n\">Median</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"m\">0.000e+00</span><span class=\"w\">   </span><span class=\"n\">Median</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"m\">0.000e+00</span><span class=\"w\">   </span><span class=\"n\">chr3L</span><span class=\"o\">:</span><span class=\"m\">15</span><span class=\"w\">   </span><span class=\"n\">Median</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"m\">14068548</span><span class=\"w\">   </span><span class=\"n\">Median</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"m\">14070644</span><span class=\"w\">\n</span><span class=\"n\">Mean</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"m\">4.556e-07</span><span class=\"w\">   </span><span class=\"n\">Mean</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"m\">1.013e-05</span><span class=\"w\">   </span><span class=\"n\">chr3R</span><span class=\"o\">:</span><span class=\"m\">24</span><span class=\"w\">   </span><span class=\"n\">Mean</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"m\">14422245</span><span class=\"w\">   </span><span class=\"n\">Mean</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"m\">14431849</span><span class=\"w\">\n</span><span class=\"m\">3</span><span class=\"n\">rd</span><span class=\"w\"> </span><span class=\"n\">Qu.</span><span class=\"o\">:</span><span class=\"m\">6.000e-12</span><span class=\"w\">   </span><span class=\"m\">3</span><span class=\"n\">rd</span><span class=\"w\"> </span><span class=\"n\">Qu.</span><span class=\"o\">:</span><span class=\"m\">3.200e-10</span><span class=\"w\">   </span><span class=\"n\">chrX</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"m\">7</span><span class=\"w\">   </span><span class=\"m\">3</span><span class=\"n\">rd</span><span class=\"w\"> </span><span class=\"n\">Qu.</span><span class=\"o\">:</span><span class=\"m\">21339535</span><span class=\"w\">   </span><span class=\"m\">3</span><span class=\"n\">rd</span><span class=\"w\"> </span><span class=\"n\">Qu.</span><span class=\"o\">:</span><span class=\"m\">21378634</span><span class=\"w\">\n</span><span class=\"n\">Max.</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"m\">7.654e-06</span><span class=\"w\">   </span><span class=\"n\">Max.</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"m\">1.629e-04</span><span class=\"w\">              </span><span class=\"n\">Max.</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"m\">31196915</span><span class=\"w\">   </span><span class=\"n\">Max.</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"m\">31203722</span><span class=\"w\">\n\n</span><span class=\"n\">Feature</span><span class=\"w\">             </span><span class=\"n\">Gene.Name</span><span class=\"w\">\n</span><span class=\"n\">lincRNA</span><span class=\"w\">       </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"m\">2</span><span class=\"w\">   </span><span class=\"n\">Ama</span><span class=\"w\">    </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"m\">1</span><span class=\"w\">\n</span><span class=\"n\">protein_coding</span><span class=\"o\">:</span><span class=\"m\">69</span><span class=\"w\">   </span><span class=\"n\">bou</span><span class=\"w\">    </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"m\">1</span><span class=\"w\">\n</span><span class=\"n\">pseudogene</span><span class=\"w\">    </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"m\">1</span><span class=\"w\">   </span><span class=\"n\">bves</span><span class=\"w\">   </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"m\">1</span><span class=\"w\">\n                    </span><span class=\"n\">CAHbeta</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"m\">1</span><span class=\"w\">\n                    </span><span class=\"n\">CG10365</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"m\">1</span><span class=\"w\">\n                    </span><span class=\"n\">CG1124</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"m\">1</span><span class=\"w\">\n                    </span><span class=\"p\">(</span><span class=\"n\">Other</span><span class=\"p\">)</span><span class=\"o\">:</span><span class=\"m\">66</span><span class=\"w\">\n</span></code></pre></div>      </div>\n    </li>\n  </ol>\n</blockquote>\n\n<h2 id=\"change-type-of-columns\">Change type of columns</h2>\n\n<p>Sometimes, it is possible that R will misinterpret the type of data represented in a data frame, or store that data in a mode which prevents you from operating on the data the way you wish. For example, a long list of gene names isn’t usually thought of as a categorical variable, the way that your experimental condition (e.g. control, treatment) might be. More importantly, some R packages you use to analyze your data may expect characters as input, not factors. At other times (such as plotting or some statistical analyses) a factor may be more appropriate. Ultimately, you should know how to change the mode of an object.</p>\n\n<p>First, its very important to recognize that coercion happens in R all the time. This can be a good thing when R gets it right, or a bad thing when the result is not what you expect.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Format gene names</hands-on-title>\n  <ol>\n    <li>\n      <p>Check the structure of the <code class=\"language-plaintext highlighter-rouge\">Gene.name</code> column</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">str</span><span class=\"p\">(</span><span class=\"n\">annotatedDEgenes</span><span class=\"o\">$</span><span class=\"n\">Gene.name</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"n\">Factor</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"o\">/</span><span class=\"w\"> </span><span class=\"m\">130</span><span class=\"w\"> </span><span class=\"n\">levels</span><span class=\"w\"> </span><span class=\"s2\">\"Ama\"</span><span class=\"p\">,</span><span class=\"s2\">\"Amy-p\"</span><span class=\"p\">,</span><span class=\"n\">..</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"m\">88</span><span class=\"w\"> </span><span class=\"m\">113</span><span class=\"w\"> </span><span class=\"m\">5</span><span class=\"w\"> </span><span class=\"m\">3</span><span class=\"w\"> </span><span class=\"m\">84</span><span class=\"w\"> </span><span class=\"m\">26</span><span class=\"w\"> </span><span class=\"m\">41</span><span class=\"w\"> </span><span class=\"m\">53</span><span class=\"w\"> </span><span class=\"m\">69</span><span class=\"w\"> </span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"n\">...</span><span class=\"w\">\n</span></code></pre></div>      </div>\n    </li>\n    <li>\n      <p>Try to coerce the column into numeric</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"nf\">as.numeric</span><span class=\"p\">(</span><span class=\"n\">annotatedDEgenes</span><span class=\"o\">$</span><span class=\"n\">Gene.name</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"p\">[</span><span class=\"m\">1</span><span class=\"p\">]</span><span class=\"w\">  </span><span class=\"m\">88</span><span class=\"w\"> </span><span class=\"m\">113</span><span class=\"w\">   </span><span class=\"m\">5</span><span class=\"w\">   </span><span class=\"m\">3</span><span class=\"w\">  </span><span class=\"m\">84</span><span class=\"w\">  </span><span class=\"m\">26</span><span class=\"w\">  </span><span class=\"m\">41</span><span class=\"w\">  </span><span class=\"m\">53</span><span class=\"w\">  </span><span class=\"m\">69</span><span class=\"w\">   </span><span class=\"m\">1</span><span class=\"w\">  </span><span class=\"m\">33</span><span class=\"w\">  </span><span class=\"m\">27</span><span class=\"w\">  </span><span class=\"m\">60</span><span class=\"w\"> </span><span class=\"m\">109</span><span class=\"w\"> </span><span class=\"m\">114</span><span class=\"w\">  </span><span class=\"m\">63</span><span class=\"w\"> </span><span class=\"m\">112</span><span class=\"w\">\n</span><span class=\"p\">[</span><span class=\"m\">18</span><span class=\"p\">]</span><span class=\"w\">  </span><span class=\"m\">89</span><span class=\"w\">  </span><span class=\"m\">91</span><span class=\"w\"> </span><span class=\"m\">116</span><span class=\"w\">  </span><span class=\"m\">87</span><span class=\"w\">  </span><span class=\"m\">38</span><span class=\"w\"> </span><span class=\"m\">128</span><span class=\"w\"> </span><span class=\"m\">121</span><span class=\"w\"> </span><span class=\"m\">124</span><span class=\"w\">  </span><span class=\"m\">35</span><span class=\"w\">  </span><span class=\"m\">92</span><span class=\"w\">  </span><span class=\"m\">15</span><span class=\"w\"> </span><span class=\"m\">107</span><span class=\"w\">  </span><span class=\"m\">57</span><span class=\"w\">  </span><span class=\"m\">97</span><span class=\"w\">   </span><span class=\"m\">7</span><span class=\"w\">  </span><span class=\"m\">59</span><span class=\"w\">  </span><span class=\"m\">68</span><span class=\"w\">\n</span><span class=\"p\">[</span><span class=\"m\">35</span><span class=\"p\">]</span><span class=\"w\">  </span><span class=\"m\">18</span><span class=\"w\">  </span><span class=\"m\">13</span><span class=\"w\"> </span><span class=\"m\">108</span><span class=\"w\">  </span><span class=\"m\">49</span><span class=\"w\"> </span><span class=\"m\">126</span><span class=\"w\">  </span><span class=\"m\">85</span><span class=\"w\">  </span><span class=\"m\">78</span><span class=\"w\"> </span><span class=\"m\">105</span><span class=\"w\"> </span><span class=\"m\">104</span><span class=\"w\"> </span><span class=\"m\">111</span><span class=\"w\">  </span><span class=\"m\">24</span><span class=\"w\">  </span><span class=\"m\">11</span><span class=\"w\">  </span><span class=\"m\">99</span><span class=\"w\">  </span><span class=\"m\">44</span><span class=\"w\">  </span><span class=\"m\">37</span><span class=\"w\">  </span><span class=\"m\">52</span><span class=\"w\">  </span><span class=\"m\">82</span><span class=\"w\">\n</span><span class=\"n\">...</span><span class=\"w\">\n</span></code></pre></div>      </div>\n\n      <p>Strangely, it works! Almost. Instead of giving an error message, R returns numeric values, which in this case are the integers assigned to the levels in this factor. This kind of behavior can lead to hard-to-find bugs, for example when we do have numbers in a factor, and we get numbers from a coercion. If we don’t look carefully, we may not notice a problem.</p>\n    </li>\n    <li>\n      <p>Coerce the column into character (which makes sense for gene names)</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">annotatedDEgenes</span><span class=\"o\">$</span><span class=\"n\">Gene.name</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nf\">as.character</span><span class=\"p\">(</span><span class=\"n\">annotatedDEgenes</span><span class=\"o\">$</span><span class=\"n\">Gene.name</span><span class=\"p\">)</span><span class=\"w\">\n</span></code></pre></div>      </div>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>R will sometimes coerce without you asking for it (implicit coercion). You can explicitly change it (explicit coercion).</p>\n\n<blockquote class=\"tip\">\n  <tip-title>Avoiding needless coercion</tip-title>\n  <p>One way to avoid needless coercion when importing a data frame using functions such as <code class=\"language-plaintext highlighter-rouge\">read.csv()</code> is to set the argument <code class=\"language-plaintext highlighter-rouge\">StringsAsFactors</code> to <code class=\"language-plaintext highlighter-rouge\">FALSE</code>. By default, this argument is <code class=\"language-plaintext highlighter-rouge\">TRUE</code>. Setting it to <code class=\"language-plaintext highlighter-rouge\">FALSE</code> will treat any non-numeric column to a character type. Going through the <code class=\"language-plaintext highlighter-rouge\">read.csv() </code>documentation, you will also see you can explicitly type your columns using the <code class=\"language-plaintext highlighter-rouge\">colClasses</code> argument. Other R packages (such as the Tidyverse <code class=\"language-plaintext highlighter-rouge\">readr</code>) don’t have this particular conversion issue, but many packages will still try to guess a data type.</p>\n</blockquote>\n\n<h2 id=\"inspect-a-numerical-column-using-math-sorting-renaming\">Inspect a numerical column using math, sorting, renaming</h2>\n\n<p>Here are a few operations that don’t need much explanation, but which are good to know. There are lots of arithmetic functions you may want to apply to your data frame. For example, you can use functions like <code class=\"language-plaintext highlighter-rouge\">mean()</code>, <code class=\"language-plaintext highlighter-rouge\">min()</code>, <code class=\"language-plaintext highlighter-rouge\">max()</code> on an individual column.</p>\n\n<p>Let’s look at the <code class=\"language-plaintext highlighter-rouge\">Base.mean</code> column, i.e. the mean of normalized counts of all samples, normalizing for sequencing depth and library composition.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Inspect the `Base.mean` column and sort</hands-on-title>\n  <ol>\n    <li>\n      <p>Get the maximum value of <code class=\"language-plaintext highlighter-rouge\">Base.mean</code> column</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nf\">max</span><span class=\"p\">(</span><span class=\"n\">annotatedDEgenes</span><span class=\"o\">$</span><span class=\"n\">Base.mean</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"p\">[</span><span class=\"m\">1</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"m\">65114.84</span><span class=\"w\">\n</span></code></pre></div>      </div>\n    </li>\n    <li>\n      <p>Sort the data frame by values in the <code class=\"language-plaintext highlighter-rouge\">Base.mean</code> column</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">sorted_by_BaseMean</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">annotatedDEgenes</span><span class=\"p\">[</span><span class=\"n\">order</span><span class=\"p\">(</span><span class=\"n\">annotatedDEgenes</span><span class=\"o\">$</span><span class=\"n\">Base.mean</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"p\">]</span><span class=\"w\">\n</span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">head</span><span class=\"p\">(</span><span class=\"n\">sorted_by_BaseMean</span><span class=\"o\">$</span><span class=\"n\">Base.mean</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"p\">[</span><span class=\"m\">1</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"m\">19.15076</span><span class=\"w\"> </span><span class=\"m\">23.55006</span><span class=\"w\"> </span><span class=\"m\">24.77052</span><span class=\"w\"> </span><span class=\"m\">26.16177</span><span class=\"w\"> </span><span class=\"m\">27.71424</span><span class=\"w\"> </span><span class=\"m\">31.58769</span><span class=\"w\">\n</span></code></pre></div>      </div>\n\n      <blockquote class=\"question\">\n        <question-title>Changing the order</question-title>\n        <p>The <code class=\"language-plaintext highlighter-rouge\">order()</code> function lists values in increasing order by default. Look at the documentation for this function and change <code class=\"language-plaintext highlighter-rouge\">sorted_by_BaseMean</code> to start with differentially expressed means with the greatest base mean.</p>\n\n        <blockquote class=\"solution\">\n          <solution-title></solution-title>\n\n          <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">sorted_by_BaseMean</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">annotatedDEgenes</span><span class=\"p\">[</span><span class=\"n\">order</span><span class=\"p\">(</span><span class=\"n\">annotatedDEgenes</span><span class=\"o\">$</span><span class=\"n\">Base.mean</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">decreasing</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">TRUE</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"p\">]</span><span class=\"w\">\n</span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">head</span><span class=\"p\">(</span><span class=\"n\">sorted_by_BaseMean</span><span class=\"o\">$</span><span class=\"n\">Base.mean</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"p\">[</span><span class=\"m\">1</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"m\">65114.841</span><span class=\"w\"> </span><span class=\"m\">28915.903</span><span class=\"w\"> </span><span class=\"m\">24584.306</span><span class=\"w\"> </span><span class=\"m\">22435.886</span><span class=\"w\">  </span><span class=\"m\">8903.630</span><span class=\"w\">  </span><span class=\"m\">8573.815</span><span class=\"w\">\n</span></code></pre></div>          </div>\n\n        </blockquote>\n      </blockquote>\n    </li>\n    <li>\n      <p>Coerce the column into character (which makes sense for gene names)</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">annotatedDEgenes</span><span class=\"o\">$</span><span class=\"n\">Gene.name</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nf\">as.character</span><span class=\"p\">(</span><span class=\"n\">annotatedDEgenes</span><span class=\"o\">$</span><span class=\"n\">Gene.name</span><span class=\"p\">)</span><span class=\"w\">\n</span></code></pre></div>      </div>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h2 id=\"save-the-data-frame-to-a-file\">Save the data frame to a file</h2>\n\n<p>We can save data frame as table in our Galaxy history to use it as input for other tools.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Save data frame in Galaxy history</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Save the <code class=\"language-plaintext highlighter-rouge\">annotatedDEgenes_plusStrand</code> object to a <code class=\"language-plaintext highlighter-rouge\">.csv</code> file using the <code class=\"language-plaintext highlighter-rouge\">write.csv()</code> function:</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">write.csv</span><span class=\"p\">(</span><span class=\"n\">annotatedDEgenes_plusStrand</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"annotatedDEgenes_plusStrand.csv\"</span><span class=\"p\">)</span><span class=\"w\">\n</span></code></pre></div>      </div>\n    </li>\n    <li>\n      <p><strong><em>TODO</em></strong>: <em>Description on how to save a file from RStudio to Galaxy</em></p>\n    </li>\n  </ol>\n</blockquote>\n\n<p>The <code class=\"language-plaintext highlighter-rouge\">write.csv()</code> function has some additional arguments listed in the help, but at a minimum you need to tell it what data frame to write to file, and give a path to a file name in quotes (if you only provide a file name, the file will be written in the current working directory).</p>\n\n<h1 id=\"aggregate-and-analyze-with-dplyr\">Aggregate and Analyze with dplyr</h1>\n\n<p>Selecting columns and rows using bracket subsetting is handy, but it can be cumbersome and difficult to read, especially for complicated operations.</p>\n\n<p>The functions we’ve been using so far, like <code class=\"language-plaintext highlighter-rouge\">str()</code>, come built into R. By using packages, we can access more functions. Here, we would like to use <a href=\"https://cran.r-project.org/package=dplyr\"><code class=\"language-plaintext highlighter-rouge\">dplyr</code></a> package provides a number of very useful functions for manipulating data frames in a way that will reduce repetition, reduce the probability of making errors, and probably even save you some typing. As an added bonus, you might even find the <code class=\"language-plaintext highlighter-rouge\">dplyr</code> grammar easier to read.</p>\n\n<blockquote class=\"comment\">\n  <comment-title>What is dplyr?</comment-title>\n\n  <p>The package <code class=\"language-plaintext highlighter-rouge\">dplyr</code> is a fairly new (2014) package that tries to provide easy tools for the most common data manipulation tasks. It is built to work directly with data frames. The thinking behind it was largely inspired by the package <code class=\"language-plaintext highlighter-rouge\">plyr</code> which has been in use for some time but suffered from being slow in some cases.<code class=\"language-plaintext highlighter-rouge\"> dplyr</code> addresses this by porting much of the computation to C++. An additional feature is the ability to work with data stored directly in an external database. The benefits of doing this are that the data can be managed natively in a relational database, queries can be conducted on that database, and only the results of the query returned.</p>\n\n  <p>This addresses a common problem with R in that all operations are conducted in memory and thus the amount of data you can work with is limited by available memory. The database connections essentially remove that limitation in that you can have a database of many 100s GB, conduct queries on it directly and pull back just what you need for analysis in R.</p>\n</blockquote>\n\n<p>To use <code class=\"language-plaintext highlighter-rouge\">dplyr</code>, we need first to install the package and then load it to be able to use it.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Install and load dyplr</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Load dyplr</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\">## load dyplr package</span><span class=\"w\">\n</span><span class=\"n\">library</span><span class=\"p\">(</span><span class=\"s2\">\"dplyr\"</span><span class=\"p\">)</span><span class=\"w\">\n</span></code></pre></div>      </div>\n\n      <blockquote class=\"tip\">\n        <tip-title>Didn't work?</tip-title>\n        <p>You might need to install dyplr first</p>\n\n        <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">install.packages</span><span class=\"p\">(</span><span class=\"s2\">\"dplyr\"</span><span class=\"p\">)</span><span class=\"w\">\n</span></code></pre></div>        </div>\n\n        <p>You might get asked to choose a CRAN mirror – this is asking you to choose a site to download the package from. The choice doesn’t matter too much.</p>\n      </blockquote>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>We only need to install a package once per computer, but we need to load it every time we open a new R session and want to use that package.</p>\n\n<h2 id=\"select-columns-and-filter-rows\">Select columns and filter rows</h2>\n\n<p>To select columns, instead with bracket, we could use the <code class=\"language-plaintext highlighter-rouge\">select</code> function of <code class=\"language-plaintext highlighter-rouge\">dplyr</code></p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Select column</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Select <code class=\"language-plaintext highlighter-rouge\">GeneID</code>, <code class=\"language-plaintext highlighter-rouge\">Start</code>, <code class=\"language-plaintext highlighter-rouge\">End</code>, <code class=\"language-plaintext highlighter-rouge\">Strand</code> columns in <code class=\"language-plaintext highlighter-rouge\">annotatedDEgenes</code></p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">select</span><span class=\"p\">(</span><span class=\"n\">annotatedDEgenes</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">GeneID</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">Start</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">End</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">Strand</span><span class=\"p\">)</span><span class=\"w\">\n         </span><span class=\"n\">GeneID</span><span class=\"w\">    </span><span class=\"n\">Start</span><span class=\"w\">      </span><span class=\"n\">End</span><span class=\"w\"> </span><span class=\"n\">Strand</span><span class=\"w\">\n</span><span class=\"m\">1</span><span class=\"w\">   </span><span class=\"n\">FBgn0039155</span><span class=\"w\"> </span><span class=\"m\">24141394</span><span class=\"w\"> </span><span class=\"m\">24147490</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\">\n</span><span class=\"m\">2</span><span class=\"w\">   </span><span class=\"n\">FBgn0003360</span><span class=\"w\"> </span><span class=\"m\">10780892</span><span class=\"w\"> </span><span class=\"m\">10786958</span><span class=\"w\">      </span><span class=\"o\">-</span><span class=\"w\">\n</span><span class=\"m\">3</span><span class=\"w\">   </span><span class=\"n\">FBgn0026562</span><span class=\"w\"> </span><span class=\"m\">26869237</span><span class=\"w\"> </span><span class=\"m\">26871995</span><span class=\"w\">      </span><span class=\"o\">-</span><span class=\"w\">\n</span><span class=\"m\">4</span><span class=\"w\">   </span><span class=\"n\">FBgn0025111</span><span class=\"w\"> </span><span class=\"m\">10778953</span><span class=\"w\"> </span><span class=\"m\">10786907</span><span class=\"w\">      </span><span class=\"o\">-</span><span class=\"w\">\n</span><span class=\"m\">5</span><span class=\"w\">   </span><span class=\"n\">FBgn0029167</span><span class=\"w\"> </span><span class=\"m\">13846053</span><span class=\"w\"> </span><span class=\"m\">13860001</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\">\n</span><span class=\"m\">6</span><span class=\"w\">   </span><span class=\"n\">FBgn0039827</span><span class=\"w\"> </span><span class=\"m\">31196915</span><span class=\"w\"> </span><span class=\"m\">31203722</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\">\n</span><span class=\"m\">7</span><span class=\"w\">   </span><span class=\"n\">FBgn0035085</span><span class=\"w\"> </span><span class=\"m\">24945138</span><span class=\"w\"> </span><span class=\"m\">24946636</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\">\n</span><span class=\"m\">8</span><span class=\"w\">   </span><span class=\"n\">FBgn0034736</span><span class=\"w\"> </span><span class=\"m\">22550093</span><span class=\"w\"> </span><span class=\"m\">22552113</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\">\n</span><span class=\"m\">9</span><span class=\"w\">   </span><span class=\"n\">FBgn0264475</span><span class=\"w\">   </span><span class=\"m\">820758</span><span class=\"w\">   </span><span class=\"m\">821512</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\">\n</span><span class=\"m\">10</span><span class=\"w\">  </span><span class=\"n\">FBgn0000071</span><span class=\"w\">  </span><span class=\"m\">6762592</span><span class=\"w\">  </span><span class=\"m\">6765261</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\">\n</span><span class=\"c1\"># ... with 120 more rows</span><span class=\"w\">\n</span></code></pre></div>      </div>\n\n      <p>The first argument to this function is the data frame (<code class=\"language-plaintext highlighter-rouge\">annotatedDEgenes</code>), and the subsequent arguments are the columns to keep.</p>\n    </li>\n    <li>\n      <p>Select all columns <em>except</em> certain ones</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">select</span><span class=\"p\">(</span><span class=\"n\">annotatedDEgenes</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">Chromosome</span><span class=\"p\">)</span><span class=\"w\">\n         </span><span class=\"n\">GeneID</span><span class=\"w\">   </span><span class=\"n\">Base.mean</span><span class=\"w\">  </span><span class=\"n\">log2.FC.</span><span class=\"w\">     </span><span class=\"n\">StdErr</span><span class=\"w\"> </span><span class=\"n\">Wald.Stats</span><span class=\"w\">       </span><span class=\"n\">P.value</span><span class=\"w\">         </span><span class=\"n\">P.adj</span><span class=\"w\">    </span><span class=\"n\">Start</span><span class=\"w\"> </span><span class=\"n\">End</span><span class=\"w\"> </span><span class=\"n\">Strand</span><span class=\"w\">    </span><span class=\"n\">Feature</span><span class=\"w\">    </span><span class=\"n\">Gene.Name</span><span class=\"w\">\n</span><span class=\"m\">1</span><span class=\"w\">   </span><span class=\"n\">FBgn0039155</span><span class=\"w\">  </span><span class=\"m\">1086.97430</span><span class=\"w\"> </span><span class=\"m\">-4.148450</span><span class=\"w\"> </span><span class=\"m\">0.13494887</span><span class=\"w\"> </span><span class=\"m\">-30.740902</span><span class=\"w\"> </span><span class=\"m\">1.617921e-207</span><span class=\"w\"> </span><span class=\"m\">1.387691e-203</span><span class=\"w\"> </span><span class=\"m\">24141394</span><span class=\"w\">  </span><span class=\"m\">24147490</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\">  </span><span class=\"n\">protein_coding</span><span class=\"w\">         </span><span class=\"n\">Kal1</span><span class=\"w\">\n</span><span class=\"m\">2</span><span class=\"w\">   </span><span class=\"n\">FBgn0003360</span><span class=\"w\">  </span><span class=\"m\">6409.57713</span><span class=\"w\"> </span><span class=\"m\">-2.999777</span><span class=\"w\"> </span><span class=\"m\">0.10434506</span><span class=\"w\"> </span><span class=\"m\">-28.748628</span><span class=\"w\"> </span><span class=\"m\">9.422382e-182</span><span class=\"w\"> </span><span class=\"m\">4.040788e-178</span><span class=\"w\"> </span><span class=\"m\">10780892</span><span class=\"w\">  </span><span class=\"m\">10786958</span><span class=\"w\">      </span><span class=\"o\">-</span><span class=\"w\">  </span><span class=\"n\">protein_coding</span><span class=\"w\">         </span><span class=\"n\">sesB</span><span class=\"w\">\n</span><span class=\"m\">3</span><span class=\"w\">   </span><span class=\"n\">FBgn0026562</span><span class=\"w\"> </span><span class=\"m\">65114.84056</span><span class=\"w\"> </span><span class=\"m\">-2.380164</span><span class=\"w\"> </span><span class=\"m\">0.08432692</span><span class=\"w\"> </span><span class=\"m\">-28.225437</span><span class=\"w\"> </span><span class=\"m\">2.850473e-175</span><span class=\"w\"> </span><span class=\"m\">8.149503e-172</span><span class=\"w\"> </span><span class=\"m\">26869237</span><span class=\"w\">  </span><span class=\"m\">26871995</span><span class=\"w\">      </span><span class=\"o\">-</span><span class=\"w\">  </span><span class=\"n\">protein_coding</span><span class=\"w\">  </span><span class=\"n\">BM</span><span class=\"m\">-40</span><span class=\"o\">-</span><span class=\"n\">SPARC</span><span class=\"w\">\n</span><span class=\"m\">4</span><span class=\"w\">   </span><span class=\"n\">FBgn0025111</span><span class=\"w\">  </span><span class=\"m\">2192.32237</span><span class=\"w\">  </span><span class=\"m\">2.699939</span><span class=\"w\"> </span><span class=\"m\">0.09794457</span><span class=\"w\">  </span><span class=\"m\">27.565988</span><span class=\"w\"> </span><span class=\"m\">2.846764e-167</span><span class=\"w\"> </span><span class=\"m\">6.104174e-164</span><span class=\"w\"> </span><span class=\"m\">10778953</span><span class=\"w\">  </span><span class=\"m\">10786907</span><span class=\"w\">      </span><span class=\"o\">-</span><span class=\"w\">  </span><span class=\"n\">protein_coding</span><span class=\"w\">         </span><span class=\"n\">Ant2</span><span class=\"w\">\n</span><span class=\"m\">5</span><span class=\"w\">   </span><span class=\"n\">FBgn0029167</span><span class=\"w\">  </span><span class=\"m\">5430.06728</span><span class=\"w\"> </span><span class=\"m\">-2.105062</span><span class=\"w\"> </span><span class=\"m\">0.09254660</span><span class=\"w\"> </span><span class=\"m\">-22.745964</span><span class=\"w\"> </span><span class=\"m\">1.573283e-114</span><span class=\"w\"> </span><span class=\"m\">2.698810e-111</span><span class=\"w\"> </span><span class=\"m\">13846053</span><span class=\"w\">  </span><span class=\"m\">13860001</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\">  </span><span class=\"n\">protein_coding</span><span class=\"w\">          </span><span class=\"n\">Hml</span><span class=\"w\">\n</span><span class=\"m\">6</span><span class=\"w\">   </span><span class=\"n\">FBgn0039827</span><span class=\"w\">   </span><span class=\"m\">390.90178</span><span class=\"w\"> </span><span class=\"m\">-3.503014</span><span class=\"w\"> </span><span class=\"m\">0.16002962</span><span class=\"w\"> </span><span class=\"m\">-21.889786</span><span class=\"w\"> </span><span class=\"m\">3.250384e-106</span><span class=\"w\"> </span><span class=\"m\">4.646424e-103</span><span class=\"w\"> </span><span class=\"m\">31196915</span><span class=\"w\">  </span><span class=\"m\">31203722</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\">  </span><span class=\"n\">protein_coding</span><span class=\"w\">       </span><span class=\"n\">CG1544</span><span class=\"w\">\n</span><span class=\"m\">7</span><span class=\"w\">   </span><span class=\"n\">FBgn0035085</span><span class=\"w\">   </span><span class=\"m\">928.26381</span><span class=\"w\"> </span><span class=\"m\">-2.414074</span><span class=\"w\"> </span><span class=\"m\">0.11518516</span><span class=\"w\"> </span><span class=\"m\">-20.958204</span><span class=\"w\">  </span><span class=\"m\">1.579343e-97</span><span class=\"w\">  </span><span class=\"m\">1.935147e-94</span><span class=\"w\"> </span><span class=\"m\">24945138</span><span class=\"w\">   </span><span class=\"m\">24946636</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">protein_coding</span><span class=\"w\">       </span><span class=\"n\">CG3770</span><span class=\"w\">\n</span><span class=\"m\">8</span><span class=\"w\">   </span><span class=\"n\">FBgn0034736</span><span class=\"w\">   </span><span class=\"m\">330.38302</span><span class=\"w\"> </span><span class=\"m\">-3.018179</span><span class=\"w\"> </span><span class=\"m\">0.15815418</span><span class=\"w\"> </span><span class=\"m\">-19.083774</span><span class=\"w\">  </span><span class=\"m\">3.444661e-81</span><span class=\"w\">  </span><span class=\"m\">3.693107e-78</span><span class=\"w\"> </span><span class=\"m\">22550093</span><span class=\"w\">   </span><span class=\"m\">22552113</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">protein_coding</span><span class=\"w\">       </span><span class=\"n\">CG6018</span><span class=\"w\">\n</span><span class=\"m\">9</span><span class=\"w\">   </span><span class=\"n\">FBgn0264475</span><span class=\"w\">   </span><span class=\"m\">955.45445</span><span class=\"w\"> </span><span class=\"m\">-2.334486</span><span class=\"w\"> </span><span class=\"m\">0.12423003</span><span class=\"w\"> </span><span class=\"m\">-18.791643</span><span class=\"w\">  </span><span class=\"m\">8.840041e-79</span><span class=\"w\">  </span><span class=\"m\">8.424559e-76</span><span class=\"w\">   </span><span class=\"m\">820758</span><span class=\"w\">   </span><span class=\"m\">821512</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\">   </span><span class=\"n\">lincRNA</span><span class=\"w\">      </span><span class=\"n\">CR43883</span><span class=\"w\">\n</span><span class=\"m\">10</span><span class=\"w\">  </span><span class=\"n\">FBgn0000071</span><span class=\"w\">   </span><span class=\"m\">468.05793</span><span class=\"w\">  </span><span class=\"m\">2.360017</span><span class=\"w\"> </span><span class=\"m\">0.13564397</span><span class=\"w\">  </span><span class=\"m\">17.398615</span><span class=\"w\">  </span><span class=\"m\">8.452137e-68</span><span class=\"w\">  </span><span class=\"m\">7.249398e-65</span><span class=\"w\">  </span><span class=\"m\">6762592</span><span class=\"w\">   </span><span class=\"m\">6765261</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\">  </span><span class=\"n\">protein_coding</span><span class=\"w\">          </span><span class=\"n\">Ama</span><span class=\"w\">\n</span><span class=\"c1\"># ... with 120 more rows</span><span class=\"w\">\n</span></code></pre></div>      </div>\n    </li>\n  </ol>\n</blockquote>\n\n<p><code class=\"language-plaintext highlighter-rouge\">dplyr</code> also provides useful functions to select columns based on their names. For instance, <code class=\"language-plaintext highlighter-rouge\">starts_with()</code> allows you to select columns that starts with specific letters.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Select columns that start with the letter \"P\"</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Select columns that start with the letter “P”</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">select</span><span class=\"p\">(</span><span class=\"n\">annotatedDEgenes</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">starts_with</span><span class=\"p\">(</span><span class=\"s2\">\"P.\"</span><span class=\"p\">))</span><span class=\"w\">\n\n          </span><span class=\"n\">P.value</span><span class=\"w\">         </span><span class=\"n\">P.adj</span><span class=\"w\">\n</span><span class=\"m\">1</span><span class=\"w\">   </span><span class=\"m\">1.617921e-207</span><span class=\"w\"> </span><span class=\"m\">1.387691e-203</span><span class=\"w\">\n</span><span class=\"m\">2</span><span class=\"w\">   </span><span class=\"m\">9.422382e-182</span><span class=\"w\"> </span><span class=\"m\">4.040788e-178</span><span class=\"w\">\n</span><span class=\"m\">3</span><span class=\"w\">   </span><span class=\"m\">2.850473e-175</span><span class=\"w\"> </span><span class=\"m\">8.149503e-172</span><span class=\"w\">\n</span><span class=\"m\">4</span><span class=\"w\">   </span><span class=\"m\">2.846764e-167</span><span class=\"w\"> </span><span class=\"m\">6.104174e-164</span><span class=\"w\">\n</span><span class=\"m\">5</span><span class=\"w\">   </span><span class=\"m\">1.573283e-114</span><span class=\"w\"> </span><span class=\"m\">2.698810e-111</span><span class=\"w\">\n</span><span class=\"m\">6</span><span class=\"w\">   </span><span class=\"m\">3.250384e-106</span><span class=\"w\"> </span><span class=\"m\">4.646424e-103</span><span class=\"w\">\n</span><span class=\"m\">7</span><span class=\"w\">    </span><span class=\"m\">1.579343e-97</span><span class=\"w\">  </span><span class=\"m\">1.935147e-94</span><span class=\"w\">\n</span><span class=\"m\">8</span><span class=\"w\">    </span><span class=\"m\">3.444661e-81</span><span class=\"w\">  </span><span class=\"m\">3.693107e-78</span><span class=\"w\">\n</span><span class=\"m\">9</span><span class=\"w\">    </span><span class=\"m\">8.840041e-79</span><span class=\"w\">  </span><span class=\"m\">8.424559e-76</span><span class=\"w\">\n</span><span class=\"m\">10</span><span class=\"w\">   </span><span class=\"m\">8.452137e-68</span><span class=\"w\">  </span><span class=\"m\">7.249398e-65</span><span class=\"w\">\n</span><span class=\"c1\"># ... with 120 more rows</span><span class=\"w\">\n</span></code></pre></div>      </div>\n    </li>\n  </ol>\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title>Selecting on multiple conditions</question-title>\n\n  <p>Create a table that contains all the columns with the letter “s” in their name except for the column “Wald.Stats”, and that contains the column “End”.</p>\n\n  <p>Hint: look at the help for the function <code class=\"language-plaintext highlighter-rouge\">starts_with()</code> we’ve just covered.</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">select</span><span class=\"p\">(</span><span class=\"n\">annotatedDEgenes</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">contains</span><span class=\"p\">(</span><span class=\"s2\">\"s\"</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">Wald.Stats</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">End</span><span class=\"p\">)</span><span class=\"w\">\n</span></code></pre></div>    </div>\n  </blockquote>\n</blockquote>\n\n<p>Similarly to choose rows, we can use the <code class=\"language-plaintext highlighter-rouge\">filter()</code> function.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Filter rows</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Filter for rows on the forward strand</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">filter</span><span class=\"p\">(</span><span class=\"n\">annotatedDEgenes</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">Strand</span><span class=\"w\"> </span><span class=\"o\">==</span><span class=\"w\"> </span><span class=\"s2\">\"+\"</span><span class=\"p\">)</span><span class=\"w\">\n        </span><span class=\"n\">GeneID</span><span class=\"w\">   </span><span class=\"n\">Base.mean</span><span class=\"w\">  </span><span class=\"n\">log2.FC.</span><span class=\"w\">     </span><span class=\"n\">StdErr</span><span class=\"w\"> </span><span class=\"n\">Wald.Stats</span><span class=\"w\">       </span><span class=\"n\">P.value</span><span class=\"w\">         </span><span class=\"n\">P.adj</span><span class=\"w\"> </span><span class=\"n\">Chromosome</span><span class=\"w\"> </span><span class=\"n\">Start</span><span class=\"w\">      </span><span class=\"n\">End</span><span class=\"w\"> </span><span class=\"n\">Strand</span><span class=\"w\">        </span><span class=\"n\">Feature</span><span class=\"w\">    </span><span class=\"n\">Gene.Name</span><span class=\"w\">\n</span><span class=\"m\">1</span><span class=\"w\">  </span><span class=\"n\">FBgn0039155</span><span class=\"w\">  </span><span class=\"m\">1086.97430</span><span class=\"w\"> </span><span class=\"m\">-4.148450</span><span class=\"w\"> </span><span class=\"m\">0.13494887</span><span class=\"w\"> </span><span class=\"m\">-30.740902</span><span class=\"w\"> </span><span class=\"m\">1.617921e-207</span><span class=\"w\"> </span><span class=\"m\">1.387691e-203</span><span class=\"w\">      </span><span class=\"n\">chr3R</span><span class=\"w\"> </span><span class=\"m\">24141394</span><span class=\"w\"> </span><span class=\"m\">24147490</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">protein_coding</span><span class=\"w\">         </span><span class=\"n\">Kal1</span><span class=\"w\">\n</span><span class=\"m\">2</span><span class=\"w\">  </span><span class=\"n\">FBgn0029167</span><span class=\"w\">  </span><span class=\"m\">5430.06728</span><span class=\"w\"> </span><span class=\"m\">-2.105062</span><span class=\"w\"> </span><span class=\"m\">0.09254660</span><span class=\"w\"> </span><span class=\"m\">-22.745964</span><span class=\"w\"> </span><span class=\"m\">1.573283e-114</span><span class=\"w\"> </span><span class=\"m\">2.698810e-111</span><span class=\"w\">      </span><span class=\"n\">chr3L</span><span class=\"w\"> </span><span class=\"m\">13846053</span><span class=\"w\"> </span><span class=\"m\">13860001</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">protein_coding</span><span class=\"w\">          </span><span class=\"n\">Hml</span><span class=\"w\">\n</span><span class=\"m\">3</span><span class=\"w\">  </span><span class=\"n\">FBgn0039827</span><span class=\"w\">   </span><span class=\"m\">390.90178</span><span class=\"w\"> </span><span class=\"m\">-3.503014</span><span class=\"w\"> </span><span class=\"m\">0.16002962</span><span class=\"w\"> </span><span class=\"m\">-21.889786</span><span class=\"w\"> </span><span class=\"m\">3.250384e-106</span><span class=\"w\"> </span><span class=\"m\">4.646424e-103</span><span class=\"w\">      </span><span class=\"n\">chr3R</span><span class=\"w\"> </span><span class=\"m\">31196915</span><span class=\"w\"> </span><span class=\"m\">31203722</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">protein_coding</span><span class=\"w\">       </span><span class=\"n\">CG1544</span><span class=\"w\">\n</span><span class=\"m\">4</span><span class=\"w\">  </span><span class=\"n\">FBgn0035085</span><span class=\"w\">   </span><span class=\"m\">928.26381</span><span class=\"w\"> </span><span class=\"m\">-2.414074</span><span class=\"w\"> </span><span class=\"m\">0.11518516</span><span class=\"w\"> </span><span class=\"m\">-20.958204</span><span class=\"w\">  </span><span class=\"m\">1.579343e-97</span><span class=\"w\">  </span><span class=\"m\">1.935147e-94</span><span class=\"w\">      </span><span class=\"n\">chr2R</span><span class=\"w\"> </span><span class=\"m\">24945138</span><span class=\"w\"> </span><span class=\"m\">24946636</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">protein_coding</span><span class=\"w\">       </span><span class=\"n\">CG3770</span><span class=\"w\">\n</span><span class=\"m\">5</span><span class=\"w\">  </span><span class=\"n\">FBgn0034736</span><span class=\"w\">   </span><span class=\"m\">330.38302</span><span class=\"w\"> </span><span class=\"m\">-3.018179</span><span class=\"w\"> </span><span class=\"m\">0.15815418</span><span class=\"w\"> </span><span class=\"m\">-19.083774</span><span class=\"w\">  </span><span class=\"m\">3.444661e-81</span><span class=\"w\">  </span><span class=\"m\">3.693107e-78</span><span class=\"w\">      </span><span class=\"n\">chr2R</span><span class=\"w\"> </span><span class=\"m\">22550093</span><span class=\"w\"> </span><span class=\"m\">22552113</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">protein_coding</span><span class=\"w\">       </span><span class=\"n\">CG6018</span><span class=\"w\">\n</span><span class=\"m\">6</span><span class=\"w\">  </span><span class=\"n\">FBgn0264475</span><span class=\"w\">   </span><span class=\"m\">955.45445</span><span class=\"w\"> </span><span class=\"m\">-2.334486</span><span class=\"w\"> </span><span class=\"m\">0.12423003</span><span class=\"w\"> </span><span class=\"m\">-18.791643</span><span class=\"w\">  </span><span class=\"m\">8.840041e-79</span><span class=\"w\">  </span><span class=\"m\">8.424559e-76</span><span class=\"w\">      </span><span class=\"n\">chr3L</span><span class=\"w\"> </span><span class=\"m\">820758</span><span class=\"w\">   </span><span class=\"m\">821512</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\">        </span><span class=\"n\">lincRNA</span><span class=\"w\">      </span><span class=\"n\">CR43883</span><span class=\"w\">\n</span><span class=\"m\">7</span><span class=\"w\">  </span><span class=\"n\">FBgn0000071</span><span class=\"w\">   </span><span class=\"m\">468.05793</span><span class=\"w\">  </span><span class=\"m\">2.360017</span><span class=\"w\"> </span><span class=\"m\">0.13564397</span><span class=\"w\">  </span><span class=\"m\">17.398615</span><span class=\"w\">  </span><span class=\"m\">8.452137e-68</span><span class=\"w\">  </span><span class=\"m\">7.249398e-65</span><span class=\"w\">      </span><span class=\"n\">chr3R</span><span class=\"w\"> </span><span class=\"m\">6762592</span><span class=\"w\">  </span><span class=\"m\">6765261</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">protein_coding</span><span class=\"w\">          </span><span class=\"n\">Ama</span><span class=\"w\">\n</span><span class=\"m\">8</span><span class=\"w\">  </span><span class=\"n\">FBgn0038832</span><span class=\"w\">   </span><span class=\"m\">429.85033</span><span class=\"w\"> </span><span class=\"m\">-2.340711</span><span class=\"w\"> </span><span class=\"m\">0.15483651</span><span class=\"w\"> </span><span class=\"m\">-15.117308</span><span class=\"w\">  </span><span class=\"m\">1.245307e-51</span><span class=\"w\">  </span><span class=\"m\">8.900828e-49</span><span class=\"w\">      </span><span class=\"n\">chr3R</span><span class=\"w\"> </span><span class=\"m\">20842139</span><span class=\"w\"> </span><span class=\"m\">20844981</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">protein_coding</span><span class=\"w\">      </span><span class=\"n\">CG15695</span><span class=\"w\">\n</span><span class=\"m\">9</span><span class=\"w\">  </span><span class=\"n\">FBgn0037754</span><span class=\"w\">   </span><span class=\"m\">394.46410</span><span class=\"w\"> </span><span class=\"m\">-2.071994</span><span class=\"w\"> </span><span class=\"m\">0.14494069</span><span class=\"w\"> </span><span class=\"m\">-14.295459</span><span class=\"w\">  </span><span class=\"m\">2.335613e-46</span><span class=\"w\">  </span><span class=\"m\">1.540966e-43</span><span class=\"w\">      </span><span class=\"n\">chr3R</span><span class=\"w\"> </span><span class=\"m\">9784652</span><span class=\"w\">  </span><span class=\"m\">9789323</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">protein_coding</span><span class=\"w\">       </span><span class=\"n\">CG8500</span><span class=\"w\">\n</span><span class=\"m\">10</span><span class=\"w\"> </span><span class=\"n\">FBgn0034897</span><span class=\"w\">  </span><span class=\"m\">1340.88978</span><span class=\"w\"> </span><span class=\"m\">-1.795107</span><span class=\"w\"> </span><span class=\"m\">0.12629203</span><span class=\"w\"> </span><span class=\"m\">-14.213934</span><span class=\"w\">  </span><span class=\"m\">7.508655e-46</span><span class=\"w\">  </span><span class=\"m\">4.293449e-43</span><span class=\"w\">      </span><span class=\"n\">chr2R</span><span class=\"w\"> </span><span class=\"m\">23713899</span><span class=\"w\"> </span><span class=\"m\">23734846</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">protein_coding</span><span class=\"w\">         </span><span class=\"n\">Sesn</span><span class=\"w\">\n</span><span class=\"c1\"># ... with 120 more rows</span><span class=\"w\">\n</span></code></pre></div>      </div>\n\n      <blockquote class=\"comment\">\n        <comment-title>Equivalent in base R code</comment-title>\n        <p>Note that this is equivalent to the base R code below, but is easier to read!</p>\n\n        <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">annotatedDEgenes</span><span class=\"p\">[</span><span class=\"n\">annotatedDEgenes</span><span class=\"o\">$</span><span class=\"n\">Strand</span><span class=\"w\"> </span><span class=\"o\">==</span><span class=\"w\"> </span><span class=\"s2\">\"+\"</span><span class=\"p\">,]</span><span class=\"w\">\n</span></code></pre></div>        </div>\n      </blockquote>\n\n      <p><code class=\"language-plaintext highlighter-rouge\">filter()</code> keeps all the rows that match the conditions that are provided</p>\n    </li>\n    <li>\n      <p>Filter for rows corresponding to genes in Chromosome X or 2R</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\">## rows for genes in Chromosome X or 2R</span><span class=\"w\">\n</span><span class=\"n\">filter</span><span class=\"p\">(</span><span class=\"n\">annotatedDEgenes</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">Chromosome</span><span class=\"w\"> </span><span class=\"o\">%in%</span><span class=\"w\"> </span><span class=\"nf\">c</span><span class=\"p\">(</span><span class=\"s2\">\"chrX\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"chr2R\"</span><span class=\"p\">))</span><span class=\"w\">\n</span></code></pre></div>      </div>\n    </li>\n    <li>\n      <p>Filter for rows where the log2 fold change is greater than 2</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\">## rows where the log2 fold change is greater than 2</span><span class=\"w\">\n</span><span class=\"n\">filter</span><span class=\"p\">(</span><span class=\"n\">annotatedDEgenes</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">log2.FC.</span><span class=\"w\"> </span><span class=\"o\">&gt;=</span><span class=\"w\"> </span><span class=\"m\">2</span><span class=\"p\">)</span><span class=\"w\">\n</span></code></pre></div>      </div>\n    </li>\n  </ol>\n</blockquote>\n\n<p><code class=\"language-plaintext highlighter-rouge\">filter()</code> allows to combine multiple conditions. They need to be separated using a <code class=\"language-plaintext highlighter-rouge\">,</code> as arguments to the function, they will be combined using the <code class=\"language-plaintext highlighter-rouge\">&amp;</code> (AND) logical operator. If you need to use the <code class=\"language-plaintext highlighter-rouge\">|</code> (OR) logical operator, you can specify it explicitly:</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Filter rows for multiple conditions</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Filter for genes on chrX and with adjusted p-value &lt;= 1e-100</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\">## both are equivalent</span><span class=\"w\">\n</span><span class=\"n\">filter</span><span class=\"p\">(</span><span class=\"n\">annotatedDEgenes</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">Chromosome</span><span class=\"w\"> </span><span class=\"o\">==</span><span class=\"w\"> </span><span class=\"s2\">\"chrX\"</span><span class=\"w\"> </span><span class=\"o\">&amp;</span><span class=\"w\"> </span><span class=\"n\">P.adj</span><span class=\"w\"> </span><span class=\"o\">&lt;=</span><span class=\"w\"> </span><span class=\"m\">1e-100</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"n\">filter</span><span class=\"p\">(</span><span class=\"n\">annotatedDEgenes</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">Chromosome</span><span class=\"w\"> </span><span class=\"o\">==</span><span class=\"w\"> </span><span class=\"s2\">\"chrX\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">P.adj</span><span class=\"w\"> </span><span class=\"o\">&lt;=</span><span class=\"w\"> </span><span class=\"m\">1e-100</span><span class=\"p\">)</span><span class=\"w\">\n</span></code></pre></div>      </div>\n    </li>\n    <li>\n      <p>Filter for genes on chrX and with log2 Fold Change smaller than -2 or larger than 2</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">filter</span><span class=\"p\">(</span><span class=\"n\">annotatedDEgenes</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">Chromosome</span><span class=\"w\"> </span><span class=\"o\">==</span><span class=\"w\"> </span><span class=\"s2\">\"chrX\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">log2.FC.</span><span class=\"w\"> </span><span class=\"o\">&lt;=</span><span class=\"w\"> </span><span class=\"m\">-2</span><span class=\"w\"> </span><span class=\"o\">|</span><span class=\"w\"> </span><span class=\"n\">log2.FC.</span><span class=\"w\"> </span><span class=\"o\">&gt;=</span><span class=\"w\"> </span><span class=\"m\">2</span><span class=\"p\">))</span><span class=\"w\">\n</span></code></pre></div>      </div>\n    </li>\n  </ol>\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title>Practising with conditionals</question-title>\n\n  <p>Select all the rows for genes that:</p>\n  <ul>\n    <li>start after position \\(1e^6\\) (one million) and before position \\(2e^6\\) (included) in their chromosome</li>\n    <li>have a log2 fold change greater than 1 or an adjusted p-value less than \\(1e^{-75}\\).</li>\n  </ul>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">filter</span><span class=\"p\">(</span><span class=\"n\">annotatedDEgenes</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">Start</span><span class=\"w\"> </span><span class=\"o\">&gt;=</span><span class=\"w\"> </span><span class=\"m\">1e6</span><span class=\"w\"> </span><span class=\"o\">&amp;</span><span class=\"w\"> </span><span class=\"n\">End</span><span class=\"w\"> </span><span class=\"o\">&lt;=</span><span class=\"w\"> </span><span class=\"m\">2e6</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">log2.FC.</span><span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"o\">|</span><span class=\"w\"> </span><span class=\"n\">P.adj</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"w\"> </span><span class=\"m\">1e-75</span><span class=\"p\">)</span><span class=\"w\">\n</span></code></pre></div>    </div>\n  </blockquote>\n</blockquote>\n\n<p>But what if you wanted to select and filter?</p>\n\n<p>We can do this with <strong>pipes</strong>. Pipes, are a fairly recent addition to R. They let you take the output of one function and send it directly to the next, which is useful when you need to do many things to the same data set. It was possible to do this before pipes were added to R, but it was much messier and more difficult. Pipes in R look like <code class=\"language-plaintext highlighter-rouge\">%&gt;%</code> and are made available via the <code class=\"language-plaintext highlighter-rouge\">magrittr</code> package, which is installed as part of <code class=\"language-plaintext highlighter-rouge\">dplyr</code>.</p>\n\n<blockquote class=\"comment\">\n  <comment-title>Pipes on RStudio</comment-title>\n\n  <p>With RStudio, you can type the pipe with</p>\n  <ul>\n    <li><kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>M</kbd> if you’re using a PC</li>\n    <li><kbd>Cmd</kbd> + <kbd>Shift</kbd> + <kbd>M</kbd> if you’re using a Mac</li>\n  </ul>\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Select and filter</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Filter for genes on forward strand, select <code class=\"language-plaintext highlighter-rouge\">GeneID</code>, <code class=\"language-plaintext highlighter-rouge\">Start</code>, <code class=\"language-plaintext highlighter-rouge\">End</code>, <code class=\"language-plaintext highlighter-rouge\">Chromosome</code> and display the first results using pipes</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">annotatedDEgenes</span><span class=\"w\"> </span><span class=\"o\">%&gt;%</span><span class=\"w\">\n   </span><span class=\"n\">filter</span><span class=\"p\">(</span><span class=\"n\">Strand</span><span class=\"w\"> </span><span class=\"o\">==</span><span class=\"w\"> </span><span class=\"s2\">\"+\"</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">%&gt;%</span><span class=\"w\">\n   </span><span class=\"n\">select</span><span class=\"p\">(</span><span class=\"n\">GeneID</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">Start</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">End</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">Chromosome</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">%&gt;%</span><span class=\"w\">\n   </span><span class=\"n\">head</span><span class=\"p\">()</span><span class=\"w\">\n\n       </span><span class=\"n\">GeneID</span><span class=\"w\">    </span><span class=\"n\">Start</span><span class=\"w\">      </span><span class=\"n\">End</span><span class=\"w\"> </span><span class=\"n\">Chromosome</span><span class=\"w\">\n</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"n\">FBgn0039155</span><span class=\"w\"> </span><span class=\"m\">24141394</span><span class=\"w\"> </span><span class=\"m\">24147490</span><span class=\"w\">      </span><span class=\"n\">chr3R</span><span class=\"w\">\n</span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"n\">FBgn0029167</span><span class=\"w\"> </span><span class=\"m\">13846053</span><span class=\"w\"> </span><span class=\"m\">13860001</span><span class=\"w\">      </span><span class=\"n\">chr3L</span><span class=\"w\">\n</span><span class=\"m\">3</span><span class=\"w\"> </span><span class=\"n\">FBgn0039827</span><span class=\"w\"> </span><span class=\"m\">31196915</span><span class=\"w\"> </span><span class=\"m\">31203722</span><span class=\"w\">      </span><span class=\"n\">chr3R</span><span class=\"w\">\n</span><span class=\"m\">4</span><span class=\"w\"> </span><span class=\"n\">FBgn0035085</span><span class=\"w\"> </span><span class=\"m\">24945138</span><span class=\"w\"> </span><span class=\"m\">24946636</span><span class=\"w\">      </span><span class=\"n\">chr2R</span><span class=\"w\">\n</span><span class=\"m\">5</span><span class=\"w\"> </span><span class=\"n\">FBgn0034736</span><span class=\"w\"> </span><span class=\"m\">22550093</span><span class=\"w\"> </span><span class=\"m\">22552113</span><span class=\"w\">      </span><span class=\"n\">chr2R</span><span class=\"w\">\n</span><span class=\"m\">6</span><span class=\"w\"> </span><span class=\"n\">FBgn0264475</span><span class=\"w\">   </span><span class=\"m\">820758</span><span class=\"w\">   </span><span class=\"m\">821512</span><span class=\"w\">      </span><span class=\"n\">chr3L</span><span class=\"w\">\n</span></code></pre></div>      </div>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>In the above code, we use the pipe to</p>\n<ol>\n  <li>Send the <code class=\"language-plaintext highlighter-rouge\">annotatedDEgenes</code> dataset through <code class=\"language-plaintext highlighter-rouge\">filter()</code></li>\n  <li>Keep rows for genes on the ‘+’ strand of their chromosome</li>\n  <li>Select through <code class=\"language-plaintext highlighter-rouge\">select()</code> to keep only the <code class=\"language-plaintext highlighter-rouge\">GeneID</code>, <code class=\"language-plaintext highlighter-rouge\">Start</code>, <code class=\"language-plaintext highlighter-rouge\">End</code>, and <code class=\"language-plaintext highlighter-rouge\">Chromosome</code> columns</li>\n  <li>Show only the first 6 rows with <code class=\"language-plaintext highlighter-rouge\">head</code></li>\n</ol>\n\n<blockquote class=\"comment\">\n  <comment-title>No need to give 1st argument to the functions</comment-title>\n\n  <p>Since <code class=\"language-plaintext highlighter-rouge\">%&gt;%</code> takes the object on its left and passes it as the first argument to the function on its right, we don’t need to explicitly include the data frame as an argument to the <code class=\"language-plaintext highlighter-rouge\">filter()</code> and <code class=\"language-plaintext highlighter-rouge\">select()</code> functions any more.</p>\n\n</blockquote>\n\n<p>Some may find it helpful to read the pipe like the word “then”. For instance, in the above example, we took the data frame <code class=\"language-plaintext highlighter-rouge\">annotatedDEgenes</code>, <em>then</em> we <code class=\"language-plaintext highlighter-rouge\">filter</code>ed for rows where <code class=\"language-plaintext highlighter-rouge\">Strand</code> was +, <em>then</em> we <code class=\"language-plaintext highlighter-rouge\">select</code>ed the <code class=\"language-plaintext highlighter-rouge\">GeneID</code>, <code class=\"language-plaintext highlighter-rouge\">Start</code>, <code class=\"language-plaintext highlighter-rouge\">End</code>, and <code class=\"language-plaintext highlighter-rouge\">Chromosome</code> columns, <em>then</em> we showed only the first six rows.</p>\n\n<p>The <code class=\"language-plaintext highlighter-rouge\">dplyr</code> functions by themselves are somewhat simple, but by combining them into linear workflows with the pipe, we can accomplish complex manipulations of data frames.</p>\n\n<p>If we want to create a new object with this smaller version of the data we can do so by assigning it to a new object.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Select and filter to create new object</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Create an <code class=\"language-plaintext highlighter-rouge\">plus_strand_genes</code> from <code class=\"language-plaintext highlighter-rouge\">annotatedDEgenes</code> after filter for genes on forward strand and selection of <code class=\"language-plaintext highlighter-rouge\">GeneID</code>, <code class=\"language-plaintext highlighter-rouge\">Start</code>, <code class=\"language-plaintext highlighter-rouge\">End</code>, <code class=\"language-plaintext highlighter-rouge\">Chromosome</code></p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">plus_strand_genes</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">annotatedDEgenes</span><span class=\"w\"> </span><span class=\"o\">%&gt;%</span><span class=\"w\">\n </span><span class=\"n\">filter</span><span class=\"p\">(</span><span class=\"n\">Strand</span><span class=\"w\"> </span><span class=\"o\">==</span><span class=\"w\"> </span><span class=\"s2\">\"+\"</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">%&gt;%</span><span class=\"w\">\n </span><span class=\"n\">select</span><span class=\"p\">(</span><span class=\"n\">GeneID</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">Start</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">End</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">Chromosome</span><span class=\"p\">)</span><span class=\"w\">\n</span></code></pre></div>      </div>\n    </li>\n    <li>\n      <p>Check the first 6 rows</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">head</span><span class=\"p\">(</span><span class=\"n\">plus_strand_genes</span><span class=\"p\">)</span><span class=\"w\">\n        </span><span class=\"n\">GeneID</span><span class=\"w\">    </span><span class=\"n\">Start</span><span class=\"w\">      </span><span class=\"n\">End</span><span class=\"w\"> </span><span class=\"n\">Chromosome</span><span class=\"w\">\n </span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"n\">FBgn0039155</span><span class=\"w\"> </span><span class=\"m\">24141394</span><span class=\"w\"> </span><span class=\"m\">24147490</span><span class=\"w\">      </span><span class=\"n\">chr3R</span><span class=\"w\">\n </span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"n\">FBgn0029167</span><span class=\"w\"> </span><span class=\"m\">13846053</span><span class=\"w\"> </span><span class=\"m\">13860001</span><span class=\"w\">      </span><span class=\"n\">chr3L</span><span class=\"w\">\n </span><span class=\"m\">3</span><span class=\"w\"> </span><span class=\"n\">FBgn0039827</span><span class=\"w\"> </span><span class=\"m\">31196915</span><span class=\"w\"> </span><span class=\"m\">31203722</span><span class=\"w\">      </span><span class=\"n\">chr3R</span><span class=\"w\">\n </span><span class=\"m\">4</span><span class=\"w\"> </span><span class=\"n\">FBgn0035085</span><span class=\"w\"> </span><span class=\"m\">24945138</span><span class=\"w\"> </span><span class=\"m\">24946636</span><span class=\"w\">      </span><span class=\"n\">chr2R</span><span class=\"w\">\n </span><span class=\"m\">5</span><span class=\"w\"> </span><span class=\"n\">FBgn0034736</span><span class=\"w\"> </span><span class=\"m\">22550093</span><span class=\"w\"> </span><span class=\"m\">22552113</span><span class=\"w\">      </span><span class=\"n\">chr2R</span><span class=\"w\">\n </span><span class=\"m\">6</span><span class=\"w\"> </span><span class=\"n\">FBgn0264475</span><span class=\"w\">   </span><span class=\"m\">820758</span><span class=\"w\">   </span><span class=\"m\">821512</span><span class=\"w\">      </span><span class=\"n\">chr3L</span><span class=\"w\">\n</span></code></pre></div>      </div>\n    </li>\n  </ol>\n</blockquote>\n\n<p>This new object includes all of the data from this sample.</p>\n\n<blockquote class=\"question\">\n  <question-title>Pipes and up-regulation</question-title>\n\n  <p>Starting with the <code class=\"language-plaintext highlighter-rouge\">annotatedDEgenes</code> data frame, use pipes to</p>\n  <ul>\n    <li>subset the data to include only observations from chromosome 3L,with the log2 fold change is at least 2</li>\n    <li>retain only the columns <code class=\"language-plaintext highlighter-rouge\">GeneID</code>, <code class=\"language-plaintext highlighter-rouge\">P.adj</code>, and <code class=\"language-plaintext highlighter-rouge\">log2.FC.</code>.</li>\n  </ul>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n    <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">annotatedDEgenes</span><span class=\"w\"> </span><span class=\"o\">%&gt;%</span><span class=\"w\">\n    </span><span class=\"n\">filter</span><span class=\"p\">(</span><span class=\"n\">Chromosome</span><span class=\"w\"> </span><span class=\"o\">==</span><span class=\"w\"> </span><span class=\"s2\">\"chr3L\"</span><span class=\"w\"> </span><span class=\"o\">&amp;</span><span class=\"w\"> </span><span class=\"n\">log2.FC.</span><span class=\"w\"> </span><span class=\"o\">&gt;=</span><span class=\"w\"> </span><span class=\"m\">2</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">%&gt;%</span><span class=\"w\">\n    </span><span class=\"n\">select</span><span class=\"p\">(</span><span class=\"n\">GeneID</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">P.adj</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">log2.FC.</span><span class=\"p\">)</span><span class=\"w\">\n</span></code></pre></div>    </div>\n  </blockquote>\n</blockquote>\n\n<h2 id=\"create-columns\">Create columns</h2>\n\n<p>Frequently we want to create new columns based on the values in existing columns, e.g. to do unit conversions or find the ratio of values in two columns. For this we can use the <code class=\"language-plaintext highlighter-rouge\">dplyr</code> function <code class=\"language-plaintext highlighter-rouge\">mutate()</code>.</p>\n\n<p>In the data frame, there is a column titled <code class=\"language-plaintext highlighter-rouge\">log2.FC.</code>. This is the logarithmically-adjusted representation of the fold-change observed in expression of the genes in the transcriptomic experiment from which this data is derived. We can calculate the observed expression level relative to the reference according to the formula: \\(FC = 2^{log2.FC.}\\)</p>\n\n<p>Let’s create a column <code class=\"language-plaintext highlighter-rouge\">FC</code> to our <code class=\"language-plaintext highlighter-rouge\">annotatedDEgenes</code> data frame that show the observed expression as a multiple of the reference level.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Select and filter to create new object</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Create a a column <code class=\"language-plaintext highlighter-rouge\">FC</code> that show the observed expression as a multiple of the reference level</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">annotatedDEgenes</span><span class=\"w\"> </span><span class=\"o\">%&gt;%</span><span class=\"w\">\n    </span><span class=\"n\">mutate</span><span class=\"p\">(</span><span class=\"n\">FC</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"o\">**</span><span class=\"w\"> </span><span class=\"n\">log2.FC.</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">%&gt;%</span><span class=\"w\">\n    </span><span class=\"n\">head</span><span class=\"p\">()</span><span class=\"w\">\n        </span><span class=\"n\">GeneID</span><span class=\"w\">  </span><span class=\"n\">Base.mean</span><span class=\"w\">  </span><span class=\"n\">log2.FC.</span><span class=\"w\">     </span><span class=\"n\">StdErr</span><span class=\"w\"> </span><span class=\"n\">Wald.Stats</span><span class=\"w\">       </span><span class=\"n\">P.value</span><span class=\"w\">         </span><span class=\"n\">P.adj</span><span class=\"w\"> </span><span class=\"n\">Chromosome</span><span class=\"w\">  </span><span class=\"n\">Start</span><span class=\"w\">      </span><span class=\"n\">End</span><span class=\"w\"> </span><span class=\"n\">Strand</span><span class=\"w\">        </span><span class=\"n\">Feature</span><span class=\"w\">   </span><span class=\"n\">Gene.Name</span><span class=\"w\">   </span><span class=\"n\">FC</span><span class=\"w\">\n </span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"n\">FBgn0039155</span><span class=\"w\">  </span><span class=\"m\">1086.9743</span><span class=\"w\"> </span><span class=\"m\">-4.148450</span><span class=\"w\"> </span><span class=\"m\">0.13494887</span><span class=\"w\">  </span><span class=\"m\">-30.74090</span><span class=\"w\"> </span><span class=\"m\">1.617921e-207</span><span class=\"w\"> </span><span class=\"m\">1.387691e-203</span><span class=\"w\">      </span><span class=\"n\">chr3R</span><span class=\"w\"> </span><span class=\"m\">24141394</span><span class=\"w\"> </span><span class=\"m\">24147490</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">protein_coding</span><span class=\"w\">        </span><span class=\"n\">Kal1</span><span class=\"w\"> </span><span class=\"m\">0.05638871</span><span class=\"w\">\n </span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"n\">FBgn0003360</span><span class=\"w\">  </span><span class=\"m\">6409.5771</span><span class=\"w\"> </span><span class=\"m\">-2.999777</span><span class=\"w\"> </span><span class=\"m\">0.10434506</span><span class=\"w\">  </span><span class=\"m\">-28.74863</span><span class=\"w\"> </span><span class=\"m\">9.422382e-182</span><span class=\"w\"> </span><span class=\"m\">4.040788e-178</span><span class=\"w\">       </span><span class=\"n\">chrX</span><span class=\"w\"> </span><span class=\"m\">10780892</span><span class=\"w\"> </span><span class=\"m\">10786958</span><span class=\"w\">      </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">protein_coding</span><span class=\"w\">        </span><span class=\"n\">sesB</span><span class=\"w\"> </span><span class=\"m\">0.12501930</span><span class=\"w\">\n </span><span class=\"m\">3</span><span class=\"w\"> </span><span class=\"n\">FBgn0026562</span><span class=\"w\"> </span><span class=\"m\">65114.8406</span><span class=\"w\"> </span><span class=\"m\">-2.380164</span><span class=\"w\"> </span><span class=\"m\">0.08432692</span><span class=\"w\">  </span><span class=\"m\">-28.22544</span><span class=\"w\"> </span><span class=\"m\">2.850473e-175</span><span class=\"w\"> </span><span class=\"m\">8.149503e-172</span><span class=\"w\">      </span><span class=\"n\">chr3R</span><span class=\"w\"> </span><span class=\"m\">26869237</span><span class=\"w\"> </span><span class=\"m\">26871995</span><span class=\"w\">      </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">protein_coding</span><span class=\"w\"> </span><span class=\"n\">BM</span><span class=\"m\">-40</span><span class=\"o\">-</span><span class=\"n\">SPARC</span><span class=\"w\"> </span><span class=\"m\">0.19208755</span><span class=\"w\">\n </span><span class=\"m\">4</span><span class=\"w\"> </span><span class=\"n\">FBgn0025111</span><span class=\"w\">  </span><span class=\"m\">2192.3224</span><span class=\"w\">  </span><span class=\"m\">2.699939</span><span class=\"w\"> </span><span class=\"m\">0.09794457</span><span class=\"w\">   </span><span class=\"m\">27.56599</span><span class=\"w\"> </span><span class=\"m\">2.846764e-167</span><span class=\"w\"> </span><span class=\"m\">6.104174e-164</span><span class=\"w\">       </span><span class=\"n\">chrX</span><span class=\"w\"> </span><span class=\"m\">10778953</span><span class=\"w\"> </span><span class=\"m\">10786907</span><span class=\"w\">      </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">protein_coding</span><span class=\"w\">        </span><span class=\"n\">Ant2</span><span class=\"w\"> </span><span class=\"m\">6.49774366</span><span class=\"w\">\n </span><span class=\"m\">5</span><span class=\"w\"> </span><span class=\"n\">FBgn0029167</span><span class=\"w\">  </span><span class=\"m\">5430.0673</span><span class=\"w\"> </span><span class=\"m\">-2.105062</span><span class=\"w\"> </span><span class=\"m\">0.09254660</span><span class=\"w\">  </span><span class=\"m\">-22.74596</span><span class=\"w\"> </span><span class=\"m\">1.573283e-114</span><span class=\"w\"> </span><span class=\"m\">2.698810e-111</span><span class=\"w\">      </span><span class=\"n\">chr3L</span><span class=\"w\"> </span><span class=\"m\">13846053</span><span class=\"w\"> </span><span class=\"m\">13860001</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">protein_coding</span><span class=\"w\">         </span><span class=\"n\">Hml</span><span class=\"w\"> </span><span class=\"m\">0.23244132</span><span class=\"w\">\n </span><span class=\"m\">6</span><span class=\"w\"> </span><span class=\"n\">FBgn0039827</span><span class=\"w\">   </span><span class=\"m\">390.9018</span><span class=\"w\"> </span><span class=\"m\">-3.503014</span><span class=\"w\"> </span><span class=\"m\">0.16002962</span><span class=\"w\">  </span><span class=\"m\">-21.88979</span><span class=\"w\"> </span><span class=\"m\">3.250384e-106</span><span class=\"w\"> </span><span class=\"m\">4.646424e-103</span><span class=\"w\">      </span><span class=\"n\">chr3R</span><span class=\"w\"> </span><span class=\"m\">31196915</span><span class=\"w\"> </span><span class=\"m\">31203722</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">protein_coding</span><span class=\"w\">      </span><span class=\"n\">CG1544</span><span class=\"w\"> </span><span class=\"m\">0.08820388</span><span class=\"w\">\n</span></code></pre></div>      </div>\n    </li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title>Selected mutation</question-title>\n\n  <p>Create a column with the gene length and just look at the <code class=\"language-plaintext highlighter-rouge\">GeneID</code>, <code class=\"language-plaintext highlighter-rouge\">Chromosome</code>, <code class=\"language-plaintext highlighter-rouge\">Start</code>, <code class=\"language-plaintext highlighter-rouge\">End</code>, and <code class=\"language-plaintext highlighter-rouge\">Length</code> columns</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n    <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">annotatedDEgenes</span><span class=\"w\"> </span><span class=\"o\">%&gt;%</span><span class=\"w\">\n   </span><span class=\"n\">mutate</span><span class=\"p\">(</span><span class=\"n\">Length</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">End</span><span class=\"o\">-</span><span class=\"n\">Start</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">%&gt;%</span><span class=\"w\">\n   </span><span class=\"n\">select</span><span class=\"p\">(</span><span class=\"n\">GeneID</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">Chromosome</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">Start</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">End</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">Length</span><span class=\"p\">)</span><span class=\"w\">\n</span></code></pre></div>    </div>\n  </blockquote>\n</blockquote>\n\n<h2 id=\"group-and-summarize-data\">Group and summarize data</h2>\n\n<p>Many data analysis tasks can be approached using the “split-apply-combine” paradigm: split the data into groups, apply some analysis to each group, and\nthen combine the results.</p>\n\n<p><code class=\"language-plaintext highlighter-rouge\">dplyr</code> makes this very easy through the use of the <code class=\"language-plaintext highlighter-rouge\">group_by()</code> function, which splits the data into groups. When the data is grouped in this way <code class=\"language-plaintext highlighter-rouge\">summarize()</code> can be used to collapse each group into a single-row summary, by applying an aggregating or summary function to each group.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Group and summarize data</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Group by <code class=\"language-plaintext highlighter-rouge\">Chromosome</code> and extract the number rows of data for each chromosome</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">annotatedDEgenes</span><span class=\"w\"> </span><span class=\"o\">%&gt;%</span><span class=\"w\">\n    </span><span class=\"n\">group_by</span><span class=\"p\">(</span><span class=\"n\">Chromosome</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">%&gt;%</span><span class=\"w\">\n    </span><span class=\"n\">summarize</span><span class=\"p\">(</span><span class=\"n\">n</span><span class=\"p\">())</span><span class=\"w\">\n </span><span class=\"c1\"># A tibble: 5 x 2</span><span class=\"w\">\n   </span><span class=\"n\">Chromosome</span><span class=\"w\"> </span><span class=\"n\">`n()`</span><span class=\"w\">\n   </span><span class=\"o\">&lt;</span><span class=\"n\">fct</span><span class=\"o\">&gt;</span><span class=\"w\">      </span><span class=\"o\">&lt;</span><span class=\"n\">int</span><span class=\"o\">&gt;</span><span class=\"w\">\n </span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"n\">chr2L</span><span class=\"w\">         </span><span class=\"m\">24</span><span class=\"w\">\n </span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"n\">chr2R</span><span class=\"w\">         </span><span class=\"m\">31</span><span class=\"w\">\n </span><span class=\"m\">3</span><span class=\"w\"> </span><span class=\"n\">chr3L</span><span class=\"w\">         </span><span class=\"m\">27</span><span class=\"w\">\n </span><span class=\"m\">4</span><span class=\"w\"> </span><span class=\"n\">chr3R</span><span class=\"w\">         </span><span class=\"m\">32</span><span class=\"w\">\n </span><span class=\"m\">5</span><span class=\"w\"> </span><span class=\"n\">chrX</span><span class=\"w\">          </span><span class=\"m\">16</span><span class=\"w\">\n</span></code></pre></div>      </div>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>Here the summary function used was <code class=\"language-plaintext highlighter-rouge\">n()</code> to find the count for each group. Because it’s a common operation, the <code class=\"language-plaintext highlighter-rouge\">dplyr</code> verb, <code class=\"language-plaintext highlighter-rouge\">count()</code> is a “shortcut” that combines both <code class=\"language-plaintext highlighter-rouge\">group_by</code> and <code class=\"language-plaintext highlighter-rouge\">summarize</code>.</p>\n\n<p>We can also apply many other functions to individual columns to get other summary statistics.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Group and summarize data</hands-on-title>\n\n  <ol>\n    <li>\n      <p>View the highest fold change (<code class=\"language-plaintext highlighter-rouge\">log2.FC.</code>) for each chromsome</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">annotatedDEgenes</span><span class=\"w\"> </span><span class=\"o\">%&gt;%</span><span class=\"w\">\n    </span><span class=\"n\">group_by</span><span class=\"p\">(</span><span class=\"n\">Chromosome</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">%&gt;%</span><span class=\"w\">\n    </span><span class=\"n\">summarize</span><span class=\"p\">(</span><span class=\"nf\">max</span><span class=\"p\">(</span><span class=\"n\">log2.FC.</span><span class=\"p\">))</span><span class=\"w\">\n </span><span class=\"c1\"># A tibble: 5 x 2</span><span class=\"w\">\n   </span><span class=\"n\">Chromosome</span><span class=\"w\"> </span><span class=\"n\">`max(log2.FC.)`</span><span class=\"w\">\n   </span><span class=\"o\">&lt;</span><span class=\"n\">fct</span><span class=\"o\">&gt;</span><span class=\"w\">               </span><span class=\"o\">&lt;</span><span class=\"n\">dbl</span><span class=\"o\">&gt;</span><span class=\"w\">\n </span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"n\">chr2L</span><span class=\"w\">                </span><span class=\"m\">2.15</span><span class=\"w\">\n </span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"n\">chr2R</span><span class=\"w\">                </span><span class=\"m\">2.41</span><span class=\"w\">\n </span><span class=\"m\">3</span><span class=\"w\"> </span><span class=\"n\">chr3L</span><span class=\"w\">                </span><span class=\"m\">2.43</span><span class=\"w\">\n </span><span class=\"m\">4</span><span class=\"w\"> </span><span class=\"n\">chr3R</span><span class=\"w\">                </span><span class=\"m\">2.36</span><span class=\"w\">\n </span><span class=\"m\">5</span><span class=\"w\"> </span><span class=\"n\">chrX</span><span class=\"w\">                 </span><span class=\"m\">2.70</span><span class=\"w\">\n</span></code></pre></div>      </div>\n    </li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title>Summarizing groups</question-title>\n\n  <p>What are the longest genes in each chromosome?</p>\n\n  <p>Hint: the function <code class=\"language-plaintext highlighter-rouge\">abs()</code> returns the absolute value.</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">annotatedDEgenes</span><span class=\"w\"> </span><span class=\"o\">%&gt;%</span><span class=\"w\">\n   </span><span class=\"n\">mutate</span><span class=\"p\">(</span><span class=\"n\">GeneLength</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nf\">abs</span><span class=\"p\">(</span><span class=\"n\">End</span><span class=\"o\">-</span><span class=\"n\">Start</span><span class=\"p\">))</span><span class=\"w\"> </span><span class=\"o\">%&gt;%</span><span class=\"w\">\n   </span><span class=\"n\">group_by</span><span class=\"p\">(</span><span class=\"n\">Chromosome</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">%&gt;%</span><span class=\"w\">\n   </span><span class=\"n\">summarize</span><span class=\"p\">(</span><span class=\"n\">max_length</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nf\">max</span><span class=\"p\">(</span><span class=\"n\">GeneLength</span><span class=\"p\">)))</span><span class=\"w\">\n</span><span class=\"c1\"># A tibble: 5 x 2</span><span class=\"w\">\n  </span><span class=\"n\">Chromosome</span><span class=\"w\"> </span><span class=\"n\">max_length</span><span class=\"w\">\n  </span><span class=\"o\">&lt;</span><span class=\"n\">fct</span><span class=\"o\">&gt;</span><span class=\"w\">           </span><span class=\"o\">&lt;</span><span class=\"n\">int</span><span class=\"o\">&gt;</span><span class=\"w\">\n</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"n\">chr2L</span><span class=\"w\">           </span><span class=\"m\">45932</span><span class=\"w\">\n</span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"n\">chr2R</span><span class=\"w\">           </span><span class=\"m\">59682</span><span class=\"w\">\n</span><span class=\"m\">3</span><span class=\"w\"> </span><span class=\"n\">chr3L</span><span class=\"w\">          </span><span class=\"m\">111613</span><span class=\"w\">\n</span><span class=\"m\">4</span><span class=\"w\"> </span><span class=\"n\">chr3R</span><span class=\"w\">           </span><span class=\"m\">44404</span><span class=\"w\">\n</span><span class=\"m\">5</span><span class=\"w\"> </span><span class=\"n\">chrX</span><span class=\"w\">            </span><span class=\"m\">28429</span><span class=\"w\">\n</span></code></pre></div>    </div>\n  </blockquote>\n</blockquote>\n\n<blockquote class=\"comment\">\n  <comment-title>Missing data and base functions</comment-title>\n\n  <p>R has many base functions like <code class=\"language-plaintext highlighter-rouge\">mean()</code>, <code class=\"language-plaintext highlighter-rouge\">median()</code>, <code class=\"language-plaintext highlighter-rouge\">min()</code>, and <code class=\"language-plaintext highlighter-rouge\">max()</code> that are useful to compute summary statistics. These are also called “built-in functions” because they come with R and don’t require that you install any additional packages.</p>\n\n  <p>By default, all <strong>R functions operating on vectors that contains missing data will return NA</strong>. It’s a way to make sure that users know they have missing data, and make a conscious decision on how to deal with it. When dealing with simple statistics like the mean, the easiest way to ignore <code class=\"language-plaintext highlighter-rouge\">NA</code> (the missing data) is to use <code class=\"language-plaintext highlighter-rouge\">na.rm = TRUE</code> (<code class=\"language-plaintext highlighter-rouge\">rm</code> stands for remove).</p>\n</blockquote>\n\n<p><code class=\"language-plaintext highlighter-rouge\">group_by()</code> can also take multiple column names.</p>\n\n<blockquote class=\"question\">\n  <question-title>Counting</question-title>\n\n  <p>How many genes are found on each strand of each chromosome?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">annotatedDEgenes</span><span class=\"w\"> </span><span class=\"o\">%&gt;%</span><span class=\"w\">\n   </span><span class=\"n\">count</span><span class=\"p\">(</span><span class=\"n\">Chromosome</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">Strand</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"c1\"># A tibble: 10 x 3</span><span class=\"w\">\n   </span><span class=\"n\">Chromosome</span><span class=\"w\"> </span><span class=\"n\">Strand</span><span class=\"w\">     </span><span class=\"n\">n</span><span class=\"w\">\n   </span><span class=\"o\">&lt;</span><span class=\"n\">fct</span><span class=\"o\">&gt;</span><span class=\"w\">      </span><span class=\"o\">&lt;</span><span class=\"n\">fct</span><span class=\"o\">&gt;</span><span class=\"w\">  </span><span class=\"o\">&lt;</span><span class=\"n\">int</span><span class=\"o\">&gt;</span><span class=\"w\">\n </span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"n\">chr2L</span><span class=\"w\">      </span><span class=\"o\">-</span><span class=\"w\">         </span><span class=\"m\">12</span><span class=\"w\">\n </span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"n\">chr2L</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\">         </span><span class=\"m\">12</span><span class=\"w\">\n </span><span class=\"m\">3</span><span class=\"w\"> </span><span class=\"n\">chr2R</span><span class=\"w\">      </span><span class=\"o\">-</span><span class=\"w\">         </span><span class=\"m\">17</span><span class=\"w\">\n </span><span class=\"m\">4</span><span class=\"w\"> </span><span class=\"n\">chr2R</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\">         </span><span class=\"m\">14</span><span class=\"w\">\n </span><span class=\"m\">5</span><span class=\"w\"> </span><span class=\"n\">chr3L</span><span class=\"w\">      </span><span class=\"o\">-</span><span class=\"w\">         </span><span class=\"m\">12</span><span class=\"w\">\n </span><span class=\"m\">6</span><span class=\"w\"> </span><span class=\"n\">chr3L</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\">         </span><span class=\"m\">15</span><span class=\"w\">\n </span><span class=\"m\">7</span><span class=\"w\"> </span><span class=\"n\">chr3R</span><span class=\"w\">      </span><span class=\"o\">-</span><span class=\"w\">          </span><span class=\"m\">8</span><span class=\"w\">\n </span><span class=\"m\">8</span><span class=\"w\"> </span><span class=\"n\">chr3R</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\">         </span><span class=\"m\">24</span><span class=\"w\">\n </span><span class=\"m\">9</span><span class=\"w\"> </span><span class=\"n\">chrX</span><span class=\"w\">       </span><span class=\"o\">-</span><span class=\"w\">          </span><span class=\"m\">9</span><span class=\"w\">\n</span><span class=\"m\">10</span><span class=\"w\"> </span><span class=\"n\">chrX</span><span class=\"w\">       </span><span class=\"o\">+</span><span class=\"w\">          </span><span class=\"m\">7</span><span class=\"w\">\n</span></code></pre></div>    </div>\n  </blockquote>\n</blockquote>\n\n<h2 id=\"reshape-data-frames\">Reshape data frames</h2>\n\n<p>While the tidy format is useful to analyze and plot data in R, it can sometimes be useful to transform the “long” tidy format, into the wide format. This transformation can be done with the <code class=\"language-plaintext highlighter-rouge\">spread()</code> function provided by the <code class=\"language-plaintext highlighter-rouge\">tidyr</code> package (also part of the <code class=\"language-plaintext highlighter-rouge\">tidyverse</code>).</p>\n\n<p><code class=\"language-plaintext highlighter-rouge\">spread()</code> takes a data frame as the first argument, and two subsequent arguments:</p>\n<ol>\n  <li>the name of the column whose values will become the column names</li>\n  <li>the name of the column whose values will fill the cells in the wide data</li>\n</ol>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Spread a key-value pair across multiple columns</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Install and load <code class=\"language-plaintext highlighter-rouge\">tidyr</code> library</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\">## load dyplr package</span><span class=\"w\">\n</span><span class=\"n\">library</span><span class=\"p\">(</span><span class=\"s2\">\"tidyr\"</span><span class=\"p\">)</span><span class=\"w\">\n</span></code></pre></div>      </div>\n\n      <blockquote class=\"tip\">\n        <tip-title>Didn't work?</tip-title>\n        <p>You might need to install tidyr first</p>\n\n        <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">install.packages</span><span class=\"p\">(</span><span class=\"s2\">\"tidyr\"</span><span class=\"p\">)</span><span class=\"w\">\n</span></code></pre></div>        </div>\n      </blockquote>\n    </li>\n    <li>\n      <p>Create <code class=\"language-plaintext highlighter-rouge\">annotatedDEgenes_wide</code> with chromosomes as row, strand as column and number of genes as values</p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">annotatedDEgenes_wide</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">annotatedDEgenes</span><span class=\"w\"> </span><span class=\"o\">%&gt;%</span><span class=\"w\">\n    </span><span class=\"n\">group_by</span><span class=\"p\">(</span><span class=\"n\">Chromosome</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">Strand</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">%&gt;%</span><span class=\"w\">\n    </span><span class=\"n\">summarize</span><span class=\"p\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"p\">())</span><span class=\"w\"> </span><span class=\"o\">%&gt;%</span><span class=\"w\">\n    </span><span class=\"n\">spread</span><span class=\"p\">(</span><span class=\"n\">Strand</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"p\">)</span><span class=\"w\">\n </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">annotatedDEgenes_wide</span><span class=\"w\">\n </span><span class=\"c1\"># A tibble: 5 x 3</span><span class=\"w\">\n </span><span class=\"c1\"># Groups:   Chromosome [5]</span><span class=\"w\">\n   </span><span class=\"n\">Chromosome</span><span class=\"w\">   </span><span class=\"n\">`+`</span><span class=\"w\">   </span><span class=\"n\">`-`</span><span class=\"w\">\n   </span><span class=\"o\">&lt;</span><span class=\"n\">fct</span><span class=\"o\">&gt;</span><span class=\"w\">      </span><span class=\"o\">&lt;</span><span class=\"n\">int</span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">int</span><span class=\"o\">&gt;</span><span class=\"w\">\n </span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"n\">chr2L</span><span class=\"w\">         </span><span class=\"m\">12</span><span class=\"w\">    </span><span class=\"m\">12</span><span class=\"w\">\n </span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"n\">chr2R</span><span class=\"w\">         </span><span class=\"m\">14</span><span class=\"w\">    </span><span class=\"m\">17</span><span class=\"w\">\n </span><span class=\"m\">3</span><span class=\"w\"> </span><span class=\"n\">chr3L</span><span class=\"w\">         </span><span class=\"m\">15</span><span class=\"w\">    </span><span class=\"m\">12</span><span class=\"w\">\n </span><span class=\"m\">4</span><span class=\"w\"> </span><span class=\"n\">chr3R</span><span class=\"w\">         </span><span class=\"m\">24</span><span class=\"w\">     </span><span class=\"m\">8</span><span class=\"w\">\n </span><span class=\"m\">5</span><span class=\"w\"> </span><span class=\"n\">chrX</span><span class=\"w\">           </span><span class=\"m\">7</span><span class=\"w\">     </span><span class=\"m\">9</span><span class=\"w\">\n</span></code></pre></div>      </div>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>The opposite operation of <code class=\"language-plaintext highlighter-rouge\">spread()</code> is taken care by <code class=\"language-plaintext highlighter-rouge\">gather()</code>.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Gather columns into key-value pairs</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Create a data frame with chromosomes, strand and number as columns from <code class=\"language-plaintext highlighter-rouge\">annotatedDEgenes_wide</code></p>\n\n      <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">annotatedDEgenes_wide</span><span class=\"w\"> </span><span class=\"o\">%&gt;%</span><span class=\"w\">\n    </span><span class=\"n\">gather</span><span class=\"p\">(</span><span class=\"n\">Strand</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">Chromosome</span><span class=\"p\">)</span><span class=\"w\">\n </span><span class=\"c1\"># A tibble: 10 x 3</span><span class=\"w\">\n </span><span class=\"c1\"># Groups:   Chromosome [5]</span><span class=\"w\">\n    </span><span class=\"n\">Chromosome</span><span class=\"w\"> </span><span class=\"n\">Strand</span><span class=\"w\">     </span><span class=\"n\">n</span><span class=\"w\">\n    </span><span class=\"o\">&lt;</span><span class=\"n\">fct</span><span class=\"o\">&gt;</span><span class=\"w\">      </span><span class=\"o\">&lt;</span><span class=\"n\">chr</span><span class=\"o\">&gt;</span><span class=\"w\">  </span><span class=\"o\">&lt;</span><span class=\"n\">int</span><span class=\"o\">&gt;</span><span class=\"w\">\n  </span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"n\">chr2L</span><span class=\"w\">      </span><span class=\"o\">-</span><span class=\"w\">         </span><span class=\"m\">12</span><span class=\"w\">\n  </span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"n\">chr2R</span><span class=\"w\">      </span><span class=\"o\">-</span><span class=\"w\">         </span><span class=\"m\">17</span><span class=\"w\">\n  </span><span class=\"m\">3</span><span class=\"w\"> </span><span class=\"n\">chr3L</span><span class=\"w\">      </span><span class=\"o\">-</span><span class=\"w\">         </span><span class=\"m\">12</span><span class=\"w\">\n  </span><span class=\"m\">4</span><span class=\"w\"> </span><span class=\"n\">chr3R</span><span class=\"w\">      </span><span class=\"o\">-</span><span class=\"w\">          </span><span class=\"m\">8</span><span class=\"w\">\n  </span><span class=\"m\">5</span><span class=\"w\"> </span><span class=\"n\">chrX</span><span class=\"w\">       </span><span class=\"o\">-</span><span class=\"w\">          </span><span class=\"m\">9</span><span class=\"w\">\n  </span><span class=\"m\">6</span><span class=\"w\"> </span><span class=\"n\">chr2L</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\">         </span><span class=\"m\">12</span><span class=\"w\">\n  </span><span class=\"m\">7</span><span class=\"w\"> </span><span class=\"n\">chr2R</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\">         </span><span class=\"m\">14</span><span class=\"w\">\n  </span><span class=\"m\">8</span><span class=\"w\"> </span><span class=\"n\">chr3L</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\">         </span><span class=\"m\">15</span><span class=\"w\">\n  </span><span class=\"m\">9</span><span class=\"w\"> </span><span class=\"n\">chr3R</span><span class=\"w\">      </span><span class=\"o\">+</span><span class=\"w\">         </span><span class=\"m\">24</span><span class=\"w\">\n </span><span class=\"m\">10</span><span class=\"w\"> </span><span class=\"n\">chrX</span><span class=\"w\">       </span><span class=\"o\">+</span><span class=\"w\">          </span><span class=\"m\">7</span><span class=\"w\">\n</span></code></pre></div>      </div>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>We specify the names of the new columns, and here add <code class=\"language-plaintext highlighter-rouge\">-Chromosome</code> as this column shouldn’t be affected by the reshaping:</p>\n\n<blockquote class=\"question\">\n  <question-title>Categorising expression levels</question-title>\n\n  <ol>\n    <li>\n      <p>Classify each gene as either “up-regulated” (fold change &gt; 1) or “down-regulated” (fold change &lt; 1) and create a table with <code class=\"language-plaintext highlighter-rouge\">Chromosome</code> as rows, the two new labels as columns, and the number of genes in the cells.</p>\n\n      <blockquote class=\"solution\">\n        <solution-title></solution-title>\n\n        <div class=\"language-R highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">annotatedDEgenes</span><span class=\"w\"> </span><span class=\"o\">%&gt;%</span><span class=\"w\">\n   </span><span class=\"n\">mutate</span><span class=\"p\">(</span><span class=\"n\">exp_cat</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">case_when</span><span class=\"p\">(</span><span class=\"w\">\n     </span><span class=\"n\">log2.FC.</span><span class=\"w\"> </span><span class=\"o\">&gt;=</span><span class=\"w\">  </span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"o\">~</span><span class=\"w\"> </span><span class=\"s2\">\"up-regulated\"</span><span class=\"p\">,</span><span class=\"w\">\n     </span><span class=\"n\">log2.FC.</span><span class=\"w\"> </span><span class=\"o\">&lt;=</span><span class=\"w\"> </span><span class=\"m\">-1</span><span class=\"w\"> </span><span class=\"o\">~</span><span class=\"w\"> </span><span class=\"s2\">\"down-regulated\"</span><span class=\"w\">\n   </span><span class=\"p\">))</span><span class=\"w\"> </span><span class=\"o\">%&gt;%</span><span class=\"w\">\n   </span><span class=\"n\">count</span><span class=\"p\">(</span><span class=\"n\">Chromosome</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">exp_cat</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">%&gt;%</span><span class=\"w\">\n   </span><span class=\"n\">spread</span><span class=\"p\">(</span><span class=\"n\">exp_cat</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"c1\"># A tibble: 5 x 3</span><span class=\"w\">\n  </span><span class=\"n\">Chromosome</span><span class=\"w\"> </span><span class=\"n\">`down-regulated`</span><span class=\"w\"> </span><span class=\"n\">`up-regulated`</span><span class=\"w\">\n  </span><span class=\"o\">&lt;</span><span class=\"n\">fct</span><span class=\"o\">&gt;</span><span class=\"w\">                 </span><span class=\"o\">&lt;</span><span class=\"n\">int</span><span class=\"o\">&gt;</span><span class=\"w\">          </span><span class=\"o\">&lt;</span><span class=\"n\">int</span><span class=\"o\">&gt;</span><span class=\"w\">\n</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"n\">chr2L</span><span class=\"w\">                    </span><span class=\"m\">17</span><span class=\"w\">              </span><span class=\"m\">7</span><span class=\"w\">\n</span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"n\">chr2R</span><span class=\"w\">                    </span><span class=\"m\">16</span><span class=\"w\">             </span><span class=\"m\">15</span><span class=\"w\">\n</span><span class=\"m\">3</span><span class=\"w\"> </span><span class=\"n\">chr3L</span><span class=\"w\">                    </span><span class=\"m\">11</span><span class=\"w\">             </span><span class=\"m\">16</span><span class=\"w\">\n</span><span class=\"m\">4</span><span class=\"w\"> </span><span class=\"n\">chr3R</span><span class=\"w\">                    </span><span class=\"m\">18</span><span class=\"w\">             </span><span class=\"m\">14</span><span class=\"w\">\n</span><span class=\"m\">5</span><span class=\"w\"> </span><span class=\"n\">chrX</span><span class=\"w\">                      </span><span class=\"m\">8</span><span class=\"w\">              </span><span class=\"m\">8</span><span class=\"w\">\n</span></code></pre></div>        </div>\n\n      </blockquote>\n    </li>\n    <li>\n      <p>How could the code above be improved?</p>\n\n      <p>Hint: think about the assumptions that we made about the data when writing this solution.</p>\n    </li>\n  </ol>\n</blockquote>\n\n"],"ref_slides":[],"hands_on":true,"slides":false,"mod_date":"2024-05-29 14:28:52 +0000","pub_date":"2019-12-09 13:25:16 +0000","version":14,"api":"https://training.galaxyproject.org/training-material/api/topics/data-science/tutorials/r-advanced/tutorial.json","tools":["interactive_tool_rstudio"],"supported_servers":{"exact":[{"url":"https://usegalaxy.eu","name":"UseGalaxy.eu","usegalaxy":true},{"url":"https://usegalaxy.fr/","name":"UseGalaxy.fr","usegalaxy":false},{"url":"https://usegalaxy.org","name":"UseGalaxy.org (Main)","usegalaxy":true},{"url":"https://usegalaxy.org.au","name":"UseGalaxy.org.au","usegalaxy":true}],"inexact":[]},"topic_name_human":"Foundations of Data Science","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools: []\n","tours":false,"video":false,"slides_recordings":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial"}