{"layout":"tutorial_hands_on","title":"Learning about one gene across biological resources and formats","level":"Introductory","draft":true,"zenodo_link":"https://zenodo.org/record/8304465","questions":["How to employ bioinformatics resources to investigate a specific protein family (opsins)?","How to navigate the Genome Data Viewer to find opsins in the human genome?","How to identify genes associated with opsins and analyze their chromosome locations?","How to explore literature and clinical contexts for the OPN1LW gene?","How to use protein sequences files to perform similarity searches using BLAST?"],"objectives":["Starting from a text search, navigate multiple web resources to examine multiple types of information about a gene, conveyed through multiple file formats."],"time_estimation":"1H","key_points":["You can search for genes and proteins using specific text on the NCBI genome.","Once you find a relevant gene or protein, you can obtain its sequence and annotation in various formats from NCBI.","You can also learn about the chromosome location and the exon-intron composition of the gene of interest.","NCBI offers a BLAST tool to perform similarity searches with sequences.","You can further explore the resources included in this tutorial to learn more about the gene-associated conditions and the variants.","You can input a FASTA file containing a sequence of interest for BLAST searches."],"contributions":{"authorship":["lisanna","bebatut","teresa-m"],"funding":["biont"]},"js_requirements":{"mathjax":22242,"mermaid":false},"short_id":"T00359","url":"/topics/data-science/tutorials/online-resources-gene/tutorial.html","topic_name":"data-science","tutorial_name":"online-resources-gene","dir":"topics/data-science/tutorials/online-resources-gene","symlink":null,"id":"data-science/online-resources-gene","ref_tutorials":["<p>When we do a bioinformatics analysis, e.g. RNA-seq, we might end up with a list of gene names. We then need to explore these genes. But how can we do that? What are the resources available for that? And how to navigate through them?</p>\n\n<p>The aim of this tutorial is to familiarize ourselves with that, using Human opsins as an example.</p>\n\n<p>Human opsins are found in the cells of your retina. Opsins catch light and begin the sequence of signals that result in vision. We will proceed by asking questions about opsins and opsin genes, and then using different bioinformatics databases and resources to answer them.</p>\n\n<blockquote class=\"comment\">\n  <comment-title></comment-title>\n  <p>This tutorial is a bit atypical: we will not work in Galaxy but mostly outside of it, navigating databases and tools through their own web interfaces. The scope of this tutorial is to illustrate several sources of biological data in different file formats, and representing different information.</p>\n</blockquote>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n  <p>In this tutorial we will deal with:</p>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#searching-human-opsins\" id=\"markdown-toc-searching-human-opsins\">Searching Human Opsins</a></li>\n  <li><a href=\"#finding-more-information-about-our-gene\" id=\"markdown-toc-finding-more-information-about-our-gene\">Finding more information about our gene</a>    <ol>\n      <li><a href=\"#literature\" id=\"markdown-toc-literature\">Literature</a></li>\n      <li><a href=\"#clinical\" id=\"markdown-toc-clinical\">Clinical</a></li>\n      <li><a href=\"#protein\" id=\"markdown-toc-protein\">Protein</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#searching-by-sequence\" id=\"markdown-toc-searching-by-sequence\">Searching by sequence</a></li>\n  <li><a href=\"#more-information-about-our-protein\" id=\"markdown-toc-more-information-about-our-protein\">More information about our protein</a></li>\n</ol>\n</blockquote>\n\n<h1 id=\"searching-human-opsins\">Searching Human Opsins</h1>\n\n<p>To seach Human Opsins, we will start by checking the <a href=\"https://www.ncbi.nlm.nih.gov/genome/gdv\">NCBI Genome Data Viewer</a>. The NCBI Genome Data Viewer (GDV) (<span class=\"citation\"><a href=\"#rangwala2021accessing\">Rangwala <i>et al.</i> 2021</a></span>) is a genome browser supporting the exploration and analysis of annotated eukaryotic genome assemblies. The GDV browser displays biological information mapped to a genome, including gene annotation, variation data, BLAST alignments, and experimental study data from the NCBI GEO and dbGaP databases. GDV release notes describe new features relating to this browser.</p>\n\n<blockquote class=\"hands-on\">\n  <hands-on-title>Open NCBI Genome Data Viewer</hands-on-title>\n\n  <ol>\n    <li>Open the NCBI Genome Data Viewer at <a href=\"https://www.ncbi.nlm.nih.gov/genome/gdv/\">www.ncbi.nlm.nih.gov/genome/gdv</a></li>\n  </ol>\n\n</blockquote>\n\n<p>The homepage includes a simple “tree of life” where the human node is highlighted because it is the default organism to search. We can change that in the <em>Search organisms</em> box but we will leave for now as we are interested in Human Opsins.</p>\n\n<figure id=\"figure-1\" style=\"max-width: 90%;\"><img src=\"./images/GenomeDataViewerpage.png\" alt=\"Genome Data Viewer home page screenshot, the word &quot;opsin&quot; is written in the search box and the result is previewed.\" width=\"2880\" height=\"3366\" loading=\"lazy\" /><a target=\"_blank\" href=\"./images/GenomeDataViewerpage.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 1</strong>:</span> Genome Data Viewer home page</figcaption></figure>\n\n<p>The panel on the right reports multiple assemblies of the genome of interest, and a map of the chromosomes in that genome. We can search for Opsins there.</p>\n\n<blockquote class=\"hands-on\">\n  <hands-on-title>Search for OpsinsOpen NCBI Genome Data Viewer</hands-on-title>\n\n  <ol>\n    <li>Type <code class=\"language-plaintext highlighter-rouge\">opsin</code> in the <em>Search in genome</em> box</li>\n    <li>Click on the magnifier icon or press <kbd>Enter<kbd></kbd></kbd></li>\n  </ol>\n\n</blockquote>\n\n<p>Below the box is now displayed a table with genes related to opsin together with their names and location, i.e. the chromosome number, as well ass the start and end position</p>\n\n<p>In the list of genes related to the search term opsin, there are the rhodopsin gene (RHO), and three cone pigments, short-, medium-, and long-wavelength sensitive opsins (for blue, green, and red light detection). There are other entities, e.g. a -LCR (Locus Control region), putative genes and receptors.</p>\n\n<p>Multiple hits are on the X chromosome, one of the sex-determining chromosomes.</p>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>How many genes have been found in Chromosome X?</li>\n    <li>How many are protein coding genes?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>The hits in ChrX are:\n        <ul>\n          <li>OPSIN-LCR</li>\n          <li>OPN1LW</li>\n          <li>OP1MW</li>\n          <li>OPN1MW2</li>\n          <li>OPN1MW3</li>\n        </ul>\n      </li>\n      <li>By hovering over each gene, a box open and we can click on <em>Details</em> to learn more about each gene. Then we learn that the first (OPSIN-LCR) is not protein coding but a gene regulatory region and the other are protein coding genes. So there are 4 protein coding genes related to opsins in Chromosome X. In particular, Chromosome X includes one red pigment gene (OPN1LW) and three green pigment genes (OPN1MW, OPN1MW2 and OPN1MW3 in the reference genome assembly).</li>\n    </ol>\n\n  </blockquote>\n</blockquote>\n\n<p>Let’s now focus on one specific opsin, the gene OPN1LW.</p>\n\n<blockquote class=\"hands-on\">\n  <hands-on-title>Open Genome Browser for gene OPN1LW</hands-on-title>\n\n  <ol>\n    <li>Click on the blue arrow that appears in the results table when you hover your mouse on the OPN1LW row</li>\n  </ol>\n\n</blockquote>\n\n<p>You should have landed in <a href=\"https://www.ncbi.nlm.nih.gov/genome/gdv/browser/genome/?id=GCF_000001405.40\">this page</a>, that is the genome view of gene OPN1LW.</p>\n\n<figure id=\"figure-2\" style=\"max-width: 90%;\"><img src=\"./images/GenomeDataViewerofgeneOPN1LW.png\" alt=\"Genome Data Viewer of gene OPN1LW, screenshot of the two main panels of the viewer, with chromosomes on the left and the feature viewer on the right.\" width=\"2840\" height=\"1404\" loading=\"lazy\" /><a target=\"_blank\" href=\"./images/GenomeDataViewerofgeneOPN1LW.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 2</strong>:</span> Genome Data Viewer of gene OPN1LW</figcaption></figure>\n\n<p>There is a lot of information in this page, let’s focus on one section at the time.</p>\n\n<ol>\n  <li>The Genome Data Viewer, on the top, tells us that we are looking at the data from the organism <code class=\"language-plaintext highlighter-rouge\">Homo sapiens</code>, assembly <code class=\"language-plaintext highlighter-rouge\">GRCh38.p14</code> and in particular at <code class=\"language-plaintext highlighter-rouge\">Chr X</code> (Chromosome X). Each of these information has a unique ID.</li>\n  <li>The entire Chromosome is represented directly below, and the positions along the short (<code class=\"language-plaintext highlighter-rouge\">p</code>) and long (<code class=\"language-plaintext highlighter-rouge\">q</code>) arms are highlihgted.</li>\n  <li>\n    <p>Below, a blue box highlights that we are now focusing on the Region corresponding to the Gene <code class=\"language-plaintext highlighter-rouge\">OPN1LW</code>.</p>\n\n    <p>There are multiple ways to interact with the viewer below. Try for example to hover with the mouse on the dots representing exons in the blue box.</p>\n  </li>\n  <li>\n    <p>In the graph below, the gene requence is a green line with the exons (protein coding fragments) represented by green rectangles.</p>\n\n    <p>Hover with the mouse on the green line corresponding to <code class=\"language-plaintext highlighter-rouge\">NM_020061.6</code> (our gene of interest) to get more detailed information.</p>\n\n    <blockquote class=\"question\">\n      <question-title></question-title>\n\n      <ol>\n        <li>What is the location of the OPN1LW segment?</li>\n        <li>What is the length of the OPN1LW segment?</li>\n        <li>What are introns and exons?</li>\n        <li>How many exons and introns are in the OPN1LW gene?</li>\n        <li>What is the total length of the coding region?</li>\n        <li>What is the distribution between coding and non coding regions? What does that mean in term of biology?</li>\n        <li>What is the lenght of the protein in number of amino acids?</li>\n      </ol>\n\n      <blockquote class=\"solution\">\n        <solution-title></solution-title>\n\n        <ol>\n          <li>From 154,144,243 to 154,159,032</li>\n          <li>1,4790 nucleotides, found at <em>Span on 14790 nt, nucleotides)</em></li>\n          <li>Eukaryotic genes are often interrupted by non-coding regions called intervening sequences or introns. The coding regions are called exons.</li>\n          <li>From this diagram, you can see that the OPN1LW gene consists of 6 exons and 5 introns, and that the introns are far larger than the exons.</li>\n          <li>The CDS length is 1,095 nucleotides.</li>\n          <li>Of the 14790 nt in the gene, only 1095 nt code for protein, which means that less than 8% of the base pairs contain the code. When this gene is expressed in cells in the human retina, an RNA copy of the entire gene is synthesized. Then the intron regions are cut out, and the exon regions joined together to produce the mature mRNA (a process called splicing). which will be translated by ribosomes as they make the red opsin protein. In this case, 92% of the initial RNA transcript is tossed out, leaving the pure protein code.</li>\n          <li>The length of the resulting protein is 364 aa, amino acids.</li>\n        </ol>\n      </blockquote>\n    </blockquote>\n  </li>\n</ol>\n\n<p>But what is the sequence of this gene? There are multiple ways to retrieve this information, we will go through what we think is one of the most intituitive.</p>\n\n<blockquote class=\"hands-on\">\n  <hands-on-title>Open Genome Browser for gene OPN1LW</hands-on-title>\n\n  <ol>\n    <li>Click on the <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> <em>Tools</em> section on the top right of the box showing the gene</li>\n    <li>Click on <em>Sequence Text View</em></li>\n  </ol>\n</blockquote>\n\n<p>This panel reports the DNA sequence of the introns (in green), as well as the one of the exons (in pink, including the translated protein sequence below).</p>\n\n<figure id=\"figure-3\" style=\"max-width: 90%;\"><img src=\"./images/SequenceTextView.png\" alt=\"Screenshot of the sequence view of the NHI resource, text is highlighted in different colors.\" width=\"2860\" height=\"1416\" loading=\"lazy\" /><a target=\"_blank\" href=\"./images/SequenceTextView.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 3</strong>:</span> Sequence Text View</figcaption></figure>\n\n<p>This sequence box is not showing the entire gene at the moment, but a subsequence of it. You can move upstream and downstream the genetic code with the arrows <em>Prev Page</em> and <em>Next Page</em>, or start from a specific position with the <em>Go To Position</em> button. We suggest to start with the start of the coding part of the gene, which as we learned earlier is at position 154,144,243.</p>\n\n<blockquote class=\"hands-on\">\n  <hands-on-title>Go to a specific position in Sequence View</hands-on-title>\n\n  <ol>\n    <li>Click on <em>Go To Position</em></li>\n    <li>\n      <p>Type on <code class=\"language-plaintext highlighter-rouge\">154144243</code></p>\n\n      <p>We have to remove the commas to validate the value</p>\n    </li>\n  </ol>\n</blockquote>\n\n<p>The sequence highlighted in purple here signals a regulatory region.</p>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>What is the first amino acid of the resulting protein product?</li>\n    <li>What is the last one?</li>\n    <li>Can you keep a note of the first three and last three AAs of this protein?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>The correspondent protein starts with Methionine, M (they all do).</li>\n      <li>The last AA of the last exon (found in the 2nd page) is Alanine (A). After that, the stop codon TGA comes, which is not translated into an AA.</li>\n      <li>The first three AAs are: M,A,Q; the last three: S,P,A.</li>\n    </ol>\n\n  </blockquote>\n</blockquote>\n\n<p>We can now close the <em>Sequence View</em>.</p>\n\n<p>From this resource, we can also get files, in different format, describing the gene. They are available from the <em>Download</em> section.</p>\n\n<ol>\n  <li><em>Download FASTA</em> will allow us to download the simplest file format to represent the nucleotide sequence of all the visible range of the genome (longer than the gene only).</li>\n  <li><em>Download GenBank flat file</em> will allow us to access the annotation avaible on this page (and beyond) in a flat text format.</li>\n  <li><em>Download Track Data</em> allows us to inpect two of the file formats we presented in the slides: the GFF (GFF3) and BED formats. If you change the tracks, each one may or may not be available.</li>\n</ol>\n\n<h1 id=\"finding-more-information-about-our-gene\">Finding more information about our gene</h1>\n\n<p>Let’s now get an overview of the information we have (in the literature) about our gene, using the NCBI resources</p>\n\n<blockquote class=\"hands-on\">\n  <hands-on-title>Go to a specific position in Sequence View</hands-on-title>\n\n  <ol>\n    <li>Open the NCBI search at <a href=\"https://www.ncbi.nlm.nih.gov/search/\">www.ncbi.nlm.nih.gov/search</a></li>\n    <li>Type <code class=\"language-plaintext highlighter-rouge\">OPN1LW</code> in the <em>Search NCBI</em> search box</li>\n  </ol>\n\n</blockquote>\n\n<figure id=\"figure-4\" style=\"max-width: 90%;\"><img src=\"./images/NIHresults.png\" alt=\"Screenshot of the NIH result page, with cards named Literature, Genes, Proteins, genomes, Clinical and PubChem. \" width=\"2880\" height=\"3228\" loading=\"lazy\" /><a target=\"_blank\" href=\"./images/NIHresults.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 4</strong>:</span> Results when searching for `OPN1LW` on NCBI</figcaption></figure>\n<p>.</p>\n\n<h2 id=\"literature\">Literature</h2>\n\n<p>Let’s start with the literature and in particular <em>PubMed</em> or <em>PubMed Central</em> results</p>\n\n<blockquote class=\"details\">\n  <details-title>What's the difference between PubMed and PubMed Central? </details-title>\n\n  <p>PubMed is a biomedical literature database which contains the abstracts of publications in the database.</p>\n\n  <p>PubMed Central is a full text repository, which contains the full text of publications in the database.</p>\n\n  <p>While the exact number of hits may vary in time from the screenshot above, any gene name should have more hits in PubMed Central (searched in the full texts of publications) than in PubMed (searched only in the abstracts).</p>\n\n</blockquote>\n\n<blockquote class=\"hands-on\">\n  <hands-on-title>Open PubMed</hands-on-title>\n\n  <ol>\n    <li>Click on <em>PubMed</em> in the <em>Literature</em> box</li>\n  </ol>\n\n</blockquote>\n\n<p>You have entered PubMed, a free database of scientific literature, to the results of a complete search for articles directly associated with this gene locus.</p>\n\n<p>By clicking on the title of each article, you can see abstracts of the article. If you are on a university campus where there is online access to specific journals, you might also see links to full articles. PubMed is your entry point to a wide variety of scientific literature in the life sciences. On the left side of any PubMed page, you will find links to a description of the database, help, and tutorials on searching.</p>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>Can you guess which type of conditions are associated to this gene?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>We will answer this question later</li>\n    </ol>\n\n  </blockquote>\n</blockquote>\n\n<blockquote class=\"hands-on\">\n  <hands-on-title>Back to NCBI Search page</hands-on-title>\n\n  <ol>\n    <li>Go back the <a href=\"https://www.ncbi.nlm.nih.gov/search/all/?term=OPN1LW\">NCBI Search page</a></li>\n  </ol>\n\n</blockquote>\n\n<h2 id=\"clinical\">Clinical</h2>\n\n<p>Let’s now focus on the <em>Clinical</em> box, and specially on <em>OMIM</em>. OMIM, the Online Mendeliam Inheritance in Man (and woman!), is a catalog of human genes and genetic disorders.</p>\n\n<blockquote class=\"hands-on\">\n  <hands-on-title>Open OMIM</hands-on-title>\n\n  <ol>\n    <li>Click on <em>OMIM</em> in the <em>Clinical</em> box</li>\n  </ol>\n\n</blockquote>\n\n<p>Each OMIM entry is a genetic disorder (here mostly types of colorblindness) associated with mutations in this gene.</p>\n\n<blockquote class=\"hands-on\">\n  <hands-on-title>Read as much as your interest dictates</hands-on-title>\n\n  <ol>\n    <li>Follow links to get more information about each entry</li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"comment\">\n  <comment-title>Read as much as your interest dictates</comment-title>\n\n  <p>For more information about OMIM itself, click the OMIM logo at the top of the page. Through OMIM, a wealth of information is available for countless genes in the human genome, and all information is backed up by references to the latest research articles.</p>\n\n</blockquote>\n\n<p>How do variations in the gene affect the protein product, and its functions? Let’s go back to the NIH page and investigate access the list of Single Nucleotide Polymorphisms (SNPs) that were detected by genetics studies in the gene.</p>\n\n<blockquote class=\"hands-on\">\n  <hands-on-title>Open dbSNP</hands-on-title>\n\n  <ol>\n    <li>Go back the <a href=\"https://www.ncbi.nlm.nih.gov/search/all/?term=OPN1LW\">NCBI Search page</a></li>\n    <li>Click on <em>dbSNP</em> in the <em>Clinical</em> box</li>\n  </ol>\n\n</blockquote>\n\n<figure id=\"figure-5\" style=\"max-width: 90%;\"><img src=\"./images/dbSNPs.png\" alt=\"Screenshot of the dbSNPs page about gene OPN1LW. Three main panels, the one on the left to filter the search based on tags, the central showing results, the right for a more detailed and programmatic search.\" width=\"2370\" height=\"3236\" loading=\"lazy\" /><a target=\"_blank\" href=\"./images/dbSNPs.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 5</strong>:</span> dbSNP in OPN1LW</figcaption></figure>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>What is the clinical significance of the rs5986963 and rs5986964 (first 2 variants listed at the time of creation of this tutorial)?</li>\n    <li>What is the functional consequence of rs104894912?</li>\n    <li>What is the functional consequence of rs104894913?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>The Clinical significance is <code class=\"language-plaintext highlighter-rouge\">benign</code> so it seems that they have no effect on the final protein product</li>\n      <li>rs104894912 mutation leads to a <code class=\"language-plaintext highlighter-rouge\">stop_gained</code> variant, which truncates the resulting protein too early and is therefore <code class=\"language-plaintext highlighter-rouge\">pathogenic</code></li>\n      <li>rs104894913 mutation leads to a <code class=\"language-plaintext highlighter-rouge\">missense_variant</code>, also <code class=\"language-plaintext highlighter-rouge\">pathogenic</code>.</li>\n    </ol>\n\n  </blockquote>\n</blockquote>\n\n<p>Let’s investigate about more on the rs104894913 variant</p>\n\n<blockquote class=\"hands-on\">\n  <hands-on-title>Learn more about a variant dbSNP</hands-on-title>\n\n  <ol>\n    <li>Click on <code class=\"language-plaintext highlighter-rouge\">rs104894913</code> to open its <a href=\"https://www.ncbi.nlm.nih.gov/snp/rs104894913\">dedicated page</a></li>\n    <li>\n      <p>Click on <em>Clinical Significance</em></p>\n\n      <blockquote class=\"question\">\n        <question-title></question-title>\n\n        <p>What type of condition is associated with the rs104894913 variant?</p>\n\n        <blockquote class=\"solution\">\n          <solution-title></solution-title>\n\n          <p>The name of the associated disease is “Protan defect”. A quick internet search with your search engine will clarify that this is a type of color blindness.</p>\n\n        </blockquote>\n      </blockquote>\n    </li>\n    <li>\n      <p>Click on the <em>Variant details</em></p>\n\n      <blockquote class=\"question\">\n        <question-title></question-title>\n\n        <ol>\n          <li>Which substitution is associated with this variant?</li>\n          <li>What is impact of this subtitution in term of codon and amino acid?</li>\n          <li>At which position of the protein is this substitution?</li>\n        </ol>\n\n        <blockquote class=\"solution\">\n          <solution-title></solution-title>\n\n          <ol>\n            <li>The substitution <code class=\"language-plaintext highlighter-rouge\">NC_000023.10:g.153424319G&gt;A</code> corresponds to change from a Guanine (G) to an Adenine (A)</li>\n            <li>This substitution change the codon <code class=\"language-plaintext highlighter-rouge\">GGG</code>, a Glycine, into <code class=\"language-plaintext highlighter-rouge\">GAG</code>, a Glutathione</li>\n            <li><code class=\"language-plaintext highlighter-rouge\">p.Gly338Glu</code> means that the substitution is at position 338 of the protein.</li>\n          </ol>\n        </blockquote>\n      </blockquote>\n    </li>\n  </ol>\n</blockquote>\n\n<p>What does this mean this substitution for the protein? Let’s have a deeper look at this protein.</p>\n\n<h2 id=\"protein\">Protein</h2>\n\n<blockquote class=\"hands-on\">\n  <hands-on-title>Open Protein</hands-on-title>\n\n  <ol>\n    <li>Go back the <a href=\"https://www.ncbi.nlm.nih.gov/search/all/?term=OPN1LW\">NCBI Search page</a></li>\n    <li>Click on <em>Protein</em> in the <em>Proteins</em> box</li>\n    <li>Click on <code class=\"language-plaintext highlighter-rouge\">OPN1LW – opsin 1, long wave sensitive</code> in the box on top</li>\n  </ol>\n\n</blockquote>\n\n<figure id=\"figure-6\" style=\"max-width: 90%;\"><img src=\"./images/Opsin1NIH.png\" alt=\"Screenshot of the Opsin 1 NIH protein page, two main panels. The one on the left reporting information about the gene, the one on the right is a table of content and a series of links to other resources. \" width=\"2818\" height=\"1784\" loading=\"lazy\" /><a target=\"_blank\" href=\"./images/Opsin1NIH.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 6</strong>:</span> Opsin 1 NIH protein page</figcaption></figure>\n\n<p>This page presents once again some data that we are familiar with (e.g. distribution of the exons along the gene sequence).</p>\n\n<blockquote class=\"hands-on\">\n  <hands-on-title>Download the protein sequences</hands-on-title>\n\n  <ol>\n    <li>Click on <em>Download Datasets</em></li>\n    <li>Select\n      <ul>\n        <li><code class=\"language-plaintext highlighter-rouge\">Gene Sequences (FASTA)</code></li>\n        <li><code class=\"language-plaintext highlighter-rouge\">Transcript sequences (FASTA)</code></li>\n        <li><code class=\"language-plaintext highlighter-rouge\">Protein sequences (FASTA)</code></li>\n      </ul>\n    </li>\n    <li>Click on <em>Download</em> button</li>\n    <li>Open the downloaded ZIP file</li>\n  </ol>\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>What does the folder contain?</li>\n    <li>Do you think they implemented good data practices?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>The folder includes\n        <ul>\n          <li>a folder <code class=\"language-plaintext highlighter-rouge\">ncbi_datasets</code> with different subfolders in it leadig some data files (multiple formats),</li>\n          <li>a <code class=\"language-plaintext highlighter-rouge\">README.md</code> (a Markdown file), which is designed to “travel” together with the data and explain how was the data retreived, what is the structure of the data containing subfolder, and where to find extensive documentation.</li>\n        </ul>\n      </li>\n      <li>It is definitely a good data management practice to guide users (not only your collaborators, but also yourself in the not-so-far future, when you will forget where does that file in your Downloads folder come from) to the data source and the data structure.</li>\n    </ol>\n\n  </blockquote>\n</blockquote>\n\n<h1 id=\"searching-by-sequence\">Searching by sequence</h1>\n\n<p>What could we do with these sequences that we just downloaded? Let’s assume that we just sequenced the transcripts that we isolated through an experiment - so we know the sequence of our entity of interest, but don’t know what it is. What we need to do in this case is to search the entire database of sequences known to science and match our unknown entity with an entry that has some annotation. Let’s do it.</p>\n\n<blockquote class=\"hands-on\">\n  <hands-on-title>Search the protein sequence against all protein sequences</hands-on-title>\n\n  <ol>\n    <li>Open (with the simplest text editor you have installed) the <code class=\"language-plaintext highlighter-rouge\">protein.faa</code> file that you just downloaded.</li>\n    <li>Copy its contents</li>\n    <li>Open BLAST <a href=\"https://blast.ncbi.nlm.nih.gov/Blast.cgi\">blast.ncbi.nlm.nih.gov</a></li>\n    <li>\n      <p>Click on the <code class=\"language-plaintext highlighter-rouge\">Protein BLAST, protein &gt; protein</code></p>\n\n      <p>We will indeed use a protein sequence to search against a database of proteins</p>\n    </li>\n    <li>Paste the protein sequence into the big text box</li>\n    <li>Check the rest of parameters</li>\n    <li>Click the blue button <code class=\"language-plaintext highlighter-rouge\">BLAST</code></li>\n  </ol>\n</blockquote>\n\n<p>This phase will take some time, there is afterall some server somewhere that is comparing the entirety of known sequences to your target.  When the search is complete, the result should look similar to the one below:</p>\n\n<figure id=\"figure-7\" style=\"max-width: 90%;\"><img src=\"./images/BLASTresults.png\" alt=\"Screenshot of BLAST results, one big header on top and the results listed as a table on bottom. \" width=\"2550\" height=\"1898\" loading=\"lazy\" /><a target=\"_blank\" href=\"./images/BLASTresults.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 7</strong>:</span> BLAST results</figcaption></figure>\n\n<blockquote class=\"hands-on\">\n  <hands-on-title>Graphic Summary of the protein sequences</hands-on-title>\n\n  <ol>\n    <li>Click on the tab <em>Graphic Summary</em></li>\n  </ol>\n</blockquote>\n\n<p>We access a box containing lots of colored lines. Each line represents a hit from your blast search. If you click on a red line, the narrow box just above the box gives a brief description of the hit.</p>\n\n<blockquote class=\"hands-on\">\n  <hands-on-title>Descriptions of the protein sequences</hands-on-title>\n\n  <ol>\n    <li>Click on the tab <em>Descriptions</em></li>\n  </ol>\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>What is the first hit? Is it expected?</li>\n    <li>What are the other hits? For which organisms?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>The first hit is our red opsin. That’s encouraging, because the best match should be to the query sequence itself, and you got this sequence from that gene entry.</li>\n      <li>Other hits are other opsins. They include entries from other primates (e.g. <code class=\"language-plaintext highlighter-rouge\">Pan troglogytes</code>).</li>\n    </ol>\n\n  </blockquote>\n</blockquote>\n\n<p>The hits are for our red opsin in human but also other opsins in other primates. We could want that, for example if we wanted to use this data to build a phylogenetic tree. If we instead are pretty sure that our sequence of interest is human, we could also have filtered the search only in human sequences.</p>\n\n<blockquote class=\"hands-on\">\n  <hands-on-title>Filter a BLAST Search</hands-on-title>\n\n  <ol>\n    <li>Click on <em>Edit Search</em></li>\n    <li>Type <code class=\"language-plaintext highlighter-rouge\">Homo sapiens</code> in <em>Organism</em> field</li>\n    <li>Click the blue button <code class=\"language-plaintext highlighter-rouge\">BLAST</code></li>\n  </ol>\n</blockquote>\n\n<p>With this new search, we find the other opsins (green, blue, rod-cell pigment) in the list. Other hits have lower numbers of matching residues. If you click on any of the colored lines in the <em>Graphic Summary</em>, you’ll open more information about that hit, and you can see how much similarity each one has to the red opsin, our original query sequence. As you go down the list, each succeeding sequence has less in common with red opsin. Each sequence is shown in comparison with red opsin in what is called a pairwise sequence alignment. Later, you’ll make multiple sequence alignments from which you can discern relationships among genes.</p>\n\n<blockquote class=\"details\">\n  <details-title>More details on BLAST scores</details-title>\n\n  <p>The displays contain two prominent measures of the significance of the hit:</p>\n\n  <ol>\n    <li>\n      <p>the BLAST Score - lableled Score (bits)</p>\n\n      <p>The BLAST Score indicates the quality of the best alignment between the query sequence and the found sequence (hit). The higher the score, the better the alignment. Scores are reduced by mismatches and gaps in the best alignment. Calculation of the score is complex, involving a substitution matrix, which is a table that assigns a score to each pair of residues aligned. The most widely used matrix for protein alignment is known as BLOSUM62.</p>\n    </li>\n    <li>\n      <p>the Expectation Value (labeled Expect or E)</p>\n\n      <p>The expectation value E of a hit tells whether the hit is likely be result from chance likeness between hit and query, or from common ancestry of hit and query. ()</p>\n\n      <blockquote class=\"comment\">\n        <comment-title>Filter a BLAST Search</comment-title>\n\n        <p>If E is smaller than \\(10\\mathrm{e}{-100}\\), it is sometimes given as 0.0.</p>\n      </blockquote>\n\n      <p>The expectation value is the number of hits you would expect to occur purely by chance if you searched for your sequence in a random genome the size of the human genome.</p>\n\n      <p>\\(E = 25\\) means that you could expect to find 25 matches in a genome of this size, purely by chance. So a hit with \\(E = 25\\) is probably a chance match, and does not imply that the hit sequence shares common ancestry with your search sequence.</p>\n\n      <p>Expectation values of around 0.1 may or may not be biologically significant (other tests would be needed to decide).</p>\n\n      <p>But very small values of E mean that the hit is biologically significant. The correspondence between your search sequence and this hit must arise from common ancestry of the sequences, because the odds are are simply too low that the match could arise by chance. For example, \\(E = 10\\mathrm{e}{-18}\\) for a hit in the human genome means that you would expect only one chance match in one billion billion different genomes the same size of the human genome.</p>\n\n      <p>The reason we believe that we all come from common ancestors is that massive sequence similarity in all organisms is simply too unlikely to be a chance occurrence. Any family of similar sequences across many organisms must have evolved from a common sequence in a remote ancestor.</p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"hands-on\">\n  <hands-on-title>Dowloading </hands-on-title>\n\n  <ol>\n    <li>Click on <em>Descriptions</em> tab</li>\n    <li>Click at any sequence hit</li>\n    <li>Click on <em>Download</em></li>\n    <li>Select <code class=\"language-plaintext highlighter-rouge\">FASTA (aligned sequences)</code></li>\n  </ol>\n</blockquote>\n\n<p>It will download a new, slightly different, type of file: an aligned FASTA. If you want, explore it before the next section.</p>\n\n<p>While in the previous sections of this tutorial we extensively used the web interfaces of the tools (genomic viewers, quick literature scanning, reading annotations, etc.), this BLAST search is an example of a step that you could fully automate with Galaxy.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title> Similarity search with BLAST in Galaxy </hands-on-title>\n\n  <ol>\n    <li>\n      <p>Create a new history for this analysis</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-new-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-new-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a new history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>Click the <i class=\"fas fa-plus\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">new-history</span> icon at the top of the history panel:</p>   <p><img src=\"/training-material/shared/images/history_create_new.svg\" alt=\"UI for creating new history\" /></p>   <!-- the original drawing can be found here https://docs.google.com/drawings/d/1cCBrLAo4kDGic5QyB70rRiWJAKTenTU8STsKDaLcVU8/edit?usp=sharing --> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Rename the history</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-renaming-a-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-renaming-a-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Renaming a history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ol>   <li>Click on <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> (<strong>Edit</strong>) next to the history name (which by default is “Unnamed history”)</li>   <li>Type the new name</li>   <li>Click on <strong>Save</strong></li> </ol>   <p>If you do not have the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> (<strong>Edit</strong>) next to the history name:</p>   <ol>   <li>Click on <strong>Unnamed history</strong> (or the current name of the history) (<strong>Click to rename history</strong>) at the top of your history panel</li>   <li>Type the new name</li>   <li>Press <kbd>Enter</kbd></li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Import the protein sequence via link from <a href=\"https://zenodo.org/record/8304465\">Zenodo</a> or Galaxy shared data libraries:</p>\n\n      <div class=\"language-text highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/8304465/files/protein.faa\n</code></pre></div>      </div>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-via-links\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-via-links\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing via links</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-data-from-a-data-library\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-data-from-a-data-library\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing data from a data library</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>As an alternative to uploading the data from a URL or your computer, the files may also have been made available from a <em>shared data library</em>:</p>   <ol>   <li>Go into <strong>Shared data</strong> (top panel) then <strong>Data libraries</strong></li>   <li>Navigate to  the correct folder as indicated by your instructor.     <ul>       <li>On most Galaxies tutorial data will be provided in a folder named <strong>GTN - Material –&gt; Topic Name -&gt; Tutorial Name</strong>.</li>     </ul>   </li>   <li>Select the desired files</li>   <li>Click on <strong>Add to History</strong> <i class=\"fas fa-caret-down\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-dropdown</span> near the top and select <strong>as Datasets</strong> from the dropdown menu</li>   <li>     <p>In the pop-up window, choose</p>     <ul>       <li><em>“Select history”</em>: the history you want to import the data to (or create a new one)</li>     </ul>   </li>   <li>Click on <strong>Import</strong></li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/devteam/ncbi_blast_plus/ncbi_blastp_wrapper/2.10.1+galaxy2\" title=\"NCBI BLAST+ blastp tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>NCBI BLAST+ blastp</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.10.1+galaxy2)</span> with the following parameters:</p>\n      <ul>\n        <li><em>“Protein query sequence(s)”</em>: <code class=\"language-plaintext highlighter-rouge\">protein.faa</code></li>\n        <li><em>“Subject database/sequences”</em>: <code class=\"language-plaintext highlighter-rouge\">Locally installed BLAST database</code></li>\n        <li>\n          <p><em>“Protein BLAST database”</em>: <code class=\"language-plaintext highlighter-rouge\">SwissProt</code></p>\n\n          <p>To search against only annotated sequences in UniProt, we need select the latest release of <code class=\"language-plaintext highlighter-rouge\">SwissProt</code></p>\n        </li>\n        <li><em>“Set expectation value cutoff”</em>: <code class=\"language-plaintext highlighter-rouge\">0.001</code></li>\n        <li><em>“Output format”</em>: <code class=\"language-plaintext highlighter-rouge\">Tabular (extended 25 columns)</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>Do you think we are looking at exactly the same results as our original search for <code class=\"language-plaintext highlighter-rouge\">opsin</code> in <a href=\"https://www.ncbi.nlm.nih.gov/genome/gdv/\">www.ncbi.nlm.nih.gov/genome/gdv</a>? Why?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <p>The results might be similar, but there are definitely some differences. Indeed, not only a text search is different than a sequence search in terms of method, but also this second round we started from the sequence of one specific opsin, so one branch of the entire protein family tree. Some of the family members are more similar between each other, so this type of search looks at the whole family from a quite biased perspective.</p>\n\n  </blockquote>\n</blockquote>\n\n<h1 id=\"more-information-about-our-protein\">More information about our protein</h1>\n\n<p>So far, we explored this information about opsins:</p>\n<ul>\n  <li>how to know which proteins of a certain type exist in a genome,</li>\n  <li>how to know where they are along the genome,</li>\n  <li>how to get more information about a gene of interest,</li>\n  <li>how to download their sequences in different formats,</li>\n  <li>how to use these files to perform a similarity search.</li>\n</ul>\n\n<p>You might be curious about how to know more about the proteins they code for, now. We have already collected some information (e.g. diseases associated), but in the next steps we will cross it with data about the protein structure, localisation, interactors, functions, etc.</p>\n\n<p>The portal to visit to obtain all information about a protein is <a href=\"https://www.uniprot.org/\">UniProt</a>. We can search it using a text search, or the gene or protein name. Let’s go for our usual <code class=\"language-plaintext highlighter-rouge\">OPN1LW</code> keyword.</p>\n\n<blockquote class=\"hands-on\">\n  <hands-on-title>Searching on UniProt</hands-on-title>\n\n  <ol>\n    <li>Open  <a href=\"https://www.uniprot.org/\">UniProt</a></li>\n    <li>Type <code class=\"language-plaintext highlighter-rouge\">OPN1LW</code> in the search bar</li>\n    <li>Select the card view</li>\n  </ol>\n</blockquote>\n\n<p>The first hit should be <code class=\"language-plaintext highlighter-rouge\">P04000 · OPSR_HUMAN</code>. Before opening the page, two things to notice:</p>\n\n<ol>\n  <li>The name of the protein <code class=\"language-plaintext highlighter-rouge\">OPSR_HUMAN</code> is different than the gene name, as well as their IDs are.</li>\n  <li>This entry has a golden star, which means that was manually annotated and curated.</li>\n</ol>\n\n<blockquote class=\"hands-on\">\n  <hands-on-title>Open a result on UniProt</hands-on-title>\n\n  <ol>\n    <li>Click on <code class=\"language-plaintext highlighter-rouge\">P04000 · OPSR_HUMAN</code></li>\n  </ol>\n</blockquote>\n\n<figure id=\"figure-8\" style=\"max-width: 90%;\"><img src=\"./images/UniProt.png\" alt=\"Screenshot of the UniProt entry page header. \" width=\"2850\" height=\"1330\" loading=\"lazy\" /><a target=\"_blank\" href=\"./images/UniProt.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 8</strong>:</span> UniProt page</figcaption></figure>\n\n<p>This is a long page with a lot of information, we designed an <a href=\"/training-material/topics/data-science/tutorials/online-resources-protein/tutorial.html\">entire tutorial</a> to go through it.</p>\n"],"ref_slides":["# Background\n\n- Need: digitally store biological data\n- All biological data could be (and initially was) included in simple text files\n- Yet, significant limitations:\n    - Not structured, hence not programmatically accessible\n    - Impossible to distinguish data (e.g. gene sequence) from metadata (e.g. annotations about location, quality, function, etc.)\n\n???\n\nIn this presentation, we'll look into the history of biological data.\nInitially, all type of data was approached using simple text files, but this quickly became limiting.\nIndeed, unstructured text files are not programmatically accessible and in such files it is impossible to distinguish data from metadata.\nIt's important to understand these limitations as they set the stage for the development of more advanced storage methods.\n\n---\n\n## Different information in different file formats\n\n- In the years, different file formats have been developed to store different types of data with the relevant metadata fields\n- E.g. for a biological sequence\n    - From the simplest, text-like file (FASTA)\n    - To more complex formats which include genomic features and quality annotation\n- Different file formats not only to represent different levels of complexity but also different types of information\n- E.g. about a protein\n    - From a text-like file to store the sequence (FASTA)\n    - To a tabular file to store the exact coordinates of each atom in the structure, hence comvey the 3D arrangement\n\n???\n\nAs time progressed, the need for more structured and accessible data storage became apparent.\nVarious file formats were developed to accommodate different types of biological data.\nWe'll explore some of these formats, ranging from simple text-like files for storing sequences to more complex ones\nthat include annotations, 3D structures, and genomic features.\n\n---\n\n## Different information in different databases\n\n- Consequently, different resources evolved not only to store, but also represent/visualise this varied information\n- These resources often have a database storing data and a web interface that allows to navigate it\n- They usually represent different levels of complexity of one specific type of biological entity\n    - E.g. A database of protein sequences and their annotation (sequence variability, genomic location, effect of mutations, etc.)\n    - E.g. A database of protein structures and their annotation (3D coordinates, flexibility, methods used to resolve the structure, etc.)\n\n???\n\nIn parallel, different biological resources emerged, each designed to handle specific types of data and complexity.\nThese resources often consist of databases with associated web interfaces, enabling users to navigate and visualize the data effectively.\n\n---\n\n### Definition of a biological database/resources\n\n- The [NAR Database Issue](https://www.oxfordjournals.org/nar/database/c/) collects publications of established databases in the field\n- Collection of data (and metadata) in the related format\n    - structured\n    - searchable (indexed)\n    - updated periodically\n    - entries mapped to unique identifiers, and cross-referenced\n- Includes associated software necessary for DB access, update, search, visualisation (web)\n\n???\n\nBiological databases play a crucial role in housing and organizing biological data.\nThe NAR Database Issue collects publications about established databases in the field.\nRequirements to be featured in this issues are to have a structured nature, searchability, regular updates, and cross-referencing capabilities.\nThese databases also offer software tools for accessing, updating, and visualizing the data they contain.\n\n---\n\n## Some history\n\n.pull-left[\n- 1953: 3D structure of DNA (Watson, Crick, Franklin, Wilkins)\n- 1956: first protein sequence, insulin (51 AA)\n- 1965: first whole nucleic acid sequence, tRNA from yeast\n- 1966: Atlas of protein sequences and structures, by Margaret Dayhoff, printed book\n- 1972: first complete protein-coding gene, coat protein from a bacteriophage\n- 1976: same Lab, its complete genome\n- 1971: Protein Data Bank (PDB)\n- 1980-87: the European Molecular Biology Laboratory (EMBL) Nucleotide Sequence Database; GenBank from the National Center for Biotechnology Information (NCBI); and the DNA Databank of Japan (DDJ)\n- 1986: SwissProt was created by Rolf Apweiler\n]\n\n.pull-right[\n![The dataset of PDB structures in 1973 included only 9 proteins illustrated in this image](http://cdn.rcsb.org/rcsb-pdb/v2/about-us/early.png)\n]\n\n???\n\nThe source of information for this slide, which includes a short early history of biological data formats and databases evolution, is the paper: https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4727787/\nUnderstanding the historical context of biological data storage helps us appreciate the progress made in the field.\n- 1953: Watson and Crick famously solved the three-dimensional structure of DNA in 1953, working from crystallographic data produced by Rosalind Franklin and Maurice Wilkins\n- 1956: Fred Sanger obtained the first protein sequence, of insulin (51 AA)\n- 1965: Robert Holley and colleagues were able to produce the first whole nucleic acid sequence, that of alanine tRNA from Saccharomyces cerevisiae\n- 1966: Atlas of protein sequences and structures, by Margaret Dayhoff, a printed book including multiple\n    > This book is a compilation of known protein sequences. The major ones listed are for cytochrome C and for hemoglobin alpha and beta chains.\n- 1972: Walter Fiers' laboratory was able to produce the first complete protein-coding gene sequence in 1972, that of the coat protein of bacteriophage MS2\n- 1976: same Lab, its complete genome\n- 1971: Protein Data Bank (PDB)\n- 1980-87: the European Molecular Biology Laboratory (EMBL) Nucleotide Sequence Database; GenBank from the National Center for Biotechnology Information (NCBI); and the DNA Databank of Japan (DDJ)\n- 1986: SwissProt was created by Rolf Apweiler\n\n---\n\n# Examples of biological databases\n\n- SwissProt + TrEMBL = UniProtKB\n- PDB\n- GenBank\n\n???\n\nProminent biological databases that have significantly contributed to our understanding of biological entities\nare for example UniProtKB, PDB, and GenBank. We will discuss their importance and the types of data they store.\n\n---\n\n### UniProtKB\n\n.pull-left[\n- Swiss-Prot: Manually curated / annotated Sequence Database\n- TrEMBL: Database of EMBL nucleotide translated sequences, automatically annotated\n\nThe two databases are merged into the UniProt Knowledge Base, including information of different types about proteins.\n]\n\n.pull-right[\n![The UniProtKB, at the time of creation of these slides, includes 596793 manually curated entries (Reviewed) in Swiss-Prot and 248272897 Unreviewed entries in TrEMBL](./images/UniProt_proteins.png)\n]\n\n???\n\n\nUniProtKB is a comprehensive resource that brings together data from both Swiss-Prot and TrEMBL databases.\nWe'll explore how these databases are merged to create a unified knowledge base about proteins, encompassing a wide array of information.\n\n---\n\n### PDB\n\n.pull-left[\nProtein Data Bank (PDB) archive of 3D structure data for biological molecules (proteins, DNA, RNA).\n\nCurrently includes > 1TB of structure data, archived world-wide.\n]\n\n.pull-right[\n![The wwPDB project maintains a single PDB archive distributed in the USA, Europe and Japan, and freely and publicly available to the global community](http://cdn.rcsb.org/rcsb-pdb/v2/about-us/wwpdb.png)\n]\n\n???\n\nThe Protein Data Bank, or PDB, is a vital repository for 3D structure data of biological molecules.\nWe'll delve into the significance of PDB, its role in advancing structural biology, and the substantial volume of data it currently archives.\n\n---\n\n### GenBank\n\n.pull-left[\nAn annotated collection of all publicly available DNA sequences, which comprises the DNA DataBank of Japan (DDBJ), the European Nucleotide Archive (ENA), and GenBank at NCBI\n]\n\n.pull-right[\n![A graph showing that both the number of GenBank sequences and the number of NCBI web users has been constantly growing from 1989 to 2019, reaching more than 200 millions sequences and 6 millions users.](https://www.researchgate.net/publication/343364994/figure/fig2/AS:919700666073090@1596285134479/Growth-of-GenBank-sequences-and-NCBI-web-users-through-2019-Figure-borrowed-from-the.png)\n]\n\n???\n\nGenBank stands as a critical resource for DNA sequences. It collaborates with other databases,\nsuch as DDBJ and ENA, to provide a comprehensive collection of publicly available DNA sequences.\n\n---\n\n## Biological knowledge\n\n.pull-left[\nUnderstanding about biological entities comes from crossing the information from/to these different resources and formats\n]\n\n.pull-right[\n![New knowledge comes from merging and crossing different levels of information about a protein, the schema mentions: the sequence (plain, conservation), structure, genomic information (conservation, location, regulation), function.](./images/merged-info.png)\n]\n\n???\n\nAn intricate web of information exists around biological entities, and understanding them involves merging\ninsights from various resources. A big part of some bioinformaticians' job is to integrate information from different\ndatabases and formats to gain a holistic understanding of biological entities.\n\n---\n\n## Features of biological databases\n\n- Data heterogeneity\n- High volume of data\n- Large scale data integration\n- Data sharing / user visualisation and navigation\n- Uncertainty / data quality measure needed\n- Dynamic and subject to change\n\n???\n\nBiological databases are characterized by a range of features that reflect the complexity of biological data.\nBiological databases face the challenges of handling data heterogeneity, ensuring data quality, and accommodating the dynamic nature of biological information.\n\n---\n\n## Possible classifications of biological databases\n\n.pull-left[\n- Data type\n- Data access\n- Data source\n- ...\n]\n\n--\n\n.pull-right[\n**Data type**\n\n- Genome database\n- Sequence database\n- Structure database\n- Pathway database\n- Disease database\n- ...\n]\n\n???\n\nClassifying biological databases helps us categorize and understand their diverse nature. There might be various\nways of classifying databases, such as by data type, data access, and data source.\n\nThe world of biological data is rich with different file formats designed to accommodate diverse types of information,\nincluding those for sequences, alignments, features/annotations, and protein structures.\n\n\n---\n\n## Possible classifications of biological databases\n\n.pull-left[\n- Data type\n- Data access\n- Data source\n- ...\n]\n\n.pull-right[\n**Data access**\n\n- Publicly available (browsing, downloading)\n- Freely accessible and reusable under a license\n- License open to certain usages (e.g. academic)\n- Proprietary / commercial\n- Restricted to certain people / institutions\n- ...\n]\n\n???\n\n\n---\n\n## Possible classifications of biological databases\n\n.pull-left[\n- Data type\n- Data access\n- Data source\n- ...\n]\n\n.pull-right[\n**Data source**\n\n- Primary databases (GenBank, PDB)\n- Secondary databases: analysed/aggregated results of the primary ones (UniProtKB)\n- Composite database: non-redundant / filtered data (SwissProt)\n- ...\n]\n\n---\n\n# Biological file formats\n\n- Sequence formats\n- Alignment formats\n- Features/annotations formats\n- Structure formats\n\n???\n\nIn the following tutorials, we'll explore some of the most commonly used biological file formats in detail.\nWe'll provide examples and explanations for each format, helping you understand how they store and represent different types of biological data.\n\n\n---\n\n## Sequence formats\n\n**FASTA**\n\nFile extensions: file.fa, file.fasta, file.fsa\n\nExample:\n\n```markdown\n>XR_002086427.1 Candida albicans SC5314 uncharacterized ncRNA (SCR1), ncRNA\n\nTGGCTGTGATGGCTTTTAGCGGAAGCGCGCTGTTCGCGTACCTGCTGTTTGTTGAAAATTTAAGAGCAAAGTGTCCGGCTCGATCCCTGCGAATTGAATTCTGAACGCTAGAGTAATCAGTGTCTTTCAAGTTCTGGTAATGTTTAGCATAACCACTGGAGGGAAGCAATTCAGCACAGTAATGCTAATCGTGGTGGAGGCGAATCCGGATGGCACCTTGTTTGTTGATAAATAGTGCGGTATCTAGTGTTGCAACTCTATTTTT\n```\n\n???\n\nFasta format is a simple way of representing nucleotide or amino acid sequences of nucleic acids and proteins.\nThis is a very basic format with two minimum lines. First line referred as comment line starts with ‘>’ and gives\nbasic information about sequence. There is no set format for comment line. Any other line that starts with ‘;’ will\nbe ignored. Lines with ‘;’ are not a common feature of fasta files. After comment line, sequence of nucleic acid or\nprotein is included in standard one letter code. Any tabulators, spaces, asterisks etc in sequence will be ignored.\n\n---\n\n## Sequence formats\n\n**FASTQ**\n\nFile extensions: ile.fastq, file.sanfastq, file.fq\n\nExample:\n\n```markdown\n@K00188:208:HFLNGBBXX:3:1101:1428:1508 2:N:0:CTTGTA\nATAATAGGATCCCTTTTCCTGGAGCTGCCTTTAGGTAATGTAGTATCTNATNGACTGNCNCCANANGGCTAAAGT\n+\nAAAFFJJJJJJJJJJJJJJJJJFJJFJJJJJFJJJJJJJJJJJJJJJJ#FJ#JJJJF#F#FJJ#F#JJJFJJJJJ\n```\n\n???\n\nFastq format was developed by Sanger institute in order to group together sequence and its quality scores (Q: phred quality score). In fastq files each entry is associated with 4 lines.\n\n- Line 1 begins with a ‘@‘ character and is a sequence identifier and an optional description.\n- Line 2 Sequence in standard one letter code.\n- Line 3 begins with a ‘+‘ character and is optionally followed by the same sequence identifier (and any additional description) again.\n- Line 4 encodes the quality values for the sequence in Line 2, and must contain the same number of symbols as letters in the sequence.\n\n---\n\n## Alignment formats\n\n**SAM (Sequence Alignment Map)**\n\nFile extensions: file.sam\n\nExample:\n\n```markdown\n1:497:R:-272+13M17D24M\t113\t1\t497\t37\t37M\t15\t100338662\t0\tCGGGTCTGACCTGAGGAGAACTGTGCTCCGCCTTCAG\t0;==-==9;>>>>>=>>>>>>>>>>>=>>>>>>>>>>\tXT:A:U\tNM:i:0\tSM:i:37\tAM:i:0\tX0:i:1\tX1:i:0\tXM:i:0\tXO:i:0\tXG:i:0\tMD:Z:37\n19:20389:F:275+18M2D19M\t99\t1\t17644\t0\t37M\t=\t17919\t314\tTATGACTGCTAATAATACCTACACATGTTAGAACCAT\t>>>>>>>>>>>>>>>>>>>><<>>><<>>4::>>:<9\tRG:Z:UM0098:1\tXT:A:R\tNM:i:0\tSM:i:0\tAM:i:0\tX0:i:4\tX1:i:0\tXM:i:0\tXO:i:0\tXG:i:0\tMD:Z:37\n19:20389:F:275+18M2D19M\t147\t1\t17919\t0\t18M2D19M\t=\t17644\t-314\tGTAGTACCAACTGTAAGTCCTTATCTTCATACTTTGT\t;44999;499<8<8<<<8<<><<<<><7<;<<<>><<\tXT:A:R\tNM:i:2\tSM:i:0\tAM:i:0\tX0:i:4\tX1:i:0\tXM:i:0\tXO:i:1\tXG:i:2\tMD:Z:18^CA19\n9:21597+10M2I25M:R:-209\t83\t1\t21678\t0\t8M2I27M\t=\t21469\t-244\tCACCACATCACATATACCAAGCCTGGCTGTGTCTTCT\t<;9<<5><<<<><<<>><<><>><9>><>>>9>>><>\tXT:A:R\tNM:i:2\tSM:i:0\tAM:i:0\tX0:i:5\tX1:i:0\tXM:i:0\tXO:i:1\tXG:i:2\tMD:Z:35\n```\n\n???\n\nThe SAM Format is a text format for storing sequence data in a series of tab delimited ASCII columns. Most often it is\ngenerated as a human readable version of its sister BAM format, which stores the same data in a compressed, indexed, binary form.\n\nSAM format files are generated following mapping of the reads to reference sequence. It is TAB-delimited text format\nwith header and a body. Header lines start with ‘@’ while alignment lines do not. Header hold generic information on\nSAM file along with version information, if the file is sorted, information on reference sequence, etc. The alignment\nrecords constitute the body of the file. Each alignment line/record has 11 mandatory fields describing essential alignment information.\n\n---\n\n## Alignment formats\n\n**BAM (Binary Alignment/Map)**\n\nFile extensions: file.bam\n\nA BAM file is the compressed binary version of the Sequence Alignment/Map (SAM).\n\n???\n\na compact and indexable representation of nucleotide sequence alignments. The data between SAM and BAM is exactly\nsame. Being Binary BAM files are small in size and ideal to store alignment files. Require samtools to view the file.\n\n---\n\n## Features/annotations formats\n\n**VCF (Variant Calling Format/File)**\n\nFile extensions: file.vcf\n\nExample:\n\n```markdown\n##fileformat=VCFv4.2\n##fileDate=20090805\n##source=myImputationProgramV3.1\n##reference=file:///seq/references/1000GenomesPilot-NCBI36.fasta\n##contig=<ID=20,length=62435964,assembly=B36,md5=f126cdf8a6e0c7f379d618ff66beb2da,species=\"Homo sapiens\",taxonomy=x>\n##phasing=partial\n##INFO=<ID=NS,Number=1,Type=Integer,Description=\"Number of Samples With Data\">\n##INFO=<ID=DP,Number=1,Type=Integer,Description=\"Total Depth\">\n##INFO=<ID=AF,Number=A,Type=Float,Description=\"Allele Frequency\">\n...\n20 14370 rs6054257 G A 29 PASS NS=3;DP=14;AF=0.5;DB;H2 GT:GQ:DP:HQ 0|0:48:1:51,51 1|0:48:8:51,51 1/1:43:5:.,.\n20 17330 . T A 3 q10 NS=3;DP=11;AF=0.017 GT:GQ:DP:HQ 0|0:49:3:58,50 0|1:3:5:65,3 0/0:41:3\n20 1110696 rs6040355 A G,T 67 PASS NS=2;DP=10;AF=0.333,0.667;AA=T;DB GT:GQ:DP:HQ 1|2:21:6:23,27 2|1:2:0:18,2 2/2:35:4\n20 1230237 . T . 47 PASS NS=3;DP=13;AA=T GT:GQ:DP:HQ 0|0:54:7:56,60 0|0:48:4:51,51 0/0:61:2\n20 1234567 microsat1 GTC G,GTCT 50 PASS NS=3;DP=9;AA=G GT:GQ:DP 0/1:35:4 0/2:17:2 1/1:40:3\n```\n\n???\n\nVCF is a text file format with a header (information VCF version, sample etc) and data lines constitute the body of file.\n\n---\n\n## Features/annotations formats\n\n**GFF (General Feature Format or Gene Finding Format)**\n\nFile extensions: file.gff2, file. gff3, file.gff\n\nExample (GFF2):\n\n```markdown\nbrowser position chr22:10000000-10025000\n\nbrowser hide all\n\ntrack name=regulatory description=\"TeleGene(tm) Regulatory Regions\"\n\nvisibility=2\n\nchr22 TeleGene enhancer 10000000 10001000 500 + . touch1\n\nchr22 TeleGene promoter 10010000 10010100 900 + . touch1\n\nchr22 TeleGene promoter 10020000 10025000 800 - . touch2\n```\n\n???\n\nGFF (General Feature Format or Gene Finding Format). GFF can be used for any kind of feature (Transcripts, exon,\nintron, promoter, 3’ UTR, repeatitive elements etc) associated with the sequence, whereas GTF is primarily for\ngenes/transcripts.  GFF3 is the latest version and an improvement over GFF2 format. However, many databases are\nstill not equipped to handle GFF3 version. The differences will be explained later in text.\n\nThe GFF format has 9 mandatory columns and they are TAB separated.\n- Col. 1 Reference Sequence\n- Col. 2 Source\n- Col. 3 Feature\n- Col. 4 Start\n- Col. 5 End\n- Col. 6 Score\n- Col. 7 Strand\n- Col. 8 Frame (GFF2 and GTF) or Phase (GFF3)\n- Col. 9  Attribute or Group field\n\n---\n\n## Features/annotations formats\n\n**BED (Browser Extensible Data)**\n\nThe BED (Browser Extensible Data) file format includes information about sequences that can be visualized in a genome\nbrowser; a feature called an annotation track. BED files are tabs-delimited and include 12 fields (columns) of data.\n\nExample of fields: name of chromosome or scaffold, starting position in the chromosome, the ending position...\n\n---\n\n## Features/annotations formats\n\n**PSI-MI**\n\nThe PSI MI format is a data exchange format for molecular interactions.\n\nExample of fields: interaction detection method, biological role, experimental features, location of the interaction, ...\n\n---\n\n## Features/annotations formats\n\n**PED**\n\nFile extensions: file.ped\n\nPED is a file format for pedigree analysis, which creates a familial relationship between different samples.\n\n---\n\n## Structure formats\n\n**PDB (Protein Data Bank formats)**\n\nFile extensions: file.pdb\n\nPDB file formats contain atomic coordinates and are used for storing 3D protein structures by the Protein Data Bank.\n\nExample:\n\n```markdown\nCOMPND    UNNAMED\nAUTHOR    GENERATED BY OPEN BABEL 2.3.2\nATOM      1  N   ALA A   1       0.000   0.000   0.000  1.00  0.00           N\nATOM      2  CA  ALA A   1       1.456   0.000   0.000  1.00  0.00           C\nATOM      3  C   ALA A   1       1.930   0.000   1.463  1.00  0.00           C\nATOM      4  O   ALA A   1       1.160   0.000   2.421  1.00  0.00           O\n...\nCONECT  101   98\nCONECT  102   94  103\nCONECT  103  102\nMASTER        0    0    0    0    0    0    0    0  103    0  103    0\nEND\n```\n\n---\n\n## Other formats\n\n**CSV**\n\nCSV (.csv file format) files stands for comma separated value and is a text file, where each line is a row and\ncolumns are delimited with a comma. It can store different types of sequencing data and can be opened using common\nspreadsheet programs.\n\n**JSON**\n\nJSON (JavaScript Object Notation) is a common file format for many other industries, but is used in a growing number\nof bioinformatics applications and web resources.\n\n**And the list of generic file formats goes on...**\n\n---\n\n## Why Are There So Many Different Types?\n\nThe many different ways of generating and using biological data have given rise to the diversity previously described.\nThese file formats have their own specific use cases depending on:\n\n- Compatibility with specific software\n- Data processing, parsing, and human readability needs\n- Efficiency for storage\n\n???\n\nIn conclusion, the multitude of biological file formats arises from the diverse needs and characteristics of biological data.\n"],"hands_on":true,"slides":true,"mod_date":"2023-11-03 14:30:27 +0000","pub_date":"2023-09-07 09:58:19 +0000","version":13,"api":"https://training.galaxyproject.org/training-material/api/topics/data-science/tutorials/online-resources-gene/tutorial.json","tools":["toolshed.g2.bx.psu.edu/repos/devteam/ncbi_blast_plus/ncbi_blastp_wrapper/2.10.1+galaxy2"],"supported_servers":{"exact":[{"url":"https://galaxy.mesocentre.uca.fr","name":"Galaxy@AuBi","usegalaxy":false},{"url":"https://usegalaxy.cz/","name":"UseGalaxy.cz","usegalaxy":false},{"url":"https://usegalaxy.eu","name":"UseGalaxy.eu","usegalaxy":true},{"url":"https://usegalaxy.fr/","name":"UseGalaxy.fr","usegalaxy":false},{"url":"https://usegalaxy.org","name":"UseGalaxy.org (Main)","usegalaxy":true},{"url":"https://usegalaxy.org.au","name":"UseGalaxy.org.au","usegalaxy":true}],"inexact":[{"url":"http://bf2i-galaxy.insa-lyon.fr:8080/","name":"BF2I-MAP","usegalaxy":false},{"url":"https://cpt.tamu.edu/galaxy-public/","name":"Center for Phage Technology (CPT)","usegalaxy":false},{"url":"https://galaxytrakr.org/","name":"GalaxyTrakr","usegalaxy":false},{"url":"https://mississippi.sorbonne-universite.fr","name":"MISSISSIPPI","usegalaxy":false},{"url":"http://pepsimili.e-nios.com:8080/","name":"PepSimili","usegalaxy":false},{"url":"https://galaxy.bio.di.uminho.pt/","name":"PhagePromotor","usegalaxy":false},{"url":"https://usegalaxy.be/","name":"UseGalaxy.be","usegalaxy":false},{"url":"https://usegalaxy.no/","name":"UseGalaxy.no","usegalaxy":false}]},"topic_name_human":"Foundations of Data Science","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"ncbi_blast_plus","owner":"devteam","revisions":"0e3cf9594bb7","tool_panel_section_label":"NCBI Blast","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: ncbi_blast_plus\n  owner: devteam\n  revisions: 0e3cf9594bb7\n  tool_panel_section_label: NCBI Blast\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":true,"slides_recordings":false,"translations":{"tutorial":[],"slides":[],"video":true},"license":"CC-BY-4.0","type":"tutorial","tags":["work-in-progress"],"contributors":[{"name":"Lisanna Paladin","joined":"2023-09","email":"lisanna.paladin@gmail.com","orcid":"0000-0003-0011-9397","id":"lisanna","url":"https://training.galaxyproject.org/training-material/api/contributors/lisanna.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/lisanna/"},{"name":"Bérénice Batut","email":"berenice.batut@gmail.com","twitter":"bebatut","linkedin":"berenicebatut","matrix":"bebatut:matrix.org","orcid":"0000-0001-9852-1987","joined":"2017-09","elixir_node":"fr","contact_for_training":true,"location":{"country":"FR","lat":45.77,"lon":3.08},"fediverse":"https://piaille.fr/@bebatut","fediverse_flavor":"mastodon","affiliations":["gallantries","ifb","elixir-europe"],"id":"bebatut","url":"https://training.galaxyproject.org/training-material/api/contributors/bebatut.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/bebatut/"},{"name":"Teresa Müller","joined":"2022-09","affiliations":["uni-freiburg","elixir-europe"],"id":"teresa-m","url":"https://training.galaxyproject.org/training-material/api/contributors/teresa-m.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/teresa-m/"},{"name":"BioNT","github":false,"joined":"2023-09","avatar":"http://biont-training.eu/assets/img/BioNT_Logo_Layout_2106_blue_Version_2_cropped.png","url":"https://training.galaxyproject.org/training-material/api/funders/biont.json","funder":true,"funding_id":"101100604","funding_system":"cordis","funding_statement":"Co-funded by the European Union","id":"biont","page":"https://training.galaxyproject.org/training-material/hall-of-fame/biont/"}]}