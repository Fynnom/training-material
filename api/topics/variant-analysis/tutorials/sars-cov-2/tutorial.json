{"layout":"tutorial_hands_on","title":"From NCBI's Sequence Read Archive (SRA) to Galaxy: SARS-CoV-2 variant analysis","subtopic":"one-health","questions":["How can you download public sequencing data deposited in the NCBI Sequence Read Archive (SRA) into a Galaxy history for analysis?","How can you process a batch of sequencing data from several samples efficiently/in parallel with Galaxy?","Starting from raw sequenced reads of whole-genome sequenced samples of SARS-CoV-2, how can you identify mutations in the genomes of these samples?"],"objectives":["Understand how Galaxy and the Sequence Read Archive interact","Be able to go from Galaxy to the Short Reach Archive, query SRA, use the SRA Run Selector to send selected metadata to Galaxy, and then import sequence data from SRA into Galaxy","Understand how collections enable processing of sequencing data in batches","Understand the analysis steps required to identify and annotate genomic mutations from sequencing data of SARS-CoV-2 samples"],"time_estimation":"1H","key_points":["Sequence data in the SRA can be directly imported into Galaxy","Collections enable efficient/parallel processing of sequence data from whole batches of samples","Genomic mutations in SARS-CoV-2 viral isolates can be identified through a straightforward pipeline involving sequenced reads preprocessing, mapping to the SARS-CoV-2 reference genome, postprocessing of mapping results, and variant calling"],"tags":["covid19","virology","one-health"],"contributions":{"authorship":["mvdbeek","tnabtaf","blankenberg","nekrut"],"editing":["wm75"]},"recordings":[{"captioners":["nekrut"],"date":"2021-02-15","galaxy_version":"21.01","length":"15M","youtube_id":"9mIL0tIfZ_o","speakers":["nekrut"]}],"js_requirements":{"mathjax":null,"mermaid":false},"short_id":"T00315","url":"/topics/variant-analysis/tutorials/sars-cov-2/tutorial.html","topic_name":"variant-analysis","tutorial_name":"sars-cov-2","dir":"topics/variant-analysis/tutorials/sars-cov-2","symlink":null,"id":"variant-analysis/sars-cov-2","ref_tutorials":["<p>The aim of this tutorial is twofold:</p>\n\n<ol>\n  <li>It introduces general patterns of working with high-throughput sequencing data in Galaxy,</li>\n  <li>It uses SARS-CoV-2 sequencing data analysis as a concrete example of how to identify genomic mutations from high-throughput sequencing data for a batch of viral isolates in Galaxy.</li>\n</ol>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n  <p>In this tutorial, we will cover:</p>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#prepare-analysis-history-and-data\" id=\"markdown-toc-prepare-analysis-history-and-data\">Prepare analysis history and data</a>    <ol>\n      <li><a href=\"#create-a-new-history-for-this-analysis\" id=\"markdown-toc-create-a-new-history-for-this-analysis\">Create a new history for this analysis</a></li>\n      <li><a href=\"#find-obtain-and-filter-information-about-public-sequencing-data\" id=\"markdown-toc-find-obtain-and-filter-information-about-public-sequencing-data\">Find, obtain and filter information about public sequencing data</a></li>\n      <li><a href=\"#retrieve-selected-sequencing-data-from-the-sra\" id=\"markdown-toc-retrieve-selected-sequencing-data-from-the-sra\">Retrieve selected sequencing data from the SRA</a></li>\n      <li><a href=\"#get-the-reference-genome-data\" id=\"markdown-toc-get-the-reference-genome-data\">Get the reference genome data</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#identification-of-mutations-in-the-batch-of-sars-cov-2-sequencing-data\" id=\"markdown-toc-identification-of-mutations-in-the-batch-of-sars-cov-2-sequencing-data\">Identification of mutations in the batch of SARS-Cov-2 sequencing data</a>    <ol>\n      <li><a href=\"#adapter-trimming-with-fastp\" id=\"markdown-toc-adapter-trimming-with-fastp\">Adapter trimming with <strong>fastp</strong></a></li>\n      <li><a href=\"#alignment-with-map-with-bwa-mem\" id=\"markdown-toc-alignment-with-map-with-bwa-mem\">Alignment with <strong>Map with BWA-MEM</strong></a></li>\n      <li><a href=\"#remove-duplicates-with-markduplicates\" id=\"markdown-toc-remove-duplicates-with-markduplicates\">Remove duplicates with <strong>MarkDuplicates</strong></a></li>\n      <li><a href=\"#generate-alignment-statistics-with-samtools-stats\" id=\"markdown-toc-generate-alignment-statistics-with-samtools-stats\">Generate alignment statistics with <strong>Samtools stats</strong></a></li>\n      <li><a href=\"#realign-reads-with-lofreq-viterbi\" id=\"markdown-toc-realign-reads-with-lofreq-viterbi\"><strong>Realign reads</strong> with lofreq viterbi</a></li>\n      <li><a href=\"#add-indel-qualities-with-lofreq-insert-indel-qualities\" id=\"markdown-toc-add-indel-qualities-with-lofreq-insert-indel-qualities\">Add indel qualities with lofreq <strong>Insert indel qualities</strong></a></li>\n      <li><a href=\"#call-variants-using-lofreq-call-variants\" id=\"markdown-toc-call-variants-using-lofreq-call-variants\">Call Variants using lofreq <strong>Call variants</strong></a></li>\n      <li><a href=\"#annotate-variant-effects-with-snpeff-eff\" id=\"markdown-toc-annotate-variant-effects-with-snpeff-eff\">Annotate variant effects with <strong>SnpEff eff:</strong></a></li>\n      <li><a href=\"#create-table-of-variants-using-snpsift-extract-fields\" id=\"markdown-toc-create-table-of-variants-using-snpsift-extract-fields\">Create table of variants using <strong>SnpSift Extract Fields</strong></a></li>\n      <li><a href=\"#summarize-data-with-multiqc\" id=\"markdown-toc-summarize-data-with-multiqc\">Summarize data with <strong>MultiQC</strong></a></li>\n    </ol>\n  </li>\n  <li><a href=\"#conclusion\" id=\"markdown-toc-conclusion\">Conclusion</a></li>\n</ol>\n\n</blockquote>\n\n<h1 id=\"prepare-analysis-history-and-data\">Prepare analysis history and data</h1>\n\n<h2 id=\"create-a-new-history-for-this-analysis\">Create a new history for this analysis</h2>\n\n<p>Any analysis should get its own Galaxy history. So let’s start by creating a new one:</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Prepare the Galaxy history</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Create a new history for this analysis</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-new-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-new-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a new history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>Click the <i class=\"fas fa-plus\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">new-history</span> icon at the top of the history panel:</p>   <p><img src=\"/training-material/shared/images/history_create_new.svg\" alt=\"UI for creating new history\" /></p>   <!-- the original drawing can be found here https://docs.google.com/drawings/d/1cCBrLAo4kDGic5QyB70rRiWJAKTenTU8STsKDaLcVU8/edit?usp=sharing --> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Rename the history</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-renaming-a-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-renaming-a-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Renaming a history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ol>   <li>Click on <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> (<strong>Edit</strong>) next to the history name (which by default is “Unnamed history”)</li>   <li>Type the new name: <code class=\"language-plaintext highlighter-rouge\">SARS-CoV-2 sequence data analysis</code></li>   <li>Click on <strong>Save</strong></li> </ol>   <p>If you do not have the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> (<strong>Edit</strong>) next to the history name:</p>   <ol>   <li>Click on <strong>Unnamed history</strong> (or the current name of the history) (<strong>Click to rename history</strong>) at the top of your history panel</li>   <li>Type the new name: <code class=\"language-plaintext highlighter-rouge\">SARS-CoV-2 sequence data analysis</code></li>   <li>Press <kbd>Enter</kbd></li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h2 id=\"find-obtain-and-filter-information-about-public-sequencing-data\">Find, obtain and filter information about public sequencing data</h2>\n\n<p>First we need to find some good, public datasets to play with.</p>\n\n<p>The <a href=\"https://www.ncbi.nlm.nih.gov/sra\">Sequence Read Archive (SRA)</a> is the primary archive of <em>unassembled reads</em>  operated by the <a href=\"https://www.ncbi.nlm.nih.gov/\">US National Institutes of Health (NIH)</a>.\nSRA is a great place to get the sequencing data that underlie publications and studies.\nThe study we are interested in for this tutorial is one on sequencing of SARS-CoV-2 viral isolates that were obtained in the Boston area in the first months of the COVID-19 pandemic (<span class=\"citation\"><a href=\"#Lemieux2021\">Lemieux <i>et al.</i> 2021</a></span>).</p>\n\n<p>So lets see how we can find its raw data in the SRA, and how we can get some of that data into Galaxy to analyze it. The Acknowledgments section of the publication mentions that raw reads from the study have been deposited in the SRA under <strong>BioProject PRJNA622837</strong> so that’s going to be our starting point.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Find the example data in the SRA</hands-on-title>\n\n  <ol>\n    <li>Go to NCBI’s SRA page by pointing your browser to <a href=\"https://www.ncbi.nlm.nih.gov/sra\">https://www.ncbi.nlm.nih.gov/sra</a></li>\n    <li>\n      <p>In the search box enter <code class=\"language-plaintext highlighter-rouge\">PRJNA622837[BioProject]</code></p>\n\n      <p>Oh, this finds a <em>lot</em> of samples (more than 22,000 at the time of writing)!\nThis is because the BioProject ID we used is that of “SARS-CoV-2 Patient Sequencing from the Broad Institute”, which has seen many more sample submissions since the published study.\nLet’s refine our search a bit.</p>\n    </li>\n    <li>\n      <p>Replace your previous search with <code class=\"language-plaintext highlighter-rouge\">PRJNA622837[BioProject] AND RNA-Seq[Strategy]</code></p>\n\n      <p>This returns only those samples from the BioProject, for which the sequencing strategy was RNA-Seq.</p>\n\n      <p>At the time of writing, 1908 hits are retained with this query, which is still more than the approximately 800 genomes mentioned in the publication, but we got a lot closer.</p>\n\n      <blockquote class=\"comment\">\n        <comment-title></comment-title>\n\n        <p>The vast majority of what has been excluded by adding <code class=\"language-plaintext highlighter-rouge\">RNA-Seq[Strategy]</code> to the query are datasets for which the “Strategy” is <em>AMPLICON</em>.\nFor these datasets, the viral RNA (or more precisely, the cDNA obtained from it) got amplified with a tiled-amplicon protocol.\nWhile tiled-amplicon sequencing has emerged as a standard way of sequencing SARS-CoV-2 samples over the course of the pandemic, the corresponding protocols/primer schemes were simply not available during the early phase of the pandemic.</p>\n\n      </blockquote>\n    </li>\n    <li>Instead of inspecting all 1908 hits one-by-one through the web interface, lets download the metadata for all samples in a single file\n      <ol>\n        <li>Click on the  <strong>Send to:</strong> dropdown at the top of the search results list</li>\n        <li>Under <strong>Choose Destination</strong>, select <code class=\"language-plaintext highlighter-rouge\">Run Selector</code></li>\n        <li>Click <strong>Go</strong></li>\n      </ol>\n\n      <p><a href=\"../../images/get_runinfo.png\" rel=\"noopener noreferrer\"><img src=\"../../images/get_runinfo.png\" alt=\"SRA search results with the &quot;Send to:&quot; dropdown configured for sending results to the Run Selector. \" width=\"779\" height=\"400\" loading=\"lazy\" /></a></p>\n\n      <p>You will be taken to the SRA Run Selector page, where you can browse all of the metadata of all search hits rather conveniently.</p>\n    </li>\n    <li>\n      <p>In the <strong>Select</strong> table, click <code class=\"language-plaintext highlighter-rouge\">Metadata</code> in the <strong>Download</strong> column</p>\n\n      <p><a href=\"../../images/metadata_from_run_selector.png\" rel=\"noopener noreferrer\"><img src=\"../../images/metadata_from_run_selector.png\" alt=\"The SRA Run Selector page with the mouse hovering over the Metadata button. \" width=\"864\" height=\"604\" loading=\"lazy\" /></a></p>\n\n      <p>This will download the metadata for all retrieved sequencing runs as a comma-separated text file.</p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>Now that we have downloaded this file we can go to a Galaxy instance and start processing it.</p>\n\n<blockquote class=\"comment\">\n  <comment-title></comment-title>\n\n  <p>Note that the file we just downloaded is <strong>not</strong> sequencing data itself. Rather, it is <em>metadata</em> describing the data itself. We will use a few Galaxy tools to filter this list down to just a few accessions that will be used in the remainder of this tutorial.</p>\n\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Upload the metadata file into Galaxy</hands-on-title>\n\n  <ol>\n    <li>\n      <p>In Galaxy, click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong></p>\n\n      <p><a href=\"../../images/upload_button.png\" rel=\"noopener noreferrer\"><img src=\"../../images/upload_button.png\" alt=\"The Upload Data button in Galaxy. \" width=\"313\" height=\"177\" loading=\"lazy\" /></a></p>\n    </li>\n    <li>\n      <p>In the Upload dialog box, click <strong>Choose local files</strong></p>\n\n      <p><a href=\"../../images/choose_local_files_button.png\" rel=\"noopener noreferrer\"><img src=\"../../images/choose_local_files_button.png\" alt=\"The Choose local files button. \" width=\"156\" height=\"43\" loading=\"lazy\" /></a></p>\n    </li>\n    <li>Find and select the downloaded metadata file on your computer</li>\n    <li>Click <strong>Start</strong></li>\n    <li>Close the dialog by pressing <strong>Close</strong></li>\n    <li>\n      <p>Once the dataset has finished uploading to your history, you can <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> inspect its contents.</p>\n\n      <p>You will see that this file contains the same metadata that you could preview on the SRA Run Selector page.</p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>In Galaxy, it is rather easy to perform further filtering of the metadata records. For example, the publication mentions that the authors analyzed samples collected between 4 March and 9 May 2020.</p>\n\n<p>If you inspect the metadata, you should see a column <strong>Collection_Date</strong>. That looks useful!</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Filter metadata lines by collection date range</hands-on-title>\n\n  <ol>\n    <li>\n      <p><span class=\"tool\" data-tool=\"Filter1\" title=\"Filter data on any column using simple expressions tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Filter data on any column using simple expressions</strong></span></p>\n\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Filter”</em>: the uploaded metadata</li>\n        <li>\n          <p><em>“With following condition”</em>: <code class=\"language-plaintext highlighter-rouge\">\"2020-03-04\" &lt;= c11 &lt;= \"2020-05-09\"</code></p>\n\n          <p>Column 11 (c11) is the Collection_Date column in this case.\nIf your input has this column in a different position, you would need to adjust the filter condition above accordingly.</p>\n        </li>\n        <li><em>“Number of header lines to skip”</em>: <code class=\"language-plaintext highlighter-rouge\">1</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>So now we are down to sequencing runs from the same date range as studied in the publication - though we still have more runs than samples discussed in the publication. Note, however, that the publication talks about assembled genomes, and it is possible that some of the sequencing runs listed in our metadata do not contain good enough data to assemble any SARS-CoV-2 genome information, or it could be that some viral samples got sequenced in several sequencing runs to obtain enough data.</p>\n\n<p>We could explore this situation in more detail, and Galaxy could also process all the sequencing runs we are currently left with, but for the sake of simplicity of the tutorial, we want to select a <em>much</em> smaller subset of sequencing runs now anyway. In particular, from previous experience with this data we suggest to continue with just the following two interesting datasets: <strong>SRR11954102</strong> and <strong>SRR12733957</strong>. So let’s pull their identifiers out of the metadata file.</p>\n\n<blockquote class=\"comment\">\n  <comment-title></comment-title>\n  <p>The following steps may seem a bit silly given that we just revealed the two identifiers above.\nHowever, think of them as placeholders for extracting run identifiers based on some other criteria.</p>\n\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Extracting a subset of identifiers</hands-on-title>\n\n  <ol>\n    <li>\n      <p><span class=\"tool\" data-tool=\"Grep1\" title=\"Select lines that match an expression tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Select lines that match an expression</strong></span></p>\n\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Select lines from”</em>: the metadata filter by collection date; output of <strong>Filter</strong> tool</li>\n        <li><em>“that”</em>: <code class=\"language-plaintext highlighter-rouge\">Matching</code></li>\n        <li><em>“the pattern”</em>: <code class=\"language-plaintext highlighter-rouge\">SRR12733957|SRR11954102</code></li>\n      </ul>\n    </li>\n    <li>\n      <p><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_cut_tool/1.1.0\" title=\"Advanced Cut tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Advanced Cut</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.1.0)</span></p>\n\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“File to cut”</em>: the metadata with only two runs retained; output of <strong>Select</strong> tool</li>\n        <li>Under <em>“Cut by”</em>\n          <ul>\n            <li><em>“List of Fields”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 1</code></li>\n          </ul>\n        </li>\n      </ul>\n\n      <!--SNIPPET-->\n      <blockquote class=\"warning\">   <div class=\"box-title warning-title\" id=\"warning-beware-of-cuts\"><i class=\"fas fa-exclamation-triangle\" aria-hidden=\"true\"></i> Warning: Beware of Cuts</div>   <p>The section below uses <strong>Cut</strong> tool. There are two <strong>cut</strong> tools in Galaxy due to historical reasons. This example uses tool with the full name <strong>Cut columns from a table (cut)</strong>. However, the same logic applies to the other tool. It simply has a slightly different interface.</p> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>At this point, you should have a dataset with just two lines and a single column with this content:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>SRR12733957\nSRR11954102\n</code></pre></div></div>\n\n<h2 id=\"retrieve-selected-sequencing-data-from-the-sra\">Retrieve selected sequencing data from the SRA</h2>\n\n<p>Now that we have our identifiers of interest extracted, we are ready to download the actual sequencing data. Since this is a very common need Galaxy offers a dedicated tool for the purpose of downloading sequencing data from the SRA identified via its run accession.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Retrieve sequencing data from SRA via run accessions</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/sra_tools/fasterq_dump/3.0.3+galaxy0\" title=\"Faster Download and Extract Reads in FASTQ tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Faster Download and Extract Reads in FASTQ</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 3.0.3+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><em>“select input type”</em>: <code class=\"language-plaintext highlighter-rouge\">List of SRA accession, one per line</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“sra accession list”</em>: the dataset with the two run accessions; output of <strong>Cut</strong></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>Several entries should have been created in your history panel when you submitted the previous job:</p>\n<ul>\n  <li><strong>Pair-end data (fasterq-dump)</strong>: Contains Paired-end datasets (if available)</li>\n  <li><strong>Single-end data (fasterq-dump)</strong> Contains Single-end datasets (if available)</li>\n  <li><strong>Other data (fasterq-dump)</strong> Contains Unpaired datasets (if available)</li>\n  <li><strong>fasterq-dump log</strong> Contains Information about the tool execution</li>\n</ul>\n\n<p>The first three items are actually <em>collections</em> of datasets.</p>\n\n<p>When the tool run is finished (all history items created by it are green / done), take a moment to explore the collections by first <strong>clicking</strong> on the collection name in the history panel.  This takes you inside the collection and shows you the datasets in it.  You can then navigate back to the outer level of your history.</p>\n\n<p>You should find that only the <strong>Pair-end data</strong> collection contains any sequencing data, which makes sense as both samples have been paired-end sequenced on the Illumina platform.</p>\n\n<h2 id=\"get-the-reference-genome-data\">Get the reference genome data</h2>\n\n<p>Since our data analysis will involve mapping the sequenced reads just downloaded to the SARS-CoV-2 reference, we also need to obtain that reference now.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Get the reference genome data</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Import the following file into your history:</p>\n\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/009/858/895/GCF_009858895.2_ASM985889v3/GCF_009858895.2_ASM985889v3_genomic.fna.gz\n</code></pre></div>      </div>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-via-links\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-via-links\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing via links</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h1 id=\"identification-of-mutations-in-the-batch-of-sars-cov-2-sequencing-data\">Identification of mutations in the batch of SARS-Cov-2 sequencing data</h1>\n\n<p>As our actual analysis we will now perform all steps necessary to identify mutations present in the genomes of our minimal batch of two samples with respect to the SARS-CoV-2 Wuhan-Hu-1 reference sequence.</p>\n\n<p>We will perform quality control and read trimming, map the reads from both samples to the reference, and perform variant calling. Finally we will annotate each sample’s variants with their predicted functional impact and report our findings in a table.</p>\n\n<p>We will also summarize different quality metrics obtained throughout the analysis in one nice summary report.</p>\n\n<h2 id=\"adapter-trimming-with-fastp\">Adapter trimming with <strong>fastp</strong></h2>\n\n<p>Removing sequencing adapters improves alignments and variant calling. <strong>fastp</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> can automatically detect widely used sequencing adapters.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Task description</hands-on-title>\n\n  <ol>\n    <li><strong>fastp</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters:\n      <ul>\n        <li><em>“Single-end or paired reads”</em>: <code class=\"language-plaintext highlighter-rouge\">Paired Collection</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Select paired collection(s)”</em>: <code class=\"language-plaintext highlighter-rouge\">list_paired</code> (output of <strong>Faster Download and Extract Reads in FASTQ</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n          </ul>\n        </li>\n        <li>In <em>“Output Options”</em>:\n          <ul>\n            <li><em>“Output JSON report”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<h2 id=\"alignment-with-map-with-bwa-mem\">Alignment with <strong>Map with BWA-MEM</strong></h2>\n\n<p><strong>BWA-MEM</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> is a widely used sequence aligner for short-read sequencing datasets such as those we are analysing in this tutorial.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Align sequencing reads to reference genome</hands-on-title>\n\n  <ol>\n    <li><strong>Map with BWA-MEM</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters:\n      <ul>\n        <li><em>“Will you select a reference genome from your history or use a built-in index?”</em>: <code class=\"language-plaintext highlighter-rouge\">Use a genome from history and build index</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Use the following dataset as the reference sequence”</em>: <code class=\"language-plaintext highlighter-rouge\">output</code> (Input dataset)</li>\n          </ul>\n        </li>\n        <li><em>“Single or Paired-end reads”</em>: <code class=\"language-plaintext highlighter-rouge\">Paired Collection</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Select a paired collection”</em>: <code class=\"language-plaintext highlighter-rouge\">output_paired_coll</code> (output of <strong>fastp</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n          </ul>\n        </li>\n        <li><em>“Set read groups information?”</em>: <code class=\"language-plaintext highlighter-rouge\">Do not set</code></li>\n        <li><em>“Select analysis mode”</em>: <code class=\"language-plaintext highlighter-rouge\">1.Simple Illumina mode</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h2 id=\"remove-duplicates-with-markduplicates\">Remove duplicates with <strong>MarkDuplicates</strong></h2>\n\n<p><strong>MarkDuplicates</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> removes duplicate sequences originating from library preparation artifacts and sequencing artifacts. It is important to remove these artefactual sequences to avoid artificial overrepresentation of single molecule.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Remove PCR duplicates</hands-on-title>\n\n  <ol>\n    <li><strong>MarkDuplicates</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Select SAM/BAM dataset or dataset collection”</em>: <code class=\"language-plaintext highlighter-rouge\">bam_output</code> (output of <strong>Map with BWA-MEM</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“If true do not write duplicates to the output file instead of writing them with appropriate flags set”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h2 id=\"generate-alignment-statistics-with-samtools-stats\">Generate alignment statistics with <strong>Samtools stats</strong></h2>\n\n<p>After the duplicate marking step above we can generate statistic about the alignment we have generated.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Generate alignment statistics</hands-on-title>\n\n  <ol>\n    <li><strong>Samtools stats</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“BAM file”</em>: <code class=\"language-plaintext highlighter-rouge\">outFile</code> (output of <strong>MarkDuplicates</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Set coverage distribution”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n        <li><em>“Output”</em>: <code class=\"language-plaintext highlighter-rouge\">One single summary file</code></li>\n        <li><em>“Filter by SAM flags”</em>: <code class=\"language-plaintext highlighter-rouge\">Do not filter</code></li>\n        <li><em>“Use a reference sequence”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n        <li><em>“Filter by regions”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<h2 id=\"realign-reads-with-lofreq-viterbi\"><strong>Realign reads</strong> with lofreq viterbi</h2>\n\n<p><strong>Realign reads</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> corrects misalignments around insertions and deletions. This is required in order to accurately detect variants.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Realign reads around indels</hands-on-title>\n\n  <ol>\n    <li><strong>Realign reads</strong> with lofreq <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Reads to realign”</em>: <code class=\"language-plaintext highlighter-rouge\">outFile</code> (output of <strong>MarkDuplicates</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Choose the source for the reference genome”</em>: <code class=\"language-plaintext highlighter-rouge\">History</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Reference”</em>: <code class=\"language-plaintext highlighter-rouge\">output</code> (Input dataset)</li>\n          </ul>\n        </li>\n        <li>In <em>“Advanced options”</em>:\n          <ul>\n            <li><em>“How to handle base qualities of 2?”</em>: <code class=\"language-plaintext highlighter-rouge\">Keep unchanged</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<h2 id=\"add-indel-qualities-with-lofreq-insert-indel-qualities\">Add indel qualities with lofreq <strong>Insert indel qualities</strong></h2>\n\n<p>This step adds indel qualities into our alignment file. This is necessary in order to call variants using <strong>Call variants</strong> with lofreq <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Add indel qualities</hands-on-title>\n\n  <ol>\n    <li><strong>Insert indel qualities</strong> with lofreq <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Reads”</em>: <code class=\"language-plaintext highlighter-rouge\">realigned</code> (output of <strong>Realign reads</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Indel calculation approach”</em>: <code class=\"language-plaintext highlighter-rouge\">Dindel</code>\n          <ul>\n            <li><em>“Choose the source for the reference genome”</em>: <code class=\"language-plaintext highlighter-rouge\">History</code>\n              <ul>\n                <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Reference”</em>: <code class=\"language-plaintext highlighter-rouge\">output</code> (Input dataset)</li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h2 id=\"call-variants-using-lofreq-call-variants\">Call Variants using lofreq <strong>Call variants</strong></h2>\n\n<p>We are now ready to call variants.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Call variants</hands-on-title>\n\n  <ol>\n    <li><strong>Call variants</strong> with lofreq <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input reads in BAM format”</em>: <code class=\"language-plaintext highlighter-rouge\">output</code> (output of <strong>Insert indel qualities</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Choose the source for the reference genome”</em>: <code class=\"language-plaintext highlighter-rouge\">History</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Reference”</em>: <code class=\"language-plaintext highlighter-rouge\">output</code> (Input dataset)</li>\n          </ul>\n        </li>\n        <li><em>“Call variants across”</em>: <code class=\"language-plaintext highlighter-rouge\">Whole reference</code></li>\n        <li><em>“Types of variants to call”</em>: <code class=\"language-plaintext highlighter-rouge\">SNVs and indels</code></li>\n        <li><em>“Variant calling parameters”</em>: <code class=\"language-plaintext highlighter-rouge\">Configure settings</code>\n          <ul>\n            <li>In <em>“Coverage”</em>:\n              <ul>\n                <li><em>“Minimal coverage”</em>: <code class=\"language-plaintext highlighter-rouge\">50</code></li>\n              </ul>\n            </li>\n            <li>In <em>“Base-calling quality”</em>:\n              <ul>\n                <li><em>“Minimum baseQ”</em>: <code class=\"language-plaintext highlighter-rouge\">30</code></li>\n                <li><em>“Minimum baseQ for alternate bases”</em>: <code class=\"language-plaintext highlighter-rouge\">30</code></li>\n              </ul>\n            </li>\n            <li>In <em>“Mapping quality”</em>:\n              <ul>\n                <li><em>“Minimum mapping quality”</em>: <code class=\"language-plaintext highlighter-rouge\">20</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n        <li><em>“Variant filter parameters”</em>: <code class=\"language-plaintext highlighter-rouge\">Preset filtering on QUAL score + coverage + strand bias (lofreq call default)</code></li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<p>The output of this step is a collection of VCF files that can be visualized in a genome browser.</p>\n\n<h2 id=\"annotate-variant-effects-with-snpeff-eff\">Annotate variant effects with <strong>SnpEff eff:</strong></h2>\n\n<p>We will now annotate the variants we called in the previous step with the effect they have on the SARS-CoV-2 genome.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Annotate variant effects</hands-on-title>\n\n  <ol>\n    <li><strong>SnpEff eff:</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Sequence changes (SNPs, MNPs, InDels)”</em>: <code class=\"language-plaintext highlighter-rouge\">variants</code> (output of <strong>Call variants</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Output format”</em>: <code class=\"language-plaintext highlighter-rouge\">VCF (only if input is VCF)</code></li>\n        <li><em>“Create CSV report, useful for downstream analysis (-csvStats)”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        <li><em>“Annotation options”</em>: ``</li>\n        <li><em>“Filter output”</em>: ``</li>\n        <li><em>“Filter out specific Effects”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>The output of this step is a VCF file with added variant effects.</p>\n\n<h2 id=\"create-table-of-variants-using-snpsift-extract-fields\">Create table of variants using <strong>SnpSift Extract Fields</strong></h2>\n\n<p>We will now select various effects from the VCF and create a tabular file that is easier to understand for humans.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Create table of variants</hands-on-title>\n\n  <ol>\n    <li><strong>SnpSift Extract Fields</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Variant input file in VCF format”</em>: <code class=\"language-plaintext highlighter-rouge\">snpeff_output</code> (output of <strong>SnpEff eff:</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Fields to extract”</em>: <code class=\"language-plaintext highlighter-rouge\">CHROM POS REF ALT QUAL DP AF SB DP4 EFF[*].IMPACT EFF[*].FUNCLASS EFF[*].EFFECT EFF[*].GENE EFF[*].CODON</code></li>\n        <li><em>“multiple field separator”</em>: <code class=\"language-plaintext highlighter-rouge\">,</code></li>\n        <li><em>“empty field text”</em>: <code class=\"language-plaintext highlighter-rouge\">.</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h2 id=\"summarize-data-with-multiqc\">Summarize data with <strong>MultiQC</strong></h2>\n\n<p>We will now summarize our analysis with MultiQC, which generates a beautiful report for our data.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Summarize data</hands-on-title>\n\n  <ol>\n    <li><strong>MultiQC</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters:\n      <ul>\n        <li>In <em>“Results”</em>:\n          <ul>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Results”</em>\n              <ul>\n                <li><em>“Which tool was used generate logs?”</em>: <code class=\"language-plaintext highlighter-rouge\">fastp</code>\n                  <ul>\n                    <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Output of fastp”</em>: <code class=\"language-plaintext highlighter-rouge\">report_json</code> (output of <strong>fastp</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Results”</em>\n              <ul>\n                <li><em>“Which tool was used generate logs?”</em>: <code class=\"language-plaintext highlighter-rouge\">Samtools</code>\n                  <ul>\n                    <li>In <em>“Samtools output”</em>:\n                      <ul>\n                        <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Samtools output”</em>\n                          <ul>\n                            <li><em>“Type of Samtools output?”</em>: <code class=\"language-plaintext highlighter-rouge\">stats</code>\n                              <ul>\n                                <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Samtools stats output”</em>: <code class=\"language-plaintext highlighter-rouge\">output</code> (output of <strong>Samtools stats</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n                              </ul>\n                            </li>\n                          </ul>\n                        </li>\n                      </ul>\n                    </li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Results”</em>\n              <ul>\n                <li><em>“Which tool was used generate logs?”</em>: <code class=\"language-plaintext highlighter-rouge\">Picard</code>\n                  <ul>\n                    <li>In <em>“Picard output”</em>:\n                      <ul>\n                        <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Picard output”</em>\n                          <ul>\n                            <li><em>“Type of Picard output?”</em>: <code class=\"language-plaintext highlighter-rouge\">Markdups</code></li>\n                            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Picard output”</em>: <code class=\"language-plaintext highlighter-rouge\">metrics_file</code> (output of <strong>MarkDuplicates</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n                          </ul>\n                        </li>\n                      </ul>\n                    </li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Results”</em>\n              <ul>\n                <li><em>“Which tool was used generate logs?”</em>: <code class=\"language-plaintext highlighter-rouge\">SnpEff</code>\n                  <ul>\n                    <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Output of SnpEff”</em>: <code class=\"language-plaintext highlighter-rouge\">csvFile</code> (output of <strong>SnpEff eff:</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<h1 id=\"conclusion\">Conclusion</h1>\n\n<p>You have seen now how to import public sequencing data into Galaxy, and you have performed the basic steps of variant calling on a batch of RNA-Seq SARS-CoV-2 data.</p>\n\n<p>Galaxy allows you to do a lot more in terms of viral sequence data analysis though. Specifically, the advanced tutorial <a href=\"/training-material/topics/variant-analysis/tutorials/sars-cov-2-variant-discovery/tutorial.html\">Mutation calling, viral genome reconstruction and lineage/clade assignment from SARS-CoV-2 sequencing data</a> is highly recommended if you want to learn how to perform a complete and more automated analysis of SARS-CoV-2 sequencing data that does not stop at lists of identified mutations but also produces consensus sequences and lineage assignments for all samples in a batch. This tutorial also shows how to deal with input data other than Illumina paired-end-sequenced RNA-Seq data.</p>\n"],"ref_slides":[],"hands_on":true,"slides":false,"mod_date":"2024-05-29 15:37:52 +0000","pub_date":"2020-06-24 15:38:29 +0000","version":45,"workflows":[{"workflow":"main_workflow.ga","tests":false,"url":"https://training.galaxyproject.org/training-material/topics/variant-analysis/tutorials/sars-cov-2/workflows/main_workflow.ga","path":"topics/variant-analysis/tutorials/sars-cov-2/workflows/main_workflow.ga","wfid":"variant-analysis-sars-cov-2","wfname":"main_workflow","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/variant-analysis-sars-cov-2/versions/main_workflow","license":null,"creators":[],"name":"Simple COVID-19 - PE Variation","title":"Simple COVID-19 - PE Variation","test_results":null,"modified":"2024-06-20 00:05:31 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\nNC_045512.2 fasta file\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"ℹ️ Input Dataset\\nSRA Manifest\"];\n  style 1 stroke:#2c3143,stroke-width:4px;\n  2[\"Faster Download and Extract Reads in FASTQ\"];\n  1 -->|output| 2;\n  3[\"fastp\"];\n  2 -->|list_paired| 3;\n  4[\"Map with BWA-MEM\"];\n  3 -->|output_paired_coll| 4;\n  0 -->|output| 4;\n  5[\"MarkDuplicates\"];\n  4 -->|bam_output| 5;\n  6[\"Realign reads\"];\n  5 -->|outFile| 6;\n  0 -->|output| 6;\n  7[\"Samtools stats\"];\n  5 -->|outFile| 7;\n  8[\"Insert indel qualities\"];\n  6 -->|realigned| 8;\n  0 -->|output| 8;\n  2ca7c89b-999f-41dc-8037-e54e25959a7e[\"Output\\nRealigned Alignments with Indel Qualities\"];\n  8 --> 2ca7c89b-999f-41dc-8037-e54e25959a7e;\n  style 2ca7c89b-999f-41dc-8037-e54e25959a7e stroke:#2c3143,stroke-width:4px;\n  9[\"Call variants\"];\n  8 -->|output| 9;\n  0 -->|output| 9;\n  10[\"SnpEff eff:\"];\n  9 -->|variants| 10;\n  11[\"SnpSift Extract Fields\"];\n  10 -->|snpeff_output| 11;\n  06259137-eaa5-404a-923c-70ee5f1d89d4[\"Output\\nSnpSift tabular output\"];\n  11 --> 06259137-eaa5-404a-923c-70ee5f1d89d4;\n  style 06259137-eaa5-404a-923c-70ee5f1d89d4 stroke:#2c3143,stroke-width:4px;\n  12[\"MultiQC\"];\n  3 -->|report_json| 12;\n  7 -->|output| 12;\n  5 -->|metrics_file| 12;\n  10 -->|csvFile| 12;\n  758ffde5-7ddd-482a-88b2-1504f8335488[\"Output\\nMultiQC Report PE\"];\n  12 --> 758ffde5-7ddd-482a-88b2-1504f8335488;\n  style 758ffde5-7ddd-482a-88b2-1504f8335488 stroke:#2c3143,stroke-width:4px;"}],"api":"https://training.galaxyproject.org/training-material/api/topics/variant-analysis/tutorials/sars-cov-2/tutorial.json","tools":["Filter1","Grep1","toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_cut_tool/1.1.0","toolshed.g2.bx.psu.edu/repos/devteam/bwa/bwa_mem/0.7.17.1","toolshed.g2.bx.psu.edu/repos/devteam/picard/picard_MarkDuplicates/2.18.2.2","toolshed.g2.bx.psu.edu/repos/devteam/samtools_stats/samtools_stats/2.0.2+galaxy2","toolshed.g2.bx.psu.edu/repos/iuc/fastp/fastp/0.20.1+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/lofreq_call/lofreq_call/2.1.5+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/lofreq_indelqual/lofreq_indelqual/2.1.5+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/lofreq_viterbi/lofreq_viterbi/2.1.5+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/multiqc/multiqc/1.8+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/snpeff_sars_cov_2/snpeff_sars_cov_2/4.5covid19","toolshed.g2.bx.psu.edu/repos/iuc/snpsift/snpSift_extractFields/4.3+t.galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/sra_tools/fasterq_dump/2.10.7+galaxy1","toolshed.g2.bx.psu.edu/repos/iuc/sra_tools/fasterq_dump/3.0.3+galaxy0"],"supported_servers":{"exact":[{"url":"https://usegalaxy.eu","name":"UseGalaxy.eu","usegalaxy":true},{"url":"https://usegalaxy.org","name":"UseGalaxy.org (Main)","usegalaxy":true}],"inexact":[{"url":"https://mississippi.sorbonne-universite.fr","name":"MISSISSIPPI","usegalaxy":false},{"url":"https://usegalaxy.be/","name":"UseGalaxy.be","usegalaxy":false},{"url":"https://usegalaxy.cz/","name":"UseGalaxy.cz","usegalaxy":false},{"url":"https://usegalaxy.fr/","name":"UseGalaxy.fr","usegalaxy":false},{"url":"https://usegalaxy.no/","name":"UseGalaxy.no","usegalaxy":false},{"url":"https://usegalaxy.org.au","name":"UseGalaxy.org.au","usegalaxy":true}]},"topic_name_human":"Variant Analysis","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"text_processing","owner":"bgruening","revisions":"d698c222f354","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"bwa","owner":"devteam","revisions":"3fe632431b68","tool_panel_section_label":"Mapping","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"picard","owner":"devteam","revisions":"a1f0b3f4b781","tool_panel_section_label":"Picard","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"samtools_stats","owner":"devteam","revisions":"145f6d74ff5e","tool_panel_section_label":"SAM/BAM","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"fastp","owner":"iuc","revisions":"dbf9c561ef29","tool_panel_section_label":"FASTA/FASTQ","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"lofreq_call","owner":"iuc","revisions":"65432c3abf6c","tool_panel_section_label":"Variant Calling","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"lofreq_indelqual","owner":"iuc","revisions":"426d707dfc47","tool_panel_section_label":"Variant Calling","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"lofreq_viterbi","owner":"iuc","revisions":"aa35ee7f3ab2","tool_panel_section_label":"Variant Calling","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"multiqc","owner":"iuc","revisions":"bf675f34b056","tool_panel_section_label":"Quality Control","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"snpeff_sars_cov_2","owner":"iuc","revisions":"2a3a00c1fa0a","tool_panel_section_label":"Variant Calling","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"snpsift","owner":"iuc","revisions":"5fab4f81391d","tool_panel_section_label":"Variant Calling","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"sra_tools","owner":"iuc","revisions":"494b2ec08162","tool_panel_section_label":"Get Data","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"sra_tools","owner":"iuc","revisions":"4df8de2d0e48","tool_panel_section_label":"Get Data","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: text_processing\n  owner: bgruening\n  revisions: d698c222f354\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bwa\n  owner: devteam\n  revisions: 3fe632431b68\n  tool_panel_section_label: Mapping\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: picard\n  owner: devteam\n  revisions: a1f0b3f4b781\n  tool_panel_section_label: Picard\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: samtools_stats\n  owner: devteam\n  revisions: 145f6d74ff5e\n  tool_panel_section_label: SAM/BAM\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: fastp\n  owner: iuc\n  revisions: dbf9c561ef29\n  tool_panel_section_label: FASTA/FASTQ\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: lofreq_call\n  owner: iuc\n  revisions: 65432c3abf6c\n  tool_panel_section_label: Variant Calling\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: lofreq_indelqual\n  owner: iuc\n  revisions: 426d707dfc47\n  tool_panel_section_label: Variant Calling\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: lofreq_viterbi\n  owner: iuc\n  revisions: aa35ee7f3ab2\n  tool_panel_section_label: Variant Calling\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: multiqc\n  owner: iuc\n  revisions: bf675f34b056\n  tool_panel_section_label: Quality Control\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: snpeff_sars_cov_2\n  owner: iuc\n  revisions: 2a3a00c1fa0a\n  tool_panel_section_label: Variant Calling\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: snpsift\n  owner: iuc\n  revisions: 5fab4f81391d\n  tool_panel_section_label: Variant Calling\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: sra_tools\n  owner: iuc\n  revisions: 494b2ec08162\n  tool_panel_section_label: Get Data\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: sra_tools\n  owner: iuc\n  revisions: 4df8de2d0e48\n  tool_panel_section_label: Get Data\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":false,"slides_recordings":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial","contributors":[{"name":"Marius van den Beek","joined":"2018-06","id":"mvdbeek","url":"https://training.galaxyproject.org/training-material/api/contributors/mvdbeek.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/mvdbeek/"},{"name":"Dave Clements","joined":"2017-09","orcid":"0000-0002-9970-6657","id":"tnabtaf","url":"https://training.galaxyproject.org/training-material/api/contributors/tnabtaf.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/tnabtaf/"},{"name":"Daniel Blankenberg","twitter":"dblankenberg","orcid":"0000-0002-6833-9049","joined":"2018-07","id":"blankenberg","url":"https://training.galaxyproject.org/training-material/api/contributors/blankenberg.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/blankenberg/"},{"name":"Anton Nekrutenko","email":"anton@nekrut.org","joined":"2017-09","id":"nekrut","url":"https://training.galaxyproject.org/training-material/api/contributors/nekrut.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/nekrut/"},{"name":"Wolfgang Maier","orcid":"0000-0002-9464-6640","matrix":"wm75:matrix.org","joined":"2017-09","elixir_node":"de","fediverse":"https://scholar.social/@zerodivision","fediverse_flavor":"mastodon","affiliations":["by-covid","uni-freiburg","elixir-europe"],"id":"wm75","url":"https://training.galaxyproject.org/training-material/api/contributors/wm75.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/wm75/"}]}