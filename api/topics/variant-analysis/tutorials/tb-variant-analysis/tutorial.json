{
  "layout": "tutorial_hands_on",
  "title": "M. tuberculosis Variant Analysis",
  "subtopic": "one-health",
  "zenodo_link": "https://doi.org/10.5281/zenodo.3496437",
  "questions": [
    "How do we detect differences between a set of reads from _M. tuberculosis_ (Mtb) and the Mtb reference genome"
  ],
  "objectives": [
    "How should we filter those variants",
    "How can we predict drug resistance from those variants",
    "How do we annotate those variants"
  ],
  "time_estimation": "2h",
  "level": "Intermediate",
  "key_points": [
    "variants in _M. tuberculosis_ sequencing data can be discovered using common microbial bioinformatics tools",
    "it is not enough to just call variants, variant calling involves multiple quality control steps",
    "the choice of reference genome and some quality control procedures are species-specific, and require knowledge of the organism in question",
    "batches of samples can be processed using Galaxy dataset collections and workflows"
  ],
  "contributors": [
    {
      "name": "Peter van Heusden",
      "twitter": "pvanheus",
      "orcid": "0000-0001-6553-5274",
      "joined": "2017-09",
      "bio": "Research at the South African National Bioinformatics Institute",
      "id": "pvanheus",
      "url": "https://training.galaxyproject.org/training-material/api/contributors/pvanheus.json",
      "page": "https://training.galaxyproject.org/training-material/hall-of-fame/pvanheus/"
    },
    {
      "name": "Simon Gladman",
      "email": "simon.gladman@unimelb.edu.au",
      "joined": "2017-09",
      "elixir_node": "au",
      "orcid": "0000-0002-6100-4385",
      "in_memoriam": "<a href=\"https://www.biocommons.org.au/news/simon-gladman\">Simon Gladman, system administrator of UseGalaxy.org.au, passed away on November 26, 2022</a>\n\n<a href=\"https://galaxyproject.org/news/2022-11-28-simon-gladman/\">He was a fantastic teacher, tutorial author, system administrator, and warm and welcoming friend.</a> He contributed heavily to the Galaxy Training Network and especially the Galaxy Administration community over the years, we will miss him dearly. The GTN and GAT would not be what they are today, without him.\n\n“Have I told you about my watch?”",
      "id": "slugger70",
      "url": "https://training.galaxyproject.org/training-material/api/contributors/slugger70.json",
      "page": "https://training.galaxyproject.org/training-material/hall-of-fame/slugger70/"
    },
    {
      "name": "Thoba Lose",
      "joined": "2019-11",
      "id": "thobalose",
      "url": "https://training.galaxyproject.org/training-material/api/contributors/thobalose.json",
      "page": "https://training.galaxyproject.org/training-material/hall-of-fame/thobalose/"
    }
  ],
  "tags": [
    "prokaryote",
    "one-health",
    "microgalaxy",
    "tuberculosis"
  ],
  "edam_ontology": [
    "topic_0622",
    "topic_3301",
    "topic_0196",
    "topic_0199",
    "topic_3305",
    "topic_3324"
  ],
  "js_requirements": {
    "mathjax": null,
    "mermaid": false
  },
  "short_id": "T00319",
  "url": "/topics/variant-analysis/tutorials/tb-variant-analysis/tutorial.html",
  "topic_name": "variant-analysis",
  "tutorial_name": "tb-variant-analysis",
  "dir": "topics/variant-analysis/tutorials/tb-variant-analysis",
  "symlink": null,
  "id": "variant-analysis/tb-variant-analysis",
  "video_library": {
    "tutorial": {
      "description": "Variation in the genome of M. tuberculosis (Mtb) is associated with changes in phenotype, for example drug resistance and virulence. It is also useful for outbreak investigation as the single nucleotide polymorphisms (SNPs) in a sample can be used to build a phylogeny.",
      "materials": [
        {
          "link": "topics/variant-analysis/tutorials/tb-variant-analysis/tutorial.html",
          "type": "Tutorial"
        }
      ],
      "tags": [
        "variant-analysis",
        "tuberculosis"
      ],
      "type": "Tutorial",
      "versions": [
        {
          "captions": [
            "pvanheus",
            "nagoue",
            "hexylena"
          ],
          "date": "2021-02-15",
          "galaxy_version": "21.01",
          "length": "40M",
          "link": "G1DmquX6Wh8",
          "speakers": [
            "pvanheus"
          ]
        }
      ],
      "gtn_id": "variant-analysis/tb-variant-analysis",
      "title": "M. tuberculosis Variant Analysis",
      "captioned": true
    },
    "slides": {
      "description": "Tuberculosis (TB) is an infectious disease caused by the bacterium Mycobacterium tuberculosis. According to the WHO, in 2018 there were 10.0 million new cases of TB worldwide and 1.4 million deaths due to the disease, making TB the world’s most deadly infectious disease.",
      "materials": [
        {
          "external": true,
          "link": "https://docs.google.com/presentation/d/16XTMh2fRrl73WVaezNAFWET0IIMXBv0MCI2engFtdQs/edit#slide=id.g6231f48ea2_0_34",
          "type": "Slides"
        }
      ],
      "tags": [
        "variant-analysis"
      ],
      "type": "Lecture",
      "versions": [
        {
          "captions": [
            "shiltemann"
          ],
          "date": "2021-02-15",
          "galaxy_version": "21.01",
          "length": "20M",
          "link": "yCC9EmLuyJg",
          "speakers": [
            "pvanheus"
          ]
        }
      ],
      "gtn_id": "variant-analysis/tb-variant-analysis",
      "title": "M. tuberculosis Variant Analysis",
      "captioned": true
    },
    "demo": null,
    "both": null,
    "session": {
      "title": "Tuberculosis Variant Analysis",
      "description": "Variation in the genome of M. tuberculosis (Mtb) is associated with changes in phenotype, for example drug resistance and virulence. It is also useful for outbreak investigation as the single nucleotide polymorphisms (SNPs) in a sample can be used to build a phylogeny.",
      "videos": [
        "variant-analysis/tb-variant-analysis/slides",
        "variant-analysis/tb-variant-analysis/tutorial"
      ]
    }
  },
  "hands_on": true,
  "slides": false,
  "mod_date": "2024-06-10 17:04:54 +0000",
  "pub_date": "2020-07-25 20:58:54 +0000",
  "version": 72,
  "workflows": [
    {
      "workflow": "tb-variant-analysis.ga",
      "tests": true,
      "url": "https://training.galaxyproject.org/training-material/topics/variant-analysis/tutorials/tb-variant-analysis/workflows/tb-variant-analysis.ga",
      "path": "topics/variant-analysis/tutorials/tb-variant-analysis/workflows/tb-variant-analysis.ga",
      "wfid": "variant-analysis-tb-variant-analysis",
      "wfname": "tb-variant-analysis",
      "trs_endpoint": "https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/variant-analysis-tb-variant-analysis/versions/tb-variant-analysis",
      "license": "AGPL-3.0-or-later",
      "creators": [
        {
          "class": "Person",
          "identifier": "0000-0001-6553-5274",
          "name": "Peter van Heusden"
        }
      ],
      "name": "TB Variant Analysis v1.0",
      "title": "TB Variant Analysis v1.0",
      "test_results": null,
      "modified": "2024-06-11 06:15:34 +0000",
      "mermaid": "flowchart TD\n  0[\"ℹ️ Input Collection\\nReads\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"ℹ️ Input Dataset\\nReference Genome\"];\n  style 1 stroke:#2c3143,stroke-width:4px;\n  2[\"ℹ️ Input Parameter\\nMinimum depth of coverage\"];\n  style 2 fill:#ded,stroke:#393,stroke-width:4px;\n  3[\"ℹ️ Input Parameter\\nMinimum variant allele frequency\"];\n  style 3 fill:#ded,stroke:#393,stroke-width:4px;\n  4[\"ℹ️ Input Parameter\\nAdditional BWA-MEM options\"];\n  style 4 fill:#ded,stroke:#393,stroke-width:4px;\n  5[\"fastp\"];\n  0 -->|output| 5;\n  6[\"seqret\"];\n  1 -->|output| 6;\n  7[\"snippy\"];\n  4 -->|output| 7;\n  2 -->|output| 7;\n  3 -->|output| 7;\n  5 -->|output_paired_coll| 7;\n  1 -->|output| 7;\n  8[\"Kraken2\"];\n  5 -->|output_paired_coll| 8;\n  c7abf2bf-ed4c-433e-a695-9eca61282bb5[\"Output\\nreport_output\"];\n  8 --> c7abf2bf-ed4c-433e-a695-9eca61282bb5;\n  style c7abf2bf-ed4c-433e-a695-9eca61282bb5 stroke:#2c3143,stroke-width:4px;\n  083a0e51-7780-4c91-a071-dc0e4641d060[\"Output\\noutput\"];\n  8 --> 083a0e51-7780-4c91-a071-dc0e4641d060;\n  style 083a0e51-7780-4c91-a071-dc0e4641d060 stroke:#2c3143,stroke-width:4px;\n  9[\"QualiMap BamQC\"];\n  7 -->|snpsbam| 9;\n  10[\"mosdepth\"];\n  2 -->|output| 10;\n  7 -->|snpsbam| 10;\n  11[\"TB Variant Filter\"];\n  7 -->|snpvcf| 11;\n  12[\"TB-Profiler Profile\"];\n  7 -->|snpsbam| 12;\n  335635b4-a4de-4980-ad02-68f0035daeaa[\"Output\\noutput_txt\"];\n  12 --> 335635b4-a4de-4980-ad02-68f0035daeaa;\n  style 335635b4-a4de-4980-ad02-68f0035daeaa stroke:#2c3143,stroke-width:4px;\n  13[\"TB Variant Filter\"];\n  7 -->|snpvcf| 13;\n  14[\"Flatten collection\"];\n  9 -->|raw_data| 14;\n  15[\"Text reformatting\"];\n  10 -->|output_quantized_bed| 15;\n  16[\"Text transformation\"];\n  11 -->|output1| 16;\n  007df8c2-bd13-495f-8904-abf31d4594d0[\"Output\\nFinal annotated VCF\"];\n  16 --> 007df8c2-bd13-495f-8904-abf31d4594d0;\n  style 007df8c2-bd13-495f-8904-abf31d4594d0 stroke:#2c3143,stroke-width:4px;\n  17[\"MultiQC\"];\n  5 -->|report_json| 17;\n  14 -->|output| 17;\n  59528235-7525-4ef9-8810-36f1ed0f01f6[\"Output\\nhtml_report\"];\n  17 --> 59528235-7525-4ef9-8810-36f1ed0f01f6;\n  style 59528235-7525-4ef9-8810-36f1ed0f01f6 stroke:#2c3143,stroke-width:4px;\n  18[\"bcftools consensus\"];\n  13 -->|output1| 18;\n  6 -->|out_file1| 18;\n  15 -->|outfile| 18;\n  c71b135d-35f9-44d0-a20e-f25528e518af[\"Output\\nconsensus_genome\"];\n  18 --> c71b135d-35f9-44d0-a20e-f25528e518af;\n  style c71b135d-35f9-44d0-a20e-f25528e518af stroke:#2c3143,stroke-width:4px;\n  19[\"TB Variant Report\"];\n  16 -->|output| 19;\n  12 -->|results_json| 19;\n  959528d2-f8f2-4440-99cf-44fddd6c5069[\"Output\\ndrug_resistance_report_html\"];\n  19 --> 959528d2-f8f2-4440-99cf-44fddd6c5069;\n  style 959528d2-f8f2-4440-99cf-44fddd6c5069 stroke:#2c3143,stroke-width:4px;\n  4d9636eb-075b-4fd2-a1e4-1a7c37a17fc0[\"Output\\nvariants_report_html\"];\n  19 --> 4d9636eb-075b-4fd2-a1e4-1a7c37a17fc0;\n  style 4d9636eb-075b-4fd2-a1e4-1a7c37a17fc0 stroke:#2c3143,stroke-width:4px;"
    }
  ],
  "api": "https://training.galaxyproject.org/training-material/api/topics/variant-analysis/tutorials/tb-variant-analysis/tutorial.json",
  "tools": [
    "__FLATTEN__",
    "toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_awk_tool/9.3+galaxy1",
    "toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_sed_tool/1.1.1",
    "toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_sed_tool/9.3+galaxy1",
    "toolshed.g2.bx.psu.edu/repos/devteam/emboss_5/EMBOSS: seqret84/5.0.0",
    "toolshed.g2.bx.psu.edu/repos/devteam/emboss_5/EMBOSS:%20seqret84/5.0.0",
    "toolshed.g2.bx.psu.edu/repos/devteam/fastqc/fastqc/0.73+galaxy0",
    "toolshed.g2.bx.psu.edu/repos/devteam/fastqc/fastqc/0.74+galaxy0",
    "toolshed.g2.bx.psu.edu/repos/devteam/samtools_stats/samtools_stats/2.0.5",
    "toolshed.g2.bx.psu.edu/repos/iuc/bcftools_consensus/bcftools_consensus/1.15.1+galaxy3",
    "toolshed.g2.bx.psu.edu/repos/iuc/fastp/fastp/0.23.4+galaxy0",
    "toolshed.g2.bx.psu.edu/repos/iuc/jbrowse/jbrowse/1.16.11+galaxy1",
    "toolshed.g2.bx.psu.edu/repos/iuc/jvarkit_wgscoverageplotter/jvarkit_wgscoverageplotter/20201223+galaxy0",
    "toolshed.g2.bx.psu.edu/repos/iuc/kraken2/kraken2/2.1.1+galaxy1",
    "toolshed.g2.bx.psu.edu/repos/iuc/mosdepth/mosdepth/0.3.8+galaxy0",
    "toolshed.g2.bx.psu.edu/repos/iuc/multiqc/multiqc/1.11+galaxy1",
    "toolshed.g2.bx.psu.edu/repos/iuc/qualimap_bamqc/qualimap_bamqc/2.2.2c+galaxy1",
    "toolshed.g2.bx.psu.edu/repos/iuc/snippy/snippy/4.6.0+galaxy0",
    "toolshed.g2.bx.psu.edu/repos/iuc/tb_variant_filter/tb_variant_filter/0.4.0+galaxy0",
    "toolshed.g2.bx.psu.edu/repos/iuc/tbprofiler/tb_profiler_profile/6.2.1+galaxy0",
    "toolshed.g2.bx.psu.edu/repos/iuc/tbvcfreport/tbvcfreport/1.0.0+galaxy0",
    "toolshed.g2.bx.psu.edu/repos/iuc/tbvcfreport/tbvcfreport/1.0.1+galaxy0",
    "upload1"
  ],
  "supported_servers": {
    "exact": [

    ],
    "inexact": [

    ]
  },
  "topic_name_human": "Variant Analysis",
  "admin_install": {
    "install_tool_dependencies": true,
    "install_repository_dependencies": true,
    "install_resolver_dependencies": true,
    "tools": [
      {
        "name": "text_processing",
        "owner": "bgruening",
        "revisions": "fbf99087e067",
        "tool_panel_section_label": "Text Manipulation",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "text_processing",
        "owner": "bgruening",
        "revisions": "d698c222f354",
        "tool_panel_section_label": "Text Manipulation",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "text_processing",
        "owner": "bgruening",
        "revisions": "fbf99087e067",
        "tool_panel_section_label": "Text Manipulation",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "emboss_5",
        "owner": "devteam",
        "revisions": "63dd26468588",
        "tool_panel_section_label": "EMBOSS",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "fastqc",
        "owner": "devteam",
        "revisions": "3d0c7bdf12f5",
        "tool_panel_section_label": "FASTA/FASTQ",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "fastqc",
        "owner": "devteam",
        "revisions": "5ec9f6bceaee",
        "tool_panel_section_label": "FASTA/FASTQ",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "samtools_stats",
        "owner": "devteam",
        "revisions": "fed4aa48ba09",
        "tool_panel_section_label": "SAM/BAM",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "bcftools_consensus",
        "owner": "iuc",
        "revisions": "147de996e34f",
        "tool_panel_section_label": "Variant Calling",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "fastp",
        "owner": "iuc",
        "revisions": "c59d48774d03",
        "tool_panel_section_label": "FASTA/FASTQ",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "jbrowse",
        "owner": "iuc",
        "revisions": "a6e57ff585c0",
        "tool_panel_section_label": "Graph/Display Data",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "jvarkit_wgscoverageplotter",
        "owner": "iuc",
        "revisions": "ac048a34cac3",
        "tool_panel_section_label": "Graph/Display Data",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "kraken2",
        "owner": "iuc",
        "revisions": "20e2f64aa1fe",
        "tool_panel_section_label": "Metagenomic Analysis",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "mosdepth",
        "owner": "iuc",
        "revisions": "5854d0da92b4",
        "tool_panel_section_label": "SAM/BAM",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "multiqc",
        "owner": "iuc",
        "revisions": "abfd8a6544d7",
        "tool_panel_section_label": "Quality Control",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "qualimap_bamqc",
        "owner": "iuc",
        "revisions": "4a89c6f84425",
        "tool_panel_section_label": "SAM/BAM",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "snippy",
        "owner": "iuc",
        "revisions": "d220115f882b",
        "tool_panel_section_label": "Variant Calling",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "tb_variant_filter",
        "owner": "iuc",
        "revisions": "32f14a2723ec",
        "tool_panel_section_label": "Annotation",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "tbprofiler",
        "owner": "iuc",
        "revisions": "4839e590cb26",
        "tool_panel_section_label": "Annotation",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "tbvcfreport",
        "owner": "iuc",
        "revisions": "42818629ec4c",
        "tool_panel_section_label": "Annotation",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "tbvcfreport",
        "owner": "iuc",
        "revisions": "9793bc5d741b",
        "tool_panel_section_label": "Annotation",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      }
    ]
  },
  "admin_install_yaml": "---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: text_processing\n  owner: bgruening\n  revisions: fbf99087e067\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: text_processing\n  owner: bgruening\n  revisions: d698c222f354\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: text_processing\n  owner: bgruening\n  revisions: fbf99087e067\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: emboss_5\n  owner: devteam\n  revisions: 63dd26468588\n  tool_panel_section_label: EMBOSS\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: fastqc\n  owner: devteam\n  revisions: 3d0c7bdf12f5\n  tool_panel_section_label: FASTA/FASTQ\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: fastqc\n  owner: devteam\n  revisions: 5ec9f6bceaee\n  tool_panel_section_label: FASTA/FASTQ\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: samtools_stats\n  owner: devteam\n  revisions: fed4aa48ba09\n  tool_panel_section_label: SAM/BAM\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bcftools_consensus\n  owner: iuc\n  revisions: 147de996e34f\n  tool_panel_section_label: Variant Calling\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: fastp\n  owner: iuc\n  revisions: c59d48774d03\n  tool_panel_section_label: FASTA/FASTQ\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: jbrowse\n  owner: iuc\n  revisions: a6e57ff585c0\n  tool_panel_section_label: Graph/Display Data\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: jvarkit_wgscoverageplotter\n  owner: iuc\n  revisions: ac048a34cac3\n  tool_panel_section_label: Graph/Display Data\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: kraken2\n  owner: iuc\n  revisions: 20e2f64aa1fe\n  tool_panel_section_label: Metagenomic Analysis\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: mosdepth\n  owner: iuc\n  revisions: 5854d0da92b4\n  tool_panel_section_label: SAM/BAM\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: multiqc\n  owner: iuc\n  revisions: abfd8a6544d7\n  tool_panel_section_label: Quality Control\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: qualimap_bamqc\n  owner: iuc\n  revisions: 4a89c6f84425\n  tool_panel_section_label: SAM/BAM\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: snippy\n  owner: iuc\n  revisions: d220115f882b\n  tool_panel_section_label: Variant Calling\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: tb_variant_filter\n  owner: iuc\n  revisions: 32f14a2723ec\n  tool_panel_section_label: Annotation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: tbprofiler\n  owner: iuc\n  revisions: 4839e590cb26\n  tool_panel_section_label: Annotation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: tbvcfreport\n  owner: iuc\n  revisions: 42818629ec4c\n  tool_panel_section_label: Annotation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: tbvcfreport\n  owner: iuc\n  revisions: 9793bc5d741b\n  tool_panel_section_label: Annotation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n",
  "tours": false,
  "video": false,
  "translations": {
    "tutorial": [

    ],
    "slides": [

    ],
    "video": false
  },
  "license": "CC-BY-4.0",
  "type": "tutorial"
}