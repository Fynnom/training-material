{"layout":"tutorial_hands_on","title":"Mapping and molecular identification of phenotype-causing mutations","subtopic":"model-organisms","zenodo_link":"https://doi.org/10.5281/zenodo.1098033","questions":["What is mapping-by-sequencing?","How can it help you identify the causative mutation in phenotypic mutants isolated from genetic screens?"],"objectives":["Use joint variant calling and extraction to facilitate variant comparison across samples","Perform variant linkage analyses for phenotypically selected recombinant progeny","Filter, annotate and report lists of variants"],"time_estimation":"2h","key_points":["Mapping-by-sequencing is a powerful method for the molecular identification of mutations","The MiModD suite of tools bundles most of the functionality required to perform mapping-by-sequencing analyses with Galaxy"],"contributors":[{"name":"Wolfgang Maier","orcid":"0000-0002-9464-6640","matrix":"wm75:matrix.org","joined":"2017-09","elixir_node":"de","fediverse":"https://scholar.social/@zerodivision","fediverse_flavor":"mastodon","affiliations":["by-covid","uni-freiburg","elixir-europe"],"id":"wm75","url":"https://training.galaxyproject.org/training-material/api/contributors/wm75.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/wm75/"}],"js_requirements":{"mathjax":null,"mermaid":false},"short_id":"T00312","url":"/topics/variant-analysis/tutorials/mapping-by-sequencing/tutorial.html","topic_name":"variant-analysis","tutorial_name":"mapping-by-sequencing","dir":"topics/variant-analysis/tutorials/mapping-by-sequencing","symlink":null,"id":"variant-analysis/mapping-by-sequencing","ref_tutorials":["<p>In order to map and identify phenotype-causing mutations efficiently from a\nsingle experiment, modern genetic research aims to combine classical genetic\nmapping concepts with the power of next-generation-sequencing.</p>\n\n<p>For example, after having obtained a mutant strain of an organism with a particular phenotype from a forward genetic screen, the classical approach towards\nidentification of the underlying causative mutation would be to:</p>\n\n<ol>\n  <li>perform mapping crosses to probe for linkage between the unknown mutation\nand selected markers with known location on the genome, in order to determine\nthe approximate genomic region that the mutation resides in, then</li>\n  <li>sequence candidate DNA stretches in this region to identify the precise\nnature of the mutation.</li>\n</ol>\n\n<p>Modern approaches, in contrast, use just one set of genome-wide sequencing data\nobtained from mapping-cross progeny and suitable parent strains to\nsimultaneously:</p>\n\n<ul>\n  <li>discover available marker mutations for linkage analysis,</li>\n  <li>map the causative mutation using these markers, and</li>\n  <li>identify candidate mutations.</li>\n</ul>\n\n<p>Since it uses sequencing data already at the mapping step, this process is\ncalled <strong>mapping-by-sequencing</strong>.</p>\n\n<p>Since genome-wide sequencing will often reveal a few hundreds to many thousands\nof marker variants that should be considered together in the linkage analysis,\nmapping-by-sequencing data is typically analyzed with dedicated computational\ntools. For Galaxy, the <strong>MiModD</strong> suite of tools offers efficient and flexible\nanalysis workflows compatible with a variety of mapping-by-sequencing\napproaches.</p>\n\n<blockquote class=\"details\">\n  <details-title>Further reading</details-title>\n  <p>The MiModD documentation has its own chapter on supported\n<a href=\"http://mimodd.readthedocs.io/en/latest/nacreousmap.html\">mapping-by-sequencing schemes</a>\nnot covered here.</p>\n</blockquote>\n\n<p>In this tutorial we are going to use several of these tools to map and identify\na point mutation in an <em>Arabidopsis thaliana</em> strain from whole-genome\nsequencing data. This will demonstrate one particular kind of linkage analysis\nsupported by <strong>MiModD</strong> called <em>Variant Allele Frequency Mapping</em>.</p>\n\n<h3 id=\"variant-allele-frequency-mapping\">Variant Allele Frequency Mapping</h3>\n\n<figure id=\"figure-1\" style=\"max-width: 90%;\"><img src=\"../../images/mbs_scheme.png\" alt=\"Principal of variant allele frequency mapping. \" width=\"972\" height=\"1121\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/mbs_scheme.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 1</strong>:</span> Principle of variant allele frequency mapping</figcaption></figure>\n\n<p>As illustrated in Figure 1, variant allele frequency mapping analyzes marker\nvariant inheritance patterns in pooled F2 recombinants selected for the\nmutation to be mapped.</p>\n\n<p>In the figure we assume a diploid\norganism with just two pairs (dark and light grey) of chromosomes.</p>\n\n<p>A mutant line established for any organism will harbor\ntwo types of variants (diamonds):</p>\n<ul>\n  <li>variants induced during mutagenesis (orange), among them the causative\nvariant responsible for the mutant phenotype (yellow)</li>\n  <li>variants (with respect to the species’ reference genome) that were\npresent in the premutagenesis strain (green open diamonds)</li>\n</ul>\n\n<p>For mapping the causative mutation, additional variants (blue open diamonds)\nare introduced through a cross to a mapping strain and F2 progeny is selected\nfor the mutant phenotype. While each individual in the F2 generation carries\nits uniquely recombined variant pattern (3 possible outcomes for the diploid\ngenome are shown in the figure), this phenotypic selection will work against\nmapping strain variants in the vicinity (yellow boxes) of the causative\nvariant. Hence, when the recombined DNA from phenotypic F2 progeny gets pooled\nand sequenced, the causative variant can be found by looking for a region for\nwhich all sequenced reads support variant alleles found in the original mutant\nline, rather than mapping strain variant alleles.</p>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#data-preparation\" id=\"markdown-toc-data-preparation\">Data Preparation</a></li>\n  <li><a href=\"#joint-variant-calling-and-extraction\" id=\"markdown-toc-joint-variant-calling-and-extraction\">Joint Variant Calling and Extraction</a></li>\n  <li><a href=\"#linkage-analysis\" id=\"markdown-toc-linkage-analysis\">Linkage Analysis</a></li>\n  <li><a href=\"#identifying-candidate-mutations\" id=\"markdown-toc-identifying-candidate-mutations\">Identifying Candidate Mutations</a></li>\n  <li><a href=\"#conclusion\" id=\"markdown-toc-conclusion\">Conclusion</a></li>\n</ol>\n\n</blockquote>\n\n<h1 id=\"data-preparation\">Data Preparation</h1>\n\n<p>In this tutorial we are going to (re-)identify the recessive causative mutation\nin a late-flowering mutant line of <em>Arabidopsis thaliana</em>.</p>\n\n<blockquote class=\"comment\">\n  <comment-title></comment-title>\n  <p><strong>MiModD</strong> was developed as a successor of the older and now unmaintained\n<em>CloudMap</em> suite of tools, but also uses some key concepts first implemented\nin the command line package <em>SHOREmap</em>.\nThe data used in this tutorial represent a subsample of the\n<a href=\"http://bioinfo.mpipz.mpg.de/shoremap/examples.html\">SHOREmap proof-of-principle data</a>\n(specifically of the <code class=\"language-plaintext highlighter-rouge\">OCF2</code> and <code class=\"language-plaintext highlighter-rouge\">Ler</code> datasets).</p>\n</blockquote>\n\n<p>The mutant line was obtained from a mutagenesis screen on the <strong>Col</strong>umbia\nreference background of <em>A. thaliana</em>. For mapping-by-sequencing, the line was\noutcrossed to the highly polymorphic <strong>L</strong>andsberg <em><strong>er</strong>ecta</em> background as a\nsource of marker variants. From this outcross, 119 F2 siblings showing the\noriginal late-flowering phenotype were recovered and their genomic DNA was\npooled and subjected to whole-genome sequencing.\nTogether with whole-genome sequencing data of a pure L<em>er</em> background strain,\nthis outcrossed pool data forms the starting point of our analysis.\nThe L<em>er</em> strain sample, thus, can inform us about the markers that the\noutcrossed F2 pool <em>could</em> have inherited and exclusion of L<em>er</em> markers from\na particular genomic region from the F2 pool provides evidence that the\nphenotype causing variant lies close to this region. With respect to\n<a href=\"#figure-1\">Figure 1</a>, this means that we will only use “blue diamond” marker\nvariants introduced through the mapping cross for the linkage analysis and\nignore potentially informative (green and orange) variants found in the\noriginal mutant line.</p>\n\n<p>For your convenience, the sequenced reads from both datasets have already been\nmapped (using <strong>Bowtie2</strong>) to the <em>A. thaliana</em> Col reference genome (version\nTAIR10) so the two datasets take the form of BAM files with the mapping results\n(see the tutorial on\n<a href=\"../../../sequence-analysis/tutorials/mapping/tutorial.html\">NGS data mapping</a>\nif you do not know what this means).</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Data upload and preprocessing</hands-on-title>\n\n  <blockquote class=\"tip\">\n    <tip-title></tip-title>\n    <p>This section assumes that you already know</p>\n\n    <ul>\n      <li>how to upload data to Galaxy via links</li>\n      <li>edit dataset attributes</li>\n      <li>do some basic text manipulation on datasets</li>\n    </ul>\n\n    <p>An excellent introduction into these topics can be found in the\n<a href=\"../../../introduction/tutorials/galaxy-intro-peaks2genes/tutorial.html\">From peaks to genes</a>\ntutorial (specifically, in the sections on\n<a href=\"../../../introduction/tutorials/galaxy-intro-peaks2genes/tutorial.html#data-upload\">Data upload</a>\nand\n<a href=\"../../../introduction/tutorials/galaxy-intro-peaks2genes/tutorial.html#file-preparation\">File preparation</a>).</p>\n  </blockquote>\n\n  <ol>\n    <li>Import the two BAM datasets representing the:\n      <ul>\n        <li><a href=\"https://zenodo.org/record/1098034/files/Ler_mapping_strain.bam\">L<em>er</em> mapping strain</a></li>\n        <li><a href=\"https://zenodo.org/record/1098034/files/outcrossed_F2.bam\">outcrossed F2 pool</a></li>\n      </ul>\n    </li>\n    <li>Specify the genome that was used at the reads mapping step\n      <ol>\n        <li>Click on <strong>Edit attributes</strong> (the pencil icon displayed with the dataset)</li>\n        <li>As the <strong>Database/Build</strong> select <code class=\"language-plaintext highlighter-rouge\">Arabidopsis thaliana TAIR10</code></li>\n        <li><strong>Save</strong> the edited attributes</li>\n      </ol>\n    </li>\n    <li>\n      <p>Import the reference genome</p>\n\n      <blockquote class=\"comment\">\n        <comment-title>TAIR10 Version</comment-title>\n        <p>This step is only necessary if the TAIR10 version of the <em>A. thaliana</em>\ngenome is not available as a built-in genome on your Galaxy server.</p>\n      </blockquote>\n\n      <ol>\n        <li>Upload the reference genome using the URL:\n<code class=\"language-plaintext highlighter-rouge\">https://www.arabidopsis.org/download_files/Genes/TAIR10_genome_release/TAIR10_chromosome_files/TAIR10_chr_all.fas</code></li>\n        <li>Use <strong>Replace parts of text</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> to truncate the title\nlines in the fasta dataset to just the bare chromosome names. Set:\n          <ul>\n            <li>\n              <p>the <strong>Find pattern</strong> to <code class=\"language-plaintext highlighter-rouge\">^&gt;(\\w+).*</code></p>\n\n              <p>This will find entire fasta title lines, or more specifically, any\nlines starting with <code class=\"language-plaintext highlighter-rouge\">&gt;</code> followed by at least one letter, digit or\nunderscore.</p>\n            </li>\n            <li>\n              <p>the <strong>Replace with</strong> pattern to <code class=\"language-plaintext highlighter-rouge\">&gt;chr$1</code></p>\n\n              <p>The <code class=\"language-plaintext highlighter-rouge\">$1</code> in it refers to the parenthesized part of the find pattern,\n<em>i.e.</em>, just the substring of letters/digits/underscores directly\nfollowing the <code class=\"language-plaintext highlighter-rouge\">&gt;</code>.</p>\n            </li>\n            <li>\n              <p><strong>Find-Pattern is a regular expression</strong> to <code class=\"language-plaintext highlighter-rouge\">Yes</code></p>\n            </li>\n          </ul>\n        </li>\n        <li>Make sure the datatype of the resulting dataset is set to <code class=\"language-plaintext highlighter-rouge\">fasta</code> and\ngive the dataset a nice name (<em>e.g.</em>, TAIR10 reference).</li>\n        <li>At this point you can delete the originally downloaded dataset.</li>\n      </ol>\n    </li>\n  </ol>\n</blockquote>\n\n<h1 id=\"joint-variant-calling-and-extraction\">Joint Variant Calling and Extraction</h1>\n\n<p>A hallmark of all mapping-by-sequencing analyses is that one would like to\nfollow the fate of variants through genetic crosses. In this tutorial, for\nexample, we would like to determine, for every marker variant provided by the\nL<em>er</em> background, at what frequency it got inherited by the outcrossed F2 pool.\nFor such analyses to work reliably, it is best to call variants jointly for all\nrelevant samples because this allows the variant caller to give us per-sample\nvariant call statistics for all sites at which <strong>any</strong> sample is found to have\na non-wt genotype. In our case, this means that the variant caller will report\nany variants it finds for the L<em>er</em> background sample along with the call\nstatistics for the outcrossed F2 pool at that same site - even if the variant\nallele contributes very little to the pool and would, thus, have been\ndisregarded in a standard single-sample analysis.</p>\n\n<p>Here, we are using the <strong>MiModD Variant Calling</strong> tool for joint variant\ncalling for our two samples. This tool outputs variant call statistics across\nall sites and all samples in the compact binary BCF format. We can then use\nthe <strong>MiModD Extract Variant Sites</strong> tool to extract sites, for which at least\none sample appears to have a non-wt genotype, and report them in VCF format.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Variant Calling</hands-on-title>\n\n  <ol>\n    <li>Use <strong>MiModD Variant Calling</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> to generate combined\nvariant call statistics:\n      <ul>\n        <li>\n          <p>Select the <strong>reference genome</strong> to call variants against.</p>\n\n          <p>If your Galaxy server offers version TAIR10 of the <em>A. thaliana</em>\nreference as a <strong>built-in genome</strong>, you can go ahead and use it.\nOtherwise, download and preprocess the reference as described under\nData Preparation and use it as a <strong>genome from my history</strong>.</p>\n        </li>\n        <li>As the <strong>Aligned reads input datasets</strong> for the analysis select the two\nBAM datasets representing the two samples (use the <code class=\"language-plaintext highlighter-rouge\">Control</code> key on the\nkeyboard to select multiple datasets from the list.</li>\n        <li><strong>Execute</strong> the job</li>\n      </ul>\n    </li>\n    <li>Run <strong>MiModD Extract Variant Sites</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with\n      <ul>\n        <li><strong>BCF input file</strong> set to the BCF dataset generated in the previous\nstep.</li>\n      </ul>\n    </li>\n  </ol>\n\n  <blockquote class=\"question\">\n    <question-title></question-title>\n\n    <ol>\n      <li>Approximately how many variants were extracted?</li>\n      <li>Does this number surprise you?</li>\n    </ol>\n\n    <blockquote class=\"solution\">\n      <solution-title></solution-title>\n      <ol>\n        <li>You can click on the extracted variants dataset in your history to\nget more details about it. You should see that the file has an\nestimated 130,000 lines. Since one variant gets reported per line in VCF format (apart from a number\nof header lines), this roughly\nequals the number of variants in the dataset.</li>\n        <li>\n          <p>The huge number of variants reflects the fact that the L<em>er</em>\nmapping strain is really quite diverged from the Col reference\nbackground that the mutant was generated in and, thus, offers many\nmarker variants for mapping.</p>\n\n          <p>In total, the L<em>er</em> genome harbors &gt;400,000 single nucleotide\nvariants compared to the Col reference, but to keep the tutorial\ndatasets small we only provided reads mapping to 2 out of 5\nchromosomes. In addition, we provided really low-coverage data\neven for those two chromosomes so our analysis will miss many true\nvariants and contain many questionable variant calls that may represent\nfalse-positives. Regardless, an analysis based on such a large overall number\nof variants is robust enough to provide useful results.</p>\n        </li>\n      </ol>\n    </blockquote>\n\n  </blockquote>\n</blockquote>\n\n<h1 id=\"linkage-analysis\">Linkage Analysis</h1>\n\n<p>The extracted variants dataset obtained in the previous step contains\ninformation about thousands of sites that can be used as markers to map the\ncausative mutation in the F2 pool. We will now analyze the data with the\n<strong>MiModD NacreousMap</strong> tool in <strong>Variant Allele Frequency</strong> mapping mode to\nidentify these markers and look for linkage between them and the causative\nmutation.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Linkage Analysis with one set of parentally contributed markers</hands-on-title>\n\n  <p>In the <strong>MiModD NacreousMap</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> interface, set</p>\n  <ul>\n    <li><strong>type of mapping analysis to perform</strong> to <code class=\"language-plaintext highlighter-rouge\">Variant Allele Frequency\nMapping</code> and</li>\n    <li><strong>data source to use</strong> to <code class=\"language-plaintext highlighter-rouge\">VCF file of variants</code>.</li>\n    <li>As the <strong>input file with variants to analyze</strong> select your extracted\nvariants VCF dataset obtained in the previous step.</li>\n    <li>As the <strong>mapping sample name</strong> use <code class=\"language-plaintext highlighter-rouge\">outcrossed F2</code>.</li>\n    <li>Leave the <strong>name of the related parent sample</strong> input field empty because\nin this two-sample there is no such sample.</li>\n    <li>As the <strong>name of the unrelated parent sample</strong> specify <code class=\"language-plaintext highlighter-rouge\">Ler</code>.\n      <blockquote class=\"comment\">\n        <comment-title>Sample roles</comment-title>\n        <p>In <code class=\"language-plaintext highlighter-rouge\">Variant Allele Frequency Mapping</code> mode the tool requires:</p>\n        <ul>\n          <li>a <strong>mapping sample</strong>, which corresponds to the recombinant pool, from\nwhich allele frequencies should be calculated</li>\n          <li>either a <strong>related</strong> or an <strong>unrelated parent sample</strong> (or both),\nfrom which the marker variant sites to use in the linkage analysis\nwill be determined. A related parent sample is related (or identical)\nto the original mutant line by descent and provides information about\n(some of) the variants present in that line, while an unrelated parent\nsample provides information about the mapping strain variants\nintroduced in the mapping cross. If both a related and an unrelated\nparent sample are available, the tool can also use the marker sets\nfrom both sides for the linkage analysis.</li>\n        </ul>\n\n      </blockquote>\n      <p>With these settings, we base the linkage analysis on crossed-in variants\nonly, <em>i.e.</em>, the tool will look for variants, for which the L<em>er</em> sample\nappears homozygous mutant, and determine the contribution of each such\nvariant allele to the recombinant pool highlighting regions of low\ncontribution, <em>i.e.</em>, with suspected linkage to the causative variant, in its\noutput.</p>\n    </li>\n  </ul>\n\n  <p>Running this job will generate two datasets, one with linkage tables for each\nchromosome in the <em>A. thaliana</em> genome, one with graphical representations\nof the data.</p>\n\n  <blockquote class=\"question\">\n    <question-title></question-title>\n\n    <ol>\n      <li>Have a look at the linkage plots dataset generated by the tool run. In\nwhich interval on which chromosome would you expect the causative\nmutation?</li>\n      <li>Are the per-marker scatter plots and the histogram plots in agreement?</li>\n      <li>What about those <code class=\"language-plaintext highlighter-rouge\">No markers found!</code> messages (you saw them, right?)\nthat the tool printed?</li>\n    </ol>\n\n    <blockquote class=\"solution\">\n      <solution-title></solution-title>\n      <ol>\n        <li>The plots suggest that the causative variant is likely to be found\nin the region from 18,000,000 to 19,000,000 on chr2.</li>\n        <li>\n          <p>Look at the y axis labels! The scatter plots show the rates at\nwhich marker sites appear to recombine with the causative mutation\nin the pool of F2 recombinants, while the histograms show linkage\nevidence. Hence, a dip of the scatter plot regression line towards zero\ncorresponds to a peak in the histograms and the two kinds of plots are,\nthus, in very good agreement for this analysis.</p>\n\n          <p>In general, the histogram plots are easier to digest and often\nprovide more precise mapping intervals, and are often all you need for\nmapping a causative variant. The per-marker scatter plots, on the other\nhand, are closer to the raw data and can sometimes reveal additional\nirregularities in the data that may indicate problems with the mapping\ncross or unexpected factors influencing the inheritance pattern.</p>\n        </li>\n        <li>Since we included only reads mapping to chromosome 1 or 2 in\nthe original BAM files, the tool will not be able to detect any markers\nfor the other chromosomes.</li>\n      </ol>\n    </blockquote>\n\n  </blockquote>\n</blockquote>\n\n<h1 id=\"identifying-candidate-mutations\">Identifying Candidate Mutations</h1>\n\n<p>With the mapping results obtained above we can now try to get a list of\ncandidates for the causative mutation. Here is what we know about this mutation\nso far:</p>\n\n<ul>\n  <li>\n    <p>The F2 recombinant pool should appear homozygous mutant for it.</p>\n\n    <p>This is because the F2 recombinants got selected based on the phenotype of\nthe recessive mutation so we can assume that all individuals in the pool were\nhomozygous for it.</p>\n  </li>\n  <li>\n    <p>The L<em>er</em> strain should not carry it.</p>\n  </li>\n  <li>\n    <p>It should reside in the genomic region identified in the previous step.</p>\n  </li>\n</ul>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Variant Filtering</hands-on-title>\n\n  <p>With the above information, we can run <strong>MiModD VCF Filter</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>\nto obtain a new VCF dataset with only those variants from the originally\nextracted ones that fulfill all three criteria. In the tool interface,</p>\n\n  <ul>\n    <li>select as <strong>VCF input file</strong> the extracted variants dataset from your\nhistory</li>\n    <li>add a <strong>Sample-specific Filter</strong> and set its\n      <ul>\n        <li><strong>sample</strong> to <code class=\"language-plaintext highlighter-rouge\">outcrossed F2</code></li>\n        <li><strong>genotype pattern(s) for the inclusion of variants</strong> to <code class=\"language-plaintext highlighter-rouge\">1/1</code></li>\n      </ul>\n\n      <p>These settings will make the filter retain only variants for which the F2\npool has a <code class=\"language-plaintext highlighter-rouge\">1/1</code>, <em>i.e.</em>, homozygous mutant genotype.</p>\n    </li>\n    <li>add another <strong>Sample-specific Filter</strong> and set its\n      <ul>\n        <li><strong>sample</strong> to <code class=\"language-plaintext highlighter-rouge\">Ler</code></li>\n        <li><strong>genotype pattern(s) for the inclusion of variants</strong> to <code class=\"language-plaintext highlighter-rouge\">0/0</code></li>\n      </ul>\n\n      <p>This filter will retain only variants for which the mapping strain sample\nhas a homozygous wt genotype.</p>\n    </li>\n    <li>add a <strong>Region Filter</strong> and set its\n      <ul>\n        <li><strong>Chromosome</strong> to <code class=\"language-plaintext highlighter-rouge\">chr2</code></li>\n        <li><strong>Region Start</strong> to 18000000</li>\n        <li><strong>Region End</strong> to 19000000</li>\n      </ul>\n\n      <p>to retain only variants falling into the previously determined mapping\ninterval.</p>\n\n      <blockquote class=\"comment\">\n        <comment-title>Sample and chromosome names</comment-title>\n        <p>This is the second time in this tutorial that we ask you to type sample\nor chromosome names exactly as they appear in a dataset, and so you\nmay have started wondering how you are supposed to keep track of which\nnames are used where in your own analyses.</p>\n\n        <p>Because this is a valid concern, the MiModD tool suite features the\n<strong>MiModD File Information</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> tool that can report the\nsample and sequence names stored in almost any dataset that you may\nencounter in a mapping-by-sequencing analysis (specifically, the\ntool can handle datasets in vcf, bcf, sam, bam and fasta format).</p>\n\n      </blockquote>\n    </li>\n  </ul>\n\n  <p>Running the job yields a new VCF dataset with variants that passed all\nfilters.</p>\n\n  <blockquote class=\"question\">\n    <question-title></question-title>\n\n    <ol>\n      <li>How many variants passed the filters?</li>\n      <li>How many variants would you have to consider as candidates if you did\nnot have any mapping information?</li>\n    </ol>\n\n    <blockquote class=\"solution\">\n      <solution-title></solution-title>\n      <ol>\n        <li>If you used the suggested mapping interval of 1Mb on chr2, you\nshould have retained 5 variants. Filtering is a really powerful way to\nreduce the number of variants to consider!</li>\n        <li>Re-running the job with the region filter removed shows that across\nthe two chromosomes, for which the input datasets provided sequencing\nreads, there are 50 variants for which the pool appears homozygous\nmutant and for which the L<em>er</em> strain is homozygous wt.</li>\n      </ol>\n    </blockquote>\n  </blockquote>\n</blockquote>\n\n<p>Not all of the retained variants are equally likely candidates for being the\ncausative mutation. Since the input datasets consist of reads from whole-genome\nsequencing, as opposed to exome sequencing, some of the variants may fall in\nintergenic regions or introns where they are unlikely to cause a phenotype.\nOther variants may fall in coding regions, but may be silent on the protein\nlevel. Hence, we can prioritize our candidate variants after annotating them\nwith predicted functional effects.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Variant Annotation</hands-on-title>\n\n  <p>To annotate our variants we are going to use <strong>SnpEff</strong> with its\n<code class=\"language-plaintext highlighter-rouge\">Arabidopsis_thaliana</code> genome database as the source of functional genomic\nannotations, then generate a human-friendly variant report with the\n<strong>MiModD Report Variants</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> tool.</p>\n\n  <ol>\n    <li>\n      <p>Use <strong>SnpEff Download</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> to download genome database\n<code class=\"language-plaintext highlighter-rouge\">Arabidopsis_thaliana</code>.</p>\n\n      <blockquote class=\"comment\">\n        <comment-title>SnpEff versions</comment-title>\n        <p>SnpEff genome databases can only be used with the specific <code class=\"language-plaintext highlighter-rouge\">major.minor</code>\nversion of SnpEff they were built for.\nMake sure you are using matching versions (e.g., <code class=\"language-plaintext highlighter-rouge\">4.3</code> - differences\npast the second digit are fine and denote subversions with compatible\ndatabase schemes) of <strong>SnpEff Download</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> in this and of\n<strong>SnpEff Variant effect and annotation</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> in the next\nstep.</p>\n\n        <p>Please also note that before SnpEff version 4.3 the TAIR10 version of\nthe <em>A. thaliana</em> genome database was named <code class=\"language-plaintext highlighter-rouge\">athalianaTair10</code>.\nIf your Galaxy server offers only older versions of the SnpEff tools,\nyou will have to use that name instead of <code class=\"language-plaintext highlighter-rouge\">Arabidopsis_thaliana</code>.</p>\n      </blockquote>\n    </li>\n    <li>In the <strong>SnpEff Variant effect and annotation</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> interface,\nset:\n      <ul>\n        <li><strong>Sequence changes (SNPs, MNPs, InDels)</strong> to your filtered VCF dataset</li>\n        <li><strong>Genome source</strong> to <code class=\"language-plaintext highlighter-rouge\">Downloaded snpEff database in your history</code></li>\n        <li><strong>SnpEff4.3 Genome Data</strong> to your just downloaded genome dataset</li>\n        <li>\n          <p>under <strong>Annotation options</strong> check <code class=\"language-plaintext highlighter-rouge\">Use 'EFF' field compatible with\nolder versions (instead of 'ANN')</code></p>\n\n          <p>This last setting is required for compatibility of the resulting dataset\nwith the current version of <strong>MiModD Report Variants</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>.</p>\n        </li>\n      </ul>\n\n      <p>Running this job will produce another VCF dataset with the functional\nannotation data added to its INFO column. Inspecting this dataset is not\nparticularly convenient, but you can turn it into a more user-friendly\nreport by</p>\n    </li>\n    <li>using <strong>MiModD Report Variants</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> and setting:\n      <ul>\n        <li><strong>The VCF input with the variants to be reported</strong> to the annotated\nvariants dataset generated by <strong>SnpEff</strong></li>\n        <li>the <strong>Format to use for the report</strong> to <code class=\"language-plaintext highlighter-rouge\">HTML</code></li>\n        <li>\n          <p><strong>Species</strong> to <code class=\"language-plaintext highlighter-rouge\">A. thaliana</code>.</p>\n\n          <p>The species information can be used by the tool to enrich the output\nwith species-specific database and genome browser links.</p>\n        </li>\n      </ul>\n\n      <blockquote class=\"comment\">\n        <comment-title></comment-title>\n        <p>Variant reports in html format are meant to be used on relatively small\nlists of candidate variants like in this example. If the input VCF\ncontains &gt; 1000 variants, the relatively large size of the reports and\nslow loading in the browser may become annoying. In this case, or if you\nexperience formatting problems with the generated html in your browser,\nit may be better to choose <code class=\"language-plaintext highlighter-rouge\">Tab-separated plain text</code> as the report\nformat although the output will then lack those convenient hyperlinks.</p>\n      </blockquote>\n    </li>\n  </ol>\n\n  <blockquote class=\"question\">\n    <question-title></question-title>\n\n    <p>The published confirmed mutations in the mutant line are <em>chr2:18,774,111\nC→T</em> and <em>chr2:18,808,927 C→T</em>. The latter was shown through follow-up\nexperiments to be the causative variant.</p>\n\n    <ol>\n      <li>What are the functional effects of these two mutations according to the\nreport?</li>\n      <li>What biological functions are described for the two genes? How do these\nrelate to the phenotype of our mutant line?</li>\n    </ol>\n\n    <blockquote class=\"solution\">\n      <solution-title></solution-title>\n      <ol>\n        <li>The C→T transition at 18,774,111 results in a premature\ntranslational stop for the transcript AT2G45550.1. The C→T transition\nat 18,808,927 affects a splice donor site and, thus, is likely to\ninterfere with correct splicing of the transcript AT2G45660.1.</li>\n        <li>From the linked gene pages at <em>TAIR</em> you can learn that the\ngene AT2G45550 encodes a cytochrome P450, while AT2G45660 encodes a\nprotein called AGL20/SOC1, which is known to control flowering. Thus, there\nis a direct connection between the late-flowering phenotype of the\nmutant line studied here and the known role of the gene affected by\nchr2:18,808,927 C→T.</li>\n      </ol>\n    </blockquote>\n  </blockquote>\n</blockquote>\n\n<h1 id=\"conclusion\">Conclusion</h1>\n\n<p>Mapping-by-sequencing can greatly speed up and facilitate the molecular\nidentification of mutations recovered from mutagenesis screens. The method\nmakes extensive use of cross-sample comparison of variants and benefits strongly\nfrom joint variant calling to generate reliable and manageable variant\ninformation. A combination of variant linkage analysis and filtering often\nresults in very small lists of candidate variants that can then be confirmed\nthrough further experimental work. Importantly, the selection of biological\nsamples for sequencing determines the meaningful variant comparisons that can\nbe made in the bioinformatics analysis so it is important to understand the\nessence of the analysis method <strong>before</strong> the preparation of any biological\nsamples.</p>\n"],"ref_slides":[],"hands_on":true,"slides":false,"mod_date":"2023-11-03 14:30:27 +0000","pub_date":"2018-03-07 15:58:55 +0000","version":25,"workflows":[{"workflow":"workflow-arabidopsis.ga","tests":false,"url":"https://training.galaxyproject.org/training-material/topics/variant-analysis/tutorials/mapping-by-sequencing/workflows/workflow-arabidopsis.ga","path":"topics/variant-analysis/tutorials/mapping-by-sequencing/workflows/workflow-arabidopsis.ga","wfid":"variant-analysis-mapping-by-sequencing","wfname":"workflow-arabidopsis","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/variant-analysis-mapping-by-sequencing/versions/workflow-arabidopsis","license":null,"creators":[],"name":"Mapping And Molecular Identification Of Phenotype Causing Mutations","title":"Mapping And Molecular Identification Of Phenotype Causing Mutations","test_results":null,"modified":"2024-06-14 10:01:53 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\nA. thaliana TAIR10 ref genome\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"ℹ️ Input Dataset\\naligned reads from outcrossed F2 pool\"];\n  style 1 stroke:#2c3143,stroke-width:4px;\n  2[\"ℹ️ Input Dataset\\naligned reads from Ler mapping strain\"];\n  style 2 stroke:#2c3143,stroke-width:4px;\n  3[\"SnpEff Download\"];\n  4[\"Replace parts of text\"];\n  0 -->|output| 4;\n  5[\"MiModD Variant Calling\"];\n  4 -->|outfile| 5;\n  2 -->|output| 5;\n  1 -->|output| 5;\n  6[\"MiModD Extract Variant Sites\"];\n  5 -->|ofile| 6;\n  7[\"MiModD NacreousMap\"];\n  6 -->|output_vcf| 7;\n  8[\"MiModD VCF Filter\"];\n  6 -->|output_vcf| 8;\n  9[\"SnpEff\"];\n  8 -->|outputfile| 9;\n  3 -->|snpeff_db| 9;\n  10[\"MiModD Report Variants\"];\n  9 -->|snpeff_output| 10;"}],"api":"https://training.galaxyproject.org/training-material/api/topics/variant-analysis/tutorials/mapping-by-sequencing/tutorial.json","tools":["toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_find_and_replace/1.1.1","toolshed.g2.bx.psu.edu/repos/iuc/snpeff/snpEff/4.1.0","toolshed.g2.bx.psu.edu/repos/iuc/snpeff/snpEff_download/4.1.0","toolshed.g2.bx.psu.edu/repos/wolma/mimodd_main/mimodd_map/0.1.8_1","toolshed.g2.bx.psu.edu/repos/wolma/mimodd_main/mimodd_varcall/0.1.8_1","toolshed.g2.bx.psu.edu/repos/wolma/mimodd_main/mimodd_varextract/0.1.8_1","toolshed.g2.bx.psu.edu/repos/wolma/mimodd_main/mimodd_varreport/0.1.8_1","toolshed.g2.bx.psu.edu/repos/wolma/mimodd_main/mimodd_vcf_filter/0.1.8_1"],"supported_servers":{"exact":[{"url":"https://usegalaxy.be/","name":"UseGalaxy.be","usegalaxy":false},{"url":"https://usegalaxy.eu","name":"UseGalaxy.eu","usegalaxy":true}],"inexact":[{"url":"https://galaxytrakr.org/","name":"GalaxyTrakr","usegalaxy":false},{"url":"https://usegalaxy.cz/","name":"UseGalaxy.cz","usegalaxy":false},{"url":"https://usegalaxy.no/","name":"UseGalaxy.no","usegalaxy":false},{"url":"https://usegalaxy.org","name":"UseGalaxy.org (Main)","usegalaxy":true},{"url":"https://usegalaxy.org.au","name":"UseGalaxy.org.au","usegalaxy":true}]},"topic_name_human":"Variant Analysis","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"text_processing","owner":"bgruening","revisions":"a6f147a050a2","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"snpeff","owner":"iuc","revisions":"20f0429a4bfe","tool_panel_section_label":"Variant Calling","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"snpeff","owner":"iuc","revisions":"20f0429a4bfe","tool_panel_section_label":"Variant Calling","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"mimodd_main","owner":"wolma","revisions":"f0f2795de2c7","tool_panel_section_label":"MiModD","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"mimodd_main","owner":"wolma","revisions":"f0f2795de2c7","tool_panel_section_label":"MiModD","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"mimodd_main","owner":"wolma","revisions":"f0f2795de2c7","tool_panel_section_label":"MiModD","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"mimodd_main","owner":"wolma","revisions":"f0f2795de2c7","tool_panel_section_label":"MiModD","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"mimodd_main","owner":"wolma","revisions":"f0f2795de2c7","tool_panel_section_label":"MiModD","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: text_processing\n  owner: bgruening\n  revisions: a6f147a050a2\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: snpeff\n  owner: iuc\n  revisions: 20f0429a4bfe\n  tool_panel_section_label: Variant Calling\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: snpeff\n  owner: iuc\n  revisions: 20f0429a4bfe\n  tool_panel_section_label: Variant Calling\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: mimodd_main\n  owner: wolma\n  revisions: f0f2795de2c7\n  tool_panel_section_label: MiModD\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: mimodd_main\n  owner: wolma\n  revisions: f0f2795de2c7\n  tool_panel_section_label: MiModD\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: mimodd_main\n  owner: wolma\n  revisions: f0f2795de2c7\n  tool_panel_section_label: MiModD\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: mimodd_main\n  owner: wolma\n  revisions: f0f2795de2c7\n  tool_panel_section_label: MiModD\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: mimodd_main\n  owner: wolma\n  revisions: f0f2795de2c7\n  tool_panel_section_label: MiModD\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":false,"slides_recordings":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial"}