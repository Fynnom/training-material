{"layout":"tutorial_hands_on","title":"Trio Analysis using Synthetic Datasets from RD-Connect GPAP","subtopic":"human-genetics-cancer","zenodo_link":"https://doi.org/10.5281/zenodo.6483454","questions":["How do you import data from the EGA?","How to download files with HTSGET in Galaxy?","How do you pre-process VCFs?","How do you identify causative variants?"],"objectives":["Requesting DAC access and importing data from the EGA.","Pre-process VCFs using regular expressions.","Use annotations and phenotype information to find the causative variant(s)."],"time_estimation":"2H","key_points":["Downloading whole datasets with HTSGET is safe and easy with Galaxy.","Regex is a usefull tool for pre-processing VCF files.","Variant annotations allows us to strictly filter VCFs to find the causative variant."],"contributors":[{"name":"Jasper Ouwerkerk","email":"j.ouwerkerk.1@erasmusmc.nl","joined":"2022-04","elixir_node":"nl","affiliations":["elixir-europe"],"id":"JasperO98","url":"https://training.galaxyproject.org/training-material/api/contributors/JasperO98.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/JasperO98/"},{"name":"Wolfgang Maier","orcid":"0000-0002-9464-6640","matrix":"wm75:matrix.org","joined":"2017-09","elixir_node":"de","fediverse":"https://scholar.social/@zerodivision","fediverse_flavor":"mastodon","affiliations":["by-covid","uni-freiburg","elixir-europe"],"id":"wm75","url":"https://training.galaxyproject.org/training-material/api/contributors/wm75.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/wm75/"},{"name":"Helena Rasche","orcid":"0000-0001-9760-8992","maintainer_contact":"gitter","matrix":"hexylena:matrix.org","joined":"2017-09","elixir_node":"nl","affiliations":["gallantries","by-covid","erasmusmc","elixir-europe","elixir-converge"],"former_affiliations":["deNBI","avans-atgm","uni-freiburg"],"contact_for_training":false,"location":{"country":"NL","lat":51.91,"lon":4.46},"id":"hexylena","url":"https://training.galaxyproject.org/training-material/api/contributors/hexylena.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/hexylena/"},{"name":"Saskia Hiltemann","maintainer_contact":"gitter","email":"saskia.hiltemann@gmail.com","fediverse":"https://mstdn.science/@shiltemann","fediverse_flavor":"mastodon","bluesky":"shiltemann.bsky.social","linkedin":"shiltemann","matrix":"shiltemann:matrix.org","orcid":"0000-0003-3803-468X","joined":"2017-09","bio":"Researcher at Erasmus Medical Center","elixir_node":"nl","contact_for_training":true,"affiliations":["CINECA-Project","gallantries","erasmusmc","elixir-europe","uni-freiburg"],"location":{"country":"NL","lat":51.912,"lon":4.462},"id":"shiltemann","url":"https://training.galaxyproject.org/training-material/api/contributors/shiltemann.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/shiltemann/"}],"tags":["cyoa"],"recordings":[{"youtube_id":"3OWXWOkJRqU","speakers":["JasperO98"],"captioners":["JasperO98"],"date":"2023-05-12","length":"40M"}],"js_requirements":{"mathjax":null,"mermaid":false},"short_id":"T00320","url":"/topics/variant-analysis/tutorials/trio-analysis/tutorial.html","topic_name":"variant-analysis","tutorial_name":"trio-analysis","dir":"topics/variant-analysis/tutorials/trio-analysis","symlink":null,"id":"variant-analysis/trio-analysis","ref_tutorials":["<p>To discover causal mutations of inherited diseases it’s common practice to do a trio analysis. In a trio analysis DNA is sequenced of both the patient and parents. Using this method, it’s possible to identify multiple inheritance patterns. Some examples of these patterns are autosomal recessive, autosomal dominant, and  de-novo variants, which are represented in the figure below. To elaborate, the most left tree shows an autosomal dominant inhertitance pattern where the offspring inherits a faulty copy of the gene from one of the parents. The center subfigure represents an autosomal recessive disease, here the offspring inherited a faulty copy of the same gene from both parents. In the right subfigure a de-novo mutation is shown, which is caused by a mutation during the offspring’s lifetime.</p>\n\n<figure id=\"figure-1\" style=\"max-width: 90%;\"><div style=\"overflow-x: auto\"><object data=\"../../images/trio-analysis/pedigree.svg\" type=\"image/svg+xml\" alt=\"Image of three family trees representing a different inheritance pattern each, from left to right the trees have a title on top with: autosomal dominant, autosomal recessive, and De-Novo. The families consists of a father, mother, and son. Under the trees there is a legend which shows, from left to right, a red diagonal line with the text 'Affected', a white square with a black border with the text 'Male Variant Absent', a white circle with a black border with the text 'Female Variant Absent', a half-blackened white square with a black border with the text 'Male Variant Present', and a half-blackened circle with a black border with the text 'Female Variant Present'.\">Image of three family trees representing a different inheritance pattern each, from left to right the trees have a title on top with: autosomal dominant, autosomal recessive, and De-Novo. The families consists of a father, mother, and son. Under the trees there is a legend which shows, from left to right, a red diagonal line with the text 'Affected', a white square with a black border with the text 'Male Variant Absent', a white circle with a black border with the text 'Female Variant Absent', a half-blackened white square with a black border with the text 'Male Variant Present', and a half-blackened circle with a black border with the text 'Female Variant Present'.</object></div><a target=\"_blank\" href=\"../../images/trio-analysis/pedigree.svg\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 1</strong>:</span> Three family trees representing autosomal dominant (left), autosomal recessive (center), and a de-novo inheritence pattern (right) from parents to son.</figcaption></figure>\n\n<p>To discover these mutations either whole exome sequencing (WES) or whole genome sequencing (WGS) can be used. With these technologies it is possible to uncover the DNA of the parents and offspring to find (shared) mutations in the DNA. These mutations can include insertions/deletions (indels), loss of heterozygosity (LOH), single nucleotide variants (SNVs), copy number variations (CNVs), and fusion genes.</p>\n\n<p>In this tutorial we will also make use of the HTSGET protocol, which is a program to download our data securely and savely. This protocol has been implemented in the <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/ega_download_client/pyega3/5.0.2+galaxy0\" title=\"EGA Download Client tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>EGA Download Client</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 5.0.2+galaxy0)</span> tool, so we don’t have to leave Galaxy to retrieve our data.</p>\n\n<p>We will not start our analysis from scratch, since the main goal of this tutorial is to use the HTSGET protocol to download variant information from an online archive and to find the causative variant from those variants. If you want to learn how to do the analysis from scratch, using the raw reads, you can have a look at the <a href=\"/training-material/topics/variant-analysis/tutorials/exome-seq/tutorial.html\">Exome sequencing data analysis for diagnosing a genetic disease</a> tutorial.</p>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n  <p>In this tutorial, we will cover:</p>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#data-preperation\" id=\"markdown-toc-data-preperation\">Data preperation</a>    <ol>\n      <li><a href=\"#getting-dac-access\" id=\"markdown-toc-getting-dac-access\">Getting DAC access</a></li>\n      <li><a href=\"#download-list-of-files\" id=\"markdown-toc-download-list-of-files\">Download list of files</a></li>\n      <li><a href=\"#filter-list-of-files\" id=\"markdown-toc-filter-list-of-files\">Filter list of files</a></li>\n      <li><a href=\"#download-files\" id=\"markdown-toc-download-files\">Download files</a></li>\n      <li><a href=\"#decompress-vcfs\" id=\"markdown-toc-decompress-vcfs\">Decompress VCFs</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#pre-processing\" id=\"markdown-toc-pre-processing\">Pre-Processing</a>    <ol>\n      <li><a href=\"#add-chromosome-prefix-to-vcf\" id=\"markdown-toc-add-chromosome-prefix-to-vcf\">Add chromosome prefix to vcf</a></li>\n      <li><a href=\"#normalizing-vcf\" id=\"markdown-toc-normalizing-vcf\">Normalizing VCF</a></li>\n      <li><a href=\"#filter-non_ref-sites\" id=\"markdown-toc-filter-non_ref-sites\">Filter NON_REF sites</a></li>\n      <li><a href=\"#merge-vcf-collection-into-one-dataset\" id=\"markdown-toc-merge-vcf-collection-into-one-dataset\">Merge VCF collection into one dataset</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#annotation\" id=\"markdown-toc-annotation\">Annotation</a>    <ol>\n      <li><a href=\"#annotate-with-snpeff\" id=\"markdown-toc-annotate-with-snpeff\">Annotate with SNPeff</a></li>\n      <li><a href=\"#compress-vcf\" id=\"markdown-toc-compress-vcf\">Compress VCF</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#trio-analysis\" id=\"markdown-toc-trio-analysis\">Trio Analysis</a>    <ol>\n      <li><a href=\"#gemini-analyses\" id=\"markdown-toc-gemini-analyses\">GEMINI analyses</a></li>\n      <li><a href=\"#geneiobio-analyses\" id=\"markdown-toc-geneiobio-analyses\">Gene.iobio Analyses</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#conclusion\" id=\"markdown-toc-conclusion\">Conclusion</a></li>\n  <li><a href=\"#workflow\" id=\"markdown-toc-workflow\">Workflow</a></li>\n</ol>\n\n</blockquote>\n\n<h1 id=\"data-preperation\">Data preperation</h1>\n<p>In this tutorial we will use case 5 from the RD-Connect GPAP synthetic datasets. The dataset that we will use consists of WGS VCFs from a real healthy family trio, which originates from the Illumina Platinum initiative <span class=\"citation\"><a href=\"#Eberle2017\">Eberle <i>et al.</i> 2017</a></span> and was made available by the <a href=\"https://www.genome.gov/10001688/international-hapmap-project\">HapMap project</a>. In our dataset a real causative variant was manually spiked-in that should cause breast cancer. The spike-in has been synthetically introduced in the mother and daughter. Here our goal is to identify the genetic variation that is responsible for the disease.</p>\n\n<p>We offer two ways to download the files. Firstly, you can download the files directly from the EGA-archive by requesting DAC access. This will take only 1 workday and gives you access to all of the RD-Connect GPAP synthetic datasets. However if you don’t have the time you can also download the data from zenodo.</p>\n\n<blockquote class=\"notranslate hands_on gtn-cyoa\" id=\"gtn-cyoa\">\n\t<div class=\"box-title\" aria-label=\"hands-on box: choose your own tutorial\"><i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\"></span> Hands-on: Choose Your Own Tutorial</div>\n\t<p>This is a \"Choose Your Own Tutorial\" section, where you can select between multiple paths. Click one of the buttons below to select how you want to follow the tutorial</p>\n\t\n\t<p>\n\t\tHere you can choose to either follow the data preperation for the data from the EGA-archive or Zenodo.\n\t</p>\n\t\n\t\n\t\t<input id=\"cyoa-opt1\" type=\"radio\" name=\"cyoa\" value=\"EGA-Archive\" onclick=\"cyoaChoice('EGA-Archive', 'gtn-cyoa')\" />\n\t\t<label for=\"cyoa-opt1\" class=\"select btn btn-secondary\">EGA-Archive</label>\n\t\n\t\n\t\t<input id=\"cyoa-opt2\" type=\"radio\" name=\"cyoa\" value=\"Zenodo\" onclick=\"cyoaChoice('Zenodo', 'gtn-cyoa')\" />\n\t\t<label for=\"cyoa-opt2\" class=\"select btn btn-secondary\">Zenodo</label>\n\t\n\t\n\t\n\n\t\n\t<script>\n\t\tfunction ready(fn) {\n\t\t\tif (document.readyState != 'loading'){\n\t\t\t\tfn();\n\t\t\t} else {\n\t\t\t\tdocument.addEventListener('DOMContentLoaded', fn);\n\t\t\t}\n\t\t}\n\t\tready(function() {\n\t\t\tcyoaDefault(\"EGA-Archive\", \"gtn-cyoa\");\n\t\t})\n\t</script>\n\t\n</blockquote>\n\n<div class=\"Zenodo\">\n  <p>I see, you can’t wait to get DAC access. To download the data from zenodo for this tutorial you can follow the step below.</p>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title>Retrieve data from zenodo</hands-on-title>\n\n    <ol>\n      <li>Import the 3 VCFs from <a href=\"https://zenodo.org/record/6483454\">Zenodo</a> to Galaxy <strong>as a collection</strong>.\n        <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/6483454/files/Case5_F.17.g.vcf.gz\nhttps://zenodo.org/record/6483454/files/Case5_IC.17.g.vcf.gz\nhttps://zenodo.org/record/6483454/files/Case5_M.17.g.vcf.gz\n</code></pre></div>        </div>\n\n        <!--SNIPPET-->\n        <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-via-links\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-via-links\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing via links</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>     <p>Click on <strong>Collection</strong> on the top</p>   </li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li>     <p>Click on <strong>Build</strong> when available</p>   </li>   <li>     <p>Enter a name for the collection</p>   </li>   <li>Click on <strong>Create list</strong> (and wait a bit)</li> </ul> </blockquote>\n        <p><!--END_SNIPPET--></p>\n      </li>\n      <li>\n        <p>Set the datatype to <strong>vcf</strong>.</p>\n      </li>\n      <li>\n        <p>Click on <strong>Start</strong></p>\n      </li>\n      <li>\n        <p>If you forgot to select the <em>“Collections”</em> tab during upload, please put the file in a collection now.</p>\n\n        <!--SNIPPET-->\n        <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-dataset-collection\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-dataset-collection\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a dataset collection</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on <i class=\"far fa-check-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-selector</span> <strong>Select Items</strong> at the top of the history panel <img src=\"/training-material/topics/galaxy-interface/images/historyItemControls.png\" alt=\"Select Items button\" /></li>   <li>Check all the datasets in your history you would like to include</li>   <li>     <p>Click <strong>n of N selected</strong> and choose <strong>Build Dataset List</strong></p>     <p><img src=\"/training-material/topics/galaxy-interface/images/buildList.png\" alt=\"build list collection menu item\" width=\"15%\" /></p>   </li>   <li>Enter a name for your collection</li>   <li>Click <strong>Create collection</strong> to build your collection</li>   <li>Click on the checkmark icon at the top of your history again</li> </ul> </blockquote>\n        <p><!--END_SNIPPET--></p>\n      </li>\n    </ol>\n\n  </blockquote>\n\n</div>\n\n<div class=\"EGA-Archive\">\n\n  <h2 id=\"getting-dac-access\">Getting DAC access</h2>\n  <p>Our test data is stored in EGA, which can be easily accessed using the EGA Download Client. Our specific EGA dataset accession ID is: “EGAD00001008392”. However, before you can access this data you need to request DAC access to this dataset. This can be requested by emailing to <a href=\"mailto:helpdesk@ega-archive.org\">helpdesk@ega-archive.org</a>, don’t forget to mention the dataset ID! When the EGA grants you access it will create an account for you, if you don’t have it already. Next, you should link your account to your Galaxy account by going to the homepage on Galaxy and at the top bar click <strong>User &gt; Preferences &gt; Manage Information</strong>. Now add your email and password of your (new) EGA account under: <strong>Your EGA (european Genome Archive) account</strong>. After that you can check if you can log in and see if you have access to the dataset.</p>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title>Check log-in and authorized datasets</hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/ega_download_client/pyega3/5.0.2+galaxy0\" title=\"EGA Download Client tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>EGA Download Client</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 5.0.2+galaxy0)</span> with the following parameters:\n        <ul>\n          <li><em>“What would you like to do?”</em>: <code class=\"language-plaintext highlighter-rouge\">List my authorized datasets</code></li>\n        </ul>\n      </li>\n    </ol>\n\n    <blockquote class=\"comment\">\n      <comment-title>Check if the dataset is listed.</comment-title>\n\n      <p>Check if your dataset is listed in the output of the tool. If not you can look at the header of the output to find out why it is not listed. When the header does not provide any information you could have a look at the error message by clicking on the <strong>eye</strong> <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> of the output dataset and then click on the icon <strong>view details</strong> <i class=\"fas fa-info-circle\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">details</span>. The error should be listed at <strong>Tool Standard Error</strong>.</p>\n    </blockquote>\n\n  </blockquote>\n\n  <h2 id=\"download-list-of-files\">Download list of files</h2>\n  <p>When you have access to the EGA dataset, you can download all the needed files. However, the EGA dataset contains many different filetypes and cases, but we are only interested in the VCFs from case 5 and, to reduce execution time, the variants on chromosome 17. To be able to donwload these files we first need to request the list of files from which we can download. Make sure to use <strong>version 4+</strong> of the <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/ega_download_client/pyega3/5.0.2+galaxy0\" title=\"EGA Download Client tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>EGA Download Client</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 5.0.2+galaxy0)</span>.</p>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title>Request list of files in the dataset</hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/ega_download_client/pyega3/5.0.2+galaxy0\" title=\"EGA Download Client tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>EGA Download Client</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 5.0.2+galaxy0)</span> <strong>version 4+</strong> with the following parameters:\n        <ul>\n          <li><em>“What would you like to do?”</em>: <code class=\"language-plaintext highlighter-rouge\">List files in a datasets</code></li>\n          <li><em>“EGA Dataset Accession ID?”</em>: <code class=\"language-plaintext highlighter-rouge\">EGAD00001008392</code></li>\n        </ul>\n      </li>\n    </ol>\n\n    <!--SNIPPET-->\n    <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-changing-the-tool-version\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-changing-the-tool-version\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Changing the tool version</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>Tools are frequently updated to new versions. Your Galaxy may have multiple versions of the same tool available. By default, you will be shown the latest version of the tool.</p>   <p><strong>Switching to a different version</strong> of a tool:</p>   <ul>   <li>Open the tool</li>   <li>Click on the <i class=\"fas fa-cubes\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool-versions</span> versions logo at the <strong>top right</strong></li>   <li>Select the desired version from the dropdown list</li> </ul> </blockquote>\n    <p><!--END_SNIPPET--></p>\n\n  </blockquote>\n\n  <h2 id=\"filter-list-of-files\">Filter list of files</h2>\n  <p>Now that we have listed all the files, we need to filter out the files we actually need. We can do this by using a simple regular expression or regex. With regex it will be easy to find or replace patterns within a textfile.</p>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title>Filter out VCFs from list of files</hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_grep_tool/1.1.1\" title=\"Search in textfiles tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Search in textfiles</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.1.1)</span> with the following parameters:\n        <ul>\n          <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Select lines from”</em>: <code class=\"language-plaintext highlighter-rouge\">List of EGA datasets</code> (output of <strong>EGA Download Client</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n          <li><em>“Type of regex”</em>: <code class=\"language-plaintext highlighter-rouge\">Extended (egrep)</code></li>\n          <li><em>“Regular Expression”</em>: <code class=\"language-plaintext highlighter-rouge\">Case5.+17.+vcf.gz$</code> The regex might seem a bit complicated if you never worked with it, however it is quite simple. We simply search for lines which contain our sequence of characters, which are lines that contain Case5 then any character for any length, denoted by the “.+”, until (chromosome) 17 is found and then again any character for any length until the sequence ends with, denoted by the dollar sign, “vcf.gz”.</li>\n          <li><em>“Match type”</em>: <code class=\"language-plaintext highlighter-rouge\">case sensitive</code></li>\n        </ul>\n      </li>\n    </ol>\n\n  </blockquote>\n\n  <h2 id=\"download-files\">Download files</h2>\n  <p>After the filtering you should have a tabular file with 3 lines each containing the ID of a VCF file from case 5, as shown below.</p>\n  <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>EGAF00005573839\t1\t33859685\t53277d993a780e0c295079bf1346ee9f\tCase5_IC.17.g.vcf.gz\nEGAF00005573866\t1\t33350163\t7e612852ee0824be458fbf9aeecaa61a\tCase5_M.17.g.vcf.gz\nEGAF00005573882\t1\t42856357\t14b53924d1492e28ad6078ceb8cfdbc7\tCase5_F.17.g.vcf.gz\n</code></pre></div>  </div>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title>Download listed VCFs</hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/ega_download_client/pyega3/5.0.2+galaxy0\" title=\"EGA Download Client tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>EGA Download Client</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 5.0.2+galaxy0)</span> with the following parameters:\n        <ul>\n          <li><em>“What would you like to do?”</em>: <code class=\"language-plaintext highlighter-rouge\">Download multiple files (based on a file with IDs)</code>\n            <ul>\n              <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Table with IDs to download”</em>: <code class=\"language-plaintext highlighter-rouge\">Filtered list of files</code> (output of <strong>Search in textfiles</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n              <li><em>“Column containing the file IDs”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 1</code></li>\n            </ul>\n          </li>\n        </ul>\n      </li>\n    </ol>\n\n    <p>After the download you should have a collection with one file for each family member, i.e. mother (M), father (F), and case (IC). Make sure the files are recognized as the <strong>vcf_bgzip</strong> format.</p>\n\n    <!--SNIPPET-->\n    <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-changing-the-datatype\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-changing-the-datatype\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Changing the datatype</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, click <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Datatypes</strong> tab on the top</li>   <li>In the <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Assign Datatype</strong>, select <code class=\"language-plaintext highlighter-rouge\">datatypes</code> from “<em>New type</em>” dropdown     <ul>       <li>Tip: you can start typing the datatype into the field to filter the dropdown menu</li>     </ul>   </li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n    <p><!--END_SNIPPET--></p>\n\n  </blockquote>\n\n  <h2 id=\"decompress-vcfs\">Decompress VCFs</h2>\n  <p>Finally, we need to decompress our bgzipped VCFs, since we will use a text manipulation tool as a next step to process the VCFs. To decompress the vcf we will use a built-in tool from Galaxy, which can be accessed by manipulating the file itself in a similair fashion as changing its detected type.</p>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title>Convert compressed vcf to uncompressed.</hands-on-title>\n\n    <p>Open the collection of VCFs and execute the following steps for each VCF.</p>\n\n    <ol>\n      <li>\n        <p>Click on the <strong>pencil</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> of the vcf you want to convert.</p>\n      </li>\n      <li>\n        <p>Click on the <strong>convert tab</strong> <i class=\"fas fa-cog\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-gear</span>.</p>\n      </li>\n      <li>\n        <p>Under <strong>Target datatype</strong> select <code class=\"language-plaintext highlighter-rouge\">vcf (using 'Convert compressed file to uncompressed.')</code></p>\n      </li>\n      <li>\n        <p>Click <i class=\"fas fa-exchange-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">exchange</span> <strong>Create Dataset</strong>.</p>\n      </li>\n    </ol>\n\n    <p>After transforming all the VCFs you need to combine the converted VCFs into a colllection again.</p>\n\n    <!--SNIPPET-->\n    <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-dataset-collection-1\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-dataset-collection-1\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a dataset collection</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on <i class=\"far fa-check-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-selector</span> <strong>Select Items</strong> at the top of the history panel <img src=\"/training-material/topics/galaxy-interface/images/historyItemControls.png\" alt=\"Select Items button\" /></li>   <li>Check the 3 vcf files</li>   <li>     <p>Click <strong>3 of N selected</strong> and choose <strong>Build Dataset List</strong></p>     <p><img src=\"/training-material/topics/galaxy-interface/images/buildList.png\" alt=\"build list collection menu item\" width=\"15%\" /></p>   </li>   <li>Enter a name for your collection</li>   <li>Click <strong>Create collection</strong> to build your collection</li>   <li>Click on the checkmark icon at the top of your history again</li> </ul> </blockquote>\n    <p><!--END_SNIPPET--></p>\n\n  </blockquote>\n\n</div>\n\n<h1 id=\"pre-processing\">Pre-Processing</h1>\n<p>Before starting the analysis, the VCF files have to be pre-processed in order to meet input requirements of the tools which we will use for the downstream analysis.</p>\n\n<h2 id=\"add-chromosome-prefix-to-vcf\">Add chromosome prefix to vcf</h2>\n<p>Firstly, our next tool has some assumptions about our input VCFs. The tool expects the chromosome numbers to start with a prefix <code class=\"language-plaintext highlighter-rouge\">chr</code>. Our VCFs only use the chromosome numbers however, the VCFs just use the chromosome numbers. This is due to a difference in reference genome used when creating the VCFs. To change the prefix in the VCFs we will use regex again.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Add chr prefix using regex</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/galaxyp/regex_find_replace/regexColumn1/1.0.1\" title=\"Column Regex Find And Replace tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Column Regex Find And Replace</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.0.1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Select cells from”</em>: <code class=\"language-plaintext highlighter-rouge\">VCFs</code> (output of <strong>Convert compressed file to uncompressed.</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“using column”</em>: <code class=\"language-plaintext highlighter-rouge\">Column: 1</code></li>\n        <li>In <em>“Check”</em>:\n          <ul>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Check”</em>\n              <ul>\n                <li><em>“Find Regex”</em>: <code class=\"language-plaintext highlighter-rouge\">^([0-9MYX])</code></li>\n                <li><em>“Replacement”</em>: <code class=\"language-plaintext highlighter-rouge\">chr\\1</code></li>\n              </ul>\n            </li>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Check”</em>\n              <ul>\n                <li><em>“Find Regex”</em>: <code class=\"language-plaintext highlighter-rouge\">^(##contig=&lt;.*ID=)([0-9MYX].+)</code></li>\n                <li><em>“Replacement”</em>: <code class=\"language-plaintext highlighter-rouge\">\\1chr\\2</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n  </ol>\n\n  <blockquote class=\"comment\">\n    <comment-title>Explaining the regex.</comment-title>\n\n    <p>The two regex patterns might look complicated but they are quite simple if you break them down in components.</p>\n    <ul>\n      <li>The first check <code class=\"language-plaintext highlighter-rouge\">^([0-9MYX])</code> &gt; <code class=\"language-plaintext highlighter-rouge\">chr\\1</code> adds the <code class=\"language-plaintext highlighter-rouge\">chr</code> prefix to all the non-header line. The check can be broken down into the following elements:\n        <ul>\n          <li><code class=\"language-plaintext highlighter-rouge\">^</code> means that the pattern has to start at the beginning of the line not somewhere randomly in the line.</li>\n          <li><code class=\"language-plaintext highlighter-rouge\">[0-9MYX]</code> means that at this position there should be a character from the list <code class=\"language-plaintext highlighter-rouge\">[]</code>, namely either a number from <code class=\"language-plaintext highlighter-rouge\">0-9</code> or the character <code class=\"language-plaintext highlighter-rouge\">M</code>, <code class=\"language-plaintext highlighter-rouge\">Y</code>, or <code class=\"language-plaintext highlighter-rouge\">X</code>.</li>\n          <li>The replacement pattern <code class=\"language-plaintext highlighter-rouge\">chr\\1</code> means that the prefix <code class=\"language-plaintext highlighter-rouge\">chr</code> has to be inserted before the first match <code class=\"language-plaintext highlighter-rouge\">\\1</code>. Here the first match refers to the pattern in the first brackets <code class=\"language-plaintext highlighter-rouge\">()</code> around the list <code class=\"language-plaintext highlighter-rouge\">[0-9MXY]</code>.</li>\n        </ul>\n      </li>\n      <li>The second check <code class=\"language-plaintext highlighter-rouge\">(##contig=&lt;.*ID=)([0-9MYX].+)</code> &gt; <code class=\"language-plaintext highlighter-rouge\">\\1chr\\2</code> adds the <code class=\"language-plaintext highlighter-rouge\">chr</code> prefix to the contig ids in the header lines. The check can be broken down into the following elements:\n        <ul>\n          <li>The first match, the pattern in the first brackets <code class=\"language-plaintext highlighter-rouge\">##contig=&lt;.*ID=</code>, matches the contig header lines, which start with <code class=\"language-plaintext highlighter-rouge\">##contig=&lt;</code>. It is followed by a match anything <code class=\"language-plaintext highlighter-rouge\">.</code> for zero-or-more times <code class=\"language-plaintext highlighter-rouge\">*</code> until it finds <code class=\"language-plaintext highlighter-rouge\">ID=</code>.</li>\n          <li>The second match, the pattern in the second brackets <code class=\"language-plaintext highlighter-rouge\">[0-9MYX].+</code>, matches the chromosome numbers and characters <code class=\"language-plaintext highlighter-rouge\">[0-9MYX]</code> followed by a matching anything <code class=\"language-plaintext highlighter-rouge\">.</code> for one-or-more times <code class=\"language-plaintext highlighter-rouge\">+</code>.</li>\n          <li>The replacement pattern <code class=\"language-plaintext highlighter-rouge\">\\1chr\\2</code> means that the prefix <code class=\"language-plaintext highlighter-rouge\">chr</code> has to be inserted between the first match <code class=\"language-plaintext highlighter-rouge\">\\1</code> or <code class=\"language-plaintext highlighter-rouge\">##contig=&lt;.*ID=</code> and the second match <code class=\"language-plaintext highlighter-rouge\">\\2</code> or <code class=\"language-plaintext highlighter-rouge\">[0-9MYX].+</code>.</li>\n        </ul>\n      </li>\n    </ul>\n  </blockquote>\n\n</blockquote>\n\n<h2 id=\"normalizing-vcf\">Normalizing VCF</h2>\n<p>After adding the prefixes to the VCFs we need to normalize the variants in the VCF to standardize how the variants are represented within the VCF. This is a very important step, since the variants in the mother and daughter might be represented differently, which would mean that the causative variant might be overlooked!</p>\n\n<p>One of the normalization steps is splitting multiallelic variants, 2 variants detected on the same position but on a different allele. Splitting these records will put the 2 variants on a separate line, that way the impact of the individual mutations can be evaluated. In addition, indels need to be left-aligned and normalized because that’s how they are stored in the annotation databases. An indel is left-aligned and normalized, according to <span class=\"citation\"><a href=\"#Tan2015\">Tan <i>et al.</i> 2015</a></span>, “if and only if it is no longer possible to shift its position to the left while keeping the length of all its alleles constant” and “if it is represented in as few nucleotides as possible”.</p>\n\n<figure id=\"figure-2\" style=\"max-width: 90%;\"><img src=\"../../images/trio-analysis/variant_normalization.png\" alt=\"Image of different representations of the same variant. On the top the variant is shown in the reference sequence GGGCACACACAGGG and the alternate sequence GGGCACACAGGG. Underneath the image is divided into two panels, the left panel aligns each allele to the reference genome, and the right panel represents the variants in a VCF with the columns POS (position), REF (reference), and ALT (alternate). From top to bottom it shows that A is not left-aligned with the reference CAC and the alternate C  at position 6, B is neither left-aligned nor parsimonious with reference GCACA and alternate GCA at position 3, C is not parsimonious with reference GGCA and alternate GG at position 2, and D is normalized with reference GCA and the alternate position G at position 3.\" width=\"700\" height=\"525\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/trio-analysis/variant_normalization.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 2</strong>:</span> The different ways to represent INDELs. (Source: https://academic.oup.com/bioinformatics/article/31/13/2202/196142)</figcaption></figure>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Normalize VCF</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/bcftools_norm/bcftools_norm/1.9+galaxy1\" title=\"bcftools norm tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>bcftools norm</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.9+galaxy1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“VCF/BCF Data”</em>: <code class=\"language-plaintext highlighter-rouge\">VCFs with chr prefix</code> (output of <strong>Text reformatting</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Choose the source for the reference genome”</em>: <code class=\"language-plaintext highlighter-rouge\">Use a built-in genome</code>\n          <ul>\n            <li><em>“Reference genome”</em>: <code class=\"language-plaintext highlighter-rouge\">Human (Homo sapiens): hg19</code></li>\n          </ul>\n        </li>\n        <li><em>“Left-align and normalize indels?”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        <li><em>“~multiallelics”</em>: <code class=\"language-plaintext highlighter-rouge\">split multiallelic sites into biallelic records (-)</code></li>\n        <li>In <em>“Restrict all operations to”</em>:\n          <ul>\n            <li><em>“Regions”</em>: <code class=\"language-plaintext highlighter-rouge\">Do not restrict to Regions</code></li>\n            <li><em>“Targets”</em>: <code class=\"language-plaintext highlighter-rouge\">Do not restrict to Targets</code></li>\n          </ul>\n        </li>\n        <li><em>“output_type”</em>: <code class=\"language-plaintext highlighter-rouge\">uncompressed VCF</code></li>\n      </ul>\n    </li>\n  </ol>\n\n  <blockquote class=\"tip\">\n    <tip-title>Check the normalization summary</tip-title>\n\n    <p>You can have a look at the summary to check what changes were made. First, expand the output of bcftools norm (by clicking on the box) and it should be listed in the box. If not you can find it by clicking on the icon view details <i class=\"fas fa-info-circle\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">details</span> and look at the output of the ToolStandard Error.</p>\n\n  </blockquote>\n\n</blockquote>\n\n<h2 id=\"filter-non_ref-sites\">Filter NON_REF sites</h2>\n<p>After normalizing the VCFs we will filter out the variants with a NON_REF tag in the ALT column, the column which represents the mutated nucleotide(s). According to the header, these sites correspond to: “any possible alternative allele at this location”. So these sites are a sort of placeholders for potential variants. However we are not interested in this kind of variants and they slow our analysis down quite a lot, so we will filter them out.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Filter out NON_REF sites</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"Filter1\" title=\"Filter tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Filter</strong></span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Filter”</em>: <code class=\"language-plaintext highlighter-rouge\">Normalized VCFs</code> (output of <strong>bcftools norm</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“With following condition”</em>: <code class=\"language-plaintext highlighter-rouge\">c5!='&lt;NON_REF&gt;'</code></li>\n        <li><em>“Number of header lines to skip”</em>: <code class=\"language-plaintext highlighter-rouge\">142</code> This has to be set manually since the tool skips lines starting with ‘#’ automatically.</li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>Why didn’t we filter out the NON_REF site directly after filtering? Have a look at the VCFs before and after normalization.</li>\n    <li>Could we have filtered out the NON_REF sites earlier with a different program?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n    <ol>\n      <li>The <code class=\"language-plaintext highlighter-rouge\">&lt;NON_REF&gt;</code> sites were sometimes also represented as a multi allelic variant e.g., <code class=\"language-plaintext highlighter-rouge\">chr17\t302\t.\tT\tTA,&lt;NON_REF&gt;</code> which would not be filtered out with the <span class=\"tool\" data-tool=\"Filter1\" title=\"Filter tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Filter</strong></span> tool.</li>\n      <li>Possibly, if the <code class=\"language-plaintext highlighter-rouge\">&lt;NON_REF&gt;</code> variants were filtered out and if the <code class=\"language-plaintext highlighter-rouge\">&lt;NON_REF&gt;</code> tag was removed from multi-allelic variants. However, the last task (splitting multi-allelic sites) can already be handled by <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/bcftools_norm/bcftools_norm/1.9+galaxy1\" title=\"bcftools norm tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>bcftools norm</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.9+galaxy1)</span> and it might involve more sophisticated steps to properly split these variants.</li>\n    </ol>\n  </blockquote>\n\n</blockquote>\n\n<h2 id=\"merge-vcf-collection-into-one-dataset\">Merge VCF collection into one dataset</h2>\n<p>Finally, we can merge the 3 separate files of the parents and patient into a single VCF. This will put overlapping variants on the same line by aligning the samples format column. If a sample misses a certain variant then on the line of that variant the sample’s format information will look like this: <code class=\"language-plaintext highlighter-rouge\">./.:.:.:.:.:.</code>. This makes it easier to find shared and missing variants between the parents and ofspring. A tool which can do this is the <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/bcftools_merge/bcftools_merge/1.10\" title=\"bcftools merge tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>bcftools merge</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.10)</span> tool.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Merge VCFs</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/bcftools_merge/bcftools_merge/1.10\" title=\"bcftools merge tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>bcftools merge</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.10)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Other VCF/BCF Datasets”</em>: <code class=\"language-plaintext highlighter-rouge\">&lt;NON_REF&gt; filtered VCFs</code> (output of <strong>Text reformatting</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li>In <em>“Restrict to”</em>:\n          <ul>\n            <li><em>“Regions”</em>: <code class=\"language-plaintext highlighter-rouge\">Do not restrict to Regions</code></li>\n          </ul>\n        </li>\n        <li>In <em>“Merge Options”</em>:\n          <ul>\n            <li><em>“Merge”</em>: <code class=\"language-plaintext highlighter-rouge\">none - no new multiallelics, output multiple records instead</code></li>\n          </ul>\n        </li>\n        <li><em>“output_type”</em>: <code class=\"language-plaintext highlighter-rouge\">uncompressed VCF</code></li>\n      </ul>\n\n      <blockquote class=\"comment\">\n        <comment-title>Checking the merged VCF.</comment-title>\n\n        <p>Check the merged VCF, now each line should contain 3 sample columns, namely <code class=\"language-plaintext highlighter-rouge\">Case6F</code>, <code class=\"language-plaintext highlighter-rouge\">Case6M</code>, and <code class=\"language-plaintext highlighter-rouge\">Case6C</code>. These columns represent the presence of the variant for the mother, father, and offspring.</p>\n      </blockquote>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h1 id=\"annotation\">Annotation</h1>\n<p>To understand what the effect of our variants are, we need to annotate our variants. We will use the tool <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/snpeff/snpEff/4.3+T.galaxy1\" title=\"SnpEff eff tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>SnpEff eff</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 4.3+T.galaxy1)</span>, which will compare our variants to a database of variants with known effects.</p>\n\n<h2 id=\"annotate-with-snpeff\">Annotate with SNPeff</h2>\n<p>Running SnpEff will produce the annotated VCF and an HTML summary file. The annotations are added to the INFO column in the VCF and the added INFO IDs (<code class=\"language-plaintext highlighter-rouge\">ANN</code>, <code class=\"language-plaintext highlighter-rouge\">LOF</code>, and <code class=\"language-plaintext highlighter-rouge\">NMD</code>) are explained in the header. The summary files include the HTML stats file which contains general metrics, such as the number of annotated variants, the impact of all the variants, and much more.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Annotation with SnpEff</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/snpeff/snpEff/4.3+T.galaxy1\" title=\"SnpEff eff: tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>SnpEff eff:</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 4.3+T.galaxy1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Sequence changes (SNPs, MNPs, InDels)”</em>: <code class=\"language-plaintext highlighter-rouge\">Merged VCF</code> (output of <strong>bcftools merge</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Output format”</em>: <code class=\"language-plaintext highlighter-rouge\">VCF (only if input is VCF)</code></li>\n        <li><em>“Genome source”</em>: <code class=\"language-plaintext highlighter-rouge\">Locally installed snpEff database</code>\n          <ul>\n            <li><em>“Genome”</em>: <code class=\"language-plaintext highlighter-rouge\">Homo sapiens : hg19</code></li>\n          </ul>\n        </li>\n        <li><em>“spliceRegion Settings”</em>: <code class=\"language-plaintext highlighter-rouge\">Use Defaults</code></li>\n        <li><em>“Filter out specific Effects”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>How many variants got annotated?</li>\n    <li>Is there something notable you can see from the HTML file?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n    <ol>\n      <li>The number of variants processed is 209,143.</li>\n      <li>Most variants are found in the intronic regions. However, this is to be expected since the mutations in intonic regions generally do not affect the gene.</li>\n    </ol>\n  </blockquote>\n\n</blockquote>\n\n<h2 id=\"compress-vcf\">Compress VCF</h2>\n<p>Now that we have finished running all the tools which require the VCF format as input, they can be converted back to the <strong>vcf_bgzip</strong> format. To compress the VCF we will use a built-in tool from Galaxy, which can be accessed by manipulating the file itself in a similair fashion as changing its detected type.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title> Compress **vcf** back to **vcf_bgzip** </hands-on-title>\n\n  <p>Execute the following steps for the SnpEff VCF.</p>\n\n  <ol>\n    <li>\n      <p>Click on the <strong>pencil</strong> <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> of the SnpEff VCF.</p>\n    </li>\n    <li>\n      <p>Click on the <strong>convert tab</strong> <i class=\"fas fa-cog\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-gear</span>.</p>\n    </li>\n    <li>\n      <p>Under <strong>Target datatype</strong> select <code class=\"language-plaintext highlighter-rouge\">vcf_bgzip (using 'Convert uncompressed file to compressed.')</code></p>\n    </li>\n    <li>\n      <p>Click <i class=\"fas fa-exchange-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">exchange</span> <strong>Create Dataset</strong>.</p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h1 id=\"trio-analysis\">Trio Analysis</h1>\n\n<h2 id=\"gemini-analyses\">GEMINI analyses</h2>\n<p>Next, we will transform our VCF into a GEMINI database which makes it easier to query the VCFs and to determine different inheritence patterns between the mother, father, and offspring. In addition, GEMINI will add even more annotations to the variants. This allows us to filter the variants even more which gets us to closer to the real causative variant.\nAll these steps are performed by the <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/gemini_load/gemini_load/0.20.1+galaxy2\" title=\"GEMINI load tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>GEMINI load</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.20.1+galaxy2)</span> tool. However, before we can load the VCF we also need to define a pedigree file.</p>\n\n<h3 id=\"create-a-pedigree-file-describing-the-family-trio\">Create a pedigree file describing the family trio</h3>\n<p>A pedigree file is a file that informs GEMINI which family members are affected by the disease and which sample name corresponds to what individual. This information is saved as a table containing information about the phenotype of the family.</p>\n\n<ol>\n  <li><strong>#family_id</strong>: Which family a row belongs to.</li>\n  <li><strong>name</strong>: The name of the sample, note this sample name has to overlap with the sample name in the VCF, see the last 3 columns of the VCF. However, for some reason the VCF contains the sample name from case 6 and not case 5. This was probably just a typo in the VCF, however here we just copy the sample name to our pedigree file.</li>\n  <li><strong>paternal_id</strong>: The sample name of the father or 0 for missing.</li>\n  <li><strong>maternal_id</strong>: The sample name of the mother or 0 for missing.</li>\n  <li><strong>sex</strong>: The sex of the person.</li>\n  <li><strong>phenotype</strong>: Wether or not the person is affected by the disease.</li>\n</ol>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Creating the PED file</hands-on-title>\n\n  <ol>\n    <li>Upload the pedigree file from below.\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>#family_id\tname\tpaternal_id\tmaternal_id\tsex\tphenotype\nFAM0001822\tCase6M\t0\t0\t2\t2\nFAM0001822\tCase6F\t0\t0\t1\t1\nFAM0001822\tCase6C\tCase6F\tCase6M\t2\t2\n</code></pre></div>      </div>\n    </li>\n  </ol>\n\n  <!--SNIPPET-->\n  <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-new-file\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-new-file\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a new file</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong> at the bottom</li>   <li>Paste the file contents into the text field</li>   <li>Press <strong>Start</strong> and <strong>Close</strong> the window</li> </ul> </blockquote>\n  <p><!--END_SNIPPET--></p>\n\n</blockquote>\n\n<p>For more information on the PED file you can read the help section of the <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/gemini_load/gemini_load/0.20.1+galaxy2\" title=\"GEMINI load tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>GEMINI load</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.20.1+galaxy2)</span> tool in the description, which can be found at the bottom of the page when clicking on the tool.</p>\n\n<h3 id=\"load-gemini-database\">Load GEMINI database</h3>\n<p>Now we can transform the subsampled VCF and PED file into a GEMINI database. Note that this can take a very long time depending on the size of the VCF. In our case it should take around 30-40 minutes.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Transform VCF and PED files into a GEMINI database</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/gemini_load/gemini_load/0.20.1+galaxy2\" title=\"GEMINI load tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>GEMINI load</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.20.1+galaxy2)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“VCF dataset to be loaded in the GEMINI database”</em>: <code class=\"language-plaintext highlighter-rouge\">SnpEff Annotated vcf_bgzip</code> (output of <strong>Convert uncompressed file to compressed.</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Sample and family information in PED format”</em>: the pedigree file prepared above</li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h3 id=\"find-inheritance-pattern\">Find inheritance pattern</h3>\n<p>With the GEMINI database it is now possible to identify the causative variant that could explain the breast cancer in the mother and daughter. The inheritance information makes it a bit easier to determine which tool to run to find the causative variant, instead of finding it by trying all the different inheritance patterns.</p>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>Which inheritance pattern could have occurred in this family trio?</p>\n\n  <blockquote class=\"tip\">\n    <tip-title>Possible patterns</tip-title>\n    <p>The available inheritance patterns can be found in the <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/gemini_inheritance/gemini_inheritance/0.20.1\" title=\"GEMINI inheritance pattern tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>GEMINI inheritance pattern</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.20.1)</span> tool.</p>\n  </blockquote>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ul>\n      <li>Since both the daughter and mother are affected, and the father likely unaffected<sup id=\"fnref:1\" role=\"doc-noteref\"><a href=\"#fn:1\" class=\"footnote\" rel=\"footnote\">1</a></sup>, the mutation is most probably dominant. The disease could still be recessive if the father has one copy of the faulty gene, however this is less likely.</li>\n      <li>The mutation is most likely not de-novo, since both the daughter and mother are affected.</li>\n      <li>The mutation could be X-linked, however since the VCF only contain mutations on chromosome 17 it would practically be impossible.</li>\n      <li>The disease could be compound heterozygous, however in that case the disease should be recessive which is less likely.</li>\n      <li>A loss of heterozygosity (LOH) is also possible, since it is a common occurrence in cancer so this could be a viable inheritance pattern.</li>\n    </ul>\n\n  </blockquote>\n\n</blockquote>\n\n<p>Based on these findings it would make sense to start looking for inherited autosomal dominant variants as a first step. If there are no convincing candidate mutations it would always be possible to look at the other less likely inheritance patterns, namely de-novo, compound heterozygous, and LOH events.</p>\n\n<p>To find the most plausible causative variant we will use the <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/gemini_inheritance/gemini_inheritance/0.20.1\" title=\"GEMINI inheritance pattern tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>GEMINI inheritance pattern</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.20.1)</span> tool. This tool allows us to select the most likely inheritance pattern (autosomal dominant). Below it is explained how to run the tool for this specific pattern, but you can always try other inheritence patterns if you are curious.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Run GEMINI autosomal dominant inhertiance pattern</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/gemini_inheritance/gemini_inheritance/0.20.1\" title=\"GEMINI inheritance pattern tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>GEMINI inheritance pattern</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.20.1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“GEMINI database”</em>: <code class=\"language-plaintext highlighter-rouge\">GEMINI database</code> (output of <strong>GEMINI load</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Your assumption about the inheritance pattern of the phenotype of interest”</em>: <code class=\"language-plaintext highlighter-rouge\">Autosomal dominant</code>\n          <ul>\n            <li>In <em>“Additional constraints on variants”</em>:\n              <ul>\n                <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Insert Additional constraints on variants”</em>\n                  <ul>\n                    <li><em>“Additional constraints expressed in SQL syntax”</em>: <code class=\"language-plaintext highlighter-rouge\">impact_severity != 'LOW'</code> To filter variants on their functional genomic impact we will use the impact_severity feature. Here a low severity means a variant with no impact on protein function, such as silent mutations.</li>\n                  </ul>\n                </li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n        <li>In <em>“Family-wise criteria for variant selection”</em>:\n          <ul>\n            <li><em>“Specify additional criteria to exclude families on a per-variant basis”</em>: <code class=\"language-plaintext highlighter-rouge\">No, analyze all variants from all included families</code></li>\n          </ul>\n        </li>\n        <li>In <em>“Output - included information”</em>:\n          <ul>\n            <li><em>“Set of columns to include in the variant report table”</em>: <code class=\"language-plaintext highlighter-rouge\">Custom (report user-specified columns)</code>\n              <ul>\n                <li><em>“Additional columns (comma-separated)”</em>: <code class=\"language-plaintext highlighter-rouge\">chrom, start, ref, alt, impact, gene, clinvar_sig, clinvar_disease_name, clinvar_gene_phenotype, rs_ids</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>Did you find the causative variant in the output of the GEMINI inheritance pattern tool?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n    <p>The only pathogenic variant related to breast cancer in the output, according to clinvar, is a SNP at chr17 at position 41215919 on the BRCA1 gene which transforms a G into a T, which is shown below.</p>\n    <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>chr17\t41215919\tG\tT\tmissense_variant\tBRCA1\tpathogenic,other\n</code></pre></div>    </div>\n    <p>This missense mutation transforms an alanine amino acid into a glutamine amino acid. Even though this variant has an unknown clinical significance in BRCA1 it was found to be among the top 10 SNPs which likely leads to breast cancer, according to <span class=\"citation\"><a href=\"#Easton2007\">Easton <i>et al.</i> 2007</a></span>. You can find more info on this mutation by googling it’s rs_ID rs28897696.</p>\n  </blockquote>\n\n</blockquote>\n\n<h2 id=\"geneiobio-analyses\">Gene.iobio Analyses</h2>\n<p>Alternatively, the trio analysis can be done using gene.iobio <span class=\"citation\"><a href=\"#Di_Sera_2021\">Sera <i>et al.</i> 2021</a></span>. The <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/geneiobio/gene_iobio_display_generation_iframe/4.7.1\" title=\"gene.iobio visualisation tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>gene.iobio visualisation</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 4.7.1)</span> tool generates an html file which sends the VCFs to the iobio site using public URLs. Therefore, your history has to be shared, i.e. <strong>everyone with a link can access your history!</strong></p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title> Make files accessible for gene.iobio </hands-on-title>\n\n  <ol>\n    <li>Open the <strong>History Options menu</strong> <i class=\"fas fa-caret-down\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-dropdown</span> at the topright corner of your history panel.</li>\n    <li>select <strong>Share or Publish</strong> <i class=\"fas fa-share-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">workflow</span>.</li>\n    <li>Then toggle the <i class=\"fas fa-toggle-on\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-toggle</span> <strong>Make History accessible</strong>.</li>\n  </ol>\n\n</blockquote>\n\n<p>For this tool it is not required to set any filtering steps or determine the most plausible inheritence pattern. Since gene.iobio runs multiple default filtering steps for autosomal dominant, recessive, <em>De novo</em>, compound heterozygous, and X-linked recessive inheritance patterns. In addition, it prioritizes variants based on gene-disease association algorithms, which significantly reduces processing time.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title> Generate gene.iobio html </hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/geneiobio/gene_iobio_display_generation_iframe/4.7.1\" title=\"gene.iobio visualisation tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>gene.iobio visualisation</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 4.7.1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Proband VCF file”</em>: <code class=\"language-plaintext highlighter-rouge\">SnpEff Annotated vcf_bgzip</code> (output of <strong>Convert compressed file to uncompressed.</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Proband sex”</em>: <code class=\"language-plaintext highlighter-rouge\">Female</code></li>\n        <li><em>“Proband sample name”</em>: <code class=\"language-plaintext highlighter-rouge\">Case6C</code></li>\n        <li><em>“Single/Trio analysis”</em>: <code class=\"language-plaintext highlighter-rouge\">Trio</code>\n          <ul>\n            <li>In <em>“Father input”</em>:\n              <ul>\n                <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Father VCF file”</em>: <code class=\"language-plaintext highlighter-rouge\">SnpEff Annotated vcf_bgzip</code> (output of <strong>Convert compressed file to uncompressed.</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n                <li><em>“Father sample name”</em>: <code class=\"language-plaintext highlighter-rouge\">Case6F</code></li>\n              </ul>\n            </li>\n            <li>In <em>“Mother input”</em>:\n              <ul>\n                <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Mother VCF file”</em>: <code class=\"language-plaintext highlighter-rouge\">SnpEff Annotated vcf_bgzip</code> (output of <strong>Convert compressed file to uncompressed.</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n                <li><em>“Is the mother affected?”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n                <li><em>“Mother sample name”</em>: <code class=\"language-plaintext highlighter-rouge\">Case6M</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n        <li><em>“Select reference genome version”</em>: <code class=\"language-plaintext highlighter-rouge\">GRCh37</code></li>\n      </ul>\n\n      <blockquote class=\"tip\">\n        <tip-title> Using gene.iobio </tip-title>\n\n        <p>To open the generated html file click on the <strong>eye</strong> <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span>, which will show the gene.iobio interface. Now a phenotype has to be added to generate a list of genes which likely contain causative variants, in this case it is breast cancer. Next, click on the <strong>Hamburger icon</strong> in the topleft corner of the gene.iobio interface. This will show 20 genes including the BRCA1 gene with the causative variant under the <strong>Genes</strong> tab. Click on the BRCA1 gene and gene.iobio starts analyzing the gene for causative variants. Then under the <strong>Variants</strong> tab you will find the causative variant listed. You can click on the variant block to see more information on it. A report will show with information on the type, location, and quality of the variant, the associated phenotype, the pathogenicity, the population frequency, conservation of the location of the variant, and the inheritence pattern (Autosomal dominant).</p>\n      </blockquote>\n\n      <blockquote class=\"tip\">\n        <tip-title> Increase genes to analyze </tip-title>\n\n        <p>More genes can be analyzed in three ways 1) the generated list of genes associated with a phenotypm can be increased. 2) The list of genes associated with another phenotype can be combined with the current list of genes. 3) A gene can manually be added.</p>\n\n        <ol>\n          <li>To increase the number of genes in the generated list of genes click on the <strong>gear icon</strong> <i class=\"fas fa-cog\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-gear</span> in gene.iobio and click on the drop down box under <strong>Keep top n genes from phenotype search</strong>.</li>\n          <li>To add more genes to the analysis type and select another phenotype in the top bar. After finding your phenotype of interest press enter and click <strong>Combine genes with current list</strong> in the pop-up screen.</li>\n          <li>To add a single gene to the analysis type and select a gene name in the top bar. After finding your gene of interest press enter.</li>\n        </ol>\n      </blockquote>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h1 id=\"conclusion\">Conclusion</h1>\n<p>In this tutorial we have illustrated how to easily download a dataset of interest savely and securely from the EGA using the HTSGET protocol. In addition, we performed a trio analysis to find the causative variant in an autosomal dominant inherited disease. We pre-processed and annotated our VCFs using the SnpEff and found the causative variant using both the GEMINI and gene.iobio tool. With this workflow you can now easily analyse and find the causative variant(s) in many different family trios from any database which HTSGET can connect to.</p>\n\n<h1 id=\"workflow\">Workflow</h1>\n<p>Here is the final layout of the workflow. For more details you can download the workflow from the overview at the top of the page.</p>\n\n<figure id=\"figure-3\" style=\"max-width: 90%;\"><img src=\"../../images/trio-analysis/workflow.png\" alt=\"Image showing the whole workflow of the tutorial. Each seperate step is represented by a rectangular block with the tool name in the upper part in blue and the lower part shows the output in white. In the top left the workflow starts with the EGA Download Client which ouputs the authorized datasets (txt), below that again the EGA Download Client is shown which outputs the list of files in the ega dataset, which is connected to the search in textfiles tool. That tool is connected again to an EGA Download Client step where the VCFs are downloaded using the list of files from the previous tool. This step is connected to a decompress step to change the bgzipped VCFs to regular VCFs. That step is connected to a Filter step which outputs a VCF. The next connected step is the bcftools norm tool which outputs a normalized VCF. Then the normalized VCFs are processed using the Text reformatting tool. Using the output from that step the bcftools megre step is used to output a single VCF and connect it to the SnpEff eff tool. This tool annotates the VCF and that step is connected to the GEMINI load tool which is also connected to step block with the title pedigree. Then the GEMINI load tool connects to the GEMINI inheritance pattern block which outputs an tabular file called GEMINI autosomal_dominant pattern. \" width=\"1208\" height=\"678\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/trio-analysis/workflow.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 3</strong>:</span> The workflow to download the VCFs and find the causative variant. If you skipped the EGA download step then the workflow starts at the second column. Here each column represents a seperate step, from left to right the steps are: Data preparation, Pre-Processing, Annotation, and GEMINI analysis.</figcaption></figure>\n\n<div class=\"footnotes\" role=\"doc-endnotes\">\n  <ol>\n    <li id=\"fn:1\" role=\"doc-endnote\">\n      <p>It is unlikely that the father has breast cancer, “For men, the lifetime risk of getting breast cancer is about 1 in 833” <a href=\"https://www.cancer.org/cancer/breast-cancer-in-men/about/key-statistics.html\">via cancer.org</a> <a href=\"#fnref:1\" class=\"reversefootnote\" role=\"doc-backlink\">&#8617;</a></p>\n    </li>\n  </ol>\n</div>\n"],"ref_slides":[],"hands_on":true,"slides":false,"mod_date":"2024-05-29 14:28:52 +0000","pub_date":"2022-05-19 12:25:33 +0000","version":45,"workflows":[{"workflow":"main_workflow.ga","tests":true,"url":"https://training.galaxyproject.org/training-material/topics/variant-analysis/tutorials/trio-analysis/workflows/main_workflow.ga","path":"topics/variant-analysis/tutorials/trio-analysis/workflows/main_workflow.ga","wfid":"variant-analysis-trio-analysis","wfname":"main_workflow","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/variant-analysis-trio-analysis/versions/main_workflow","license":"MIT","creators":[{"class":"Person","identifier":"0000-0003-2556-2125","name":"Jasper Ouwerkerk"}],"name":"Trio Analysis Tutorial","title":"Trio Analysis Tutorial","test_results":null,"modified":"2024-06-18 00:05:46 +0000","mermaid":"flowchart TD\n  0[\"EGA Download Client\"];\n  85672f3a-1556-49b6-be09-2e6c81721fb3[\"Output\\nEGA Download Client: authorized datasets\"];\n  0 --> 85672f3a-1556-49b6-be09-2e6c81721fb3;\n  style 85672f3a-1556-49b6-be09-2e6c81721fb3 stroke:#2c3143,stroke-width:4px;\n  1[\"EGA Download Client\"];\n  acd2bcf0-4b9d-4743-9034-716e73d4824f[\"Output\\nList of files in EGAD00001008392\"];\n  1 --> acd2bcf0-4b9d-4743-9034-716e73d4824f;\n  style acd2bcf0-4b9d-4743-9034-716e73d4824f stroke:#2c3143,stroke-width:4px;\n  2[\"ℹ️ Input Dataset\\npedigree\"];\n  style 2 stroke:#2c3143,stroke-width:4px;\n  3[\"Search in textfiles\"];\n  1 -->|dataset_file_list| 3;\n  6d5d135e-a373-4938-9374-019a09f45a51[\"Output\\nList of Case 5 VCFs\"];\n  3 --> 6d5d135e-a373-4938-9374-019a09f45a51;\n  style 6d5d135e-a373-4938-9374-019a09f45a51 stroke:#2c3143,stroke-width:4px;\n  4[\"EGA Download Client\"];\n  3 -->|output| 4;\n  bdce7169-390b-4adb-9305-5550d5d70a73[\"Output\\nCase 5 VCFs.gz\"];\n  4 --> bdce7169-390b-4adb-9305-5550d5d70a73;\n  style bdce7169-390b-4adb-9305-5550d5d70a73 stroke:#2c3143,stroke-width:4px;\n  5[\"Convert compressed file to uncompressed.\"];\n  4 -->|downloaded_file_collection| 5;\n  82b71cdc-d813-4c77-8ff3-fa59e1725709[\"Output\\nCase 5 VCFs\"];\n  5 --> 82b71cdc-d813-4c77-8ff3-fa59e1725709;\n  style 82b71cdc-d813-4c77-8ff3-fa59e1725709 stroke:#2c3143,stroke-width:4px;\n  6[\"Column Regex Find And Replace\"];\n  5 -->|output1| 6;\n  5e1ff158-cf8a-4dc8-9c22-b987a9f5ac27[\"Output\\nCase 5 VCFs (Fixed Header and Chr)\"];\n  6 --> 5e1ff158-cf8a-4dc8-9c22-b987a9f5ac27;\n  style 5e1ff158-cf8a-4dc8-9c22-b987a9f5ac27 stroke:#2c3143,stroke-width:4px;\n  7[\"bcftools norm\"];\n  6 -->|out_file1| 7;\n  96b34c8d-fa92-48cb-b01f-c05364deba5d[\"Output\\nCase 5 Normalized VCFs\"];\n  7 --> 96b34c8d-fa92-48cb-b01f-c05364deba5d;\n  style 96b34c8d-fa92-48cb-b01f-c05364deba5d stroke:#2c3143,stroke-width:4px;\n  8[\"Filter\"];\n  7 -->|output_file| 8;\n  a8539eb9-8bc3-473b-a27f-201c3acf5539[\"Output\\nCase 5 Normalized VCFs (Removed <NON_REF>)\"];\n  8 --> a8539eb9-8bc3-473b-a27f-201c3acf5539;\n  style a8539eb9-8bc3-473b-a27f-201c3acf5539 stroke:#2c3143,stroke-width:4px;\n  9[\"bcftools merge\"];\n  8 -->|out_file1| 9;\n  b5c479b2-e58a-4fe2-b1cf-fc64476c8192[\"Output\\nCase 5 Merged VCF\"];\n  9 --> b5c479b2-e58a-4fe2-b1cf-fc64476c8192;\n  style b5c479b2-e58a-4fe2-b1cf-fc64476c8192 stroke:#2c3143,stroke-width:4px;\n  10[\"SnpEff eff:\"];\n  9 -->|output_file| 10;\n  cd7b4941-4f4c-4631-8ad5-3411e60fbbd9[\"Output\\nCase 5 SnpEff Annotated vcf\"];\n  10 --> cd7b4941-4f4c-4631-8ad5-3411e60fbbd9;\n  style cd7b4941-4f4c-4631-8ad5-3411e60fbbd9 stroke:#2c3143,stroke-width:4px;\n  11[\"Convert uncompressed file to compressed\"];\n  10 -->|snpeff_output| 11;\n  6e5e1084-b5e1-4daf-8f3b-bd3868a52a25[\"Output\\nSnpEff Annotated vcf_bgzip\"];\n  11 --> 6e5e1084-b5e1-4daf-8f3b-bd3868a52a25;\n  style 6e5e1084-b5e1-4daf-8f3b-bd3868a52a25 stroke:#2c3143,stroke-width:4px;\n  12[\"gene.iobio visualisation\"];\n  11 -->|output1| 12;\n  11 -->|output1| 12;\n  11 -->|output1| 12;\n  0b30f4e0-7328-4479-8a56-bbf828fcfdba[\"Output\\nCase 5 gene.iobio results\"];\n  12 --> 0b30f4e0-7328-4479-8a56-bbf828fcfdba;\n  style 0b30f4e0-7328-4479-8a56-bbf828fcfdba stroke:#2c3143,stroke-width:4px;\n  13[\"Case 5 GEMINI Database\"];\n  11 -->|output1| 13;\n  2 -->|output| 13;\n  8a1964d9-607c-4dd3-a2dc-0f9a68dbb681[\"Output\\nGEMINI Database\"];\n  13 --> 8a1964d9-607c-4dd3-a2dc-0f9a68dbb681;\n  style 8a1964d9-607c-4dd3-a2dc-0f9a68dbb681 stroke:#2c3143,stroke-width:4px;\n  14[\"Case 5 GEMINI Inheritance pattern\"];\n  13 -->|outfile| 14;\n  960ef978-089c-4292-81b5-731965c72a0d[\"Output\\nCase 5 GEMINI results\"];\n  14 --> 960ef978-089c-4292-81b5-731965c72a0d;\n  style 960ef978-089c-4292-81b5-731965c72a0d stroke:#2c3143,stroke-width:4px;"}],"api":"https://training.galaxyproject.org/training-material/api/topics/variant-analysis/tutorials/trio-analysis/tutorial.json","tools":["CONVERTER_gz_to_uncompressed","CONVERTER_uncompressed_to_gz","Filter1","toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_grep_tool/1.1.1","toolshed.g2.bx.psu.edu/repos/galaxyp/regex_find_replace/regexColumn1/1.0.1","toolshed.g2.bx.psu.edu/repos/iuc/bcftools_merge/bcftools_merge/1.10","toolshed.g2.bx.psu.edu/repos/iuc/bcftools_norm/bcftools_norm/1.9+galaxy1","toolshed.g2.bx.psu.edu/repos/iuc/ega_download_client/pyega3/5.0.2+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/gemini_inheritance/gemini_inheritance/0.20.1","toolshed.g2.bx.psu.edu/repos/iuc/gemini_load/gemini_load/0.20.1+galaxy2","toolshed.g2.bx.psu.edu/repos/iuc/geneiobio/gene_iobio_display_generation_iframe/4.7.1","toolshed.g2.bx.psu.edu/repos/iuc/snpeff/snpEff/4.3+T.galaxy1"],"supported_servers":{"exact":[{"url":"https://usegalaxy.eu","name":"UseGalaxy.eu","usegalaxy":true}],"inexact":[{"url":"https://usegalaxy.cz/","name":"UseGalaxy.cz","usegalaxy":false}]},"topic_name_human":"Variant Analysis","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"text_processing","owner":"bgruening","revisions":"d698c222f354","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"regex_find_replace","owner":"galaxyp","revisions":"ae8c4b2488e7","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"bcftools_merge","owner":"iuc","revisions":"86296490704e","tool_panel_section_label":"Variant Calling","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"bcftools_norm","owner":"iuc","revisions":"da6fc9f4a367","tool_panel_section_label":"Variant Calling","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"ega_download_client","owner":"iuc","revisions":"7d87a9d58aa1","tool_panel_section_label":"Get Data","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"gemini_inheritance","owner":"iuc","revisions":"2c68e29c3527","tool_panel_section_label":"Gemini","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"gemini_load","owner":"iuc","revisions":"2270a8b83c12","tool_panel_section_label":"Gemini","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"geneiobio","owner":"iuc","revisions":"c0af7b196a89","tool_panel_section_label":"Graph/Display Data","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"snpeff","owner":"iuc","revisions":"5c7b70713fb5","tool_panel_section_label":"Variant Calling","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: text_processing\n  owner: bgruening\n  revisions: d698c222f354\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: regex_find_replace\n  owner: galaxyp\n  revisions: ae8c4b2488e7\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bcftools_merge\n  owner: iuc\n  revisions: 86296490704e\n  tool_panel_section_label: Variant Calling\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bcftools_norm\n  owner: iuc\n  revisions: da6fc9f4a367\n  tool_panel_section_label: Variant Calling\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: ega_download_client\n  owner: iuc\n  revisions: 7d87a9d58aa1\n  tool_panel_section_label: Get Data\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: gemini_inheritance\n  owner: iuc\n  revisions: 2c68e29c3527\n  tool_panel_section_label: Gemini\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: gemini_load\n  owner: iuc\n  revisions: 2270a8b83c12\n  tool_panel_section_label: Gemini\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: geneiobio\n  owner: iuc\n  revisions: c0af7b196a89\n  tool_panel_section_label: Graph/Display Data\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: snpeff\n  owner: iuc\n  revisions: 5c7b70713fb5\n  tool_panel_section_label: Variant Calling\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":false,"slides_recordings":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial"}