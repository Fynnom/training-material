{"layout":"tutorial_hands_on","title":"Exome sequencing data analysis for diagnosing a genetic disease","subtopic":"human-genetics-cancer","zenodo_link":"https://doi.org/10.5281/zenodo.3054169","questions":["How do you identify genetic variants in samples based on exome sequencing data?","How do you, among the set of detected variants, identify candidate causative variants for a given phenotype/disease?"],"objectives":["Jointly call variants and genotypes for a family trio from whole-exome sequencing data","Use variant annotation and the observed inheritance pattern of a phenotype to identify candidate causative variants and to prioritize them"],"time_estimation":"5h","key_points":["Exome sequencing is an efficient way to identify disease-relevant genetic variants.","Freebayes is a good variant and genotype caller for the joint analysis of multiple samples. It is straightforward to use and requires only minimal processing of mapped reads.","Variant annotation and being able to exploit genotype information across family members is key to identifying candidate disease variants. SnpEff and GEMINI, in particular, are powerful tools offered by Galaxy for that purpose."],"contributors":[{"name":"Wolfgang Maier","orcid":"0000-0002-9464-6640","matrix":"wm75:matrix.org","joined":"2017-09","elixir_node":"de","fediverse":"https://scholar.social/@zerodivision","fediverse_flavor":"mastodon","affiliations":["by-covid","uni-freiburg","elixir-europe"],"id":"wm75","url":"https://training.galaxyproject.org/training-material/api/contributors/wm75.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/wm75/"},{"name":"Bérénice Batut","email":"berenice.batut@gmail.com","twitter":"bebatut","linkedin":"berenicebatut","matrix":"bebatut:matrix.org","orcid":"0000-0001-9852-1987","joined":"2017-09","elixir_node":"fr","contact_for_training":true,"location":{"country":"FR","lat":45.77,"lon":3.08},"fediverse":"https://piaille.fr/@bebatut","fediverse_flavor":"mastodon","affiliations":["gallantries","ifb","elixir-europe"],"id":"bebatut","url":"https://training.galaxyproject.org/training-material/api/contributors/bebatut.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/bebatut/"},{"name":"Torsten Houwaart","joined":"2017-09","elixir_node":"de","former_affiliations":["uni-freiburg","elixir-europe"],"id":"torhou","url":"https://training.galaxyproject.org/training-material/api/contributors/torhou.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/torhou/"},{"name":"Anika Erxleben","email":"anikaerxleben@gmail.com","orcid":"0000-0002-7427-6478","joined":"2017-09","elixir_node":"de","affiliations":["eurosciencegateway","uni-freiburg","elixir-europe"],"id":"erxleben","url":"https://training.galaxyproject.org/training-material/api/contributors/erxleben.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/erxleben/"},{"name":"Björn Grüning","email":"bjoern.gruening@gmail.com","twitter":"bjoerngruening","fediverse":"https://fosstodon.org/@bgruening","fediverse_flavor":"mastodon","matrix":"bgruening:matrix.org","orcid":"0000-0002-3079-6586","elixir_node":"de","linkedin":"bgruening","contact_for_training":true,"joined":"2017-09","location":{"country":"DE","lat":47.997791,"lon":7.842609},"affiliations":["eurosciencegateway","eosc-life","by-covid","deNBI","sfb992","elixir-converge","uni-freiburg","elixir-europe"],"id":"bgruening","url":"https://training.galaxyproject.org/training-material/api/contributors/bgruening.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/bgruening/"}],"js_requirements":{"mathjax":null,"mermaid":false},"short_id":"T00311","url":"/topics/variant-analysis/tutorials/exome-seq/tutorial.html","topic_name":"variant-analysis","tutorial_name":"exome-seq","dir":"topics/variant-analysis/tutorials/exome-seq","symlink":null,"id":"variant-analysis/exome-seq","ref_tutorials":["<p>Exome sequencing is a method that enables the selective sequencing of the\nexonic regions of a genome - that is the transcribed parts of the genome present\nin mature mRNA, including protein-coding sequences, but also untranslated\nregions (UTRs).</p>\n\n<p>In humans, there are about 180,000 exons with a combined length of ~ 30 million\nbase pairs (30 Mb). Thus, the exome represents only 1% of the human genome, but\nhas been estimated to harbor up to 85% of all disease-causing variants (<a href=\"https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2768590/\">Choi\net al., 2009</a>).</p>\n\n<p>Exome sequencing, thus, offers an affordable alternative to whole-genome\nsequencing in the diagnosis of genetic disease, while still covering far more\npotential disease-causing variant sites than genotyping arrays. This is of\nspecial relevance in the case of rare genetic diseases, for which the causative\nvariants may occur at too low a frequency in the human population to be\nincluded on genotyping arrays.</p>\n\n<p>Of note, a recent study focusing on the area of clinical pediatric neurology\nindicates that the costs of exome sequencing may actually not be higher even\ntoday than the costs of conventional genetic testing (<a href=\"https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5589982/\">Vissers et al., 2017</a>).</p>\n\n<blockquote class=\"details\">\n  <details-title>Exome sequencing <i>vs</i> whole-genome sequencing</details-title>\n\n  <p>In principle, the steps illustrated in this tutorial are suitable also for\nthe analysis of whole-genome sequencing (WGS) data. At comparable mean\ncoverage, however, WGS datasets will be much larger than exome sequencing\nones and their analysis will take correspondingly more time.</p>\n\n  <p>The obvious benefit of WGS compared to exome-sequencing, of course, is that\nit will allow variant detection in even more regions of the genome.\nAs a less apparent advantage, the more complete information of WGS data can\nmake it easier to detect <em>copy number variation (CNV)</em> and\n<em>structural variants</em> such as translocations and inversions (although such\ndetection will require more sophisticated analysis steps, which are not\ncovered by this tutorial).</p>\n\n  <p>Very generally, one could argue that exome-sequencing captures most of the\ninformation that can be analyzed with standard bioinformatical tools today at\nreasonable costs. WGS, on the other hand, captures as much information as\ntoday’s sequencing technology can provide, and it may be possible to\nreanalyze such data with more powerful bioinformatical software in the\nfuture to exploit aspects of the information that were not amenable to\nanalysis at the time of data acquisition.</p>\n</blockquote>\n\n<p>The identification of causative variants underlying any particular genetic\ndisease is, as we will see in this tutorial, not just dependent on the\nsuccessful detection of variants in the genome of the patient, but also on\nvariant comparison between the patient and selected relatives. Most often\nfamily trio data, consisting of the genome sequences of the patient and their\nparents, is used for this purpose. With multisample data like this it becomes\npossible to search for variants following any kind of Mendelian inheritance\nscheme compatible with the observed inheritance pattern of the disease, or to\ndetect possibly causative <em>de-novo</em> mutations or <em>loss-of-heterozygosity</em> (LOH) events.</p>\n\n<blockquote class=\"details\">\n  <details-title>Related tutorials</details-title>\n\n  <p>This tutorial focuses on the practical aspects of analyzing real-world\npatient data. If you are more interested in the theoretical aspects of\nvariant calling, you may want to have a look at the related tutorial on\n<a href=\"../dip/tutorial.html\">Calling variants in diploid systems</a>.</p>\n\n  <p>The tutorial on <a href=\"../somatic-variants/tutorial.html\">Somatic variant calling</a>\nfollows an analysis workflow that is rather similar to the one here, but\ntries to identify tumor variants by comparing a tumor sample to healthy\ntissue from the same patient. Together, the two tutorials are intended to get\nyou started with genomics medicine using Galaxy.</p>\n\n</blockquote>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n  <p>In this tutorial, we will cover:</p>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#data-preparation\" id=\"markdown-toc-data-preparation\">Data Preparation</a>    <ol>\n      <li><a href=\"#get-data\" id=\"markdown-toc-get-data\">Get data</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#quality-control\" id=\"markdown-toc-quality-control\">Quality control</a></li>\n  <li><a href=\"#read-mapping\" id=\"markdown-toc-read-mapping\">Read mapping</a></li>\n  <li><a href=\"#mapped-reads-postprocessing\" id=\"markdown-toc-mapped-reads-postprocessing\">Mapped reads postprocessing</a>    <ol>\n      <li><a href=\"#filtering-on-mapped-reads-properties\" id=\"markdown-toc-filtering-on-mapped-reads-properties\">Filtering on mapped reads properties</a></li>\n      <li><a href=\"#removing-duplicate-reads\" id=\"markdown-toc-removing-duplicate-reads\">Removing duplicate reads</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#variant-calling\" id=\"markdown-toc-variant-calling\">Variant calling</a>    <ol>\n      <li><a href=\"#generating-freebayes-calls\" id=\"markdown-toc-generating-freebayes-calls\">Generating FreeBayes calls</a></li>\n      <li><a href=\"#post-processing-freebayes-calls\" id=\"markdown-toc-post-processing-freebayes-calls\">Post-processing FreeBayes calls</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#variant-annotation-and-reporting\" id=\"markdown-toc-variant-annotation-and-reporting\">Variant annotation and reporting</a>    <ol>\n      <li><a href=\"#get-data-1\" id=\"markdown-toc-get-data-1\">Get data</a></li>\n      <li><a href=\"#variant-annotation-with-functional-genomic-effects\" id=\"markdown-toc-variant-annotation-with-functional-genomic-effects\">Variant annotation with functional genomic effects</a></li>\n      <li><a href=\"#generating-a-gemini-database-of-variants-for-further-annotation-and-efficient-variant-queries\" id=\"markdown-toc-generating-a-gemini-database-of-variants-for-further-annotation-and-efficient-variant-queries\">Generating a GEMINI database of variants for further annotation and efficient variant queries</a></li>\n      <li><a href=\"#candidate-variant-detection\" id=\"markdown-toc-candidate-variant-detection\">Candidate variant detection</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#conclusion\" id=\"markdown-toc-conclusion\">Conclusion</a></li>\n</ol>\n\n</blockquote>\n\n<h1 id=\"data-preparation\">Data Preparation</h1>\n\n<p>In this tutorial, we are going to analyze exome sequencing data from a family\ntrio, in which the boy child is affected by the disease\n<a href=\"https://ghr.nlm.nih.gov/condition/osteopetrosis/\">osteopetrosis</a>, while both\nparents, who happen to be consanguineous, are unaffected. Our goal is to\nidentify the genetic variation that is responsible for the disease.</p>\n\n<h2 id=\"get-data\">Get data</h2>\n\n<p><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tip</span> This tutorial offers <strong>two alternative entry points</strong> allowing\nyou to</p>\n\n<ul>\n  <li>conduct a full analysis starting from original sequenced reads in <code class=\"language-plaintext highlighter-rouge\">fastq</code>\nformat or to</li>\n  <li>start your analysis with premapped reads in <code class=\"language-plaintext highlighter-rouge\">bam</code> format that are (almost)\nready for variant calling.</li>\n</ul>\n\n<p>While the full analysis is probably closer to how you would analyze your own\ndata, the shortened analysis from premapped reads may suit your time frame\nbetter, and will avoid redundancy if you have previously worked through other\ntutorials demonstrating NGS quality control and read mapping, like the\ndedicated\n<a href=\"/training-material/topics/sequence-analysis/tutorials/quality-control/tutorial.html\">Quality control</a>\nand <a href=\"/training-material/topics/sequence-analysis/tutorials/mapping/tutorial.html\">Mapping</a>\ntutorials.</p>\n\n<p>The following hands-on section will guide you through obtaining the right\ndata for either analysis.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Data upload</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Create a new history for this tutorial and give it a meaningful name</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-new-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-new-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a new history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>Click the <i class=\"fas fa-plus\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">new-history</span> icon at the top of the history panel:</p>   <p><img src=\"/training-material/shared/images/history_create_new.svg\" alt=\"UI for creating new history\" /></p>   <!-- the original drawing can be found here https://docs.google.com/drawings/d/1cCBrLAo4kDGic5QyB70rRiWJAKTenTU8STsKDaLcVU8/edit?usp=sharing --> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-renaming-a-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-renaming-a-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Renaming a history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ol>   <li>Click on <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> (<strong>Edit</strong>) next to the history name (which by default is “Unnamed history”)</li>   <li>Type the new name</li>   <li>Click on <strong>Save</strong></li> </ol>   <p>If you do not have the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> (<strong>Edit</strong>) next to the history name:</p>   <ol>   <li>Click on <strong>Unnamed history</strong> (or the current name of the history) (<strong>Click to rename history</strong>) at the top of your history panel</li>   <li>Type the new name</li>   <li>Press <kbd>Enter</kbd></li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Obtain the raw sequencing data</p>\n\n      <blockquote class=\"comment\">\n        <comment-title>Starting from raw sequencing data</comment-title>\n        <p>In this and the following steps you will obtain the original unmapped\nsequencing data and prepare for a full analysis including the mapping of\nthe sequenced reads.</p>\n\n        <p>If you prefer <strong>to skip the mapping step</strong> and start the analysis from\npremapped data <strong>you should proceed directly to step 4</strong> of this\nsection.</p>\n      </blockquote>\n\n      <p>Import the original sequenced reads datasets of the family trio from\n<a href=\"https://zenodo.org/record/3054169\">Zenodo</a>:</p>\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/3243160/files/father_R1.fq.gz\nhttps://zenodo.org/record/3243160/files/father_R2.fq.gz\nhttps://zenodo.org/record/3243160/files/mother_R1.fq.gz\nhttps://zenodo.org/record/3243160/files/mother_R2.fq.gz\nhttps://zenodo.org/record/3243160/files/proband_R1.fq.gz\nhttps://zenodo.org/record/3243160/files/proband_R2.fq.gz\n</code></pre></div>      </div>\n\n      <p>Alternatively, the same files may be available on your Galaxy server\nthrough a shared data library (your instructor may tell you so), in\nwhich case you may prefer to import the data directly from there.</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-via-links\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-via-links\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing via links</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Change <strong>Type (set all):</strong> from “Auto-detect” to <code class=\"language-plaintext highlighter-rouge\">fastqsanger.gz</code></p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-data-from-a-data-library\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-data-from-a-data-library\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing data from a data library</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>As an alternative to uploading the data from a URL or your computer, the files may also have been made available from a <em>shared data library</em>:</p>   <ol>   <li>Go into <strong>Shared data</strong> (top panel) then <strong>Data libraries</strong></li>   <li>Navigate to  the correct folder as indicated by your instructor.     <ul>       <li>On most Galaxies tutorial data will be provided in a folder named <strong>GTN - Material –&gt; Topic Name -&gt; Tutorial Name</strong>.</li>     </ul>   </li>   <li>Select the desired files</li>   <li>Click on <strong>Add to History</strong> <i class=\"fas fa-caret-down\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-dropdown</span> near the top and select <strong>as Datasets</strong> from the dropdown menu</li>   <li>     <p>In the pop-up window, choose</p>     <ul>       <li><em>“Select history”</em>: the history you want to import the data to (or create a new one)</li>     </ul>   </li>   <li>Click on <strong>Import</strong></li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Check that the newly created datasets in your history have their\ndatatypes assigned correctly to <code class=\"language-plaintext highlighter-rouge\">fastqsanger.gz</code>, and fix any missing or\nwrong datatype assignment</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-changing-the-datatype\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-changing-the-datatype\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Changing the datatype</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, click <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Datatypes</strong> tab on the top</li>   <li>In the <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Assign Datatype</strong>, select <code class=\"language-plaintext highlighter-rouge\">fastqsanger.gz</code> from “<em>New type</em>” dropdown     <ul>       <li>Tip: you can start typing the datatype into the field to filter the dropdown menu</li>     </ul>   </li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <p><i class=\"fas fa-trophy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">trophy</span> Congratulations for obtaining the datasets required for\nan analysis including reads mapping. You should now\n<strong>proceed with Step 7</strong> below.</p>\n    </li>\n    <li>Obtain the premapped sequencing data\n      <blockquote class=\"comment\">\n        <comment-title>Alternative entry point: Premapped data</comment-title>\n        <p>Skip this and the following two steps if you already obtained and\nprepared the original unmapped seuencing data and are planning to\nperform the mapping step yourself.</p>\n      </blockquote>\n\n      <p>Import the premapped reads datasets of the family trio from\n<a href=\"https://zenodo.org/record/3054169\">Zenodo</a>:</p>\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/3243160/files/mapped_reads_father.bam\nhttps://zenodo.org/record/3243160/files/mapped_reads_mother.bam\nhttps://zenodo.org/record/3243160/files/mapped_reads_proband.bam\n</code></pre></div>      </div>\n\n      <p>Alternatively, the same files may be available on your Galaxy server\nthrough a shared data library (your instructor may tell you so), in\nwhich case you may prefer to import the data directly from there.</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-via-links-1\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-via-links-1\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing via links</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Change <strong>Type (set all):</strong> from “Auto-detect” to <code class=\"language-plaintext highlighter-rouge\">bam</code></p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-data-from-a-data-library-1\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-data-from-a-data-library-1\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing data from a data library</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>As an alternative to uploading the data from a URL or your computer, the files may also have been made available from a <em>shared data library</em>:</p>   <ol>   <li>Go into <strong>Shared data</strong> (top panel) then <strong>Data libraries</strong></li>   <li>Navigate to  the correct folder as indicated by your instructor.     <ul>       <li>On most Galaxies tutorial data will be provided in a folder named <strong>GTN - Material –&gt; Topic Name -&gt; Tutorial Name</strong>.</li>     </ul>   </li>   <li>Select the desired files</li>   <li>Click on <strong>Add to History</strong> <i class=\"fas fa-caret-down\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-dropdown</span> near the top and select <strong>as Datasets</strong> from the dropdown menu</li>   <li>     <p>In the pop-up window, choose</p>     <ul>       <li><em>“Select history”</em>: the history you want to import the data to (or create a new one)</li>     </ul>   </li>   <li>Click on <strong>Import</strong></li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Check that the newly created datasets in your history have their\ndatatypes assigned correctly to <code class=\"language-plaintext highlighter-rouge\">bam</code>, and fix any missing or wrong\ndatatype assignment</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-changing-the-datatype-1\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-changing-the-datatype-1\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Changing the datatype</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, click <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Datatypes</strong> tab on the top</li>   <li>In the <i class=\"fas fa-database\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-chart-select-data</span> <strong>Assign Datatype</strong>, select <code class=\"language-plaintext highlighter-rouge\">bam</code> from “<em>New type</em>” dropdown     <ul>       <li>Tip: you can start typing the datatype into the field to filter the dropdown menu</li>     </ul>   </li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Specify the genome version that was used for mapping</p>\n\n      <p>Change the database/build (dbkey) for each of your bam datasets\nto <code class=\"language-plaintext highlighter-rouge\">hg19</code>.</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-changing-database-build-dbkey\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-changing-database-build-dbkey\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Changing database/build (dbkey)</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click the desired dataset’s name to expand it.</li>   <li>     <p>Click on the “?” next to database indicator:</p>     <p><img src=\"/training-material/shared/images/datasets_dbkey.svg\" alt=\"UI for changing dbkey\" /></p>   </li>   <li>In the central panel, change the <strong>Database/Build</strong> field</li>   <li>Select your desired database key from the dropdown list: <code class=\"language-plaintext highlighter-rouge\">Human Feb. 2009 (GRCh37/hg19) (hg19)</code></li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <blockquote class=\"details\">\n        <details-title>Why specify genome versions</details-title>\n        <p>When you are starting with sequencing data that has already been mapped\nto a particular genome version (human hg19 in this case), it is good\npractice to attach this information as metadata to the datasets.</p>\n\n        <p>Doing so helps prevent accidental use of a different version of the\nreference genome in later steps like variant calling, which would\ntypically lead to nonsensical results because of base position changes\nbetween the different versions.</p>\n      </blockquote>\n\n      <p><i class=\"fas fa-trophy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">trophy</span> Congratulations for obtaining the premapped sequencing\ndatasets. Now, <strong>follow the remaining steps</strong> to set everything up for a\nsuccessful analysis.</p>\n    </li>\n    <li>\n      <p>Rename the datasets</p>\n\n      <p>For datasets that you upload via a link, Galaxy will pick the link\naddress as the dataset name, which you will likely want to shorten to\njust the file names.</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-renaming-a-dataset\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-renaming-a-dataset\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Renaming a dataset</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, change the <strong>Name</strong> field</li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Add #father/#mother/#child tags to the datasets</p>\n\n      <p>Parts of the analysis in this tutorial will consist of identical steps\nperformed on the data of each family member.</p>\n\n      <p>To make it easier to keep track of which dataset represents which step in\nthe analysis of which sample, Galaxy supports dataset tags. In particular,\nif you attach a tag starting with <code class=\"language-plaintext highlighter-rouge\">#</code> to any dataset, that tag will\nautomatically propagate to any new dataset derived from the tagged\ndataset.</p>\n\n      <p>Tags are supposed to help you identify the origin of datasets quickly,\nbut you can choose them as you like.</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-adding-a-tag\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-adding-a-tag\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Adding a tag</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ol>   <li>Click on the dataset to expand it</li>   <li>Click on <strong>Add Tags</strong> <i class=\"fas fa-tags\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-tags</span></li>   <li>Add a tag  starting with <code class=\"language-plaintext highlighter-rouge\">#</code>     <ul>       <li>Tags starting with <code class=\"language-plaintext highlighter-rouge\">#</code> will be automatically propagated to the outputs of tools using this dataset.</li>     </ul>   </li>   <li>Press <kbd>Enter</kbd></li>   <li>Check that the tag appears below the dataset name</li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Obtain the reference genome</p>\n\n      <blockquote class=\"comment\">\n        <comment-title>Shortcut</comment-title>\n        <p>You can skip this step if the Galaxy server you are working on offers\na <code class=\"language-plaintext highlighter-rouge\">hg19</code> version of the human reference genome with prebuilt indexes for\n<em>bwa-mem</em> (only necessary if starting from unmapped original sequencing\nreads) and <em>freebayes</em>. Ask your instructor, or check the tools\n<strong>Map with BWA-MEM</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> and <strong>FreeBayes</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>\nif they list a <code class=\"language-plaintext highlighter-rouge\">hg19</code> version as an option under\n<em>“Select a / Using reference genome”</em>).</p>\n      </blockquote>\n\n      <p>Import the <code class=\"language-plaintext highlighter-rouge\">hg19</code> version of the human chromosome 8 sequence:</p>\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/3243160/files/hg19_chr8.fa.gz\n</code></pre></div>      </div>\n\n      <p>In the upload dialog, make sure you specify:</p>\n\n      <ul>\n        <li><strong>Type</strong>: <code class=\"language-plaintext highlighter-rouge\">fasta</code></li>\n        <li><strong>Genome</strong>: <code class=\"language-plaintext highlighter-rouge\">Human Feb. 2009 (GRCh37/hg19) (hg19)</code></li>\n      </ul>\n\n      <p>Alternatively, load the dataset from a shared data library.</p>\n    </li>\n    <li>\n      <p>Rename the reference genome</p>\n\n      <p>The reference genome you have imported above came as a compressed\nfile, but got unpacked by Galaxy to plain <code class=\"language-plaintext highlighter-rouge\">fasta</code> format according to\nyour datatype selection. At a minimum, you may now wish to remove the\n<code class=\"language-plaintext highlighter-rouge\">.gz</code> suffix from the dataset name to avoid confusion.</p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p><i class=\"fas fa-trophy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">trophy</span> <strong>Congratulations!</strong>\nYou are all set for starting the analysis now.</p>\n\n<p>If you have chosen to follow the complete analysis from the original sequenced\ndata, just proceed with the next section.</p>\n\n<p>If, on the other hand, you have prepared to start from the premapped data, skip\nthe sections on <em>Quality control</em> and <em>Read mapping</em>, and conitnue with\n<strong>Mapped reads postprocessing</strong>.</p>\n\n<h1 id=\"quality-control\">Quality control</h1>\n\n<p>This step serves the purpose of identifying possible issues with the raw\nsequenced reads input data before embarking on any “real” analysis steps.</p>\n\n<p>Some of the typical problems with NGS data can be mitigated by preprocessing\naffected sequencing reads before trying to map them to the reference genome.\nDetecting some other, more severe problems early on may at least save you a lot\nof time spent on analyzing low-quality data that is not worth the effort.</p>\n\n<p>Here, we will perform a standard quality check on our input data and only point\nout a few interesting aspects about that data. For a more thorough explanation\nof NGS data quality control, you may want to have a look at the dedicated\ntutorial on <a href=\"/training-material/topics/sequence-analysis/tutorials/quality-control/tutorial.html\">Quality control</a>.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Quality control of the input datasets</hands-on-title>\n  <ol>\n    <li>Run <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/devteam/fastqc/fastqc/0.74+galaxy0\" title=\"FastQC tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>FastQC</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.74+galaxy0)</span> on each of your six fastq datasets\n      <ul>\n        <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“Short read data from your current history”</em>: all 6 FASTQ  datasets selected with <strong>Multiple datasets</strong></li>\n      </ul>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-select-multiple-datasets\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-select-multiple-datasets\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Select multiple datasets</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ol>   <li>Click on <i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <strong>Multiple datasets</strong></li>   <li>Select several files by keeping the <kbd>Ctrl</kbd> (or <kbd>COMMAND</kbd>) key pressed and clicking on the files of interest</li> </ol> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <p>When you start this job, twelve new datasets (one with the calculated raw\ndata, another one with an html report of the findings for each input\ndataset) will get added to your history.</p>\n    </li>\n    <li>Use <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/multiqc/multiqc/1.11+galaxy1\" title=\"MultiQC tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>MultiQC</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.11+galaxy1)</span> to aggregate the raw <strong>FastQC</strong> data of all input datasets into one report\n      <ul>\n        <li>In <em>“Results”</em>\n          <ul>\n            <li><em>“Which tool was used generate logs?”</em>: <code class=\"language-plaintext highlighter-rouge\">FastQC</code></li>\n            <li>In <em>“FastQC output”</em>\n              <ul>\n                <li><em>“Type of FastQC output?”</em>: <code class=\"language-plaintext highlighter-rouge\">Raw data</code></li>\n                <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“FastQC output”</em>: all six <em>RawData</em>\noutputs of <strong>FastQC</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>\n      <p>Inspect the <em>Webpage</em> output produced by the tool</p>\n\n      <blockquote class=\"question\">\n        <question-title></question-title>\n\n        <ol>\n          <li>Based on the report, do you think preprocessing of the reads\n(trimming and/or filtering) will be necessary before mapping?</li>\n          <li>Why do all samples show a non-normal GC content distribution, and\nshould you be worried?</li>\n        </ol>\n\n        <blockquote class=\"solution\">\n          <solution-title></solution-title>\n\n          <ol>\n            <li>Sequence quality is quite good overall. If anything you might\nconsider trimming the 3’ ends of reads (base qualities decline\nslightly towards the 3’ ends) or to filter out the small fraction\nof reads with a mean base quality &lt; 5.\nFeel free to run, <em>e.g.</em>, <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/pjbriggs/trimmomatic/trimmomatic/0.38.1\" title=\"Trimmomatic tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Trimmomatic</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.38.1)</span> on the\nfastq datasets if you want to, but don’t expect this to have a big\neffect on the analysis given the high overall quality of the data\nof all samples.</li>\n            <li>\n              <p>In whole-genome sequencing, a non-normal distribution of the GC\ncontent of the reads from a sample is typically considered to hint\nat possible contamination.\nHere, however, we are dealing with sequencing data from captured\nexomes, <em>i.e</em>, the reads are not representing random sequences from\na genome, but rather a biased selection.</p>\n\n              <p>A bimodal GC content distribution, like for the samples at hand, is\na characteristic feature of many exome capture methods and has also\nbeen observed with an Illumina Nextera Rapid Capture exome kit\nbefore (compare Fig. 3D in\n<a href=\"https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4522667/\">Shigemizu et al., 2015</a>\n).</p>\n            </li>\n          </ol>\n\n        </blockquote>\n      </blockquote>\n    </li>\n  </ol>\n</blockquote>\n\n<h1 id=\"read-mapping\">Read mapping</h1>\n\n<p>Now that you confirmed that the quality of the input data is good enough to\nwarrant further analysis, it is time to map the sequenced reads to the\nreference genome.</p>\n\n<p>We assume here that you are at least vaguely familiar with the concept of read\nmapping and only illustrate the concrete steps necessary  to map our specific\nNGS reads datasets to the human reference genome. We recommend you to follow\nthe dedicated <a href=\"/training-material/topics/sequence-analysis/tutorials/mapping/tutorial.html\">Mapping tutorial</a>, if you need a general introduction to read mapping.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Read Mapping</hands-on-title>\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/devteam/bwa/bwa_mem/0.7.17.2\" title=\"Map with BWA-MEM tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Map with BWA-MEM</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.7.17.2)</span> to map the reads from the <strong>father</strong> sample to the reference genome\n      <ul>\n        <li><em>“Will you select a reference genome from your history or use a built-in index?”</em>: <code class=\"language-plaintext highlighter-rouge\">Use a built-in genome index</code>\n          <ul>\n            <li><em>“Using reference genome”</em>: <code class=\"language-plaintext highlighter-rouge\">Human: hg19</code> (or a similarly named option)</li>\n          </ul>\n\n          <blockquote class=\"comment\">\n            <comment-title>Using the imported `hg19` sequence</comment-title>\n            <p>If you have imported the <code class=\"language-plaintext highlighter-rouge\">hg19</code> chr8 sequence as a fasta dataset into\nyour history instead:</p>\n            <ul>\n              <li><em>“Will you select a reference genome from your history or use a\nbuilt-in index?”</em>: <code class=\"language-plaintext highlighter-rouge\">Use a genome from history and build index</code>\n                <ul>\n                  <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Use the following dataset as the reference sequence”</em>: your imported <code class=\"language-plaintext highlighter-rouge\">hg19</code> fasta dataset.</li>\n                </ul>\n              </li>\n            </ul>\n          </blockquote>\n        </li>\n        <li><em>“Single or Paired-end reads”</em>: <code class=\"language-plaintext highlighter-rouge\">Paired</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Select first set of reads”</em>: the\nforward reads (R1) dataset of the <strong>father</strong> sample</li>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Select second set of reads”</em>: the\nreverse reads (R2) dataset of the <strong>father</strong> sample</li>\n          </ul>\n\n          <blockquote class=\"tip\">\n            <tip-title>No FASTQ datasets selectable?</tip-title>\n            <p>Please confirm that the problematic datasets declare <em>format</em>:\n<code class=\"language-plaintext highlighter-rouge\">fastqsanger.gz</code>.</p>\n\n            <p>Most Galaxy tools that accept FASTQ input expect the data to be\nformatted as <em>FASTQ with Sanger-scaled quality values</em>, the most\nwidely spread version of the FASTQ format. To make this requirement\nexplicit (instead of generating possibly wrong results) these tools\nrequire you to set the dataset type to <code class=\"language-plaintext highlighter-rouge\">fastqsanger</code> (<code class=\"language-plaintext highlighter-rouge\">fastqsanger.gz</code>\nfor data compressed with gzip). You can do so either on data upload\nor later from the <em>Edit dataset attributes</em> view (which you can reach\nby clicking on the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> pencil icon.</p>\n          </blockquote>\n        </li>\n        <li><em>“Set read groups information?”</em>: <code class=\"language-plaintext highlighter-rouge\">Set read groups (SAM/BAM specification)</code>\n          <ul>\n            <li><em>“Auto-assign”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code>\n              <ul>\n                <li><em>“Read group identifier (ID)”</em>: <code class=\"language-plaintext highlighter-rouge\">000</code></li>\n              </ul>\n            </li>\n            <li><em>“Auto-assign”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code>\n              <ul>\n                <li><em>“Read group sample name (SM)”</em>: <code class=\"language-plaintext highlighter-rouge\">father</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n\n      <blockquote class=\"warning\">\n        <warning-title>Read group IDs and sample names - choose, but choose wisely</warning-title>\n        <p>In general, you are free to choose ID and SM values to your liking, but\n…</p>\n\n        <p>The <strong>ID</strong> should <strong>unambiguously identify</strong> the sequencing run that\nproduced the reads. At the very least, no two input datasets in any\ngiven analysis should define the same ID twice, or tools like\n<em>FreeBayes</em>, which we are going to use in the next step, will refuse\nto work with the data.</p>\n\n        <p>The <strong>SM</strong> value, on the other hand, should identify the biological\nsample represented by the data and is used by many tools (like <em>GEMINI</em>\nwhich we will use later) to let you refer to one specifc sample in a\nmultisample analysis. Choose descriptive, but short and easy to\nremember sample names since you will have to type them in again!</p>\n\n      </blockquote>\n    </li>\n    <li>\n      <p><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/devteam/bwa/bwa_mem/0.7.17.2\" title=\"Map with BWA-MEM tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Map with BWA-MEM</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.7.17.2)</span> to map the reads from the <strong>mother</strong> sample to the reference genome <strong>using the same parameters as before</strong> except</p>\n\n      <ul>\n        <li><em>“Single or Paired-end reads”</em>: <code class=\"language-plaintext highlighter-rouge\">Paired</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Select first set of reads”</em>: the\nforward reads (R1) dataset of the <strong>mother</strong> sample</li>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Select second set of reads”</em>: the\nreverse reads (R2) dataset of the <strong>mother</strong> sample</li>\n          </ul>\n        </li>\n        <li><em>“Set read groups information?”</em>: <code class=\"language-plaintext highlighter-rouge\">Set read groups (SAM/BAM specification)</code>\n          <ul>\n            <li><em>“Auto-assign”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code>\n              <ul>\n                <li><em>“Read group identifier (ID)”</em>: <code class=\"language-plaintext highlighter-rouge\">001</code></li>\n              </ul>\n            </li>\n            <li><em>“Auto-assign”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code>\n              <ul>\n                <li><em>“Read group sample name (SM)”</em>: <code class=\"language-plaintext highlighter-rouge\">mother</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>\n      <p><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/devteam/bwa/bwa_mem/0.7.17.2\" title=\"Map with BWA-MEM tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Map with BWA-MEM</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.7.17.2)</span> to map the reads from the <strong>child</strong> sample to the reference genome <strong>using the same parameters as before</strong> except</p>\n\n      <ul>\n        <li><em>“Single or Paired-end reads”</em>: <code class=\"language-plaintext highlighter-rouge\">Paired</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Select first set of reads”</em>: the\nforward reads (R1) dataset of the <strong>child</strong> sample</li>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Select second set of reads”</em>: the\nreverse reads (R2) dataset of the <strong>child</strong> sample</li>\n          </ul>\n        </li>\n        <li><em>“Set read groups information?”</em>: <code class=\"language-plaintext highlighter-rouge\">Set read groups (SAM/BAM specification)</code>\n          <ul>\n            <li><em>“Auto-assign”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code>\n              <ul>\n                <li><em>“Read group identifier (ID)”</em>: <code class=\"language-plaintext highlighter-rouge\">002</code></li>\n              </ul>\n            </li>\n            <li><em>“Auto-assign”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code>\n              <ul>\n                <li><em>“Read group sample name (SM)”</em>: <code class=\"language-plaintext highlighter-rouge\">proband</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h1 id=\"mapped-reads-postprocessing\">Mapped reads postprocessing</h1>\n\n<p>At this point in the analysis you should have obtained three mapped reads\ndatasets in <code class=\"language-plaintext highlighter-rouge\">bam</code> format. Each of these datasets should:</p>\n\n<ul>\n  <li>\n    <p>have its <em>database</em> set to the key <code class=\"language-plaintext highlighter-rouge\">hg19</code></p>\n\n    <p>Please correct any missing (<code class=\"language-plaintext highlighter-rouge\">?</code>) or wrong keys now!</p>\n\n    <!--SNIPPET-->\n    <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-changing-database-build-dbkey-1\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-changing-database-build-dbkey-1\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Changing database/build (dbkey)</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click the desired dataset’s name to expand it.</li>   <li>     <p>Click on the “?” next to database indicator:</p>     <p><img src=\"/training-material/shared/images/datasets_dbkey.svg\" alt=\"UI for changing dbkey\" /></p>   </li>   <li>In the central panel, change the <strong>Database/Build</strong> field</li>   <li>Select your desired database key from the dropdown list: <code class=\"language-plaintext highlighter-rouge\">Human Feb. 2009 (GRCh37/hg19) (hg19)</code></li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>\n    <p><!--END_SNIPPET--></p>\n  </li>\n  <li>\n    <p>ideally, carry one of the <code class=\"language-plaintext highlighter-rouge\">#father</code>, <code class=\"language-plaintext highlighter-rouge\">#mother</code> or <code class=\"language-plaintext highlighter-rouge\">#child</code> tags\nfor quick identification of the samples they provide data for.</p>\n  </li>\n</ul>\n\n<p>In principle, you could use these datasets directly for variant calling, and in\nmany cases, including this one, this would be sufficient to identify the\nsought-after variants.</p>\n\n<p>To obtain an accurate picture of the variant spectrum found in your samples it\nis good practice though to perform various postprocessing steps on the mapped\nreads before passing them to a variant caller.</p>\n\n<blockquote class=\"comment\">\n  <comment-title>Shortcut</comment-title>\n  <p>If you are in a hurry, you may skip the postprocessing steps and continue\nwith your mapped reads datasets and the <em>Variant Calling</em> section. Make sure\nthough you come back here, or read about mapped reads postprocessing\nelsewhere, before attempting to perform any variant analysis on your own data\nthat may require high accuracy/sensitivity.</p>\n</blockquote>\n\n<p>The optimal set of postprocessing steps required depends on the variant calling\nsoftware used at the next step. The <strong>FreeBayes</strong> variant caller that we are\ngoing to use in this tutorial is particularly well suited for use with minimal\nmapped reads postprocessing pipelines, so all we are going to do here is:</p>\n\n<ul>\n  <li>\n    <p>filter the paired-end reads of all samples to retain only those read pairs,\nfor which both the forward and the reverse read have been mapped to the\nreference successfully</p>\n\n    <p>For such pairs of reads, we can be extra confident that they don’t\ncome from some non-human contaminant DNA or represent a sequencing artefact\nof some sort.</p>\n  </li>\n  <li>\n    <p>deduplicate reads</p>\n\n    <p>Duplicate reads, which typically arise from PCR-overamplification of genomic\nfragments during sequencing library preparation, can, to some extent, lead to\nwrong genotype assignments at variant sites (if, for example, a sample is\nheterozygous for a variant, but fragments with one of the two alleles get\namplified more efficiently than the others).</p>\n  </li>\n</ul>\n\n<blockquote class=\"comment\">\n  <comment-title>More postprocessing steps</comment-title>\n  <p>The <a href=\"../somatic-variants/tutorial.html\">Somatic variant calling tutorial</a>\nprovides an example of a much more complex mapped reads postprocessing\npipeline that may be required for optimal performance of other variant\ncallers.</p>\n</blockquote>\n\n<h2 id=\"filtering-on-mapped-reads-properties\">Filtering on mapped reads properties</h2>\n\n<p>To produce new filtered BAM datasets with only mapped reads the mate of which is also mapped:</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Filtering for read pair mapping status</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/samtools_view/samtools_view/1.15.1+galaxy0\" title=\"Samtools view tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Samtools view</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.15.1+galaxy0)</span> with the following\nparameters (leaving non-mentioned ones at their defaults):\n      <ul>\n        <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“SAM/BAM/CRAM data set”</em>: all 3 mapped reads\n datasets of the family trio, outputs of <strong>Map with BWA-MEM</strong>\n <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n        <li><em>“What would you like to look at?”</em>: <code class=\"language-plaintext highlighter-rouge\">A filtered/subsampled selection of reads</code></li>\n      </ul>\n      <ul>\n        <li>In <em>“Configure filters”</em>:\n          <ul>\n            <li><em>“Exclude reads with any of the following flags set”</em>:\n<code class=\"language-plaintext highlighter-rouge\">Read is unmapped</code> <strong>and</strong> <code class=\"language-plaintext highlighter-rouge\">Mate is unmapped</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>This will result in three new datasets, one for each sample in the analysis.</p>\n\n<blockquote class=\"details\">\n  <details-title>More than one way to filter</details-title>\n  <p>Instead of the above filter conditions we could also have exploited the\n<em>Read is mapped in a proper pair</em> flag bit.</p>\n\n  <p>For a read to be flagged as being mapped in a proper pair its mate needs to\nbe mapped, but the mapped pair also needs to meet additional,\naligner-specific criteria. These may include (and do so for <strong>BWA-MEM</strong>):</p>\n\n  <ul>\n    <li>both reads need to map to the same chomosome</li>\n    <li>the two reads need to map to the reference in the orientation expected by\nthe aligner</li>\n    <li>the two read pairs need to map to the reference within an\naligner-determined distance</li>\n  </ul>\n\n  <p>Thus, filtering based on the flag has two consequences:</p>\n\n  <ul>\n    <li>filtering will be stricter than with just the <em>Read is unmapped</em> and <em>Mate\nis unmapped</em> flags above</li>\n    <li>\n      <p>you will eliminate read pairs that could be informative with regard to\nchromosomal rearrangements and insertion/deletion events</p>\n\n      <p>=&gt; Do not filter for properly paired reads if you plan to detect such\nstructural variants!</p>\n    </li>\n  </ul>\n\n  <p>In addition, the <em>proper pair</em> flag is considered undefined if the read\nitself is unmapped, so a <em>proper pair</em> filter should eliminate unmapped reads\nexplicitly to be on the safe side.</p>\n\n  <p>Thus, if you would like to use proper pair filtering (we have no intention to\ndetect structural variants in this tutorial) instead of just filtering for\nmapped reads with a mapped mate, you could run the alternative:</p>\n\n  <blockquote class=\"hands_on\">\n    <hands-on-title></hands-on-title>\n\n    <ol>\n      <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/samtools_view/samtools_view/1.15.1+galaxy0\" title=\"Samtools view tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Samtools view</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.15.1+galaxy0)</span>:\n        <ul>\n          <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“SAM/BAM/CRAM data set”</em>: all 3 mapped reads\n datasets of the family trio, outputs of <strong>Map with BWA-MEM</strong>\n <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n          <li><em>“What would you like to look at?”</em>: <code class=\"language-plaintext highlighter-rouge\">A filtered/subsampled selection of reads</code></li>\n        </ul>\n        <ul>\n          <li>In <em>“Configure filters”</em>:\n            <ul>\n              <li><em>“Require that these flags are set”</em>: <code class=\"language-plaintext highlighter-rouge\">Read is mapped in a proper pair</code></li>\n              <li><em>“Exclude reads with any of the following flags set”</em>: <code class=\"language-plaintext highlighter-rouge\">Read is unmapped</code></li>\n            </ul>\n          </li>\n        </ul>\n      </li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<h2 id=\"removing-duplicate-reads\">Removing duplicate reads</h2>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Remove duplicates</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/devteam/samtools_rmdup/samtools_rmdup/2.0.1\" title=\"RmDup tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>RmDup</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.0.1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“BAM file”</em>: all 3 filtered reads datasets; the\n outputs of <strong>Samtools view</strong></li>\n        <li><em>“Is this paired-end or single end data”</em>: <code class=\"language-plaintext highlighter-rouge\">BAM is paired-end</code></li>\n      </ul>\n      <ul>\n        <li><em>“Treat as single-end”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>Again, this will produce three new datasets, one for each member of the family\ntrio.</p>\n\n<h1 id=\"variant-calling\">Variant calling</h1>\n\n<p>With the sequenced reads of all samples mapped and postprocessed, we can start\nlooking for evidence of sequence deviations, <em>i.e.</em> variants, between the\nsequenced genomic samples and the reference genome.</p>\n\n<p>This task has been automated and optimized continuously over the last decade,\nand modern variant calling software hides much of the complexity involved in\nit. At least a basic understanding of the underlying concepts is still highly\nrecommended though and, if you are new to variant calling, the tutorial on\n<a href=\"../dip/tutorial.html\">Calling variants in diploid systems</a> may be a good\nstarting point for you.</p>\n\n<h2 id=\"generating-freebayes-calls\">Generating FreeBayes calls</h2>\n\n<p>We will use <strong>FreeBayes</strong> to call our variants. <strong>FreeBayes</strong> is a Bayesian\ngenetic variant detector designed to find small polymorphisms, specifically\nSNPs (single-nucleotide polymorphisms), indels (insertions and deletions), MNPs\n(multi-nucleotide polymorphisms), and complex events (composite insertion and\nsubstitution events) smaller than the length of a short-read sequencing\nalignment.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Generating FreeBayes calls</hands-on-title>\n\n  <ol>\n    <li>Run <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/devteam/freebayes/freebayes/1.3.6+galaxy0\" title=\"FreeBayes tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>FreeBayes</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.3.6+galaxy0)</span>:\n      <ul>\n        <li><em>“Choose the source for the reference genome”</em>: <code class=\"language-plaintext highlighter-rouge\">Locally cached</code>\n          <ul>\n            <li><em>“Run in batch mode?”</em>: <code class=\"language-plaintext highlighter-rouge\">Merge output VCFs</code>\n              <ul>\n                <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“BAM dataset(s)”</em>: all three mapped reads\ndatasets of the family trio; the outputs of <strong>RmDup</strong></li>\n              </ul>\n            </li>\n            <li><em>“Using reference genome”</em>: <code class=\"language-plaintext highlighter-rouge\">Human: hg19</code> (or a similarly named option)</li>\n          </ul>\n\n          <blockquote class=\"comment\">\n            <comment-title>Using the imported `hg19` sequence</comment-title>\n            <p>If you have imported the <code class=\"language-plaintext highlighter-rouge\">hg19</code> chr8 sequence as a fasta dataset\ninto your history instead:</p>\n            <ul>\n              <li><em>“Choose the source for the reference genome”</em>: <code class=\"language-plaintext highlighter-rouge\">History</code>\n                <ul>\n                  <li><em>“Run in batch mode?”</em>: <code class=\"language-plaintext highlighter-rouge\">Merge output VCFs</code>\n                    <ul>\n                      <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“BAM or CRAM dataset(s)”</em>: all three\n mapped and fully post-processed reads datasets of the family trio;\n outputs of <strong>RmDup</strong></li>\n                    </ul>\n                  </li>\n                  <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Use the following dataset as the\nreference sequence”</em>: your imported <code class=\"language-plaintext highlighter-rouge\">hg19</code> fasta dataset.</li>\n                </ul>\n              </li>\n            </ul>\n          </blockquote>\n        </li>\n        <li><em>“Limit variant calling to a set of regions?”</em>: <code class=\"language-plaintext highlighter-rouge\">Do not limit</code></li>\n        <li><em>“Choose parameter selection level”</em>: <code class=\"language-plaintext highlighter-rouge\">1. Simple diploid calling</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p><i class=\"fas fa-trophy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">trophy</span> <strong>Congratulations!</strong>\nYou have created you first multisample VCF file, one of the most complicated\nfile formats in bioinformatics. For every variant detected in at least one of\nyour samples, this tab-separated format uses a single line to store all\ninformation about the variant. This includes but is not limited to:</p>\n\n<ul>\n  <li>the position of the variant in the genome (with respect to the reference\ngenome used for the analysis)</li>\n  <li>the nature of the variant (the actual sequence change associated with it)</li>\n  <li>the detected genotype of every sample at the variant position</li>\n  <li>measures of the reliability of the variant call and of all individual\ngenotype calls</li>\n</ul>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Optional hands-on: Inspect the VCF output produced by FreeBayes</hands-on-title>\n\n  <ol>\n    <li>Display the VCF dataset:\n      <ul>\n        <li>\n          <p>Click the <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> icon next to the VCF dataset generated\nby FreeBayes to display its contents.</p>\n\n          <p>VCF is a tabular plain text format though its information density makes\nit complicated to  understand.</p>\n        </li>\n      </ul>\n\n      <blockquote class=\"question\">\n        <question-title></question-title>\n\n        <p>Can you locate at least some of the above-listed information in the\ndataset?</p>\n\n        <p>Hints:</p>\n        <ul>\n          <li>Lines starting with <code class=\"language-plaintext highlighter-rouge\">##</code> are comment lines explaining the content of\nthe file.</li>\n          <li>Diploid genotypes at biallelic sites are encoded using <code class=\"language-plaintext highlighter-rouge\">0/0</code>, <code class=\"language-plaintext highlighter-rouge\">0/1</code>\nand <code class=\"language-plaintext highlighter-rouge\">1/1</code> to represent homozygous reference, heterozygous and\nhomozygous variant states, respectively.</li>\n        </ul>\n\n        <blockquote class=\"solution\">\n          <solution-title></solution-title>\n\n          <ul>\n            <li>\n              <p>The position of each variant with respect to the reference genome is\nstored in the first two columns (labeled <code class=\"language-plaintext highlighter-rouge\">CHROM</code> and <code class=\"language-plaintext highlighter-rouge\">POS</code>).</p>\n            </li>\n            <li>\n              <p>The sequence change associated with the variant is provided by\ncolumns 4 and 5 (<code class=\"language-plaintext highlighter-rouge\">REF</code> and <code class=\"language-plaintext highlighter-rouge\">ALT</code>).</p>\n\n              <p>The first of these lists the sequence found at the variant site in\nthe reference genome, the second the variant sequence.</p>\n            </li>\n            <li>\n              <p>The genotypes of the samples are stored as part of columns 10 and\nup.</p>\n\n              <p>Column 9 (<code class=\"language-plaintext highlighter-rouge\">FORMAT</code>) provides the legend for understanding the\nsample-specific columns following it and tells us that the first\nelement (before the first <code class=\"language-plaintext highlighter-rouge\">:</code> separator) of each sample column holds\nthe sample genotype (<code class=\"language-plaintext highlighter-rouge\">GT</code>).</p>\n            </li>\n            <li>\n              <p>The variant call quality (a measure of the reliability of the\nvariant existing in any of the samples, <em>i.e.</em> it being real) is\nstored in column 6 (<code class=\"language-plaintext highlighter-rouge\">QUAL</code>).\nThe values are <a href=\"https://en.wikipedia.org/wiki/Phred_quality_score\">Phred-scaled</a>\nlike sequenced reads base qualities.</p>\n\n              <p>The (log10-scaled) likelihoods of individual genotype calls are\nstored as the last element (<code class=\"language-plaintext highlighter-rouge\">GL</code>) in every sample column.</p>\n            </li>\n          </ul>\n\n          <p>If you are eager to learn all the details about the format, you could\nconsult the excellent (but also long) official\n<a href=\"http://samtools.github.io/hts-specs/VCFv4.3.pdf\">VCF specification</a>.</p>\n\n        </blockquote>\n      </blockquote>\n    </li>\n  </ol>\n</blockquote>\n\n<h2 id=\"post-processing-freebayes-calls\">Post-processing FreeBayes calls</h2>\n\n<p>Before starting to analyze the detected variants, we need to post-process the\nVCF dataset to fix a few incompatibilities between Freebayes and downstream\nanalysis tools. In particular, we want to:</p>\n\n<ul>\n  <li>\n    <p>Split multiallelic variant records, <em>i.e.</em>, records that list more than one\nalternate allele at a given genomic position, into separate record lines.</p>\n\n    <p>This will allow us to annotate each record with information about the impact\nof one specific variant allele further on.</p>\n  </li>\n  <li>\n    <p>Make sure that indels are represented in left-aligned and normalized form\nbecause this is how known indels are stored in public annotation databases.</p>\n\n    <blockquote class=\"details\">\n      <details-title>Indel normalization</details-title>\n      <p>Indel normalization is a surprisingly complex topic, which is explained\nreally well and in detail in\n<a href=\"https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4481842/\">Tan et al., 2015</a>.\nThe following figure illustrates the various possibilities to represent\nan indel, only one of which is the <em>normalized</em> form:</p>\n      <figure id=\"figure-1\" style=\"max-width: 90%;\"><img src=\"../../images/indel_normalization.png\" alt=\"different ways to represent the same indel. \" width=\"720\" height=\"540\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/indel_normalization.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 1</strong>:</span> The many ways to represent an indel (from: https://genome.sph.umich.edu/wiki/Variant_Normalization</figcaption></figure>\n      <p>.</p>\n\n    </blockquote>\n  </li>\n</ul>\n\n<p>A tool that can do this and also ensures that a VCF dataset conforms to\nstandards in some other, less important respects is <strong>bcftools norm</strong>.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Post-processing FreeBayes calls</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/bcftools_norm/bcftools_norm/1.15.1+galaxy3\" title=\"bcftools norm tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>bcftools norm</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.15.1+galaxy3)</span> with the following parameters:\n      <ul>\n        <li><em>“VCF/BCF Data”</em>: the VCF output of <strong>FreeBayes</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n        <li><em>“Choose the source for the reference genome”</em>: <code class=\"language-plaintext highlighter-rouge\">Use a built-in genome</code>\n          <ul>\n            <li><em>“Reference genome”</em>: <code class=\"language-plaintext highlighter-rouge\">Human: hg19</code> (or a similarly named option)</li>\n          </ul>\n\n          <blockquote class=\"comment\">\n            <comment-title>Using the imported `hg19` sequence</comment-title>\n            <p>If you have imported the <code class=\"language-plaintext highlighter-rouge\">hg19</code> chr8 sequence as a fasta dataset\ninto your history instead:</p>\n            <ul>\n              <li><em>“Choose the source for the reference genome”</em>:\n<code class=\"language-plaintext highlighter-rouge\">Use a genome from the history</code>\n                <ul>\n                  <li><em>“Reference genome”</em>: your imported <code class=\"language-plaintext highlighter-rouge\">hg19</code> fasta dataset</li>\n                </ul>\n              </li>\n            </ul>\n          </blockquote>\n        </li>\n        <li><em>“When any REF allele does not match the reference genome base”</em>:\n<code class=\"language-plaintext highlighter-rouge\">ignore the problem (-w)</code></li>\n        <li><em>“Atomize”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n        <li><em>“Left-align and normalize indels?”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n        <li>\n          <p><em>“Perform deduplication for the folowing types of variant records”</em>:\n<code class=\"language-plaintext highlighter-rouge\">do not deduplicate any records</code></p>\n\n          <p>Freebayes is not producing any duplicate calls.</p>\n        </li>\n        <li><em>“~multiallelics”</em>: <code class=\"language-plaintext highlighter-rouge\">split multiallelic sites into biallelic records (-)</code>\n          <ul>\n            <li>\n              <p><em>“split the following variant types”</em>: <code class=\"language-plaintext highlighter-rouge\">both</code></p>\n\n              <p>We want to split both, multiallelic SNP and indel records.</p>\n            </li>\n          </ul>\n        </li>\n        <li>\n          <p><em>“output_type”</em>: <code class=\"language-plaintext highlighter-rouge\">uncompressed VCF</code></p>\n\n          <p>We would like to keep the results human-readable. VCF is also what tools\nlike <em>SnpEff</em> and <em>GEMINI</em> expect as input. Compressed, binary BCF is\ninteresting for space-efficient long-term storage of large lists of\nvariants.</p>\n        </li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>You could try to look for the differences between the original and the\nnormalized VCF dataset, but for convenience <strong>bcftools norm</strong> reports a brief\nsummary of the actions it performed. Expand the dataset in the history (by\nclicking on its name) to see this output listing the total number of variant\nlines processed, along with the number of split, realigned and skipped records.</p>\n\n<h1 id=\"variant-annotation-and-reporting\">Variant annotation and reporting</h1>\n\n<p>A list of variants detected in a set of samples is a start, but to discover\nbiologically or clinically relevant information in it is almost impossible\nwithout some additional tools and data. In particular, the\nvariants in the list need to be:</p>\n\n<ul>\n  <li>\n    <p><strong>prioritized</strong> with respect to their potential relevance for the biological\n/ clinical phenotype that is studied</p>\n\n    <p>Even with exome sequencing, only a fraction of the detected variants will\nhave a clear impact on the function of a protein (many variants will\nintroduce silent mutations, or reside in intronic regions still covered by\nthe exome-enriched sequencing data). Of these, many will have been observed\nbefore in healthy individuals arguing against them playing an important role\nin an adverse phenotype.</p>\n  </li>\n  <li>\n    <p><strong>filtered</strong> based on the inheritance pattern expected for a causative\nvariant</p>\n\n    <p>A multisample VCF file records the most likely genotypes of all samples at\nevery variant site. Knowing which individuals (samples) are affected by a\nphenotype we can exclude variants with inheritance patterns that are\nincompatible with the observed inheritance of the phenotype.</p>\n  </li>\n  <li>\n    <p><strong>reported</strong> in a more human-friendly form</p>\n\n    <p>While the VCF format can be used to encode all relevant information about any\nvariant, it is hard for humans to parse that information.</p>\n\n    <p>Ideally, one would like to generate simpler reports for any set of filtered\nand prioritized variants.</p>\n  </li>\n</ul>\n\n<h2 id=\"get-data-1\">Get data</h2>\n\n<p>Our workhorse for annotating and reporting variants and the genes affected by\nthem will be the <strong>GEMINI</strong> framework. GEMINI comes bundled with a wealth of\nannotation data for human variants from many different sources. These can be\nused to annotate any list of human variants conveniently, without the need for\nseparate downloads and conversion between different annotation data formats.</p>\n\n<blockquote class=\"details\">\n  <details-title>Custom annotations and GEMINI</details-title>\n  <p>Beyond its bundled annotation data, GEMINI also provides (limited) support\nfor using custom annotations.\nThe <a href=\"../somatic-variants/tutorial.html\">Somatic variant calling tutorial</a>\ndemonstrates the use of <strong>GEMINI annotate</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> for this purpose.</p>\n</blockquote>\n\n<p>The only additional annotation tool we need, for the purpose of this\ntutorial, is the tool <strong>SnpEff</strong>, which can annotate variants with their\ncalculated effects on known genomic features. Because SnpEff is a generic tool\nthat can be used on variants found in the genome of any organism we need to\nprovide it with a so-called <strong>SnpEff genome file</strong> that holds the annotated\nfeatures (genes, transcripts, translated regions, <em>etc.</em>) for our genome of\ninterest.</p>\n\n<p>While annotated variants are all we need to <em>prioritize</em> them as described\nabove, <em>filtering based on inheritance patterns</em> requires a way to inform\nGEMINI about the relationship between our samples and their observed\nphenotypes. This is done through a so-called <strong>pedigree file</strong> in PED format,\nwhich is rather simple to generate manually.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Obtain SnpEff genome and GEMINI pedigree files</hands-on-title>\n  <ol>\n    <li>\n      <p>Download <strong>SnpEff functional genomic annotations</strong></p>\n\n      <blockquote class=\"comment\">\n        <comment-title>Shortcut</comment-title>\n        <p>You can skip this step if the Galaxy server you are working on offers\n<code class=\"language-plaintext highlighter-rouge\">Homo sapiens: hg19</code> as a locally installed snpEff database. You can\ncheck the <strong>Genome source</strong> select list of the\n<span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/snpeff/snpEff/4.3+T.galaxy2\" title=\"SnpEff eff tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>SnpEff eff</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 4.3+T.galaxy2)</span>\ntool to see if this is the case.</p>\n      </blockquote>\n\n      <p>Use <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/snpeff/snpEff_download/4.3+T.galaxy2\" title=\"SnpEff Download tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>SnpEff Download</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 4.3+T.galaxy2)</span> to download genome annotation\n database <code class=\"language-plaintext highlighter-rouge\">hg19</code>.</p>\n    </li>\n    <li>\n      <p>Create a PED-formatted pedigree dataset describing our single-family sample trio:</p>\n\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>#family_id    name     paternal_id    maternal_id    sex    phenotype\nFAM           father   0              0              1      1\nFAM           mother   0              0              2      1\nFAM           proband  father         mother         1      2\n</code></pre></div>      </div>\n\n      <p>and set its datatype to <code class=\"language-plaintext highlighter-rouge\">tabular</code>.</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-new-file\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-new-file\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a new file</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong> at the bottom</li>   <li>Paste the file contents into the text field</li>   <li>Change <strong>Type</strong> from “Auto-detect” to <code class=\"language-plaintext highlighter-rouge\">tabular</code>* Press <strong>Start</strong> and <strong>Close</strong> the window</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <blockquote class=\"warning\">\n        <warning-title>Remember those sample names</warning-title>\n\n        <p>The above content of the pedigree dataset assumes you chose <code class=\"language-plaintext highlighter-rouge\">father</code>,\n<code class=\"language-plaintext highlighter-rouge\">mother</code>, <code class=\"language-plaintext highlighter-rouge\">proband</code> as the sample names at the read mapping step\n(if you haven’t mapped the reads yourself, but started with the\npremapped data, you can safely skip this warning section).\nBy now, these sample names will have been propagated through <em>BWA-MEM</em>\nand <em>Freebayes</em> to the VCF dataset of variants. It is <strong>important</strong> that\nyou use matching sample names in the pedigree and in the VCF dataset, or\nGEMINI will not be able to connect the information in them.</p>\n\n        <p>If you have chosen different sample names before, you have to adjust\nthe pedigree dataset accordingly!</p>\n\n      </blockquote>\n\n      <blockquote class=\"details\">\n        <details-title>More on PED files</details-title>\n\n        <p>The PED format is explained in the help section of\n<span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/gemini_load/gemini_load/0.20.1+galaxy2\" title=\"GEMINI load tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>GEMINI load</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.20.1+galaxy2)</span>.</p>\n\n        <p>Take a moment and try to understand the information that is encoded in\nthe PED dataset we are using here.</p>\n      </blockquote>\n    </li>\n  </ol>\n</blockquote>\n\n<h2 id=\"variant-annotation-with-functional-genomic-effects\">Variant annotation with functional genomic effects</h2>\n\n<p>We need to start annotating our variants with SnpEff simply because Gemini\nknows how to parse SnpEff-annotated VCFs, while GEMINI output cannot be used\nwith SnpEff.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Adding annotations with SnpEff</hands-on-title>\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/snpeff/snpEff/4.3+T.galaxy2\" title=\"SnpEff eff tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>SnpEff eff</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 4.3+T.galaxy2)</span>\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Sequence changes (SNPs, MNPs, InDels)”</em>: the\noutput of <strong>bcftools norm</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n        <li><em>“Input format”</em>: <code class=\"language-plaintext highlighter-rouge\">VCF</code></li>\n        <li><em>“Output format”</em>: <code class=\"language-plaintext highlighter-rouge\">VCF (only if input is VCF)</code></li>\n        <li><em>“Genome source”</em>: <code class=\"language-plaintext highlighter-rouge\">Locally installed reference genome</code>\n          <ul>\n            <li><em>“Genome”</em>: <code class=\"language-plaintext highlighter-rouge\">Homo sapiens: hg19</code> (or a similarly named option)</li>\n          </ul>\n\n          <blockquote class=\"comment\">\n            <comment-title>Using the imported `hg19` SnpEff genome database</comment-title>\n            <p>If you have imported the <code class=\"language-plaintext highlighter-rouge\">hg19</code> SnpEff genome database into your\nhistory instead:</p>\n            <ul>\n              <li><em>“Genome source”</em>: <code class=\"language-plaintext highlighter-rouge\">Downloaded snpEff database in your history</code>\n                <ul>\n                  <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“SnpEff4.3 Genome Data”</em>: your imported <code class=\"language-plaintext highlighter-rouge\">hg19</code> SnpEff dataset.</li>\n                </ul>\n              </li>\n            </ul>\n          </blockquote>\n        </li>\n        <li><em>“Produce Summary Stats”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>Running the above job will produce two datasets. One is a <em>Summary Stats</em> HTML\nreport, which contains some interesting general metrics such as a distribution\nof variants across gene features. The other one is the main annotation result -\na VCF like the input, but with annotations of variant effects added to the INFO\ncolumn.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Optional hands-on: Inspect the Summary Stats output produced by SnpEff</hands-on-title>\n\n  <ol>\n    <li>Display the dataset:\n      <ul>\n        <li>Click the <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> icon next to the HTML dataset generated\nby SnpEff to display its contents.</li>\n      </ul>\n\n      <blockquote class=\"question\">\n        <question-title></question-title>\n\n        <p>One section in the report is <strong>Number of effects by type and region</strong>.\nGiven that you are analyzing exome data, what is the most surprising\naspect in this section? Do you have an idea how to explain it?</p>\n\n        <blockquote class=\"solution\">\n          <solution-title></solution-title>\n\n          <p>According to the report, intronic variants make up 50% of all\nvariants detected!</p>\n\n          <p>Exome capture kits are designed to capture exons plus a bit of\nsurrounding sequence to ensure proper coverage of the exon ends\nincluding splice junction sites.</p>\n\n          <p>Thus, even though intronic sequences are underrepresented in exome\nsequencing data, not all of them are eliminated. Since mutations\nin most intron bases are neutral, they can accumulate at higher\nfrequency than most mutations in exons and, thus, still represent a\nrelevant fraction of all detected variants.</p>\n\n        </blockquote>\n      </blockquote>\n    </li>\n  </ol>\n</blockquote>\n\n<h2 id=\"generating-a-gemini-database-of-variants-for-further-annotation-and-efficient-variant-queries\">Generating a GEMINI database of variants for further annotation and efficient variant queries</h2>\n\n<p>Next, we are going to use the SnpEff-annotated VCF as the basis for more\nexhaustive annotation with GEMINI. Unlike SnpEff, GEMINI does not just add\nannotations to a list of variants in VCF format. Instead the framework\nextracts the variants from the VCF input and stores them, together with newly\nadded annotations, in an SQL database. It then lets you formulate queries for\nretrieving and reporting subsets of variants. The combined variant\nextraction/annotation/storage step is performed by the <strong>GEMINI load</strong> tool. In\naddition, that same tool can be used to incorporate sample pedigree info into\nthe database.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Creating a GEMINI database from a variants dataset</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/gemini_load/gemini_load/0.20.1+galaxy2\" title=\"GEMINI load tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>GEMINI load</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.20.1+galaxy2)</span> with\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“VCF dataset to be loaded in the GEMINI database”</em>:\nthe output of <strong>SnpEff eff</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n        <li><em>“The variants in this input are”</em>: <code class=\"language-plaintext highlighter-rouge\">annotated with snpEff</code></li>\n        <li>\n          <p><em>“This input comes with genotype calls for its samples”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></p>\n\n          <p>Sample genotypes were called by Freebayes for us.</p>\n        </li>\n        <li><em>“Choose a gemini annotation source”</em>: select the latest available annotations snapshot (most likely, there will be only one)</li>\n        <li><em>“Sample and family information in PED format”</em>: the pedigree file\nprepared above</li>\n        <li><em>“Load the following optional content into the database”</em>\n          <ul>\n            <li><i class=\"far fa-check-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-check</span> <em>“GERP scores”</em></li>\n            <li><i class=\"far fa-check-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-check</span> <em>“CADD scores”</em></li>\n            <li><i class=\"far fa-check-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-check</span> <em>“Gene tables”</em></li>\n            <li><i class=\"far fa-check-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-check</span> <em>“Sample genotypes”</em></li>\n            <li><i class=\"far fa-check-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-check</span> <em>“variant INFO field”</em></li>\n          </ul>\n\n          <p>Leave <strong>unchecked</strong> the following:</p>\n          <ul>\n            <li>\n              <p><em>“Genotype likelihoods (sample PLs)”</em></p>\n\n              <p>Freebayes does not generate these values</p>\n            </li>\n            <li>\n              <p><em>“only variants that passed all filters”</em></p>\n\n              <p>This setting is irrelevant for our input because Freebayes did not\napply any variant filters.</p>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n  </ol>\n</blockquote>\n\n<p>Running this job generates a GEMINI-specific database dataset, which can only\nbe processed with other GEMINI tools. The benefit, however, is that we now have\nvariants, rich annotations and pedigree info stored in a format that enables\nflexible and highly efficient queries, which will greatly simplify our actual\ntask to identify the variant responsible for the child’s disease!</p>\n\n<blockquote class=\"details\">\n  <details-title>The GEMINI suite of tools</details-title>\n\n  <p>For a beginner, the sheer number of GEMINI tools may be a bit daunting and\ngive the impression that this framework adds a lot of complexity.\nIn practice, however, you will likely only need a very limited number of\nthese tools for any given analysis. To help you get an overview, here is a\nlist of the most general-purpose tools and their function:</p>\n\n  <ul>\n    <li>Every analysis will always start with <strong>GEMINI load</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> to\nbuild the GEMINI database from a variant list in VCF format and the\ndefault annotations bundled with GEMINI.</li>\n    <li><strong>GEMINI amend</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> and <strong>GEMINI annotate</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>\nlet you add additional information to a GEMINI database after it has been\ncreated. Use <strong>GEMINI amend</strong> to overwrite the pedigree info in a database\nwith the one found in a given PED input, and <strong>GEMINI annotate</strong> to add\ncustom annotations based on a VCF or BED dataset.</li>\n    <li><strong>GEMINI database info</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> lets you peek into the content of\na GEMINI database to explore, <em>e.g</em>, what annotations are stored in it.</li>\n    <li><strong>GEMINI query</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> and <strong>GEMINI gene-wise</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>\nare the two generic and most flexible tools for querying, filtering and\nreporting variants in a database. There is hardly anything you cannot do\nwith these tools, but you need to know or learn at least some SQL-like\nsyntax to use them.</li>\n    <li><strong>GEMINI inheritance pattern</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> simplifies variant queries\nbased on their inheritance pattern. While you could use the <em>query</em> and\n<em>gene-wise</em> tools for the same purpose, this tool allows you to perform a\nrange of standard queries without typing any SQL. <strong>This tool is what we\nare going to use here to identify the causative variant.</strong></li>\n    <li>The remaining tools serve more specialized purposes, which are beyond the\nscope of this tutorial.</li>\n  </ul>\n\n  <p>The <a href=\"../somatic-variants/tutorial.html\">Somatic variant calling tutorial</a>\ndemonstrates the use of the <strong>GEMINI annotate</strong> and <strong>GEMINI query</strong> tools,\nand tries to introduce some essential bits of GEMINI’s SQL-like syntax.</p>\n\n  <p>For a thorough explanation of all tools and functionality you should consult\nthe <a href=\"https://gemini.readthedocs.io\">GEMINI documentation</a>.</p>\n</blockquote>\n\n<h2 id=\"candidate-variant-detection\">Candidate variant detection</h2>\n\n<p>Let us now try to identify variants that have the potential to explain the\nboy child’s osteopetrosis phenotype. Remember that the parents are\nconsanguineous, but both of them do not suffer from the disease. This\ninformation allows us to make some assumptions about the inheritance pattern of the causative variant.</p>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>Which inheritance patterns are in line with the phenotypic observations\nfor the family trio?</p>\n\n  <p>Hint: GEMINI easily lets you search for variants fitting any of the following\ninheritance patterns:</p>\n  <ul>\n    <li>Autosomal recessive</li>\n    <li>Autosomal dominant</li>\n    <li>X-linked recessive</li>\n    <li>X-linked dominant</li>\n    <li>Autosomal de-novo</li>\n    <li>X-linked de-novo</li>\n    <li>Compound heterozygous</li>\n    <li>Loss of heterozygosity (LOH) events</li>\n  </ul>\n\n  <p>Think about which of these might apply to the causative variant.</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n    <ul>\n      <li>Since both parents are unaffected the variant cannot be dominant and\ninherited.</li>\n      <li>A de-novo acquisition of a dominant (or an X-linked recessive) mutation\nis, of course, possible.</li>\n      <li>A recessive variant is a possibility, and a more likely one given\nthe parents’ consanguinity.</li>\n      <li>For both the de-novo and the inherited recessive case, the variant could\nreside on an autosome or on the X chromosome. Given that we provided you\nwith only the subset of sequencing reads mapping to chr8, an X-linked\nvariant would not be exactly instructive though ;)</li>\n      <li>A compound heterozygous combination of variant alleles affecting the\nsame gene is possible, but less likely given the consanguinity of the\nparents (as this would require two deleterious variant alleles in the\ngene circulating in the same family).</li>\n      <li>A loss of heterozygosity (LOH) turning a heterozygous recessive variant\ninto a homozygous one could be caused by uniparental disomy or by an LOH\nevent early in embryonic development, but both these possibilities have\nan exceedingly small probability.</li>\n    </ul>\n\n    <p>Based on these considerations it makes sense to start looking for\ninherited autosomal recessive variants first. Then, if there is no\nconvincing candidate mutation among them, you could extend the search to\nde-novo variants, compund heterozygous variant pairs and LOH events -\nprobably in that order.</p>\n  </blockquote>\n</blockquote>\n\n<p>Since our GEMINI database holds the variant and genotype calls for the\nfamily trio and the relationship between the family members, we can make use\nof <strong>GEMINI inheritance pattern</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> to report all variants\nfitting any specific inheritance model with ease.</p>\n\n<p>Below is how you can perform the query for inherited autosomal recessive\nvariants. Feel free to run analogous queries for other types of variants that\nyou think could plausibly be causative for the child’s disease.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Finding and reporting plausible causative variants</hands-on-title>\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/gemini_inheritance/gemini_inheritance/0.20.1\" title=\"GEMINI inheritance pattern tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>GEMINI inheritance pattern</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.20.1)</span>\n      <ul>\n        <li><em>“GEMINI database”</em>: the GEMINI database of annotated variants; output\nof <strong>GEMINI load</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n        <li><em>“Your assumption about the inheritance pattern of the phenotype of interest”</em>:\n<code class=\"language-plaintext highlighter-rouge\">Autosomal recessive</code>\n          <ul>\n            <li><i class=\"far fa-plus-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-repeat</span> <em>“Additional constraints on variants”</em>\n              <ul>\n                <li>\n                  <p><em>“Additional constraints expressed in SQL syntax”</em>:\n<code class=\"language-plaintext highlighter-rouge\">impact_severity != 'LOW'</code></p>\n\n                  <p>This is a simple way to prioritize variants based on their\nfunctional genomic impact. Variants with <em>low impact severity</em> would\nbe those with no obvious impact on protein function (<em>i.e.</em>, silent\nmutations and variants outside coding regions)</p>\n                </li>\n              </ul>\n            </li>\n            <li>\n              <p><em>“Include hits with less convincing inheritance patterns”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></p>\n\n              <p>This option is only meaningful with larger family trees to account\nfor errors in phenotype assessment.</p>\n            </li>\n            <li>\n              <p><em>“Report candidates shared by unaffected samples”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></p>\n\n              <p>This option is only meaningful with larger family trees to account\nfor alleles with partial phenotypic penetrance.</p>\n            </li>\n          </ul>\n        </li>\n        <li>\n          <p><em>“Family-wise criteria for variant selection”</em>: keep default settings</p>\n\n          <p>This section is not useful when you have data from just one family.</p>\n        </li>\n        <li>In <em>“Output - included information”</em>\n          <ul>\n            <li><em>“Set of columns to include in the variant report table”</em>:\n<code class=\"language-plaintext highlighter-rouge\">Custom (report user-specified columns)</code>\n              <ul>\n                <li><em>“Choose columns to include in the report”</em>:\n                  <ul>\n                    <li><i class=\"far fa-check-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-check</span> <em>“alternative allele frequency (max_aaf_all)”</em></li>\n                  </ul>\n                </li>\n                <li><em>“Additional columns (comma-separated)”</em>:\n<code class=\"language-plaintext highlighter-rouge\">chrom, start, ref, alt, impact, gene, clinvar_sig,\nclinvar_disease_name, clinvar_gene_phenotype, rs_ids</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n\n      <blockquote class=\"comment\">\n        <comment-title>Variant- <i>vs</i> gene-centric ClinVar information</comment-title>\n        <p>Most annotation data offered by GEMINI is variant-centric, <em>i.e.</em>,\nannotations reported for a variant are specific to this exact variant.\nA few annotation sources, however, also provide gene-centric\ninformation, which applies to the gene affected by a variant, not\nnecessarily the variant itself.</p>\n\n        <p>In the case of <a href=\"https://www.ncbi.nlm.nih.gov/clinvar/\">ClinVar</a>, the\nannotation fields/columns <code class=\"language-plaintext highlighter-rouge\">clinvar_sig</code> and <code class=\"language-plaintext highlighter-rouge\">clinvar_disease_name</code> refer\nto the particular variant, but <code class=\"language-plaintext highlighter-rouge\">clinvar_gene_phenotype</code> provides\ninformation about the affected gene.</p>\n\n        <p>Including the gene phenotype in the report can be crucial because a\ngene may be well known to be disease-relevant, while a particular\nvariant may not have been clinically observed or been reported before.</p>\n      </blockquote>\n    </li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>From the GEMINI reports you generated, can you identify the most likely\ncandidate variant responsible for the child’s disease?</p>\n</blockquote>\n\n<blockquote class=\"details\">\n  <details-title>More GEMINI usage examples</details-title>\n\n  <p>While only demonstrating command line use of GEMINI, the following tutorial\nslides may give you additional ideas for variant queries and filters:</p>\n\n  <ul>\n    <li><a href=\"https://s3.amazonaws.com/gemini-tutorials/Intro-To-Gemini.pdf\">Introduction to GEMINI</a></li>\n    <li><a href=\"https://s3.amazonaws.com/gemini-tutorials/Gemini-DeNovo-Tutorial.pdf\">Identifying <em>de novo</em> mutations with GEMINI</a></li>\n    <li><a href=\"https://s3.amazonaws.com/gemini-tutorials/Gemini-Recessive-Tutorial.pdf\">Identifying recessive gene candidates with GEMINI</a></li>\n    <li><a href=\"https://s3.amazonaws.com/gemini-tutorials/Gemini-Dominant-Tutorial.pdf\">Identifying dominant gene candidates with GEMINI</a></li>\n  </ul>\n</blockquote>\n\n<h1 id=\"conclusion\">Conclusion</h1>\n\n<p>It was not hard to find the most likely causative mutation for the child’s\ndisease (you did find it, right?).</p>\n\n<p>Even though it will not always provide as strong support for just one specific\ncausative variant, analysis of whole-exome sequencing data of family trios (or\nother related samples) can often narrow down the search for the cause of a\ngenetic disease to just a very small, manageable set of candidate variants, the\nrelevance of which can then be addressed through standard methods.</p>\n"],"ref_slides":[],"hands_on":true,"slides":false,"mod_date":"2023-11-03 14:30:27 +0000","pub_date":"2016-08-19 14:05:48 +0000","version":41,"workflows":[{"workflow":"workflow_exome_seq_from_premapped.ga","tests":true,"url":"https://training.galaxyproject.org/training-material/topics/variant-analysis/tutorials/exome-seq/workflows/workflow_exome_seq_from_premapped.ga","path":"topics/variant-analysis/tutorials/exome-seq/workflows/workflow_exome_seq_from_premapped.ga","wfid":"variant-analysis-exome-seq","wfname":"workflow_exome_seq_from_premapped","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/variant-analysis-exome-seq/versions/workflow_exome_seq_from_premapped","license":"MIT","creators":[{"class":"Person","identifier":"0000-0002-9464-6640","name":"Wolfgang Maier"}],"name":"Exome Seq Training Pre-Mapped W Cached Ref","title":"Exome Seq Training Pre-Mapped W Cached Ref","test_results":null,"modified":"2024-06-21 00:05:33 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\nFather data\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"ℹ️ Input Dataset\\nMother data\"];\n  style 1 stroke:#2c3143,stroke-width:4px;\n  2[\"ℹ️ Input Dataset\\nProband data\"];\n  style 2 stroke:#2c3143,stroke-width:4px;\n  3[\"ℹ️ Input Dataset\\nPEDigree data\"];\n  style 3 stroke:#2c3143,stroke-width:4px;\n  4[\"Samtools view\"];\n  0 -->|output| 4;\n  5[\"Samtools view\"];\n  1 -->|output| 5;\n  6[\"Samtools view\"];\n  2 -->|output| 6;\n  7[\"RmDup\"];\n  4 -->|outputsam| 7;\n  8[\"RmDup\"];\n  5 -->|outputsam| 8;\n  9[\"RmDup\"];\n  6 -->|outputsam| 9;\n  10[\"FreeBayes\"];\n  7 -->|output1| 10;\n  8 -->|output1| 10;\n  9 -->|output1| 10;\n  11[\"bcftools norm\"];\n  10 -->|output_vcf| 11;\n  12[\"SnpEff eff:\"];\n  11 -->|output_file| 12;\n  974b6b15-ccf7-4fe8-8a71-2b3fe8b45272[\"Output\\nsnpeff_variant_stats\"];\n  12 --> 974b6b15-ccf7-4fe8-8a71-2b3fe8b45272;\n  style 974b6b15-ccf7-4fe8-8a71-2b3fe8b45272 stroke:#2c3143,stroke-width:4px;\n  083b9686-5c6d-495f-9257-7243896e64d7[\"Output\\nnormalized_snpeff_annotated_variants\"];\n  12 --> 083b9686-5c6d-495f-9257-7243896e64d7;\n  style 083b9686-5c6d-495f-9257-7243896e64d7 stroke:#2c3143,stroke-width:4px;\n  13[\"GEMINI load\"];\n  12 -->|snpeff_output| 13;\n  3 -->|output| 13;\n  14[\"GEMINI inheritance pattern\"];\n  13 -->|outfile| 14;\n  c5a64822-3c68-495e-b2fd-4642b1aabb5a[\"Output\\ncandidate_mutations\"];\n  14 --> c5a64822-3c68-495e-b2fd-4642b1aabb5a;\n  style c5a64822-3c68-495e-b2fd-4642b1aabb5a stroke:#2c3143,stroke-width:4px;"},{"workflow":"workflow_exome_seq_full.ga","tests":true,"url":"https://training.galaxyproject.org/training-material/topics/variant-analysis/tutorials/exome-seq/workflows/workflow_exome_seq_full.ga","path":"topics/variant-analysis/tutorials/exome-seq/workflows/workflow_exome_seq_full.ga","wfid":"variant-analysis-exome-seq","wfname":"workflow_exome_seq_full","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/variant-analysis-exome-seq/versions/workflow_exome_seq_full","license":"MIT","creators":[{"class":"Person","identifier":"0000-0002-9464-6640","name":"Wolfgang Maier"}],"name":"Exome Seq Training Full W Cached Ref","title":"Exome Seq Training Full W Cached Ref","test_results":null,"modified":"2024-06-21 00:05:33 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\nfather_R1\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"ℹ️ Input Dataset\\nfather_R2\"];\n  style 1 stroke:#2c3143,stroke-width:4px;\n  2[\"ℹ️ Input Dataset\\nmother_R1\"];\n  style 2 stroke:#2c3143,stroke-width:4px;\n  3[\"ℹ️ Input Dataset\\nmother_R2\"];\n  style 3 stroke:#2c3143,stroke-width:4px;\n  4[\"ℹ️ Input Dataset\\nproband_R1\"];\n  style 4 stroke:#2c3143,stroke-width:4px;\n  5[\"ℹ️ Input Dataset\\nproband_R2\"];\n  style 5 stroke:#2c3143,stroke-width:4px;\n  6[\"ℹ️ Input Dataset\\nPEDigree data\"];\n  style 6 stroke:#2c3143,stroke-width:4px;\n  7[\"FastQC\"];\n  0 -->|output| 7;\n  8[\"FastQC\"];\n  1 -->|output| 8;\n  9[\"Map with BWA-MEM\"];\n  0 -->|output| 9;\n  1 -->|output| 9;\n  10[\"FastQC\"];\n  2 -->|output| 10;\n  11[\"FastQC\"];\n  3 -->|output| 11;\n  12[\"Map with BWA-MEM\"];\n  2 -->|output| 12;\n  3 -->|output| 12;\n  13[\"FastQC\"];\n  4 -->|output| 13;\n  14[\"FastQC\"];\n  5 -->|output| 14;\n  15[\"Map with BWA-MEM\"];\n  4 -->|output| 15;\n  5 -->|output| 15;\n  16[\"Samtools view\"];\n  9 -->|bam_output| 16;\n  17[\"Samtools view\"];\n  12 -->|bam_output| 17;\n  18[\"MultiQC\"];\n  7 -->|text_file| 18;\n  8 -->|text_file| 18;\n  10 -->|text_file| 18;\n  11 -->|text_file| 18;\n  13 -->|text_file| 18;\n  14 -->|text_file| 18;\n  de867748-890a-454c-baf3-6a9313269975[\"Output\\nmultiqc_input_data\"];\n  18 --> de867748-890a-454c-baf3-6a9313269975;\n  style de867748-890a-454c-baf3-6a9313269975 stroke:#2c3143,stroke-width:4px;\n  19[\"Samtools view\"];\n  15 -->|bam_output| 19;\n  20[\"RmDup\"];\n  16 -->|outputsam| 20;\n  21[\"RmDup\"];\n  17 -->|outputsam| 21;\n  22[\"RmDup\"];\n  19 -->|outputsam| 22;\n  23[\"FreeBayes\"];\n  20 -->|output1| 23;\n  21 -->|output1| 23;\n  22 -->|output1| 23;\n  24[\"bcftools norm\"];\n  23 -->|output_vcf| 24;\n  25[\"SnpEff eff:\"];\n  24 -->|output_file| 25;\n  4aab5884-4099-4e41-a82d-c4e1ff19609f[\"Output\\nsnpeff_variant_stats\"];\n  25 --> 4aab5884-4099-4e41-a82d-c4e1ff19609f;\n  style 4aab5884-4099-4e41-a82d-c4e1ff19609f stroke:#2c3143,stroke-width:4px;\n  e5a2fbc7-acdd-4782-822a-91568cb8d5b8[\"Output\\nnormalized_snpeff_annotated_variants\"];\n  25 --> e5a2fbc7-acdd-4782-822a-91568cb8d5b8;\n  style e5a2fbc7-acdd-4782-822a-91568cb8d5b8 stroke:#2c3143,stroke-width:4px;\n  26[\"GEMINI load\"];\n  25 -->|snpeff_output| 26;\n  6 -->|output| 26;\n  27[\"GEMINI inheritance pattern\"];\n  26 -->|outfile| 27;\n  07bd4bba-e7d9-48a8-b812-5dc2b07712bd[\"Output\\ncandidate_mutations\"];\n  27 --> 07bd4bba-e7d9-48a8-b812-5dc2b07712bd;\n  style 07bd4bba-e7d9-48a8-b812-5dc2b07712bd stroke:#2c3143,stroke-width:4px;"}],"api":"https://training.galaxyproject.org/training-material/api/topics/variant-analysis/tutorials/exome-seq/tutorial.json","tools":["toolshed.g2.bx.psu.edu/repos/devteam/bwa/bwa_mem/0.7.17.2","toolshed.g2.bx.psu.edu/repos/devteam/fastqc/fastqc/0.74+galaxy0","toolshed.g2.bx.psu.edu/repos/devteam/freebayes/freebayes/1.3.6+galaxy0","toolshed.g2.bx.psu.edu/repos/devteam/samtools_rmdup/samtools_rmdup/2.0.1","toolshed.g2.bx.psu.edu/repos/iuc/bcftools_norm/bcftools_norm/1.15.1+galaxy3","toolshed.g2.bx.psu.edu/repos/iuc/gemini_inheritance/gemini_inheritance/0.20.1","toolshed.g2.bx.psu.edu/repos/iuc/gemini_load/gemini_load/0.20.1+galaxy2","toolshed.g2.bx.psu.edu/repos/iuc/multiqc/multiqc/1.11+galaxy1","toolshed.g2.bx.psu.edu/repos/iuc/samtools_view/samtools_view/1.15.1+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/snpeff/snpEff/4.3+T.galaxy2","toolshed.g2.bx.psu.edu/repos/iuc/snpeff/snpEff_download/4.3+T.galaxy2","toolshed.g2.bx.psu.edu/repos/pjbriggs/trimmomatic/trimmomatic/0.38.1"],"supported_servers":{"exact":[{"url":"https://usegalaxy.cz/","name":"UseGalaxy.cz","usegalaxy":false},{"url":"https://usegalaxy.eu","name":"UseGalaxy.eu","usegalaxy":true},{"url":"https://usegalaxy.fr/","name":"UseGalaxy.fr","usegalaxy":false},{"url":"https://usegalaxy.org","name":"UseGalaxy.org (Main)","usegalaxy":true}],"inexact":[{"url":"https://usegalaxy.no/","name":"UseGalaxy.no","usegalaxy":false},{"url":"https://usegalaxy.org.au","name":"UseGalaxy.org.au","usegalaxy":true}]},"topic_name_human":"Variant Analysis","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"bwa","owner":"devteam","revisions":"e188dc7a68e6","tool_panel_section_label":"Mapping","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"fastqc","owner":"devteam","revisions":"5ec9f6bceaee","tool_panel_section_label":"FASTA/FASTQ","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"freebayes","owner":"devteam","revisions":"a5937157062f","tool_panel_section_label":"Variant Calling","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"samtools_rmdup","owner":"devteam","revisions":"586f9e1cdb2b","tool_panel_section_label":"SAM/BAM","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"bcftools_norm","owner":"iuc","revisions":"ebb2e12a6de1","tool_panel_section_label":"Variant Calling","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"gemini_inheritance","owner":"iuc","revisions":"2c68e29c3527","tool_panel_section_label":"Gemini","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"gemini_load","owner":"iuc","revisions":"2270a8b83c12","tool_panel_section_label":"Gemini","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"multiqc","owner":"iuc","revisions":"abfd8a6544d7","tool_panel_section_label":"Quality Control","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"samtools_view","owner":"iuc","revisions":"5826298f6a73","tool_panel_section_label":"SAM/BAM","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"snpeff","owner":"iuc","revisions":"9473cd297a76","tool_panel_section_label":"Variant Calling","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"snpeff","owner":"iuc","revisions":"9473cd297a76","tool_panel_section_label":"Variant Calling","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"trimmomatic","owner":"pjbriggs","revisions":"d94aff5ee623","tool_panel_section_label":"FASTA/FASTQ","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: bwa\n  owner: devteam\n  revisions: e188dc7a68e6\n  tool_panel_section_label: Mapping\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: fastqc\n  owner: devteam\n  revisions: 5ec9f6bceaee\n  tool_panel_section_label: FASTA/FASTQ\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: freebayes\n  owner: devteam\n  revisions: a5937157062f\n  tool_panel_section_label: Variant Calling\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: samtools_rmdup\n  owner: devteam\n  revisions: 586f9e1cdb2b\n  tool_panel_section_label: SAM/BAM\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bcftools_norm\n  owner: iuc\n  revisions: ebb2e12a6de1\n  tool_panel_section_label: Variant Calling\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: gemini_inheritance\n  owner: iuc\n  revisions: 2c68e29c3527\n  tool_panel_section_label: Gemini\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: gemini_load\n  owner: iuc\n  revisions: 2270a8b83c12\n  tool_panel_section_label: Gemini\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: multiqc\n  owner: iuc\n  revisions: abfd8a6544d7\n  tool_panel_section_label: Quality Control\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: samtools_view\n  owner: iuc\n  revisions: 5826298f6a73\n  tool_panel_section_label: SAM/BAM\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: snpeff\n  owner: iuc\n  revisions: 9473cd297a76\n  tool_panel_section_label: Variant Calling\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: snpeff\n  owner: iuc\n  revisions: 9473cd297a76\n  tool_panel_section_label: Variant Calling\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: trimmomatic\n  owner: pjbriggs\n  revisions: d94aff5ee623\n  tool_panel_section_label: FASTA/FASTQ\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":false,"slides_recordings":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial"}