{"layout":"tutorial_hands_on","title":"Submitting sequence data to ENA","zenodo_link":"https://doi.org/10.5281/zenodo.5163611","questions":["How do you submit raw sequence reads and assembled genomes to the European Nucleotide Archive?"],"objectives":["Submit raw sequencing reads and metadata to ENA's test server","Submit consensus sequence and metadata to ENA's test server"],"time_estimation":"1h","level":"Intermediate","key_points":["Use Galaxy's 'ENA Upload tool' to submit raw reads to ENA","Use Galaxy's 'Submit consensus sequence to ENA' tool","You need to include your ENA Webin credentials in Galaxy","For small submission use 'ENA Upload tool' interactive metadata forms feature","For bulk submissions use a spreadsheet metadata template"],"requirements":[{"type":"internal","topic_name":"sequence-analysis","tutorials":["human-reads-removal"]},{"type":"internal","topic_name":"galaxy-interface","tutorials":["collections"]}],"tags":["covid19"],"contributors":[{"name":"Miguel Roncoroni","joined":"2021-08","email":"miguel.roncoroni@elixir-belgium.org","id":"roncoronimiguel","url":"https://training.galaxyproject.org/training-material/api/contributors/roncoronimiguel.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/roncoronimiguel/"},{"name":"Bert Droesbeke","email":"bert.droesbeke@vib.be","matrix":"bedroesb:matrix.org","orcid":"0000-0003-0522-5674","joined":"2019-12","elixir_node":"be","affiliations":["elixir-europe"],"id":"bedroesb","url":"https://training.galaxyproject.org/training-material/api/contributors/bedroesb.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/bedroesb/"},{"name":"Boris Depoortere","joined":"2024-04","email":"boris.depoortere99@gmail.com","linkedin":"borisdepoortere","matrix":"b0r1sd:matrix.org","elixir_node":"be","location":{"country":"BE","lat":51.054,"lon":3.723},"affiliations":["elixir-europe"],"id":"B0r1sD","url":"https://training.galaxyproject.org/training-material/api/contributors/B0r1sD.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/B0r1sD/"}],"js_requirements":{"mathjax":null,"mermaid":false},"short_id":"T00159","url":"/topics/galaxy-interface/tutorials/upload-data-to-ena/tutorial.html","topic_name":"galaxy-interface","tutorial_name":"upload-data-to-ena","dir":"topics/galaxy-interface/tutorials/upload-data-to-ena","symlink":null,"id":"galaxy-interface/upload-data-to-ena","ref_tutorials":["<p>Raw reads contain valuable information, such as coverage depth and quality scores, that is lost in a consensus sequence.\nSubmission of raw reads to public repositories allows reuse of data and reproducibility of analysis and enables discovery of minor allelic variants and intrahost variation, for example during the recent COVID-19 pandemic (<span class=\"citation\"><a href=\"#Maier2021\">Maier <i>et al.</i> 2021</a></span>).</p>\n\n<p>The European Nucleotide Archive is an Open and FAIR repository of nucleotide data. As part of the International Nucleotide Sequence Database Collaboration (INSDC), ENA also indexes data from the NCBI and DDBJ <span class=\"citation\"><a href=\"#Arita2020\">Arita <i>et al.</i> 2020</a></span>. Data submitted to ENA must be accompanied by sufficient metadata. You can learn more from this <a href=\"/training-material/topics/galaxy-interface/tutorials/upload-data-to-ena/slides.html\">introductory slide deck</a> or directly from <a href=\"https://ena-docs.readthedocs.io/en/latest/submit/general-guide/metadata.html\">ENA</a>.</p>\n\n<p>In this tutorial we will show you how to use Galaxy’s ‘ENA Upload tool’ to submit raw sequencing reads, consensus sequences and their associated metadata to ENA (<span class=\"citation\"><a href=\"#Roncoroni2021\">Roncoroni <i>et al.</i> 2021</a></span>). You will learn to add your ENA Webin credentials to Galaxy, input metadata interactively or via a metadata template and submit the reads to ENA (test) server using Galaxy’s ‘ENA upload tool’.\nSpecifically, we will use one ONT sequencing file to demonstrate interactive metadata input and two sets of PE Illumina reads to demonstrate how to use the ENA metadata template. Finally, we will submit consensus sequences to ENA using ‘Submit consensus sequence to ENA’ tool.</p>\n\n<p>Data will be submitted to ENA’s test server and will not be public.</p>\n\n<blockquote class=\"comment\">\n  <comment-title>Nature of the input data</comment-title>\n  <p>We will use data derived from sequencing data of bronchoalveolar lavage fluid (BALF) samples obtained from early COVID-19 patients in China as our input data.\nHuman traces have been removed in <a href=\"/training-material/topics/sequence-analysis/tutorials/human-reads-removal/tutorial.html\">Galaxy</a>.</p>\n\n</blockquote>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n  <p>In this tutorial, we will cover:</p>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#adding-ena-webin-credentials-to-your-galaxy-user-information\" id=\"markdown-toc-adding-ena-webin-credentials-to-your-galaxy-user-information\">Adding ENA Webin credentials to your Galaxy user information</a></li>\n  <li><a href=\"#submitting-raw-sequence-data-reads-to-the-ena\" id=\"markdown-toc-submitting-raw-sequence-data-reads-to-the-ena\">Submitting raw sequence data (reads) to the ENA</a>    <ol>\n      <li><a href=\"#option-1-submitting-to-ena-using-interactive-metadata-generator\" id=\"markdown-toc-option-1-submitting-to-ena-using-interactive-metadata-generator\">Option 1: submitting to ENA using interactive metadata generator</a></li>\n      <li><a href=\"#option-2-submitting-to-ena-using-a-metadata-template\" id=\"markdown-toc-option-2-submitting-to-ena-using-a-metadata-template\">Option 2: submitting to ENA using a metadata template</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#submitting-consensus-sequences-to-ena\" id=\"markdown-toc-submitting-consensus-sequences-to-ena\">Submitting consensus sequences to ENA</a></li>\n</ol>\n\n</blockquote>\n\n<h1 id=\"adding-ena-webin-credentials-to-your-galaxy-user-information\">Adding ENA Webin credentials to your Galaxy user information</h1>\n\n<p>In order to submit data to ENA, you need to have a valid Webin account. If you don’t have one already you can register for one <a href=\"https://www.ebi.ac.uk/ena/submit/sra/#registration\">on ENA’s Registration Page</a>. Webin credentials need to be included in your Galaxy user information before you can use the ENA Upload tool.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Add Webin credentials to your Galaxy user information</hands-on-title>\n\n  <ol>\n    <li>If you have not already done so, log in to usegalaxy.eu</li>\n    <li>Navigate to <em>“User”</em> &gt; <em>“Preferences”</em> on the top menu\n      <ul>\n        <li>Click on <i class=\"fa fa-user\" aria-hidden=\"true\"></i> <strong>Manage Information</strong></li>\n      </ul>\n      <ul>\n        <li>Scroll down to <em>“Your ENA Webin account details”</em> and fill in your <strong><em>ENA Webin ID</em></strong> and <strong><em>Password</em></strong></li>\n      </ul>\n    </li>\n  </ol>\n  <figure id=\"figure-1\" style=\"max-width: 90%;\"><img src=\"../../images/upload-data-to-ena/ENA-credentials.png\" alt=\"ENA Webin Account details in Galaxy. \" width=\"212\" height=\"165\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/upload-data-to-ena/ENA-credentials.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 1</strong>:</span> ENA Webin Account details</figcaption></figure>\n</blockquote>\n\n<h1 id=\"submitting-raw-sequence-data-reads-to-the-ena\">Submitting raw sequence data (reads) to the ENA</h1>\n<h2 id=\"option-1-submitting-to-ena-using-interactive-metadata-generator\">Option 1: submitting to ENA using interactive metadata generator</h2>\n\n<p>In this first example, you will submit one ONT sequence file using the interactive metadata forms from the ENA Upload tool. This method is only convenient for small submissions. For bulk submissions, we recommend you use the metadata template described below in Option 2.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Data upload</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Upload the ONT data from Zenodo via URLs</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-via-links\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-via-links\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing via links</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <p>The URL for our example data is this:</p>\n\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/6912963/files/SRR10902284_ONT.fq.gz\n</code></pre></div>      </div>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>Once the data is uploaded, we fill the metadata using  the ENA Upload tool. Interactive metadata forms are nested to fit <a href=\"https://ena-docs.readthedocs.io/en/latest/submit/general-guide/metadata.html\">ENA’s metadata model</a>. Briefly, you add Samples to a Study, Experiments to Samples and Runs to Experiments. The interactive metadata form does only two <a href=\"https://www.ebi.ac.uk/ena/browser/checklists\">ENA Sample Checklists</a>, the basic minimal sample metadata and the ENA virus pathogen reporting standard checklist. Switch between the basic template and the virus pathogen one under the “Select your sample type” option. If you wish to include additional metadata from a sample checklist, please use Option 2 below.</p>\n\n<p>We recommend always submitting to the test server before submitting to the public one.\nAfter you confirm that all the data and metadata looks ok, you can go ahead and submit to the public ENA server.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>add metadata interactively and submit a single sequence to ENA</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/ena_upload/ena_upload/0.7.1\" title=\"ENA Upload tool tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>ENA Upload tool</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.7.1)</span>:\n      <ul>\n        <li><em>“Action to execute”</em>: <code class=\"language-plaintext highlighter-rouge\">Add new (meta)data</code></li>\n        <li><em>“Select the metadata input method”</em>: <code class=\"language-plaintext highlighter-rouge\">Interactively (only recommended for small studies)</code></li>\n        <li><em>“Add .fastq (.gz, .bz2) extension to the Galaxy dataset names to match the ones described in the input tables?”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n        <li><em>“Select your sample type”</em>: <code class=\"language-plaintext highlighter-rouge\">Viral</code></li>\n        <li>Under “Submission options”:\n          <ul>\n            <li><em>“Affiliation centre”</em>: your institution</li>\n            <li><em>“Submit to ENA test server”</em>: <code class=\"language-plaintext highlighter-rouge\">yes</code></li>\n            <li><em>“Create test outputs without submitting (meta)data to ENA”</em>: <code class=\"language-plaintext highlighter-rouge\">no</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>Fill all metadata boxes and make sure that:\n      <ul>\n        <li><em>”“</em>:</li>\n        <li><em>“Please select the type of study”</em>: <code class=\"language-plaintext highlighter-rouge\">Whole Genome Sequencing</code></li>\n        <li><em>“Enter the species of the sample”</em>: <code class=\"language-plaintext highlighter-rouge\">Severe acute respiratory syndrome coronavirus 2</code></li>\n        <li><em>“Enter the taxonomic ID corresponding to the sample species”</em>: <code class=\"language-plaintext highlighter-rouge\">2697049</code></li>\n        <li><em>“Host common name”</em>: <code class=\"language-plaintext highlighter-rouge\">human</code></li>\n        <li><em>“Host subject id”</em>: avoid using ID that can be use to trace samples back to patients</li>\n        <li><em>“Host scientific name”</em>: <code class=\"language-plaintext highlighter-rouge\">Homo sapiens</code></li>\n        <li><em>“Library strategy”</em>: <code class=\"language-plaintext highlighter-rouge\">RNA-Seq</code></li>\n        <li><em>“Select library source”</em>: <code class=\"language-plaintext highlighter-rouge\">METAGENOMIC</code></li>\n        <li><em>“Library selection”</em>: <code class=\"language-plaintext highlighter-rouge\">RANDOM</code></li>\n        <li><em>“Library layout”</em>: <code class=\"language-plaintext highlighter-rouge\">SINGLE</code></li>\n        <li><em>“Select the sequencing platform used”</em>: <code class=\"language-plaintext highlighter-rouge\">Oxford Nanopore</code></li>\n        <li><em>“Instrument model”</em>: <code class=\"language-plaintext highlighter-rouge\">minION</code></li>\n        <li><em>“Runs executed within this experiment”</em>\n          <ul>\n            <li><i class=\"far fa-copy\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-files</span> <em>“File(s) associated with this run”</em>: <code class=\"language-plaintext highlighter-rouge\">SRR10902284_ONT.fq.gz</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"warning\">\n  <warning-title>Do not include personal identifiable data</warning-title>\n  <p>In some cases, some information is requested by ENA that may classify as personal or could be used to identify persons (e.g. ‘host ID’ for checklist ERC000033). Make sure that you do not publish any personal metadata that infringes privacy protection regulations in your jurisdiction.</p>\n</blockquote>\n\n<blockquote class=\"warning\">\n  <warning-title>Submit to the test server first</warning-title>\n  <p>Make sure <em>“Submit to ENA test server”</em>: <code class=\"language-plaintext highlighter-rouge\">yes</code>. Otherwise your data will be submitted to the public server.</p>\n</blockquote>\n\n<p>Four metadata tables (Study, Sample, Experiment and Run), and a metadata ticket with submission information are generated. You can confirm a successful submission at ENA <a href=\"https://wwwdev.ebi.ac.uk/ena/submit/webin/\">test server</a> (or the <a href=\"https://www.ebi.ac.uk/ena/submit/sra\">public server</a>, if you chose it).</p>\n\n<blockquote class=\"tip\">\n  <tip-title>Metadata ticket</tip-title>\n  <p>Upon successful submission, a metadata ticket is generated. This contains information of the submission, including parseable metadata. Importantly, it contains Study, Sample, Run and Experiment accession numbers. The former two you will use later to link the consensus sequence to the raw data.</p>\n</blockquote>\n\n<h2 id=\"option-2-submitting-to-ena-using-a-metadata-template\">Option 2: submitting to ENA using a metadata template</h2>\n\n<p>For larger submissions, interactive metadata input can be tedious and not practical. In the second example, you will submit two sets of Illumina PE sequence files and input metadata using a template spreadsheet. This template contains all fields for ENA sample checklist <em>‘ERC000033 - ENA virus pathogen reporting standard checklist’</em>. Tabular (.tsv and .xlsx) metadata templates for all sample checklist can be found in <a href=\"https://github.com/ELIXIR-Belgium/ENA-metadata-templates\">this repository</a>.\nFor this tutorial, we provide you with a pre-filled template and encourage you to explore it.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Upload and inspect data</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Upload the ONT data from Zenodo via URLs:</p>\n\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/6912963/files/SRR10903401_1.fastq.gz\nhttps://zenodo.org/record/6912963/files/SRR10903401_2.fastq.gz\nhttps://zenodo.org/record/6912963/files/SRR10903402_1.fastq.gz\nhttps://zenodo.org/record/6912963/files/SRR10903402_2.fastq.gz\nhttps://zenodo.org/record/6912963/files/metadata_template_ERC000033_mock_complete.xlsx\n</code></pre></div>      </div>\n    </li>\n    <li>\n      <p>Arrange the data into a paired dataset collection</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-paired-collection\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-paired-collection\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a paired collection</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on <i class=\"far fa-check-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-selector</span> <strong>Select Items</strong> at the top of the history panel <img src=\"/training-material/topics/galaxy-interface/images/historyItemControls.png\" alt=\"Select Items button\" /></li>   <li>Check all the datasets in your history you would like to include</li>   <li>     <p>Click <strong>n of N selected</strong> and choose <strong>Build List of Dataset Pairs</strong></p>   </li>   <li>Change the text of <em>unpaired forward</em> to a common selector for the forward reads</li>   <li>Change the text of <em>unpaired reverse</em> to a common selector for the reverse reads</li>   <li>Click <strong>Pair these datasets</strong> for each valid <em>forward</em> and <em>reverse</em> pair.</li>   <li>Enter a name for your collection</li>   <li>Click <strong>Create List</strong> to build your collection</li>   <li>Click on the checkmark icon at the top of your history again</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n\n      <p>For the example datasets this means:</p>\n      <ul>\n        <li>You need to tell Galaxy about the suffix for your forward and reverse reads, respectively:\n          <ul>\n            <li>set the text of <em>unpaired forward</em> to: <code class=\"language-plaintext highlighter-rouge\">_1.fastq.gz</code></li>\n            <li>set the text of <em>unpaired reverse</em> to: <code class=\"language-plaintext highlighter-rouge\">_2.fastq.gz</code></li>\n            <li>click: <code class=\"language-plaintext highlighter-rouge\">Auto-pair</code></li>\n          </ul>\n\n          <p>All datasets should now be moved to the <em>paired section</em> of the dialog, and the middle column there should show that only the sample accession numbers, <em>i.e.</em> <code class=\"language-plaintext highlighter-rouge\">SRR10903401</code> and <code class=\"language-plaintext highlighter-rouge\">SRR10903402</code>, will be used as the pair names.</p>\n        </li>\n      </ul>\n\n      <blockquote class=\"warning\">\n        <warning-title>Paired collection names</warning-title>\n        <p>It is very important that the paired collection names contain no suffix (e.g. _1, _R1, etc.) or file extensions (.fastq, .fastq.gz). The submission tool will add these at runtime and leaving them in the paired collection names will cause a mismatch with the filenames in the metadata table.</p>\n      </blockquote>\n      <ul>\n        <li>Make sure <em>Hide original elements</em> is checked to obtain a cleaned-up history after building the collection.</li>\n        <li>Give your collection a name</li>\n        <li>Click <em>Create Collection</em></li>\n      </ul>\n    </li>\n    <li>\n      <p>Inspect the <code class=\"language-plaintext highlighter-rouge\">GTN_tutorial_mock_metadata.xlsx</code> (filled-in template) file by clicking on the <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> (eye) icon</p>\n\n      <p>https://github.com/enasequence/webin-cli</p>\n\n      <blockquote class=\"question\">\n        <question-title></question-title>\n\n        <ol>\n          <li>How many metadata sheets are there?</li>\n          <li>How is the ‘Sample’ section in the template different from that in the interactive metadata input?</li>\n        </ol>\n\n        <blockquote class=\"solution\">\n          <solution-title></solution-title>\n          <ol>\n            <li>There are four metadata sheets, one per metadata object (Study, Sample, Experiment, Run)</li>\n            <li>The Sample section is more extensive in the template spreadsheet, because it contains all the fields from ENA ERC000033 sample checklist, as well as all ‘Recommended’ and ‘Optional’ fields in the other sections.</li>\n          </ol>\n        </blockquote>\n      </blockquote>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>As before, the submission is done to the test server before submitting to the public one.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>use a metadata template and submit multiple sequences to ENA</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/ena_upload/ena_upload/0.7.1\" title=\"ENA Upload tool tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>ENA Upload tool</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.7.1)</span>:\n      <ul>\n        <li><em>“Action to execute”</em>: <code class=\"language-plaintext highlighter-rouge\">Add new (meta)data</code></li>\n        <li><em>“Select the metadata input method”</em>: <code class=\"language-plaintext highlighter-rouge\">Excel file</code></li>\n        <li><em>“Select the ENA sample checklist”</em>: <code class=\"language-plaintext highlighter-rouge\">ENA virus pathogen reporting standard checklist (ERC000033)</code></li>\n        <li><em>“Select Excel (.xlsx) file based on template”</em>: <code class=\"language-plaintext highlighter-rouge\">metadata_template_ERC000033_mock_complete.xlsx</code></li>\n        <li><em>“Select input data”</em>: <code class=\"language-plaintext highlighter-rouge\">Paired dataset collection</code></li>\n        <li><em>“List of paired-end sequencing data files”</em>: select the collection you made above during data upload</li>\n        <li>Under “Submission options”:\n          <ul>\n            <li><em>“Affiliation centre”</em>: your institution</li>\n            <li><em>“Submit to ENA test server?”</em>: <code class=\"language-plaintext highlighter-rouge\">yes</code></li>\n            <li><em>“Create test outputs without submitting (meta)data to ENA”</em>: <code class=\"language-plaintext highlighter-rouge\">no</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"warning\">\n  <warning-title>Do not include personal identifiable data</warning-title>\n  <p>In some cases, some information is requested by ENA that may classify as personal or could be used to identify persons (e.g. ‘host ID’ for checklist ERC000033). Make sure that you do not publish any personal metadata that infringes privacy protection regulations in your jurisdiction.</p>\n</blockquote>\n\n<blockquote class=\"warning\">\n  <warning-title>Submit to the test server first</warning-title>\n  <p>Make sure <em>“Submit to ENA test server?”</em>: <code class=\"language-plaintext highlighter-rouge\">yes</code>. Otherwise your data will be submitted to the public server.</p>\n</blockquote>\n\n<p>Four metadata tables (Study, Sample, Experiment and Run), and a metadata ticket with submission information are generated. You can confirm a successful submission at ENA <a href=\"https://wwwdev.ebi.ac.uk/ena/submit/webin/\">test server</a> (or the <a href=\"https://www.ebi.ac.uk/ena/submit/sra\">public server</a>, if you chose it).</p>\n\n<blockquote class=\"tip\">\n  <tip-title>Metadata ticket</tip-title>\n  <p>Upon succesful submission, a metadata ticket is generated. This contains information of the submission, including parseable metadata. Importantly, it contains Study, Sample, Run and Experiment accession numbers. The former two you will use later to link the consensus sequence to the raw data.</p>\n</blockquote>\n\n<h1 id=\"submitting-consensus-sequences-to-ena\">Submitting consensus sequences to ENA</h1>\n\n<p>We produced consensus sequences for the Illumina data from Option 2 above following <a href=\"https://workflowhub.eu/workflows/113?version=4\">SARS-CoV-2-PE-Illumina-WGS-variant-calling</a>, <a href=\"https://workflowhub.eu/workflows/109?version=5\">SARS-CoV-2-variation-reporting</a> and <a href=\"https://workflowhub.eu/workflows/138?version=4\">COVID-19-consensus-construction</a> workflows.</p>\n\n<p>In this step we will submit one consensus sequence to ENA.\nWe will link it to the reads submitted in the first step using the accession numbers given to those submissions. Galaxy’s ‘ENA Upload tool’ captures and stores metadata on a metadata ticket.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>submit consensus sequences to ENA</hands-on-title>\n\n  <ol>\n    <li>Upload the consensus sequence to Galaxy from Zenodo via URLs:\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/6912963/files/SRR10903401.fasta\n</code></pre></div>      </div>\n    </li>\n    <li><i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> Open the ‘ENA submsission receipt’ and find the Study and Sample accession numbers from the raw data submission.</li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/ieguinoa/ena_webin_cli/ena_webin_cli/7d751b5943b0\" title=\"Submit consensus sequence to ENA tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Submit consensus sequence to ENA</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 7d751b5943b0)</span>:\n      <ul>\n        <li><em>“Submit to test ENA server?”</em>: <code class=\"language-plaintext highlighter-rouge\">yes</code></li>\n        <li><em>“Validate files and metadata but do not submit”</em>: <code class=\"language-plaintext highlighter-rouge\">no</code></li>\n        <li>Fill the assembly metadata. For our assembly:\n          <ul>\n            <li><em>“Assembly type”</em>: <code class=\"language-plaintext highlighter-rouge\">Clone</code></li>\n            <li><em>“Assembly program”</em>: <code class=\"language-plaintext highlighter-rouge\">BWA-MEM</code></li>\n            <li><em>“Molecule type”</em>: <code class=\"language-plaintext highlighter-rouge\">genomic RNA</code></li>\n            <li><em>“Coverage”</em>: <code class=\"language-plaintext highlighter-rouge\">1000</code></li>\n            <li><em>“Select the method to load study and sample metadata”</em>: <code class=\"language-plaintext highlighter-rouge\">Fill in required metadata</code></li>\n            <li><em>“Assembly name”</em>: give a name to your assembly.</li>\n            <li><em>“Study accession”</em>: <code class=\"language-plaintext highlighter-rouge\">ERP139884</code> (you can find the Study accession number from your raw data submission metadata ticket)</li>\n            <li><em>“Sample accession”</em>: <code class=\"language-plaintext highlighter-rouge\">ERS12519941</code> (you can find the Sample accession number from your raw data submission metadata ticket)</li>\n            <li><em>“Sequencing platform”</em>: <code class=\"language-plaintext highlighter-rouge\">Illumina</code></li>\n          </ul>\n        </li>\n        <li>Select the consensus sequence assembly file from your history: <code class=\"language-plaintext highlighter-rouge\">SRR10903401.fasta</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>The output are a list of manifest (in our example one manifest) and a ‘submission log’. The manifest file is the metadata required by <a href=\"https://github.com/enasequence/webin-cli\">ENA’s Webin CLI tool</a>. The ‘submission log’ can be useful to troubleshoot failed submissions.</p>\n"],"ref_slides":["### The European Nucleotide Archive\n.pull-left[\n\n.left[\nENA is:\n- a FAIR and Open repository for sequence data (reads, assemblies, annotations)\n- part of the International Nucleotide Sequence Database Collaboration (INSDC) with NCBI and DDJB\n- the [COVID-19 data portal](https://www.covid19dataportal.org/) repository for SARS-CoV-2 sequences\n]\n]\n.pull-right[\n![ENA-FAIR](../../images/upload-data-to-ena/ENA-FAIR.png)\n\nThe European Nucleotide Archive and INSDC\n]\n\n---\n\n## SARS-CoV-2 sequences\n.left[\nWhy is raw SARS-CoV-2 sequence data important?\n- Allows reuse of data and reproducibility of analysis\n- Enables discovery of minor allelic variants and [intrahost variation](https://virological.org/t/global-framework-for-sars-cov-2-data-analysis-application-to-intrahost-variation-part-1/623)\n]\n.image-40[\n![Intrahost variation](../../images/upload-data-to-ena/intra-host.png)\n]\n\n.reduce70[Minor allelic-variants can be used to detect intrahost variation. From Maier et al., 2021 [doi.org/10.1101/2021.03.25.437046](https://doi.org/10.1101/2021.03.25.437046)]\n---\n\n### Submitting reads with Galaxy\n.left[\nWhy use Galaxy to submit to ENA?\n- intuitive graphical user interface (GUI)\n- simple metadata input via a template spreadsheet or interactively\n- no bioinformatics skills needed\n]\n.image-75[![upload-tool](../../images/upload-data-to-ena/upload-tool.png)\n]\n\n---\n\n### Submission overview\n.image-100[\n![reads-submission](../../images/upload-data-to-ena/reads_submission.png)\n]\n---\n\n### What you need\n.left[\nData:\n- compressed fastq format (*.fastq.gz, *.fastq.bz2)\n- human traces removed ([tutorial](https://training.galaxyproject.org/training-material/topics/sequence-analysis/tutorials/human-reads-removal/tutorial.html))\n\nMetadata:\n- interactive metadata input (for a few submissions) or;\n- metadata [template spreadsheet](https://drive.google.com/file/d/1Gx78GKh58PmRjdmJ05DBbpObAL-3oUFX/view?usp=sharing) (for bulk submissions)\n\nCredentials:\n- [ENA Webin credentials](https://www.ebi.ac.uk/ena/submit/sra/#registration) in your Galaxy user information\n]\n.left[\n![ENA-credentials](../../images/upload-data-to-ena/ENA-credentials.png)\n]\n---\n\n### Metadata\n.left[\nFor the submission of SARS-CoV-2 reads [ENA's metadata model](https://ena-docs.readthedocs.io/en/latest/submit/general-guide/metadata.html) requires:\n- study, sample, experiment and run information\n- additional information for viral samples ([viral checklist](https://www.ebi.ac.uk/ena/browser/view/ERC000033))\n]\n![metadata-model](../../images/upload-data-to-ena/metadata_model_reads.png)\n\n---\n\n\n### Metadata\n.left[\nInteractive metadata input in Galaxy:\n]\n![interactive metadata](../../images/upload-data-to-ena/interactive_metadata.png)\n---\n\n### Metadata\n.left[\nMetadata [template spreadsheet](https://drive.google.com/file/d/1Gx78GKh58PmRjdmJ05DBbpObAL-3oUFX/view?usp=sharing):\n- one sheet each for study, sample, experiment and run\n- built-in controlled vocabulary\n]\n![metadata_template](../../images/upload-data-to-ena/metadata_template.png)\n---\n\n\n### Metadata\n.left[\n- Different metadata objects are linked using Aliases\n- Aliases must be unique\n]\n![metadata-model](../../images/upload-data-to-ena/metadata_model_reads.png)\n---\n\n### Aliases\n.left[\nAliases link metadata objects:\n- Experiments are linked to Study and Samples\n- Runs are linked to Experiments\n]\n![study-sample](../../images/upload-data-to-ena/study_sample_exp.png)\n---\n\n### Aliases\n.left[\nAliases link metadata objects:\n- Experiments are linked to Study and Samples\n- Runs are linked to Experiments\n]\n![exp-run](../../images/upload-data-to-ena/exp_run.png)\n---\n\n### Aliases\n.left[\nAliases link metadata to data:\n- Data (filename.fastq.gz) is linked to Run Alias\n]\n![data-metadata](../../images/upload-data-to-ena/data_metadata.png)\n---\n"],"hands_on":true,"slides":true,"mod_date":"2024-04-03 12:52:03 +0000","pub_date":"2021-08-10 09:29:31 +0000","version":25,"workflows":[{"workflow":"main_workflow.ga","tests":false,"url":"https://training.galaxyproject.org/training-material/topics/galaxy-interface/tutorials/upload-data-to-ena/workflows/main_workflow.ga","path":"topics/galaxy-interface/tutorials/upload-data-to-ena/workflows/main_workflow.ga","wfid":"galaxy-interface-upload-data-to-ena","wfname":"main_workflow","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/galaxy-interface-upload-data-to-ena/versions/main_workflow","license":null,"creators":[],"name":"GTN_ENA_upload_workflow","title":"GTN_ENA_upload_workflow","test_results":null,"modified":"2024-06-16 00:05:36 +0000","mermaid":"flowchart TD\n  0[\"ENA Upload tool\"];\n  1[\"ENA Upload tool\"];"}],"api":"https://training.galaxyproject.org/training-material/api/topics/galaxy-interface/tutorials/upload-data-to-ena/tutorial.json","tools":["toolshed.g2.bx.psu.edu/repos/ieguinoa/ena_webin_cli/ena_webin_cli/7d751b5943b0","toolshed.g2.bx.psu.edu/repos/iuc/ena_upload/ena_upload/0.3.2","toolshed.g2.bx.psu.edu/repos/iuc/ena_upload/ena_upload/0.7.1"],"supported_servers":{"exact":[],"inexact":[]},"topic_name_human":"Using Galaxy and Managing your Data","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"ena_upload","owner":"iuc","revisions":"9e2df763086c","tool_panel_section_label":"Send Data","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: ena_upload\n  owner: iuc\n  revisions: 9e2df763086c\n  tool_panel_section_label: Send Data\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":false,"slides_recordings":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial"}