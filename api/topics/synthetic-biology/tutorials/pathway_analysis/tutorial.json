{"layout":"tutorial_hands_on","title":"Evaluating and ranking a set of pathways based on multiple metrics","zenodo_link":"https://zenodo.org/record/6628296","questions":["How to evaluate a set of heterologous pathways ?"],"objectives":["Calculate the production flux of the lycopene target molecule using _Flux Balance Analysis_ tool.","Compute thermodynamics values to optimize the yield of the reaction producing the lycopene using _Thermo_ tool.","Compute the global score for the previous annotated pathways.","Rank the computed heterologous pathways depending on their score."],"time_estimation":"20M","contributors":[{"name":"Kenza Bazi-Kabbaj","email":"kenza.bazi-kabbaj@inrae.fr","orcid":"0000-0002-4319-5616","joined":"2022-03","id":"kenza12","url":"https://training.galaxyproject.org/training-material/api/contributors/kenza12.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/kenza12/"},{"name":"Thomas Duigou","email":"thomas.duigou@inrae.fr","orcid":"0000-0002-2649-2950","linkedin":"thomas-duigou-ba281730","joined":"2022-03","id":"tduigou","url":"https://training.galaxyproject.org/training-material/api/contributors/tduigou.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/tduigou/"},{"name":"Joan Hérisson","email":"joan.herisson@univ-evry.fr","orcid":"0000-0001-9741-0847","linkedin":"joanherisson","joined":"2022-03","id":"breakthewall","url":"https://training.galaxyproject.org/training-material/api/contributors/breakthewall.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/breakthewall/"},{"name":"Guillaume Gricourt","email":"guillaume.gricourt@inrae.fr","orcid":"0000-0003-0143-5535","linkedin":"guillaume-gricourt","joined":"2022-03","id":"guillaume-gricourt","url":"https://training.galaxyproject.org/training-material/api/contributors/guillaume-gricourt.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/guillaume-gricourt/"},{"name":"Ioana Popescu","email":"ioana.popescu@univ-evry.fr","orcid":"0000-0003-2547-8935","twitter":"ioanagrig","linkedin":"ioana-popescu-8207a026","joined":"2022-03","id":"ioanagry","url":"https://training.galaxyproject.org/training-material/api/contributors/ioanagry.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/ioanagry/"},{"name":"Jean-Loup Faulon","email":"Jean-loup.Faulon@inrae.fr","orcid":"0000-0003-4274-2953","linkedin":"jean-loup-faulon-6b85976","twitter":"jeanloupfaulon","joined":"2022-03","elixir_node":"fr","affiliations":["elixir-europe"],"id":"jfaulon","url":"https://training.galaxyproject.org/training-material/api/contributors/jfaulon.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/jfaulon/"}],"recordings":[{"captioners":["kenza12"],"date":"2022-09-26","length":"5M","youtube_id":"240oxe8unnU","speakers":["breakthewall"],"type":"Demo"}],"js_requirements":{"mathjax":null,"mermaid":false},"short_id":"T00274","url":"/topics/synthetic-biology/tutorials/pathway_analysis/tutorial.html","topic_name":"synthetic-biology","tutorial_name":"pathway_analysis","dir":"topics/synthetic-biology/tutorials/pathway_analysis","symlink":null,"id":"synthetic-biology/pathway_analysis","ref_tutorials":["<p>Progress in synthetic biology is enabled by powerful bioinformatics tools such as those aimed to design metabolic pathways for the production of chemicals. These tools are available in SynBioCAD portal which is the first Galaxy set of tools for synthetic biology and metabolic engineering (<span class=\"citation\"><a href=\"#Hrisson2022\">Hérisson <i>et al.</i> 2022</a></span>).</p>\n\n<p>In this tutorial, we will use a set of tools from the <strong>Pathway Analysis workflow</strong> which will enable you to evaluate a set of heterelogous pathways previously produced by the RetroSynthesis workflow in a chassis organism (<em>E. coli</em> iML1515). These workflows are available in the <a href=\"https://galaxy-synbiocad.org\">Galaxy SynbioCAD platform</a>. The goal is to inform the user of the theoretically best performing pathways by ranking them based on the four following criteria: target product flux, thermodynamic feasibility, pathway length and enzyme availability.</p>\n\n<p>We recommend that you follow the Retrosynthesis tutorial before starting the current tutorial which will enable you to find pathways to synthesize heterologous compounds producing Lycopene in the <em>E. coli</em> chassis organism.</p>\n\n<p>Four main steps will be run using the following workflow:</p>\n\n<p>To rank the computed heterologous pathways, we need to calculate some metrics. This is why an in-house Flux Balance Analysis (FBA) was developed to calculate the production flux of a given target (e.g. lycopene). The method forces a fraction of its maximal flux through the biomass reaction while optimizing for the target molecule. This is achieved by the <em>Flux Balance Analysis</em> tool.</p>\n\n<p>Secondly, we will use the <em>Thermo</em> tool to estimate thermodynamics values (based on Gibbs free energies) for each pathway to know whether a producing pathway is feasible in physiological conditions. The contribution of individual reactions to the final pathway thermodynamic is balanced solving a linear equation system.</p>\n\n<p>After that, the <em>Score Pathway</em> tool is used to calculate a global score combining target flux, pathway thermodynamics, pathway length and enzyme availability.</p>\n\n<p>Finally, the pathway are ranked based on the global score using the <em>Rank Pathways</em> tool.</p>\n\n<p><a href=\"../../images/pathway_analysis_workflow.jpg\" rel=\"noopener noreferrer\"><img src=\"../../images/pathway_analysis_workflow.jpg\" alt=\"This image shows the pathway analysis workflow viewed from the Galaxy editor interface. The pathway analysis workflow will evaluate and rank pathways based on multiple metrics. First, Flux Balance Analysis (FBA) node will take as inputs a collection of SBMLs representing the heterologous pathways to be evaluated, another SBML representing the chassis, and 2 additional inputs are expected for indicating the biomass reaction ID and the cell compartment ID that will be used during the FBA analysis. The FBA method will optimize the production of the target under the constraint that the model should still produce some level biomass. Then, the Thermo tool is used to estimate thermodynamics values for each pathway to know whether it is favorable towards target production in physiological conditions. After that the Score Pathway tool will calculate a global score combining target flux, pathway thermodynamics, pathway length and enzyme availability. Finally, the pathways are ranked based on the global score using the Rank Pathways tool. All exchange files are SBMLs. The output is a CSV file which contains the pathway IDs and their corresponding global score.\" width=\"2698\" height=\"1056\" loading=\"lazy\" /></a></p>\n\n<p>Note that we will run the steps of this workflow individually so as not to neglect the understanding of the intermediate steps. Then, we will run the workflow automatically so that it itself retrieves the outputs from the previous step and gives them as input to the next tool.</p>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n  <p>In this tutorial, we will cover:</p>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#data-preparation\" id=\"markdown-toc-data-preparation\">Data Preparation</a>    <ol>\n      <li><a href=\"#get-data\" id=\"markdown-toc-get-data\">Get data</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#compute-the-target-product-flux\" id=\"markdown-toc-compute-the-target-product-flux\">Compute the target product flux</a>    <ol>\n      <li><a href=\"#compute-thermodynamics-values\" id=\"markdown-toc-compute-thermodynamics-values\">Compute thermodynamics values</a></li>\n      <li><a href=\"#compute-the-global-score-of-pathways\" id=\"markdown-toc-compute-the-global-score-of-pathways\">Compute the global score of pathways</a></li>\n      <li><a href=\"#rank-annotated-pathways\" id=\"markdown-toc-rank-annotated-pathways\">Rank annotated pathways</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#run-the-pathway-analysis-workflow\" id=\"markdown-toc-run-the-pathway-analysis-workflow\">Run the <strong>Pathway Analysis Workflow</strong></a></li>\n  <li><a href=\"#conclusion\" id=\"markdown-toc-conclusion\">Conclusion</a></li>\n</ol>\n\n</blockquote>\n\n<h1 id=\"data-preparation\">Data Preparation</h1>\n\n<p>First we need to upload and prepare the following inputs to analyze:</p>\n\n<ul>\n  <li>\n    <p>A set of pathways provided in the SBML format (Systems Biology Markup Language) to be ranked, modeling heterologous pathways such as those outputted by the <strong>RetroSynthesis workflow</strong> (available in <a href=\"https://galaxy-synbiocad.org\">Galaxy SynbioCAD platform</a>).</p>\n  </li>\n  <li>\n    <p>The GEM (Genome-scale Metabolic Models) which is a formalized representation of the metabolism of the host organism (the model is <em>E. coli</em> iML1515), provided in the SBML format.</p>\n  </li>\n</ul>\n\n<h2 id=\"get-data\">Get data</h2>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Data upload</hands-on-title>\n\n  <ol>\n    <li>Create a new history for this tutorial named <em>Pathway Analysis</em>.</li>\n    <li>\n      <p>Import the files from <a href=\"https://zenodo.org/record/6628296\">Zenodo</a> :</p>\n\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://zenodo.org/record/6628296/files/rp_001_0001.xml\nhttps://zenodo.org/record/6628296/files/rp_001_0006.xml\nhttps://zenodo.org/record/6628296/files/rp_001_0011.xml\nhttps://zenodo.org/record/6628296/files/rp_002_0001.xml\nhttps://zenodo.org/record/6628296/files/rp_002_0006.xml\nhttps://zenodo.org/record/6628296/files/rp_002_0011.xml\nhttps://zenodo.org/record/6628296/files/rp_003_0001.xml\nhttps://zenodo.org/record/6628296/files/rp_003_0116.xml\nhttps://zenodo.org/record/6628296/files/rp_003_0231.xml\nhttps://zenodo.org/record/6628296/files/SBML_Model_iML1515.xml\n</code></pre></div>      </div>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-importing-via-links\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-importing-via-links\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Importing via links</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class=\"fa fa-edit\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Create a list or collection named <code class=\"language-plaintext highlighter-rouge\">Heterologous pathways</code> and composed of the 9 rpSBML pathways.</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-creating-a-dataset-collection\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-creating-a-dataset-collection\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Creating a dataset collection</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on <i class=\"far fa-check-square\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-selector</span> <strong>Select Items</strong> at the top of the history panel <img src=\"/training-material/topics/galaxy-interface/images/historyItemControls.png\" alt=\"Select Items button\" /></li>   <li>Check all the datasets in your history you would like to include</li>   <li>     <p>Click <strong>n of N selected</strong> and choose <strong>Build Dataset List</strong></p>     <p><img src=\"/training-material/topics/galaxy-interface/images/buildList.png\" alt=\"build list collection menu item\" width=\"15%\" /></p>   </li>   <li>Enter a name for your collection</li>   <li>Click <strong>Create collection</strong> to build your collection</li>   <li>Click on the checkmark icon at the top of your history again</li> </ul> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h1 id=\"compute-the-target-product-flux\">Compute the target product flux</h1>\n\n<p>Notice that the starting compounds (in other words, <em>the precursors</em>) of the predicted pathways (also referred as the <em>heterologous pathways</em>) are compounds that have been initially extracted from the genome-scale metabolic model (GEM) of the organism we are interested in (also referred as <em>chassis</em>). While this step is out of the scope of the present Pathway Analysis tutorial, this means that the precursors of predicted pathways are also present in the chassis model. Hence, predicted pathways and the chassis organism model can be merged to construct “augmented” whole-cell models, enabling flux analysis of these metabolic systems. This is what we’ll do here to predict the production flux of a compound of interest.</p>\n\n<p>Within the frame of this tutorial, we’ll use the <em>E. coli</em> iML1515 GEM (downloaded from the <a href=\"http://bigg.ucsd.edu/\">BiGG database</a>) to model the chassis metabolism of <em>E. coli</em> and the target compound is the lycopene. The provided <em>E. coli</em> model is in the SBML. The extraction of precursor compounds and the pathway prediction have already been performed during the RetroSynthesis workflow (available in <a href=\"https://galaxy-synbiocad.org\">Galaxy SynbioCAD platform</a>).</p>\n\n<p>The FBA (Flux Balance Analysis) method used to calculate the flux is a mathematical approach (as decribed in section Methods in <span class=\"citation\"><a href=\"#Hrisson2022\">Hérisson <i>et al.</i> 2022</a></span>) which uses the COBRApy package (<span class=\"citation\"><a href=\"#Ebrahim2013\">Ebrahim <i>et al.</i> 2013</a></span>) and proposes 3 different analysis methods (standard FBA, parsimonious FBA, fraction of reaction). The first two methods are specific to the COBRApy package and the last one <code class=\"language-plaintext highlighter-rouge\">Fraction of Reaction</code> is an in-house analysis method (as decribed in section Methods in <span class=\"citation\"><a href=\"#Hrisson2022\">Hérisson <i>et al.</i> 2022</a></span>) to consider the cell needs for its own maintenance while producing the target compound.</p>\n\n<p>Within the workflow, the purpose of the <em>Flux Balance Analysis</em> tool is to predict the production flux of the targeted compound, while considering the cellular needs. Under such simulation conditions, the analysis that returns a low production flux may be due to some precursor compounds having a limiting production flux, nor cofactor fluxes involved not being sufficiently balanced by the chassis native metabolism. Pathways with high flux would be caused by both the precursor compounds and the cofactors being in abundance. In either case, bottlenecks that limit the flux of the pathway may be investigated (this is outside of the scope of the workflow) and pathways that do not theoretically generate high yields can be filtered out.</p>\n\n<p>We first perform an FBA (with COBRApy) optimizing the biomass reaction and record its maximal theoretical flux. The upper and lower bounds of the biomass reaction are then set to a same amount, equals to a fraction of its previously recorded optimum (default is 75% of its optimum). The method then performs a second FBA where biomass flux is enforced to this fraction of its optimum while optimizing the target production flux. Simulated fluxes are recorded directly into the SBML file and all changed flux bounds are reset to their original values before saving the output file.</p>\n\n<p><a href=\"../../images/fba_calculation.png\" rel=\"noopener noreferrer\"><img src=\"../../images/fba_calculation.png\" alt=\"This picture describes the process to obtain annotated SBML pathways with calculated fluxes. First, FBA tool takes as input one SBML representing the heterologous pathway and another SBML representing the chassis. The two SBMLs are merged to render an augmented model containing both the reactions of the heterologous pathway and the chassis. Then FBA tool uses the COBRApy package to optimize the producing flux of the target reaction, under the constraint that the flux of the biomass reaction should be equals to 75% of its maximal theoretical value. At the end, the calculated fluxes are recorded as annotations into the SBML of the heterologous pathway.\" width=\"1124\" height=\"571\" loading=\"lazy\" /></a></p>\n\n<blockquote class=\"details\">\n  <details-title>Comment</details-title>\n\n  <p>Blocking compounds that cannot provide any flux are temporarily removed from heterologous reactions for the FBA evaluation. Such cases can happen due to side substrates or products of predicted reactions that do not match any chassis compound, representing dead-end paths.</p>\n\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Calculating the flux of a target using Flux Balance Analysis (FBA)</hands-on-title>\n\n  <ol>\n    <li>Run <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/rpfba/rpfba/5.12.1\" title=\"Flux balance analysis tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Flux balance analysis</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 5.12.1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“Pathway (rpSBML)”</em>: Select <code class=\"language-plaintext highlighter-rouge\">Heterologous pathways</code> (Input dataset collection) from your current history.</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Model (SBML)”</em>: Select <code class=\"language-plaintext highlighter-rouge\">SBML_Model_iML1515.xml</code> (Input dataset) from your current history.</li>\n        <li><em>“SBML compartment ID”</em>: Leave the default value <code class=\"language-plaintext highlighter-rouge\">c</code>.</li>\n      </ul>\n\n      <blockquote class=\"comment\">\n        <comment-title>Choose a compartment corresponding to your model</comment-title>\n\n        <p>You can specify the compartment from which the chemical species were extracted.\nThe default is <code class=\"language-plaintext highlighter-rouge\">c</code>, the BiGG code for the cytoplasm.</p>\n      </blockquote>\n\n      <ul>\n        <li><em>“biomass reaction ID”</em>: Specify the biomass reaction ID that will be used for the “fraction” simulation, type <code class=\"language-plaintext highlighter-rouge\">R_BIOMASS_Ec_iML1515_core_75p37M</code>.</li>\n      </ul>\n\n      <blockquote class=\"comment\">\n        <comment-title>How to select the biomass reaction ID ?</comment-title>\n\n        <p>The biomass reaction ID objective is extracted from the current model <em>E.Coli iML1515</em>. You can search the term <code class=\"language-plaintext highlighter-rouge\">biomass</code> in your XML model and pick the ID where the term <code class=\"language-plaintext highlighter-rouge\">core</code> appears.</p>\n      </blockquote>\n\n      <ul>\n        <li><em>“Constraint based simulation type”</em>: <code class=\"language-plaintext highlighter-rouge\">Fraction of Reaction</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>What is the FBA score for <code class=\"language-plaintext highlighter-rouge\">rp_003_0001</code> pathway ?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>View the SBML rp_003_0001 file and look for <code class=\"language-plaintext highlighter-rouge\">fba_fraction</code> value in <code class=\"language-plaintext highlighter-rouge\">&lt;groups:listOfGroups&gt;</code> section: value= <code class=\"language-plaintext highlighter-rouge\">0.23693089430893874</code>.</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<h2 id=\"compute-thermodynamics-values\">Compute thermodynamics values</h2>\n\n<p>The goal of the thermodynamic analysis is to estimate the feasibility of the predicted pathways toward target production, in physiological conditions. The eQuilibrator libraries (<span class=\"citation\"><a href=\"#Flamholz_2011\">Flamholz <i>et al.</i> 2011</a></span>) are used to calculate the formation energy of compounds by either using public database IDs (when referenced within the tools internal database) or by decomposing the chemical structure and calculating its energy of formation using the component contribution method.</p>\n\n<p>The reaction Gibbs energy is estimated by combining the energy of formation of the compounds involved in the reaction (with consideration for the stoichiometric coefficients).</p>\n\n<p>Finally, the thermodynamic of a pathway is estimated by combining the Gibbs energy of reactions involved in it. The contribution of individual reactions to the final pathway thermodynamic is balanced using a linear equation system, according to the relative uses of intermediate compounds across the pathway (See Thermodynamics in Methods section for further details: <span class=\"citation\"><a href=\"#Hrisson2022\">Hérisson <i>et al.</i> 2022</a></span>). A pathway Gibbs energy below zero indicates that the thermodynamic is favorable toward the production of the target.</p>\n\n<p><a href=\"../../images/rpthermo.png\" rel=\"noopener noreferrer\"><img src=\"../../images/rpthermo.png\" alt=\"This image describe the process of computing thermodynamics values of a pathway, to assess whether a pathway is favorable towards target production in physiological conditions. rpThermo tool takes as input the output of rpFBA, which corresponds to the pathway to be analyzed (as an SBML file). rpThermo relies on eQuilibrator libraries to calculate the formation energy of compounds. The reaction Gibbs energy is estimated by combining the energy of formation of the compounds involved in the reaction (with consideration for the stoichiometric coefficients). From this, the thermodynamic of a pathway is estimated by combining the Gibbs energy of all reactions taking part in it. The individual contribution of reactions to the final pathway thermodynamic is weighted using a linear equation system, to take into consideration of the relative needs of intermediate compounds across the pathway. For the record, a pathway Gibbs energy below zero indicates that the thermodynamic is favorable toward the production of the target.\" width=\"1860\" height=\"1044\" loading=\"lazy\" /></a></p>\n\n<p>Secondly, we will use the <em>Thermo</em> tool to estimate thermodynamics values (based on Gibbs free energies) for each pathway to know whether a producing pathway is feasible in physiological conditions</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Compute thermodynamics values for each pathway using rpThermo tool</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/tduigou/rpthermo/rpthermo/5.12.1\" title=\"Thermo tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Thermo</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 5.12.1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input File”</em>: <code class=\"language-plaintext highlighter-rouge\">pathway_with_fba</code> (output of <strong>Flux balance analysis</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n      </ul>\n\n      <blockquote class=\"comment\">\n        <comment-title></comment-title>\n\n        <p>The tool takes as input pathways in SBML format and returns annotated pathways (with thermodynamics information for each reaction) in SBML format too.</p>\n      </blockquote>\n    </li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>What is the thermodynamic score attributed to the reaction with the following <em>EC (Enzyme Commission) number</em> <em>2.5.1.29</em> for <code class=\"language-plaintext highlighter-rouge\">rp_001_0001</code> pathway ?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>View the SBML rp_001_0001 file and search the reaction ID <code class=\"language-plaintext highlighter-rouge\">2.5.1.29</code> contained in <code class=\"language-plaintext highlighter-rouge\">&lt;listOfReactions&gt;</code>. The corresponding value is indicated in <code class=\"language-plaintext highlighter-rouge\">thermo_dGm_prime</code> field : <code class=\"language-plaintext highlighter-rouge\">-242.348</code>.</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<h2 id=\"compute-the-global-score-of-pathways\">Compute the global score of pathways</h2>\n\n<p>The <em>Pathway Score</em> tool provides a global score for a given pathway previously annotated by the <em>Flux Balance Analysis</em> and <em>Thermo</em> tools. This score is computed by a machine learning (ML) model (cf. Machine Learning Global Scoring in <span class=\"citation\"><a href=\"#Hrisson2022\">Hérisson <i>et al.</i> 2022</a></span>). The model takes as input features describing the pathway (thermodynamic feasibility, target flux with fixed biomass, length) and the reactions within the pathway (reaction SMARTS, Gibbs free energy, enzyme availability score) and prints out the probability for the pathway to be a valid pathway. The ML model has been trained on literature data (cf. section Benchmarking with literature data in <span class=\"citation\"><a href=\"#Hrisson2022\">Hérisson <i>et al.</i> 2022</a></span>) and by a validation trial (cf. section Benchmarking by expert validation trial in <span class=\"citation\"><a href=\"#Hrisson2022\">Hérisson <i>et al.</i> 2022</a></span>).</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Compute the global score using the _Pathway Score_ tool</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/tduigou/rpscore/rpscore/5.12.1\" title=\"Score Pathway tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Score Pathway</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 5.12.1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Pathway (rpSBML)”</em>: <code class=\"language-plaintext highlighter-rouge\">pathway_with_thermo</code> (output of <strong>Thermo</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n      </ul>\n\n      <blockquote class=\"comment\">\n        <comment-title></comment-title>\n\n        <p>This tool will output a new annotated SBML file representing the pathway, containing the <code class=\"language-plaintext highlighter-rouge\">global_score</code> annotation.</p>\n      </blockquote>\n    </li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>What is the computed global score for the <code class=\"language-plaintext highlighter-rouge\">rp_001_0001</code> pathway ?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>View the SBML file <code class=\"language-plaintext highlighter-rouge\">rp_001_0001</code> and search for <code class=\"language-plaintext highlighter-rouge\">global_score</code> : value=<code class=\"language-plaintext highlighter-rouge\">0.975147980451584</code>.</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<h2 id=\"rank-annotated-pathways\">Rank annotated pathways</h2>\n\n<p>Finally, <em>Rank Pathways</em> ranks the previous set of heterologous pathways, based on their global score, to reveal what are the most likely pathways to produce the target molecule (here it is <em>lycopene</em>) in a given organism of interest (<em>E. coli</em> in this tutorial).</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Rank annotated pathways using rpRanker tool</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/tduigou/rpranker/rpranker/5.12.1\" title=\"Rank Pathways tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Rank Pathways</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 5.12.1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Pathways”</em>: <code class=\"language-plaintext highlighter-rouge\">scored_pathway</code> (output of <strong>Score Pathway</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n      </ul>\n\n      <blockquote class=\"comment\">\n        <comment-title></comment-title>\n\n        <p>This tool will output a CSV file which contains the pathway IDs and their corresponding global score.</p>\n      </blockquote>\n    </li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <ol>\n    <li>What are the 3 top-ranked pathways ?</li>\n  </ol>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li><code class=\"language-plaintext highlighter-rouge\">002_0011</code>, <code class=\"language-plaintext highlighter-rouge\">001_0011</code> ,<code class=\"language-plaintext highlighter-rouge\">002_0006</code>.</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<h1 id=\"run-the-pathway-analysis-workflow\">Run the <strong>Pathway Analysis Workflow</strong></h1>\n\n<p>In this section, you can run the Pathway Analysis Workflow more easily and fastly following these instructions:</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Execute the entire workflow in one go.</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Import the workflow into Galaxy</p>\n\n      <!--SNIPPET-->\n      <blockquote class=\"hands_on\">   <div class=\"box-title hands_on-title\" id=\"hands-on-importing-and-launching-a-gtn-workflow\"><i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i> Hands-on: Importing and launching a GTN workflow</div>   <div class=\"show-when-galaxy-proxy-active\"> <span class=\"workflow\" data-workflow=\"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/synthetic-biology-pathway_analysis/versions/main_workflow\">Launch <strong>Pathway Analysis Workflow</strong> <i class=\"fas fa-share-alt\" aria-hidden=\"true\"></i></span> (<a href=\"https://github.com/galaxyproject/training-material/blob/main/topics/synthetic-biology/tutorials/pathway_analysis/workflows/main_workflow.ga\">View on GitHub</a>, <a href=\"https://training.galaxyproject.org/training-material/topics/synthetic-biology/tutorials/pathway_analysis/workflows/main_workflow.ga\">Download workflow</a>) workflow. </div>   <div class=\"hide-when-galaxy-proxy-active\"> Click to  <a href=\"https://my.galaxy.training/?path=/workflows/trs_import%3Frun_form=true%26trs_url=https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/synthetic-biology-pathway_analysis/versions/main_workflow\">     Launch <strong>Pathway Analysis Workflow</strong> <i class=\"fas fa-share-alt\" aria-hidden=\"true\"></i> </a> (<a href=\"https://github.com/galaxyproject/training-material/blob/main/topics/synthetic-biology/tutorials/pathway_analysis/workflows/main_workflow.ga\">View on GitHub</a>, <a href=\"https://training.galaxyproject.org/training-material/topics/synthetic-biology/tutorials/pathway_analysis/workflows/main_workflow.ga\">Download workflow</a>) </div>   <!--SNIPPET-->   <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-if-this-does-not-work\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-if-this-does-not-work\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: If this does not work</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ul>   <li>Click on <em>Workflow</em> on the top menu bar of Galaxy. You will see a list of all your workflows.</li>   <li>Click on <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>Import</strong> at the top-right of the screen</li>   <li>Paste the following URL into the box labelled <em>“Archived Workflow URL”</em>: <code class=\"language-plaintext highlighter-rouge\">https://training.galaxyproject.org/training-material/topics/synthetic-biology/tutorials/pathway_analysis/workflows/main_workflow.ga</code></li>   <li>Click the <strong>Import workflow</strong> button</li> </ul>   <p>Below is a short video demonstrating how to import a workflow from GitHub using this procedure:</p>   <figure> <iframe credentialless=\"\" allowfullscreen=\"\" referrerpolicy=\"no-referrer\" sandbox=\"allow-scripts allow-same-origin\" allow=\"accelerometer 'none'; ambient-light-sensor 'none'; autoplay 'none'; battery 'none'; bluetooth 'none'; browsing-topics 'none'; camera 'none'; ch-ua 'none'; display-capture 'none'; domain-agent 'none'; document-domain 'none'; encrypted-media 'none'; execution-while-not-rendered 'none'; execution-while-out-of-viewport 'none'; gamepad 'none'; geolocation 'none'; gyroscope 'none'; hid 'none'; identity-credentials-get 'none'; idle-detection 'none'; keyboard-map 'none'; local-fonts 'none'; magnetometer 'none'; microphone 'none'; midi 'none'; navigation-override 'none'; otp-credentials 'none'; payment 'none'; picture-in-picture 'none'; publickey-credentials-create 'none'; publickey-credentials-get 'none'; screen-wake-lock 'none'; serial 'none'; speaker-selection 'none'; sync-xhr 'none'; usb 'none'; web-share 'none'; window-management 'none'; xr-spatial-tracking 'none'\" csp=\"sandbox allow-scripts allow-same-origin;\" width=\"560\" height=\"315\" src=\"https://www.youtube-nocookie.com/embed/hoP36Te5wko\" title=\"Importing a workflow from URL\" frameborder=\"0\" loading=\"lazy\"></iframe> <figcaption>   <span class=\"figcaption-prefix\"><strong>Video</strong>:</span> Importing a workflow from URL</figcaption> </figure> </blockquote>   <p><!--END_SNIPPET--></p> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>Click on <em>Workflow</em> on the top menu bar of Galaxy. You will see <strong>Pathway Analysis Workflow</strong></li>\n    <li>Click on the <i class=\"fas fa-play\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">workflow-run</span> (<em>Run workflow</em>) button next to your workflow</li>\n    <li>Provide the workflow with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Heterologous pathways”:</em> Select <code class=\"language-plaintext highlighter-rouge\">Heterologous pathways</code> (Input dataset collection) from your current history.</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Chassis where to produce target from”</em>: Select <code class=\"language-plaintext highlighter-rouge\">SBML_Model_iML1515.xml</code> (Input dataset) from your current history.</li>\n        <li><em>“Cell compartment ID”</em>: Enter value <code class=\"language-plaintext highlighter-rouge\">c</code>.</li>\n        <li><em>“biomass reaction ID”</em>: Specify the biomass reaction ID that will be restricted in the “fraction” simulation type <code class=\"language-plaintext highlighter-rouge\">R_BIOMASS_Ec_iML1515_core_75p37M</code>.</li>\n      </ul>\n\n      <blockquote class=\"comment\">\n        <comment-title></comment-title>\n\n        <p>All the outputs will be automatically generated and identical to the previous ones.</p>\n      </blockquote>\n    </li>\n  </ol>\n</blockquote>\n\n<h1 id=\"conclusion\">Conclusion</h1>\n\n<p>To select the best pathways for producing the lycopene in <em>E. coli</em>, some metrics have to be estimated, namely production flux of the target and pathway thermodynamics. A global score is then computed by combining these criteria with others (pathway length, enzyme availability score, reaction SMARTS) using a machine learning model. These steps achieved using the tools of the presented Pathway Analysis workflow.</p>\n\n<p><a href=\"../../images/pathway_analysis_scheme.png\" rel=\"noopener noreferrer\"><img src=\"../../images/pathway_analysis_scheme.png\" alt=\"This scheme represents the pathway analysis workflow enabling the identification of the best pathways for producing a molecule of interest. To do that the workflow takes as input the collection of pathways to be scored and the metabolic model of the chassis (all files are SBMLs). Iteratively, each pathway is merged with the chassis model, and several metrics are evaluated such as the target production flux (using the rpFBA tool) and the thermodynamics of the pathway (using the rpThermo tool). A global score of each pathway combining these metrics with others is computed using a machine learning method (with the rpScore tool). Finally, the pathways are ranked from best to worst according to their global score (using the rpRanker tool). During the workflow, all metrics are stored as SBML annotations. The final output is a CSV file which contains the pathway IDs and their corresponding global score.\" width=\"1905\" height=\"820\" loading=\"lazy\" /></a></p>\n"],"ref_slides":[],"hands_on":true,"slides":false,"mod_date":"2024-05-31 14:27:26 +0000","pub_date":"2022-09-26 09:29:24 +0000","version":11,"workflows":[{"workflow":"main_workflow.ga","tests":false,"url":"https://training.galaxyproject.org/training-material/topics/synthetic-biology/tutorials/pathway_analysis/workflows/main_workflow.ga","path":"topics/synthetic-biology/tutorials/pathway_analysis/workflows/main_workflow.ga","wfid":"synthetic-biology-pathway_analysis","wfname":"main_workflow","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/synthetic-biology-pathway_analysis/versions/main_workflow","license":null,"creators":[],"name":"Pathway Analysis","title":"Pathway Analysis","test_results":null,"modified":"2024-06-24 07:44:31 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Collection\\nHeterologous pathways\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"ℹ️ Input Dataset\\nChassis where to produce target from\"];\n  style 1 stroke:#2c3143,stroke-width:4px;\n  2[\"ℹ️ Input Parameter\\nCell compartment ID\"];\n  style 2 fill:#ded,stroke:#393,stroke-width:4px;\n  3[\"ℹ️ Input Parameter\\nBiomass reaction ID\"];\n  style 3 fill:#ded,stroke:#393,stroke-width:4px;\n  4[\"Flux balance analysis\"];\n  3 -->|output| 4;\n  2 -->|output| 4;\n  1 -->|output| 4;\n  0 -->|output| 4;\n  5[\"Thermo\"];\n  4 -->|pathway_with_fba| 5;\n  6[\"Score Pathway\"];\n  5 -->|pathway_with_thermo| 6;\n  7[\"Rank Pathways\"];\n  6 -->|scored_pathway| 7;\n  8111f525-5845-4ac2-a1d6-c4bfd218cf3f[\"Output\\nRanked Pathways\"];\n  7 --> 8111f525-5845-4ac2-a1d6-c4bfd218cf3f;\n  style 8111f525-5845-4ac2-a1d6-c4bfd218cf3f stroke:#2c3143,stroke-width:4px;"}],"api":"https://training.galaxyproject.org/training-material/api/topics/synthetic-biology/tutorials/pathway_analysis/tutorial.json","tools":["toolshed.g2.bx.psu.edu/repos/iuc/rpfba/rpfba/5.12.1","toolshed.g2.bx.psu.edu/repos/tduigou/rpranker/rpranker/5.12.1","toolshed.g2.bx.psu.edu/repos/tduigou/rpscore/rpscore/5.12.1","toolshed.g2.bx.psu.edu/repos/tduigou/rpthermo/rpthermo/5.12.1"],"supported_servers":{"exact":[],"inexact":[]},"topic_name_human":"Synthetic Biology","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"rpfba","owner":"iuc","revisions":"19be43e96154","tool_panel_section_label":"Synthetic Biology","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"rpranker","owner":"tduigou","revisions":"bab690866445","tool_panel_section_label":"Synthetic Biology","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"rpscore","owner":"tduigou","revisions":"da8ae7fa5ed3","tool_panel_section_label":"Synthetic Biology","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"rpthermo","owner":"tduigou","revisions":"21a900eee812","tool_panel_section_label":"Synthetic Biology","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: rpfba\n  owner: iuc\n  revisions: 19be43e96154\n  tool_panel_section_label: Synthetic Biology\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: rpranker\n  owner: tduigou\n  revisions: bab690866445\n  tool_panel_section_label: Synthetic Biology\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: rpscore\n  owner: tduigou\n  revisions: da8ae7fa5ed3\n  tool_panel_section_label: Synthetic Biology\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: rpthermo\n  owner: tduigou\n  revisions: 21a900eee812\n  tool_panel_section_label: Synthetic Biology\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":false,"slides_recordings":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial"}